{"version":3,"sources":["main.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","2","getTeamData","res","inMap","sims","Object","keys","map","key","sort","b","start","time","first","teamid","data","info","trips","revenue","forEach","sim","push","_teamid","step","inRev","rev","lyft","parseFloat","taxi","plotMain","datasets","line","total","idx","x","y","label","borderColor","PINK","fill","cubicInterpolationMode","_loop","ctx","document","getElementById","getContext","Chart","type","options","responsive","maintainAspectRatio","legend","position","title","display","text","scales","xAxes","scaleLabel","labelString","ticks","callback","ts","moment","format","yAxes","toFixed","elements","point","radius","config","db","firebase","initializeApp","database","GAME","qs","split","join","tokens","params","re","exec","decodeURIComponent","getQueryParams","location","search","game","gameid","ref","on","snap","val","onResults","console","log","./config"],"mappings":"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","file":"../main.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n\"use strict\";\n\nmodule.exports = {\n    apiKey: \"AIzaSyCGWEpvuy4sPR3n5xzwfATLzyMDvwE6tOY\",\n    authDomain: \"illinois-tech-acm.firebaseapp.com\",\n    databaseURL: \"https://illinois-tech-acm.firebaseio.com\",\n    projectId: \"illinois-tech-acm\",\n    storageBucket: \"illinois-tech-acm.appspot.com\",\n    messagingSenderId: \"344533734310\"\n};\n\n},{}],2:[function(require,module,exports){\n'use strict';\n\nvar config = require('./config');\nvar FirebaseApp = firebase.initializeApp(config);\nvar db = FirebaseApp.database();\n\nvar PARAMS = getQueryParams(document.location.search);\nvar GAME = PARAMS.game;\n\nvar PINK = '#EA38B9';\nvar PURPLE = '#422E6E';\n\nfunction getQueryParams(qs) {\n\tqs = qs.split('+').join(' ');\n\tvar params = {},\n\t    tokens,\n\t    re = /[?&]?([^=]+)=([^&]*)/g;\n\twhile (tokens = re.exec(qs)) {\n\t\tparams[decodeURIComponent(tokens[1])] = decodeURIComponent(tokens[2]);\n\t}\n\treturn params;\n}\n\nfunction onResults(gameid, callback) {\n\tdb.ref('lyft/results/' + gameid).on('value', function (snap) {\n\t\tvar val = snap.val() || {};\n\t\tcallback(val);\n\t});\n}\n\nfunction getTeamData(res) {\n\tvar inMap = res || {};\n\tvar sims = Object.keys(inMap).map(function (key) {\n\t\treturn res[key];\n\t}).sort(function (a, b) {\n\t\treturn a.start - b.start;\n\t});\n\tvar time = [];\n\tvar map = {};\n\tif (sims.length > 0) {\n\t\tvar first = sims[0];\n\t\tfor (var teamid in first.data) {\n\t\t\tif (!(teamid in map)) {\n\t\t\t\tmap[teamid] = {\n\t\t\t\t\tinfo: { teamid: teamid },\n\t\t\t\t\ttrips: [],\n\t\t\t\t\trevenue: []\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\tsims.forEach(function (sim) {\n\t\t\ttime.push(sim.start);\n\t\t\tfor (var _teamid in sim.data) {\n\t\t\t\tif (_teamid in map) {\n\t\t\t\t\tvar step = sim.data[_teamid];\n\t\t\t\t\tmap[_teamid].trips.push(step.trips);\n\t\t\t\t\tvar inRev = step.revenue;\n\t\t\t\t\tvar rev = {\n\t\t\t\t\t\tlyft: parseFloat(inRev.lyft),\n\t\t\t\t\t\ttaxi: parseFloat(inRev.taxi)\n\t\t\t\t\t};\n\t\t\t\t\tmap[_teamid].revenue.push(rev);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\treturn {\n\t\ttime: time,\n\t\tmap: map\n\t};\n}\n\nfunction plotMain(time, map) {\n\tvar datasets = [];\n\n\tvar _loop = function _loop(teamid) {\n\t\tvar line = [];\n\t\tvar total = 0;\n\t\tmap[teamid].revenue.forEach(function (step, idx) {\n\t\t\ttotal += step.lyft;\n\t\t\tline.push({\n\t\t\t\tx: time[idx],\n\t\t\t\ty: total\n\t\t\t});\n\t\t});\n\t\tdatasets.push({\n\t\t\tlabel: teamid,\n\t\t\tborderColor: PINK,\n\t\t\tfill: false,\n\t\t\tcubicInterpolationMode: 'monotone',\n\t\t\tdata: line\n\t\t});\n\t};\n\n\tfor (var teamid in map) {\n\t\t_loop(teamid);\n\t}\n\tvar ctx = document.getElementById('plot1').getContext('2d');\n\tvar chart = new Chart(ctx, {\n\t\ttype: 'line',\n\t\tdata: {\n\t\t\tdatasets: datasets\n\t\t},\n\t\toptions: {\n\t\t\tresponsive: false,\n\t\t\tmaintainAspectRatio: true,\n\t\t\tlegend: {\n\t\t\t\tposition: 'bottom'\n\t\t\t},\n\t\t\ttitle: {\n\t\t\t\tdisplay: true,\n\t\t\t\ttext: 'Revenue over Time'\n\t\t\t},\n\t\t\tscales: {\n\t\t\t\txAxes: [{\n\t\t\t\t\tdisplay: true,\n\t\t\t\t\ttype: 'linear',\n\t\t\t\t\tscaleLabel: {\n\t\t\t\t\t\tdisplay: true,\n\t\t\t\t\t\tlabelString: 'Time'\n\t\t\t\t\t},\n\t\t\t\t\tticks: {\n\t\t\t\t\t\tcallback: function callback(ts) {\n\t\t\t\t\t\t\treturn moment(ts).format('M/D');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}],\n\t\t\t\tyAxes: [{\n\t\t\t\t\tdisplay: true,\n\t\t\t\t\ttype: 'linear',\n\t\t\t\t\tscaleLabel: {\n\t\t\t\t\t\tdisplay: true,\n\t\t\t\t\t\tlabelString: 'Revenue ($)'\n\t\t\t\t\t},\n\t\t\t\t\tticks: {\n\t\t\t\t\t\tcallback: function callback(rev) {\n\t\t\t\t\t\t\treturn '$' + rev.toFixed(0);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}]\n\t\t\t},\n\t\t\telements: {\n\t\t\t\tpoint: {\n\t\t\t\t\tradius: 0\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n}\n\nif (GAME) {\n\tonResults(GAME, function (res) {\n\t\tvar data = getTeamData(res);\n\t\tconsole.log(data);\n\t\tplotMain(data.time, data.map);\n\t});\n}\n\n},{\"./config\":1}]},{},[2])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvY29uZmlnLmpzIiwic3JjL2pzL21haW4uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztBQ0FBLE9BQU8sT0FBUCxHQUFpQjtBQUNiLFlBQVEseUNBREs7QUFFYixnQkFBWSxtQ0FGQztBQUdiLGlCQUFhLDBDQUhBO0FBSWIsZUFBVyxtQkFKRTtBQUtiLG1CQUFlLCtCQUxGO0FBTWIsdUJBQW1CO0FBTk4sQ0FBakI7Ozs7O0FDQUEsSUFBSSxTQUFTLFFBQVEsVUFBUixDQUFiO0FBQ0EsSUFBSSxjQUFjLFNBQVMsYUFBVCxDQUF1QixNQUF2QixDQUFsQjtBQUNBLElBQUksS0FBSyxZQUFZLFFBQVosRUFBVDs7QUFFQSxJQUFNLFNBQVMsZUFBZSxTQUFTLFFBQVQsQ0FBa0IsTUFBakMsQ0FBZjtBQUNBLElBQU0sT0FBTyxPQUFPLElBQXBCOztBQUVBLElBQU0sZ0JBQU47QUFDQSxJQUFNLGtCQUFOOztBQUVBLFNBQVMsY0FBVCxDQUF3QixFQUF4QixFQUE0QjtBQUMzQixNQUFLLEdBQUcsS0FBSCxDQUFTLEdBQVQsRUFBYyxJQUFkLENBQW1CLEdBQW5CLENBQUw7QUFDQSxLQUFJLFNBQVMsRUFBYjtBQUFBLEtBQ0MsTUFERDtBQUFBLEtBRUMsS0FBSyx1QkFGTjtBQUdBLFFBQU8sU0FBUyxHQUFHLElBQUgsQ0FBUSxFQUFSLENBQWhCLEVBQTZCO0FBQzVCLFNBQU8sbUJBQW1CLE9BQU8sQ0FBUCxDQUFuQixDQUFQLElBQXdDLG1CQUFtQixPQUFPLENBQVAsQ0FBbkIsQ0FBeEM7QUFDQTtBQUNELFFBQU8sTUFBUDtBQUNBOztBQUVELFNBQVMsU0FBVCxDQUFtQixNQUFuQixFQUEyQixRQUEzQixFQUFxQztBQUNwQyxJQUFHLEdBQUgsbUJBQXVCLE1BQXZCLEVBQWlDLEVBQWpDLENBQW9DLE9BQXBDLEVBQTZDLFVBQUMsSUFBRCxFQUFVO0FBQ3RELE1BQUksTUFB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O0FBQ1AsY0FBUyxJQURGO0FBRVAsbUJBRk87QUFHUCxpQkFBWTtBQUNYLGVBQVMsSUFERTtBQUVYLG1CQUFhO0FBRkYsTUFITDtBQU9QLFlBQU87QUFDTixnQkFBVSxrQkFBQyxFQUFELEVBQVE7QUFDakIsY0FBTyxPQUFPLEVBQVAsRUFBVyxNQUFYLENBQWtCLEtBQWxCLENBQVA7QUFDQTtBQUhLO0FBUEEsS0FBRCxDQURBO0FBY1AsV0FBTyxDQUFDO0FBQ1AsY0FBUyxJQURGO0FBRVAsbUJBRk87QUFHUCxpQkFBWTtBQUNYLGVBQVMsSUFERTtBQUVYLG1CQUFhO0FBRkYsTUFITDtBQU9QLFlBQU87QUFDTixnQkFBVSxrQkFBQyxHQUFELEVBQVM7QUFDbEIsb0JBQVcsSUFBSSxPQUFKLENBQVksQ0FBWixDQUFYO0FBQ0E7QUFISztBQVBBLEtBQUQ7QUFkQSxJQVZBO0FBc0NSLGFBQVU7QUFDVCxXQUFPO0FBQ04sYUFBUTtBQURGO0FBREU7QUF0Q0Y7QUFMaUIsRUFBZixDQUFaO0FBa0RBOztBQUVELElBQUksSUFBSixFQUFVO0FBQ1QsV0FBVSxJQUFWLEVBQWdCLFVBQUMsR0FBRCxFQUFTO0FBQ3hCLE1BQUksT0FBTyxZQUFZLEdBQVosQ0FBWDtBQUNBLFVBQVEsR0FBUixDQUFZLElBQVo7QUFDQSxXQUFTLEtBQUssSUFBZCxFQUFvQixLQUFLLEdBQXpCO0FBQ0EsRUFKRDtBQUtBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIm1vZHVsZS5leHBvcnRzID0ge1xuICAgIGFwaUtleTogXCJBSXphU3lDR1dFcHZ1eTRzUFIzbjV4endmQVRMenlNRHZ3RTZ0T1lcIixcbiAgICBhdXRoRG9tYWluOiBcImlsbGlub2lzLXRlY2gtYWNtLmZpcmViYXNlYXBwLmNvbVwiLFxuICAgIGRhdGFiYXNlVVJMOiBcImh0dHBzOi8vaWxsaW5vaXMtdGVjaC1hY20uZmlyZWJhc2Vpby5jb21cIixcbiAgICBwcm9qZWN0SWQ6IFwiaWxsaW5vaXMtdGVjaC1hY21cIixcbiAgICBzdG9yYWdlQnVja2V0OiBcImlsbGlub2lzLXRlY2gtYWNtLmFwcHNwb3QuY29tXCIsXG4gICAgbWVzc2FnaW5nU2VuZGVySWQ6IFwiMzQ0NTMzNzM0MzEwXCJcbn0iLCJsZXQgY29uZmlnID0gcmVxdWlyZSgnLi9jb25maWcnKTtcbmxldCBGaXJlYmFzZUFwcCA9IGZpcmViYXNlLmluaXRpYWxpemVBcHAoY29uZmlnKTtcbmxldCBkYiA9IEZpcmViYXNlQXBwLmRhdGFiYXNlKCk7XG5cbmNvbnN0IFBBUkFNUyA9IGdldFF1ZXJ5UGFyYW1zKGRvY3VtZW50LmxvY2F0aW9uLnNlYXJjaCk7XG5jb25zdCBHQU1FID0gUEFSQU1TLmdhbWU7XG5cbmNvbnN0IFBJTksgPSBgI0VBMzhCOWA7XG5jb25zdCBQVVJQTEUgPSBgIzQyMkU2RWA7XG5cbmZ1bmN0aW9uIGdldFF1ZXJ5UGFyYW1zKHFzKSB7XG5cdHFzID0gcXMuc3BsaXQoJysnKS5qb2luKCcgJyk7XG5cdHZhciBwYXJhbXMgPSB7fSxcblx0XHR0b2tlbnMsXG5cdFx0cmUgPSAvWz8mXT8oW149XSspPShbXiZdKikvZztcblx0d2hpbGUgKHRva2VucyA9IHJlLmV4ZWMocXMpKSB7XG5cdFx0cGFyYW1zW2RlY29kZVVSSUNvbXBvbmVudCh0b2tlbnNbMV0pXSA9IGRlY29kZVVSSUNvbXBvbmVudCh0b2tlbnNbMl0pO1xuXHR9XG5cdHJldHVybiBwYXJhbXM7XG59XG5cbmZ1bmN0aW9uIG9uUmVzdWx0cyhnYW1laWQsIGNhbGxiYWNrKSB7XG5cdGRiLnJlZihgbHlmdC9yZXN1bHRzLyR7Z2FtZWlkfWApLm9uKCd2YWx1ZScsIChzbmFwKSA9PiB7XG5cdFx0bGV0IHZhbCA9IHNuYXAudmFsKCkgfHwge307XG5cdFx0Y2FsbGJhY2sodmFsKTtcblx0fSk7XG59XG5cbmZ1bmN0aW9uIGdldFRlYW1EYXRhKHJlcykge1xuXHRsZXQgaW5NYXAgPSByZXMgfHwge307XG5cdGxldCBzaW1zID0gT2JqZWN0LmtleXMoaW5NYXApLm1hcCgoa2V5KSA9PiByZXNba2V5XSkuc29ydCgoYSwgYikgPT4ge1xuXHRcdHJldHVybiBhLnN0YXJ0IC0gYi5zdGFydDtcblx0fSk7XG5cdGxldCB0aW1lID0gW107XG5cdGxldCBtYXAgPSB7fTtcblx0aWYgKHNpbXMubGVuZ3RoID4gMCkge1xuXHRcdGxldCBmaXJzdCA9IHNpbXNbMF07XG5cdFx0Zm9yIChsZXQgdGVhbWlkIGluIGZpcnN0LmRhdGEpIHtcblx0XHRcdGlmICghKHRlYW1pZCBpbiBtYXApKSB7XG5cdFx0XHRcdG1hcFt0ZWFtaWRdID0ge1xuXHRcdFx0XHRcdGluZm86IHt0ZWFtaWQ6IHRlYW1pZH0sXG5cdFx0XHRcdFx0dHJpcHM6IFtdLFxuXHRcdFx0XHRcdHJldmVudWU6IFtdXG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0c2ltcy5mb3JFYWNoKChzaW0pID0+IHtcblx0XHRcdHRpbWUucHVzaChzaW0uc3RhcnQpO1xuXHRcdFx0Zm9yIChsZXQgdGVhbWlkIGluIHNpbS5kYXRhKSB7XG5cdFx0XHRcdGlmICh0ZWFtaWQgaW4gbWFwKSB7XG5cdFx0XHRcdFx0bGV0IHN0ZXAgPSBzaW0uZGF0YVt0ZWFtaWRdO1xuXHRcdFx0XHRcdG1hcFt0ZWFtaWRdLnRyaXBzLnB1c2goc3RlcC50cmlwcyk7XG5cdFx0XHRcdFx0bGV0IGluUmV2ID0gc3RlcC5yZXZlbnVlO1xuXHRcdFx0XHRcdGxldCByZXYgPSB7XG5cdFx0XHRcdFx0XHRseWZ0OiBwYXJzZUZsb2F0KGluUmV2Lmx5ZnQpLFxuXHRcdFx0XHRcdFx0dGF4aTogcGFyc2VGbG9hdChpblJldi50YXhpKVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRtYXBbdGVhbWlkXS5yZXZlbnVlLnB1c2gocmV2KTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cdHJldHVybiB7XG5cdFx0dGltZTogdGltZSxcblx0XHRtYXA6IG1hcFxuXHR9O1xufVxuXG5mdW5jdGlvbiBwbG90TWFpbih0aW1lLCBtYXApIHtcblx0bGV0IGRhdGFzZXRzID0gW107XG5cdGZvciAobGV0IHRlYW1pZCBpbiBtYXApIHtcblx0XHRsZXQgbGluZSA9IFtdO1xuXHRcdGxldCB0b3RhbCA9IDA7XG5cdFx0bWFwW3RlYW1pZF0ucmV2ZW51ZS5mb3JFYWNoKChzdGVwLCBpZHgpID0+IHtcblx0XHRcdHRvdGFsICs9IHN0ZXAubHlmdDtcblx0XHRcdGxpbmUucHVzaCh7XG5cdFx0XHRcdHg6IHRpbWVbaWR4XSxcblx0XHRcdFx0eTogdG90YWxcblx0XHRcdH0pO1xuXHRcdH0pO1xuXHRcdGRhdGFzZXRzLnB1c2goe1xuXHRcdFx0bGFiZWw6IHRlYW1pZCxcblx0XHRcdGJvcmRlckNvbG9yOiBQSU5LLFxuXHRcdFx0ZmlsbDogZmFsc2UsXG5cdFx0XHRjdWJpY0ludGVycG9sYXRpb25Nb2RlOiAnbW9ub3RvbmUnLFxuXHRcdFx0ZGF0YTogbGluZVxuXHRcdH0pO1xuXHR9XG5cdGxldCBjdHggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGxvdDEnKS5nZXRDb250ZXh0KCcyZCcpO1xuXHRsZXQgY2hhcnQgPSBuZXcgQ2hhcnQoY3R4LCB7XG5cdFx0dHlwZTogYGxpbmVgLFxuXHRcdGRhdGE6IHtcblx0XHRcdGRhdGFzZXRzOiBkYXRhc2V0c1xuXHRcdH0sXG5cdFx0b3B0aW9uczoge1xuXHRcdFx0cmVzcG9uc2l2ZTogZmFsc2UsXG5cdFx0XHRtYWludGFpbkFzcGVjdFJhdGlvOiB0cnVlLFxuXHRcdFx0bGVnZW5kOiB7XG5cdFx0XHRcdHBvc2l0aW9uOiBgYm90dG9tYCxcblx0XHRcdH0sXG5cdFx0XHR0aXRsZToge1xuXHRcdFx0XHRkaXNwbGF5OiB0cnVlLFxuXHRcdFx0XHR0ZXh0OiBgUmV2ZW51ZSBvdmVyIFRpbWVgXG5cdFx0XHR9LFxuXHRcdFx0c2NhbGVzOiB7XG5cdFx0XHRcdHhBeGVzOiBbe1xuXHRcdFx0XHRcdGRpc3BsYXk6IHRydWUsXG5cdFx0XHRcdFx0dHlwZTogYGxpbmVhcmAsXG5cdFx0XHRcdFx0c2NhbGVMYWJlbDoge1xuXHRcdFx0XHRcdFx0ZGlzcGxheTogdHJ1ZSxcblx0XHRcdFx0XHRcdGxhYmVsU3RyaW5nOiAnVGltZSdcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdHRpY2tzOiB7XG5cdFx0XHRcdFx0XHRjYWxsYmFjazogKHRzKSA9PiB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBtb21lbnQodHMpLmZvcm1hdCgnTS9EJyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XSxcblx0XHRcdFx0eUF4ZXM6IFt7XG5cdFx0XHRcdFx0ZGlzcGxheTogdHJ1ZSxcblx0XHRcdFx0XHR0eXBlOiBgbGluZWFyYCxcblx0XHRcdFx0XHRzY2FsZUxhYmVsOiB7XG5cdFx0XHRcdFx0XHRkaXNwbGF5OiB0cnVlLFxuXHRcdFx0XHRcdFx0bGFiZWxTdHJpbmc6ICdSZXZlbnVlICgkKSdcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdHRpY2tzOiB7XG5cdFx0XHRcdFx0XHRjYWxsYmFjazogKHJldikgPT4ge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gYCQke3Jldi50b0ZpeGVkKDApfWA7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XVxuXHRcdFx0fSxcblx0XHRcdGVsZW1lbnRzOiB7XG5cdFx0XHRcdHBvaW50OiB7XG5cdFx0XHRcdFx0cmFkaXVzOiAwXG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH0pO1xufVxuXG5pZiAoR0FNRSkge1xuXHRvblJlc3VsdHMoR0FNRSwgKHJlcykgPT4ge1xuXHRcdGxldCBkYXRhID0gZ2V0VGVhbURhdGEocmVzKTtcblx0XHRjb25zb2xlLmxvZyhkYXRhKTtcblx0XHRwbG90TWFpbihkYXRhLnRpbWUsIGRhdGEubWFwKTtcblx0fSk7XG59XG4iXX0=\n"]}