{"version":3,"sources":["main.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","Object","defineProperty","value","firebaseApp_1","firebase","createFirebaseNamespace","default","./src/firebaseApp","2","app","name","DEFAULT_ENTRY_NAME","contains","apps_","error","getApps","keys","map","callAppHooks","eventName","factories","forEach","serviceName","factoryName","useAsService","appHooks","useService","options","namespace","__esModule","initializeApp","undefined","FirebaseAppImpl","apps","Promise","SDK_VERSION","INTERNAL","registerService","createService","serviceProperties","appHook","allowMultipleInstances","serviceNamespace","appArg","util_2","deepExtend","prototype","args","_i","arguments","this","_getService","bind","apply","extendNamespace","props","createSubscribe","util_1","ErrorFactory","removeApp","patchProperty","get","appErrors","create","obj","key","hasOwnProperty","tokenListeners","firebase_","isDeleted_","services_","name_","options_","deepCopy","getUid","getToken","resolve","addAuthTokenListener","callback","push","setTimeout","removeAuthTokenListener","filter","listener","checkDestroyed_","enumerable","configurable","delete","_this","then","services","serviceKey","instanceKey","all","service","instanceIdentifier","instanceSpecifier","extendApp","console","log","no-app","bad-app-name","duplicate-app","app-deleted","duplicate-service","sa-not-supported","invalid-app-argument","@firebase/util","3","global","h","aa","k","ba","m","ca","da","ea","b","Array","c","toString","splice","propertyIsEnumerable","fa","ha","ia","p","q","ja","ka","d","slice","unshift","Function","indexOf","la","ma","Date","now","Uc","constructor","Og","captureStackTrace","stack","message","String","na","split","shift","join","oa","trim","replace","wa","pa","test","qa","ra","sa","ta","ua","va","v","xa","ya","za","w","Aa","Ba","Ca","Da","Fa","Tc","kf","Ea","qb","ob","Ga","Ha","Ja","Lc","lf","Ia","bb","Ka","Oa","La","Ma","JSON","stringify","encodeURIComponent","Na","Pa","Math","max","x","Qa","Ra","g","Sa","some","Ua","Ta","charAt","Va","Xa","Wa","Ya","Za","concat","$a","ab","cb","navigator","db","userAgent","y","eb","fb","gb","hb","ib","jb","kb","lb","mb","nb","wb","pb","z","rb","sb","tb","toLowerCase","ub","vb","document","documentMode","xb","yb","exec","Ab","parseFloat","Cb","Bb","A","parseInt","Db","compatMode","Kb","Eb","Fb","Hb","Gb","fromCharCode","Ib","Mb","qc","Uint8Array","Xc","bg","Fe","Cg","Int32Array","Lb","reset","Nb","Ob","Pb","Qb","F","zb","ic","yi","update","charCodeAt","digest","Sb","Rb","Tb","freeze","Ub","Ic","isDisposed","Vb","Number","Wb","Xb","addEventListener","removeEventListener","B","type","currentTarget","target","defaultPrevented","Ue","stopPropagation","preventDefault","Yb","relatedTarget","button","screenY","screenX","clientY","clientX","offsetY","offsetX","charCode","keyCode","metaKey","shiftKey","altKey","ctrlKey","state","pointerId","pointerType","R","init","Zb","4","changedTouches","srcElement","nodeName","fromElement","toElement","layerX","layerY","pageX","pageY","cancelBubble","returnValue","Hf","$b","random","ac","bc","Mc","src","capture","vc","pc","cc","dc","I","jc","add","ec","remove","fc","td","hasListener","gc","hc","lc","once","kc","mc","listen","nc","oc","attachEvent","rc","sc","tc","ga","uc","detachEvent","wc","parentNode","xc","handleEvent","yc","Ac","jf","zc","Bc","Cc","Ec","Dc","Hc","Fc","Gc","Nc","Boolean","valueOf","isFinite","isNaN","Jc","\"","\\","/","\b","\f","\n","\r","\t","\u000b","Kc","substr","je","Cd","Oc","Pc","ActiveXObject","XMLHttpRequest","Ee","Qc","XDomainRequest","Rc","readyState","onreadystatechange","responseText","status","statusText","responseXML","onload","Lf","onerror","ze","onprogress","Mf","ontimeout","Nf","open","send","abort","setRequestHeader","getResponseHeader","contentType","Sc","getAllResponseHeaders","Yf","wf","lg","next","put","Vc","Wc","MessageChannel","window","postMessage","createElement","style","display","documentElement","appendChild","contentWindow","write","close","location","protocol","host","origin","data","port1","onmessage","port2","me","removeChild","bd","Zc","Yc","set","scope","rd","$c","dd","ad","cd","ed","setImmediate","Window","fd","ownerDocument","defaultView","parentWindow","Location","Element","displayName","gd","id","hf","hd","jd","Tf","kd","ld","getElementById","nd","cssText","className","htmlFor","md","setAttribute","lastIndexOf","cellpadding","cellspacing","colspan","frameborder","height","maxlength","nonce","role","rowspan","usemap","valign","width","pd","od","createTextNode","nodeType","qd","item","$goog_Thenable","sd","C","ud","vd","context","child","wd","xd","D","E","zd","yd","Ad","Bd","Gf","reason","Ed","Dd","cancel","Fd","Gd","Hd","Id","zg","Ag","TypeError","Jd","Kd","Bf","Ld","Md","Nd","Ne","re","be","he","Od","Pd","oe","Qd","Rd","Td","Sd","Ud","Wd","Vd","Xd","Yd","clearTimeout","Zd","yg","de","We","$d","timeout","ae","Pg","attributes","charset","ce","getElementsByTagName","tagName","ee","te","fe","Xe","ge","Le","Ae","ie","ke","le","getName","getParent","info","config","ne","pe","G","nf","dispatchEvent","qe","se","StopIteration","mf","H","ue","addAll","ve","Jb","we","clear","clone","xe","ye","Be","Ce","De","substring","decodeURIComponent","headers","Ke","hg","gf","T","Ge","He","toUpperCase","Re","Qe","upload","Ie","FormData","responseType","withCredentials","Je","Me","dg","Oe","Pe","match","self","lengthComputable","loaded","total","getResponse","response","mozResponseArrayBuffer","Se","Xf","Te","J","Ve","Ye","Ze","$e","af","bf","cf","df","pop","ef","K","ff","removeParameter","decodeURI","encodeURI","X","extend","pf","Kg","Lg","Mg","of","firebaseEndpoint","secureTokenEndpoint","qf","L","rf","href","sf","tf","vf","uf","xf","yf","floor","screen","availHeight","availWidth","top","left","resizable","statusbar","toolbar","scrollbars","standalone","noreferrer","createEvent","initMouseEvent","opener","noopener","focus","zf","closed","Af","Df","Cf","Ef","Ff","If","Fg","Hg","Jf","sort","M","localStorage","Kf","setItem","removeItem","indexedDB","Of","Pf","Qf","Rf","parse","Sf","___jsl","CP","Uf","onLine","connection","Vf","ug","ag","Wf","$f","visibilityState","getTime","toUTCString","Zf","abcd","N","cg","eg","fg","gg","ig","Gg","providerId","Ig","Jg","Ng","jg","O","kg","toJSON","argument-error","app-not-authorized","app-not-installed","captcha-check-failed","code-expired","cordova-not-ready","cors-unsupported","credential-already-in-use","custom-token-mismatch","requires-recent-login","dynamic-link-not-activated","email-already-in-use","expired-action-code","cancelled-popup-request","internal-error","invalid-app-credential","invalid-app-id","invalid-user-token","invalid-auth-event","invalid-verification-code","invalid-continue-uri","invalid-cordova-configuration","invalid-custom-token","invalid-email","invalid-api-key","invalid-credential","invalid-persistence-type","invalid-message-payload","invalid-oauth-provider","invalid-oauth-client-id","unauthorized-domain","invalid-action-code","wrong-password","invalid-phone-number","invalid-recipient-email","invalid-sender","invalid-verification-id","missing-android-pkg-name","auth-domain-config-required","missing-app-credential","missing-verification-code","missing-continue-uri","missing-iframe-start","missing-ios-bundle-id","missing-phone-number","missing-verification-id","account-exists-with-different-credential","network-request-failed","no-auth-event","no-such-provider","operation-not-allowed","operation-not-supported-in-this-environment","popup-blocked","popup-closed-by-user","provider-already-linked","quota-exceeded","redirect-cancelled-by-user","redirect-operation-pending","user-token-expired","too-many-requests","unauthorized-continue-uri","unsupported-persistence-type","user-cancelled","user-not-found","user-disabled","user-mismatch","user-signed-out","weak-password","web-storage-unsupported","mg","Y","getError","eventId","urlResponse","sessionId","ng","og","pg","sub","email","provider_id","sign_in_provider","is_anonymous","getEmail","isAnonymous","qg","iss","aud","exp","rg","idToken","sg","accessToken","oauthToken","oauthTokenSecret","tg","vg","wg","id_token","access_token","secret","oauth_token_secret","postBody","requestUri","oauthIdToken","oauthAccessToken","xg","isOAuthProvider","setCustomParameters","P","addScope","credential","Bg","Dg","Eg","Q","password","PROVIDER_ID","verificationId","phoneNumber","U","verifyPhoneNumber","operation","verificationCode","temporaryProof","sessionInfo","auth","verify","recaptchaToken","Qg","Rg","Sg","Tg","Ug","Vg","$g","node","secureTokenTimeout","Wg","secureTokenHeaders","Xg","firebaseTimeout","Yg","firebaseHeaders","Zg","Content-Type","ah","bh","dh","ch","eh","fh","gapi","client","request","setApiKey","setToken","path","method","body","authType","hh","grant_type","refresh_token","gh","ih","jh","kh","mh","lh","identifier","continueUri","allProviders","oh","nh","authorizedDomains","ph","qh","signInAnonymously","rh","updateEmail","sh","updatePassword","th","photoUrl","updateProfile","deleteAttribute","sendPasswordResetEmail","requestType","uh","sendEmailVerification","vh","wh","yh","xh","deleteProvider","zh","Ah","needConfirmation","errorMessage","returnIdpCredential","Bh","Ch","autoCreate","Dh","Eh","oobCode","confirmPasswordReset","Fh","newPassword","checkActionCode","Gh","applyActionCode","Hh","endpoint","$","Ih","Jh","Kh","Lh","recaptchaSiteKey","Mh","token","USER_NOT_FOUND","returnSecureToken","errors","keyInvalid","ipRefererBlocked","INVALID_CUSTOM_TOKEN","CREDENTIAL_MISMATCH","MISSING_CUSTOM_TOKEN","INVALID_IDENTIFIER","MISSING_CONTINUE_URI","INVALID_EMAIL","INVALID_PASSWORD","USER_DISABLED","MISSING_PASSWORD","EMAIL_EXISTS","PASSWORD_LOGIN_DISABLED","INVALID_IDP_RESPONSE","FEDERATED_USER_ID_ALREADY_LINKED","INVALID_MESSAGE_PAYLOAD","INVALID_RECIPIENT_EMAIL","INVALID_SENDER","EMAIL_NOT_FOUND","EXPIRED_OOB_CODE","INVALID_OOB_CODE","MISSING_OOB_CODE","CREDENTIAL_TOO_OLD_LOGIN_AGAIN","INVALID_ID_TOKEN","TOKEN_EXPIRED","CORS_UNSUPPORTED","DYNAMIC_LINK_NOT_ACTIVATED","INVALID_APP_ID","TOO_MANY_ATTEMPTS_TRY_LATER","WEAK_PASSWORD","OPERATION_NOT_ALLOWED","USER_CANCELLED","CAPTCHA_CHECK_FAILED","INVALID_APP_CREDENTIAL","INVALID_CODE","INVALID_PHONE_NUMBER","INVALID_SESSION_INFO","INVALID_TEMPORARY_PROOF","MISSING_APP_CREDENTIAL","MISSING_CODE","MISSING_PHONE_NUMBER","MISSING_SESSION_INFO","QUOTA_EXCEEDED","SESSION_EXPIRED","INVALID_CONTINUE_URI","MISSING_ANDROID_PACKAGE_NAME","MISSING_IOS_BUNDLE_ID","UNAUTHORIZED_DOMAIN","INVALID_OAUTH_CLIENT_ID","Oh","Nh","Ph","where","url","messageHandlersFilter","position","dontclear","restyle","setHideOnLeave","Qh","ping","sendMessage","Rh","register","Sh","Th","Uh","Vh","Wh","Xh","Yh","Zh","RegExp","$h","ai","bi","ci","authEvent","webStorageSupport","di","theme","sitekey","size","hasChildNodes","ei","fi","gi","render","hi","grecaptcha","execute","firstChild","ii","ji","Infinity","hl","ki","li","apiKey","mi","reactNative","AsyncStorage","getItem","ni","pi","oi","qi","si","ri","sessionStorage","ui","ti","vi","errorCode","onupgradeneeded","result","createObjectStore","keyPath","onsuccess","wi","xi","objectStore","zi","transaction","Ai","getAll","openCursor","Fi","Ei","Browser","Bi","Node","Ci","ReactNative","Di","Gi","android","packageName","installApp","minimumVersion","iOS","bundleId","handleCodeInApp","Hi","continueUrl","canHandleCodeInApp","androidPackageName","androidMinimumVersion","androidInstallApp","iOSBundleId","Ii","confirm","Ji","Ki","newEmail","fromEmail","Li","start","Mi","Ni","stop","Ui","Oi","Pi","Qi","Ri","Si","Ti","isNewUser","rawUserInfo","profile","login","screenName","Yi","Vi","LOCAL","NONE","SESSION","Wi","Xi","S","Zi","$i","addListener","removeListener","aj","bj","setInterval","oldValue","newValue","clearInterval","cj","j","dj","ej","fj","gj","hj","ij","jj","kj","lj","mj","nj","ibi","apn","appDisplayName","oj","handleOpenURL","pj","qj","rj","sj","tj","xj","uj","vj","unknown","signInViaRedirect","linkViaRedirect","reauthViaRedirect","signInViaPopup","linkViaPopup","reauthViaPopup","Z","wj","Aj","yj","zj","subscribe","unsubscribe","Bj","Cj","getRedirectResult","Dj","Ej","Fj","Gj","Hj","user","Ij","Jj","refreshToken","expirationTime","Lj","Kj","expiresIn","Mj","expires_in","Nj","lastSignInTime","creationTime","lastLoginAt","createdAt","Oj","uid","photoURL","Pj","appName","authDomain","Qj","Rj","Sj","languageCode","Tj","Uj","Vj","Wj","getIdToken","Xj","Yj","Zj","ak","bk","emailVerified","metadata","providerData","ck","dk","ek","gk","fk","hk","copy","reload","ik","jk","warn","kk","users","localId","lk","passwordHash","providerUserInfo","rawId","reauthenticateAndRetrieveDataWithCredential","mk","reauthenticateWithCredential","nk","linkAndRetrieveDataWithCredential","ok","linkWithCredential","linkWithPhoneNumber","reauthenticateWithPhoneNumber","additionalUserInfo","operationType","updatePhoneNumber","unlink","linkWithPopup","pk","reauthenticateWithPopup","qk","linkWithRedirect","rk","reauthenticateWithRedirect","sk","tk","uk","stsTokenManager","redirectEventId","vk","wk","xk","yk","Ak","zk","Bk","Ck","Dk","setPersistence","Ek","Fk","Gk","Hk","Ik","Jk","Kk","Lk","logFramework","Mk","Nk","Ok","useDeviceLanguage","languages","language","userLanguage","currentUser","Pk","Qk","signInWithPopup","signInWithRedirect","signOut","Rk","Sk","Tk","onIdTokenChanged","onAuthStateChanged","signInWithCustomToken","signInWithEmailAndPassword","createUserWithEmailAndPassword","signInWithCredential","signInAndRetrieveDataWithCredential","Uk","_lat","fetchProvidersForEmail","verifyPasswordResetCode","signInWithPhoneNumber","Wk","optional","W","Vk","V","Xk","Yk","Zk","$k","al","bl","App","cl","el","fl","gl","Persistence","Auth","User","@firebase/app","registerDatabase","instance","unused","RepoManager_1","RepoManager","getInstance","databaseFromApp","Reference","Reference_1","Query","Query_1","Database","Database_1","enableLogging","ServerValue","TEST_ACCESS","isNodeSdk","app_1","./src/api/Database","./src/api/Query","./src/api/Reference","./src/api/internal","./src/api/test_access","./src/core/RepoManager","./src/core/util/util","5","validation_1","Path_1","PriorityIndex_1","DataSnapshot","node_","ref_","index_","val","validateArgCount","exportVal","exists","isEmpty","childPathString","validatePathString","childPath","Path","childRef","getChild","PRIORITY_INDEX","hasChild","getPriority","action","validateCallback","isLeafNode","forEachChild","hasChildren","getKey","numChildren","getRef","../core/snap/indexes/PriorityIndex","../core/util/Path","../core/util/validation","6","parser_1","Repo_1","repo_","Repo","fatal","root_","Empty","DatabaseInternals","ref","pathString","checkDeleted_","refFromURL","apiName","parsedURL","parseRepoInfo","validateUrl","repoInfo","repoInfo_","goOffline","interrupt","goOnline","resume","TIMESTAMP",".sv","database","deleteRepo","../core/Repo","../core/RepoManager","../core/util/libs/parser","../core/util/util","./Reference","7","__referenceConstructor","KeyIndex_1","ValueIndex_1","PathIndex_1","util_3","EventRegistration_1","util_4","repo","queryParams_","orderByCalled_","assert","validateQueryEndpoints_","params","startNode","endNode","hasStart","getIndexStartValue","hasEnd","getIndexEndValue","getIndex","KEY_INDEX","tooManyArgsError","wrongArgTypeError","getIndexStartName","MIN_NAME","getIndexEndName","MAX_NAME","isValidPriority","PathIndex","VALUE_INDEX","validateLimit_","hasLimit","hasAnchoredLimit","validateNoPreviousOrderByCall_","fnName","getQueryParams","on","eventType","cancelCallbackOrContext","validateEventType","ret","getCancelAndContextArgs_","onValueEvent","callbacks","onChildEvent","cancelCallback","container","ValueEventRegistration","addEventCallbackForQuery","ChildEventRegistration","off","validateContextObject","valueCallback","removeEventCallbackForQuery","userCallback","cancelOrContext","firstCall","deferred","Deferred","promise","catch","onceCallback","snapshot","err","reject","limitToFirst","limit","limitToLast","orderByChild","parsedPath","index","newParams","orderBy","orderByKey","orderByPriority","orderByValue","startAt","validateFirebaseDataArg","validateKey","endAt","equalTo","toUrlEncodedString","queryObject","getQueryObject","queryIdentifier","ObjectToUniqueKey","isEqual","other","sameRepo","samePath","equals","sameQueryIdentifier","errorPrefix","../core/snap/indexes/KeyIndex","../core/snap/indexes/PathIndex","../core/snap/indexes/ValueIndex","../core/view/EventRegistration","8","__extends","extendStatics","setPrototypeOf","__proto__","__","onDisconnect_1","TransactionResult_1","NextPushId_1","QueryParams_1","SyncPoint_1","_super","QueryParams","DEFAULT","getBack","getFront","validateRootPathString","parentPath","parent","getRoot","databaseProp","newVal","onComplete","validateWritablePath","setWithPriority","wrapCallback","objectToMerge","isArray","newObjectToMerge","validateFirebaseMergeDataArg","newPriority","validatePriority","transactionUpdate","applyLocally","validateBoolean","startTransaction","committed","TransactionResult","setPriority","priority","serverTime","nextPushId","thennablePushRef","pushRef","onDisconnect","OnDisconnect","SyncPoint","../core/SyncPoint","../core/util/NextPushId","../core/view/QueryParams","./Query","./TransactionResult","./onDisconnect","9","10","WebSocketConnection_1","BrowserPollConnection_1","forceLongPolling","WebSocketConnection","forceDisallow","BrowserPollConnection","forceAllow","forceWebSockets","isWebSocketsAvailable","setSecurityDebugCallback","persistentConnection_","securityDebugCallback_","stats","showDelta","statsIncrementCounter","metric","dataUpdateCount","interceptServerData","interceptServerData_","../realtime/BrowserPollConnection","../realtime/WebSocketConnection","11","path_","onDisconnectCancel","onDisconnectSet","onDisconnectSetWithPriority","onDisconnectUpdate","12","RepoInfo_1","PersistentConnection_1","Connection_1","DataConnection","PersistentConnection","simpleListen","sendRequest","echo","onEcho","RealTimeConnection","Connection","hijackHash","newHash","oldPut","opt_onComplete","opt_hash","ConnectionTarget","RepoInfo","query","listens","firebaseRef","listens_","forceRestClient","../core/PersistentConnection","../core/RepoInfo","../realtime/Connection","13","AuthTokenProvider","app_","forceRefresh","addTokenChangeListener","removeTokenChangeListener","notifyForInvalidToken","./util/util","14","ImmutableTree_1","Node_1","CompoundWrite","writeTree_","addWrite","ImmutableTree","rootmost","findRootMostValueAndPath","rootMostPath","relativePath","updateChild","subtree","setTree","addWrites","updates","newWrite","childKey","removeWrite","hasCompleteWrite","getCompleteNode","getCompleteChildren","children","childName","childNode","NamedNode","inorderTraversal","childTree","childCompoundWrite","shadowingNode","applySubtreeWrite_","writeTree","priorityWrite_1","./snap/Node","./snap/indexes/PriorityIndex","./util/ImmutableTree","./util/Path","15","VisibilityMonitor_1","OnlineMonitor_1","util_5","util_6","util_7","RECONNECT_MIN_DELAY","RECONNECT_MAX_DELAY_DEFAULT","onDataUpdate_","onConnectStatus_","onServerInfoUpdate_","authTokenProvider_","authOverride_","nextPersistentConnectionId_","log_","logWrapper","interruptReasons_","outstandingPuts_","outstandingPutCount_","onDisconnectRequestQueue_","connected_","reconnectDelay_","maxReconnectDelay_","lastSessionId","establishConnectionTimer_","visible_","requestCBHash_","requestNumber_","realtime_","authToken_","forceTokenRefresh_","invalidAuthTokenCount_","firstConnection_","lastConnectionAttemptTime_","lastConnectionEstablishedTime_","scheduleConnect_","VisibilityMonitor","onVisible_","OnlineMonitor","onOnline_","onResponse","curReqNum","msg","currentHashFn","tag","queryId","isDefault","loadsAllData","listenSpec","hashFn","sendListen_","req","payload","warnOnListenWarnings_","removeListen_","warnings","safeGet","indexSpec","indexPath","refreshAuthToken","tryAuth","reduceReconnectDelayIfAdminCredential_","isAdmin","token_1","authMethod","isValidFormat","requestData","cred","res","onAuthRevoked_","unlisten","sendUnlisten_","queryObj","onDisconnectPut","sendOnDisconnect_","onDisconnectMerge","hash","putInternal","merge","sendPut_","queued","reportStats","errorReason","onDataMessage_","reqNum","onDataPush_","onListenRevoked_","onSecurityDebugPacket_","onReady_","timestamp","handleTimestamp_","sendConnectStats_","restoreState_","establishConnection_","visible","online","onRealtimeDisconnect_","cancelSentTransactions_","shouldReconnect_","timeSinceLastConnectAttempt","reconnectDelay","min","onDataMessage_1","onReady_1","connId_1","nextConnectionId_","self_1","lastSessionId_1","canceled_1","connection_1","closeFn_1","CONSTANTS","NODE_ADMIN","delta","serverTimeOffset","normalizedPathString","getCount","statusCode","explanation","queries","clientName","NODE_CLIENT","isMobileCordova","isReactNative","currentlyOnline","ServerActions","./ServerActions","./util/OnlineMonitor","./util/VisibilityMonitor","16","ReadonlyRestClient","getListenId_","listenId","thisListen","queryStringParamaters","toRestQueryStringParameters","restRequest_","queryStringParameters","authTokenData","authToken","secure","querystring","xhr","jsonEval","17","ServerValues_1","nodeFromJSON_1","SparseSnapshotTree_1","SyncTree_1","SnapshotHolder_1","AuthTokenProvider_1","StatsManager_1","StatsReporter_1","StatsListener_1","EventQueue_1","ReadonlyRestClient_1","statsListener_","eventQueue_","EventQueue","nextWriteId_","interceptServerDataCallback_","onDisconnect_","SparseSnapshotTree","authTokenProvider","stats_","StatsManager","getCollection","beingCrawled","server_","authOverride","statsReporter_","getOrCreateReporter","StatsReporter","transactions_init_","infoData_","SnapshotHolder","infoSyncTree_","SyncTree","startListening","infoEvents","getNode","applyServerOverwrite","stopListening","updateInfo_","serverSyncTree_","events","raiseEventsForChangedPath","offset","generateServerValues","generateWithValues","isMerge","taggedChildren","raw","nodeFromJSON","applyTaggedQueryMerge","taggedSnap","applyTaggedQueryOverwrite","changedChildren","applyServerMerge","snap","affectedPath","rerunTransactions_","connectStatus","runOnDisconnectEvents_","each","newNode","updateSnapshot","getNextWriteId_","serverValues","newNodeUnresolved","resolveDeferredValueSnapshot","writeId","applyUserOverwrite","queueEvents","success","clearEvents","ackUserWrite","callOnCompleteCallback","abortTransactions_","childrenToMerge","empty","changedKey","changedValue","writeId_1","applyUserMerge","changedPath","resolveDeferredValueTree","forEachTree","forget","remember","newChildNode","eventRegistration","addEventRegistration","raiseEventsAtPath","removeEventRegistration","StatsListener","longestName","reduce","previousValue","currentValue","stat","incrementCounter","includeStat","var_args","prefix","exceptionGuard","__database","../api/Database","./AuthTokenProvider","./PersistentConnection","./ReadonlyRestClient","./SnapshotHolder","./SparseSnapshotTree","./SyncTree","./snap/nodeFromJSON","./stats/StatsListener","./stats/StatsManager","./stats/StatsReporter","./util/ServerValues","./view/EventQueue","18","storage_1","Constants_1","webSocketOnly","persistenceKey","domain","internalHost","PersistentStorage","needsQueryParam","isCacheableHost","isDemoHost","isCustomHost","updateHost","newHost","connectionURL","connURL","WEBSOCKET","LONG_POLLING","pairs","str","toURLString","../realtime/Constants","./storage/storage","19","_staticInstance","repos_","useRestClient_","dbUrl","parsedUrl","createRepo","appRepos","./Repo","./Repo_transaction","./util/libs/parser","./util/validation","20","TransactionStatus","DataSnapshot_1","Tree_1","ChildrenNode_1","MAX_TRANSACTION_RETRIES_","transactionQueueTree_","Tree","watchRef","order","LUIDGenerator","retryCount","unwatcher","abortReason","currentWriteId","currentInputSnapshot","currentOutputSnapshotRaw","currentOutputSnapshotResolved","currentState","getLatestState_","validateFirebaseData","RUN","queueNode","subTree","nodeQueue","getValue","setValue","priorityForNode","calcCompleteEventCache","ChildrenNode","EMPTY_NODE","sendReadyTransactions_","excludeSets","pruneCompletedTransactionsBelowNode_","queue","buildTransactionQueue_","every","sendTransactionQueue_","setsToIgnore","txn","latestState","snapToSend","latestHash","SENT","dataToSend","pathToSend","COMPLETED","SENT_NEEDS_ABORT","NEEDS_ABORT","rootMostTransactionNode","getAncestorTransactionNode_","rerunTransactionQueue_","abortTransaction","currentNode","newData","newDataNode","updatePriority","oldWriteId","newNodeResolved","lastInput","front","transactionNode","popFront","transactionQueue","aggregateTransactionQueuesForNode_","to","from","forEachAncestor","abortTransactionsOnNode_","forEachDescendant","lastSent","../api/DataSnapshot","../api/Reference","./snap/ChildrenNode","./util/Tree","21","22","rootNode_","newSnapshotNode","23","CountedSet_1","value_","children_","find","CountedSet","tree","prefixPath","func","./util/CountedSet","24","CacheNode_1","ViewCache_1","View_1","views_","applyOperation","writesCache","optCompleteServerCache","source","view","events_1","serverCache","serverCacheComplete","eventCache","eventCacheComplete","calcCompleteEventChildren","viewCache","ViewCache","CacheNode","View","getInitialEvents","cancelError","removed","cancelEvents","hadCompleteView","hasCompleteView","viewQueryId","getQuery","getQueryViews","getCompleteServerCache","viewForQuery","getCompleteView","viewExistsForQuery","findValue","./view/CacheNode","./view/View","./view/ViewCache","25","AckUserWrite_1","ListenComplete_1","Merge_1","Operation_1","Overwrite_1","WriteTree_1","listenProvider_","syncPointTree_","pendingWriteTree_","WriteTree","tagToQueryMap_","queryToTagMap_","addOverwrite","applyOperationToSyncPoints_","Overwrite","OperationSource","addMerge","changeTree","fromObject","Merge","revert","getWrite","affectedTree_1","AckUserWrite","Server","applyListenComplete","ListenComplete","queryKey","queryKeyForTag_","parseQueryKey_","queryPath","op","forServerTaggedQuery","applyTaggedOperation_","applyTaggedListenComplete","foundAncestorDefaultView","foreachOnPath","pathToSyncPoint","sp","syncPoint","foreachChild","childSyncPoint","completeCache","updateImmediateChild","viewAlreadyExists","makeQueryKey_","getNextQueryTag_","childWrites","setupListener_","maybeSyncPoint","removedAndEvents","removingDefault","findIndex","covered","findOnPath","parentSyncPoint","newViews","collectDistinctViewsForSubTree_","newQuery","createListenerForView_","queryForListening_","tagForQuery_","queryToRemove","tagToRemove","removeTags_","writeIdsToExclude","pathSoFar","fold","maybeChildSyncPoint","childMap","views_1","childViews","removedQuery","removedQueryKey","removedQueryTag","queriesToStop","queries_1","childQueries","queryToStop","getServerCache","errorForServerCode","splitIndex","nextQueryTag_","applyOperationHelper_","syncPointTree","applyOperationDescendantsHelper_","childOperation","operationForChild","childServerCache","getImmediateChild","childWritesCache","./SyncPoint","./WriteTree","./operation/AckUserWrite","./operation/ListenComplete","./operation/Merge","./operation/Operation","./operation/Overwrite","26","CompoundWrite_1","visibleWrites_","allWrites_","lastWriteId_","WriteTreeRef","record","idx","writeToRemove","removedWriteWasVisible","removedWriteOverlapsWithOtherWrites","currentWrite","recordContainsPath_","resetTree_","getCompleteWriteData","treePath","completeServerCache","includeHiddenWrites","mergeAtPath","layerTree_","layeredCache","subMerge","completeServerChildren","completeChildren","topLevelSet","childSnap","merge_1","namedNode","calcEventCacheAfterServerOverwrite","existingEventSnap","existingServerSnap","childMerge","calcCompleteChild","isCompleteForChild","shadowingWrite","calcIndexedSlice","completeServerData","startPost","count","reverse","toIterate","withIndex","nodes","cmp","getCompare","iter","getReverseIteratorFrom","getIteratorFrom","getNext","writeRecord","findKey","DefaultFilter_","writes","treeRoot","compoundWrite","writePath","assertionError","deepNode","treePath_","existingServerCache","./CompoundWrite","27","affectedTree","OperationType","ACK_USER_WRITE","../util/Path","./Operation","28","LISTEN_COMPLETE","29","MERGE","./Overwrite","30","fromUser","fromServer","tagged","31","OVERWRITE","32","SortedMap_1","snap_1","IndexMap_1","LeafNode_1","comparators_1","priorityNode_","indexMap_","lazyHash_","validatePriorityNode","SortedMap","NAME_COMPARATOR","IndexMap","Default","newPriorityNode","newChildren","newIndexMap","removeFromIndexes","insert","addToIndexes","getLength","newImmediateChild","exportFormat","numKeys","maxKey","allIntegerKeys","INTEGER_REGEXP_","array","toHash_1","priorityHashText","childHash","sha1","getPredecessorChildName","resolveIndex_","predecessor","getPredecessorKey","getFirstChildName","indexDefinition","minKey","getFirstChild","getLastChildName","getLastChild","wrappedNode","getIterator","minPost","iterator","Wrap","peek","compare","getReverseIterator","maxPost","endPost","compareTo","MAX_NODE","hasIndex","addIndex","isIndexed","otherChildrenNode","thisIter","otherIter","thisCurrent","otherCurrent","MaxNode","defineProperties","MIN","MAX","KeyIndex","__EMPTY_NODE","LeafNode","__childrenNodeConstructor","setMaxNode","../util/SortedMap","../util/util","./IndexMap","./LeafNode","./Node","./comparators","./indexes/KeyIndex","./indexes/PriorityIndex","./snap","33","_defaultIndexMap","childSet_1","fallbackObject","indexes_","indexSet_",".priority","indexKey","sortedMap","existingChildren","childList","sawIndexedValue","isDefinedOn","newIndex","buildChildSet","indexName","newIndexSet","newIndexes","indexedChildren","existingSnap","./childSet","34",".value","toHash","doubleToIEEE754String","compareToLeafNode_","otherLeaf","otherLeafType","thisLeafType","otherIndex","VALUE_TYPE_ORDER","thisIndex","35","36","SortedMap_2","LOG_2","Base12Num","num","logBase2","current_","mask","bits","bitMask","bits_","nextBitIsOne","keyFn","mapSortFn","buildBalancedTree","low","high","LLRBNode","BLACK","middle","right","root","base12","buildPennant","chunkSize","color","attachPennant","pennant","isOne","pow","RED","buildFrom12Array","37","NAME_ONLY_COMPARATOR","nameCompare","38","Index","indexedValueChanged","oldNode","oldWrapped","newWrapped","../../util/util","../Node","39","Index_1","makePost","indexValue","./Index","40","indexPath_","extractChild","aChild","bChild","indexCmp","valueNode","../ChildrenNode","../nodeFromJSON","41","setNodeFromJSON","PriorityIndex","aPriority","bPriority","priorityNode","../LeafNode","42","ValueIndex","43","json","jsonLeaf","USE_HINZE","node_1","jsonObj_1","childData","children_1","childrenHavePriority_1","hinzeJsonObj_1","childSet","sortedChildSet","./ChildrenNode","44","45","StatsCollection","counters_","amount","46","collection_","last_","newStats","47","StatsCollection_1","hashString","collections_","creatorFunction","reporters_","./StatsCollection","48","FIRST_STATS_MIN_TIME","FIRST_STATS_MAX_TIME","collection","statsToReport_","setTimeoutNonBlocking","reportStats_","reportedStats","haveStatsToReport","./StatsListener","49","DOMStorageWrapper","domStorage_","prefix_","prefixedName_","storedVal","50","MemoryStorage","cache_","isInMemoryStorage","51","DOMStorageWrapper_1","MemoryStorage_1","createStoragefor","domStorageName","domStorage","SessionStorage","./DOMStorageWrapper","./MemoryStorage","52","fn","53","EventEmitter","allowedEvents_","listeners_","trigger","listeners","validateEventType_","eventData","getInitialEvent","et","54","emptyChildrenSingleton","EmptyChildren","stringCompare","findRootMostMatchingPathAndValue","predicate","childExistingPathAndValue","toSet","newChild","newTree","fold_","accum","findOnPath_","pathToFollow","nextChild","foreachOnPath_","currentRelativePath","foreach","foreach_","./Path","./SortedMap","./util","55","PUSH_CHARS","lastPushTime","lastRandChars","duplicateTime","timeStampChars","56","EventEmitter_1","online_","./EventEmitter","57","pathOrString","pieceNum","pieces_","copyTo","pieceNum_","begin","pieces","childPathObj","childPieces","outerPath","innerPath","outer","inner","comparePaths","leftKeys","rightKeys","ValidationPath","errorPrefix_","parts_","byteLength_","stringLength","checkValid_","last","MAX_PATH_LENGTH_BYTES","MAX_PATH_DEPTH","toErrorString","58","values","resolveDeferredValue","resolvedTree","rawPri","leafNode","childrenNode","../SparseSnapshotTree","../snap/LeafNode","../snap/indexes/PriorityIndex","../snap/nodeFromJSON","59","SortedMapIterator","startKey","comparator","isReverse_","resultGenerator_","nodeStack_","hasNext","reverseTraversal","min_","fixUp_","removeMin_","isRed_","moveRedLeft_","smallest","rotateRight_","moveRedRight_","rotateLeft_","colorFlip_","nl","nr","checkMaxDepth_","blackDepth","check_","LLRBEmptyNode","comparator_","rightParent","resultGenerator","60","TreeNode","childCount","parent_","pathObj","updateParents_","includeSelf","childrenFirst","forEachImmediateDescendantWithValue","updateChild_","childEmpty","childExists","61","hidden","visibilityChange","62","decodePath","pathStringDecoded","piece","dataURL","parseURL","subdomain","warnIfPageIsSecure","scheme","port","colonInd","slashInd","parts","../../RepoInfo","../Path","../util","63","utf8Bytes","stringToByteArray","Sha1","sha1Bytes","base64","encodeByteArray","buildLogMessage_","logger","firstLog_","logger_","persistent","warnAboutUnsupportedMethod","methodName","isInvalidJSONNumber","POSITIVE_INFINITY","NEGATIVE_INFINITY","executeWhenDOMReady","called_1","wrappedFn_1","aAsInt","tryParseInt","bAsInt","requireKey","splitStringBySize","segsize","len","dataSegs","bindCallback","ln","abs","LN2","round","hexByteString","hexByte","isChromeExtensionContentScript","isWindowsStoreApp","Windows","UI","intVal","callUserCallback","search","exportPropGetter","object","fnGet","time","../storage/storage","64","INVALID_KEY_REGEX_","INVALID_PATH_REGEX_","MAX_LEAF_SIZE_","isValidKey","isValidPathString","isValidRootPathString","argumentNumber","hasDotValue_1","hasActualChild_1","validateFirebaseMergePaths","mergePaths","curPath","prevPath","validateCredential","bool","validateString","string","validateObject","validateObjectContainsKey","opt_type","65","fullyInitialized_","filtered_","isFullyInitialized","isFiltered","isCompleteForPath","66","Change","snapshotNode","oldSnap","prevName","valueChange","VALUE","childAddedChange","CHILD_ADDED","childRemovedChange","CHILD_REMOVED","childChangedChange","newSnapshot","oldSnapshot","CHILD_CHANGED","childMovedChange","CHILD_MOVED","67","Change_1","ChildChangeAccumulator","changeMap_","trackChildChange","change","oldChange","oldType","getChanges","getValues","./Change","68","NoCompleteChildSource_","getCompleteChild","getChildAfterChild","NO_COMPLETE_CHILD_SOURCE","WriteTreeCompleteChildSource","writes_","viewCache_","optCompleteServerCache_","getEventCache","serverNode","getCompleteServerSnap","./CacheNode","69","DataEvent","getPath","getEventType","getEventRunner","CancelEvent","70","EventGenerator","query_","generateEventsForChanges","changes","eventRegistrations","moves","generateEventsForType_","registrations","filteredChanges","compareChanges_","materializedChange","materializeSingleChange_","registration","respondsTo","aWrapped","bWrapped","../snap/Node","71","eventLists_","recursionDepth_","eventDataList","currList","eventPath","EventList","raiseQueuedEventsMatchingPredicate_","sentAll","eventList","raise","events_","eventFn","72","Event_1","callback_","cancelCallback_","context_","ctx","cancelCB_1","cb_1","createCancelEvent","matches","hasAnyCallback","callbacks_","eventToCheck","cancelCB_2","cb_2","otherCount","otherKey","getAnyKey","thisKey","../../api/DataSnapshot","./Event","73","IndexedFilter_1","LimitedFilter_1","RangedFilter_1","limitSet_","startSet_","startNameSet_","endSet_","endNameSet_","limit_","viewFrom_","indexStartValue_","indexStartName_","indexEndValue_","indexEndName_","isViewFromLeft","WIRE_PROTOCOL_CONSTANTS_","VIEW_FROM_LEFT","getLimit","copy_","newLimit","VIEW_FROM_RIGHT","WIRE_PROTOCOL_CONSTANTS","INDEX_START_VALUE","INDEX_START_NAME","INDEX_END_VALUE","INDEX_END_NAME","LIMIT","viewFrom","VIEW_FROM","INDEX","getNodeFilter","IndexedFilter","LimitedFilter","RangedFilter","REST_CONSTANTS","REST_QUERY_CONSTANTS_","qs","ORDER_BY","START_AT","END_AT","LIMIT_TO_FIRST","LIMIT_TO_LAST","../snap/indexes/KeyIndex","../snap/indexes/PathIndex","../snap/indexes/ValueIndex","./filter/IndexedFilter","./filter/LimitedFilter","./filter/RangedFilter","74","ViewProcessor_1","EventGenerator_1","initialViewCache","eventRegistrations_","indexFilter","processor_","ViewProcessor","initialServerCache","initialEventCache","serverSnap","updateFullNode","eventSnap","newServerCache","filtersNodes","newEventCache","eventGenerator_","cache","path_1","maybeEvent","remaining","existing","getCompleteEventSnap","oldViewCache","assertIndexed","generateEventsForChanges_","initialChanges","../operation/Operation","../snap/ChildrenNode","./EventGenerator","./ViewCache","./ViewProcessor","75","eventCache_","serverCache_","updateEventSnap","complete","filtered","updateServerSnap","76","ChildChangeAccumulator_1","CompleteChildSource_1","ProcessorResult","filter_","newViewCache","filterServerNode","accumulator","overwrite","applyUserOverwrite_","applyServerOverwrite_","applyUserMerge_","applyServerMerge_","revertUserWrite_","ackUserWrite_","listenComplete_","maybeAddValueEvent_","isLeafOrEmpty","oldCompleteSnap","generateEventCacheAfterServerEvent_","changePath","oldEventSnap","completeEventChildren","completeNode","oldEventNode","updatedPriority","childChangePath","newEventChild","eventChildUpdate","changedSnap","oldServerSnap","serverFilter","getIndexedFilter","newServerNode","oldChild","newEventSnap","cacheHasChild_","curViewCache","applyMerge_","viewMergeTree","serverChild","childMergeTree","isUnknownDeepMerge","ackPath","changedChildren_1","changedChildren_2","mergePath","serverCachePath","oldServerNode","oldEventCache","serverChildren","../util/ImmutableTree","./ChildChangeAccumulator","./CompleteChildSource","77","optChangeAccumulator","newSnap","../../snap/ChildrenNode","../../snap/indexes/PriorityIndex","../Change","78","rangedFilter_","reverse_","fullLimitUpdateChild_","getEndPost","getStartPost","indexCompare_1","foundStartPost","changeAccumulator","indexCmp_1","newChildNamedNode","windowBoundary","inRange","oldChildSnap","compareNext","../../snap/Node","./RangedFilter","79","indexedFilter_","startPost_","getStartPost_","endPost_","getEndPost_","startName","endName","../../../core/snap/Node","./IndexedFilter","80","PacketReceiver_1","FIREBASE_LONGPOLL_START_PARAM","FIREBASE_LONGPOLL_CLOSE_COMMAND","FIREBASE_LONGPOLL_COMMAND_CB_NAME","FIREBASE_LONGPOLL_DATA_CB_NAME","FIREBASE_LONGPOLL_ID_PARAM","FIREBASE_LONGPOLL_PW_PARAM","FIREBASE_LONGPOLL_SERIAL_PARAM","FIREBASE_LONGPOLL_CALLBACK_ID_PARAM","FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM","FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET","FIREBASE_LONGPOLL_DATA_PARAM","FIREBASE_LONGPOLL_DISCONN_FRAME_PARAM","FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM","connId","transportSessionId","bytesSent","bytesReceived","everConnected_","urlFn","onMessage","curSegmentNum","myPacketOrderer","PacketReceiver","isClosed_","connectTimeoutTimer_","onClosed_","scriptTagHolder","FirebaseIFrameScriptHolder","command","arg1","arg2","incrementIncomingBytes_","sendNewPolls","closeAfter","pN","handleResponse","urlParams","uniqueCallbackIdentifier","VERSION_PARAM","PROTOCOL_VERSION","TRANSPORT_SESSION_PARAM","LAST_SESSION_PARAM","FORGE_DOMAIN","REFERER_PARAM","FORGE_REF","connectURL","addTag","startLongPoll","addDisconnectPingFrame","forceAllow_","forceDisallow_","isAvailable","markConnectionHealthy","shutdown_","myDisconnFrame","dataStr","base64data","base64Encode","MAX_URL_DATA_SIZE","enqueueSegment","pw","commandCB","onMessageCB","outstandingRequests","pendingSegs","currentSerial","myIFrame","createIFrame_","script","iframeContents","doc","iframe","contentDocument","alive","innerHTML","myID","myPW","theURL","nodeRestRequest","newRequest_","curDataString","theSeg","seg","ts","addLongPollTag_","segnum","totalsegs","serial","doNewRequest","keepaliveTimeout","loadCB","doNodeLongPoll","newScript_1","async","rstate","../core/stats/StatsManager","../core/util/CountedSet","./Constants","./polling/PacketReceiver","81","TransportManager_1","onMessage_","onKill_","connectionCount","pendingDataMessages","state_","transportManager_","TransportManager","start_","conn","initialTransport","conn_","nextTransportId_","primaryResponsesRequired_","onMessageReceived","connReceiver_","onConnectionLost","disconnReceiver_","tx_","rx_","secondaryConn_","isHealthy_","healthyTimeout_ms","healthyTimeout_","everConnected","onConnectionLost_","onSecondaryConnectionLost_","onPrimaryMessageReceived_","onSecondaryMessageReceived_","dataMsg","sendData_","tryCleanupConnection","onSecondaryControl_","controlData","cmd","upgradeIfSecondaryHealthy_","secondaryResponsesRequired_","parsedData","layer","proceedWithUpgrade_","onControl_","onPrimaryResponse_","onHandshake_","onConnectionShutdown_","onReset_","sendPingOnPrimaryIfNecessary_","handshake","version","onConnectionEstablished_","tryStartUpgrade_","upgradeTransport","startUpgrade_","closeConnections_","../core/storage/storage","./TransportManager","82","83","initTransports_","isSkipPollConnection","previouslyFailed","transports_","transports_1","ALL_TRANSPORTS","transport","./BrowserPollConnection","./WebSocketConnection","84","process","WebSocketImpl","MozWebSocket","WebSocket","setWebSocketImpl","impl","keepaliveTimer","frames","totalFrames","connectionURL_","device","User-Agent","platform","env","proxy","mySock","onopen","onclose","handleIncomingFrame","isOldAndroid","oldAndroidMatch","appendFrame_","fullMess","jsonMess","handleNewFrameCount_","frameCount","extractFrameCount_","mess","resetKeepAlive","remainingData","sendString_","responsesRequiredToBeHealthy","healthyTimeout","_process","85","pendingResponses","currentResponseNum","closeAfterResponse","onClose","responseNum","requestNum","this_1","toProcess","_loop_2","_loop_1","../../core/util/util","86","registerMessaging","namespaceExports","Messaging","window_controller_1","sw_controller_1","./src/controllers/sw-controller","./src/controllers/window-controller","87","errors_1","token_manager_1","notification_permission_1","SENDER_ID_OPTION_NAME","ControllerInterface","errorFactory_","codes","BAD_SENDER_ID","messagingSenderId_","tokenManager_","currentPermission","getNotificationPermission_","granted","denied","NOTIFICATIONS_BLOCKED","getSWRegistration_","getSavedToken","createToken","deleteToken","pushManager","getSubscription","subscription","SHOULD_BE_INHERITED","requestPermission","AVAILABLE_IN_WINDOW","useServiceWorker","nextOrObserver","optError","optCompleted","onTokenRefresh","setBackgroundMessageHandler","AVAILABLE_IN_SW","closeDatabase","Notification","permission","getTokenManager","../models/errors","../models/notification-permission","../models/token-manager","88","controller_interface_1","worker_page_message_1","fcm_details_1","SWController","onPush_","onSubChange_","onNotificationClick_","bgMessageHandler_","event","msgPayload","handleMsgPromise","hasVisibleClients_","hasVisibleClients","notification","sendMessageToWindowClients_","notificationDetails","getNotificationData_","notificationTitle","title","showNotification","waitUntil","promiseChain","NO_FCM_TOKEN_FOR_RESUBSCRIBE","tokenDetails","tokenManager","getTokenDetailsFromToken","details","INVALID_SAVED_TOKEN","SUBSCRIPTION_OPTIONS","newSubscription","subscribeToFCM","fcmSenderId","fcmPushSet","fcmToken","UNABLE_TO_RESUBSCRIBE","stopImmediatePropagation","clickAction","getWindowClient_","windowClient","clients","openWindow","internalMsg","createNewMsg","TYPES_OF_MSG","NOTIFICATION_CLICKED","attemptToMessageClient_","notificationInformation","assign","_a","BG_HANDLER_FUNCTION_EXPECTED","URL","matchAll","includeUncontrolled","clientList","suitableClient","NO_WINDOW_CLIENT_TO_MSG","PUSH_MSG_RECEIVED","../models/fcm-details","../models/worker-page-message","./controller-interface","89","default_sw_1","WindowController","registrationToUse_","manifestCheckPromise_","messageObserver_","observer","tokenRefreshObserver_","onTokenRefresh_","setupSWMessageListener_","isSupported_","manifestCheck_","UNSUPPORTED_BROWSER","manifestTag","querySelector","fetch","manifestContent","INCORRECT_GCM_SENDER_ID","managePermissionResult","PERMISSION_BLOCKED","PERMISSION_DEFAULT","permissionPromise","ServiceWorkerRegistration","SW_REGISTRATION_EXPECTED","USE_SW_BEFORE_GET_TOKEN","waitForRegistrationToActivate_","serviceWorker","installing","waiting","active","stateChangeListener","SW_REG_REDUNDANT","NO_SW_IN_REG","FAILED_DEFAULT_REGISTRATION","browserErrorMessage","PARAMS","TYPE_OF_MSG","workerPageMessage","pushMessage","DATA","PushSubscription","../models/default-sw","90","toBase64","arrayBuffer","uint8Version","btoa","91","92","CODES","GET_SUBSCRIPTION_FAILED","TOKEN_SUBSCRIBE_FAILED","TOKEN_SUBSCRIBE_NO_TOKEN","TOKEN_SUBSCRIBE_NO_PUSH_SET","INVALID_DELETE_TOKEN","DELETE_TOKEN_NOT_FOUND","DELETE_SCOPE_NOT_FOUND","FAILED_TO_DELETE_TOKEN","BAD_SCOPE","BAD_VAPID_KEY","BAD_SUBSCRIPTION","BAD_TOKEN","BAD_PUSH_SET","FAILED_DELETE_VAPID_KEY","ERROR_MAP","93","FCM_APPLICATION_SERVER_KEY","SUBSCRIPTION_DETAILS","userVisibleOnly","applicationServerKey","ENDPOINT","APPLICATION_SERVER_KEY","94","95","array_buffer_to_base64_1","FCM_TOKEN_OBJ_STORE","TokenManager","openDbPromise_","openDatabase_","DB_NAME","createIndex","unique","getTokenDetailsFromSWScope_","swScope","scopeRequest","getAllTokenDetailsForSenderId_","senderId","senderIdTokens","cursorRequest","cursor","continue","pushSet","p256dh","fcmSubscribeBody","Headers","append","subscribeOptions","fcmTokenResponse","isSameSubscription_","masterTokenDetails","saveTokenDetails_","swRegistration","allTokenDetails","fcmTokenDetails","../helpers/array-buffer-to-base64","./errors","./fcm-details","96","msgType","msgData","97","./src/polyfills/promise","./src/shims/find","./src/shims/findIndex","98","__global","promise-polyfill","99","thisArg","kValue","100","101","factory","opt_url","service_1","Service","xhriopool_1","XhrIoPool","registerStorage","TaskState","taskenums_2","TaskEvent","taskenums_1","StringFormat","string_1","Storage","reference_1","STORAGE_TYPE","./src/implementation/string","./src/implementation/taskenums","./src/implementation/xhriopool","./src/reference","./src/service","102","and_","v1","v2","errorsExports","MetadataUtils","validate","specs","passed","minArgs","maxArgs","invalidArgumentCount","validator","invalidArgument","ArgSpec","opt_optional","isJustDef","stringSpec","opt_validator","stringValidator","isString","uploadDataSpec","ArrayBuffer","isNativeBlobDefined","Blob","metadataSpec","metadataValidator","nonNegativeNumberSpec","isNumber","looseObjectSpec","isDef","nullFunctionSpec","isFunction","./error","./metadata","./type","103","elem","arraylike","104","promiseimpl","argsToForward","./promise_external","105","constants","failrequest_1","location_1","requestmap_1","AuthWrapper","maker","requestMaker","pool","bucket_","deleted_","extractBucket_","storageRefMaker_","requestMaker_","pool_","service_","maxOperationRetryTime_","defaultMaxOperationRetryTime","maxUploadRetryTime_","defaultMaxUploadRetryTime","requestMap_","RequestMap","bucketString","configOption","makeFromBucketSpec","bucket","getAuthToken","_error","appDeleted","makeStorageReference","loc","makeRequest","requestInfo","FailRequest","addRequest","deleteApp","maxUploadRetryTime","setMaxUploadRetryTime","maxOperationRetryTime","setMaxOperationRetryTime","./constants","./failrequest","./location","./requestmap","106","canceled","cancelState","triggerCallback","triggeredCallback","callWithDelay","millis","timeoutId","handler","hitTimeout","waitSeconds","waitMillis","wasTimeout","stopped","107","fs","FbsBlob","opt_elideCopy","blobType","isNativeBlob","data_","byteLength","size_","type_","startByte","endByte","realBlob","sliced","sliceBlob","buffer","getBlob","blobby","uint8Arrays","dataFromString","RAW","finalLength_1","merged_1","index_1","uploadData","./fs","./string","108","domainBase","downloadBase","apiBaseUrl","apiUploadBaseUrl","setDomainBase","shortMaxOperationRetryTime","minSafeInteger","109","prependCode","constants_1","FirebaseStorageError","code_","message_","serverResponse_","codeProp","codeEquals","serverResponseProp","setServerResponseProp","serverResponse","Code","UNKNOWN","OBJECT_NOT_FOUND","BUCKET_NOT_FOUND","PROJECT_NOT_FOUND","UNAUTHENTICATED","UNAUTHORIZED","RETRY_LIMIT_EXCEEDED","INVALID_CHECKSUM","CANCELED","INVALID_EVENT_NAME","INVALID_URL","INVALID_DEFAULT_BUCKET","NO_DEFAULT_BUCKET","CANNOT_SLICE_BLOB","SERVER_FILE_WRONG_SIZE","NO_DOWNLOAD_URL","INVALID_ARGUMENT","INVALID_ARGUMENT_COUNT","APP_DELETED","INVALID_ROOT_OPERATION","INVALID_FORMAT","INTERNAL_ERROR","objectNotFound","bucketNotFound","projectNotFound","project","quotaExceeded","unauthenticated","unauthorized","retryLimitExceeded","invalidChecksum","checksum","calculated","invalidEventName","invalidUrl","invalidDefaultBucket","noDefaultBucket","cannotSliceBlob","serverFileWrongSize","noDownloadURL","argMin","argMax","real","countPart","plural","invalidRootOperation","invalidFormat","format","internalError","110","promise_","getPromise","appDelete","111","getBlobBuilder","BlobBuilder","WebKitBlobBuilder","blob","end","webkitSlice","mozSlice","112","jsonObjectOrNull","isNonArrayObject","113","fullServerUrl","encode","bucketOnlyServerUrl","bucketLocation","makeFromUrl","groups","regex","indices","postModify","group","captures","bucketValue","pathValue","114","noXform_","xformPath","fullPath","lastComponent","addRef","authWrapper","fromResource","resource","mappings","mapping","local","xform","server","UrlUtils","Mapping","opt_local","opt_writable","opt_xform","writable","mappings_","getMappings","nameMapping","sizeMapping","tokens","urlPart","makeDownloadUrl","makeQueryString","alt","fromResourceString","resourceString","toResourceString","isObject","isNonNullObject","./json","./path","./url","115","prop","116","Observer","opt_error","opt_complete","117","canonicalChildPath","component","118","make","resolver","119","addAuthHeader_","addVersionHeader_","number","backoff","XhrIoExports","NetworkRequest","successCodes","additionalRetryCodes","errorCallback","progressCallback","pendingXhr_","backoffId_","resolve_","reject_","canceled_","appDelete_","url_","method_","headers_","body_","successCodes_","additionalRetryCodes_","errorCallback_","progressCallback_","timeout_","backoffDone","requestWentThrough","wasSuccessCode","getResponseText","RequestEndStatus","backoffCallback","progressListener","progressEvent","createXhrIo","addUploadProgressListener","removeUploadProgressListener","hitServer","getErrorCode","ErrorCode","NO_ERROR","getStatus","isRetryStatusCode_","successCode","wasCanceled","ABORT","isFiveHundredCode","isExtraRetryCode","isRequestSpecificRetryCode","opt_canceled","queryPart","errorHandler","./array","./backoff","./object","./xhrio","120","RequestInfo","121","map_","id_","unmap","122","handlerCheck","cndn","metadataHandler","text","sharedErrorHandler","newErr","objectErrorHandler","shared","determineContentType_","metadataForUpload_","opt_metadata","checkResumeHeader_","opt_allowed","allowed","blob_1","requestinfo_1","getMetadata","makeNormalUrl","updateMetadata","deleteObject","multipartUpload","X-Goog-Upload-Protocol","boundary","genBoundary","preBlobPart","postBlobPart","makeUploadUrl","ResumableUploadStatus","current","finalized","createResumableUpload","X-Goog-Upload-Command","X-Goog-Upload-Header-Content-Length","X-Goog-Upload-Header-Content-Type","getResumableUploadStatus","sizeString","resumableUploadChunkSize","continueResumableUpload","opt_status","opt_progressCallback","bytesLeft","bytesToUpload","X-Goog-Upload-Offset","uploadStatus","newCurrent","./blob","./requestinfo","123","utf8Bytes_","percentEncodedBytes_","decoded","DATA_URL","base64Bytes_","BASE64","hasMinus","hasUnder","invalidChar","BASE64URL","hasPlus","hasSlash","bytes","atob","dataURLBytes_","DataURLParts","rest","dataURLContentType_","endsWith","formatValidator","stringFormat","StringData","opt_contentType","124","STATE_CHANGED","InternalTaskState","RUNNING","PAUSING","PAUSED","SUCCESS","CANCELING","ERROR","taskStateFromInternalTaskState","125","126","nextPart","127","128","NetworkXhrIo","sent_","xhr_","errorCode_","sendPromise_","NETWORK_ERROR","opt_body","opt_headers","header","129","xhrio_network_1","./xhrio_network","130","requests","fbsString","task_1","newRef","newPath","throwIfRoot_","UploadTask","putString","getDownloadURL","./implementation/args","./implementation/blob","./implementation/error","./implementation/location","./implementation/metadata","./implementation/object","./implementation/path","./implementation/requests","./implementation/string","./implementation/type","./task","131","authwrapper_1","fbsPromiseImpl","RequestExports","authWrapper_","authWrapperBucket","internals_","ServiceInternals","./implementation/authwrapper","./implementation/promise_external","./implementation/request","./reference","132","observer_1","tasksnapshot_1","fbsArgs","fbsArray","async_1","fbsPromiseimpl","fbsRequests","fbsTaskEnums","typeUtils","transferred_","needToFetchStatus_","needToFetchMetadata_","observers_","error_","uploadUrl_","request_","chunkMultiplier_","location_","blob_","metadata_","resumable_","shouldDoResumable_","errorHandler_","completeTransitions_","transition_","metadataErrorHandler_","makeProgressCallback_","sizeBefore","updateProgress_","createResumable_","fetchStatus_","fetchMetadata_","continueUpload_","oneShotUpload_","resolveToken_","createRequest","statusRequest","uploadRequest","newStatus","increaseMultiplier_","metadataRequest","multipartRequest","transferred","old","notifyObservers_","wasPaused","externalState","UploadTaskSnapshot","completed","nextOrObserverValidator","nextValidator","observerValidator","nextOrObserverMessage","makeBinder","addObserver_","removeObserver_","_p","binderSpecs","onFulfilled","onRejected","notifyObserver_","finishPromise_","triggered","toCall","valid","pause","./implementation/array","./implementation/async","./implementation/observer","./implementation/taskenums","./tasksnapshot","133","bytesTransferred","totalBytes","task","urls","134","__export","./src/assert","./src/constants","./src/crypt","./src/deepCopy","./src/deferred","./src/environment","./src/errors","./src/json","./src/jwt","./src/obj","./src/query","./src/sha1","./src/subscribe","./src/utf8","./src/validation","135","assertion","136","137","output","byteArrayToString","chunk","byteToCharMap_","charToByteMap_","byteToCharMapWebSafe_","charToByteMapWebSafe_","ENCODED_VALS_BASE","ENCODED_VALS","ENCODED_VALS_WEBSAFE","HAS_NATIVE_SUPPORT","input","opt_webSafe","init_","byteToCharMap","byte1","haveByte2","byte2","haveByte3","byte3","outByte1","outByte2","outByte3","outByte4","encodeString","decodeString","decodeStringToByteArray","charToByteMap","byte4","base64Decode","138","dateValue","139","140","getUA","141","ERROR_NAME","patchCapture","captureFake","FirebaseError","err_1","pattern","template","fullCode","142","Hash","blockSize","143","144","crypt_1","json_1","decode","claims","signature","isValidTimestamp","validSince","validUntil","issuedAtTime","./crypt","145","objTo","objFrom","rv","opt_obj","opt_this","146","obj_1","querystringParams","arrayVal","querystringDecode","./obj","147","chain_","buf_","W_","pad_","inbuf_","total_","compress_","buf","opt_offset","opt_length","lengthMinusBlock","inbuf","totalBits","./hash","148","implementsAnyMethods","methods","methods_1","noop","executor","onNoObservers","ObserverProxy","observers","unsubscribes","observerCount","forEachObserver","unsub","unsubscribeOne","finalError","sendOne","onError","149","assert_1","out","./assert","150","argName","minCount","maxCount","argCount","argError","validateNamespace","151","@firebase/polyfill","152","@firebase/auth","153","@firebase/database","154","./app","./auth","./database","./messaging","./storage","155","@firebase/messaging","156","@firebase/storage","157","defaultSetTimout","defaultClearTimeout","runTimeout","fun","cachedSetTimeout","runClearTimeout","marker","cachedClearTimeout","cleanUpNextTick","draining","currentQueue","queueIndex","drainQueue","run","Item","nextTick","browser","argv","versions","removeAllListeners","emit","prependListener","prependOnceListener","binding","cwd","chdir","dir","umask","158","_state","_handled","_value","_deferreds","doResolve","handle","_immediateFn","finale","_unhandledRejectionFn","Handler","done","ex","setTimeoutFunc","prom","arr","race","_setImmediateFn","_setUnhandledRejectionFn","159","databaseURL","projectId","storageBucket","messagingSenderId","160","getTeamData","inMap","sims","first","teamid","trips","revenue","sim","_teamid","step","inRev","rev","lyft","taxi","plotMain","datasets","line","label","borderColor","PINK","fill","cubicInterpolationMode","_loop","getContext","Chart","responsive","maintainAspectRatio","legend","scales","xAxes","yAxes","elements","point","radius","GAME","game","gameid","onResults","./config"],"mappings":"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","file":"../main.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar firebaseApp_1 = require(\"./src/firebaseApp\");\nexports.firebase = firebaseApp_1.createFirebaseNamespace();\nexports.default = exports.firebase;\n\n\n\n\n},{\"./src/firebaseApp\":2}],2:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar util_1 = require(\"@firebase/util\");\nvar util_2 = require(\"@firebase/util\");\nvar contains = function (obj, key) {\n    return Object.prototype.hasOwnProperty.call(obj, key);\n};\nvar DEFAULT_ENTRY_NAME = '[DEFAULT]';\n// An array to capture listeners before the true auth functions\n// exist\nvar tokenListeners = [];\n/**\n * Global context object for a collection of services using\n * a shared authentication state.\n */\nvar FirebaseAppImpl = /** @class */ (function () {\n    function FirebaseAppImpl(options, name, firebase_) {\n        this.firebase_ = firebase_;\n        this.isDeleted_ = false;\n        this.services_ = {};\n        this.name_ = name;\n        this.options_ = util_2.deepCopy(options);\n        this.INTERNAL = {\n            getUid: function () { return null; },\n            getToken: function () { return Promise.resolve(null); },\n            addAuthTokenListener: function (callback) {\n                tokenListeners.push(callback);\n                // Make sure callback is called, asynchronously, in the absence of the auth module\n                setTimeout(function () { return callback(null); }, 0);\n            },\n            removeAuthTokenListener: function (callback) {\n                tokenListeners = tokenListeners.filter(function (listener) { return listener !== callback; });\n            }\n        };\n    }\n    Object.defineProperty(FirebaseAppImpl.prototype, \"name\", {\n        get: function () {\n            this.checkDestroyed_();\n            return this.name_;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(FirebaseAppImpl.prototype, \"options\", {\n        get: function () {\n            this.checkDestroyed_();\n            return this.options_;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    FirebaseAppImpl.prototype.delete = function () {\n        var _this = this;\n        return new Promise(function (resolve) {\n            _this.checkDestroyed_();\n            resolve();\n        })\n            .then(function () {\n            _this.firebase_.INTERNAL.removeApp(_this.name_);\n            var services = [];\n            Object.keys(_this.services_).forEach(function (serviceKey) {\n                Object.keys(_this.services_[serviceKey]).forEach(function (instanceKey) {\n                    services.push(_this.services_[serviceKey][instanceKey]);\n                });\n            });\n            return Promise.all(services.map(function (service) {\n                return service.INTERNAL.delete();\n            }));\n        })\n            .then(function () {\n            _this.isDeleted_ = true;\n            _this.services_ = {};\n        });\n    };\n    /**\n     * Return a service instance associated with this app (creating it\n     * on demand), identified by the passed instanceIdentifier.\n     *\n     * NOTE: Currently storage is the only one that is leveraging this\n     * functionality. They invoke it by calling:\n     *\n     * ```javascript\n     * firebase.app().storage('STORAGE BUCKET ID')\n     * ```\n     *\n     * The service name is passed to this already\n     * @internal\n     */\n    FirebaseAppImpl.prototype._getService = function (name, instanceIdentifier) {\n        if (instanceIdentifier === void 0) { instanceIdentifier = DEFAULT_ENTRY_NAME; }\n        this.checkDestroyed_();\n        if (!this.services_[name]) {\n            this.services_[name] = {};\n        }\n        if (!this.services_[name][instanceIdentifier]) {\n            /**\n             * If a custom instance has been defined (i.e. not '[DEFAULT]')\n             * then we will pass that instance on, otherwise we pass `null`\n             */\n            var instanceSpecifier = instanceIdentifier !== DEFAULT_ENTRY_NAME\n                ? instanceIdentifier\n                : undefined;\n            var service = this.firebase_.INTERNAL.factories[name](this, this.extendApp.bind(this), instanceSpecifier);\n            this.services_[name][instanceIdentifier] = service;\n        }\n        return this.services_[name][instanceIdentifier];\n    };\n    /**\n     * Callback function used to extend an App instance at the time\n     * of service instance creation.\n     */\n    FirebaseAppImpl.prototype.extendApp = function (props) {\n        var _this = this;\n        // Copy the object onto the FirebaseAppImpl prototype\n        util_2.deepExtend(this, props);\n        /**\n         * If the app has overwritten the addAuthTokenListener stub, forward\n         * the active token listeners on to the true fxn.\n         *\n         * TODO: This function is required due to our current module\n         * structure. Once we are able to rely strictly upon a single module\n         * implementation, this code should be refactored and Auth should\n         * provide these stubs and the upgrade logic\n         */\n        if (props.INTERNAL && props.INTERNAL.addAuthTokenListener) {\n            tokenListeners.forEach(function (listener) {\n                _this.INTERNAL.addAuthTokenListener(listener);\n            });\n            tokenListeners = [];\n        }\n    };\n    /**\n     * This function will throw an Error if the App has already been deleted -\n     * use before performing API actions on the App.\n     */\n    FirebaseAppImpl.prototype.checkDestroyed_ = function () {\n        if (this.isDeleted_) {\n            error('app-deleted', { name: this.name_ });\n        }\n    };\n    return FirebaseAppImpl;\n}());\n// Prevent dead-code elimination of these methods w/o invalid property\n// copying.\n(FirebaseAppImpl.prototype.name && FirebaseAppImpl.prototype.options) ||\n    FirebaseAppImpl.prototype.delete ||\n    console.log('dc');\n/**\n * Return a firebase namespace object.\n *\n * In production, this will be called exactly once and the result\n * assigned to the 'firebase' global.  It may be called multiple times\n * in unit tests.\n */\nfunction createFirebaseNamespace() {\n    var apps_ = {};\n    var factories = {};\n    var appHooks = {};\n    // A namespace is a plain JavaScript Object.\n    var namespace = {\n        // Hack to prevent Babel from modifying the object returned\n        // as the firebase namespace.\n        __esModule: true,\n        initializeApp: initializeApp,\n        app: app,\n        apps: null,\n        Promise: Promise,\n        SDK_VERSION: '4.5.2',\n        INTERNAL: {\n            registerService: registerService,\n            createFirebaseNamespace: createFirebaseNamespace,\n            extendNamespace: extendNamespace,\n            createSubscribe: util_1.createSubscribe,\n            ErrorFactory: util_2.ErrorFactory,\n            removeApp: removeApp,\n            factories: factories,\n            useAsService: useAsService,\n            Promise: Promise,\n            deepExtend: util_2.deepExtend\n        }\n    };\n    // Inject a circular default export to allow Babel users who were previously\n    // using:\n    //\n    //   import firebase from 'firebase';\n    //   which becomes: var firebase = require('firebase').default;\n    //\n    // instead of\n    //\n    //   import * as firebase from 'firebase';\n    //   which becomes: var firebase = require('firebase');\n    util_2.patchProperty(namespace, 'default', namespace);\n    // firebase.apps is a read-only getter.\n    Object.defineProperty(namespace, 'apps', {\n        get: getApps\n    });\n    /**\n     * Called by App.delete() - but before any services associated with the App\n     * are deleted.\n     */\n    function removeApp(name) {\n        var app = apps_[name];\n        callAppHooks(app, 'delete');\n        delete apps_[name];\n    }\n    /**\n     * Get the App object for a given name (or DEFAULT).\n     */\n    function app(name) {\n        name = name || DEFAULT_ENTRY_NAME;\n        if (!contains(apps_, name)) {\n            error('no-app', { name: name });\n        }\n        return apps_[name];\n    }\n    util_2.patchProperty(app, 'App', FirebaseAppImpl);\n    /**\n     * Create a new App instance (name must be unique).\n     */\n    function initializeApp(options, name) {\n        if (name === undefined) {\n            name = DEFAULT_ENTRY_NAME;\n        }\n        else {\n            if (typeof name !== 'string' || name === '') {\n                error('bad-app-name', { name: name + '' });\n            }\n        }\n        if (contains(apps_, name)) {\n            error('duplicate-app', { name: name });\n        }\n        var app = new FirebaseAppImpl(options, name, namespace);\n        apps_[name] = app;\n        callAppHooks(app, 'create');\n        return app;\n    }\n    /*\n     * Return an array of all the non-deleted FirebaseApps.\n     */\n    function getApps() {\n        // Make a copy so caller cannot mutate the apps list.\n        return Object.keys(apps_).map(function (name) { return apps_[name]; });\n    }\n    /*\n     * Register a Firebase Service.\n     *\n     * firebase.INTERNAL.registerService()\n     *\n     * TODO: Implement serviceProperties.\n     */\n    function registerService(name, createService, serviceProperties, appHook, allowMultipleInstances) {\n        // Cannot re-register a service that already exists\n        if (factories[name]) {\n            error('duplicate-service', { name: name });\n        }\n        // Capture the service factory for later service instantiation\n        factories[name] = createService;\n        // Capture the appHook, if passed\n        if (appHook) {\n            appHooks[name] = appHook;\n            // Run the **new** app hook on all existing apps\n            getApps().forEach(function (app) {\n                appHook('create', app);\n            });\n        }\n        // The Service namespace is an accessor function ...\n        var serviceNamespace = function (appArg) {\n            if (appArg === void 0) { appArg = app(); }\n            if (typeof appArg[name] !== 'function') {\n                // Invalid argument.\n                // This happens in the following case: firebase.storage('gs:/')\n                error('invalid-app-argument', { name: name });\n            }\n            // Forward service instance lookup to the FirebaseApp.\n            return appArg[name]();\n        };\n        // ... and a container for service-level properties.\n        if (serviceProperties !== undefined) {\n            util_2.deepExtend(serviceNamespace, serviceProperties);\n        }\n        // Monkey-patch the serviceNamespace onto the firebase namespace\n        namespace[name] = serviceNamespace;\n        // Patch the FirebaseAppImpl prototype\n        FirebaseAppImpl.prototype[name] = function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            var serviceFxn = this._getService.bind(this, name);\n            return serviceFxn.apply(this, allowMultipleInstances ? args : []);\n        };\n        return serviceNamespace;\n    }\n    /**\n     * Patch the top-level firebase namespace with additional properties.\n     *\n     * firebase.INTERNAL.extendNamespace()\n     */\n    function extendNamespace(props) {\n        util_2.deepExtend(namespace, props);\n    }\n    function callAppHooks(app, eventName) {\n        Object.keys(factories).forEach(function (serviceName) {\n            // Ignore virtual services\n            var factoryName = useAsService(app, serviceName);\n            if (factoryName === null) {\n                return;\n            }\n            if (appHooks[factoryName]) {\n                appHooks[factoryName](eventName, app);\n            }\n        });\n    }\n    // Map the requested service to a registered service name\n    // (used to map auth to serverAuth service when needed).\n    function useAsService(app, name) {\n        if (name === 'serverAuth') {\n            return null;\n        }\n        var useService = name;\n        var options = app.options;\n        return useService;\n    }\n    return namespace;\n}\nexports.createFirebaseNamespace = createFirebaseNamespace;\nfunction error(code, args) {\n    throw appErrors.create(code, args);\n}\n// TypeScript does not support non-string indexes!\n// let errors: {[code: AppError: string} = {\nvar errors = {\n    'no-app': \"No Firebase App '{$name}' has been created - \" +\n        'call Firebase App.initializeApp()',\n    'bad-app-name': \"Illegal App name: '{$name}\",\n    'duplicate-app': \"Firebase App named '{$name}' already exists\",\n    'app-deleted': \"Firebase App named '{$name}' already deleted\",\n    'duplicate-service': \"Firebase service named '{$name}' already registered\",\n    'sa-not-supported': 'Initializing the Firebase SDK with a service ' +\n        'account is only allowed in a Node.js environment. On client ' +\n        'devices, you should instead initialize the SDK with an api key and ' +\n        'auth domain',\n    'invalid-app-argument': 'firebase.{$name}() takes either no argument or a ' +\n        'Firebase App instance.'\n};\nvar appErrors = new util_2.ErrorFactory('app', 'Firebase', errors);\n\n\n\n\n},{\"@firebase/util\":134}],3:[function(require,module,exports){\n(function (global){\nvar firebase = require('@firebase/app').default; (function(){/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function(){var h,aa=aa||{},k=this,ba=function(a){return void 0!==a},m=function(a){return\"string\"==typeof a},ca=function(a){return\"boolean\"==typeof a},da=function(){},ea=function(a){var b=typeof a;if(\"object\"==b)if(a){if(a instanceof Array)return\"array\";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if(\"[object Window]\"==c)return\"object\";if(\"[object Array]\"==c||\"number\"==typeof a.length&&\"undefined\"!=typeof a.splice&&\"undefined\"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable(\"splice\"))return\"array\";\nif(\"[object Function]\"==c||\"undefined\"!=typeof a.call&&\"undefined\"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable(\"call\"))return\"function\"}else return\"null\";else if(\"function\"==b&&\"undefined\"==typeof a.call)return\"object\";return b},fa=function(a){return null===a},ha=function(a){return\"array\"==ea(a)},ia=function(a){var b=ea(a);return\"array\"==b||\"object\"==b&&\"number\"==typeof a.length},p=function(a){return\"function\"==ea(a)},q=function(a){var b=typeof a;return\"object\"==b&&null!=a||\"function\"==\nb},ja=function(a,b,c){return a.call.apply(a.bind,arguments)},ka=function(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}},r=function(a,b,c){r=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf(\"native code\")?ja:ka;return r.apply(null,arguments)},la=function(a,b){var c=\nArray.prototype.slice.call(arguments,1);return function(){var b=c.slice();b.push.apply(b,arguments);return a.apply(this,b)}},ma=Date.now||function(){return+new Date},t=function(a,b){function c(){}c.prototype=b.prototype;a.Uc=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Og=function(a,c,f){for(var d=Array(arguments.length-2),e=2;e<arguments.length;e++)d[e-2]=arguments[e];return b.prototype[c].apply(a,d)}};var u=function(a){if(Error.captureStackTrace)Error.captureStackTrace(this,u);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))};t(u,Error);u.prototype.name=\"CustomError\";var na=function(a,b){for(var c=a.split(\"%s\"),d=\"\",e=Array.prototype.slice.call(arguments,1);e.length&&1<c.length;)d+=c.shift()+e.shift();return d+c.join(\"%s\")},oa=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^[\\s\\xa0]+|[\\s\\xa0]+$/g,\"\")},wa=function(a){if(!pa.test(a))return a;-1!=a.indexOf(\"&\")&&(a=a.replace(qa,\"&amp;\"));-1!=a.indexOf(\"<\")&&(a=a.replace(ra,\"&lt;\"));-1!=a.indexOf(\">\")&&(a=a.replace(sa,\"&gt;\"));-1!=a.indexOf('\"')&&(a=a.replace(ta,\"&quot;\"));-1!=a.indexOf(\"'\")&&\n(a=a.replace(ua,\"&#39;\"));-1!=a.indexOf(\"\\x00\")&&(a=a.replace(va,\"&#0;\"));return a},qa=/&/g,ra=/</g,sa=/>/g,ta=/\"/g,ua=/'/g,va=/\\x00/g,pa=/[\\x00&<>\"']/,v=function(a,b){return-1!=a.indexOf(b)},xa=function(a,b){return a<b?-1:a>b?1:0};var ya=function(a,b){b.unshift(a);u.call(this,na.apply(null,b));b.shift()};t(ya,u);ya.prototype.name=\"AssertionError\";\nvar za=function(a,b,c,d){var e=\"Assertion failed\";if(c){e+=\": \"+c;var f=d}else a&&(e+=\": \"+a,f=b);throw new ya(\"\"+e,f||[]);},w=function(a,b,c){a||za(\"\",null,b,Array.prototype.slice.call(arguments,2));return a},Aa=function(a,b){throw new ya(\"Failure\"+(a?\": \"+a:\"\"),Array.prototype.slice.call(arguments,1));},Ba=function(a,b,c){\"number\"==typeof a||za(\"Expected number but got %s: %s.\",[ea(a),a],b,Array.prototype.slice.call(arguments,2));return a},Ca=function(a,b,c){m(a)||za(\"Expected string but got %s: %s.\",\n[ea(a),a],b,Array.prototype.slice.call(arguments,2))},Da=function(a,b,c){p(a)||za(\"Expected function but got %s: %s.\",[ea(a),a],b,Array.prototype.slice.call(arguments,2))};var Fa=function(){this.Tc=\"\";this.kf=Ea};Fa.prototype.qb=!0;Fa.prototype.ob=function(){return this.Tc};Fa.prototype.toString=function(){return\"Const{\"+this.Tc+\"}\"};var Ga=function(a){if(a instanceof Fa&&a.constructor===Fa&&a.kf===Ea)return a.Tc;Aa(\"expected object of type Const, got '\"+a+\"'\");return\"type_error:Const\"},Ea={},Ha=function(a){var b=new Fa;b.Tc=a;return b};Ha(\"\");var Ja=function(){this.Lc=\"\";this.lf=Ia};Ja.prototype.qb=!0;Ja.prototype.ob=function(){return this.Lc};Ja.prototype.toString=function(){return\"TrustedResourceUrl{\"+this.Lc+\"}\"};\nvar Ka=function(a){if(a instanceof Ja&&a.constructor===Ja&&a.lf===Ia)return a.Lc;Aa(\"expected object of type TrustedResourceUrl, got '\"+a+\"' of type \"+ea(a));return\"type_error:TrustedResourceUrl\"},Oa=function(a,b){var c=Ga(a);if(!La.test(c))throw Error(\"Invalid TrustedResourceUrl format: \"+c);a=c.replace(Ma,function(a,e){if(!Object.prototype.hasOwnProperty.call(b,e))throw Error('Found marker, \"'+e+'\", in format string, \"'+c+'\", but no valid label mapping found in args: '+JSON.stringify(b));a=b[e];\nreturn a instanceof Fa?Ga(a):encodeURIComponent(String(a))});return Na(a)},Ma=/%{(\\w+)}/g,La=/^(?:https:)?\\/\\/[0-9a-z.:[\\]-]+\\/|^\\/[^\\/\\\\]|^about:blank(#|$)/i,Ia={},Na=function(a){var b=new Ja;b.Lc=a;return b};var Pa=Array.prototype.indexOf?function(a,b,c){w(null!=a.length);return Array.prototype.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(m(a))return m(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},x=Array.prototype.forEach?function(a,b,c){w(null!=a.length);Array.prototype.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=m(a)?a.split(\"\"):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},Qa=function(a,b){for(var c=m(a)?\na.split(\"\"):a,d=a.length-1;0<=d;--d)d in c&&b.call(void 0,c[d],d,a)},Ra=Array.prototype.map?function(a,b,c){w(null!=a.length);return Array.prototype.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=m(a)?a.split(\"\"):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},Sa=Array.prototype.some?function(a,b,c){w(null!=a.length);return Array.prototype.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=m(a)?a.split(\"\"):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return!0;return!1},\nUa=function(a){a:{var b=Ta;for(var c=a.length,d=m(a)?a.split(\"\"):a,e=0;e<c;e++)if(e in d&&b.call(void 0,d[e],e,a)){b=e;break a}b=-1}return 0>b?null:m(a)?a.charAt(b):a[b]},Va=function(a,b){return 0<=Pa(a,b)},Xa=function(a,b){b=Pa(a,b);var c;(c=0<=b)&&Wa(a,b);return c},Wa=function(a,b){w(null!=a.length);return 1==Array.prototype.splice.call(a,b,1).length},Ya=function(a,b){var c=0;Qa(a,function(d,e){b.call(void 0,d,e,a)&&Wa(a,e)&&c++})},Za=function(a){return Array.prototype.concat.apply([],arguments)},\n$a=function(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]};var ab=function(a){return Ra(a,function(a){a=a.toString(16);return 1<a.length?a:\"0\"+a}).join(\"\")};var bb;a:{var cb=k.navigator;if(cb){var db=cb.userAgent;if(db){bb=db;break a}}bb=\"\"}var y=function(a){return v(bb,a)};var eb=function(a,b){for(var c in a)b.call(void 0,a[c],c,a)},fb=function(a,b){for(var c in a)if(b.call(void 0,a[c],c,a))return!0;return!1},gb=function(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b},hb=function(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b},ib=function(a){for(var b in a)return!1;return!0},jb=function(a,b){for(var c in a)if(!(c in b)||a[c]!==b[c])return!1;for(c in b)if(!(c in a))return!1;return!0},kb=function(a){var b={},c;for(c in a)b[c]=a[c];return b},lb=\"constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf\".split(\" \"),\nmb=function(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<lb.length;f++)c=lb[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var nb=function(a){nb[\" \"](a);return a};nb[\" \"]=da;var pb=function(a,b){var c=ob;return Object.prototype.hasOwnProperty.call(c,a)?c[a]:c[a]=b(a)};var qb=y(\"Opera\"),z=y(\"Trident\")||y(\"MSIE\"),rb=y(\"Edge\"),sb=rb||z,tb=y(\"Gecko\")&&!(v(bb.toLowerCase(),\"webkit\")&&!y(\"Edge\"))&&!(y(\"Trident\")||y(\"MSIE\"))&&!y(\"Edge\"),ub=v(bb.toLowerCase(),\"webkit\")&&!y(\"Edge\"),vb=function(){var a=k.document;return a?a.documentMode:void 0},wb;\na:{var xb=\"\",yb=function(){var a=bb;if(tb)return/rv:([^\\);]+)(\\)|;)/.exec(a);if(rb)return/Edge\\/([\\d\\.]+)/.exec(a);if(z)return/\\b(?:MSIE|rv)[: ]([^\\);]+)(\\)|;)/.exec(a);if(ub)return/WebKit\\/(\\S+)/.exec(a);if(qb)return/(?:Version)[ \\/]?(\\S+)/.exec(a)}();yb&&(xb=yb?yb[1]:\"\");if(z){var Ab=vb();if(null!=Ab&&Ab>parseFloat(xb)){wb=String(Ab);break a}}wb=xb}\nvar Bb=wb,ob={},A=function(a){return pb(a,function(){for(var b=0,c=oa(String(Bb)).split(\".\"),d=oa(String(a)).split(\".\"),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||\"\",l=d[f]||\"\";do{g=/(\\d*)(\\D*)(.*)/.exec(g)||[\"\",\"\",\"\",\"\"];l=/(\\d*)(\\D*)(.*)/.exec(l)||[\"\",\"\",\"\",\"\"];if(0==g[0].length&&0==l[0].length)break;b=xa(0==g[1].length?0:parseInt(g[1],10),0==l[1].length?0:parseInt(l[1],10))||xa(0==g[2].length,0==l[2].length)||xa(g[2],l[2]);g=g[3];l=l[3]}while(0==b)}return 0<=b})},Cb;var Db=k.document;\nCb=Db&&z?vb()||(\"CSS1Compat\"==Db.compatMode?parseInt(Bb,10):5):void 0;var Eb=null,Fb=null,Hb=function(a){var b=\"\";Gb(a,function(a){b+=String.fromCharCode(a)});return b},Gb=function(a,b){function c(b){for(;d<a.length;){var c=a.charAt(d++),e=Fb[c];if(null!=e)return e;if(!/^[\\s\\xa0]*$/.test(c))throw Error(\"Unknown base64 encoding at char: \"+c);}return b}Ib();for(var d=0;;){var e=c(-1),f=c(0),g=c(64),l=c(64);if(64===l&&-1===e)break;b(e<<2|f>>4);64!=g&&(b(f<<4&240|g>>2),64!=l&&b(g<<6&192|l))}},Ib=function(){if(!Eb){Eb={};Fb={};for(var a=0;65>a;a++)Eb[a]=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\".charAt(a),\nFb[Eb[a]]=a,62<=a&&(Fb[\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.\".charAt(a)]=a)}};var Jb=function(){this.Da=-1};var Mb=function(a,b){this.Da=-1;this.Da=64;this.qc=k.Uint8Array?new Uint8Array(this.Da):Array(this.Da);this.Xc=this.rb=0;this.l=[];this.bg=a;this.Fe=b;this.Cg=k.Int32Array?new Int32Array(64):Array(64);ba(Kb)||(Kb=k.Int32Array?new Int32Array(Lb):Lb);this.reset()},Kb;t(Mb,Jb);for(var Nb=[],Ob=0;63>Ob;Ob++)Nb[Ob]=0;var Pb=Za(128,Nb);Mb.prototype.reset=function(){this.Xc=this.rb=0;this.l=k.Int32Array?new Int32Array(this.Fe):$a(this.Fe)};\nvar Qb=function(a){var b=a.qc;w(b.length==a.Da);for(var c=a.Cg,d=0,e=0;e<b.length;)c[d++]=b[e]<<24|b[e+1]<<16|b[e+2]<<8|b[e+3],e=4*d;for(b=16;64>b;b++){e=c[b-15]|0;d=c[b-2]|0;var f=(c[b-16]|0)+((e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3)|0,g=(c[b-7]|0)+((d>>>17|d<<15)^(d>>>19|d<<13)^d>>>10)|0;c[b]=f+g|0}d=a.l[0]|0;e=a.l[1]|0;var l=a.l[2]|0,n=a.l[3]|0,F=a.l[4]|0,zb=a.l[5]|0,ic=a.l[6]|0;f=a.l[7]|0;for(b=0;64>b;b++){var yi=((d>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10))+(d&e^d&l^e&l)|0;g=F&zb^~F&ic;f=f+((F>>>\n6|F<<26)^(F>>>11|F<<21)^(F>>>25|F<<7))|0;g=g+(Kb[b]|0)|0;g=f+(g+(c[b]|0)|0)|0;f=ic;ic=zb;zb=F;F=n+g|0;n=l;l=e;e=d;d=g+yi|0}a.l[0]=a.l[0]+d|0;a.l[1]=a.l[1]+e|0;a.l[2]=a.l[2]+l|0;a.l[3]=a.l[3]+n|0;a.l[4]=a.l[4]+F|0;a.l[5]=a.l[5]+zb|0;a.l[6]=a.l[6]+ic|0;a.l[7]=a.l[7]+f|0};\nMb.prototype.update=function(a,b){ba(b)||(b=a.length);var c=0,d=this.rb;if(m(a))for(;c<b;)this.qc[d++]=a.charCodeAt(c++),d==this.Da&&(Qb(this),d=0);else if(ia(a))for(;c<b;){var e=a[c++];if(!(\"number\"==typeof e&&0<=e&&255>=e&&e==(e|0)))throw Error(\"message must be a byte array\");this.qc[d++]=e;d==this.Da&&(Qb(this),d=0)}else throw Error(\"message must be string or array\");this.rb=d;this.Xc+=b};\nMb.prototype.digest=function(){var a=[],b=8*this.Xc;56>this.rb?this.update(Pb,56-this.rb):this.update(Pb,this.Da-(this.rb-56));for(var c=63;56<=c;c--)this.qc[c]=b&255,b/=256;Qb(this);for(c=b=0;c<this.bg;c++)for(var d=24;0<=d;d-=8)a[b++]=this.l[c]>>d&255;return a};\nvar Lb=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,\n4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];var Sb=function(){Mb.call(this,8,Rb)};t(Sb,Mb);var Rb=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];var Tb=Object.freeze||function(a){return a};var Ub=function(){this.Ma=this.Ma;this.Ic=this.Ic};Ub.prototype.Ma=!1;Ub.prototype.isDisposed=function(){return this.Ma};Ub.prototype.lb=function(){if(this.Ic)for(;this.Ic.length;)this.Ic.shift()()};var Vb=!z||9<=Number(Cb),Wb=z&&!A(\"9\");!ub||A(\"528\");tb&&A(\"1.9b\")||z&&A(\"8\")||qb&&A(\"9.5\")||ub&&A(\"528\");tb&&!A(\"8\")||z&&A(\"9\");var Xb=function(){if(!k.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},\"passive\",{get:function(){a=!0}});k.addEventListener(\"test\",da,b);k.removeEventListener(\"test\",da,b);return a}();var B=function(a,b){this.type=a;this.currentTarget=this.target=b;this.defaultPrevented=this.Wa=!1;this.Ue=!0};B.prototype.stopPropagation=function(){this.Wa=!0};B.prototype.preventDefault=function(){this.defaultPrevented=!0;this.Ue=!1};var Yb=function(a,b){B.call(this,a?a.type:\"\");this.relatedTarget=this.currentTarget=this.target=null;this.button=this.screenY=this.screenX=this.clientY=this.clientX=this.offsetY=this.offsetX=0;this.key=\"\";this.charCode=this.keyCode=0;this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.state=null;this.pointerId=0;this.pointerType=\"\";this.R=null;a&&this.init(a,b)};t(Yb,B);var Zb=Tb({2:\"touch\",3:\"pen\",4:\"mouse\"});\nYb.prototype.init=function(a,b){var c=this.type=a.type,d=a.changedTouches?a.changedTouches[0]:null;this.target=a.target||a.srcElement;this.currentTarget=b;if(b=a.relatedTarget){if(tb){a:{try{nb(b.nodeName);var e=!0;break a}catch(f){}e=!1}e||(b=null)}}else\"mouseover\"==c?b=a.fromElement:\"mouseout\"==c&&(b=a.toElement);this.relatedTarget=b;null===d?(this.offsetX=ub||void 0!==a.offsetX?a.offsetX:a.layerX,this.offsetY=ub||void 0!==a.offsetY?a.offsetY:a.layerY,this.clientX=void 0!==a.clientX?a.clientX:a.pageX,\nthis.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0):(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0);this.button=a.button;this.keyCode=a.keyCode||0;this.key=a.key||\"\";this.charCode=a.charCode||(\"keypress\"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.pointerId=a.pointerId||0;this.pointerType=\nm(a.pointerType)?a.pointerType:Zb[a.pointerType]||\"\";this.state=a.state;this.R=a;a.defaultPrevented&&this.preventDefault()};Yb.prototype.stopPropagation=function(){Yb.Uc.stopPropagation.call(this);this.R.stopPropagation?this.R.stopPropagation():this.R.cancelBubble=!0};Yb.prototype.preventDefault=function(){Yb.Uc.preventDefault.call(this);var a=this.R;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,Wb)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};\nYb.prototype.Hf=function(){return this.R};var $b=\"closure_listenable_\"+(1E6*Math.random()|0),ac=0;var bc=function(a,b,c,d,e){this.listener=a;this.Mc=null;this.src=b;this.type=c;this.capture=!!d;this.vc=e;this.key=++ac;this.Bb=this.pc=!1},cc=function(a){a.Bb=!0;a.listener=null;a.Mc=null;a.src=null;a.vc=null};var dc=function(a){this.src=a;this.I={};this.jc=0};dc.prototype.add=function(a,b,c,d,e){var f=a.toString();a=this.I[f];a||(a=this.I[f]=[],this.jc++);var g=ec(a,b,d,e);-1<g?(b=a[g],c||(b.pc=!1)):(b=new bc(b,this.src,f,!!d,e),b.pc=c,a.push(b));return b};dc.prototype.remove=function(a,b,c,d){a=a.toString();if(!(a in this.I))return!1;var e=this.I[a];b=ec(e,b,c,d);return-1<b?(cc(e[b]),Wa(e,b),0==e.length&&(delete this.I[a],this.jc--),!0):!1};\nvar fc=function(a,b){var c=b.type;c in a.I&&Xa(a.I[c],b)&&(cc(b),0==a.I[c].length&&(delete a.I[c],a.jc--))};dc.prototype.td=function(a,b,c,d){a=this.I[a.toString()];var e=-1;a&&(e=ec(a,b,c,d));return-1<e?a[e]:null};dc.prototype.hasListener=function(a,b){var c=ba(a),d=c?a.toString():\"\",e=ba(b);return fb(this.I,function(a){for(var f=0;f<a.length;++f)if(!(c&&a[f].type!=d||e&&a[f].capture!=b))return!0;return!1})};\nvar ec=function(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.Bb&&f.listener==b&&f.capture==!!c&&f.vc==d)return e}return-1};var gc=\"closure_lm_\"+(1E6*Math.random()|0),hc={},jc=0,lc=function(a,b,c,d,e){if(d&&d.once)kc(a,b,c,d,e);else if(ha(b))for(var f=0;f<b.length;f++)lc(a,b[f],c,d,e);else c=mc(c),a&&a[$b]?a.listen(b,c,q(d)?!!d.capture:!!d,e):nc(a,b,c,!1,d,e)},nc=function(a,b,c,d,e,f){if(!b)throw Error(\"Invalid event type\");var g=q(e)?!!e.capture:!!e,l=oc(a);l||(a[gc]=l=new dc(a));c=l.add(b,c,d,g,f);if(!c.Mc){d=pc();c.Mc=d;d.src=a;d.listener=c;if(a.addEventListener)Xb||(e=g),void 0===e&&(e=!1),a.addEventListener(b.toString(),\nd,e);else if(a.attachEvent)a.attachEvent(qc(b.toString()),d);else throw Error(\"addEventListener and attachEvent are unavailable.\");jc++}},pc=function(){var a=rc,b=Vb?function(c){return a.call(b.src,b.listener,c)}:function(c){c=a.call(b.src,b.listener,c);if(!c)return c};return b},kc=function(a,b,c,d,e){if(ha(b))for(var f=0;f<b.length;f++)kc(a,b[f],c,d,e);else c=mc(c),a&&a[$b]?sc(a,b,c,q(d)?!!d.capture:!!d,e):nc(a,b,c,!0,d,e)},tc=function(a,b,c,d,e){if(ha(b))for(var f=0;f<b.length;f++)tc(a,b[f],c,d,\ne);else d=q(d)?!!d.capture:!!d,c=mc(c),a&&a[$b]?a.ga.remove(String(b),c,d,e):a&&(a=oc(a))&&(b=a.td(b,c,d,e))&&uc(b)},uc=function(a){if(\"number\"!=typeof a&&a&&!a.Bb){var b=a.src;if(b&&b[$b])fc(b.ga,a);else{var c=a.type,d=a.Mc;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent&&b.detachEvent(qc(c),d);jc--;(c=oc(b))?(fc(c,a),0==c.jc&&(c.src=null,b[gc]=null)):cc(a)}}},qc=function(a){return a in hc?hc[a]:hc[a]=\"on\"+a},wc=function(a,b,c,d){var e=!0;if(a=oc(a))if(b=a.I[b.toString()])for(b=\nb.concat(),a=0;a<b.length;a++){var f=b[a];f&&f.capture==c&&!f.Bb&&(f=vc(f,d),e=e&&!1!==f)}return e},vc=function(a,b){var c=a.listener,d=a.vc||a.src;a.pc&&uc(a);return c.call(d,b)},rc=function(a,b){if(a.Bb)return!0;if(!Vb){if(!b)a:{b=[\"window\",\"event\"];for(var c=k,d=0;d<b.length;d++)if(c=c[b[d]],null==c){b=null;break a}b=c}d=b;b=new Yb(d,this);c=!0;if(!(0>d.keyCode||void 0!=d.returnValue)){a:{var e=!1;if(0==d.keyCode)try{d.keyCode=-1;break a}catch(g){e=!0}if(e||void 0==d.returnValue)d.returnValue=\n!0}d=[];for(e=b.currentTarget;e;e=e.parentNode)d.push(e);a=a.type;for(e=d.length-1;!b.Wa&&0<=e;e--){b.currentTarget=d[e];var f=wc(d[e],a,!0,b);c=c&&f}for(e=0;!b.Wa&&e<d.length;e++)b.currentTarget=d[e],f=wc(d[e],a,!1,b),c=c&&f}return c}return vc(a,new Yb(b,this))},oc=function(a){a=a[gc];return a instanceof dc?a:null},xc=\"__closure_events_fn_\"+(1E9*Math.random()>>>0),mc=function(a){w(a,\"Listener can not be null.\");if(p(a))return a;w(a.handleEvent,\"An object listener must have handleEvent method.\");\na[xc]||(a[xc]=function(b){return a.handleEvent(b)});return a[xc]};var yc=/^[+a-zA-Z0-9_.!#$%&'*\\/=?^`{|}~-]+@([a-zA-Z0-9-]+\\.)+[a-zA-Z0-9]{2,63}$/;var Ac=function(){this.xa=\"\";this.jf=zc};Ac.prototype.qb=!0;Ac.prototype.ob=function(){return this.xa};Ac.prototype.toString=function(){return\"SafeUrl{\"+this.xa+\"}\"};\nvar Bc=function(a){if(a instanceof Ac&&a.constructor===Ac&&a.jf===zc)return a.xa;Aa(\"expected object of type SafeUrl, got '\"+a+\"' of type \"+ea(a));return\"type_error:SafeUrl\"},Cc=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i,Ec=function(a){if(a instanceof Ac)return a;a=a.qb?a.ob():String(a);Cc.test(a)||(a=\"about:invalid#zClosurez\");return Dc(a)},zc={},Dc=function(a){var b=new Ac;b.xa=a;return b};Dc(\"about:blank\");var Hc=function(a){var b=[];Fc(new Gc,a,b);return b.join(\"\")},Gc=function(){this.Nc=void 0},Fc=function(a,b,c){if(null==b)c.push(\"null\");else{if(\"object\"==typeof b){if(ha(b)){var d=b;b=d.length;c.push(\"[\");for(var e=\"\",f=0;f<b;f++)c.push(e),e=d[f],Fc(a,a.Nc?a.Nc.call(d,String(f),e):e,c),e=\",\";c.push(\"]\");return}if(b instanceof String||b instanceof Number||b instanceof Boolean)b=b.valueOf();else{c.push(\"{\");f=\"\";for(d in b)Object.prototype.hasOwnProperty.call(b,d)&&(e=b[d],\"function\"!=typeof e&&(c.push(f),\nIc(d,c),c.push(\":\"),Fc(a,a.Nc?a.Nc.call(b,d,e):e,c),f=\",\"));c.push(\"}\");return}}switch(typeof b){case \"string\":Ic(b,c);break;case \"number\":c.push(isFinite(b)&&!isNaN(b)?String(b):\"null\");break;case \"boolean\":c.push(String(b));break;case \"function\":c.push(\"null\");break;default:throw Error(\"Unknown type: \"+typeof b);}}},Jc={'\"':'\\\\\"',\"\\\\\":\"\\\\\\\\\",\"/\":\"\\\\/\",\"\\b\":\"\\\\b\",\"\\f\":\"\\\\f\",\"\\n\":\"\\\\n\",\"\\r\":\"\\\\r\",\"\\t\":\"\\\\t\",\"\\x0B\":\"\\\\u000b\"},Kc=/\\uffff/.test(\"\\uffff\")?/[\\\\\"\\x00-\\x1f\\x7f-\\uffff]/g:/[\\\\\"\\x00-\\x1f\\x7f-\\xff]/g,\nIc=function(a,b){b.push('\"',a.replace(Kc,function(a){var b=Jc[a];b||(b=\"\\\\u\"+(a.charCodeAt(0)|65536).toString(16).substr(1),Jc[a]=b);return b}),'\"')};var Lc=function(){};Lc.prototype.je=null;var Mc=function(a){return a.je||(a.je=a.Cd())};var Nc,Oc=function(){};t(Oc,Lc);Oc.prototype.rc=function(){var a=Pc(this);return a?new ActiveXObject(a):new XMLHttpRequest};Oc.prototype.Cd=function(){var a={};Pc(this)&&(a[0]=!0,a[1]=!0);return a};\nvar Pc=function(a){if(!a.Ee&&\"undefined\"==typeof XMLHttpRequest&&\"undefined\"!=typeof ActiveXObject){for(var b=[\"MSXML2.XMLHTTP.6.0\",\"MSXML2.XMLHTTP.3.0\",\"MSXML2.XMLHTTP\",\"Microsoft.XMLHTTP\"],c=0;c<b.length;c++){var d=b[c];try{return new ActiveXObject(d),a.Ee=d}catch(e){}}throw Error(\"Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed\");}return a.Ee};Nc=new Oc;var Qc=function(){};t(Qc,Lc);Qc.prototype.rc=function(){var a=new XMLHttpRequest;if(\"withCredentials\"in a)return a;if(\"undefined\"!=typeof XDomainRequest)return new Rc;throw Error(\"Unsupported browser\");};Qc.prototype.Cd=function(){return{}};\nvar Rc=function(){this.oa=new XDomainRequest;this.readyState=0;this.onreadystatechange=null;this.responseText=\"\";this.status=-1;this.statusText=this.responseXML=null;this.oa.onload=r(this.Lf,this);this.oa.onerror=r(this.ze,this);this.oa.onprogress=r(this.Mf,this);this.oa.ontimeout=r(this.Nf,this)};h=Rc.prototype;h.open=function(a,b,c){if(null!=c&&!c)throw Error(\"Only async requests are supported.\");this.oa.open(a,b)};\nh.send=function(a){if(a)if(\"string\"==typeof a)this.oa.send(a);else throw Error(\"Only string data is supported\");else this.oa.send()};h.abort=function(){this.oa.abort()};h.setRequestHeader=function(){};h.getResponseHeader=function(a){return\"content-type\"==a.toLowerCase()?this.oa.contentType:\"\"};h.Lf=function(){this.status=200;this.responseText=this.oa.responseText;Sc(this,4)};h.ze=function(){this.status=500;this.responseText=\"\";Sc(this,4)};h.Nf=function(){this.ze()};\nh.Mf=function(){this.status=200;Sc(this,1)};var Sc=function(a,b){a.readyState=b;if(a.onreadystatechange)a.onreadystatechange()};Rc.prototype.getAllResponseHeaders=function(){return\"content-type: \"+this.oa.contentType};var Tc=function(a,b,c){this.Yf=c;this.wf=a;this.lg=b;this.Hc=0;this.wc=null};Tc.prototype.get=function(){if(0<this.Hc){this.Hc--;var a=this.wc;this.wc=a.next;a.next=null}else a=this.wf();return a};Tc.prototype.put=function(a){this.lg(a);this.Hc<this.Yf&&(this.Hc++,a.next=this.wc,this.wc=a)};var Uc=function(a){k.setTimeout(function(){throw a;},0)},Vc,Wc=function(){var a=k.MessageChannel;\"undefined\"===typeof a&&\"undefined\"!==typeof window&&window.postMessage&&window.addEventListener&&!y(\"Presto\")&&(a=function(){var a=document.createElement(\"IFRAME\");a.style.display=\"none\";a.src=\"\";document.documentElement.appendChild(a);var b=a.contentWindow;a=b.document;a.open();a.write(\"\");a.close();var c=\"callImmediate\"+Math.random(),d=\"file:\"==b.location.protocol?\"*\":b.location.protocol+\"//\"+b.location.host;\na=r(function(a){if((\"*\"==d||a.origin==d)&&a.data==c)this.port1.onmessage()},this);b.addEventListener(\"message\",a,!1);this.port1={};this.port2={postMessage:function(){b.postMessage(c,d)}}});if(\"undefined\"!==typeof a&&!y(\"Trident\")&&!y(\"MSIE\")){var b=new a,c={},d=c;b.port1.onmessage=function(){if(ba(c.next)){c=c.next;var a=c.me;c.me=null;a()}};return function(a){d.next={me:a};d=d.next;b.port2.postMessage(0)}}return\"undefined\"!==typeof document&&\"onreadystatechange\"in document.createElement(\"SCRIPT\")?\nfunction(a){var b=document.createElement(\"SCRIPT\");b.onreadystatechange=function(){b.onreadystatechange=null;b.parentNode.removeChild(b);b=null;a();a=null};document.documentElement.appendChild(b)}:function(a){k.setTimeout(a,0)}};var Xc=function(){this.bd=this.hb=null},Zc=new Tc(function(){return new Yc},function(a){a.reset()},100);Xc.prototype.add=function(a,b){var c=Zc.get();c.set(a,b);this.bd?this.bd.next=c:(w(!this.hb),this.hb=c);this.bd=c};Xc.prototype.remove=function(){var a=null;this.hb&&(a=this.hb,this.hb=this.hb.next,this.hb||(this.bd=null),a.next=null);return a};var Yc=function(){this.next=this.scope=this.rd=null};Yc.prototype.set=function(a,b){this.rd=a;this.scope=b;this.next=null};\nYc.prototype.reset=function(){this.next=this.scope=this.rd=null};var dd=function(a,b){$c||ad();bd||($c(),bd=!0);cd.add(a,b)},$c,ad=function(){if(-1!=String(k.Promise).indexOf(\"[native code]\")){var a=k.Promise.resolve(void 0);$c=function(){a.then(ed)}}else $c=function(){var a=ed;!p(k.setImmediate)||k.Window&&k.Window.prototype&&!y(\"Edge\")&&k.Window.prototype.setImmediate==k.setImmediate?(Vc||(Vc=Wc()),Vc(a)):k.setImmediate(a)}},bd=!1,cd=new Xc,ed=function(){for(var a;a=cd.remove();){try{a.rd.call(a.scope)}catch(b){Uc(b)}Zc.put(a)}bd=!1};var fd=function(a,b){var c=(c=a&&a.ownerDocument)&&(c.defaultView||c.parentWindow)||k;\"undefined\"!=typeof c[b]&&\"undefined\"!=typeof c.Location&&\"undefined\"!=typeof c.Element&&(c=a&&(a instanceof c[b]||!(a instanceof c.Location||a instanceof c.Element)),a=q(a)?a.constructor.displayName||a.constructor.name||Object.prototype.toString.call(a):void 0===a?\"undefined\":null===a?\"null\":typeof a,w(c,\"Argument is not a %s (or a non-Element, non-Location mock); got: %s\",b,a))};var gd=!z||9<=Number(Cb);!tb&&!z||z&&9<=Number(Cb)||tb&&A(\"1.9.1\");z&&A(\"9\");var id=function(){this.xa=\"\";this.hf=hd};id.prototype.qb=!0;id.prototype.ob=function(){return this.xa};id.prototype.toString=function(){return\"SafeHtml{\"+this.xa+\"}\"};var jd=function(a){if(a instanceof id&&a.constructor===id&&a.hf===hd)return a.xa;Aa(\"expected object of type SafeHtml, got '\"+a+\"' of type \"+ea(a));return\"type_error:SafeHtml\"},hd={};id.prototype.Tf=function(a){this.xa=a;return this};var kd=function(a,b){fd(a,\"HTMLScriptElement\");a.src=Ka(b)};var ld=function(a){var b=document;return m(a)?b.getElementById(a):a},nd=function(a,b){eb(b,function(b,d){b&&b.qb&&(b=b.ob());\"style\"==d?a.style.cssText=b:\"class\"==d?a.className=b:\"for\"==d?a.htmlFor=b:md.hasOwnProperty(d)?a.setAttribute(md[d],b):0==d.lastIndexOf(\"aria-\",0)||0==d.lastIndexOf(\"data-\",0)?a.setAttribute(d,b):a[d]=b})},md={cellpadding:\"cellPadding\",cellspacing:\"cellSpacing\",colspan:\"colSpan\",frameborder:\"frameBorder\",height:\"height\",maxlength:\"maxLength\",nonce:\"nonce\",role:\"role\",rowspan:\"rowSpan\",\ntype:\"type\",usemap:\"useMap\",valign:\"vAlign\",width:\"width\"},pd=function(a,b,c){var d=arguments,e=document,f=String(d[0]),g=d[1];if(!gd&&g&&(g.name||g.type)){f=[\"<\",f];g.name&&f.push(' name=\"',wa(g.name),'\"');if(g.type){f.push(' type=\"',wa(g.type),'\"');var l={};mb(l,g);delete l.type;g=l}f.push(\">\");f=f.join(\"\")}f=e.createElement(f);g&&(m(g)?f.className=g:ha(g)?f.className=g.join(\" \"):nd(f,g));2<d.length&&od(e,f,d);return f},od=function(a,b,c){function d(c){c&&b.appendChild(m(c)?a.createTextNode(c):\nc)}for(var e=2;e<c.length;e++){var f=c[e];!ia(f)||q(f)&&0<f.nodeType?d(f):x(qd(f)?$a(f):f,d)}},qd=function(a){if(a&&\"number\"==typeof a.length){if(q(a))return\"function\"==typeof a.item||\"string\"==typeof a.item;if(p(a))return\"function\"==typeof a.item}return!1};var rd=function(a){a.prototype.then=a.prototype.then;a.prototype.$goog_Thenable=!0},sd=function(a){if(!a)return!1;try{return!!a.$goog_Thenable}catch(b){return!1}};var C=function(a,b){this.aa=0;this.za=void 0;this.kb=this.ua=this.w=null;this.uc=this.pd=!1;if(a!=da)try{var c=this;a.call(b,function(a){td(c,2,a)},function(a){if(!(a instanceof ud))try{if(a instanceof Error)throw a;throw Error(\"Promise rejected.\");}catch(e){}td(c,3,a)})}catch(d){td(this,3,d)}},vd=function(){this.next=this.context=this.tb=this.Ua=this.child=null;this.Hb=!1};vd.prototype.reset=function(){this.context=this.tb=this.Ua=this.child=null;this.Hb=!1};\nvar wd=new Tc(function(){return new vd},function(a){a.reset()},100),xd=function(a,b,c){var d=wd.get();d.Ua=a;d.tb=b;d.context=c;return d},D=function(a){if(a instanceof C)return a;var b=new C(da);td(b,2,a);return b},E=function(a){return new C(function(b,c){c(a)})},zd=function(a,b,c){yd(a,b,c,null)||dd(la(b,a))},Ad=function(a){return new C(function(b,c){var d=a.length,e=[];if(d)for(var f=function(a,c){d--;e[a]=c;0==d&&b(e)},g=function(a){c(a)},l=0,n;l<a.length;l++)n=a[l],zd(n,la(f,l),g);else b(e)})},\nBd=function(a){return new C(function(b){var c=a.length,d=[];if(c)for(var e=function(a,e,f){c--;d[a]=e?{Gf:!0,value:f}:{Gf:!1,reason:f};0==c&&b(d)},f=0,g;f<a.length;f++)g=a[f],zd(g,la(e,f,!0),la(e,f,!1));else b(d)})};C.prototype.then=function(a,b,c){null!=a&&Da(a,\"opt_onFulfilled should be a function.\");null!=b&&Da(b,\"opt_onRejected should be a function. Did you pass opt_context as the second argument instead of the third?\");return Cd(this,p(a)?a:null,p(b)?b:null,c)};rd(C);\nvar Ed=function(a,b){b=xd(b,b,void 0);b.Hb=!0;Dd(a,b);return a};C.prototype.g=function(a,b){return Cd(this,null,a,b)};C.prototype.cancel=function(a){0==this.aa&&dd(function(){var b=new ud(a);Fd(this,b)},this)};\nvar Fd=function(a,b){if(0==a.aa)if(a.w){var c=a.w;if(c.ua){for(var d=0,e=null,f=null,g=c.ua;g&&(g.Hb||(d++,g.child==a&&(e=g),!(e&&1<d)));g=g.next)e||(f=g);e&&(0==c.aa&&1==d?Fd(c,b):(f?(d=f,w(c.ua),w(null!=d),d.next==c.kb&&(c.kb=d),d.next=d.next.next):Gd(c),Hd(c,e,3,b)))}a.w=null}else td(a,3,b)},Dd=function(a,b){a.ua||2!=a.aa&&3!=a.aa||Id(a);w(null!=b.Ua);a.kb?a.kb.next=b:a.ua=b;a.kb=b},Cd=function(a,b,c,d){var e=xd(null,null,null);e.child=new C(function(a,g){e.Ua=b?function(c){try{var e=b.call(d,\nc);a(e)}catch(F){g(F)}}:a;e.tb=c?function(b){try{var e=c.call(d,b);!ba(e)&&b instanceof ud?g(b):a(e)}catch(F){g(F)}}:g});e.child.w=a;Dd(a,e);return e.child};C.prototype.zg=function(a){w(1==this.aa);this.aa=0;td(this,2,a)};C.prototype.Ag=function(a){w(1==this.aa);this.aa=0;td(this,3,a)};\nvar td=function(a,b,c){0==a.aa&&(a===c&&(b=3,c=new TypeError(\"Promise cannot resolve to itself\")),a.aa=1,yd(c,a.zg,a.Ag,a)||(a.za=c,a.aa=b,a.w=null,Id(a),3!=b||c instanceof ud||Jd(a,c)))},yd=function(a,b,c,d){if(a instanceof C)return null!=b&&Da(b,\"opt_onFulfilled should be a function.\"),null!=c&&Da(c,\"opt_onRejected should be a function. Did you pass opt_context as the second argument instead of the third?\"),Dd(a,xd(b||da,c||null,d)),!0;if(sd(a))return a.then(b,c,d),!0;if(q(a))try{var e=a.then;if(p(e))return Kd(a,\ne,b,c,d),!0}catch(f){return c.call(d,f),!0}return!1},Kd=function(a,b,c,d,e){var f=!1,g=function(a){f||(f=!0,c.call(e,a))},l=function(a){f||(f=!0,d.call(e,a))};try{b.call(a,g,l)}catch(n){l(n)}},Id=function(a){a.pd||(a.pd=!0,dd(a.Bf,a))},Gd=function(a){var b=null;a.ua&&(b=a.ua,a.ua=b.next,b.next=null);a.ua||(a.kb=null);null!=b&&w(null!=b.Ua);return b};C.prototype.Bf=function(){for(var a;a=Gd(this);)Hd(this,a,this.aa,this.za);this.pd=!1};\nvar Hd=function(a,b,c,d){if(3==c&&b.tb&&!b.Hb)for(;a&&a.uc;a=a.w)a.uc=!1;if(b.child)b.child.w=null,Ld(b,c,d);else try{b.Hb?b.Ua.call(b.context):Ld(b,c,d)}catch(e){Md.call(null,e)}wd.put(b)},Ld=function(a,b,c){2==b?a.Ua.call(a.context,c):a.tb&&a.tb.call(a.context,c)},Jd=function(a,b){a.uc=!0;dd(function(){a.uc&&Md.call(null,b)})},Md=Uc,ud=function(a){u.call(this,a)};t(ud,u);ud.prototype.name=\"cancel\";/*\n Portions of this code are from MochiKit, received by\n The Closure Authors under the MIT license. All other code is Copyright\n 2005-2009 The Closure Authors. All Rights Reserved.\n*/\nvar Nd=function(a,b){this.Qc=[];this.Ne=a;this.re=b||null;this.Pb=this.nb=!1;this.za=void 0;this.be=this.he=this.fd=!1;this.Yc=0;this.w=null;this.gd=0};Nd.prototype.cancel=function(a){if(this.nb)this.za instanceof Nd&&this.za.cancel();else{if(this.w){var b=this.w;delete this.w;a?b.cancel(a):(b.gd--,0>=b.gd&&b.cancel())}this.Ne?this.Ne.call(this.re,this):this.be=!0;this.nb||Od(this,new Pd)}};Nd.prototype.oe=function(a,b){this.fd=!1;Qd(this,a,b)};\nvar Qd=function(a,b,c){a.nb=!0;a.za=c;a.Pb=!b;Rd(a)},Td=function(a){if(a.nb){if(!a.be)throw new Sd;a.be=!1}};Nd.prototype.callback=function(a){Td(this);Ud(a);Qd(this,!0,a)};var Od=function(a,b){Td(a);Ud(b);Qd(a,!1,b)},Ud=function(a){w(!(a instanceof Nd),\"An execution sequence may not be initiated with a blocking Deferred.\")},Wd=function(a,b){Vd(a,null,b,void 0)},Vd=function(a,b,c,d){w(!a.he,\"Blocking Deferreds can not be re-used\");a.Qc.push([b,c,d]);a.nb&&Rd(a)};\nNd.prototype.then=function(a,b,c){var d,e,f=new C(function(a,b){d=a;e=b});Vd(this,d,function(a){a instanceof Pd?f.cancel():e(a)});return f.then(a,b,c)};rd(Nd);\nvar Xd=function(a){return Sa(a.Qc,function(a){return p(a[1])})},Rd=function(a){if(a.Yc&&a.nb&&Xd(a)){var b=a.Yc,c=Yd[b];c&&(k.clearTimeout(c.Qb),delete Yd[b]);a.Yc=0}a.w&&(a.w.gd--,delete a.w);b=a.za;for(var d=c=!1;a.Qc.length&&!a.fd;){var e=a.Qc.shift(),f=e[0],g=e[1];e=e[2];if(f=a.Pb?g:f)try{var l=f.call(e||a.re,b);ba(l)&&(a.Pb=a.Pb&&(l==b||l instanceof Error),a.za=b=l);if(sd(b)||\"function\"===typeof k.Promise&&b instanceof k.Promise)d=!0,a.fd=!0}catch(n){b=n,a.Pb=!0,Xd(a)||(c=!0)}}a.za=b;d&&(l=r(a.oe,\na,!0),d=r(a.oe,a,!1),b instanceof Nd?(Vd(b,l,d),b.he=!0):b.then(l,d));c&&(b=new Zd(b),Yd[b.Qb]=b,a.Yc=b.Qb)},Sd=function(){u.call(this)};t(Sd,u);Sd.prototype.message=\"Deferred has already fired\";Sd.prototype.name=\"AlreadyCalledError\";var Pd=function(){u.call(this)};t(Pd,u);Pd.prototype.message=\"Deferred was canceled\";Pd.prototype.name=\"CanceledError\";var Zd=function(a){this.Qb=k.setTimeout(r(this.yg,this),0);this.ba=a};\nZd.prototype.yg=function(){w(Yd[this.Qb],\"Cannot throw an error that is not scheduled.\");delete Yd[this.Qb];throw this.ba;};var Yd={};var de=function(a){var b={},c=b.document||document,d=Ka(a),e=document.createElement(\"SCRIPT\"),f={We:e,ic:void 0},g=new Nd($d,f),l=null,n=null!=b.timeout?b.timeout:5E3;0<n&&(l=window.setTimeout(function(){ae(e,!0);Od(g,new be(1,\"Timeout reached for loading script \"+d))},n),f.ic=l);e.onload=e.onreadystatechange=function(){e.readyState&&\"loaded\"!=e.readyState&&\"complete\"!=e.readyState||(ae(e,b.Pg||!1,l),g.callback(null))};e.onerror=function(){ae(e,!0,l);Od(g,new be(0,\"Error while loading script \"+d))};\nf=b.attributes||{};mb(f,{type:\"text/javascript\",charset:\"UTF-8\"});nd(e,f);kd(e,a);ce(c).appendChild(e);return g},ce=function(a){var b;return(b=(a||document).getElementsByTagName(\"HEAD\"))&&0!=b.length?b[0]:a.documentElement},$d=function(){if(this&&this.We){var a=this.We;a&&\"SCRIPT\"==a.tagName&&ae(a,!0,this.ic)}},ae=function(a,b,c){null!=c&&k.clearTimeout(c);a.onload=da;a.onerror=da;a.onreadystatechange=da;b&&window.setTimeout(function(){a&&a.parentNode&&a.parentNode.removeChild(a)},0)},be=function(a,\nb){var c=\"Jsloader error (code #\"+a+\")\";b&&(c+=\": \"+b);u.call(this,c);this.code=a};t(be,u);var ee=function(a,b,c,d,e){this.reset(a,b,c,d,e)};ee.prototype.te=null;var fe=0;ee.prototype.reset=function(a,b,c,d,e){\"number\"==typeof e||fe++;d||ma();this.Vb=a;delete this.te};ee.prototype.Xe=function(a){this.Vb=a};var ge=function(a){this.Le=a;this.Ae=this.kd=this.Vb=this.w=null},he=function(a,b){this.name=a;this.value=b};he.prototype.toString=function(){return this.name};var ie=new he(\"SEVERE\",1E3),je=new he(\"INFO\",800),ke=new he(\"CONFIG\",700),le=new he(\"FINE\",500);ge.prototype.getName=function(){return this.Le};ge.prototype.getParent=function(){return this.w};ge.prototype.Xe=function(a){this.Vb=a};var me=function(a){if(a.Vb)return a.Vb;if(a.w)return me(a.w);Aa(\"Root logger has no level set.\");return null};\nge.prototype.log=function(a,b,c){if(a.value>=me(this).value)for(p(b)&&(b=b()),a=new ee(a,String(b),this.Le),c&&(a.te=c),c=this;c;){var d=c,e=a;if(d.Ae)for(var f=0;b=d.Ae[f];f++)b(e);c=c.getParent()}};ge.prototype.info=function(a,b){this.log(je,a,b)};ge.prototype.config=function(a,b){this.log(ke,a,b)};\nvar ne={},oe=null,pe=function(a){oe||(oe=new ge(\"\"),ne[\"\"]=oe,oe.Xe(ke));var b;if(!(b=ne[a])){b=new ge(a);var c=a.lastIndexOf(\".\"),d=a.substr(c+1);c=pe(a.substr(0,c));c.kd||(c.kd={});c.kd[d]=b;b.w=c;ne[a]=b}return b};var G=function(){Ub.call(this);this.ga=new dc(this);this.nf=this;this.Kd=null};t(G,Ub);G.prototype[$b]=!0;h=G.prototype;h.addEventListener=function(a,b,c,d){lc(this,a,b,c,d)};h.removeEventListener=function(a,b,c,d){tc(this,a,b,c,d)};\nh.dispatchEvent=function(a){qe(this);var b=this.Kd;if(b){var c=[];for(var d=1;b;b=b.Kd)c.push(b),w(1E3>++d,\"infinite loop\")}b=this.nf;d=a.type||a;if(m(a))a=new B(a,b);else if(a instanceof B)a.target=a.target||b;else{var e=a;a=new B(d,b);mb(a,e)}e=!0;if(c)for(var f=c.length-1;!a.Wa&&0<=f;f--){var g=a.currentTarget=c[f];e=re(g,d,!0,a)&&e}a.Wa||(g=a.currentTarget=b,e=re(g,d,!0,a)&&e,a.Wa||(e=re(g,d,!1,a)&&e));if(c)for(f=0;!a.Wa&&f<c.length;f++)g=a.currentTarget=c[f],e=re(g,d,!1,a)&&e;return e};\nh.lb=function(){G.Uc.lb.call(this);if(this.ga){var a=this.ga,b=0,c;for(c in a.I){for(var d=a.I[c],e=0;e<d.length;e++)++b,cc(d[e]);delete a.I[c];a.jc--}}this.Kd=null};h.listen=function(a,b,c,d){qe(this);return this.ga.add(String(a),b,!1,c,d)};\nvar sc=function(a,b,c,d,e){a.ga.add(String(b),c,!0,d,e)},re=function(a,b,c,d){b=a.ga.I[String(b)];if(!b)return!0;b=b.concat();for(var e=!0,f=0;f<b.length;++f){var g=b[f];if(g&&!g.Bb&&g.capture==c){var l=g.listener,n=g.vc||g.src;g.pc&&fc(a.ga,g);e=!1!==l.call(n,d)&&e}}return e&&0!=d.Ue};G.prototype.td=function(a,b,c,d){return this.ga.td(String(a),b,c,d)};G.prototype.hasListener=function(a,b){return this.ga.hasListener(ba(a)?String(a):void 0,b)};var qe=function(a){w(a.ga,\"Event target is not initialized. Did you call the superclass (goog.events.EventTarget) constructor?\")};var se=\"StopIteration\"in k?k.StopIteration:{message:\"StopIteration\",stack:\"\"},te=function(){};te.prototype.next=function(){throw se;};te.prototype.mf=function(){return this};var H=function(a,b){a&&a.log(le,b,void 0)};var ue=function(a,b){this.ja={};this.C=[];this.gb=this.u=0;var c=arguments.length;if(1<c){if(c%2)throw Error(\"Uneven number of arguments\");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.addAll(a)};h=ue.prototype;h.ha=function(){ve(this);for(var a=[],b=0;b<this.C.length;b++)a.push(this.ja[this.C[b]]);return a};h.va=function(){ve(this);return this.C.concat()};h.Jb=function(a){return we(this.ja,a)};h.clear=function(){this.ja={};this.gb=this.u=this.C.length=0};\nh.remove=function(a){return we(this.ja,a)?(delete this.ja[a],this.u--,this.gb++,this.C.length>2*this.u&&ve(this),!0):!1};var ve=function(a){if(a.u!=a.C.length){for(var b=0,c=0;b<a.C.length;){var d=a.C[b];we(a.ja,d)&&(a.C[c++]=d);b++}a.C.length=c}if(a.u!=a.C.length){var e={};for(c=b=0;b<a.C.length;)d=a.C[b],we(e,d)||(a.C[c++]=d,e[d]=1),b++;a.C.length=c}};h=ue.prototype;h.get=function(a,b){return we(this.ja,a)?this.ja[a]:b};\nh.set=function(a,b){we(this.ja,a)||(this.u++,this.C.push(a),this.gb++);this.ja[a]=b};h.addAll=function(a){if(a instanceof ue){var b=a.va();a=a.ha()}else b=hb(a),a=gb(a);for(var c=0;c<b.length;c++)this.set(b[c],a[c])};h.forEach=function(a,b){for(var c=this.va(),d=0;d<c.length;d++){var e=c[d],f=this.get(e);a.call(b,f,e,this)}};h.clone=function(){return new ue(this)};\nh.mf=function(a){ve(this);var b=0,c=this.gb,d=this,e=new te;e.next=function(){if(c!=d.gb)throw Error(\"The map has changed since the iterator was created\");if(b>=d.C.length)throw se;var e=d.C[b++];return a?e:d.ja[e]};return e};var we=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};var xe=function(a){if(a.ha&&\"function\"==typeof a.ha)return a.ha();if(m(a))return a.split(\"\");if(ia(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return gb(a)},ye=function(a){if(a.va&&\"function\"==typeof a.va)return a.va();if(!a.ha||\"function\"!=typeof a.ha){if(ia(a)||m(a)){var b=[];a=a.length;for(var c=0;c<a;c++)b.push(c);return b}return hb(a)}},ze=function(a,b,c){if(a.forEach&&\"function\"==typeof a.forEach)a.forEach(b,c);else if(ia(a)||m(a))x(a,b,c);else for(var d=ye(a),e=xe(a),f=e.length,\ng=0;g<f;g++)b.call(c,e[g],d&&d[g],a)};var Ae=function(a,b,c){if(p(a))c&&(a=r(a,c));else if(a&&\"function\"==typeof a.handleEvent)a=r(a.handleEvent,a);else throw Error(\"Invalid listener argument\");return 2147483647<Number(b)?-1:k.setTimeout(a,b||0)},Be=function(a){var b=null;return(new C(function(c,d){b=Ae(function(){c(void 0)},a);-1==b&&d(Error(\"Failed to schedule timer.\"))})).g(function(a){k.clearTimeout(b);throw a;})};var Ce=/^(?:([^:/?#.]+):)?(?:\\/\\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$/,De=function(a,b){if(a){a=a.split(\"&\");for(var c=0;c<a.length;c++){var d=a[c].indexOf(\"=\"),e=null;if(0<=d){var f=a[c].substring(0,d);e=a[c].substring(d+1)}else f=a[c];b(f,e?decodeURIComponent(e.replace(/\\+/g,\" \")):\"\")}}};var I=function(a){G.call(this);this.headers=new ue;this.dd=a||null;this.Ca=!1;this.cd=this.b=null;this.Ub=this.Ke=this.Ec=\"\";this.Qa=this.zd=this.zc=this.od=!1;this.Db=0;this.Vc=null;this.Oc=\"\";this.Zc=this.hg=this.gf=!1};t(I,G);var Ee=I.prototype,Fe=pe(\"goog.net.XhrIo\");Ee.T=Fe;var Ge=/^https?$/i,He=[\"POST\",\"PUT\"];\nI.prototype.send=function(a,b,c,d){if(this.b)throw Error(\"[goog.net.XhrIo] Object is active with another request=\"+this.Ec+\"; newUri=\"+a);b=b?b.toUpperCase():\"GET\";this.Ec=a;this.Ub=\"\";this.Ke=b;this.od=!1;this.Ca=!0;this.b=this.dd?this.dd.rc():Nc.rc();this.cd=this.dd?Mc(this.dd):Mc(Nc);this.b.onreadystatechange=r(this.Re,this);this.hg&&\"onprogress\"in this.b&&(this.b.onprogress=r(function(a){this.Qe(a,!0)},this),this.b.upload&&(this.b.upload.onprogress=r(this.Qe,this)));try{H(this.T,Ie(this,\"Opening Xhr\")),\nthis.zd=!0,this.b.open(b,String(a),!0),this.zd=!1}catch(f){H(this.T,Ie(this,\"Error opening Xhr: \"+f.message));this.ba(5,f);return}a=c||\"\";var e=this.headers.clone();d&&ze(d,function(a,b){e.set(b,a)});d=Ua(e.va());c=k.FormData&&a instanceof k.FormData;!Va(He,b)||d||c||e.set(\"Content-Type\",\"application/x-www-form-urlencoded;charset=utf-8\");e.forEach(function(a,b){this.b.setRequestHeader(b,a)},this);this.Oc&&(this.b.responseType=this.Oc);\"withCredentials\"in this.b&&this.b.withCredentials!==this.gf&&\n(this.b.withCredentials=this.gf);try{Je(this),0<this.Db&&(this.Zc=Ke(this.b),H(this.T,Ie(this,\"Will abort after \"+this.Db+\"ms if incomplete, xhr2 \"+this.Zc)),this.Zc?(this.b.timeout=this.Db,this.b.ontimeout=r(this.ic,this)):this.Vc=Ae(this.ic,this.Db,this)),H(this.T,Ie(this,\"Sending request\")),this.zc=!0,this.b.send(a),this.zc=!1}catch(f){H(this.T,Ie(this,\"Send error: \"+f.message)),this.ba(5,f)}};\nvar Ke=function(a){return z&&A(9)&&\"number\"==typeof a.timeout&&ba(a.ontimeout)},Ta=function(a){return\"content-type\"==a.toLowerCase()};I.prototype.ic=function(){\"undefined\"!=typeof aa&&this.b&&(this.Ub=\"Timed out after \"+this.Db+\"ms, aborting\",H(this.T,Ie(this,this.Ub)),this.dispatchEvent(\"timeout\"),this.abort(8))};I.prototype.ba=function(a,b){this.Ca=!1;this.b&&(this.Qa=!0,this.b.abort(),this.Qa=!1);this.Ub=b;Le(this);Me(this)};var Le=function(a){a.od||(a.od=!0,a.dispatchEvent(\"complete\"),a.dispatchEvent(\"error\"))};\nI.prototype.abort=function(){this.b&&this.Ca&&(H(this.T,Ie(this,\"Aborting\")),this.Ca=!1,this.Qa=!0,this.b.abort(),this.Qa=!1,this.dispatchEvent(\"complete\"),this.dispatchEvent(\"abort\"),Me(this))};I.prototype.lb=function(){this.b&&(this.Ca&&(this.Ca=!1,this.Qa=!0,this.b.abort(),this.Qa=!1),Me(this,!0));I.Uc.lb.call(this)};I.prototype.Re=function(){this.isDisposed()||(this.zd||this.zc||this.Qa?Ne(this):this.dg())};I.prototype.dg=function(){Ne(this)};\nvar Ne=function(a){if(a.Ca&&\"undefined\"!=typeof aa)if(a.cd[1]&&4==Oe(a)&&2==Pe(a))H(a.T,Ie(a,\"Local request error detected and ignored\"));else if(a.zc&&4==Oe(a))Ae(a.Re,0,a);else if(a.dispatchEvent(\"readystatechange\"),4==Oe(a)){H(a.T,Ie(a,\"Request complete\"));a.Ca=!1;try{var b=Pe(a);a:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break a;default:c=!1}var d;if(!(d=c)){var e;if(e=0===b){var f=String(a.Ec).match(Ce)[1]||null;if(!f&&k.self&&k.self.location){var g=\nk.self.location.protocol;f=g.substr(0,g.length-1)}e=!Ge.test(f?f.toLowerCase():\"\")}d=e}if(d)a.dispatchEvent(\"complete\"),a.dispatchEvent(\"success\");else{try{var l=2<Oe(a)?a.b.statusText:\"\"}catch(n){H(a.T,\"Can not get status: \"+n.message),l=\"\"}a.Ub=l+\" [\"+Pe(a)+\"]\";Le(a)}}finally{Me(a)}}};I.prototype.Qe=function(a,b){w(\"progress\"===a.type,\"goog.net.EventType.PROGRESS is of the same type as raw XHR progress.\");this.dispatchEvent(Qe(a,\"progress\"));this.dispatchEvent(Qe(a,b?\"downloadprogress\":\"uploadprogress\"))};\nvar Qe=function(a,b){return{type:b,lengthComputable:a.lengthComputable,loaded:a.loaded,total:a.total}},Me=function(a,b){if(a.b){Je(a);var c=a.b,d=a.cd[0]?da:null;a.b=null;a.cd=null;b||a.dispatchEvent(\"ready\");try{c.onreadystatechange=d}catch(e){(a=a.T)&&a.log(ie,\"Problem encountered resetting onreadystatechange: \"+e.message,void 0)}}},Je=function(a){a.b&&a.Zc&&(a.b.ontimeout=null);a.Vc&&(k.clearTimeout(a.Vc),a.Vc=null)},Oe=function(a){return a.b?a.b.readyState:0},Pe=function(a){try{return 2<Oe(a)?\na.b.status:-1}catch(b){return-1}},Re=function(a){try{return a.b?a.b.responseText:\"\"}catch(b){return H(a.T,\"Can not get responseText: \"+b.message),\"\"}};\nI.prototype.getResponse=function(){try{if(!this.b)return null;if(\"response\"in this.b)return this.b.response;switch(this.Oc){case \"\":case \"text\":return this.b.responseText;case \"arraybuffer\":if(\"mozResponseArrayBuffer\"in this.b)return this.b.mozResponseArrayBuffer}var a=this.T;a&&a.log(ie,\"Response type \"+this.Oc+\" is not supported on this browser\",void 0);return null}catch(b){return H(this.T,\"Can not get response: \"+b.message),null}};\nI.prototype.getResponseHeader=function(a){if(this.b&&4==Oe(this))return a=this.b.getResponseHeader(a),null===a?void 0:a};I.prototype.getAllResponseHeaders=function(){return this.b&&4==Oe(this)?this.b.getAllResponseHeaders():\"\"};var Ie=function(a,b){return b+\" [\"+a.Ke+\" \"+a.Ec+\" \"+Pe(a)+\"]\"};var Se=function(a,b){this.pa=this.eb=this.qa=\"\";this.vb=null;this.Pa=this.Ga=\"\";this.da=this.Xf=!1;if(a instanceof Se){this.da=ba(b)?b:a.da;Te(this,a.qa);var c=a.eb;J(this);this.eb=c;Ue(this,a.pa);Ve(this,a.vb);We(this,a.Ga);Xe(this,a.ea.clone());a=a.Pa;J(this);this.Pa=a}else a&&(c=String(a).match(Ce))?(this.da=!!b,Te(this,c[1]||\"\",!0),a=c[2]||\"\",J(this),this.eb=Ye(a),Ue(this,c[3]||\"\",!0),Ve(this,c[4]),We(this,c[5]||\"\",!0),Xe(this,c[6]||\"\",!0),a=c[7]||\"\",J(this),this.Pa=Ye(a)):(this.da=!!b,this.ea=\nnew Ze(null,0,this.da))};Se.prototype.toString=function(){var a=[],b=this.qa;b&&a.push($e(b,af,!0),\":\");var c=this.pa;if(c||\"file\"==b)a.push(\"//\"),(b=this.eb)&&a.push($e(b,af,!0),\"@\"),a.push(encodeURIComponent(String(c)).replace(/%25([0-9a-fA-F]{2})/g,\"%$1\")),c=this.vb,null!=c&&a.push(\":\",String(c));if(c=this.Ga)this.pa&&\"/\"!=c.charAt(0)&&a.push(\"/\"),a.push($e(c,\"/\"==c.charAt(0)?bf:cf,!0));(c=this.ea.toString())&&a.push(\"?\",c);(c=this.Pa)&&a.push(\"#\",$e(c,df));return a.join(\"\")};\nSe.prototype.resolve=function(a){var b=this.clone(),c=!!a.qa;c?Te(b,a.qa):c=!!a.eb;if(c){var d=a.eb;J(b);b.eb=d}else c=!!a.pa;c?Ue(b,a.pa):c=null!=a.vb;d=a.Ga;if(c)Ve(b,a.vb);else if(c=!!a.Ga){if(\"/\"!=d.charAt(0))if(this.pa&&!this.Ga)d=\"/\"+d;else{var e=b.Ga.lastIndexOf(\"/\");-1!=e&&(d=b.Ga.substr(0,e+1)+d)}e=d;if(\"..\"==e||\".\"==e)d=\"\";else if(v(e,\"./\")||v(e,\"/.\")){d=0==e.lastIndexOf(\"/\",0);e=e.split(\"/\");for(var f=[],g=0;g<e.length;){var l=e[g++];\".\"==l?d&&g==e.length&&f.push(\"\"):\"..\"==l?((1<f.length||\n1==f.length&&\"\"!=f[0])&&f.pop(),d&&g==e.length&&f.push(\"\")):(f.push(l),d=!0)}d=f.join(\"/\")}else d=e}c?We(b,d):c=\"\"!==a.ea.toString();c?Xe(b,a.ea.clone()):c=!!a.Pa;c&&(a=a.Pa,J(b),b.Pa=a);return b};Se.prototype.clone=function(){return new Se(this)};\nvar Te=function(a,b,c){J(a);a.qa=c?Ye(b,!0):b;a.qa&&(a.qa=a.qa.replace(/:$/,\"\"))},Ue=function(a,b,c){J(a);a.pa=c?Ye(b,!0):b},Ve=function(a,b){J(a);if(b){b=Number(b);if(isNaN(b)||0>b)throw Error(\"Bad port number \"+b);a.vb=b}else a.vb=null},We=function(a,b,c){J(a);a.Ga=c?Ye(b,!0):b},Xe=function(a,b,c){J(a);b instanceof Ze?(a.ea=b,a.ea.$d(a.da)):(c||(b=$e(b,ef)),a.ea=new Ze(b,0,a.da))},K=function(a,b,c){J(a);a.ea.set(b,c)},ff=function(a,b){return a.ea.get(b)};\nSe.prototype.removeParameter=function(a){J(this);this.ea.remove(a);return this};var J=function(a){if(a.Xf)throw Error(\"Tried to modify a read-only Uri\");};Se.prototype.$d=function(a){this.da=a;this.ea&&this.ea.$d(a);return this};\nvar gf=function(a){return a instanceof Se?a.clone():new Se(a,void 0)},hf=function(a,b){var c=new Se(null,void 0);Te(c,\"https\");a&&Ue(c,a);b&&We(c,b);return c},Ye=function(a,b){return a?b?decodeURI(a.replace(/%25/g,\"%2525\")):decodeURIComponent(a):\"\"},$e=function(a,b,c){return m(a)?(a=encodeURI(a).replace(b,jf),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,\"%$1\")),a):null},jf=function(a){a=a.charCodeAt(0);return\"%\"+(a>>4&15).toString(16)+(a&15).toString(16)},af=/[#\\/\\?@]/g,cf=/[#\\?:]/g,bf=/[#\\?]/g,ef=/[#\\?@]/g,\ndf=/#/g,Ze=function(a,b,c){this.u=this.s=null;this.X=a||null;this.da=!!c},kf=function(a){a.s||(a.s=new ue,a.u=0,a.X&&De(a.X,function(b,c){a.add(decodeURIComponent(b.replace(/\\+/g,\" \")),c)}))},mf=function(a){var b=ye(a);if(\"undefined\"==typeof b)throw Error(\"Keys are undefined\");var c=new Ze(null,0,void 0);a=xe(a);for(var d=0;d<b.length;d++){var e=b[d],f=a[d];ha(f)?lf(c,e,f):c.add(e,f)}return c};h=Ze.prototype;\nh.add=function(a,b){kf(this);this.X=null;a=this.ca(a);var c=this.s.get(a);c||this.s.set(a,c=[]);c.push(b);this.u=Ba(this.u)+1;return this};h.remove=function(a){kf(this);a=this.ca(a);return this.s.Jb(a)?(this.X=null,this.u=Ba(this.u)-this.s.get(a).length,this.s.remove(a)):!1};h.clear=function(){this.s=this.X=null;this.u=0};h.Jb=function(a){kf(this);a=this.ca(a);return this.s.Jb(a)};h.forEach=function(a,b){kf(this);this.s.forEach(function(c,d){x(c,function(c){a.call(b,c,d,this)},this)},this)};\nh.va=function(){kf(this);for(var a=this.s.ha(),b=this.s.va(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c};h.ha=function(a){kf(this);var b=[];if(m(a))this.Jb(a)&&(b=Za(b,this.s.get(this.ca(a))));else{a=this.s.ha();for(var c=0;c<a.length;c++)b=Za(b,a[c])}return b};h.set=function(a,b){kf(this);this.X=null;a=this.ca(a);this.Jb(a)&&(this.u=Ba(this.u)-this.s.get(a).length);this.s.set(a,[b]);this.u=Ba(this.u)+1;return this};\nh.get=function(a,b){a=a?this.ha(a):[];return 0<a.length?String(a[0]):b};var lf=function(a,b,c){a.remove(b);0<c.length&&(a.X=null,a.s.set(a.ca(b),$a(c)),a.u=Ba(a.u)+c.length)};h=Ze.prototype;h.toString=function(){if(this.X)return this.X;if(!this.s)return\"\";for(var a=[],b=this.s.va(),c=0;c<b.length;c++){var d=b[c],e=encodeURIComponent(String(d));d=this.ha(d);for(var f=0;f<d.length;f++){var g=e;\"\"!==d[f]&&(g+=\"=\"+encodeURIComponent(String(d[f])));a.push(g)}}return this.X=a.join(\"&\")};\nh.clone=function(){var a=new Ze;a.X=this.X;this.s&&(a.s=this.s.clone(),a.u=this.u);return a};h.ca=function(a){a=String(a);this.da&&(a=a.toLowerCase());return a};h.$d=function(a){a&&!this.da&&(kf(this),this.X=null,this.s.forEach(function(a,c){var b=c.toLowerCase();c!=b&&(this.remove(c),lf(this,b,a))},this));this.da=a};h.extend=function(a){for(var b=0;b<arguments.length;b++)ze(arguments[b],function(a,b){this.add(b,a)},this)};var nf={Kg:{qd:\"https://www.googleapis.com/identitytoolkit/v3/relyingparty/\",Wd:\"https://securetoken.googleapis.com/v1/token\",id:\"p\"},Lg:{qd:\"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/\",Wd:\"https://staging-securetoken.sandbox.googleapis.com/v1/token\",id:\"s\"},Mg:{qd:\"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/\",Wd:\"https://test-securetoken.sandbox.googleapis.com/v1/token\",id:\"t\"}},of=function(a){for(var b in nf)if(nf[b].id===a)return a=\nnf[b],{firebaseEndpoint:a.qd,secureTokenEndpoint:a.Wd};return null},pf;pf=of(\"__EID__\")?\"__EID__\":void 0;var qf=function(){var a=L();return z&&!!Cb&&11==Cb||/Edge\\/\\d+/.test(a)},rf=function(){return k.window&&k.window.location.href||\"\"},sf=function(a,b){b=b||k.window;var c=\"about:blank\";a&&(c=Bc(Ec(a)));b.location.href=c},tf=function(a,b){var c=[],d;for(d in a)d in b?typeof a[d]!=typeof b[d]?c.push(d):ha(a[d])?jb(a[d],b[d])||c.push(d):\"object\"==typeof a[d]&&null!=a[d]&&null!=b[d]?0<tf(a[d],b[d]).length&&c.push(d):a[d]!==b[d]&&c.push(d):c.push(d);for(d in b)d in a||c.push(d);return c},vf=function(){var a=\nL();a=\"Chrome\"!=uf(a)?null:(a=a.match(/\\sChrome\\/(\\d+)/i))&&2==a.length?parseInt(a[1],10):null;return a&&30>a?!1:!z||!Cb||9<Cb},wf=function(a){a=(a||L()).toLowerCase();return a.match(/android/)||a.match(/webos/)||a.match(/iphone|ipad|ipod/)||a.match(/blackberry/)||a.match(/windows phone/)||a.match(/iemobile/)?!0:!1},xf=function(a){a=a||k.window;try{a.close()}catch(b){}},yf=function(a,b,c){var d=Math.floor(1E9*Math.random()).toString();b=b||500;c=c||600;var e=(window.screen.availHeight-c)/2,f=(window.screen.availWidth-\nb)/2;b={width:b,height:c,top:0<e?e:0,left:0<f?f:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1};c=L().toLowerCase();d&&(b.target=d,v(c,\"crios/\")&&(b.target=\"_blank\"));\"Firefox\"==uf(L())&&(a=a||\"http://localhost\",b.scrollbars=!0);c=a||\"\";(a=b)||(a={});d=window;b=c instanceof Ac?c:Ec(\"undefined\"!=typeof c.href?c.href:String(c));c=a.target||c.target;e=[];for(g in a)switch(g){case \"width\":case \"height\":case \"top\":case \"left\":e.push(g+\"=\"+a[g]);break;case \"target\":case \"noopener\":case \"noreferrer\":break;\ndefault:e.push(g+\"=\"+(a[g]?1:0))}var g=e.join(\",\");(y(\"iPhone\")&&!y(\"iPod\")&&!y(\"iPad\")||y(\"iPad\")||y(\"iPod\"))&&d.navigator&&d.navigator.standalone&&c&&\"_self\"!=c?(g=d.document.createElement(\"A\"),fd(g,\"HTMLAnchorElement\"),b instanceof Ac||b instanceof Ac||(b=b.qb?b.ob():String(b),w(Cc.test(b))||(b=\"about:invalid#zClosurez\"),b=Dc(b)),g.href=Bc(b),g.setAttribute(\"target\",c),a.noreferrer&&g.setAttribute(\"rel\",\"noreferrer\"),a=document.createEvent(\"MouseEvent\"),a.initMouseEvent(\"click\",!0,!0,d,1),g.dispatchEvent(a),\ng={}):a.noreferrer?(g=d.open(\"\",c,g),d=Bc(b),g&&(sb&&v(d,\";\")&&(d=\"'\"+d.replace(/'/g,\"%27\")+\"'\"),g.opener=null,a=Ha(\"b/12014412, meta tag with sanitized URL\"),d='<META HTTP-EQUIV=\"refresh\" content=\"0; url='+wa(d)+'\">',Ca(Ga(a),\"must provide justification\"),w(!/^[\\s\\xa0]*$/.test(Ga(a)),\"must provide non-empty justification\"),g.document.write(jd((new id).Tf(d))),g.document.close())):(g=d.open(Bc(b),c,g))&&a.noopener&&(g.opener=null);if(g)try{g.focus()}catch(l){}return g},zf=function(a){return new C(function(b){var c=\nfunction(){Be(2E3).then(function(){if(!a||a.closed)b();else return c()})};return c()})},Af=/^\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}$/,Bf=function(){var a=null;return(new C(function(b){\"complete\"==k.document.readyState?b():(a=function(){b()},kc(window,\"load\",a))})).g(function(b){tc(window,\"load\",a);throw b;})},Df=function(){return Cf(void 0)?Bf().then(function(){return new C(function(a,b){var c=k.document,d=setTimeout(function(){b(Error(\"Cordova framework is not ready.\"))},1E3);c.addEventListener(\"deviceready\",\nfunction(){clearTimeout(d);a()},!1)})}):E(Error(\"Cordova must run in an Android or iOS file scheme.\"))},Cf=function(a){a=a||L();return!(\"file:\"!==Ef()||!a.toLowerCase().match(/iphone|ipad|ipod|android/))},Ff=function(){var a=k.window;try{return!(!a||a==a.top)}catch(b){return!1}},Gf=function(){return firebase.INTERNAL.hasOwnProperty(\"reactNative\")?\"ReactNative\":firebase.INTERNAL.hasOwnProperty(\"node\")?\"Node\":\"Browser\"},Hf=function(){var a=Gf();return\"ReactNative\"===a||\"Node\"===a},uf=function(a){var b=\na.toLowerCase();if(v(b,\"opera/\")||v(b,\"opr/\")||v(b,\"opios/\"))return\"Opera\";if(v(b,\"iemobile\"))return\"IEMobile\";if(v(b,\"msie\")||v(b,\"trident/\"))return\"IE\";if(v(b,\"edge/\"))return\"Edge\";if(v(b,\"firefox/\"))return\"Firefox\";if(v(b,\"silk/\"))return\"Silk\";if(v(b,\"blackberry\"))return\"Blackberry\";if(v(b,\"webos\"))return\"Webos\";if(!v(b,\"safari/\")||v(b,\"chrome/\")||v(b,\"crios/\")||v(b,\"android\"))if(!v(b,\"chrome/\")&&!v(b,\"crios/\")||v(b,\"edge/\")){if(v(b,\"android\"))return\"Android\";if((a=a.match(/([a-zA-Z\\d\\.]+)\\/[a-zA-Z\\d\\.]*$/))&&\n2==a.length)return a[1]}else return\"Chrome\";else return\"Safari\";return\"Other\"},If={Fg:\"FirebaseCore-web\",Hg:\"FirebaseUI-web\"},Jf=function(a,b){b=b||[];var c=[],d={},e;for(e in If)d[If[e]]=!0;for(e=0;e<b.length;e++)\"undefined\"!==typeof d[b[e]]&&(delete d[b[e]],c.push(b[e]));c.sort();b=c;b.length||(b=[\"FirebaseCore-web\"]);c=Gf();return(\"Browser\"===c?uf(L()):c)+\"/JsCore/\"+a+\"/\"+b.join(\",\")},L=function(){return k.navigator&&k.navigator.userAgent||\"\"},M=function(a,b){a=a.split(\".\");b=b||k;for(var c=0;c<\na.length&&\"object\"==typeof b&&null!=b;c++)b=b[a[c]];c!=a.length&&(b=void 0);return b},Lf=function(){try{var a=k.localStorage,b=Kf();if(a)return a.setItem(b,\"1\"),a.removeItem(b),qf()?!!k.indexedDB:!0}catch(c){}return!1},Nf=function(){return(Mf()||\"chrome-extension:\"===Ef()||Cf())&&!Hf()&&Lf()},Mf=function(){return\"http:\"===Ef()||\"https:\"===Ef()},Ef=function(){return k.location&&k.location.protocol||null},Of=function(a){a=a||L();return wf(a)||\"Firefox\"==uf(a)?!1:!0},Pf=function(a){return\"undefined\"===\ntypeof a?null:Hc(a)},Qf=function(a){var b={},c;for(c in a)a.hasOwnProperty(c)&&null!==a[c]&&void 0!==a[c]&&(b[c]=a[c]);return b},Rf=function(a){if(null!==a)return JSON.parse(a)},Kf=function(a){return a?a:\"\"+Math.floor(1E9*Math.random()).toString()},Sf=function(a){a=a||L();return\"Safari\"==uf(a)||a.toLowerCase().match(/iphone|ipad|ipod/)?!1:!0},Tf=function(){var a=k.___jsl;if(a&&a.H)for(var b in a.H)if(a.H[b].r=a.H[b].r||[],a.H[b].L=a.H[b].L||[],a.H[b].r=a.H[b].L.concat(),a.CP)for(var c=0;c<a.CP.length;c++)a.CP[c]=\nnull},Uf=function(){var a=k.navigator;return a&&\"boolean\"===typeof a.onLine&&(Mf()||\"chrome-extension:\"===Ef()||\"undefined\"!==typeof a.connection)?a.onLine:!0},Vf=function(a,b,c,d){if(a>b)throw Error(\"Short delay should be less than long delay!\");this.ug=a;this.ag=b;a=c||L();d=d||Gf();this.Wf=wf(a)||\"ReactNative\"===d};Vf.prototype.get=function(){return this.Wf?this.ag:this.ug};\nvar Wf=function(){var a=k.document;return a&&\"undefined\"!==typeof a.visibilityState?\"visible\"==a.visibilityState:!0},Xf=function(){var a=k.document,b=null;return Wf()||!a?D():(new C(function(c){b=function(){Wf()&&(a.removeEventListener(\"visibilitychange\",b,!1),c())};a.addEventListener(\"visibilitychange\",b,!1)})).g(function(c){a.removeEventListener(\"visibilitychange\",b,!1);throw c;})},Yf=function(a){try{var b=new Date(parseInt(a,10));if(!isNaN(b.getTime())&&!/[^0-9]/.test(a))return b.toUTCString()}catch(c){}return null};var Zf={};var $f;try{var ag={};Object.defineProperty(ag,\"abcd\",{configurable:!0,enumerable:!0,value:1});Object.defineProperty(ag,\"abcd\",{configurable:!0,enumerable:!0,value:2});$f=2==ag.abcd}catch(a){$f=!1}\nvar N=function(a,b,c){$f?Object.defineProperty(a,b,{configurable:!0,enumerable:!0,value:c}):a[b]=c},bg=function(a,b){if(b)for(var c in b)b.hasOwnProperty(c)&&N(a,c,b[c])},cg=function(a){var b={};bg(b,a);return b},dg=function(a){var b={},c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b},eg=function(a,b){if(!b||!b.length)return!0;if(!a)return!1;for(var c=0;c<b.length;c++){var d=a[b[c]];if(void 0===d||null===d||\"\"===d)return!1}return!0},fg=function(a){var b=a;if(\"object\"==typeof a&&null!=a){b=\n\"length\"in a?[]:{};for(var c in a)N(b,c,fg(a[c]))}return b};var gg=\"oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version\".split(\" \"),hg=[\"client_id\",\"response_type\",\"scope\",\"redirect_uri\",\"state\"],ig={Gg:{Dc:\"locale\",Zb:500,Yb:600,providerId:\"facebook.com\",Ud:hg},Ig:{Dc:null,Zb:500,Yb:620,providerId:\"github.com\",Ud:hg},Jg:{Dc:\"hl\",Zb:515,Yb:680,providerId:\"google.com\",Ud:hg},Ng:{Dc:\"lang\",Zb:485,Yb:705,providerId:\"twitter.com\",Ud:gg}},jg=function(a){for(var b in ig)if(ig[b].providerId==a)return ig[b];\nreturn null};var O=function(a,b){this.code=\"auth/\"+a;this.message=b||kg[a]||\"\"};t(O,Error);O.prototype.A=function(){return{code:this.code,message:this.message}};O.prototype.toJSON=function(){return this.A()};\nvar lg=function(a){var b=a&&a.code;return b?new O(b.substring(5),a.message):null},kg={\"argument-error\":\"\",\"app-not-authorized\":\"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.\",\"app-not-installed\":\"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.\",\"captcha-check-failed\":\"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.\",\n\"code-expired\":\"The SMS code has expired. Please re-send the verification code to try again.\",\"cordova-not-ready\":\"Cordova framework is not ready.\",\"cors-unsupported\":\"This browser is not supported.\",\"credential-already-in-use\":\"This credential is already associated with a different user account.\",\"custom-token-mismatch\":\"The custom token corresponds to a different audience.\",\"requires-recent-login\":\"This operation is sensitive and requires recent authentication. Log in again before retrying this request.\",\n\"dynamic-link-not-activated\":\"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.\",\"email-already-in-use\":\"The email address is already in use by another account.\",\"expired-action-code\":\"The action code has expired. \",\"cancelled-popup-request\":\"This operation has been cancelled due to another conflicting popup being opened.\",\"internal-error\":\"An internal error has occurred.\",\"invalid-app-credential\":\"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.\",\n\"invalid-app-id\":\"The mobile app identifier is not registed for the current project.\",\"invalid-user-token\":\"The user's credential is no longer valid. The user must sign in again.\",\"invalid-auth-event\":\"An internal error has occurred.\",\"invalid-verification-code\":\"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.\",\"invalid-continue-uri\":\"The continue URL provided in the request is invalid.\",\n\"invalid-cordova-configuration\":\"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.\",\"invalid-custom-token\":\"The custom token format is incorrect. Please check the documentation.\",\"invalid-email\":\"The email address is badly formatted.\",\"invalid-api-key\":\"Your API key is invalid, please check you have copied it correctly.\",\"invalid-credential\":\"The supplied auth credential is malformed or has expired.\",\n\"invalid-persistence-type\":\"The specified persistence type is invalid. It can only be local, session or none.\",\"invalid-message-payload\":\"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.\",\"invalid-oauth-provider\":\"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.\",\"invalid-oauth-client-id\":\"The OAuth client ID provided is either invalid or does not match the specified API key.\",\n\"unauthorized-domain\":\"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.\",\"invalid-action-code\":\"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.\",\"wrong-password\":\"The password is invalid or the user does not have a password.\",\"invalid-phone-number\":\"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].\",\n\"invalid-recipient-email\":\"The email corresponding to this action failed to send as the provided recipient email address is invalid.\",\"invalid-sender\":\"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.\",\"invalid-verification-id\":\"The verification ID used to create the phone auth credential is invalid.\",\"missing-android-pkg-name\":\"An Android Package Name must be provided if the Android App is required to be installed.\",\n\"auth-domain-config-required\":\"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.\",\"missing-app-credential\":\"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.\",\"missing-verification-code\":\"The phone auth credential was created with an empty SMS verification code.\",\"missing-continue-uri\":\"A continue URL must be provided in the request.\",\"missing-iframe-start\":\"An internal error has occurred.\",\n\"missing-ios-bundle-id\":\"An iOS Bundle ID must be provided if an App Store ID is provided.\",\"missing-phone-number\":\"To send verification codes, provide a phone number for the recipient.\",\"missing-verification-id\":\"The phone auth credential was created with an empty verification ID.\",\"app-deleted\":\"This instance of FirebaseApp has been deleted.\",\"account-exists-with-different-credential\":\"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.\",\n\"network-request-failed\":\"A network error (such as timeout, interrupted connection or unreachable host) has occurred.\",\"no-auth-event\":\"An internal error has occurred.\",\"no-such-provider\":\"User was not linked to an account with the given provider.\",\"operation-not-allowed\":\"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.\",\"operation-not-supported-in-this-environment\":'This operation is not supported in the environment this application is running on. \"location.protocol\" must be http, https or chrome-extension and web storage must be enabled.',\n\"popup-blocked\":\"Unable to establish a connection with the popup. It may have been blocked by the browser.\",\"popup-closed-by-user\":\"The popup has been closed by the user before finalizing the operation.\",\"provider-already-linked\":\"User can only be linked to one identity for the given provider.\",\"quota-exceeded\":\"The project's quota for this operation has been exceeded.\",\"redirect-cancelled-by-user\":\"The redirect operation has been cancelled by the user before finalizing.\",\"redirect-operation-pending\":\"A redirect sign-in operation is already pending.\",\ntimeout:\"The operation has timed out.\",\"user-token-expired\":\"The user's credential is no longer valid. The user must sign in again.\",\"too-many-requests\":\"We have blocked all requests from this device due to unusual activity. Try again later.\",\"unauthorized-continue-uri\":\"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.\",\"unsupported-persistence-type\":\"The current environment does not support the specified persistence type.\",\"user-cancelled\":\"User did not grant your application the permissions it requested.\",\n\"user-not-found\":\"There is no user record corresponding to this identifier. The user may have been deleted.\",\"user-disabled\":\"The user account has been disabled by an administrator.\",\"user-mismatch\":\"The supplied credentials do not correspond to the previously signed in user.\",\"user-signed-out\":\"\",\"weak-password\":\"The password must be 6 characters long or more.\",\"web-storage-unsupported\":\"This browser is not supported or 3rd party cookies and data may be disabled.\"};var mg=function(a,b,c,d,e){this.ma=a;this.Y=b||null;this.Eb=c||null;this.Yd=d||null;this.ba=e||null;if(this.Eb||this.ba){if(this.Eb&&this.ba)throw new O(\"invalid-auth-event\");if(this.Eb&&!this.Yd)throw new O(\"invalid-auth-event\");}else throw new O(\"invalid-auth-event\");};mg.prototype.tc=function(){return this.Yd};mg.prototype.getError=function(){return this.ba};mg.prototype.A=function(){return{type:this.ma,eventId:this.Y,urlResponse:this.Eb,sessionId:this.Yd,error:this.ba&&this.ba.A()}};\nvar ng=function(a){a=a||{};return a.type?new mg(a.type,a.eventId,a.urlResponse,a.sessionId,a.error&&lg(a.error)):null};var og=function(a){var b=\"unauthorized-domain\",c=void 0,d=gf(a);a=d.pa;d=d.qa;\"chrome-extension\"==d?c=na(\"This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.\",a):\"http\"==d||\"https\"==d?c=na(\"This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.\",a):b=\n\"operation-not-supported-in-this-environment\";O.call(this,b,c)};t(og,O);var pg=function(a){this.Zf=a.sub;ma();this.Mb=a.email||null;this.Rd=a.provider_id||a.firebase&&a.firebase.sign_in_provider||null;this.qf=!!a.is_anonymous||\"anonymous\"==this.Rd};pg.prototype.getEmail=function(){return this.Mb};pg.prototype.isAnonymous=function(){return this.qf};var qg=function(a){a=a.split(\".\");if(3!=a.length)return null;a=a[1];for(var b=(4-a.length%4)%4,c=0;c<b;c++)a+=\".\";try{var d=JSON.parse(Hb(a));if(d.sub&&d.iss&&d.aud&&d.exp)return new pg(d)}catch(e){}return null};var rg=function(a,b){return a.then(function(a){if(a.idToken){var c=qg(a.idToken);if(!c||b!=c.Zf)throw new O(\"user-mismatch\");return a}throw new O(\"user-mismatch\");}).g(function(a){throw a&&a.code&&\"auth/user-not-found\"==a.code?new O(\"user-mismatch\"):a;})},sg=function(a,b){if(b.idToken||b.accessToken)b.idToken&&N(this,\"idToken\",b.idToken),b.accessToken&&N(this,\"accessToken\",b.accessToken);else if(b.oauthToken&&b.oauthTokenSecret)N(this,\"accessToken\",b.oauthToken),N(this,\"secret\",b.oauthTokenSecret);\nelse throw new O(\"internal-error\",\"failed to construct a credential\");N(this,\"providerId\",a)};sg.prototype.Ob=function(a){return tg(a,ug(this))};sg.prototype.Fc=function(a,b){var c=ug(this);c.idToken=b;return vg(a,c)};sg.prototype.Gd=function(a,b){var c=ug(this);return rg(wg(a,c),b)};var ug=function(a){var b={};a.idToken&&(b.id_token=a.idToken);a.accessToken&&(b.access_token=a.accessToken);a.secret&&(b.oauth_token_secret=a.secret);b.providerId=a.providerId;return{postBody:mf(b).toString(),requestUri:\"http://localhost\"}};\nsg.prototype.A=function(){var a={providerId:this.providerId};this.idToken&&(a.oauthIdToken=this.idToken);this.accessToken&&(a.oauthAccessToken=this.accessToken);this.secret&&(a.oauthTokenSecret=this.secret);return a};var xg=function(a,b){this.kg=b||[];bg(this,{providerId:a,isOAuthProvider:!0});this.qe={};this.Ed=(jg(a)||{}).Dc||null;this.nd=null};xg.prototype.setCustomParameters=function(a){this.qe=kb(a);return this};var P=function(a){xg.call(this,a,hg);this.Vd=[]};t(P,xg);\nP.prototype.addScope=function(a){Va(this.Vd,a)||this.Vd.push(a);return this};P.prototype.ye=function(){return $a(this.Vd)};P.prototype.credential=function(a,b){if(!a&&!b)throw new O(\"argument-error\",\"credential failed: must provide the ID token and/or the access token.\");return new sg(this.providerId,{idToken:a||null,accessToken:b||null})};var yg=function(){P.call(this,\"facebook.com\")};t(yg,P);N(yg,\"PROVIDER_ID\",\"facebook.com\");\nvar zg=function(a){if(!a)throw new O(\"argument-error\",\"credential failed: expected 1 argument (the OAuth access token).\");var b=a;q(a)&&(b=a.accessToken);return(new yg).credential(null,b)},Ag=function(){P.call(this,\"github.com\")};t(Ag,P);N(Ag,\"PROVIDER_ID\",\"github.com\");var Bg=function(a){if(!a)throw new O(\"argument-error\",\"credential failed: expected 1 argument (the OAuth access token).\");var b=a;q(a)&&(b=a.accessToken);return(new Ag).credential(null,b)},Cg=function(){P.call(this,\"google.com\");this.addScope(\"profile\")};\nt(Cg,P);N(Cg,\"PROVIDER_ID\",\"google.com\");var Dg=function(a,b){var c=a;q(a)&&(c=a.idToken,b=a.accessToken);return(new Cg).credential(c,b)},Eg=function(){xg.call(this,\"twitter.com\",gg)};t(Eg,xg);N(Eg,\"PROVIDER_ID\",\"twitter.com\");\nvar Fg=function(a,b){var c=a;q(c)||(c={oauthToken:a,oauthTokenSecret:b});if(!c.oauthToken||!c.oauthTokenSecret)throw new O(\"argument-error\",\"credential failed: expected 2 arguments (the OAuth access token and secret).\");return new sg(\"twitter.com\",c)},Gg=function(a,b){this.Mb=a;this.Ld=b;N(this,\"providerId\",\"password\")};Gg.prototype.Ob=function(a){return Q(a,Hg,{email:this.Mb,password:this.Ld})};Gg.prototype.Fc=function(a,b){return Q(a,Ig,{idToken:b,email:this.Mb,password:this.Ld})};\nGg.prototype.Gd=function(a,b){return rg(this.Ob(a),b)};Gg.prototype.A=function(){return{email:this.Mb,password:this.Ld}};var Jg=function(){bg(this,{providerId:\"password\",isOAuthProvider:!1})};bg(Jg,{PROVIDER_ID:\"password\"});var Kg=function(a){if(!(a.verificationId&&a.$c||a.hc&&a.phoneNumber))throw new O(\"internal-error\");this.U=a;N(this,\"providerId\",\"phone\")};Kg.prototype.Ob=function(a){return a.verifyPhoneNumber(Lg(this))};Kg.prototype.Fc=function(a,b){var c=Lg(this);c.idToken=b;return Q(a,Mg,c)};\nKg.prototype.Gd=function(a,b){var c=Lg(this);c.operation=\"REAUTH\";a=Q(a,Ng,c);return rg(a,b)};Kg.prototype.A=function(){var a={providerId:\"phone\"};this.U.verificationId&&(a.verificationId=this.U.verificationId);this.U.$c&&(a.verificationCode=this.U.$c);this.U.hc&&(a.temporaryProof=this.U.hc);this.U.phoneNumber&&(a.phoneNumber=this.U.phoneNumber);return a};\nvar Lg=function(a){return a.U.hc&&a.U.phoneNumber?{temporaryProof:a.U.hc,phoneNumber:a.U.phoneNumber}:{sessionInfo:a.U.verificationId,code:a.U.$c}},Og=function(a){try{this.tf=a||firebase.auth()}catch(b){throw new O(\"argument-error\",\"Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().\");}bg(this,{providerId:\"phone\",isOAuthProvider:!1})};\nOg.prototype.verifyPhoneNumber=function(a,b){var c=this.tf.f;return D(b.verify()).then(function(d){if(!m(d))throw new O(\"argument-error\",\"An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.\");switch(b.type){case \"recaptcha\":return Q(c,Pg,{phoneNumber:a,recaptchaToken:d});default:throw new O(\"argument-error\",'Only firebase.auth.ApplicationVerifiers with type=\"recaptcha\" are currently supported.');}})};\nvar Qg=function(a,b){if(!a)throw new O(\"missing-verification-id\");if(!b)throw new O(\"missing-verification-code\");return new Kg({verificationId:a,$c:b})};bg(Og,{PROVIDER_ID:\"phone\"});\nvar Rg=function(a){if(a.temporaryProof&&a.phoneNumber)return new Kg({hc:a.temporaryProof,phoneNumber:a.phoneNumber});var b=a&&a.providerId;if(!b||\"password\"===b)return null;var c=a&&a.oauthAccessToken,d=a&&a.oauthTokenSecret;a=a&&a.oauthIdToken;try{switch(b){case \"google.com\":return Dg(a,c);case \"facebook.com\":return zg(c);case \"github.com\":return Bg(c);case \"twitter.com\":return Fg(c,d);default:return(new P(b)).credential(a,c)}}catch(e){return null}},Sg=function(a){if(!a.isOAuthProvider)throw new O(\"invalid-oauth-provider\");\n};var Tg=function(a,b,c){O.call(this,a,c);a=b||{};a.email&&N(this,\"email\",a.email);a.phoneNumber&&N(this,\"phoneNumber\",a.phoneNumber);a.credential&&N(this,\"credential\",a.credential)};t(Tg,O);Tg.prototype.A=function(){var a={code:this.code,message:this.message};this.email&&(a.email=this.email);this.phoneNumber&&(a.phoneNumber=this.phoneNumber);var b=this.credential&&this.credential.A();b&&mb(a,b);return a};Tg.prototype.toJSON=function(){return this.A()};\nvar Ug=function(a){if(a.code){var b=a.code||\"\";0==b.indexOf(\"auth/\")&&(b=b.substring(5));var c={credential:Rg(a)};if(a.email)c.email=a.email;else if(a.phoneNumber)c.phoneNumber=a.phoneNumber;else return new O(b,a.message||void 0);return new Tg(b,c,a.message)}return null};var Vg=function(a){this.Eg=a};t(Vg,Lc);Vg.prototype.rc=function(){return new this.Eg};Vg.prototype.Cd=function(){return{}};\nvar R=function(a,b,c){var d=\"Node\"==Gf();d=k.XMLHttpRequest||d&&firebase.INTERNAL.node&&firebase.INTERNAL.node.XMLHttpRequest;if(!d)throw new O(\"internal-error\",\"The XMLHttpRequest compatibility library was not found.\");this.m=a;a=b||{};this.qg=a.secureTokenEndpoint||\"https://securetoken.googleapis.com/v1/token\";this.rg=a.secureTokenTimeout||Wg;this.Pc=kb(a.secureTokenHeaders||Xg);this.Df=a.firebaseEndpoint||\"https://www.googleapis.com/identitytoolkit/v3/relyingparty/\";this.Ef=a.firebaseTimeout||\nYg;this.mb=kb(a.firebaseHeaders||Zg);c&&(this.mb[\"X-Client-Version\"]=c,this.Pc[\"X-Client-Version\"]=c);this.vf=new Qc;this.Dg=new Vg(d)},$g,Wg=new Vf(3E4,6E4),Xg={\"Content-Type\":\"application/x-www-form-urlencoded\"},Yg=new Vf(3E4,6E4),Zg={\"Content-Type\":\"application/json\"},ah=function(a,b){b?a.mb[\"X-Firebase-Locale\"]=b:delete a.mb[\"X-Firebase-Locale\"]},bh=function(a,b){b?(a.mb[\"X-Client-Version\"]=b,a.Pc[\"X-Client-Version\"]=b):(delete a.mb[\"X-Client-Version\"],delete a.Pc[\"X-Client-Version\"])},dh=function(a,\nb,c,d,e,f,g){Uf()?(vf()?a=r(a.tg,a):($g||($g=new C(function(a,b){ch(a,b)})),a=r(a.sg,a)),a(b,c,d,e,f,g)):c&&c(null)};\nR.prototype.tg=function(a,b,c,d,e,f){var g=\"Node\"==Gf(),l=Hf()?g?new I(this.Dg):new I:new I(this.vf);if(f){l.Db=Math.max(0,f);var n=setTimeout(function(){l.dispatchEvent(\"timeout\")},f)}l.listen(\"complete\",function(){n&&clearTimeout(n);var a=null;try{a=JSON.parse(Re(this))||null}catch(zb){a=null}b&&b(a)});sc(l,\"ready\",function(){n&&clearTimeout(n);this.Ma||(this.Ma=!0,this.lb())});sc(l,\"timeout\",function(){n&&clearTimeout(n);this.Ma||(this.Ma=!0,this.lb());b&&b(null)});l.send(a,c,d,e)};\nvar eh=Ha(\"https://apis.google.com/js/client.js?onload=%{onload}\"),fh=\"__fcb\"+Math.floor(1E6*Math.random()).toString(),ch=function(a,b){if(((window.gapi||{}).client||{}).request)a();else{k[fh]=function(){((window.gapi||{}).client||{}).request?a():b(Error(\"CORS_UNSUPPORTED\"))};var c=Oa(eh,{onload:fh});Wd(de(c),function(){b(Error(\"CORS_UNSUPPORTED\"))})}};\nR.prototype.sg=function(a,b,c,d,e){var f=this;$g.then(function(){window.gapi.client.setApiKey(f.m);var g=window.gapi.auth.getToken();window.gapi.auth.setToken(null);window.gapi.client.request({path:a,method:c,body:d,headers:e,authType:\"none\",callback:function(a){window.gapi.auth.setToken(g);b&&b(a)}})}).g(function(a){b&&b({error:{message:a&&a.message||\"CORS_UNSUPPORTED\"}})})};\nvar hh=function(a,b){return new C(function(c,d){\"refresh_token\"==b.grant_type&&b.refresh_token||\"authorization_code\"==b.grant_type&&b.code?dh(a,a.qg+\"?key=\"+encodeURIComponent(a.m),function(a){a?a.error?d(gh(a)):a.access_token&&a.refresh_token?c(a):d(new O(\"internal-error\")):d(new O(\"network-request-failed\"))},\"POST\",mf(b).toString(),a.Pc,a.rg.get()):d(new O(\"internal-error\"))})},ih=function(a,b,c,d,e,f){var g=gf(a.Df+b);K(g,\"key\",a.m);f&&K(g,\"cb\",ma().toString());var l=\"GET\"==c;if(l)for(var n in d)d.hasOwnProperty(n)&&\nK(g,n,d[n]);return new C(function(b,f){dh(a,g.toString(),function(a){a?a.error?f(gh(a,e||{})):b(a):f(new O(\"network-request-failed\"))},c,l?void 0:Hc(Qf(d)),a.mb,a.Ef.get())})},jh=function(a){if(!yc.test(a.email))throw new O(\"invalid-email\");},kh=function(a){\"email\"in a&&jh(a)},mh=function(a,b){return Q(a,lh,{identifier:b,continueUri:Mf()?rf():\"http://localhost\"}).then(function(a){return a.allProviders||[]})},oh=function(a){return Q(a,nh,{}).then(function(a){return a.authorizedDomains||[]})},ph=function(a){if(!a.idToken)throw new O(\"internal-error\");\n},qh=function(a){if(a.phoneNumber||a.temporaryProof){if(!a.phoneNumber||!a.temporaryProof)throw new O(\"internal-error\");}else{if(!a.sessionInfo)throw new O(\"missing-verification-id\");if(!a.code)throw new O(\"missing-verification-code\");}};R.prototype.signInAnonymously=function(){return Q(this,rh,{})};R.prototype.updateEmail=function(a,b){return Q(this,sh,{idToken:a,email:b})};R.prototype.updatePassword=function(a,b){return Q(this,Ig,{idToken:a,password:b})};var th={displayName:\"DISPLAY_NAME\",photoUrl:\"PHOTO_URL\"};\nR.prototype.updateProfile=function(a,b){var c={idToken:a},d=[];eb(th,function(a,f){var e=b[f];null===e?d.push(a):f in b&&(c[f]=e)});d.length&&(c.deleteAttribute=d);return Q(this,sh,c)};R.prototype.sendPasswordResetEmail=function(a,b){a={requestType:\"PASSWORD_RESET\",email:a};mb(a,b);return Q(this,uh,a)};R.prototype.sendEmailVerification=function(a,b){a={requestType:\"VERIFY_EMAIL\",idToken:a};mb(a,b);return Q(this,vh,a)};R.prototype.verifyPhoneNumber=function(a){return Q(this,wh,a)};\nvar yh=function(a,b,c){return Q(a,xh,{idToken:b,deleteProvider:c})},zh=function(a){if(!a.requestUri||!a.sessionId&&!a.postBody)throw new O(\"internal-error\");},Ah=function(a){var b=null;a.needConfirmation?(a.code=\"account-exists-with-different-credential\",b=Ug(a)):\"FEDERATED_USER_ID_ALREADY_LINKED\"==a.errorMessage?(a.code=\"credential-already-in-use\",b=Ug(a)):\"EMAIL_EXISTS\"==a.errorMessage&&(a.code=\"email-already-in-use\",b=Ug(a));if(b)throw b;if(!a.idToken)throw new O(\"internal-error\");},tg=function(a,\nb){b.returnIdpCredential=!0;return Q(a,Bh,b)},vg=function(a,b){b.returnIdpCredential=!0;return Q(a,Ch,b)},wg=function(a,b){b.returnIdpCredential=!0;b.autoCreate=!1;return Q(a,Dh,b)},Eh=function(a){if(!a.oobCode)throw new O(\"invalid-action-code\");};R.prototype.confirmPasswordReset=function(a,b){return Q(this,Fh,{oobCode:a,newPassword:b})};R.prototype.checkActionCode=function(a){return Q(this,Gh,{oobCode:a})};R.prototype.applyActionCode=function(a){return Q(this,Hh,{oobCode:a})};\nvar Hh={endpoint:\"setAccountInfo\",F:Eh,cb:\"email\"},Gh={endpoint:\"resetPassword\",F:Eh,$:function(a){if(!a.email||!a.requestType)throw new O(\"internal-error\");}},Ih={endpoint:\"signupNewUser\",F:function(a){jh(a);if(!a.password)throw new O(\"weak-password\");},$:ph,Aa:!0},lh={endpoint:\"createAuthUri\"},Jh={endpoint:\"deleteAccount\",ab:[\"idToken\"]},xh={endpoint:\"setAccountInfo\",ab:[\"idToken\",\"deleteProvider\"],F:function(a){if(!ha(a.deleteProvider))throw new O(\"internal-error\");}},Kh={endpoint:\"getAccountInfo\"},\nvh={endpoint:\"getOobConfirmationCode\",ab:[\"idToken\",\"requestType\"],F:function(a){if(\"VERIFY_EMAIL\"!=a.requestType)throw new O(\"internal-error\");},cb:\"email\"},uh={endpoint:\"getOobConfirmationCode\",ab:[\"requestType\"],F:function(a){if(\"PASSWORD_RESET\"!=a.requestType)throw new O(\"internal-error\");jh(a)},cb:\"email\"},nh={ie:!0,endpoint:\"getProjectConfig\",De:\"GET\"},Lh={ie:!0,endpoint:\"getRecaptchaParam\",De:\"GET\",$:function(a){if(!a.recaptchaSiteKey)throw new O(\"internal-error\");}},Fh={endpoint:\"resetPassword\",\nF:Eh,cb:\"email\"},Pg={endpoint:\"sendVerificationCode\",ab:[\"phoneNumber\",\"recaptchaToken\"],cb:\"sessionInfo\"},sh={endpoint:\"setAccountInfo\",ab:[\"idToken\"],F:kh,Aa:!0},Ig={endpoint:\"setAccountInfo\",ab:[\"idToken\"],F:function(a){kh(a);if(!a.password)throw new O(\"weak-password\");},$:ph,Aa:!0},rh={endpoint:\"signupNewUser\",$:ph,Aa:!0},Bh={endpoint:\"verifyAssertion\",F:zh,$:Ah,Aa:!0},Dh={endpoint:\"verifyAssertion\",F:zh,$:function(a){if(a.errorMessage&&\"USER_NOT_FOUND\"==a.errorMessage)throw new O(\"user-not-found\");\nif(!a.idToken)throw new O(\"internal-error\");},Aa:!0},Ch={endpoint:\"verifyAssertion\",F:function(a){zh(a);if(!a.idToken)throw new O(\"internal-error\");},$:Ah,Aa:!0},Mh={endpoint:\"verifyCustomToken\",F:function(a){if(!a.token)throw new O(\"invalid-custom-token\");},$:ph,Aa:!0},Hg={endpoint:\"verifyPassword\",F:function(a){jh(a);if(!a.password)throw new O(\"wrong-password\");},$:ph,Aa:!0},wh={endpoint:\"verifyPhoneNumber\",F:qh,$:ph},Mg={endpoint:\"verifyPhoneNumber\",F:function(a){if(!a.idToken)throw new O(\"internal-error\");\nqh(a)},$:function(a){if(a.temporaryProof)throw a.code=\"credential-already-in-use\",Ug(a);ph(a)}},Ng={yf:{USER_NOT_FOUND:\"user-not-found\"},endpoint:\"verifyPhoneNumber\",F:qh,$:ph},Q=function(a,b,c){if(!eg(c,b.ab))return E(new O(\"internal-error\"));var d=b.De||\"POST\",e;return D(c).then(b.F).then(function(){b.Aa&&(c.returnSecureToken=!0);return ih(a,b.endpoint,d,c,b.yf,b.ie||!1)}).then(function(a){return e=a}).then(b.$).then(function(){if(!b.cb)return e;if(!(b.cb in e))throw new O(\"internal-error\");return e[b.cb]})},\ngh=function(a,b){var c=(a.error&&a.error.errors&&a.error.errors[0]||{}).reason||\"\";var d={keyInvalid:\"invalid-api-key\",ipRefererBlocked:\"app-not-authorized\"};if(c=d[c]?new O(d[c]):null)return c;c=a.error&&a.error.message||\"\";d={INVALID_CUSTOM_TOKEN:\"invalid-custom-token\",CREDENTIAL_MISMATCH:\"custom-token-mismatch\",MISSING_CUSTOM_TOKEN:\"internal-error\",INVALID_IDENTIFIER:\"invalid-email\",MISSING_CONTINUE_URI:\"internal-error\",INVALID_EMAIL:\"invalid-email\",INVALID_PASSWORD:\"wrong-password\",USER_DISABLED:\"user-disabled\",\nMISSING_PASSWORD:\"internal-error\",EMAIL_EXISTS:\"email-already-in-use\",PASSWORD_LOGIN_DISABLED:\"operation-not-allowed\",INVALID_IDP_RESPONSE:\"invalid-credential\",FEDERATED_USER_ID_ALREADY_LINKED:\"credential-already-in-use\",INVALID_MESSAGE_PAYLOAD:\"invalid-message-payload\",INVALID_RECIPIENT_EMAIL:\"invalid-recipient-email\",INVALID_SENDER:\"invalid-sender\",EMAIL_NOT_FOUND:\"user-not-found\",EXPIRED_OOB_CODE:\"expired-action-code\",INVALID_OOB_CODE:\"invalid-action-code\",MISSING_OOB_CODE:\"internal-error\",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:\"requires-recent-login\",\nINVALID_ID_TOKEN:\"invalid-user-token\",TOKEN_EXPIRED:\"user-token-expired\",USER_NOT_FOUND:\"user-token-expired\",CORS_UNSUPPORTED:\"cors-unsupported\",DYNAMIC_LINK_NOT_ACTIVATED:\"dynamic-link-not-activated\",INVALID_APP_ID:\"invalid-app-id\",TOO_MANY_ATTEMPTS_TRY_LATER:\"too-many-requests\",WEAK_PASSWORD:\"weak-password\",OPERATION_NOT_ALLOWED:\"operation-not-allowed\",USER_CANCELLED:\"user-cancelled\",CAPTCHA_CHECK_FAILED:\"captcha-check-failed\",INVALID_APP_CREDENTIAL:\"invalid-app-credential\",INVALID_CODE:\"invalid-verification-code\",\nINVALID_PHONE_NUMBER:\"invalid-phone-number\",INVALID_SESSION_INFO:\"invalid-verification-id\",INVALID_TEMPORARY_PROOF:\"invalid-credential\",MISSING_APP_CREDENTIAL:\"missing-app-credential\",MISSING_CODE:\"missing-verification-code\",MISSING_PHONE_NUMBER:\"missing-phone-number\",MISSING_SESSION_INFO:\"missing-verification-id\",QUOTA_EXCEEDED:\"quota-exceeded\",SESSION_EXPIRED:\"code-expired\",INVALID_CONTINUE_URI:\"invalid-continue-uri\",MISSING_ANDROID_PACKAGE_NAME:\"missing-android-pkg-name\",MISSING_IOS_BUNDLE_ID:\"missing-ios-bundle-id\",\nUNAUTHORIZED_DOMAIN:\"unauthorized-continue-uri\",INVALID_OAUTH_CLIENT_ID:\"invalid-oauth-client-id\"};mb(d,b||{});b=(b=c.match(/^[^\\s]+\\s*:\\s*(.*)$/))&&1<b.length?b[1]:void 0;for(var e in d)if(0===c.indexOf(e))return new O(d[e],b);!b&&a&&(b=Pf(a));return new O(\"internal-error\",b)};var Oh=function(a){this.Bg=a;this.yc=null;this.Id=Nh(this)},Nh=function(a){return Ph().then(function(){return new C(function(b,c){M(\"gapi.iframes.getContext\")().open({where:document.body,url:a.Bg,messageHandlersFilter:M(\"gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER\"),attributes:{style:{position:\"absolute\",top:\"-100px\",width:\"1px\",height:\"1px\"}},dontclear:!0},function(d){a.yc=d;a.yc.restyle({setHideOnLeave:!1});var e=setTimeout(function(){c(Error(\"Network Error\"))},Qh.get()),f=function(){clearTimeout(e);\nb()};d.ping(f).then(f,function(){c(Error(\"Network Error\"))})})})})};Oh.prototype.sendMessage=function(a){var b=this;return this.Id.then(function(){return new C(function(c){b.yc.send(a.type,a,c,M(\"gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER\"))})})};\nvar Rh=function(a,b){a.Id.then(function(){a.yc.register(\"authEvent\",b,M(\"gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER\"))})},Sh=Ha(\"https://apis.google.com/js/api.js?onload=%{onload}\"),Th=new Vf(3E4,6E4),Qh=new Vf(5E3,15E3),Uh=null,Ph=function(){return Uh?Uh:Uh=(new C(function(a,b){if(Uf()){var c=function(){Tf();M(\"gapi.load\")(\"gapi.iframes\",{callback:a,ontimeout:function(){Tf();b(Error(\"Network Error\"))},timeout:Th.get()})};if(M(\"gapi.iframes.Iframe\"))a();else if(M(\"gapi.load\"))c();else{var d=\"__iframefcb\"+\nMath.floor(1E6*Math.random()).toString();k[d]=function(){M(\"gapi.load\")?c():b(Error(\"Network Error\"))};d=Oa(Sh,{onload:d});D(de(d)).g(function(){b(Error(\"Network Error\"))})}}else b(Error(\"Network Error\"))})).g(function(a){Uh=null;throw a;})};var Vh=function(a,b,c){this.B=a;this.m=b;this.o=c;this.fb=null;this.Ba=hf(this.B,\"/__/auth/iframe\");K(this.Ba,\"apiKey\",this.m);K(this.Ba,\"appName\",this.o);this.P=null;this.M=[]};Vh.prototype.ae=function(a){this.fb=a;return this};Vh.prototype.Zd=function(a){this.P=a;return this};\nVh.prototype.toString=function(){this.fb?K(this.Ba,\"v\",this.fb):this.Ba.removeParameter(\"v\");this.P?K(this.Ba,\"eid\",this.P):this.Ba.removeParameter(\"eid\");this.M.length?K(this.Ba,\"fw\",this.M.join(\",\")):this.Ba.removeParameter(\"fw\");return this.Ba.toString()};var Wh=function(a,b,c,d,e){this.B=a;this.m=b;this.o=c;this.sf=d;this.fb=this.Y=this.Td=null;this.xb=e;this.P=null};Wh.prototype.ae=function(a){this.fb=a;return this};Wh.prototype.Zd=function(a){this.P=a;return this};\nWh.prototype.toString=function(){var a=hf(this.B,\"/__/auth/handler\");K(a,\"apiKey\",this.m);K(a,\"appName\",this.o);K(a,\"authType\",this.sf);if(this.xb.isOAuthProvider){var b=this.xb;try{var c=firebase.app(this.o).auth().ia}catch(l){c=null}b.nd=c;K(a,\"providerId\",this.xb.providerId);b=this.xb;c=Qf(b.qe);for(var d in c)c[d]=c[d].toString();d=b.kg;c=kb(c);for(var e=0;e<d.length;e++){var f=d[e];f in c&&delete c[f]}b.Ed&&b.nd&&!c[b.Ed]&&(c[b.Ed]=b.nd);ib(c)||K(a,\"customParameters\",Pf(c))}\"function\"===typeof this.xb.ye&&\n(b=this.xb.ye(),b.length&&K(a,\"scopes\",b.join(\",\")));this.Td?K(a,\"redirectUrl\",this.Td):a.removeParameter(\"redirectUrl\");this.Y?K(a,\"eventId\",this.Y):a.removeParameter(\"eventId\");this.fb?K(a,\"v\",this.fb):a.removeParameter(\"v\");if(this.mc)for(var g in this.mc)this.mc.hasOwnProperty(g)&&!ff(a,g)&&K(a,g,this.mc[g]);this.P?K(a,\"eid\",this.P):a.removeParameter(\"eid\");g=Xh(this.o);g.length&&K(a,\"fw\",g.join(\",\"));return a.toString()};\nvar Xh=function(a){try{return $a(firebase.app(a).auth().M)}catch(b){return[]}},Yh=function(a,b,c,d,e){this.B=a;this.m=b;this.o=c;this.La=d||null;this.P=e||null;this.f=this.yd=this.we=null;this.ta=[];this.Ac=this.wa=null},Zh=function(a){var b=rf();return oh(a).then(function(a){a:{var c=gf(b),e=c.qa;c=c.pa;for(var f=0;f<a.length;f++){var g=a[f];var l=c;var n=e;0==g.indexOf(\"chrome-extension://\")?l=gf(g).pa==l&&\"chrome-extension\"==n:\"http\"!=n&&\"https\"!=n?l=!1:Af.test(g)?l=l==g:(g=g.split(\".\").join(\"\\\\.\"),\nl=(new RegExp(\"^(.+\\\\.\"+g+\"|\"+g+\")$\",\"i\")).test(l));if(l){a=!0;break a}}a=!1}if(!a)throw new og(rf());})};h=Yh.prototype;h.Sb=function(){if(this.Ac)return this.Ac;var a=this;return this.Ac=Bf().then(function(){if(!a.yd){var b=a.La,c=a.P,d=Xh(a.o);b=(new Vh(a.B,a.m,a.o)).ae(b).Zd(c);b.M=$a(d||[]);a.yd=b.toString()}a.xc=new Oh(a.yd);$h(a)})};\nh.ec=function(a,b,c){var d=new O(\"popup-closed-by-user\"),e=new O(\"web-storage-unsupported\"),f=this,g=!1;return this.Ra().then(function(){ai(f).then(function(c){c||(a&&xf(a),b(e),g=!0)})}).g(function(){}).then(function(){if(!g)return zf(a)}).then(function(){if(!g)return Be(c).then(function(){b(d)})})};h.Ye=function(){var a=L();return!Of(a)&&!Sf(a)};h.Be=function(){return!1};\nh.$b=function(a,b,c,d,e,f,g){if(!a)return E(new O(\"popup-blocked\"));if(g&&!Of())return this.Ra().g(function(b){xf(a);e(b)}),d(),D();this.wa||(this.wa=Zh(bi(this)));var l=this;return this.wa.then(function(){var b=l.Ra().g(function(b){xf(a);e(b);throw b;});d();return b}).then(function(){Sg(c);if(!g){var d=ci(l.B,l.m,l.o,b,c,null,f,l.La,void 0,l.P);sf(d,a)}}).g(function(a){\"auth/network-request-failed\"==a.code&&(l.wa=null);throw a;})};\nvar bi=function(a){a.f||(a.we=a.La?Jf(a.La,Xh(a.o)):null,a.f=new R(a.m,of(a.P),a.we));return a.f};Yh.prototype.ac=function(a,b,c){this.wa||(this.wa=Zh(bi(this)));var d=this;return this.wa.then(function(){Sg(b);var e=ci(d.B,d.m,d.o,a,b,rf(),c,d.La,void 0,d.P);sf(e)}).g(function(a){\"auth/network-request-failed\"==a.code&&(d.wa=null);throw a;})};Yh.prototype.Ra=function(){var a=this;return this.Sb().then(function(){return a.xc.Id}).g(function(){a.wa=null;throw new O(\"network-request-failed\");})};\nYh.prototype.bf=function(){return!0};\nvar ci=function(a,b,c,d,e,f,g,l,n,F){a=new Wh(a,b,c,d,e);a.Td=f;a.Y=g;f=a.ae(l);f.mc=kb(n||null);return f.Zd(F).toString()},$h=function(a){if(!a.xc)throw Error(\"IfcHandler must be initialized!\");Rh(a.xc,function(b){var c={};if(b&&b.authEvent){var d=!1;b=ng(b.authEvent);for(c=0;c<a.ta.length;c++)d=a.ta[c](b)||d;c={};c.status=d?\"ACK\":\"ERROR\";return D(c)}c.status=\"ERROR\";return D(c)})},ai=function(a){var b={type:\"webStorageSupport\"};return a.Sb().then(function(){return a.xc.sendMessage(b)}).then(function(a){if(a&&a.length&&\n\"undefined\"!==typeof a[0].webStorageSupport)return a[0].webStorageSupport;throw Error();})};Yh.prototype.ib=function(a){this.ta.push(a)};Yh.prototype.dc=function(a){Ya(this.ta,function(b){return b==a})};var di=function(a,b,c,d,e,f){N(this,\"type\",\"recaptcha\");this.ad=this.Ib=null;this.Kb=!1;this.ne=b;this.Fa=c||{theme:\"light\",type:\"image\"};this.J=[];if(this.Fa.sitekey)throw new O(\"argument-error\",\"sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.\");this.Bc=\"invisible\"===this.Fa.size;if(!ld(b)||!this.Bc&&ld(b).hasChildNodes())throw new O(\"argument-error\",\"reCAPTCHA container is either not found or already contains inner elements!\");this.f=new R(a,\nf||null,e||null);this.Jf=d||function(){return null};var g=this;this.Wc=[];var l=this.Fa.callback;this.Fa.callback=function(a){g.Lb(a);if(\"function\"===typeof l)l(a);else if(\"string\"===typeof l){var b=M(l,k);\"function\"===typeof b&&b(a)}};var n=this.Fa[\"expired-callback\"];this.Fa[\"expired-callback\"]=function(){g.Lb(null);if(\"function\"===typeof n)n();else if(\"string\"===typeof n){var a=M(n,k);\"function\"===typeof a&&a()}}};di.prototype.Lb=function(a){for(var b=0;b<this.Wc.length;b++)try{this.Wc[b](a)}catch(c){}};\nvar ei=function(a,b){Ya(a.Wc,function(a){return a==b})};di.prototype.c=function(a){var b=this;this.J.push(a);Ed(a,function(){Xa(b.J,a)});return a};\ndi.prototype.Tb=function(){var a=this;return this.Ib?this.Ib:this.Ib=this.c(D().then(function(){if(Mf())return Bf();throw new O(\"operation-not-supported-in-this-environment\",\"RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.\");}).then(function(){return fi(gi(),a.Jf())}).then(function(){return Q(a.f,Lh,{})}).then(function(b){a.Fa.sitekey=b.recaptchaSiteKey}).g(function(b){a.Ib=null;throw b;}))};\ndi.prototype.render=function(){hi(this);var a=this;return this.c(this.Tb().then(function(){if(null===a.ad){var b=a.ne;if(!a.Bc){var c=ld(b);b=pd(\"DIV\");c.appendChild(b)}a.ad=grecaptcha.render(b,a.Fa)}return a.ad}))};di.prototype.verify=function(){hi(this);var a=this;return this.c(this.render().then(function(b){return new C(function(c){var d=grecaptcha.getResponse(b);if(d)c(d);else{var e=function(b){b&&(ei(a,e),c(b))};a.Wc.push(e);a.Bc&&grecaptcha.execute(a.ad)}})}))};\nvar hi=function(a){if(a.Kb)throw new O(\"internal-error\",\"RecaptchaVerifier instance has been destroyed.\");};di.prototype.clear=function(){hi(this);this.Kb=!0;gi().ld--;for(var a=0;a<this.J.length;a++)this.J[a].cancel(\"RecaptchaVerifier instance has been destroyed.\");if(!this.Bc){a=ld(this.ne);for(var b;b=a.firstChild;)a.removeChild(b)}};\nvar ii=Ha(\"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}\"),ji=function(){this.ld=k.grecaptcha?Infinity:0;this.Ce=null;this.jd=\"__rcb\"+Math.floor(1E6*Math.random()).toString()},fi=function(a,b){return new C(function(c,d){if(Uf())if(!k.grecaptcha||b!==a.Ce&&!a.ld){k[a.jd]=function(){if(k.grecaptcha){a.Ce=b;var e=k.grecaptcha.render;k.grecaptcha.render=function(b,c){b=e(b,c);a.ld++;return b};c()}else d(new O(\"internal-error\"));delete k[a.jd]};var e=Oa(ii,{onload:a.jd,\nhl:b||\"\"});D(de(e)).g(function(){d(new O(\"internal-error\",\"Unable to load external reCAPTCHA dependencies!\"))})}else c();else d(new O(\"network-request-failed\"))})},ki=null,gi=function(){ki||(ki=new ji);return ki},li=function(a,b,c){try{this.i=c||firebase.app()}catch(f){throw new O(\"argument-error\",\"No firebase.app.App instance is currently initialized.\");}if(this.i.options&&this.i.options.apiKey)c=this.i.options.apiKey;else throw new O(\"invalid-api-key\");var d=this,e=null;try{e=$a(this.i.auth().M)}catch(f){}e=\nfirebase.SDK_VERSION?Jf(firebase.SDK_VERSION,e):null;di.call(this,c,a,b,function(){try{var a=d.i.auth().ia}catch(g){a=null}return a},e,of(pf))};t(li,di);var mi=function(a){this.G=a||firebase.INTERNAL.reactNative&&firebase.INTERNAL.reactNative.AsyncStorage;if(!this.G)throw new O(\"internal-error\",\"The React Native compatibility library was not found.\");};h=mi.prototype;h.get=function(a){return D(this.G.getItem(a)).then(function(a){return a&&Rf(a)})};h.set=function(a,b){return D(this.G.setItem(a,Pf(b)))};h.remove=function(a){return D(this.G.removeItem(a))};h.jb=function(){};h.$a=function(){};var ni=function(){this.G={}};h=ni.prototype;h.get=function(a){return D(this.G[a])};h.set=function(a,b){this.G[a]=b;return D()};h.remove=function(a){delete this.G[a];return D()};h.jb=function(){};h.$a=function(){};var pi=function(){if(!oi()){if(\"Node\"==Gf())throw new O(\"internal-error\",\"The LocalStorage compatibility library was not found.\");throw new O(\"web-storage-unsupported\");}this.G=k.localStorage||firebase.INTERNAL.node.localStorage},oi=function(){var a=\"Node\"==Gf();a=k.localStorage||a&&firebase.INTERNAL.node&&firebase.INTERNAL.node.localStorage;if(!a)return!1;try{return a.setItem(\"__sak\",\"1\"),a.removeItem(\"__sak\"),!0}catch(b){return!1}};h=pi.prototype;\nh.get=function(a){var b=this;return D().then(function(){var c=b.G.getItem(a);return Rf(c)})};h.set=function(a,b){var c=this;return D().then(function(){var d=Pf(b);null===d?c.remove(a):c.G.setItem(a,d)})};h.remove=function(a){var b=this;return D().then(function(){b.G.removeItem(a)})};h.jb=function(a){k.window&&lc(k.window,\"storage\",a)};h.$a=function(a){k.window&&tc(k.window,\"storage\",a)};var qi=function(){this.G={}};h=qi.prototype;h.get=function(){return D(null)};h.set=function(){return D()};h.remove=function(){return D()};h.jb=function(){};h.$a=function(){};var si=function(){if(!ri()){if(\"Node\"==Gf())throw new O(\"internal-error\",\"The SessionStorage compatibility library was not found.\");throw new O(\"web-storage-unsupported\");}this.G=k.sessionStorage||firebase.INTERNAL.node.sessionStorage},ri=function(){var a=\"Node\"==Gf();a=k.sessionStorage||a&&firebase.INTERNAL.node&&firebase.INTERNAL.node.sessionStorage;if(!a)return!1;try{return a.setItem(\"__sak\",\"1\"),a.removeItem(\"__sak\"),!0}catch(b){return!1}};h=si.prototype;\nh.get=function(a){var b=this;return D().then(function(){var c=b.G.getItem(a);return Rf(c)})};h.set=function(a,b){var c=this;return D().then(function(){var d=Pf(b);null===d?c.remove(a):c.G.setItem(a,d)})};h.remove=function(a){var b=this;return D().then(function(){b.G.removeItem(a)})};h.jb=function(){};h.$a=function(){};var ti=function(a,b,c,d,e,f){if(!window.indexedDB)throw new O(\"web-storage-unsupported\");this.zf=a;this.Hd=b;this.md=c;this.ff=d;this.gb=e;this.N={};this.fc=[];this.Wb=0;this.Rf=f||k.indexedDB},ui,vi=function(a){return new C(function(b,c){var d=a.Rf.open(a.zf,a.gb);d.onerror=function(a){c(Error(a.target.errorCode))};d.onupgradeneeded=function(b){b=b.target.result;try{b.createObjectStore(a.Hd,{keyPath:a.md})}catch(f){c(f)}};d.onsuccess=function(a){b(a.target.result)}})},wi=function(a){a.Ge||(a.Ge=\nvi(a));return a.Ge},xi=function(a,b){return b.objectStore(a.Hd)},zi=function(a,b,c){return b.transaction([a.Hd],c?\"readwrite\":\"readonly\")},Ai=function(a){return new C(function(b,c){a.onsuccess=function(a){a&&a.target?b(a.target.result):b()};a.onerror=function(a){c(Error(a.target.errorCode))}})};h=ti.prototype;\nh.set=function(a,b){var c=!1,d,e=this;return Ed(wi(this).then(function(b){d=b;b=xi(e,zi(e,d,!0));return Ai(b.get(a))}).then(function(f){var g=xi(e,zi(e,d,!0));if(f)return f.value=b,Ai(g.put(f));e.Wb++;c=!0;f={};f[e.md]=a;f[e.ff]=b;return Ai(g.add(f))}).then(function(){e.N[a]=b}),function(){c&&e.Wb--})};h.get=function(a){var b=this;return wi(this).then(function(c){return Ai(xi(b,zi(b,c,!1)).get(a))}).then(function(a){return a&&a.value})};\nh.remove=function(a){var b=!1,c=this;return Ed(wi(this).then(function(d){b=!0;c.Wb++;return Ai(xi(c,zi(c,d,!0))[\"delete\"](a))}).then(function(){delete c.N[a]}),function(){b&&c.Wb--})};\nh.xg=function(){var a=this;return wi(this).then(function(b){var c=xi(a,zi(a,b,!1));return c.getAll?Ai(c.getAll()):new C(function(a,b){var d=[],e=c.openCursor();e.onsuccess=function(b){(b=b.target.result)?(d.push(b.value),b[\"continue\"]()):a(d)};e.onerror=function(a){b(Error(a.target.errorCode))}})}).then(function(b){var c={},d=[];if(0==a.Wb){for(d=0;d<b.length;d++)c[b[d][a.md]]=b[d][a.ff];d=tf(a.N,c);a.N=c}return d})};h.jb=function(a){0==this.fc.length&&this.ce();this.fc.push(a)};\nh.$a=function(a){Ya(this.fc,function(b){return b==a});0==this.fc.length&&this.Sc()};h.ce=function(){var a=this;this.Sc();var b=function(){a.Nd=Be(800).then(r(a.xg,a)).then(function(b){0<b.length&&x(a.fc,function(a){a(b)})}).then(b).g(function(a){\"STOP_EVENT\"!=a.message&&b()});return a.Nd};b()};h.Sc=function(){this.Nd&&this.Nd.cancel(\"STOP_EVENT\")};var Ei=function(){this.se={Browser:Bi,Node:Ci,ReactNative:Di}[Gf()]},Fi,Bi={D:pi,ee:si},Ci={D:pi,ee:si},Di={D:mi,ee:qi};var Gi=function(a){this.Bd(a)};\nGi.prototype.Bd=function(a){var b=a.url;if(\"undefined\"===typeof b)throw new O(\"missing-continue-uri\");if(\"string\"!==typeof b||\"string\"===typeof b&&!b.length)throw new O(\"invalid-continue-uri\");this.uf=b;this.ge=this.nc=null;this.He=!1;var c=a.android;if(c&&\"object\"===typeof c){b=c.packageName;var d=c.installApp;c=c.minimumVersion;if(\"string\"===typeof b&&b.length){this.nc=b;if(\"undefined\"!==typeof d&&\"boolean\"!==typeof d)throw new O(\"argument-error\",\"installApp property must be a boolean when specified.\");this.He=\n!!d;if(\"undefined\"!==typeof c&&(\"string\"!==typeof c||\"string\"===typeof c&&!c.length))throw new O(\"argument-error\",\"minimumVersion property must be a non empty string when specified.\");this.ge=c||null}else{if(\"undefined\"!==typeof b)throw new O(\"argument-error\",\"packageName property must be a non empty string when specified.\");if(\"undefined\"!==typeof d||\"undefined\"!==typeof c)throw new O(\"missing-android-pkg-name\");}}else if(\"undefined\"!==typeof c)throw new O(\"argument-error\",\"android property must be a non null object when specified.\");\nthis.xd=null;if((b=a.iOS)&&\"object\"===typeof b)if(b=b.bundleId,\"string\"===typeof b&&b.length)this.xd=b;else{if(\"undefined\"!==typeof b)throw new O(\"argument-error\",\"bundleId property must be a non empty string when specified.\");}else if(\"undefined\"!==typeof b)throw new O(\"argument-error\",\"iOS property must be a non null object when specified.\");a=a.handleCodeInApp;if(\"undefined\"!==typeof a&&\"boolean\"!==typeof a)throw new O(\"argument-error\",\"handleCodeInApp property must be a boolean when specified.\");\nif((this.le=!!a)&&!this.xd&&!this.nc)throw new O(\"argument-error\",\"handleCodeInApp property can't be true when no mobile application is provided.\");};var Hi=function(a){var b={};b.continueUrl=a.uf;b.canHandleCodeInApp=a.le;if(b.androidPackageName=a.nc)b.androidMinimumVersion=a.ge,b.androidInstallApp=a.He;b.iOSBundleId=a.xd;for(var c in b)null===b[c]&&delete b[c];return b};var Ii=function(a,b){this.xf=b;N(this,\"verificationId\",a)};Ii.prototype.confirm=function(a){a=Qg(this.verificationId,a);return this.xf(a)};var Ji=function(a,b,c,d){return(new Og(a)).verifyPhoneNumber(b,c).then(function(a){return new Ii(a,d)})};var Ki=function(a){var b={},c=a.email,d=a.newEmail;a=a.requestType;if(!c||!a)throw Error(\"Invalid provider user info!\");b.fromEmail=d||null;b.email=c;N(this,\"operation\",a);N(this,\"data\",fg(b))};var Li=function(a,b,c,d,e,f){this.fg=a;this.mg=b;this.Kf=c;this.Gc=d;this.fe=e;this.ng=!!f;this.ub=null;this.Sa=this.Gc;if(this.fe<this.Gc)throw Error(\"Proactive refresh lower bound greater than upper bound!\");};Li.prototype.start=function(){this.Sa=this.Gc;Mi(this,!0)};\nvar Ni=function(a,b){if(b)return a.Sa=a.Gc,a.Kf();b=a.Sa;a.Sa*=2;a.Sa>a.fe&&(a.Sa=a.fe);return b},Mi=function(a,b){a.stop();a.ub=Be(Ni(a,b)).then(function(){return a.ng?D():Xf()}).then(function(){return a.fg()}).then(function(){Mi(a,!0)}).g(function(b){a.mg(b)&&Mi(a,!1)})};Li.prototype.stop=function(){this.ub&&(this.ub.cancel(),this.ub=null)};var Ui=function(a){var b={};b[\"facebook.com\"]=Oi;b[\"google.com\"]=Pi;b[\"github.com\"]=Qi;b[\"twitter.com\"]=Ri;var c=a&&a.providerId;try{if(c)return b[c]?new b[c](a):new Si(a);if(\"undefined\"!==typeof a.idToken)return new Ti(a)}catch(d){}return null},Ti=function(a){var b=a.providerId;if(!b&&a.idToken){var c=qg(a.idToken);c&&c.Rd&&(b=c.Rd)}if(!b)throw Error(\"Invalid additional user info!\");a=!!a.isNewUser;N(this,\"providerId\",b);N(this,\"isNewUser\",a)},Si=function(a){Ti.call(this,a);a=Rf(a.rawUserInfo||\"{}\");\nN(this,\"profile\",fg(a||{}))};t(Si,Ti);var Oi=function(a){Si.call(this,a);if(\"facebook.com\"!=this.providerId)throw Error(\"Invalid provider id!\");};t(Oi,Si);var Qi=function(a){Si.call(this,a);if(\"github.com\"!=this.providerId)throw Error(\"Invalid provider id!\");N(this,\"username\",this.profile&&this.profile.login||null)};t(Qi,Si);var Pi=function(a){Si.call(this,a);if(\"google.com\"!=this.providerId)throw Error(\"Invalid provider id!\");};t(Pi,Si);\nvar Ri=function(a){Si.call(this,a);if(\"twitter.com\"!=this.providerId)throw Error(\"Invalid provider id!\");N(this,\"username\",a.screenName||null)};t(Ri,Si);var Vi={LOCAL:\"local\",NONE:\"none\",SESSION:\"session\"},Wi=function(a){var b=new O(\"invalid-persistence-type\"),c=new O(\"unsupported-persistence-type\");a:{for(d in Vi)if(Vi[d]==a){var d=!0;break a}d=!1}if(!d||\"string\"!==typeof a)throw b;switch(Gf()){case \"ReactNative\":if(\"session\"===a)throw c;break;case \"Node\":if(\"none\"!==a)throw c;break;default:if(!Lf()&&\"none\"!==a)throw c;}},Xi=function(a,b,c,d){this.Me=a;this.Xd=b;this.og=c;this.Ve=d;this.S={};Fi||(Fi=new Ei);a=Fi;try{if(qf()){ui||(ui=new ti(\"firebaseLocalStorageDb\",\n\"firebaseLocalStorage\",\"fbase_key\",\"value\",1));var e=ui}else e=new a.se.D;this.Se=e}catch(f){this.Se=new ni,this.Ve=!0}try{this.af=new a.se.ee}catch(f){this.af=new ni}this.Qf=new ni;this.de=r(this.Ze,this);this.N={}},Yi,Zi=function(){Yi||(Yi=new Xi(\"firebase\",\":\",!Sf(L())&&Ff()?!0:!1,Of()));return Yi},$i=function(a,b){switch(b){case \"session\":return a.af;case \"none\":return a.Qf;default:return a.Se}};h=Xi.prototype;h.ca=function(a,b){return this.Me+this.Xd+a.name+(b?this.Xd+b:\"\")};\nh.get=function(a,b){return $i(this,a.D).get(this.ca(a,b))};h.remove=function(a,b){b=this.ca(a,b);\"local\"==a.D&&(this.N[b]=null);return $i(this,a.D).remove(b)};h.set=function(a,b,c){var d=this.ca(a,c),e=this,f=$i(this,a.D);return f.set(d,b).then(function(){return f.get(d)}).then(function(b){\"local\"==a.D&&(e.N[d]=b)})};\nh.addListener=function(a,b,c){a=this.ca(a,b);\"undefined\"!==typeof k.localStorage&&\"function\"===typeof k.localStorage.getItem&&(this.N[a]=k.localStorage.getItem(a));ib(this.S)&&this.ce();this.S[a]||(this.S[a]=[]);this.S[a].push(c)};h.removeListener=function(a,b,c){a=this.ca(a,b);this.S[a]&&(Ya(this.S[a],function(a){return a==c}),0==this.S[a].length&&delete this.S[a]);ib(this.S)&&this.Sc()};h.ce=function(){$i(this,\"local\").jb(this.de);this.Ve||qf()||aj(this)};\nvar aj=function(a){bj(a);a.Fd=setInterval(function(){for(var b in a.S){var c=k.localStorage.getItem(b),d=a.N[b];c!=d&&(a.N[b]=c,c=new Yb({type:\"storage\",key:b,target:window,oldValue:d,newValue:c,Md:!0}),a.Ze(c))}},1E3)},bj=function(a){a.Fd&&(clearInterval(a.Fd),a.Fd=null)};Xi.prototype.Sc=function(){$i(this,\"local\").$a(this.de);bj(this)};\nXi.prototype.Ze=function(a){if(a&&a.Hf){var b=a.R.key;if(null==b)for(var c in this.S){var d=this.N[c];\"undefined\"===typeof d&&(d=null);var e=k.localStorage.getItem(c);e!==d&&(this.N[c]=e,this.hd(c))}else if(0==b.indexOf(this.Me+this.Xd)&&this.S[b]){\"undefined\"!==typeof a.R.Md?$i(this,\"local\").$a(this.de):bj(this);if(this.og)if(c=k.localStorage.getItem(b),d=a.R.newValue,d!==c)null!==d?k.localStorage.setItem(b,d):k.localStorage.removeItem(b);else if(this.N[b]===d&&\"undefined\"===typeof a.R.Md)return;\nvar f=this;c=function(){if(\"undefined\"!==typeof a.R.Md||f.N[b]!==k.localStorage.getItem(b))f.N[b]=k.localStorage.getItem(b),f.hd(b)};z&&Cb&&10==Cb&&k.localStorage.getItem(b)!==a.R.newValue&&a.R.newValue!==a.R.oldValue?setTimeout(c,10):c()}}else x(a,r(this.hd,this))};Xi.prototype.hd=function(a){this.S[a]&&x(this.S[a],function(a){a()})};var cj=function(a,b){this.j=a;this.h=b||Zi()},dj={name:\"authEvent\",D:\"local\"},ej=function(a){return a.h.get(dj,a.j).then(function(a){return ng(a)})};cj.prototype.ib=function(a){this.h.addListener(dj,this.j,a)};cj.prototype.dc=function(a){this.h.removeListener(dj,this.j,a)};var fj=function(a){this.h=a||Zi()},gj={name:\"sessionId\",D:\"session\"};fj.prototype.tc=function(a){return this.h.get(gj,a)};var hj=function(a,b,c,d,e,f,g){this.B=a;this.m=b;this.o=c;this.La=d||null;this.P=g||null;this.$e=b+\":\"+c;this.pg=new fj;this.xe=new cj(this.$e);this.Ad=null;this.ta=[];this.Vf=e||500;this.ig=f||2E3;this.Rb=this.Jc=null},ij=function(a){return new O(\"invalid-cordova-configuration\",a)};\nhj.prototype.Ra=function(){return this.Tb?this.Tb:this.Tb=Df().then(function(){if(\"function\"!==typeof M(\"universalLinks.subscribe\",k))throw ij(\"cordova-universal-links-plugin is not installed\");if(\"undefined\"===typeof M(\"BuildInfo.packageName\",k))throw ij(\"cordova-plugin-buildinfo is not installed\");if(\"function\"!==typeof M(\"cordova.plugins.browsertab.openUrl\",k))throw ij(\"cordova-plugin-browsertab is not installed\");if(\"function\"!==typeof M(\"cordova.InAppBrowser.open\",k))throw ij(\"cordova-plugin-inappbrowser is not installed\");\n},function(){throw new O(\"cordova-not-ready\");})};var jj=function(){for(var a=20,b=[];0<a;)b.push(\"1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\".charAt(Math.floor(62*Math.random()))),a--;return b.join(\"\")},kj=function(a){var b=new Sb;b.update(a);return ab(b.digest())};h=hj.prototype;h.ec=function(a,b){b(new O(\"operation-not-supported-in-this-environment\"));return D()};h.$b=function(){return E(new O(\"operation-not-supported-in-this-environment\"))};h.bf=function(){return!1};h.Ye=function(){return!0};\nh.Be=function(){return!0};\nh.ac=function(a,b,c){if(this.Jc)return E(new O(\"redirect-operation-pending\"));var d=this,e=k.document,f=null,g=null,l=null,n=null;return this.Jc=Ed(D().then(function(){Sg(b);return lj(d)}).then(function(){return mj(d,a,b,c)}).then(function(){return(new C(function(a,b){g=function(){var b=M(\"cordova.plugins.browsertab.close\",k);a();\"function\"===typeof b&&b();d.Rb&&\"function\"===typeof d.Rb.close&&(d.Rb.close(),d.Rb=null);return!1};d.ib(g);l=function(){f||(f=Be(d.ig).then(function(){b(new O(\"redirect-cancelled-by-user\"))}))};n=\nfunction(){Wf()&&l()};e.addEventListener(\"resume\",l,!1);L().toLowerCase().match(/android/)||e.addEventListener(\"visibilitychange\",n,!1)})).g(function(a){return nj(d).then(function(){throw a;})})}),function(){l&&e.removeEventListener(\"resume\",l,!1);n&&e.removeEventListener(\"visibilitychange\",n,!1);f&&f.cancel();g&&d.dc(g);d.Jc=null})};\nvar mj=function(a,b,c,d){var e=jj(),f=new mg(b,d,null,e,new O(\"no-auth-event\")),g=M(\"BuildInfo.packageName\",k);if(\"string\"!==typeof g)throw new O(\"invalid-cordova-configuration\");var l=M(\"BuildInfo.displayName\",k),n={};if(L().toLowerCase().match(/iphone|ipad|ipod/))n.ibi=g;else if(L().toLowerCase().match(/android/))n.apn=g;else return E(new O(\"operation-not-supported-in-this-environment\"));l&&(n.appDisplayName=l);e=kj(e);n.sessionId=e;var F=ci(a.B,a.m,a.o,b,c,null,d,a.La,n,a.P);return a.Ra().then(function(){var b=\na.$e;return a.pg.h.set(dj,f.A(),b)}).then(function(){var b=M(\"cordova.plugins.browsertab.isAvailable\",k);if(\"function\"!==typeof b)throw new O(\"invalid-cordova-configuration\");var c=null;b(function(b){if(b){c=M(\"cordova.plugins.browsertab.openUrl\",k);if(\"function\"!==typeof c)throw new O(\"invalid-cordova-configuration\");c(F)}else{c=M(\"cordova.InAppBrowser.open\",k);if(\"function\"!==typeof c)throw new O(\"invalid-cordova-configuration\");b=c;var d=L();d=!(!d.match(/(iPad|iPhone|iPod).*OS 7_\\d/i)&&!d.match(/(iPad|iPhone|iPod).*OS 8_\\d/i));\na.Rb=b(F,d?\"_blank\":\"_system\",\"location=yes\")}})})};hj.prototype.Lb=function(a){for(var b=0;b<this.ta.length;b++)try{this.ta[b](a)}catch(c){}};\nvar lj=function(a){a.Ad||(a.Ad=a.Ra().then(function(){return new C(function(b){var c=function(d){b(d);a.dc(c);return!1};a.ib(c);oj(a)})}));return a.Ad},nj=function(a){var b=null;return ej(a.xe).then(function(c){b=c;c=a.xe;return c.h.remove(dj,c.j)}).then(function(){return b})},oj=function(a){var b=M(\"universalLinks.subscribe\",k);if(\"function\"!==typeof b)throw new O(\"invalid-cordova-configuration\");var c=new mg(\"unknown\",null,null,null,new O(\"no-auth-event\")),d=!1,e=Be(a.Vf).then(function(){return nj(a).then(function(){d||\na.Lb(c)})}),f=function(b){d=!0;e&&e.cancel();nj(a).then(function(d){var e=c;if(d&&b&&b.url){e=null;var f=b.url;var g=gf(f),l=ff(g,\"link\"),n=ff(gf(l),\"link\");g=ff(g,\"deep_link_id\");f=ff(gf(g),\"link\")||g||n||l||f;-1!=f.indexOf(\"/__/auth/callback\")&&(e=gf(f),e=Rf(ff(e,\"firebaseError\")||null),e=(e=\"object\"===typeof e?lg(e):null)?new mg(d.ma,d.Y,null,null,e):new mg(d.ma,d.Y,f,d.tc()));e=e||c}a.Lb(e)})},g=k.handleOpenURL;k.handleOpenURL=function(a){0==a.toLowerCase().indexOf(M(\"BuildInfo.packageName\",k).toLowerCase()+\n\"://\")&&f({url:a});if(\"function\"===typeof g)try{g(a)}catch(n){console.error(n)}};b(null,f)};hj.prototype.ib=function(a){this.ta.push(a);lj(this).g(function(b){\"auth/invalid-cordova-configuration\"===b.code&&(b=new mg(\"unknown\",null,null,null,new O(\"no-auth-event\")),a(b))})};hj.prototype.dc=function(a){Ya(this.ta,function(b){return b==a})};var pj=function(a){this.j=a;this.h=Zi()},qj={name:\"pendingRedirect\",D:\"session\"},rj=function(a){return a.h.set(qj,\"pending\",a.j)},sj=function(a){return a.h.remove(qj,a.j)},tj=function(a){return a.h.get(qj,a.j).then(function(a){return\"pending\"==a})};var xj=function(a,b,c){this.B=a;this.m=b;this.o=c;this.gc=[];this.sb=!1;this.ed=r(this.vd,this);this.Xa=new uj(this);this.Od=new vj(this);this.Xb=new pj(this.m+\":\"+this.o);this.Ia={};this.Ia.unknown=this.Xa;this.Ia.signInViaRedirect=this.Xa;this.Ia.linkViaRedirect=this.Xa;this.Ia.reauthViaRedirect=this.Xa;this.Ia.signInViaPopup=this.Od;this.Ia.linkViaPopup=this.Od;this.Ia.reauthViaPopup=this.Od;this.Z=wj(this.B,this.m,this.o,pf)},wj=function(a,b,c,d){var e=firebase.SDK_VERSION||null;return Cf()?new hj(a,\nb,c,e,void 0,void 0,d):new Yh(a,b,c,e,d)};xj.prototype.reset=function(){this.sb=!1;this.Z.dc(this.ed);this.Z=wj(this.B,this.m,this.o)};xj.prototype.Sb=function(){var a=this;this.sb||(this.sb=!0,this.Z.ib(this.ed));var b=this.Z;return this.Z.Ra().g(function(c){a.Z==b&&a.reset();throw c;})};var Aj=function(a){a.Z.Ye()&&a.Sb().g(function(b){var c=new mg(\"unknown\",null,null,null,new O(\"operation-not-supported-in-this-environment\"));yj(b)&&a.vd(c)});a.Z.Be()||zj(a.Xa)};\nxj.prototype.subscribe=function(a){Va(this.gc,a)||this.gc.push(a);if(!this.sb){var b=this;tj(this.Xb).then(function(a){a?sj(b.Xb).then(function(){b.Sb().g(function(a){var c=new mg(\"unknown\",null,null,null,new O(\"operation-not-supported-in-this-environment\"));yj(a)&&b.vd(c)})}):Aj(b)}).g(function(){Aj(b)})}};xj.prototype.unsubscribe=function(a){Ya(this.gc,function(b){return b==a})};\nxj.prototype.vd=function(a){if(!a)throw new O(\"invalid-auth-event\");for(var b=!1,c=0;c<this.gc.length;c++){var d=this.gc[c];if(d.ke(a.ma,a.Y)){(b=this.Ia[a.ma])&&b.Te(a,d);b=!0;break}}zj(this.Xa);return b};var Bj=new Vf(2E3,1E4),Cj=new Vf(3E4,6E4);xj.prototype.getRedirectResult=function(){return this.Xa.getRedirectResult()};xj.prototype.$b=function(a,b,c,d,e){var f=this;return this.Z.$b(a,b,c,function(){f.sb||(f.sb=!0,f.Z.ib(f.ed))},function(){f.reset()},d,e)};\nvar yj=function(a){return a&&\"auth/cordova-not-ready\"==a.code?!0:!1};xj.prototype.ac=function(a,b,c){var d=this,e;return rj(this.Xb).then(function(){return d.Z.ac(a,b,c).g(function(a){if(yj(a))throw new O(\"operation-not-supported-in-this-environment\");e=a;return sj(d.Xb).then(function(){throw e;})}).then(function(){return d.Z.bf()?new C(function(){}):sj(d.Xb).then(function(){return d.getRedirectResult()}).then(function(){}).g(function(){})})})};\nxj.prototype.ec=function(a,b,c,d){return this.Z.ec(c,function(c){a.bb(b,null,c,d)},Bj.get())};var Dj={},Ej=function(a,b,c){var d=b+\":\"+c;Dj[d]||(Dj[d]=new xj(a,b,c));return Dj[d]},uj=function(a){this.h=a;this.Ab=null;this.cc=[];this.bc=[];this.yb=null;this.Sd=!1};uj.prototype.reset=function(){this.Ab=null;this.yb&&(this.yb.cancel(),this.yb=null)};\nuj.prototype.Te=function(a,b){if(!a)return E(new O(\"invalid-auth-event\"));this.reset();this.Sd=!0;var c=a.ma,d=a.Y,e=a.getError()&&\"auth/web-storage-unsupported\"==a.getError().code,f=a.getError()&&\"auth/operation-not-supported-in-this-environment\"==a.getError().code;\"unknown\"!=c||e||f?a=a.ba?this.Pd(a,b):b.Nb(c,d)?this.Qd(a,b):E(new O(\"invalid-auth-event\")):(Fj(this,!1,null,null),a=D());return a};var zj=function(a){a.Sd||(a.Sd=!0,Fj(a,!1,null,null))};\nuj.prototype.Pd=function(a){Fj(this,!0,null,a.getError());return D()};uj.prototype.Qd=function(a,b){var c=this;b=b.Nb(a.ma,a.Y);var d=a.Eb,e=a.tc(),f=!!a.ma.match(/Redirect$/);return b(d,e).then(function(a){Fj(c,f,a,null)}).g(function(a){Fj(c,f,null,a)})};\nvar Gj=function(a,b){a.Ab=function(){return E(b)};if(a.bc.length)for(var c=0;c<a.bc.length;c++)a.bc[c](b)},Hj=function(a,b){a.Ab=function(){return D(b)};if(a.cc.length)for(var c=0;c<a.cc.length;c++)a.cc[c](b)},Fj=function(a,b,c,d){b?d?Gj(a,d):Hj(a,c):Hj(a,{user:null});a.cc=[];a.bc=[]};uj.prototype.getRedirectResult=function(){var a=this;return new C(function(b,c){a.Ab?a.Ab().then(b,c):(a.cc.push(b),a.bc.push(c),Ij(a))})};\nvar Ij=function(a){var b=new O(\"timeout\");a.yb&&a.yb.cancel();a.yb=Be(Cj.get()).then(function(){a.Ab||Fj(a,!0,null,b)})},vj=function(a){this.h=a};vj.prototype.Te=function(a,b){if(!a)return E(new O(\"invalid-auth-event\"));var c=a.ma,d=a.Y;return a.ba?this.Pd(a,b):b.Nb(c,d)?this.Qd(a,b):E(new O(\"invalid-auth-event\"))};vj.prototype.Pd=function(a,b){b.bb(a.ma,null,a.getError(),a.Y);return D()};\nvj.prototype.Qd=function(a,b){var c=a.Y,d=a.ma,e=b.Nb(d,c),f=a.Eb;a=a.tc();return e(f,a).then(function(a){b.bb(d,a,null,c)}).g(function(a){b.bb(d,null,a,c)})};var Jj=function(a){this.f=a;this.Ja=this.fa=null;this.Na=0};Jj.prototype.A=function(){return{apiKey:this.f.m,refreshToken:this.fa,accessToken:this.Ja,expirationTime:this.Na}};\nvar Lj=function(a,b){var c=b.idToken,d=b.refreshToken;b=Kj(b.expiresIn);a.Ja=c;a.Na=b;a.fa=d},Kj=function(a){return ma()+1E3*parseInt(a,10)},Mj=function(a,b){return hh(a.f,b).then(function(b){a.Ja=b.access_token;a.Na=Kj(b.expires_in);a.fa=b.refresh_token;return{accessToken:a.Ja,expirationTime:a.Na,refreshToken:a.fa}}).g(function(b){\"auth/user-token-expired\"==b.code&&(a.fa=null);throw b;})};\nJj.prototype.getToken=function(a){a=!!a;return this.Ja&&!this.fa?E(new O(\"user-token-expired\")):a||!this.Ja||ma()>this.Na-3E4?this.fa?Mj(this,{grant_type:\"refresh_token\",refresh_token:this.fa}):D(null):D({accessToken:this.Ja,expirationTime:this.Na,refreshToken:this.fa})};var Nj=function(a,b){this.pe=a||null;this.Je=b||null;bg(this,{lastSignInTime:Yf(b||null),creationTime:Yf(a||null)})};Nj.prototype.clone=function(){return new Nj(this.pe,this.Je)};Nj.prototype.A=function(){return{lastLoginAt:this.Je,createdAt:this.pe}};var Oj=function(a,b,c,d,e,f){bg(this,{uid:a,displayName:d||null,photoURL:e||null,email:c||null,phoneNumber:f||null,providerId:b})},Pj=function(a,b){B.call(this,a);for(var c in b)this[c]=b[c]};t(Pj,B);\nvar S=function(a,b,c){this.J=[];this.m=a.apiKey;this.o=a.appName;this.B=a.authDomain||null;a=firebase.SDK_VERSION?Jf(firebase.SDK_VERSION):null;this.f=new R(this.m,of(pf),a);this.ra=new Jj(this.f);Qj(this,b.idToken);Lj(this.ra,b);N(this,\"refreshToken\",this.ra.fa);Rj(this,c||{});G.call(this);this.Kc=!1;this.B&&Nf()&&(this.v=Ej(this.B,this.m,this.o));this.Rc=[];this.sa=null;this.wb=Sj(this);this.Gb=r(this.wd,this);var d=this;this.ia=null;this.Pe=function(a){d.Cb(a.languageCode)};this.Dd=null;this.M=\n[];this.Oe=function(a){Tj(d,a.Ff)};this.sd=null};t(S,G);S.prototype.Cb=function(a){this.ia=a;ah(this.f,a)};var Uj=function(a,b){a.Dd&&tc(a.Dd,\"languageCodeChanged\",a.Pe);(a.Dd=b)&&lc(b,\"languageCodeChanged\",a.Pe)},Tj=function(a,b){a.M=b;bh(a.f,firebase.SDK_VERSION?Jf(firebase.SDK_VERSION,a.M):null)},Vj=function(a,b){a.sd&&tc(a.sd,\"frameworkChanged\",a.Oe);(a.sd=b)&&lc(b,\"frameworkChanged\",a.Oe)};S.prototype.wd=function(){this.wb.ub&&(this.wb.stop(),this.wb.start())};\nvar Wj=function(a){try{return firebase.app(a.o).auth()}catch(b){throw new O(\"internal-error\",\"No firebase.auth.Auth instance is available for the Firebase App '\"+a.o+\"'!\");}},Sj=function(a){return new Li(function(){return a.getIdToken(!0)},function(a){return a&&\"auth/network-request-failed\"==a.code?!0:!1},function(){var b=a.ra.Na-ma()-3E5;return 0<b?b:0},3E4,96E4,!1)},Xj=function(a){a.Kb||a.wb.ub||(a.wb.start(),tc(a,\"tokenChanged\",a.Gb),lc(a,\"tokenChanged\",a.Gb))},Yj=function(a){tc(a,\"tokenChanged\",\na.Gb);a.wb.stop()},Qj=function(a,b){a.Ie=b;N(a,\"_lat\",b)},Zj=function(a,b){Ya(a.Rc,function(a){return a==b})},ak=function(a){for(var b=[],c=0;c<a.Rc.length;c++)b.push(a.Rc[c](a));return Bd(b).then(function(){return a})},bk=function(a){a.v&&!a.Kc&&(a.Kc=!0,a.v.subscribe(a))},Rj=function(a,b){bg(a,{uid:b.uid,displayName:b.displayName||null,photoURL:b.photoURL||null,email:b.email||null,emailVerified:b.emailVerified||!1,phoneNumber:b.phoneNumber||null,isAnonymous:b.isAnonymous||!1,metadata:new Nj(b.createdAt,\nb.lastLoginAt),providerData:[]})};N(S.prototype,\"providerId\",\"firebase\");var ck=function(){},dk=function(a){return D().then(function(){if(a.Kb)throw new O(\"app-deleted\");})},ek=function(a){return Ra(a.providerData,function(a){return a.providerId})},gk=function(a,b){b&&(fk(a,b.providerId),a.providerData.push(b))},fk=function(a,b){Ya(a.providerData,function(a){return a.providerId==b})},hk=function(a,b,c){(\"uid\"!=b||c)&&a.hasOwnProperty(b)&&N(a,b,c)};\nS.prototype.copy=function(a){var b=this;b!=a&&(bg(this,{uid:a.uid,displayName:a.displayName,photoURL:a.photoURL,email:a.email,emailVerified:a.emailVerified,phoneNumber:a.phoneNumber,isAnonymous:a.isAnonymous,providerData:[]}),a.metadata?N(this,\"metadata\",a.metadata.clone()):N(this,\"metadata\",new Nj),x(a.providerData,function(a){gk(b,a)}),this.ra=a.ra,N(this,\"refreshToken\",this.ra.fa))};S.prototype.reload=function(){var a=this;return this.c(dk(this).then(function(){return ik(a).then(function(){return ak(a)}).then(ck)}))};\nvar ik=function(a){return a.getIdToken().then(function(b){var c=a.isAnonymous;return jk(a,b).then(function(){c||hk(a,\"isAnonymous\",!1);return b})})};S.prototype.getIdToken=function(a){var b=this;return this.c(dk(this).then(function(){return b.ra.getToken(a)}).then(function(a){if(!a)throw new O(\"internal-error\");a.accessToken!=b.Ie&&(Qj(b,a.accessToken),b.Ta());hk(b,\"refreshToken\",a.refreshToken);return a.accessToken}))};\nS.prototype.getToken=function(a){Zf[\"firebase.User.prototype.getToken is deprecated. Please use firebase.User.prototype.getIdToken instead.\"]||(Zf[\"firebase.User.prototype.getToken is deprecated. Please use firebase.User.prototype.getIdToken instead.\"]=!0,\"undefined\"!==typeof console&&\"function\"===typeof console.warn&&console.warn(\"firebase.User.prototype.getToken is deprecated. Please use firebase.User.prototype.getIdToken instead.\"));return this.getIdToken(a)};\nvar kk=function(a,b){b.idToken&&a.Ie!=b.idToken&&(Lj(a.ra,b),a.Ta(),Qj(a,b.idToken),hk(a,\"refreshToken\",a.ra.fa))};S.prototype.Ta=function(){this.dispatchEvent(new Pj(\"tokenChanged\"))};var jk=function(a,b){return Q(a.f,Kh,{idToken:b}).then(r(a.gg,a))};\nS.prototype.gg=function(a){a=a.users;if(!a||!a.length)throw new O(\"internal-error\");a=a[0];Rj(this,{uid:a.localId,displayName:a.displayName,photoURL:a.photoUrl,email:a.email,emailVerified:!!a.emailVerified,phoneNumber:a.phoneNumber,lastLoginAt:a.lastLoginAt,createdAt:a.createdAt});for(var b=lk(a),c=0;c<b.length;c++)gk(this,b[c]);hk(this,\"isAnonymous\",!(this.email&&a.passwordHash)&&!(this.providerData&&this.providerData.length))};\nvar lk=function(a){return(a=a.providerUserInfo)&&a.length?Ra(a,function(a){return new Oj(a.rawId,a.providerId,a.email,a.displayName,a.photoUrl,a.phoneNumber)}):[]};S.prototype.reauthenticateAndRetrieveDataWithCredential=function(a){var b=this,c=null;return this.c(a.Gd(this.f,this.uid).then(function(a){kk(b,a);c=mk(b,a,\"reauthenticate\");b.sa=null;return b.reload()}).then(function(){return c}),!0)};S.prototype.reauthenticateWithCredential=function(a){return this.reauthenticateAndRetrieveDataWithCredential(a).then(function(){})};\nvar nk=function(a,b){return ik(a).then(function(){if(Va(ek(a),b))return ak(a).then(function(){throw new O(\"provider-already-linked\");})})};S.prototype.linkAndRetrieveDataWithCredential=function(a){var b=this,c=null;return this.c(nk(this,a.providerId).then(function(){return b.getIdToken()}).then(function(c){return a.Fc(b.f,c)}).then(function(a){c=mk(b,a,\"link\");return ok(b,a)}).then(function(){return c}))};S.prototype.linkWithCredential=function(a){return this.linkAndRetrieveDataWithCredential(a).then(function(a){return a.user})};\nS.prototype.linkWithPhoneNumber=function(a,b){var c=this;return this.c(nk(this,\"phone\").then(function(){return Ji(Wj(c),a,b,r(c.linkAndRetrieveDataWithCredential,c))}))};S.prototype.reauthenticateWithPhoneNumber=function(a,b){var c=this;return this.c(D().then(function(){return Ji(Wj(c),a,b,r(c.reauthenticateAndRetrieveDataWithCredential,c))}),!0)};var mk=function(a,b,c){var d=Rg(b);b=Ui(b);return cg({user:a,credential:d,additionalUserInfo:b,operationType:c})},ok=function(a,b){kk(a,b);return a.reload().then(function(){return a})};\nh=S.prototype;h.updateEmail=function(a){var b=this;return this.c(this.getIdToken().then(function(c){return b.f.updateEmail(c,a)}).then(function(a){kk(b,a);return b.reload()}))};h.updatePhoneNumber=function(a){var b=this;return this.c(this.getIdToken().then(function(c){return a.Fc(b.f,c)}).then(function(a){kk(b,a);return b.reload()}))};h.updatePassword=function(a){var b=this;return this.c(this.getIdToken().then(function(c){return b.f.updatePassword(c,a)}).then(function(a){kk(b,a);return b.reload()}))};\nh.updateProfile=function(a){if(void 0===a.displayName&&void 0===a.photoURL)return dk(this);var b=this;return this.c(this.getIdToken().then(function(c){return b.f.updateProfile(c,{displayName:a.displayName,photoUrl:a.photoURL})}).then(function(a){kk(b,a);hk(b,\"displayName\",a.displayName||null);hk(b,\"photoURL\",a.photoUrl||null);x(b.providerData,function(a){\"password\"===a.providerId&&(N(a,\"displayName\",b.displayName),N(a,\"photoURL\",b.photoURL))});return ak(b)}).then(ck))};\nh.unlink=function(a){var b=this;return this.c(ik(this).then(function(c){return Va(ek(b),a)?yh(b.f,c,[a]).then(function(a){var c={};x(a.providerUserInfo||[],function(a){c[a.providerId]=!0});x(ek(b),function(a){c[a]||fk(b,a)});c[Og.PROVIDER_ID]||N(b,\"phoneNumber\",null);return ak(b)}):ak(b).then(function(){throw new O(\"no-such-provider\");})}))};\nh[\"delete\"]=function(){var a=this;return this.c(this.getIdToken().then(function(b){return Q(a.f,Jh,{idToken:b})}).then(function(){a.dispatchEvent(new Pj(\"userDeleted\"))})).then(function(){for(var b=0;b<a.J.length;b++)a.J[b].cancel(\"app-deleted\");Uj(a,null);Vj(a,null);a.J=[];a.Kb=!0;Yj(a);N(a,\"refreshToken\",null);a.v&&a.v.unsubscribe(a)})};\nh.ke=function(a,b){return\"linkViaPopup\"==a&&(this.la||null)==b&&this.ka||\"reauthViaPopup\"==a&&(this.la||null)==b&&this.ka||\"linkViaRedirect\"==a&&(this.Ha||null)==b||\"reauthViaRedirect\"==a&&(this.Ha||null)==b?!0:!1};h.bb=function(a,b,c,d){\"linkViaPopup\"!=a&&\"reauthViaPopup\"!=a||d!=(this.la||null)||(c&&this.Va?this.Va(c):b&&!c&&this.ka&&this.ka(b),this.K&&(this.K.cancel(),this.K=null),delete this.ka,delete this.Va)};\nh.Nb=function(a,b){return\"linkViaPopup\"==a&&b==(this.la||null)?r(this.ue,this):\"reauthViaPopup\"==a&&b==(this.la||null)?r(this.ve,this):\"linkViaRedirect\"==a&&(this.Ha||null)==b?r(this.ue,this):\"reauthViaRedirect\"==a&&(this.Ha||null)==b?r(this.ve,this):null};h.sc=function(){return Kf(this.uid+\":::\")};h.linkWithPopup=function(a){var b=this;return pk(this,\"linkViaPopup\",a,function(){return nk(b,a.providerId).then(function(){return ak(b)})},!1)};\nh.reauthenticateWithPopup=function(a){return pk(this,\"reauthViaPopup\",a,function(){return D()},!0)};\nvar pk=function(a,b,c,d,e){if(!Nf())return E(new O(\"operation-not-supported-in-this-environment\"));if(a.sa&&!e)return E(a.sa);var f=jg(c.providerId),g=a.sc(),l=null;(!Of()||Ff())&&a.B&&c.isOAuthProvider&&(l=ci(a.B,a.m,a.o,b,c,null,g,firebase.SDK_VERSION||null));var n=yf(l,f&&f.Zb,f&&f.Yb);d=d().then(function(){qk(a);if(!e)return a.getIdToken().then(function(){})}).then(function(){return a.v.$b(n,b,c,g,!!l)}).then(function(){return new C(function(c,d){a.bb(b,null,new O(\"cancelled-popup-request\"),a.la||\nnull);a.ka=c;a.Va=d;a.la=g;a.K=a.v.ec(a,b,n,g)})}).then(function(a){n&&xf(n);return a?cg(a):null}).g(function(a){n&&xf(n);throw a;});return a.c(d,e)};S.prototype.linkWithRedirect=function(a){var b=this;return rk(this,\"linkViaRedirect\",a,function(){return nk(b,a.providerId)},!1)};S.prototype.reauthenticateWithRedirect=function(a){return rk(this,\"reauthViaRedirect\",a,function(){return D()},!0)};\nvar rk=function(a,b,c,d,e){if(!Nf())return E(new O(\"operation-not-supported-in-this-environment\"));if(a.sa&&!e)return E(a.sa);var f=null,g=a.sc();d=d().then(function(){qk(a);if(!e)return a.getIdToken().then(function(){})}).then(function(){a.Ha=g;return ak(a)}).then(function(b){a.Ya&&(b=a.Ya,b=b.h.set(sk,a.A(),b.j));return b}).then(function(){return a.v.ac(b,c,g)}).g(function(b){f=b;if(a.Ya)return tk(a.Ya);throw f;}).then(function(){if(f)throw f;});return a.c(d,e)},qk=function(a){if(!a.v||!a.Kc){if(a.v&&\n!a.Kc)throw new O(\"internal-error\");throw new O(\"auth-domain-config-required\");}};S.prototype.ue=function(a,b){var c=this;this.K&&(this.K.cancel(),this.K=null);var d=null,e=this.getIdToken().then(function(d){return vg(c.f,{requestUri:a,sessionId:b,idToken:d})}).then(function(a){d=mk(c,a,\"link\");return ok(c,a)}).then(function(){return d});return this.c(e)};\nS.prototype.ve=function(a,b){var c=this;this.K&&(this.K.cancel(),this.K=null);var d=null,e=D().then(function(){return rg(wg(c.f,{requestUri:a,sessionId:b}),c.uid)}).then(function(a){d=mk(c,a,\"reauthenticate\");kk(c,a);c.sa=null;return c.reload()}).then(function(){return d});return this.c(e,!0)};\nS.prototype.sendEmailVerification=function(a){var b=this,c=null;return this.c(this.getIdToken().then(function(b){c=b;return\"undefined\"===typeof a||ib(a)?{}:Hi(new Gi(a))}).then(function(a){return b.f.sendEmailVerification(c,a)}).then(function(a){if(b.email!=a)return b.reload()}).then(function(){}))};S.prototype.c=function(a,b){var c=this,d=uk(this,a,b);this.J.push(d);Ed(d,function(){Xa(c.J,d)});return d};\nvar uk=function(a,b,c){return a.sa&&!c?(b.cancel(),E(a.sa)):b.g(function(b){!b||\"auth/user-disabled\"!=b.code&&\"auth/user-token-expired\"!=b.code||(a.sa||a.dispatchEvent(new Pj(\"userInvalidated\")),a.sa=b);throw b;})};S.prototype.toJSON=function(){return this.A()};\nS.prototype.A=function(){var a={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,providerData:[],apiKey:this.m,appName:this.o,authDomain:this.B,stsTokenManager:this.ra.A(),redirectEventId:this.Ha||null};this.metadata&&mb(a,this.metadata.A());x(this.providerData,function(b){a.providerData.push(dg(b))});return a};\nvar vk=function(a){if(!a.apiKey)return null;var b={apiKey:a.apiKey,authDomain:a.authDomain,appName:a.appName},c={};if(a.stsTokenManager&&a.stsTokenManager.accessToken&&a.stsTokenManager.expirationTime)c.idToken=a.stsTokenManager.accessToken,c.refreshToken=a.stsTokenManager.refreshToken||null,c.expiresIn=(a.stsTokenManager.expirationTime-ma())/1E3;else return null;var d=new S(b,c,a);a.providerData&&x(a.providerData,function(a){a&&gk(d,cg(a))});a.redirectEventId&&(d.Ha=a.redirectEventId);return d},\nwk=function(a,b,c,d){var e=new S(a,b);c&&(e.Ya=c);d&&Tj(e,d);return e.reload().then(function(){return e})};var xk=function(a){this.j=a;this.h=Zi()},sk={name:\"redirectUser\",D:\"session\"},tk=function(a){return a.h.remove(sk,a.j)},yk=function(a,b){return a.h.get(sk,a.j).then(function(a){a&&b&&(a.authDomain=b);return vk(a||{})})};var Ak=function(a,b){this.j=a;this.h=b||Zi();this.O=null;this.Jd=this.Bd();this.h.addListener(zk(\"local\"),this.j,r(this.vg,this))};Ak.prototype.vg=function(){var a=this,b=zk(\"local\");Bk(this,function(){return D().then(function(){return a.O&&\"local\"!=a.O.D?a.h.get(b,a.j):null}).then(function(c){if(c)return Ck(a,\"local\").then(function(){a.O=b})})})};var Ck=function(a,b){var c=[],d;for(d in Vi)Vi[d]!==b&&c.push(a.h.remove(zk(Vi[d]),a.j));c.push(a.h.remove(Dk,a.j));return Ad(c)};\nAk.prototype.Bd=function(){var a=this,b=zk(\"local\"),c=zk(\"session\"),d=zk(\"none\");return this.h.get(c,this.j).then(function(e){return e?c:a.h.get(d,a.j).then(function(c){return c?d:a.h.get(b,a.j).then(function(c){return c?b:a.h.get(Dk,a.j).then(function(a){return a?zk(a):b})})})}).then(function(b){a.O=b;return Ck(a,b.D)}).g(function(){a.O||(a.O=b)})};var Dk={name:\"persistence\",D:\"session\"},zk=function(a){return{name:\"authUser\",D:a}};\nAk.prototype.setPersistence=function(a){var b=null,c=this;Wi(a);return Bk(this,function(){return a!=c.O.D?c.h.get(c.O,c.j).then(function(d){b=d;return Ck(c,a)}).then(function(){c.O=zk(a);if(b)return c.h.set(c.O,b,c.j)}):D()})};\nvar Ek=function(a){return Bk(a,function(){return a.h.set(Dk,a.O.D,a.j)})},Fk=function(a,b){return Bk(a,function(){return a.h.set(a.O,b.A(),a.j)})},Gk=function(a){return Bk(a,function(){return a.h.remove(a.O,a.j)})},Hk=function(a,b){return Bk(a,function(){return a.h.get(a.O,a.j).then(function(a){a&&b&&(a.authDomain=b);return vk(a||{})})})},Bk=function(a,b){a.Jd=a.Jd.then(b,b);return a.Jd};var T=function(a){this.Ea=!1;N(this,\"app\",a);if(this.i().options&&this.i().options.apiKey)a=firebase.SDK_VERSION?Jf(firebase.SDK_VERSION):null,this.f=new R(this.i().options&&this.i().options.apiKey,of(pf),a);else throw new O(\"invalid-api-key\");this.J=[];this.Ka=[];this.Fb=[];this.cg=firebase.INTERNAL.createSubscribe(r(this.Sf,this));this.kc=void 0;this.eg=firebase.INTERNAL.createSubscribe(r(this.Uf,this));Ik(this,null);a=this.i().options.apiKey;var b=this.i().name;this.na=new Ak(a+\":\"+b);a=this.i().options.apiKey;\nb=this.i().name;this.zb=new xk(a+\":\"+b);this.oc=this.c(Jk(this));this.ya=this.c(Kk(this));this.Cc=!1;this.ud=r(this.wg,this);this.ef=r(this.pb,this);this.Gb=r(this.wd,this);this.cf=r(this.Of,this);this.df=r(this.Pf,this);Lk(this);this.INTERNAL={};this.INTERNAL[\"delete\"]=r(this[\"delete\"],this);this.INTERNAL.logFramework=r(this.$f,this);this.Oa=0;G.call(this);Mk(this);this.M=[]};t(T,G);var Nk=function(a){B.call(this,\"languageCodeChanged\");this.languageCode=a};t(Nk,B);\nvar Ok=function(a){B.call(this,\"frameworkChanged\");this.Ff=a};t(Ok,B);T.prototype.setPersistence=function(a){a=this.na.setPersistence(a);return this.c(a)};T.prototype.Cb=function(a){this.ia===a||this.Ea||(this.ia=a,ah(this.f,this.ia),this.dispatchEvent(new Nk(this.ia)))};T.prototype.useDeviceLanguage=function(){var a=k.navigator;this.Cb(a?a.languages&&a.languages[0]||a.language||a.userLanguage||null:null)};\nT.prototype.$f=function(a){this.M.push(a);bh(this.f,firebase.SDK_VERSION?Jf(firebase.SDK_VERSION,this.M):null);this.dispatchEvent(new Ok(this.M))};var Mk=function(a){Object.defineProperty(a,\"lc\",{get:function(){return this.ia},set:function(a){this.Cb(a)},enumerable:!1});a.ia=null};T.prototype.toJSON=function(){return{apiKey:this.i().options.apiKey,authDomain:this.i().options.authDomain,appName:this.i().name,currentUser:U(this)&&U(this).A()}};\nvar Pk=function(a){return a.Af||E(new O(\"auth-domain-config-required\"))},Lk=function(a){var b=a.i().options.authDomain,c=a.i().options.apiKey;b&&Nf()&&(a.Af=a.oc.then(function(){if(!a.Ea){a.v=Ej(b,c,a.i().name);a.v.subscribe(a);U(a)&&bk(U(a));if(a.Za){bk(a.Za);var d=a.Za;d.Cb(a.ia);Uj(d,a);d=a.Za;Tj(d,a.M);Vj(d,a);a.Za=null}return a.v}}))};h=T.prototype;h.ke=function(a,b){switch(a){case \"unknown\":case \"signInViaRedirect\":return!0;case \"signInViaPopup\":return this.la==b&&!!this.ka;default:return!1}};\nh.bb=function(a,b,c,d){\"signInViaPopup\"==a&&this.la==d&&(c&&this.Va?this.Va(c):b&&!c&&this.ka&&this.ka(b),this.K&&(this.K.cancel(),this.K=null),delete this.ka,delete this.Va)};h.Nb=function(a,b){return\"signInViaRedirect\"==a||\"signInViaPopup\"==a&&this.la==b&&this.ka?r(this.Cf,this):null};\nh.Cf=function(a,b){var c=this;a={requestUri:a,sessionId:b};this.K&&(this.K.cancel(),this.K=null);var d=null,e=null,f=tg(c.f,a).then(function(a){d=Rg(a);e=Ui(a);return a});a=c.oc.then(function(){return f}).then(function(a){return Qk(c,a)}).then(function(){return cg({user:U(c),credential:d,additionalUserInfo:e,operationType:\"signIn\"})});return this.c(a)};h.sc=function(){return Kf()};\nh.signInWithPopup=function(a){if(!Nf())return E(new O(\"operation-not-supported-in-this-environment\"));var b=this,c=jg(a.providerId),d=this.sc(),e=null;(!Of()||Ff())&&this.i().options.authDomain&&a.isOAuthProvider&&(e=ci(this.i().options.authDomain,this.i().options.apiKey,this.i().name,\"signInViaPopup\",a,null,d,firebase.SDK_VERSION||null));var f=yf(e,c&&c.Zb,c&&c.Yb);c=Pk(this).then(function(b){return b.$b(f,\"signInViaPopup\",a,d,!!e)}).then(function(){return new C(function(a,c){b.bb(\"signInViaPopup\",\nnull,new O(\"cancelled-popup-request\"),b.la);b.ka=a;b.Va=c;b.la=d;b.K=b.v.ec(b,\"signInViaPopup\",f,d)})}).then(function(a){f&&xf(f);return a?cg(a):null}).g(function(a){f&&xf(f);throw a;});return this.c(c)};h.signInWithRedirect=function(a){if(!Nf())return E(new O(\"operation-not-supported-in-this-environment\"));var b=this,c=Pk(this).then(function(){return Ek(b.na)}).then(function(){return b.v.ac(\"signInViaRedirect\",a)});return this.c(c)};\nh.getRedirectResult=function(){if(!Nf())return E(new O(\"operation-not-supported-in-this-environment\"));var a=this,b=Pk(this).then(function(){return a.v.getRedirectResult()}).then(function(a){return a?cg(a):null});return this.c(b)};\nvar Qk=function(a,b){var c={};c.apiKey=a.i().options.apiKey;c.authDomain=a.i().options.authDomain;c.appName=a.i().name;return a.oc.then(function(){return wk(c,b,a.zb,$a(a.M))}).then(function(b){if(U(a)&&b.uid==U(a).uid)return U(a).copy(b),a.pb(b);Ik(a,b);bk(b);return a.pb(b)}).then(function(){a.Ta()})},Ik=function(a,b){U(a)&&(Zj(U(a),a.ef),tc(U(a),\"tokenChanged\",a.Gb),tc(U(a),\"userDeleted\",a.cf),tc(U(a),\"userInvalidated\",a.df),Yj(U(a)));b&&(b.Rc.push(a.ef),lc(b,\"tokenChanged\",a.Gb),lc(b,\"userDeleted\",\na.cf),lc(b,\"userInvalidated\",a.df),0<a.Oa&&Xj(b));N(a,\"currentUser\",b);b&&(b.Cb(a.ia),Uj(b,a),Tj(b,a.M),Vj(b,a))};T.prototype.signOut=function(){var a=this,b=this.ya.then(function(){if(!U(a))return D();Ik(a,null);return Gk(a.na).then(function(){a.Ta()})});return this.c(b)};\nvar Rk=function(a){var b=a.i().options.authDomain;b=yk(a.zb,b).then(function(b){if(a.Za=b)b.Ya=a.zb;return tk(a.zb)});return a.c(b)},Jk=function(a){var b=a.i().options.authDomain,c=Rk(a).then(function(){return Hk(a.na,b)}).then(function(b){return b?(b.Ya=a.zb,a.Za&&(a.Za.Ha||null)==(b.Ha||null)?b:b.reload().then(function(){return Fk(a.na,b).then(function(){return b})}).g(function(c){return\"auth/network-request-failed\"==c.code?b:Gk(a.na)})):null}).then(function(b){Ik(a,b||null)});return a.c(c)},Kk=\nfunction(a){return a.oc.then(function(){return a.getRedirectResult()}).g(function(){}).then(function(){if(!a.Ea)return a.ud()}).g(function(){}).then(function(){if(!a.Ea){a.Cc=!0;var b=a.na;b.h.addListener(zk(\"local\"),b.j,a.ud)}})};h=T.prototype;\nh.wg=function(){var a=this,b=this.i().options.authDomain;return Hk(this.na,b).then(function(b){if(!a.Ea){var c;if(c=U(a)&&b){c=U(a).uid;var e=b.uid;c=void 0===c||null===c||\"\"===c||void 0===e||null===e||\"\"===e?!1:c==e}if(c)return U(a).copy(b),U(a).getIdToken();if(U(a)||b)Ik(a,b),b&&(bk(b),b.Ya=a.zb),a.v&&a.v.subscribe(a),a.Ta()}})};h.pb=function(a){return Fk(this.na,a)};h.wd=function(){this.Ta();this.pb(U(this))};h.Of=function(){this.signOut()};h.Pf=function(){this.signOut()};\nvar Sk=function(a,b){var c=null,d=null;return a.c(b.then(function(b){c=Rg(b);d=Ui(b);return Qk(a,b)}).then(function(){return cg({user:U(a),credential:c,additionalUserInfo:d,operationType:\"signIn\"})}))};h=T.prototype;h.Sf=function(a){var b=this;this.addAuthTokenListener(function(){a.next(U(b))})};h.Uf=function(a){var b=this;Tk(this,function(){a.next(U(b))})};\nh.onIdTokenChanged=function(a,b,c){var d=this;this.Cc&&firebase.Promise.resolve().then(function(){p(a)?a(U(d)):p(a.next)&&a.next(U(d))});return this.cg(a,b,c)};h.onAuthStateChanged=function(a,b,c){var d=this;this.Cc&&firebase.Promise.resolve().then(function(){d.kc=d.getUid();p(a)?a(U(d)):p(a.next)&&a.next(U(d))});return this.eg(a,b,c)};h.If=function(a){var b=this,c=this.ya.then(function(){return U(b)?U(b).getIdToken(a).then(function(a){return{accessToken:a}}):null});return this.c(c)};\nh.signInWithCustomToken=function(a){var b=this;return this.ya.then(function(){return Sk(b,Q(b.f,Mh,{token:a}))}).then(function(a){a=a.user;hk(a,\"isAnonymous\",!1);return b.pb(a)}).then(function(){return U(b)})};h.signInWithEmailAndPassword=function(a,b){var c=this;return this.ya.then(function(){return Sk(c,Q(c.f,Hg,{email:a,password:b}))}).then(function(a){return a.user})};h.createUserWithEmailAndPassword=function(a,b){var c=this;return this.ya.then(function(){return Sk(c,Q(c.f,Ih,{email:a,password:b}))}).then(function(a){return a.user})};\nh.signInWithCredential=function(a){return this.signInAndRetrieveDataWithCredential(a).then(function(a){return a.user})};h.signInAndRetrieveDataWithCredential=function(a){var b=this;return this.ya.then(function(){return Sk(b,a.Ob(b.f))})};h.signInAnonymously=function(){var a=this;return this.ya.then(function(){var b=U(a);return b&&b.isAnonymous?b:Sk(a,a.f.signInAnonymously()).then(function(b){b=b.user;hk(b,\"isAnonymous\",!0);return a.pb(b)}).then(function(){return U(a)})})};h.i=function(){return this.app};\nvar U=function(a){return a.currentUser};T.prototype.getUid=function(){return U(this)&&U(this).uid||null};var Uk=function(a){return U(a)&&U(a)._lat||null};h=T.prototype;h.Ta=function(){if(this.Cc){for(var a=0;a<this.Ka.length;a++)if(this.Ka[a])this.Ka[a](Uk(this));if(this.kc!==this.getUid()&&this.Fb.length)for(this.kc=this.getUid(),a=0;a<this.Fb.length;a++)if(this.Fb[a])this.Fb[a](Uk(this))}};h.pf=function(a){this.addAuthTokenListener(a);this.Oa++;0<this.Oa&&U(this)&&Xj(U(this))};\nh.jg=function(a){var b=this;x(this.Ka,function(c){c==a&&b.Oa--});0>this.Oa&&(this.Oa=0);0==this.Oa&&U(this)&&Yj(U(this));this.removeAuthTokenListener(a)};h.addAuthTokenListener=function(a){var b=this;this.Ka.push(a);this.c(this.ya.then(function(){b.Ea||Va(b.Ka,a)&&a(Uk(b))}))};h.removeAuthTokenListener=function(a){Ya(this.Ka,function(b){return b==a})};var Tk=function(a,b){a.Fb.push(b);a.c(a.ya.then(function(){!a.Ea&&Va(a.Fb,b)&&a.kc!==a.getUid()&&(a.kc=a.getUid(),b(Uk(a)))}))};h=T.prototype;\nh[\"delete\"]=function(){this.Ea=!0;for(var a=0;a<this.J.length;a++)this.J[a].cancel(\"app-deleted\");this.J=[];this.na&&(a=this.na,a.h.removeListener(zk(\"local\"),a.j,this.ud));this.v&&this.v.unsubscribe(this);return firebase.Promise.resolve()};h.c=function(a){var b=this;this.J.push(a);Ed(a,function(){Xa(b.J,a)});return a};h.fetchProvidersForEmail=function(a){return this.c(mh(this.f,a))};h.verifyPasswordResetCode=function(a){return this.checkActionCode(a).then(function(a){return a.data.email})};\nh.confirmPasswordReset=function(a,b){return this.c(this.f.confirmPasswordReset(a,b).then(function(){}))};h.checkActionCode=function(a){return this.c(this.f.checkActionCode(a).then(function(a){return new Ki(a)}))};h.applyActionCode=function(a){return this.c(this.f.applyActionCode(a).then(function(){}))};h.sendPasswordResetEmail=function(a,b){var c=this;return this.c(D().then(function(){return\"undefined\"===typeof b||ib(b)?{}:Hi(new Gi(b))}).then(function(b){return c.f.sendPasswordResetEmail(a,b)}).then(function(){}))};\nh.signInWithPhoneNumber=function(a,b){return this.c(Ji(this,a,b,r(this.signInAndRetrieveDataWithCredential,this)))};var Wk=function(a,b,c,d){a:{c=Array.prototype.slice.call(c);var e=0;for(var f=!1,g=0;g<b.length;g++)if(b[g].optional)f=!0;else{if(f)throw new O(\"internal-error\",\"Argument validator encountered a required argument after an optional argument.\");e++}f=b.length;if(c.length<e||f<c.length)d=\"Expected \"+(e==f?1==e?\"1 argument\":e+\" arguments\":e+\"-\"+f+\" arguments\")+\" but got \"+c.length+\".\";else{for(e=0;e<c.length;e++)if(f=b[e].optional&&void 0===c[e],!b[e].W(c[e])&&!f){b=b[e];if(0>e||e>=Vk.length)throw new O(\"internal-error\",\n\"Argument validator received an unsupported number of arguments.\");c=Vk[e];d=(d?\"\":c+\" argument \")+(b.name?'\"'+b.name+'\" ':\"\")+\"must be \"+b.V+\".\";break a}d=null}}if(d)throw new O(\"argument-error\",a+\" failed: \"+d);},Vk=\"First Second Third Fourth Fifth Sixth Seventh Eighth Ninth\".split(\" \"),V=function(a,b){return{name:a||\"\",V:\"a valid string\",optional:!!b,W:m}},Xk=function(){return{name:\"opt_forceRefresh\",V:\"a boolean\",optional:!0,W:ca}},W=function(a,b){return{name:a||\"\",V:\"a valid object\",optional:!!b,\nW:q}},Yk=function(a,b){return{name:a||\"\",V:\"a function\",optional:!!b,W:p}},Zk=function(a,b){return{name:a||\"\",V:\"null\",optional:!!b,W:fa}},$k=function(){return{name:\"\",V:\"an HTML element\",optional:!1,W:function(a){return!!(a&&a instanceof Element)}}},al=function(){return{name:\"auth\",V:\"an instance of Firebase Auth\",optional:!0,W:function(a){return!!(a&&a instanceof T)}}},bl=function(){return{name:\"app\",V:\"an instance of Firebase App\",optional:!0,W:function(a){return!!(a&&a instanceof firebase.app.App)}}},\ncl=function(a){return{name:a?a+\"Credential\":\"credential\",V:a?\"a valid \"+a+\" credential\":\"a valid credential\",optional:!1,W:function(b){if(!b)return!1;var c=!a||b.providerId===a;return!(!b.Ob||!c)}}},dl=function(){return{name:\"authProvider\",V:\"a valid Auth provider\",optional:!1,W:function(a){return!!(a&&a.providerId&&a.hasOwnProperty&&a.hasOwnProperty(\"isOAuthProvider\"))}}},el=function(){return{name:\"applicationVerifier\",V:\"an implementation of firebase.auth.ApplicationVerifier\",optional:!1,W:function(a){return!!(a&&\nm(a.type)&&p(a.verify))}}},X=function(a,b,c,d){return{name:c||\"\",V:a.V+\" or \"+b.V,optional:!!d,W:function(c){return a.W(c)||b.W(c)}}};var Y=function(a,b){for(var c in b){var d=b[c].name;a[d]=fl(d,a[c],b[c].a)}},Z=function(a,b,c,d){a[b]=fl(b,c,d)},fl=function(a,b,c){if(!c)return b;var d=gl(a);a=function(){var a=Array.prototype.slice.call(arguments);Wk(d,c,a);return b.apply(this,a)};for(var e in b)a[e]=b[e];for(e in b.prototype)a.prototype[e]=b.prototype[e];return a},gl=function(a){a=a.split(\".\");return a[a.length-1]};Y(T.prototype,{applyActionCode:{name:\"applyActionCode\",a:[V(\"code\")]},checkActionCode:{name:\"checkActionCode\",a:[V(\"code\")]},confirmPasswordReset:{name:\"confirmPasswordReset\",a:[V(\"code\"),V(\"newPassword\")]},createUserWithEmailAndPassword:{name:\"createUserWithEmailAndPassword\",a:[V(\"email\"),V(\"password\")]},fetchProvidersForEmail:{name:\"fetchProvidersForEmail\",a:[V(\"email\")]},getRedirectResult:{name:\"getRedirectResult\",a:[]},onAuthStateChanged:{name:\"onAuthStateChanged\",a:[X(W(),Yk(),\"nextOrObserver\"),\nYk(\"opt_error\",!0),Yk(\"opt_completed\",!0)]},onIdTokenChanged:{name:\"onIdTokenChanged\",a:[X(W(),Yk(),\"nextOrObserver\"),Yk(\"opt_error\",!0),Yk(\"opt_completed\",!0)]},sendPasswordResetEmail:{name:\"sendPasswordResetEmail\",a:[V(\"email\"),X(W(\"opt_actionCodeSettings\",!0),Zk(null,!0),\"opt_actionCodeSettings\",!0)]},setPersistence:{name:\"setPersistence\",a:[V(\"persistence\")]},signInAndRetrieveDataWithCredential:{name:\"signInAndRetrieveDataWithCredential\",a:[cl()]},signInAnonymously:{name:\"signInAnonymously\",a:[]},\nsignInWithCredential:{name:\"signInWithCredential\",a:[cl()]},signInWithCustomToken:{name:\"signInWithCustomToken\",a:[V(\"token\")]},signInWithEmailAndPassword:{name:\"signInWithEmailAndPassword\",a:[V(\"email\"),V(\"password\")]},signInWithPhoneNumber:{name:\"signInWithPhoneNumber\",a:[V(\"phoneNumber\"),el()]},signInWithPopup:{name:\"signInWithPopup\",a:[dl()]},signInWithRedirect:{name:\"signInWithRedirect\",a:[dl()]},signOut:{name:\"signOut\",a:[]},toJSON:{name:\"toJSON\",a:[V(null,!0)]},useDeviceLanguage:{name:\"useDeviceLanguage\",\na:[]},verifyPasswordResetCode:{name:\"verifyPasswordResetCode\",a:[V(\"code\")]}});(function(a,b){for(var c in b){var d=b[c].name;if(d!==c){var e=b[c].rf;Object.defineProperty(a,d,{get:function(){return this[c]},set:function(a){Wk(d,[e],[a],!0);this[c]=a},enumerable:!0})}}})(T.prototype,{lc:{name:\"languageCode\",rf:X(V(),Zk(),\"languageCode\")}});T.Persistence=Vi;T.Persistence.LOCAL=\"local\";T.Persistence.SESSION=\"session\";T.Persistence.NONE=\"none\";\nY(S.prototype,{\"delete\":{name:\"delete\",a:[]},getIdToken:{name:\"getIdToken\",a:[Xk()]},getToken:{name:\"getToken\",a:[Xk()]},linkAndRetrieveDataWithCredential:{name:\"linkAndRetrieveDataWithCredential\",a:[cl()]},linkWithCredential:{name:\"linkWithCredential\",a:[cl()]},linkWithPhoneNumber:{name:\"linkWithPhoneNumber\",a:[V(\"phoneNumber\"),el()]},linkWithPopup:{name:\"linkWithPopup\",a:[dl()]},linkWithRedirect:{name:\"linkWithRedirect\",a:[dl()]},reauthenticateAndRetrieveDataWithCredential:{name:\"reauthenticateAndRetrieveDataWithCredential\",\na:[cl()]},reauthenticateWithCredential:{name:\"reauthenticateWithCredential\",a:[cl()]},reauthenticateWithPhoneNumber:{name:\"reauthenticateWithPhoneNumber\",a:[V(\"phoneNumber\"),el()]},reauthenticateWithPopup:{name:\"reauthenticateWithPopup\",a:[dl()]},reauthenticateWithRedirect:{name:\"reauthenticateWithRedirect\",a:[dl()]},reload:{name:\"reload\",a:[]},sendEmailVerification:{name:\"sendEmailVerification\",a:[X(W(\"opt_actionCodeSettings\",!0),Zk(null,!0),\"opt_actionCodeSettings\",!0)]},toJSON:{name:\"toJSON\",a:[V(null,\n!0)]},unlink:{name:\"unlink\",a:[V(\"provider\")]},updateEmail:{name:\"updateEmail\",a:[V(\"email\")]},updatePassword:{name:\"updatePassword\",a:[V(\"password\")]},updatePhoneNumber:{name:\"updatePhoneNumber\",a:[cl(\"phone\")]},updateProfile:{name:\"updateProfile\",a:[W(\"profile\")]}});Y(C.prototype,{g:{name:\"catch\"},then:{name:\"then\"}});Y(Ii.prototype,{confirm:{name:\"confirm\",a:[V(\"verificationCode\")]}});Z(Jg,\"credential\",function(a,b){return new Gg(a,b)},[V(\"email\"),V(\"password\")]);\nY(yg.prototype,{addScope:{name:\"addScope\",a:[V(\"scope\")]},setCustomParameters:{name:\"setCustomParameters\",a:[W(\"customOAuthParameters\")]}});Z(yg,\"credential\",zg,[X(V(),W(),\"token\")]);Y(Ag.prototype,{addScope:{name:\"addScope\",a:[V(\"scope\")]},setCustomParameters:{name:\"setCustomParameters\",a:[W(\"customOAuthParameters\")]}});Z(Ag,\"credential\",Bg,[X(V(),W(),\"token\")]);Y(Cg.prototype,{addScope:{name:\"addScope\",a:[V(\"scope\")]},setCustomParameters:{name:\"setCustomParameters\",a:[W(\"customOAuthParameters\")]}});\nZ(Cg,\"credential\",Dg,[X(V(),X(W(),Zk()),\"idToken\"),X(V(),Zk(),\"accessToken\",!0)]);Y(Eg.prototype,{setCustomParameters:{name:\"setCustomParameters\",a:[W(\"customOAuthParameters\")]}});Z(Eg,\"credential\",Fg,[X(V(),W(),\"token\"),V(\"secret\",!0)]);Y(P.prototype,{addScope:{name:\"addScope\",a:[V(\"scope\")]},credential:{name:\"credential\",a:[X(V(),Zk(),\"idToken\",!0),X(V(),Zk(),\"accessToken\",!0)]},setCustomParameters:{name:\"setCustomParameters\",a:[W(\"customOAuthParameters\")]}});\nZ(Og,\"credential\",Qg,[V(\"verificationId\"),V(\"verificationCode\")]);Y(Og.prototype,{verifyPhoneNumber:{name:\"verifyPhoneNumber\",a:[V(\"phoneNumber\"),el()]}});Y(O.prototype,{toJSON:{name:\"toJSON\",a:[V(null,!0)]}});Y(Tg.prototype,{toJSON:{name:\"toJSON\",a:[V(null,!0)]}});Y(og.prototype,{toJSON:{name:\"toJSON\",a:[V(null,!0)]}});Y(li.prototype,{clear:{name:\"clear\",a:[]},render:{name:\"render\",a:[]},verify:{name:\"verify\",a:[]}});\n(function(){if(\"undefined\"!==typeof firebase&&firebase.INTERNAL&&firebase.INTERNAL.registerService){var a={Auth:T,Error:O};Z(a,\"EmailAuthProvider\",Jg,[]);Z(a,\"FacebookAuthProvider\",yg,[]);Z(a,\"GithubAuthProvider\",Ag,[]);Z(a,\"GoogleAuthProvider\",Cg,[]);Z(a,\"TwitterAuthProvider\",Eg,[]);Z(a,\"OAuthProvider\",P,[V(\"providerId\")]);Z(a,\"PhoneAuthProvider\",Og,[al()]);Z(a,\"RecaptchaVerifier\",li,[X(V(),$k(),\"recaptchaContainer\"),W(\"recaptchaParameters\",!0),bl()]);firebase.INTERNAL.registerService(\"auth\",function(a,\nc){a=new T(a);c({INTERNAL:{getUid:r(a.getUid,a),getToken:r(a.If,a),addAuthTokenListener:r(a.pf,a),removeAuthTokenListener:r(a.jg,a)}});return a},a,function(a,c){if(\"create\"===a)try{c.auth()}catch(d){}});firebase.INTERNAL.extendNamespace({User:S})}else throw Error(\"Cannot find the firebase namespace; be sure to include firebase-app.js before this library.\");})();}).call(this);\n}).call(typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : typeof window !== 'undefined' ? window : {});\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n\n},{\"@firebase/app\":1}],4:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar app_1 = require(\"@firebase/app\");\nvar Database_1 = require(\"./src/api/Database\");\nvar Query_1 = require(\"./src/api/Query\");\nvar Reference_1 = require(\"./src/api/Reference\");\nvar util_1 = require(\"./src/core/util/util\");\nvar RepoManager_1 = require(\"./src/core/RepoManager\");\nvar INTERNAL = require(\"./src/api/internal\");\nvar TEST_ACCESS = require(\"./src/api/test_access\");\nvar util_2 = require(\"@firebase/util\");\nfunction registerDatabase(instance) {\n    // Register the Database Service with the 'firebase' namespace.\n    var namespace = instance.INTERNAL.registerService('database', function (app, unused, url) { return RepoManager_1.RepoManager.getInstance().databaseFromApp(app, url); }, \n    // firebase.database namespace properties\n    {\n        Reference: Reference_1.Reference,\n        Query: Query_1.Query,\n        Database: Database_1.Database,\n        enableLogging: util_1.enableLogging,\n        INTERNAL: INTERNAL,\n        ServerValue: Database_1.Database.ServerValue,\n        TEST_ACCESS: TEST_ACCESS\n    }, null, true);\n    if (util_2.isNodeSdk()) {\n        module.exports = namespace;\n    }\n}\nexports.registerDatabase = registerDatabase;\nregisterDatabase(app_1.default);\n\n\n\n},{\"./src/api/Database\":6,\"./src/api/Query\":7,\"./src/api/Reference\":8,\"./src/api/internal\":10,\"./src/api/test_access\":12,\"./src/core/RepoManager\":19,\"./src/core/util/util\":63,\"@firebase/app\":1,\"@firebase/util\":134}],5:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\nvar validation_1 = require(\"../core/util/validation\");\nvar Path_1 = require(\"../core/util/Path\");\nvar PriorityIndex_1 = require(\"../core/snap/indexes/PriorityIndex\");\n/**\n * Class representing a firebase data snapshot.  It wraps a SnapshotNode and\n * surfaces the public methods (val, forEach, etc.) we want to expose.\n */\nvar DataSnapshot = /** @class */ (function () {\n    /**\n     * @param {!Node} node_ A SnapshotNode to wrap.\n     * @param {!Reference} ref_ The ref of the location this snapshot came from.\n     * @param {!Index} index_ The iteration order for this snapshot\n     */\n    function DataSnapshot(node_, ref_, index_) {\n        this.node_ = node_;\n        this.ref_ = ref_;\n        this.index_ = index_;\n    }\n    /**\n     * Retrieves the snapshot contents as JSON.  Returns null if the snapshot is\n     * empty.\n     *\n     * @return {*} JSON representation of the DataSnapshot contents, or null if empty.\n     */\n    DataSnapshot.prototype.val = function () {\n        util_1.validateArgCount('DataSnapshot.val', 0, 0, arguments.length);\n        return this.node_.val();\n    };\n    /**\n     * Returns the snapshot contents as JSON, including priorities of node.  Suitable for exporting\n     * the entire node contents.\n     * @return {*} JSON representation of the DataSnapshot contents, or null if empty.\n     */\n    DataSnapshot.prototype.exportVal = function () {\n        util_1.validateArgCount('DataSnapshot.exportVal', 0, 0, arguments.length);\n        return this.node_.val(true);\n    };\n    // Do not create public documentation. This is intended to make JSON serialization work but is otherwise unnecessary\n    // for end-users\n    DataSnapshot.prototype.toJSON = function () {\n        // Optional spacer argument is unnecessary because we're depending on recursion rather than stringifying the content\n        util_1.validateArgCount('DataSnapshot.toJSON', 0, 1, arguments.length);\n        return this.exportVal();\n    };\n    /**\n     * Returns whether the snapshot contains a non-null value.\n     *\n     * @return {boolean} Whether the snapshot contains a non-null value, or is empty.\n     */\n    DataSnapshot.prototype.exists = function () {\n        util_1.validateArgCount('DataSnapshot.exists', 0, 0, arguments.length);\n        return !this.node_.isEmpty();\n    };\n    /**\n     * Returns a DataSnapshot of the specified child node's contents.\n     *\n     * @param {!string} childPathString Path to a child.\n     * @return {!DataSnapshot} DataSnapshot for child node.\n     */\n    DataSnapshot.prototype.child = function (childPathString) {\n        util_1.validateArgCount('DataSnapshot.child', 0, 1, arguments.length);\n        // Ensure the childPath is a string (can be a number)\n        childPathString = String(childPathString);\n        validation_1.validatePathString('DataSnapshot.child', 1, childPathString, false);\n        var childPath = new Path_1.Path(childPathString);\n        var childRef = this.ref_.child(childPath);\n        return new DataSnapshot(this.node_.getChild(childPath), childRef, PriorityIndex_1.PRIORITY_INDEX);\n    };\n    /**\n     * Returns whether the snapshot contains a child at the specified path.\n     *\n     * @param {!string} childPathString Path to a child.\n     * @return {boolean} Whether the child exists.\n     */\n    DataSnapshot.prototype.hasChild = function (childPathString) {\n        util_1.validateArgCount('DataSnapshot.hasChild', 1, 1, arguments.length);\n        validation_1.validatePathString('DataSnapshot.hasChild', 1, childPathString, false);\n        var childPath = new Path_1.Path(childPathString);\n        return !this.node_.getChild(childPath).isEmpty();\n    };\n    /**\n     * Returns the priority of the object, or null if no priority was set.\n     *\n     * @return {string|number|null} The priority.\n     */\n    DataSnapshot.prototype.getPriority = function () {\n        util_1.validateArgCount('DataSnapshot.getPriority', 0, 0, arguments.length);\n        // typecast here because we never return deferred values or internal priorities (MAX_PRIORITY)\n        return this.node_.getPriority().val();\n    };\n    /**\n     * Iterates through child nodes and calls the specified action for each one.\n     *\n     * @param {function(!DataSnapshot)} action Callback function to be called\n     * for each child.\n     * @return {boolean} True if forEach was canceled by action returning true for\n     * one of the child nodes.\n     */\n    DataSnapshot.prototype.forEach = function (action) {\n        var _this = this;\n        util_1.validateArgCount('DataSnapshot.forEach', 1, 1, arguments.length);\n        util_1.validateCallback('DataSnapshot.forEach', 1, action, false);\n        if (this.node_.isLeafNode())\n            return false;\n        var childrenNode = this.node_;\n        // Sanitize the return value to a boolean. ChildrenNode.forEachChild has a weird return type...\n        return !!childrenNode.forEachChild(this.index_, function (key, node) {\n            return action(new DataSnapshot(node, _this.ref_.child(key), PriorityIndex_1.PRIORITY_INDEX));\n        });\n    };\n    /**\n     * Returns whether this DataSnapshot has children.\n     * @return {boolean} True if the DataSnapshot contains 1 or more child nodes.\n     */\n    DataSnapshot.prototype.hasChildren = function () {\n        util_1.validateArgCount('DataSnapshot.hasChildren', 0, 0, arguments.length);\n        if (this.node_.isLeafNode())\n            return false;\n        else\n            return !this.node_.isEmpty();\n    };\n    Object.defineProperty(DataSnapshot.prototype, \"key\", {\n        get: function () {\n            return this.ref_.getKey();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Returns the number of children for this DataSnapshot.\n     * @return {number} The number of children that this DataSnapshot contains.\n     */\n    DataSnapshot.prototype.numChildren = function () {\n        util_1.validateArgCount('DataSnapshot.numChildren', 0, 0, arguments.length);\n        return this.node_.numChildren();\n    };\n    /**\n     * @return {Reference} The Firebase reference for the location this snapshot's data came from.\n     */\n    DataSnapshot.prototype.getRef = function () {\n        util_1.validateArgCount('DataSnapshot.ref', 0, 0, arguments.length);\n        return this.ref_;\n    };\n    Object.defineProperty(DataSnapshot.prototype, \"ref\", {\n        get: function () {\n            return this.getRef();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return DataSnapshot;\n}());\nexports.DataSnapshot = DataSnapshot;\n\n\n\n},{\"../core/snap/indexes/PriorityIndex\":41,\"../core/util/Path\":57,\"../core/util/validation\":64,\"@firebase/util\":134}],6:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"../core/util/util\");\nvar parser_1 = require(\"../core/util/libs/parser\");\nvar Path_1 = require(\"../core/util/Path\");\nvar Reference_1 = require(\"./Reference\");\nvar Repo_1 = require(\"../core/Repo\");\nvar RepoManager_1 = require(\"../core/RepoManager\");\nvar util_2 = require(\"@firebase/util\");\nvar validation_1 = require(\"../core/util/validation\");\n/**\n * Class representing a firebase database.\n * @implements {FirebaseService}\n */\nvar Database = /** @class */ (function () {\n    /**\n     * The constructor should not be called by users of our public API.\n     * @param {!Repo} repo_\n     */\n    function Database(repo_) {\n        this.repo_ = repo_;\n        if (!(repo_ instanceof Repo_1.Repo)) {\n            util_1.fatal(\"Don't call new Database() directly - please use firebase.database().\");\n        }\n        /** @type {Reference} */\n        this.root_ = new Reference_1.Reference(repo_, Path_1.Path.Empty);\n        this.INTERNAL = new DatabaseInternals(this);\n    }\n    Object.defineProperty(Database.prototype, \"app\", {\n        get: function () {\n            return this.repo_.app;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Returns a reference to the root or the path specified in opt_pathString.\n     * @param {string=} pathString\n     * @return {!Reference} Firebase reference.\n     */\n    Database.prototype.ref = function (pathString) {\n        this.checkDeleted_('ref');\n        util_2.validateArgCount('database.ref', 0, 1, arguments.length);\n        return pathString !== undefined ? this.root_.child(pathString) : this.root_;\n    };\n    /**\n     * Returns a reference to the root or the path specified in url.\n     * We throw a exception if the url is not in the same domain as the\n     * current repo.\n     * @param {string} url\n     * @return {!Reference} Firebase reference.\n     */\n    Database.prototype.refFromURL = function (url) {\n        /** @const {string} */\n        var apiName = 'database.refFromURL';\n        this.checkDeleted_(apiName);\n        util_2.validateArgCount(apiName, 1, 1, arguments.length);\n        var parsedURL = parser_1.parseRepoInfo(url);\n        validation_1.validateUrl(apiName, 1, parsedURL);\n        var repoInfo = parsedURL.repoInfo;\n        if (repoInfo.host !== this.repo_.repoInfo_.host) {\n            util_1.fatal(apiName +\n                ': Host name does not match the current database: ' +\n                '(found ' +\n                repoInfo.host +\n                ' but expected ' +\n                this.repo_.repoInfo_.host +\n                ')');\n        }\n        return this.ref(parsedURL.path.toString());\n    };\n    /**\n     * @param {string} apiName\n     */\n    Database.prototype.checkDeleted_ = function (apiName) {\n        if (this.repo_ === null) {\n            util_1.fatal('Cannot call ' + apiName + ' on a deleted database.');\n        }\n    };\n    // Make individual repo go offline.\n    Database.prototype.goOffline = function () {\n        util_2.validateArgCount('database.goOffline', 0, 0, arguments.length);\n        this.checkDeleted_('goOffline');\n        this.repo_.interrupt();\n    };\n    Database.prototype.goOnline = function () {\n        util_2.validateArgCount('database.goOnline', 0, 0, arguments.length);\n        this.checkDeleted_('goOnline');\n        this.repo_.resume();\n    };\n    Database.ServerValue = {\n        TIMESTAMP: {\n            '.sv': 'timestamp'\n        }\n    };\n    return Database;\n}());\nexports.Database = Database;\nvar DatabaseInternals = /** @class */ (function () {\n    /** @param {!Database} database */\n    function DatabaseInternals(database) {\n        this.database = database;\n    }\n    /** @return {Promise<void>} */\n    DatabaseInternals.prototype.delete = function () {\n        this.database.checkDeleted_('delete');\n        RepoManager_1.RepoManager.getInstance().deleteRepo(this.database.repo_);\n        this.database.repo_ = null;\n        this.database.root_ = null;\n        this.database.INTERNAL = null;\n        this.database = null;\n        return Promise.resolve();\n    };\n    return DatabaseInternals;\n}());\nexports.DatabaseInternals = DatabaseInternals;\n\n\n\n},{\"../core/Repo\":17,\"../core/RepoManager\":19,\"../core/util/Path\":57,\"../core/util/libs/parser\":62,\"../core/util/util\":63,\"../core/util/validation\":64,\"./Reference\":8,\"@firebase/util\":134}],7:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\nvar KeyIndex_1 = require(\"../core/snap/indexes/KeyIndex\");\nvar PriorityIndex_1 = require(\"../core/snap/indexes/PriorityIndex\");\nvar ValueIndex_1 = require(\"../core/snap/indexes/ValueIndex\");\nvar PathIndex_1 = require(\"../core/snap/indexes/PathIndex\");\nvar util_2 = require(\"../core/util/util\");\nvar Path_1 = require(\"../core/util/Path\");\nvar validation_1 = require(\"../core/util/validation\");\nvar util_3 = require(\"@firebase/util\");\nvar EventRegistration_1 = require(\"../core/view/EventRegistration\");\nvar util_4 = require(\"@firebase/util\");\nvar __referenceConstructor;\n/**\n * A Query represents a filter to be applied to a firebase location.  This object purely represents the\n * query expression (and exposes our public API to build the query).  The actual query logic is in ViewBase.js.\n *\n * Since every Firebase reference is a query, Firebase inherits from this object.\n */\nvar Query = /** @class */ (function () {\n    function Query(repo, path, queryParams_, orderByCalled_) {\n        this.repo = repo;\n        this.path = path;\n        this.queryParams_ = queryParams_;\n        this.orderByCalled_ = orderByCalled_;\n    }\n    Object.defineProperty(Query, \"__referenceConstructor\", {\n        get: function () {\n            util_1.assert(__referenceConstructor, 'Reference.ts has not been loaded');\n            return __referenceConstructor;\n        },\n        set: function (val) {\n            __referenceConstructor = val;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Validates start/end values for queries.\n     * @param {!QueryParams} params\n     * @private\n     */\n    Query.validateQueryEndpoints_ = function (params) {\n        var startNode = null;\n        var endNode = null;\n        if (params.hasStart()) {\n            startNode = params.getIndexStartValue();\n        }\n        if (params.hasEnd()) {\n            endNode = params.getIndexEndValue();\n        }\n        if (params.getIndex() === KeyIndex_1.KEY_INDEX) {\n            var tooManyArgsError = 'Query: When ordering by key, you may only pass one argument to ' +\n                'startAt(), endAt(), or equalTo().';\n            var wrongArgTypeError = 'Query: When ordering by key, the argument passed to startAt(), endAt(),' +\n                'or equalTo() must be a string.';\n            if (params.hasStart()) {\n                var startName = params.getIndexStartName();\n                if (startName != util_2.MIN_NAME) {\n                    throw new Error(tooManyArgsError);\n                }\n                else if (typeof startNode !== 'string') {\n                    throw new Error(wrongArgTypeError);\n                }\n            }\n            if (params.hasEnd()) {\n                var endName = params.getIndexEndName();\n                if (endName != util_2.MAX_NAME) {\n                    throw new Error(tooManyArgsError);\n                }\n                else if (typeof endNode !== 'string') {\n                    throw new Error(wrongArgTypeError);\n                }\n            }\n        }\n        else if (params.getIndex() === PriorityIndex_1.PRIORITY_INDEX) {\n            if ((startNode != null && !validation_1.isValidPriority(startNode)) ||\n                (endNode != null && !validation_1.isValidPriority(endNode))) {\n                throw new Error('Query: When ordering by priority, the first argument passed to startAt(), ' +\n                    'endAt(), or equalTo() must be a valid priority value (null, a number, or a string).');\n            }\n        }\n        else {\n            util_1.assert(params.getIndex() instanceof PathIndex_1.PathIndex ||\n                params.getIndex() === ValueIndex_1.VALUE_INDEX, 'unknown index type.');\n            if ((startNode != null && typeof startNode === 'object') ||\n                (endNode != null && typeof endNode === 'object')) {\n                throw new Error('Query: First argument passed to startAt(), endAt(), or equalTo() cannot be ' +\n                    'an object.');\n            }\n        }\n    };\n    /**\n     * Validates that limit* has been called with the correct combination of parameters\n     * @param {!QueryParams} params\n     * @private\n     */\n    Query.validateLimit_ = function (params) {\n        if (params.hasStart() &&\n            params.hasEnd() &&\n            params.hasLimit() &&\n            !params.hasAnchoredLimit()) {\n            throw new Error(\"Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.\");\n        }\n    };\n    /**\n     * Validates that no other order by call has been made\n     * @param {!string} fnName\n     * @private\n     */\n    Query.prototype.validateNoPreviousOrderByCall_ = function (fnName) {\n        if (this.orderByCalled_ === true) {\n            throw new Error(fnName + \": You can't combine multiple orderBy calls.\");\n        }\n    };\n    /**\n     * @return {!QueryParams}\n     */\n    Query.prototype.getQueryParams = function () {\n        return this.queryParams_;\n    };\n    /**\n     * @return {!Reference}\n     */\n    Query.prototype.getRef = function () {\n        util_3.validateArgCount('Query.ref', 0, 0, arguments.length);\n        // This is a slight hack. We cannot goog.require('fb.api.Firebase'), since Firebase requires fb.api.Query.\n        // However, we will always export 'Firebase' to the global namespace, so it's guaranteed to exist by the time this\n        // method gets called.\n        return new Query.__referenceConstructor(this.repo, this.path);\n    };\n    /**\n     * @param {!string} eventType\n     * @param {!function(DataSnapshot, string=)} callback\n     * @param {(function(Error)|Object)=} cancelCallbackOrContext\n     * @param {Object=} context\n     * @return {!function(DataSnapshot, string=)}\n     */\n    Query.prototype.on = function (eventType, callback, cancelCallbackOrContext, context) {\n        util_3.validateArgCount('Query.on', 2, 4, arguments.length);\n        validation_1.validateEventType('Query.on', 1, eventType, false);\n        util_3.validateCallback('Query.on', 2, callback, false);\n        var ret = Query.getCancelAndContextArgs_('Query.on', cancelCallbackOrContext, context);\n        if (eventType === 'value') {\n            this.onValueEvent(callback, ret.cancel, ret.context);\n        }\n        else {\n            var callbacks = {};\n            callbacks[eventType] = callback;\n            this.onChildEvent(callbacks, ret.cancel, ret.context);\n        }\n        return callback;\n    };\n    /**\n     * @param {!function(!DataSnapshot)} callback\n     * @param {?function(Error)} cancelCallback\n     * @param {?Object} context\n     * @protected\n     */\n    Query.prototype.onValueEvent = function (callback, cancelCallback, context) {\n        var container = new EventRegistration_1.ValueEventRegistration(callback, cancelCallback || null, context || null);\n        this.repo.addEventCallbackForQuery(this, container);\n    };\n    /**\n     * @param {!Object.<string, !function(!DataSnapshot, ?string)>} callbacks\n     * @param {?function(Error)} cancelCallback\n     * @param {?Object} context\n     * @protected\n     */\n    Query.prototype.onChildEvent = function (callbacks, cancelCallback, context) {\n        var container = new EventRegistration_1.ChildEventRegistration(callbacks, cancelCallback, context);\n        this.repo.addEventCallbackForQuery(this, container);\n    };\n    /**\n     * @param {string=} eventType\n     * @param {(function(!DataSnapshot, ?string=))=} callback\n     * @param {Object=} context\n     */\n    Query.prototype.off = function (eventType, callback, context) {\n        util_3.validateArgCount('Query.off', 0, 3, arguments.length);\n        validation_1.validateEventType('Query.off', 1, eventType, true);\n        util_3.validateCallback('Query.off', 2, callback, true);\n        util_3.validateContextObject('Query.off', 3, context, true);\n        var container = null;\n        var callbacks = null;\n        if (eventType === 'value') {\n            var valueCallback = callback || null;\n            container = new EventRegistration_1.ValueEventRegistration(valueCallback, null, context || null);\n        }\n        else if (eventType) {\n            if (callback) {\n                callbacks = {};\n                callbacks[eventType] = callback;\n            }\n            container = new EventRegistration_1.ChildEventRegistration(callbacks, null, context || null);\n        }\n        this.repo.removeEventCallbackForQuery(this, container);\n    };\n    /**\n     * Attaches a listener, waits for the first event, and then removes the listener\n     * @param {!string} eventType\n     * @param {!function(!DataSnapshot, string=)} userCallback\n     * @param cancelOrContext\n     * @param context\n     * @return {!firebase.Promise}\n     */\n    Query.prototype.once = function (eventType, userCallback, cancelOrContext, context) {\n        var _this = this;\n        util_3.validateArgCount('Query.once', 1, 4, arguments.length);\n        validation_1.validateEventType('Query.once', 1, eventType, false);\n        util_3.validateCallback('Query.once', 2, userCallback, true);\n        var ret = Query.getCancelAndContextArgs_('Query.once', cancelOrContext, context);\n        // TODO: Implement this more efficiently (in particular, use 'get' wire protocol for 'value' event)\n        // TODO: consider actually wiring the callbacks into the promise. We cannot do this without a breaking change\n        // because the API currently expects callbacks will be called synchronously if the data is cached, but this is\n        // against the Promise specification.\n        var firstCall = true;\n        var deferred = new util_4.Deferred();\n        // A dummy error handler in case a user wasn't expecting promises\n        deferred.promise.catch(function () { });\n        var onceCallback = function (snapshot) {\n            // NOTE: Even though we unsubscribe, we may get called multiple times if a single action (e.g. set() with JSON)\n            // triggers multiple events (e.g. child_added or child_changed).\n            if (firstCall) {\n                firstCall = false;\n                _this.off(eventType, onceCallback);\n                if (userCallback) {\n                    userCallback.bind(ret.context)(snapshot);\n                }\n                deferred.resolve(snapshot);\n            }\n        };\n        this.on(eventType, onceCallback, \n        /*cancel=*/ function (err) {\n            _this.off(eventType, onceCallback);\n            if (ret.cancel)\n                ret.cancel.bind(ret.context)(err);\n            deferred.reject(err);\n        });\n        return deferred.promise;\n    };\n    /**\n     * Set a limit and anchor it to the start of the window.\n     * @param {!number} limit\n     * @return {!Query}\n     */\n    Query.prototype.limitToFirst = function (limit) {\n        util_3.validateArgCount('Query.limitToFirst', 1, 1, arguments.length);\n        if (typeof limit !== 'number' ||\n            Math.floor(limit) !== limit ||\n            limit <= 0) {\n            throw new Error('Query.limitToFirst: First argument must be a positive integer.');\n        }\n        if (this.queryParams_.hasLimit()) {\n            throw new Error('Query.limitToFirst: Limit was already set (by another call to limit, ' +\n                'limitToFirst, or limitToLast).');\n        }\n        return new Query(this.repo, this.path, this.queryParams_.limitToFirst(limit), this.orderByCalled_);\n    };\n    /**\n     * Set a limit and anchor it to the end of the window.\n     * @param {!number} limit\n     * @return {!Query}\n     */\n    Query.prototype.limitToLast = function (limit) {\n        util_3.validateArgCount('Query.limitToLast', 1, 1, arguments.length);\n        if (typeof limit !== 'number' ||\n            Math.floor(limit) !== limit ||\n            limit <= 0) {\n            throw new Error('Query.limitToLast: First argument must be a positive integer.');\n        }\n        if (this.queryParams_.hasLimit()) {\n            throw new Error('Query.limitToLast: Limit was already set (by another call to limit, ' +\n                'limitToFirst, or limitToLast).');\n        }\n        return new Query(this.repo, this.path, this.queryParams_.limitToLast(limit), this.orderByCalled_);\n    };\n    /**\n     * Given a child path, return a new query ordered by the specified grandchild path.\n     * @param {!string} path\n     * @return {!Query}\n     */\n    Query.prototype.orderByChild = function (path) {\n        util_3.validateArgCount('Query.orderByChild', 1, 1, arguments.length);\n        if (path === '$key') {\n            throw new Error('Query.orderByChild: \"$key\" is invalid.  Use Query.orderByKey() instead.');\n        }\n        else if (path === '$priority') {\n            throw new Error('Query.orderByChild: \"$priority\" is invalid.  Use Query.orderByPriority() instead.');\n        }\n        else if (path === '$value') {\n            throw new Error('Query.orderByChild: \"$value\" is invalid.  Use Query.orderByValue() instead.');\n        }\n        validation_1.validatePathString('Query.orderByChild', 1, path, false);\n        this.validateNoPreviousOrderByCall_('Query.orderByChild');\n        var parsedPath = new Path_1.Path(path);\n        if (parsedPath.isEmpty()) {\n            throw new Error('Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.');\n        }\n        var index = new PathIndex_1.PathIndex(parsedPath);\n        var newParams = this.queryParams_.orderBy(index);\n        Query.validateQueryEndpoints_(newParams);\n        return new Query(this.repo, this.path, newParams, /*orderByCalled=*/ true);\n    };\n    /**\n     * Return a new query ordered by the KeyIndex\n     * @return {!Query}\n     */\n    Query.prototype.orderByKey = function () {\n        util_3.validateArgCount('Query.orderByKey', 0, 0, arguments.length);\n        this.validateNoPreviousOrderByCall_('Query.orderByKey');\n        var newParams = this.queryParams_.orderBy(KeyIndex_1.KEY_INDEX);\n        Query.validateQueryEndpoints_(newParams);\n        return new Query(this.repo, this.path, newParams, /*orderByCalled=*/ true);\n    };\n    /**\n     * Return a new query ordered by the PriorityIndex\n     * @return {!Query}\n     */\n    Query.prototype.orderByPriority = function () {\n        util_3.validateArgCount('Query.orderByPriority', 0, 0, arguments.length);\n        this.validateNoPreviousOrderByCall_('Query.orderByPriority');\n        var newParams = this.queryParams_.orderBy(PriorityIndex_1.PRIORITY_INDEX);\n        Query.validateQueryEndpoints_(newParams);\n        return new Query(this.repo, this.path, newParams, /*orderByCalled=*/ true);\n    };\n    /**\n     * Return a new query ordered by the ValueIndex\n     * @return {!Query}\n     */\n    Query.prototype.orderByValue = function () {\n        util_3.validateArgCount('Query.orderByValue', 0, 0, arguments.length);\n        this.validateNoPreviousOrderByCall_('Query.orderByValue');\n        var newParams = this.queryParams_.orderBy(ValueIndex_1.VALUE_INDEX);\n        Query.validateQueryEndpoints_(newParams);\n        return new Query(this.repo, this.path, newParams, /*orderByCalled=*/ true);\n    };\n    /**\n     * @param {number|string|boolean|null} value\n     * @param {?string=} name\n     * @return {!Query}\n     */\n    Query.prototype.startAt = function (value, name) {\n        if (value === void 0) { value = null; }\n        util_3.validateArgCount('Query.startAt', 0, 2, arguments.length);\n        validation_1.validateFirebaseDataArg('Query.startAt', 1, value, this.path, true);\n        validation_1.validateKey('Query.startAt', 2, name, true);\n        var newParams = this.queryParams_.startAt(value, name);\n        Query.validateLimit_(newParams);\n        Query.validateQueryEndpoints_(newParams);\n        if (this.queryParams_.hasStart()) {\n            throw new Error('Query.startAt: Starting point was already set (by another call to startAt ' +\n                'or equalTo).');\n        }\n        // Calling with no params tells us to start at the beginning.\n        if (value === undefined) {\n            value = null;\n            name = null;\n        }\n        return new Query(this.repo, this.path, newParams, this.orderByCalled_);\n    };\n    /**\n     * @param {number|string|boolean|null} value\n     * @param {?string=} name\n     * @return {!Query}\n     */\n    Query.prototype.endAt = function (value, name) {\n        if (value === void 0) { value = null; }\n        util_3.validateArgCount('Query.endAt', 0, 2, arguments.length);\n        validation_1.validateFirebaseDataArg('Query.endAt', 1, value, this.path, true);\n        validation_1.validateKey('Query.endAt', 2, name, true);\n        var newParams = this.queryParams_.endAt(value, name);\n        Query.validateLimit_(newParams);\n        Query.validateQueryEndpoints_(newParams);\n        if (this.queryParams_.hasEnd()) {\n            throw new Error('Query.endAt: Ending point was already set (by another call to endAt or ' +\n                'equalTo).');\n        }\n        return new Query(this.repo, this.path, newParams, this.orderByCalled_);\n    };\n    /**\n     * Load the selection of children with exactly the specified value, and, optionally,\n     * the specified name.\n     * @param {number|string|boolean|null} value\n     * @param {string=} name\n     * @return {!Query}\n     */\n    Query.prototype.equalTo = function (value, name) {\n        util_3.validateArgCount('Query.equalTo', 1, 2, arguments.length);\n        validation_1.validateFirebaseDataArg('Query.equalTo', 1, value, this.path, false);\n        validation_1.validateKey('Query.equalTo', 2, name, true);\n        if (this.queryParams_.hasStart()) {\n            throw new Error('Query.equalTo: Starting point was already set (by another call to startAt or ' +\n                'equalTo).');\n        }\n        if (this.queryParams_.hasEnd()) {\n            throw new Error('Query.equalTo: Ending point was already set (by another call to endAt or ' +\n                'equalTo).');\n        }\n        return this.startAt(value, name).endAt(value, name);\n    };\n    /**\n     * @return {!string} URL for this location.\n     */\n    Query.prototype.toString = function () {\n        util_3.validateArgCount('Query.toString', 0, 0, arguments.length);\n        return this.repo.toString() + this.path.toUrlEncodedString();\n    };\n    // Do not create public documentation. This is intended to make JSON serialization work but is otherwise unnecessary\n    // for end-users.\n    Query.prototype.toJSON = function () {\n        // An optional spacer argument is unnecessary for a string.\n        util_3.validateArgCount('Query.toJSON', 0, 1, arguments.length);\n        return this.toString();\n    };\n    /**\n     * An object representation of the query parameters used by this Query.\n     * @return {!Object}\n     */\n    Query.prototype.queryObject = function () {\n        return this.queryParams_.getQueryObject();\n    };\n    /**\n     * @return {!string}\n     */\n    Query.prototype.queryIdentifier = function () {\n        var obj = this.queryObject();\n        var id = util_2.ObjectToUniqueKey(obj);\n        return id === '{}' ? 'default' : id;\n    };\n    /**\n     * Return true if this query and the provided query are equivalent; otherwise, return false.\n     * @param {Query} other\n     * @return {boolean}\n     */\n    Query.prototype.isEqual = function (other) {\n        util_3.validateArgCount('Query.isEqual', 1, 1, arguments.length);\n        if (!(other instanceof Query)) {\n            var error = 'Query.isEqual failed: First argument must be an instance of firebase.database.Query.';\n            throw new Error(error);\n        }\n        var sameRepo = this.repo === other.repo;\n        var samePath = this.path.equals(other.path);\n        var sameQueryIdentifier = this.queryIdentifier() === other.queryIdentifier();\n        return sameRepo && samePath && sameQueryIdentifier;\n    };\n    /**\n     * Helper used by .on and .once to extract the context and or cancel arguments.\n     * @param {!string} fnName The function name (on or once)\n     * @param {(function(Error)|Object)=} cancelOrContext\n     * @param {Object=} context\n     * @return {{cancel: ?function(Error), context: ?Object}}\n     * @private\n     */\n    Query.getCancelAndContextArgs_ = function (fnName, cancelOrContext, context) {\n        var ret = { cancel: null, context: null };\n        if (cancelOrContext && context) {\n            ret.cancel = cancelOrContext;\n            util_3.validateCallback(fnName, 3, ret.cancel, true);\n            ret.context = context;\n            util_3.validateContextObject(fnName, 4, ret.context, true);\n        }\n        else if (cancelOrContext) {\n            // we have either a cancel callback or a context.\n            if (typeof cancelOrContext === 'object' && cancelOrContext !== null) {\n                // it's a context!\n                ret.context = cancelOrContext;\n            }\n            else if (typeof cancelOrContext === 'function') {\n                ret.cancel = cancelOrContext;\n            }\n            else {\n                throw new Error(util_3.errorPrefix(fnName, 3, true) +\n                    ' must either be a cancel callback or a context object.');\n            }\n        }\n        return ret;\n    };\n    Object.defineProperty(Query.prototype, \"ref\", {\n        get: function () {\n            return this.getRef();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return Query;\n}());\nexports.Query = Query;\n\n\n\n},{\"../core/snap/indexes/KeyIndex\":39,\"../core/snap/indexes/PathIndex\":40,\"../core/snap/indexes/PriorityIndex\":41,\"../core/snap/indexes/ValueIndex\":42,\"../core/util/Path\":57,\"../core/util/util\":63,\"../core/util/validation\":64,\"../core/view/EventRegistration\":72,\"@firebase/util\":134}],8:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar onDisconnect_1 = require(\"./onDisconnect\");\nvar TransactionResult_1 = require(\"./TransactionResult\");\nvar util_1 = require(\"../core/util/util\");\nvar NextPushId_1 = require(\"../core/util/NextPushId\");\nvar Query_1 = require(\"./Query\");\nvar Repo_1 = require(\"../core/Repo\");\nvar Path_1 = require(\"../core/util/Path\");\nvar QueryParams_1 = require(\"../core/view/QueryParams\");\nvar validation_1 = require(\"../core/util/validation\");\nvar util_2 = require(\"@firebase/util\");\nvar util_3 = require(\"@firebase/util\");\nvar SyncPoint_1 = require(\"../core/SyncPoint\");\nvar Reference = /** @class */ (function (_super) {\n    __extends(Reference, _super);\n    /**\n     * Call options:\n     *   new Reference(Repo, Path) or\n     *   new Reference(url: string, string|RepoManager)\n     *\n     * Externally - this is the firebase.database.Reference type.\n     *\n     * @param {!Repo} repo\n     * @param {(!Path)} path\n     * @extends {Query}\n     */\n    function Reference(repo, path) {\n        var _this = this;\n        if (!(repo instanceof Repo_1.Repo)) {\n            throw new Error('new Reference() no longer supported - use app.database().');\n        }\n        // call Query's constructor, passing in the repo and path.\n        _this = _super.call(this, repo, path, QueryParams_1.QueryParams.DEFAULT, false) || this;\n        return _this;\n    }\n    /** @return {?string} */\n    Reference.prototype.getKey = function () {\n        util_2.validateArgCount('Reference.key', 0, 0, arguments.length);\n        if (this.path.isEmpty())\n            return null;\n        else\n            return this.path.getBack();\n    };\n    /**\n     * @param {!(string|Path)} pathString\n     * @return {!Reference}\n     */\n    Reference.prototype.child = function (pathString) {\n        util_2.validateArgCount('Reference.child', 1, 1, arguments.length);\n        if (typeof pathString === 'number') {\n            pathString = String(pathString);\n        }\n        else if (!(pathString instanceof Path_1.Path)) {\n            if (this.path.getFront() === null)\n                validation_1.validateRootPathString('Reference.child', 1, pathString, false);\n            else\n                validation_1.validatePathString('Reference.child', 1, pathString, false);\n        }\n        return new Reference(this.repo, this.path.child(pathString));\n    };\n    /** @return {?Reference} */\n    Reference.prototype.getParent = function () {\n        util_2.validateArgCount('Reference.parent', 0, 0, arguments.length);\n        var parentPath = this.path.parent();\n        return parentPath === null ? null : new Reference(this.repo, parentPath);\n    };\n    /** @return {!Reference} */\n    Reference.prototype.getRoot = function () {\n        util_2.validateArgCount('Reference.root', 0, 0, arguments.length);\n        var ref = this;\n        while (ref.getParent() !== null) {\n            ref = ref.getParent();\n        }\n        return ref;\n    };\n    /** @return {!Database} */\n    Reference.prototype.databaseProp = function () {\n        return this.repo.database;\n    };\n    /**\n     * @param {*} newVal\n     * @param {function(?Error)=} onComplete\n     * @return {!Promise}\n     */\n    Reference.prototype.set = function (newVal, onComplete) {\n        util_2.validateArgCount('Reference.set', 1, 2, arguments.length);\n        validation_1.validateWritablePath('Reference.set', this.path);\n        validation_1.validateFirebaseDataArg('Reference.set', 1, newVal, this.path, false);\n        util_2.validateCallback('Reference.set', 2, onComplete, true);\n        var deferred = new util_3.Deferred();\n        this.repo.setWithPriority(this.path, newVal, \n        /*priority=*/ null, deferred.wrapCallback(onComplete));\n        return deferred.promise;\n    };\n    /**\n     * @param {!Object} objectToMerge\n     * @param {function(?Error)=} onComplete\n     * @return {!Promise}\n     */\n    Reference.prototype.update = function (objectToMerge, onComplete) {\n        util_2.validateArgCount('Reference.update', 1, 2, arguments.length);\n        validation_1.validateWritablePath('Reference.update', this.path);\n        if (Array.isArray(objectToMerge)) {\n            var newObjectToMerge = {};\n            for (var i = 0; i < objectToMerge.length; ++i) {\n                newObjectToMerge['' + i] = objectToMerge[i];\n            }\n            objectToMerge = newObjectToMerge;\n            util_1.warn('Passing an Array to Firebase.update() is deprecated. ' +\n                'Use set() if you want to overwrite the existing data, or ' +\n                'an Object with integer keys if you really do want to ' +\n                'only update some of the children.');\n        }\n        validation_1.validateFirebaseMergeDataArg('Reference.update', 1, objectToMerge, this.path, false);\n        util_2.validateCallback('Reference.update', 2, onComplete, true);\n        var deferred = new util_3.Deferred();\n        this.repo.update(this.path, objectToMerge, deferred.wrapCallback(onComplete));\n        return deferred.promise;\n    };\n    /**\n     * @param {*} newVal\n     * @param {string|number|null} newPriority\n     * @param {function(?Error)=} onComplete\n     * @return {!Promise}\n     */\n    Reference.prototype.setWithPriority = function (newVal, newPriority, onComplete) {\n        util_2.validateArgCount('Reference.setWithPriority', 2, 3, arguments.length);\n        validation_1.validateWritablePath('Reference.setWithPriority', this.path);\n        validation_1.validateFirebaseDataArg('Reference.setWithPriority', 1, newVal, this.path, false);\n        validation_1.validatePriority('Reference.setWithPriority', 2, newPriority, false);\n        util_2.validateCallback('Reference.setWithPriority', 3, onComplete, true);\n        if (this.getKey() === '.length' || this.getKey() === '.keys')\n            throw 'Reference.setWithPriority failed: ' +\n                this.getKey() +\n                ' is a read-only object.';\n        var deferred = new util_3.Deferred();\n        this.repo.setWithPriority(this.path, newVal, newPriority, deferred.wrapCallback(onComplete));\n        return deferred.promise;\n    };\n    /**\n     * @param {function(?Error)=} onComplete\n     * @return {!Promise}\n     */\n    Reference.prototype.remove = function (onComplete) {\n        util_2.validateArgCount('Reference.remove', 0, 1, arguments.length);\n        validation_1.validateWritablePath('Reference.remove', this.path);\n        util_2.validateCallback('Reference.remove', 1, onComplete, true);\n        return this.set(null, onComplete);\n    };\n    /**\n     * @param {function(*):*} transactionUpdate\n     * @param {(function(?Error, boolean, ?DataSnapshot))=} onComplete\n     * @param {boolean=} applyLocally\n     * @return {!Promise}\n     */\n    Reference.prototype.transaction = function (transactionUpdate, onComplete, applyLocally) {\n        util_2.validateArgCount('Reference.transaction', 1, 3, arguments.length);\n        validation_1.validateWritablePath('Reference.transaction', this.path);\n        util_2.validateCallback('Reference.transaction', 1, transactionUpdate, false);\n        util_2.validateCallback('Reference.transaction', 2, onComplete, true);\n        // NOTE: applyLocally is an internal-only option for now.  We need to decide if we want to keep it and how\n        // to expose it.\n        validation_1.validateBoolean('Reference.transaction', 3, applyLocally, true);\n        if (this.getKey() === '.length' || this.getKey() === '.keys')\n            throw 'Reference.transaction failed: ' +\n                this.getKey() +\n                ' is a read-only object.';\n        if (applyLocally === undefined)\n            applyLocally = true;\n        var deferred = new util_3.Deferred();\n        if (typeof onComplete === 'function') {\n            deferred.promise.catch(function () { });\n        }\n        var promiseComplete = function (error, committed, snapshot) {\n            if (error) {\n                deferred.reject(error);\n            }\n            else {\n                deferred.resolve(new TransactionResult_1.TransactionResult(committed, snapshot));\n            }\n            if (typeof onComplete === 'function') {\n                onComplete(error, committed, snapshot);\n            }\n        };\n        this.repo.startTransaction(this.path, transactionUpdate, promiseComplete, applyLocally);\n        return deferred.promise;\n    };\n    /**\n     * @param {string|number|null} priority\n     * @param {function(?Error)=} onComplete\n     * @return {!Promise}\n     */\n    Reference.prototype.setPriority = function (priority, onComplete) {\n        util_2.validateArgCount('Reference.setPriority', 1, 2, arguments.length);\n        validation_1.validateWritablePath('Reference.setPriority', this.path);\n        validation_1.validatePriority('Reference.setPriority', 1, priority, false);\n        util_2.validateCallback('Reference.setPriority', 2, onComplete, true);\n        var deferred = new util_3.Deferred();\n        this.repo.setWithPriority(this.path.child('.priority'), priority, null, deferred.wrapCallback(onComplete));\n        return deferred.promise;\n    };\n    /**\n     * @param {*=} value\n     * @param {function(?Error)=} onComplete\n     * @return {!Reference}\n     */\n    Reference.prototype.push = function (value, onComplete) {\n        util_2.validateArgCount('Reference.push', 0, 2, arguments.length);\n        validation_1.validateWritablePath('Reference.push', this.path);\n        validation_1.validateFirebaseDataArg('Reference.push', 1, value, this.path, true);\n        util_2.validateCallback('Reference.push', 2, onComplete, true);\n        var now = this.repo.serverTime();\n        var name = NextPushId_1.nextPushId(now);\n        // push() returns a ThennableReference whose promise is fulfilled with a regular Reference.\n        // We use child() to create handles to two different references. The first is turned into a\n        // ThennableReference below by adding then() and catch() methods and is used as the\n        // return value of push(). The second remains a regular Reference and is used as the fulfilled\n        // value of the first ThennableReference.\n        var thennablePushRef = this.child(name);\n        var pushRef = this.child(name);\n        var promise;\n        if (value != null) {\n            promise = thennablePushRef.set(value, onComplete).then(function () { return pushRef; });\n        }\n        else {\n            promise = Promise.resolve(pushRef);\n        }\n        thennablePushRef.then = promise.then.bind(promise);\n        thennablePushRef.catch = promise.then.bind(promise, undefined);\n        if (typeof onComplete === 'function') {\n            promise.catch(function () { });\n        }\n        return thennablePushRef;\n    };\n    /**\n     * @return {!OnDisconnect}\n     */\n    Reference.prototype.onDisconnect = function () {\n        validation_1.validateWritablePath('Reference.onDisconnect', this.path);\n        return new onDisconnect_1.OnDisconnect(this.repo, this.path);\n    };\n    Object.defineProperty(Reference.prototype, \"database\", {\n        get: function () {\n            return this.databaseProp();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Reference.prototype, \"key\", {\n        get: function () {\n            return this.getKey();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Reference.prototype, \"parent\", {\n        get: function () {\n            return this.getParent();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Reference.prototype, \"root\", {\n        get: function () {\n            return this.getRoot();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return Reference;\n}(Query_1.Query));\nexports.Reference = Reference;\n/**\n * Define reference constructor in various modules\n *\n * We are doing this here to avoid several circular\n * dependency issues\n */\nQuery_1.Query.__referenceConstructor = Reference;\nSyncPoint_1.SyncPoint.__referenceConstructor = Reference;\n\n\n\n},{\"../core/Repo\":17,\"../core/SyncPoint\":24,\"../core/util/NextPushId\":55,\"../core/util/Path\":57,\"../core/util/util\":63,\"../core/util/validation\":64,\"../core/view/QueryParams\":73,\"./Query\":7,\"./TransactionResult\":9,\"./onDisconnect\":11,\"@firebase/util\":134}],9:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\nvar TransactionResult = /** @class */ (function () {\n    /**\n     * A type for the resolve value of Firebase.transaction.\n     * @constructor\n     * @dict\n     * @param {boolean} committed\n     * @param {DataSnapshot} snapshot\n     */\n    function TransactionResult(committed, snapshot) {\n        this.committed = committed;\n        this.snapshot = snapshot;\n    }\n    // Do not create public documentation. This is intended to make JSON serialization work but is otherwise unnecessary\n    // for end-users\n    TransactionResult.prototype.toJSON = function () {\n        util_1.validateArgCount('TransactionResult.toJSON', 0, 1, arguments.length);\n        return { committed: this.committed, snapshot: this.snapshot.toJSON() };\n    };\n    return TransactionResult;\n}());\nexports.TransactionResult = TransactionResult;\n\n\n\n},{\"@firebase/util\":134}],10:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar WebSocketConnection_1 = require(\"../realtime/WebSocketConnection\");\nvar BrowserPollConnection_1 = require(\"../realtime/BrowserPollConnection\");\n/**\n * INTERNAL methods for internal-use only (tests, etc.).\n *\n * Customers shouldn't use these or else should be aware that they could break at any time.\n *\n * @const\n */\nexports.forceLongPolling = function () {\n    WebSocketConnection_1.WebSocketConnection.forceDisallow();\n    BrowserPollConnection_1.BrowserPollConnection.forceAllow();\n};\nexports.forceWebSockets = function () {\n    BrowserPollConnection_1.BrowserPollConnection.forceDisallow();\n};\n/* Used by App Manager */\nexports.isWebSocketsAvailable = function () {\n    return WebSocketConnection_1.WebSocketConnection['isAvailable']();\n};\nexports.setSecurityDebugCallback = function (ref, callback) {\n    ref.repo.persistentConnection_.securityDebugCallback_ = callback;\n};\nexports.stats = function (ref, showDelta) {\n    ref.repo.stats(showDelta);\n};\nexports.statsIncrementCounter = function (ref, metric) {\n    ref.repo.statsIncrementCounter(metric);\n};\nexports.dataUpdateCount = function (ref) {\n    return ref.repo.dataUpdateCount;\n};\nexports.interceptServerData = function (ref, callback) {\n    return ref.repo.interceptServerData_(callback);\n};\n\n\n\n},{\"../realtime/BrowserPollConnection\":80,\"../realtime/WebSocketConnection\":84}],11:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\nvar validation_1 = require(\"../core/util/validation\");\nvar util_2 = require(\"../core/util/util\");\nvar util_3 = require(\"@firebase/util\");\n/**\n * @constructor\n */\nvar OnDisconnect = /** @class */ (function () {\n    /**\n     * @param {!Repo} repo_\n     * @param {!Path} path_\n     */\n    function OnDisconnect(repo_, path_) {\n        this.repo_ = repo_;\n        this.path_ = path_;\n    }\n    /**\n     * @param {function(?Error)=} onComplete\n     * @return {!firebase.Promise}\n     */\n    OnDisconnect.prototype.cancel = function (onComplete) {\n        util_1.validateArgCount('OnDisconnect.cancel', 0, 1, arguments.length);\n        util_1.validateCallback('OnDisconnect.cancel', 1, onComplete, true);\n        var deferred = new util_3.Deferred();\n        this.repo_.onDisconnectCancel(this.path_, deferred.wrapCallback(onComplete));\n        return deferred.promise;\n    };\n    /**\n     * @param {function(?Error)=} onComplete\n     * @return {!firebase.Promise}\n     */\n    OnDisconnect.prototype.remove = function (onComplete) {\n        util_1.validateArgCount('OnDisconnect.remove', 0, 1, arguments.length);\n        validation_1.validateWritablePath('OnDisconnect.remove', this.path_);\n        util_1.validateCallback('OnDisconnect.remove', 1, onComplete, true);\n        var deferred = new util_3.Deferred();\n        this.repo_.onDisconnectSet(this.path_, null, deferred.wrapCallback(onComplete));\n        return deferred.promise;\n    };\n    /**\n     * @param {*} value\n     * @param {function(?Error)=} onComplete\n     * @return {!firebase.Promise}\n     */\n    OnDisconnect.prototype.set = function (value, onComplete) {\n        util_1.validateArgCount('OnDisconnect.set', 1, 2, arguments.length);\n        validation_1.validateWritablePath('OnDisconnect.set', this.path_);\n        validation_1.validateFirebaseDataArg('OnDisconnect.set', 1, value, this.path_, false);\n        util_1.validateCallback('OnDisconnect.set', 2, onComplete, true);\n        var deferred = new util_3.Deferred();\n        this.repo_.onDisconnectSet(this.path_, value, deferred.wrapCallback(onComplete));\n        return deferred.promise;\n    };\n    /**\n     * @param {*} value\n     * @param {number|string|null} priority\n     * @param {function(?Error)=} onComplete\n     * @return {!firebase.Promise}\n     */\n    OnDisconnect.prototype.setWithPriority = function (value, priority, onComplete) {\n        util_1.validateArgCount('OnDisconnect.setWithPriority', 2, 3, arguments.length);\n        validation_1.validateWritablePath('OnDisconnect.setWithPriority', this.path_);\n        validation_1.validateFirebaseDataArg('OnDisconnect.setWithPriority', 1, value, this.path_, false);\n        validation_1.validatePriority('OnDisconnect.setWithPriority', 2, priority, false);\n        util_1.validateCallback('OnDisconnect.setWithPriority', 3, onComplete, true);\n        var deferred = new util_3.Deferred();\n        this.repo_.onDisconnectSetWithPriority(this.path_, value, priority, deferred.wrapCallback(onComplete));\n        return deferred.promise;\n    };\n    /**\n     * @param {!Object} objectToMerge\n     * @param {function(?Error)=} onComplete\n     * @return {!firebase.Promise}\n     */\n    OnDisconnect.prototype.update = function (objectToMerge, onComplete) {\n        util_1.validateArgCount('OnDisconnect.update', 1, 2, arguments.length);\n        validation_1.validateWritablePath('OnDisconnect.update', this.path_);\n        if (Array.isArray(objectToMerge)) {\n            var newObjectToMerge = {};\n            for (var i = 0; i < objectToMerge.length; ++i) {\n                newObjectToMerge['' + i] = objectToMerge[i];\n            }\n            objectToMerge = newObjectToMerge;\n            util_2.warn('Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the ' +\n                'existing data, or an Object with integer keys if you really do want to only update some of the children.');\n        }\n        validation_1.validateFirebaseMergeDataArg('OnDisconnect.update', 1, objectToMerge, this.path_, false);\n        util_1.validateCallback('OnDisconnect.update', 2, onComplete, true);\n        var deferred = new util_3.Deferred();\n        this.repo_.onDisconnectUpdate(this.path_, objectToMerge, deferred.wrapCallback(onComplete));\n        return deferred.promise;\n    };\n    return OnDisconnect;\n}());\nexports.OnDisconnect = OnDisconnect;\n\n\n\n},{\"../core/util/util\":63,\"../core/util/validation\":64,\"@firebase/util\":134}],12:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar RepoInfo_1 = require(\"../core/RepoInfo\");\nvar PersistentConnection_1 = require(\"../core/PersistentConnection\");\nvar RepoManager_1 = require(\"../core/RepoManager\");\nvar Connection_1 = require(\"../realtime/Connection\");\nexports.DataConnection = PersistentConnection_1.PersistentConnection;\n/**\n * @param {!string} pathString\n * @param {function(*)} onComplete\n */\nPersistentConnection_1.PersistentConnection.prototype.simpleListen = function (pathString, onComplete) {\n    this.sendRequest('q', { p: pathString }, onComplete);\n};\n/**\n * @param {*} data\n * @param {function(*)} onEcho\n */\nPersistentConnection_1.PersistentConnection.prototype.echo = function (data, onEcho) {\n    this.sendRequest('echo', { d: data }, onEcho);\n};\n// RealTimeConnection properties that we use in tests.\nexports.RealTimeConnection = Connection_1.Connection;\n/**\n * @param {function(): string} newHash\n * @return {function()}\n */\nexports.hijackHash = function (newHash) {\n    var oldPut = PersistentConnection_1.PersistentConnection.prototype.put;\n    PersistentConnection_1.PersistentConnection.prototype.put = function (pathString, data, opt_onComplete, opt_hash) {\n        if (opt_hash !== undefined) {\n            opt_hash = newHash();\n        }\n        oldPut.call(this, pathString, data, opt_onComplete, opt_hash);\n    };\n    return function () {\n        PersistentConnection_1.PersistentConnection.prototype.put = oldPut;\n    };\n};\n/**\n * @type {function(new:RepoInfo, !string, boolean, !string, boolean): undefined}\n */\nexports.ConnectionTarget = RepoInfo_1.RepoInfo;\n/**\n * @param {!Query} query\n * @return {!string}\n */\nexports.queryIdentifier = function (query) {\n    return query.queryIdentifier();\n};\n/**\n * @param {!Query} firebaseRef\n * @return {!Object}\n */\nexports.listens = function (firebaseRef) {\n    return firebaseRef.repo.persistentConnection_.listens_;\n};\n/**\n * Forces the RepoManager to create Repos that use ReadonlyRestClient instead of PersistentConnection.\n *\n * @param {boolean} forceRestClient\n */\nexports.forceRestClient = function (forceRestClient) {\n    RepoManager_1.RepoManager.getInstance().forceRestClient(forceRestClient);\n};\n\n\n\n},{\"../core/PersistentConnection\":15,\"../core/RepoInfo\":18,\"../core/RepoManager\":19,\"../realtime/Connection\":81}],13:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"./util/util\");\n/**\n * Abstraction around FirebaseApp's token fetching capabilities.\n */\nvar AuthTokenProvider = /** @class */ (function () {\n    /**\n     * @param {!FirebaseApp} app_\n     */\n    function AuthTokenProvider(app_) {\n        this.app_ = app_;\n    }\n    /**\n     * @param {boolean} forceRefresh\n     * @return {!Promise<FirebaseAuthTokenData>}\n     */\n    AuthTokenProvider.prototype.getToken = function (forceRefresh) {\n        return this.app_['INTERNAL']['getToken'](forceRefresh).then(null, \n        // .catch\n        function (error) {\n            // TODO: Need to figure out all the cases this is raised and whether\n            // this makes sense.\n            if (error && error.code === 'auth/token-not-initialized') {\n                util_1.log('Got auth/token-not-initialized error.  Treating as null token.');\n                return null;\n            }\n            else {\n                return Promise.reject(error);\n            }\n        });\n    };\n    AuthTokenProvider.prototype.addTokenChangeListener = function (listener) {\n        // TODO: We might want to wrap the listener and call it with no args to\n        // avoid a leaky abstraction, but that makes removing the listener harder.\n        this.app_['INTERNAL']['addAuthTokenListener'](listener);\n    };\n    AuthTokenProvider.prototype.removeTokenChangeListener = function (listener) {\n        this.app_['INTERNAL']['removeAuthTokenListener'](listener);\n    };\n    AuthTokenProvider.prototype.notifyForInvalidToken = function () {\n        var errorMessage = 'Provided authentication credentials for the app named \"' +\n            this.app_.name +\n            '\" are invalid. This usually indicates your app was not ' +\n            'initialized correctly. ';\n        if ('credential' in this.app_.options) {\n            errorMessage +=\n                'Make sure the \"credential\" property provided to initializeApp() ' +\n                    'is authorized to access the specified \"databaseURL\" and is from the correct ' +\n                    'project.';\n        }\n        else if ('serviceAccount' in this.app_.options) {\n            errorMessage +=\n                'Make sure the \"serviceAccount\" property provided to initializeApp() ' +\n                    'is authorized to access the specified \"databaseURL\" and is from the correct ' +\n                    'project.';\n        }\n        else {\n            errorMessage +=\n                'Make sure the \"apiKey\" and \"databaseURL\" properties provided to ' +\n                    'initializeApp() match the values provided for your app at ' +\n                    'https://console.firebase.google.com/.';\n        }\n        util_1.warn(errorMessage);\n    };\n    return AuthTokenProvider;\n}());\nexports.AuthTokenProvider = AuthTokenProvider;\n\n\n\n},{\"./util/util\":63}],14:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ImmutableTree_1 = require(\"./util/ImmutableTree\");\nvar Path_1 = require(\"./util/Path\");\nvar util_1 = require(\"@firebase/util\");\nvar Node_1 = require(\"./snap/Node\");\nvar PriorityIndex_1 = require(\"./snap/indexes/PriorityIndex\");\nvar util_2 = require(\"@firebase/util\");\n/**\n * This class holds a collection of writes that can be applied to nodes in unison. It abstracts away the logic with\n * dealing with priority writes and multiple nested writes. At any given path there is only allowed to be one write\n * modifying that path. Any write to an existing path or shadowing an existing path will modify that existing write\n * to reflect the write added.\n *\n * @constructor\n * @param {!ImmutableTree.<!Node>} writeTree\n */\nvar CompoundWrite = /** @class */ (function () {\n    function CompoundWrite(writeTree_) {\n        this.writeTree_ = writeTree_;\n    }\n    /**\n     * @param {!Path} path\n     * @param {!Node} node\n     * @return {!CompoundWrite}\n     */\n    CompoundWrite.prototype.addWrite = function (path, node) {\n        if (path.isEmpty()) {\n            return new CompoundWrite(new ImmutableTree_1.ImmutableTree(node));\n        }\n        else {\n            var rootmost = this.writeTree_.findRootMostValueAndPath(path);\n            if (rootmost != null) {\n                var rootMostPath = rootmost.path;\n                var value = rootmost.value;\n                var relativePath = Path_1.Path.relativePath(rootMostPath, path);\n                value = value.updateChild(relativePath, node);\n                return new CompoundWrite(this.writeTree_.set(rootMostPath, value));\n            }\n            else {\n                var subtree = new ImmutableTree_1.ImmutableTree(node);\n                var newWriteTree = this.writeTree_.setTree(path, subtree);\n                return new CompoundWrite(newWriteTree);\n            }\n        }\n    };\n    /**\n     * @param {!Path} path\n     * @param {!Object.<string, !Node>} updates\n     * @return {!CompoundWrite}\n     */\n    CompoundWrite.prototype.addWrites = function (path, updates) {\n        var newWrite = this;\n        util_1.forEach(updates, function (childKey, node) {\n            newWrite = newWrite.addWrite(path.child(childKey), node);\n        });\n        return newWrite;\n    };\n    /**\n     * Will remove a write at the given path and deeper paths. This will <em>not</em> modify a write at a higher\n     * location, which must be removed by calling this method with that path.\n     *\n     * @param {!Path} path The path at which a write and all deeper writes should be removed\n     * @return {!CompoundWrite} The new CompoundWrite with the removed path\n     */\n    CompoundWrite.prototype.removeWrite = function (path) {\n        if (path.isEmpty()) {\n            return CompoundWrite.Empty;\n        }\n        else {\n            var newWriteTree = this.writeTree_.setTree(path, ImmutableTree_1.ImmutableTree.Empty);\n            return new CompoundWrite(newWriteTree);\n        }\n    };\n    /**\n     * Returns whether this CompoundWrite will fully overwrite a node at a given location and can therefore be\n     * considered \"complete\".\n     *\n     * @param {!Path} path The path to check for\n     * @return {boolean} Whether there is a complete write at that path\n     */\n    CompoundWrite.prototype.hasCompleteWrite = function (path) {\n        return this.getCompleteNode(path) != null;\n    };\n    /**\n     * Returns a node for a path if and only if the node is a \"complete\" overwrite at that path. This will not aggregate\n     * writes from deeper paths, but will return child nodes from a more shallow path.\n     *\n     * @param {!Path} path The path to get a complete write\n     * @return {?Node} The node if complete at that path, or null otherwise.\n     */\n    CompoundWrite.prototype.getCompleteNode = function (path) {\n        var rootmost = this.writeTree_.findRootMostValueAndPath(path);\n        if (rootmost != null) {\n            return this.writeTree_\n                .get(rootmost.path)\n                .getChild(Path_1.Path.relativePath(rootmost.path, path));\n        }\n        else {\n            return null;\n        }\n    };\n    /**\n     * Returns all children that are guaranteed to be a complete overwrite.\n     *\n     * @return {!Array.<NamedNode>} A list of all complete children.\n     */\n    CompoundWrite.prototype.getCompleteChildren = function () {\n        var children = [];\n        var node = this.writeTree_.value;\n        if (node != null) {\n            // If it's a leaf node, it has no children; so nothing to do.\n            if (!node.isLeafNode()) {\n                node.forEachChild(PriorityIndex_1.PRIORITY_INDEX, function (childName, childNode) {\n                    children.push(new Node_1.NamedNode(childName, childNode));\n                });\n            }\n        }\n        else {\n            this.writeTree_.children.inorderTraversal(function (childName, childTree) {\n                if (childTree.value != null) {\n                    children.push(new Node_1.NamedNode(childName, childTree.value));\n                }\n            });\n        }\n        return children;\n    };\n    /**\n     * @param {!Path} path\n     * @return {!CompoundWrite}\n     */\n    CompoundWrite.prototype.childCompoundWrite = function (path) {\n        if (path.isEmpty()) {\n            return this;\n        }\n        else {\n            var shadowingNode = this.getCompleteNode(path);\n            if (shadowingNode != null) {\n                return new CompoundWrite(new ImmutableTree_1.ImmutableTree(shadowingNode));\n            }\n            else {\n                return new CompoundWrite(this.writeTree_.subtree(path));\n            }\n        }\n    };\n    /**\n     * Returns true if this CompoundWrite is empty and therefore does not modify any nodes.\n     * @return {boolean} Whether this CompoundWrite is empty\n     */\n    CompoundWrite.prototype.isEmpty = function () {\n        return this.writeTree_.isEmpty();\n    };\n    /**\n     * Applies this CompoundWrite to a node. The node is returned with all writes from this CompoundWrite applied to the\n     * node\n     * @param {!Node} node The node to apply this CompoundWrite to\n     * @return {!Node} The node with all writes applied\n     */\n    CompoundWrite.prototype.apply = function (node) {\n        return CompoundWrite.applySubtreeWrite_(Path_1.Path.Empty, this.writeTree_, node);\n    };\n    /**\n     * @type {!CompoundWrite}\n     */\n    CompoundWrite.Empty = new CompoundWrite(new ImmutableTree_1.ImmutableTree(null));\n    /**\n     * @param {!Path} relativePath\n     * @param {!ImmutableTree.<!Node>} writeTree\n     * @param {!Node} node\n     * @return {!Node}\n     * @private\n     */\n    CompoundWrite.applySubtreeWrite_ = function (relativePath, writeTree, node) {\n        if (writeTree.value != null) {\n            // Since there a write is always a leaf, we're done here\n            return node.updateChild(relativePath, writeTree.value);\n        }\n        else {\n            var priorityWrite_1 = null;\n            writeTree.children.inorderTraversal(function (childKey, childTree) {\n                if (childKey === '.priority') {\n                    // Apply priorities at the end so we don't update priorities for either empty nodes or forget\n                    // to apply priorities to empty nodes that are later filled\n                    util_2.assert(childTree.value !== null, 'Priority writes must always be leaf nodes');\n                    priorityWrite_1 = childTree.value;\n                }\n                else {\n                    node = CompoundWrite.applySubtreeWrite_(relativePath.child(childKey), childTree, node);\n                }\n            });\n            // If there was a priority write, we only apply it if the node is not empty\n            if (!node.getChild(relativePath).isEmpty() && priorityWrite_1 !== null) {\n                node = node.updateChild(relativePath.child('.priority'), priorityWrite_1);\n            }\n            return node;\n        }\n    };\n    return CompoundWrite;\n}());\nexports.CompoundWrite = CompoundWrite;\n\n\n\n},{\"./snap/Node\":35,\"./snap/indexes/PriorityIndex\":41,\"./util/ImmutableTree\":54,\"./util/Path\":57,\"@firebase/util\":134}],15:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar app_1 = require(\"@firebase/app\");\nvar util_1 = require(\"@firebase/util\");\nvar util_2 = require(\"@firebase/util\");\nvar util_3 = require(\"@firebase/util\");\nvar util_4 = require(\"./util/util\");\nvar Path_1 = require(\"./util/Path\");\nvar VisibilityMonitor_1 = require(\"./util/VisibilityMonitor\");\nvar OnlineMonitor_1 = require(\"./util/OnlineMonitor\");\nvar util_5 = require(\"@firebase/util\");\nvar Connection_1 = require(\"../realtime/Connection\");\nvar util_6 = require(\"@firebase/util\");\nvar util_7 = require(\"@firebase/util\");\nvar ServerActions_1 = require(\"./ServerActions\");\nvar RECONNECT_MIN_DELAY = 1000;\nvar RECONNECT_MAX_DELAY_DEFAULT = 60 * 5 * 1000; // 5 minutes in milliseconds (Case: 1858)\nvar RECONNECT_MAX_DELAY_FOR_ADMINS = 30 * 1000; // 30 seconds for admin clients (likely to be a backend server)\nvar RECONNECT_DELAY_MULTIPLIER = 1.3;\nvar RECONNECT_DELAY_RESET_TIMEOUT = 30000; // Reset delay back to MIN_DELAY after being connected for 30sec.\nvar SERVER_KILL_INTERRUPT_REASON = 'server_kill';\n// If auth fails repeatedly, we'll assume something is wrong and log a warning / back off.\nvar INVALID_AUTH_TOKEN_THRESHOLD = 3;\n/**\n * Firebase connection.  Abstracts wire protocol and handles reconnecting.\n *\n * NOTE: All JSON objects sent to the realtime connection must have property names enclosed\n * in quotes to make sure the closure compiler does not minify them.\n */\nvar PersistentConnection = /** @class */ (function (_super) {\n    __extends(PersistentConnection, _super);\n    /**\n     * @implements {ServerActions}\n     * @param {!RepoInfo} repoInfo_ Data about the namespace we are connecting to\n     * @param {function(string, *, boolean, ?number)} onDataUpdate_ A callback for new data from the server\n     * @param onConnectStatus_\n     * @param onServerInfoUpdate_\n     * @param authTokenProvider_\n     * @param authOverride_\n     */\n    function PersistentConnection(repoInfo_, onDataUpdate_, onConnectStatus_, onServerInfoUpdate_, authTokenProvider_, authOverride_) {\n        var _this = _super.call(this) || this;\n        _this.repoInfo_ = repoInfo_;\n        _this.onDataUpdate_ = onDataUpdate_;\n        _this.onConnectStatus_ = onConnectStatus_;\n        _this.onServerInfoUpdate_ = onServerInfoUpdate_;\n        _this.authTokenProvider_ = authTokenProvider_;\n        _this.authOverride_ = authOverride_;\n        // Used for diagnostic logging.\n        _this.id = PersistentConnection.nextPersistentConnectionId_++;\n        _this.log_ = util_4.logWrapper('p:' + _this.id + ':');\n        /** @private {Object} */\n        _this.interruptReasons_ = {};\n        _this.listens_ = {};\n        _this.outstandingPuts_ = [];\n        _this.outstandingPutCount_ = 0;\n        _this.onDisconnectRequestQueue_ = [];\n        _this.connected_ = false;\n        _this.reconnectDelay_ = RECONNECT_MIN_DELAY;\n        _this.maxReconnectDelay_ = RECONNECT_MAX_DELAY_DEFAULT;\n        _this.securityDebugCallback_ = null;\n        _this.lastSessionId = null;\n        /** @private {number|null} */\n        _this.establishConnectionTimer_ = null;\n        /** @private {boolean} */\n        _this.visible_ = false;\n        // Before we get connected, we keep a queue of pending messages to send.\n        _this.requestCBHash_ = {};\n        _this.requestNumber_ = 0;\n        /** @private {?{\n         *   sendRequest(Object),\n         *   close()\n         * }} */\n        _this.realtime_ = null;\n        /** @private {string|null} */\n        _this.authToken_ = null;\n        _this.forceTokenRefresh_ = false;\n        _this.invalidAuthTokenCount_ = 0;\n        _this.firstConnection_ = true;\n        _this.lastConnectionAttemptTime_ = null;\n        _this.lastConnectionEstablishedTime_ = null;\n        if (authOverride_ && !util_7.isNodeSdk()) {\n            throw new Error('Auth override specified in options, but not supported on non Node.js platforms');\n        }\n        _this.scheduleConnect_(0);\n        VisibilityMonitor_1.VisibilityMonitor.getInstance().on('visible', _this.onVisible_, _this);\n        if (repoInfo_.host.indexOf('fblocal') === -1) {\n            OnlineMonitor_1.OnlineMonitor.getInstance().on('online', _this.onOnline_, _this);\n        }\n        return _this;\n    }\n    /**\n     * @param {!string} action\n     * @param {*} body\n     * @param {function(*)=} onResponse\n     * @protected\n     */\n    PersistentConnection.prototype.sendRequest = function (action, body, onResponse) {\n        var curReqNum = ++this.requestNumber_;\n        var msg = { r: curReqNum, a: action, b: body };\n        this.log_(util_2.stringify(msg));\n        util_3.assert(this.connected_, \"sendRequest call when we're not connected not allowed.\");\n        this.realtime_.sendRequest(msg);\n        if (onResponse) {\n            this.requestCBHash_[curReqNum] = onResponse;\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    PersistentConnection.prototype.listen = function (query, currentHashFn, tag, onComplete) {\n        var queryId = query.queryIdentifier();\n        var pathString = query.path.toString();\n        this.log_('Listen called for ' + pathString + ' ' + queryId);\n        this.listens_[pathString] = this.listens_[pathString] || {};\n        util_3.assert(query.getQueryParams().isDefault() ||\n            !query.getQueryParams().loadsAllData(), 'listen() called for non-default but complete query');\n        util_3.assert(!this.listens_[pathString][queryId], 'listen() called twice for same path/queryId.');\n        var listenSpec = {\n            onComplete: onComplete,\n            hashFn: currentHashFn,\n            query: query,\n            tag: tag\n        };\n        this.listens_[pathString][queryId] = listenSpec;\n        if (this.connected_) {\n            this.sendListen_(listenSpec);\n        }\n    };\n    /**\n     * @param {!{onComplete(),\n     *           hashFn():!string,\n     *           query: !Query,\n     *           tag: ?number}} listenSpec\n     * @private\n     */\n    PersistentConnection.prototype.sendListen_ = function (listenSpec) {\n        var _this = this;\n        var query = listenSpec.query;\n        var pathString = query.path.toString();\n        var queryId = query.queryIdentifier();\n        this.log_('Listen on ' + pathString + ' for ' + queryId);\n        var req = { /*path*/ p: pathString };\n        var action = 'q';\n        // Only bother to send query if it's non-default.\n        if (listenSpec.tag) {\n            req['q'] = query.queryObject();\n            req['t'] = listenSpec.tag;\n        }\n        req['h'] = listenSpec.hashFn();\n        this.sendRequest(action, req, function (message) {\n            var payload = message['d'];\n            var status = message['s'];\n            // print warnings in any case...\n            PersistentConnection.warnOnListenWarnings_(payload, query);\n            var currentListenSpec = _this.listens_[pathString] && _this.listens_[pathString][queryId];\n            // only trigger actions if the listen hasn't been removed and readded\n            if (currentListenSpec === listenSpec) {\n                _this.log_('listen response', message);\n                if (status !== 'ok') {\n                    _this.removeListen_(pathString, queryId);\n                }\n                if (listenSpec.onComplete) {\n                    listenSpec.onComplete(status, payload);\n                }\n            }\n        });\n    };\n    /**\n     * @param {*} payload\n     * @param {!Query} query\n     * @private\n     */\n    PersistentConnection.warnOnListenWarnings_ = function (payload, query) {\n        if (payload && typeof payload === 'object' && util_1.contains(payload, 'w')) {\n            var warnings = util_1.safeGet(payload, 'w');\n            if (Array.isArray(warnings) && ~warnings.indexOf('no_index')) {\n                var indexSpec = '\".indexOn\": \"' +\n                    query\n                        .getQueryParams()\n                        .getIndex()\n                        .toString() +\n                    '\"';\n                var indexPath = query.path.toString();\n                util_4.warn(\"Using an unspecified index. Your data will be downloaded and \" +\n                    (\"filtered on the client. Consider adding \" + indexSpec + \" at \") +\n                    (indexPath + \" to your security rules for better performance.\"));\n            }\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    PersistentConnection.prototype.refreshAuthToken = function (token) {\n        this.authToken_ = token;\n        this.log_('Auth token refreshed');\n        if (this.authToken_) {\n            this.tryAuth();\n        }\n        else {\n            //If we're connected we want to let the server know to unauthenticate us. If we're not connected, simply delete\n            //the credential so we dont become authenticated next time we connect.\n            if (this.connected_) {\n                this.sendRequest('unauth', {}, function () { });\n            }\n        }\n        this.reduceReconnectDelayIfAdminCredential_(token);\n    };\n    /**\n     * @param {!string} credential\n     * @private\n     */\n    PersistentConnection.prototype.reduceReconnectDelayIfAdminCredential_ = function (credential) {\n        // NOTE: This isn't intended to be bulletproof (a malicious developer can always just modify the client).\n        // Additionally, we don't bother resetting the max delay back to the default if auth fails / expires.\n        var isFirebaseSecret = credential && credential.length === 40;\n        if (isFirebaseSecret || util_5.isAdmin(credential)) {\n            this.log_('Admin auth credential detected.  Reducing max reconnect time.');\n            this.maxReconnectDelay_ = RECONNECT_MAX_DELAY_FOR_ADMINS;\n        }\n    };\n    /**\n     * Attempts to authenticate with the given credentials. If the authentication attempt fails, it's triggered like\n     * a auth revoked (the connection is closed).\n     */\n    PersistentConnection.prototype.tryAuth = function () {\n        var _this = this;\n        if (this.connected_ && this.authToken_) {\n            var token_1 = this.authToken_;\n            var authMethod = util_5.isValidFormat(token_1) ? 'auth' : 'gauth';\n            var requestData = { cred: token_1 };\n            if (this.authOverride_ === null) {\n                requestData['noauth'] = true;\n            }\n            else if (typeof this.authOverride_ === 'object') {\n                requestData['authvar'] = this.authOverride_;\n            }\n            this.sendRequest(authMethod, requestData, function (res) {\n                var status = res['s'];\n                var data = res['d'] || 'error';\n                if (_this.authToken_ === token_1) {\n                    if (status === 'ok') {\n                        _this.invalidAuthTokenCount_ = 0;\n                    }\n                    else {\n                        // Triggers reconnect and force refresh for auth token\n                        _this.onAuthRevoked_(status, data);\n                    }\n                }\n            });\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    PersistentConnection.prototype.unlisten = function (query, tag) {\n        var pathString = query.path.toString();\n        var queryId = query.queryIdentifier();\n        this.log_('Unlisten called for ' + pathString + ' ' + queryId);\n        util_3.assert(query.getQueryParams().isDefault() ||\n            !query.getQueryParams().loadsAllData(), 'unlisten() called for non-default but complete query');\n        var listen = this.removeListen_(pathString, queryId);\n        if (listen && this.connected_) {\n            this.sendUnlisten_(pathString, queryId, query.queryObject(), tag);\n        }\n    };\n    PersistentConnection.prototype.sendUnlisten_ = function (pathString, queryId, queryObj, tag) {\n        this.log_('Unlisten on ' + pathString + ' for ' + queryId);\n        var req = { /*path*/ p: pathString };\n        var action = 'n';\n        // Only bother sending queryId if it's non-default.\n        if (tag) {\n            req['q'] = queryObj;\n            req['t'] = tag;\n        }\n        this.sendRequest(action, req);\n    };\n    /**\n     * @inheritDoc\n     */\n    PersistentConnection.prototype.onDisconnectPut = function (pathString, data, onComplete) {\n        if (this.connected_) {\n            this.sendOnDisconnect_('o', pathString, data, onComplete);\n        }\n        else {\n            this.onDisconnectRequestQueue_.push({\n                pathString: pathString,\n                action: 'o',\n                data: data,\n                onComplete: onComplete\n            });\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    PersistentConnection.prototype.onDisconnectMerge = function (pathString, data, onComplete) {\n        if (this.connected_) {\n            this.sendOnDisconnect_('om', pathString, data, onComplete);\n        }\n        else {\n            this.onDisconnectRequestQueue_.push({\n                pathString: pathString,\n                action: 'om',\n                data: data,\n                onComplete: onComplete\n            });\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    PersistentConnection.prototype.onDisconnectCancel = function (pathString, onComplete) {\n        if (this.connected_) {\n            this.sendOnDisconnect_('oc', pathString, null, onComplete);\n        }\n        else {\n            this.onDisconnectRequestQueue_.push({\n                pathString: pathString,\n                action: 'oc',\n                data: null,\n                onComplete: onComplete\n            });\n        }\n    };\n    PersistentConnection.prototype.sendOnDisconnect_ = function (action, pathString, data, onComplete) {\n        var request = { /*path*/ p: pathString, /*data*/ d: data };\n        this.log_('onDisconnect ' + action, request);\n        this.sendRequest(action, request, function (response) {\n            if (onComplete) {\n                setTimeout(function () {\n                    onComplete(response['s'], response['d']);\n                }, Math.floor(0));\n            }\n        });\n    };\n    /**\n     * @inheritDoc\n     */\n    PersistentConnection.prototype.put = function (pathString, data, onComplete, hash) {\n        this.putInternal('p', pathString, data, onComplete, hash);\n    };\n    /**\n     * @inheritDoc\n     */\n    PersistentConnection.prototype.merge = function (pathString, data, onComplete, hash) {\n        this.putInternal('m', pathString, data, onComplete, hash);\n    };\n    PersistentConnection.prototype.putInternal = function (action, pathString, data, onComplete, hash) {\n        var request = {\n            /*path*/ p: pathString,\n            /*data*/ d: data\n        };\n        if (hash !== undefined)\n            request['h'] = hash;\n        // TODO: Only keep track of the most recent put for a given path?\n        this.outstandingPuts_.push({\n            action: action,\n            request: request,\n            onComplete: onComplete\n        });\n        this.outstandingPutCount_++;\n        var index = this.outstandingPuts_.length - 1;\n        if (this.connected_) {\n            this.sendPut_(index);\n        }\n        else {\n            this.log_('Buffering put: ' + pathString);\n        }\n    };\n    PersistentConnection.prototype.sendPut_ = function (index) {\n        var _this = this;\n        var action = this.outstandingPuts_[index].action;\n        var request = this.outstandingPuts_[index].request;\n        var onComplete = this.outstandingPuts_[index].onComplete;\n        this.outstandingPuts_[index].queued = this.connected_;\n        this.sendRequest(action, request, function (message) {\n            _this.log_(action + ' response', message);\n            delete _this.outstandingPuts_[index];\n            _this.outstandingPutCount_--;\n            // Clean up array occasionally.\n            if (_this.outstandingPutCount_ === 0) {\n                _this.outstandingPuts_ = [];\n            }\n            if (onComplete)\n                onComplete(message['s'], message['d']);\n        });\n    };\n    /**\n     * @inheritDoc\n     */\n    PersistentConnection.prototype.reportStats = function (stats) {\n        var _this = this;\n        // If we're not connected, we just drop the stats.\n        if (this.connected_) {\n            var request = { /*counters*/ c: stats };\n            this.log_('reportStats', request);\n            this.sendRequest(/*stats*/ 's', request, function (result) {\n                var status = result['s'];\n                if (status !== 'ok') {\n                    var errorReason = result['d'];\n                    _this.log_('reportStats', 'Error sending stats: ' + errorReason);\n                }\n            });\n        }\n    };\n    /**\n     * @param {*} message\n     * @private\n     */\n    PersistentConnection.prototype.onDataMessage_ = function (message) {\n        if ('r' in message) {\n            // this is a response\n            this.log_('from server: ' + util_2.stringify(message));\n            var reqNum = message['r'];\n            var onResponse = this.requestCBHash_[reqNum];\n            if (onResponse) {\n                delete this.requestCBHash_[reqNum];\n                onResponse(message['b']);\n            }\n        }\n        else if ('error' in message) {\n            throw 'A server-side error has occurred: ' + message['error'];\n        }\n        else if ('a' in message) {\n            // a and b are action and body, respectively\n            this.onDataPush_(message['a'], message['b']);\n        }\n    };\n    PersistentConnection.prototype.onDataPush_ = function (action, body) {\n        this.log_('handleServerMessage', action, body);\n        if (action === 'd')\n            this.onDataUpdate_(body['p'], body['d'], \n            /*isMerge*/ false, body['t']);\n        else if (action === 'm')\n            this.onDataUpdate_(body['p'], body['d'], \n            /*isMerge=*/ true, body['t']);\n        else if (action === 'c')\n            this.onListenRevoked_(body['p'], body['q']);\n        else if (action === 'ac')\n            this.onAuthRevoked_(body['s'], body['d']);\n        else if (action === 'sd')\n            this.onSecurityDebugPacket_(body);\n        else\n            util_4.error('Unrecognized action received from server: ' +\n                util_2.stringify(action) +\n                '\\nAre you using the latest client?');\n    };\n    PersistentConnection.prototype.onReady_ = function (timestamp, sessionId) {\n        this.log_('connection ready');\n        this.connected_ = true;\n        this.lastConnectionEstablishedTime_ = new Date().getTime();\n        this.handleTimestamp_(timestamp);\n        this.lastSessionId = sessionId;\n        if (this.firstConnection_) {\n            this.sendConnectStats_();\n        }\n        this.restoreState_();\n        this.firstConnection_ = false;\n        this.onConnectStatus_(true);\n    };\n    PersistentConnection.prototype.scheduleConnect_ = function (timeout) {\n        var _this = this;\n        util_3.assert(!this.realtime_, \"Scheduling a connect when we're already connected/ing?\");\n        if (this.establishConnectionTimer_) {\n            clearTimeout(this.establishConnectionTimer_);\n        }\n        // NOTE: Even when timeout is 0, it's important to do a setTimeout to work around an infuriating \"Security Error\" in\n        // Firefox when trying to write to our long-polling iframe in some scenarios (e.g. Forge or our unit tests).\n        this.establishConnectionTimer_ = setTimeout(function () {\n            _this.establishConnectionTimer_ = null;\n            _this.establishConnection_();\n        }, Math.floor(timeout));\n    };\n    /**\n     * @param {boolean} visible\n     * @private\n     */\n    PersistentConnection.prototype.onVisible_ = function (visible) {\n        // NOTE: Tabbing away and back to a window will defeat our reconnect backoff, but I think that's fine.\n        if (visible &&\n            !this.visible_ &&\n            this.reconnectDelay_ === this.maxReconnectDelay_) {\n            this.log_('Window became visible.  Reducing delay.');\n            this.reconnectDelay_ = RECONNECT_MIN_DELAY;\n            if (!this.realtime_) {\n                this.scheduleConnect_(0);\n            }\n        }\n        this.visible_ = visible;\n    };\n    PersistentConnection.prototype.onOnline_ = function (online) {\n        if (online) {\n            this.log_('Browser went online.');\n            this.reconnectDelay_ = RECONNECT_MIN_DELAY;\n            if (!this.realtime_) {\n                this.scheduleConnect_(0);\n            }\n        }\n        else {\n            this.log_('Browser went offline.  Killing connection.');\n            if (this.realtime_) {\n                this.realtime_.close();\n            }\n        }\n    };\n    PersistentConnection.prototype.onRealtimeDisconnect_ = function () {\n        this.log_('data client disconnected');\n        this.connected_ = false;\n        this.realtime_ = null;\n        // Since we don't know if our sent transactions succeeded or not, we need to cancel them.\n        this.cancelSentTransactions_();\n        // Clear out the pending requests.\n        this.requestCBHash_ = {};\n        if (this.shouldReconnect_()) {\n            if (!this.visible_) {\n                this.log_(\"Window isn't visible.  Delaying reconnect.\");\n                this.reconnectDelay_ = this.maxReconnectDelay_;\n                this.lastConnectionAttemptTime_ = new Date().getTime();\n            }\n            else if (this.lastConnectionEstablishedTime_) {\n                // If we've been connected long enough, reset reconnect delay to minimum.\n                var timeSinceLastConnectSucceeded = new Date().getTime() - this.lastConnectionEstablishedTime_;\n                if (timeSinceLastConnectSucceeded > RECONNECT_DELAY_RESET_TIMEOUT)\n                    this.reconnectDelay_ = RECONNECT_MIN_DELAY;\n                this.lastConnectionEstablishedTime_ = null;\n            }\n            var timeSinceLastConnectAttempt = new Date().getTime() - this.lastConnectionAttemptTime_;\n            var reconnectDelay = Math.max(0, this.reconnectDelay_ - timeSinceLastConnectAttempt);\n            reconnectDelay = Math.random() * reconnectDelay;\n            this.log_('Trying to reconnect in ' + reconnectDelay + 'ms');\n            this.scheduleConnect_(reconnectDelay);\n            // Adjust reconnect delay for next time.\n            this.reconnectDelay_ = Math.min(this.maxReconnectDelay_, this.reconnectDelay_ * RECONNECT_DELAY_MULTIPLIER);\n        }\n        this.onConnectStatus_(false);\n    };\n    PersistentConnection.prototype.establishConnection_ = function () {\n        if (this.shouldReconnect_()) {\n            this.log_('Making a connection attempt');\n            this.lastConnectionAttemptTime_ = new Date().getTime();\n            this.lastConnectionEstablishedTime_ = null;\n            var onDataMessage_1 = this.onDataMessage_.bind(this);\n            var onReady_1 = this.onReady_.bind(this);\n            var onDisconnect_1 = this.onRealtimeDisconnect_.bind(this);\n            var connId_1 = this.id + ':' + PersistentConnection.nextConnectionId_++;\n            var self_1 = this;\n            var lastSessionId_1 = this.lastSessionId;\n            var canceled_1 = false;\n            var connection_1 = null;\n            var closeFn_1 = function () {\n                if (connection_1) {\n                    connection_1.close();\n                }\n                else {\n                    canceled_1 = true;\n                    onDisconnect_1();\n                }\n            };\n            var sendRequestFn = function (msg) {\n                util_3.assert(connection_1, \"sendRequest call when we're not connected not allowed.\");\n                connection_1.sendRequest(msg);\n            };\n            this.realtime_ = {\n                close: closeFn_1,\n                sendRequest: sendRequestFn\n            };\n            var forceRefresh = this.forceTokenRefresh_;\n            this.forceTokenRefresh_ = false;\n            // First fetch auth token, and establish connection after fetching the token was successful\n            this.authTokenProvider_\n                .getToken(forceRefresh)\n                .then(function (result) {\n                if (!canceled_1) {\n                    util_4.log('getToken() completed. Creating connection.');\n                    self_1.authToken_ = result && result.accessToken;\n                    connection_1 = new Connection_1.Connection(connId_1, self_1.repoInfo_, onDataMessage_1, onReady_1, onDisconnect_1, \n                    /* onKill= */ function (reason) {\n                        util_4.warn(reason + ' (' + self_1.repoInfo_.toString() + ')');\n                        self_1.interrupt(SERVER_KILL_INTERRUPT_REASON);\n                    }, lastSessionId_1);\n                }\n                else {\n                    util_4.log('getToken() completed but was canceled');\n                }\n            })\n                .then(null, function (error) {\n                self_1.log_('Failed to get token: ' + error);\n                if (!canceled_1) {\n                    if (util_6.CONSTANTS.NODE_ADMIN) {\n                        // This may be a critical error for the Admin Node.js SDK, so log a warning.\n                        // But getToken() may also just have temporarily failed, so we still want to\n                        // continue retrying.\n                        util_4.warn(error);\n                    }\n                    closeFn_1();\n                }\n            });\n        }\n    };\n    /**\n     * @param {string} reason\n     */\n    PersistentConnection.prototype.interrupt = function (reason) {\n        util_4.log('Interrupting connection for reason: ' + reason);\n        this.interruptReasons_[reason] = true;\n        if (this.realtime_) {\n            this.realtime_.close();\n        }\n        else {\n            if (this.establishConnectionTimer_) {\n                clearTimeout(this.establishConnectionTimer_);\n                this.establishConnectionTimer_ = null;\n            }\n            if (this.connected_) {\n                this.onRealtimeDisconnect_();\n            }\n        }\n    };\n    /**\n     * @param {string} reason\n     */\n    PersistentConnection.prototype.resume = function (reason) {\n        util_4.log('Resuming connection for reason: ' + reason);\n        delete this.interruptReasons_[reason];\n        if (util_1.isEmpty(this.interruptReasons_)) {\n            this.reconnectDelay_ = RECONNECT_MIN_DELAY;\n            if (!this.realtime_) {\n                this.scheduleConnect_(0);\n            }\n        }\n    };\n    PersistentConnection.prototype.handleTimestamp_ = function (timestamp) {\n        var delta = timestamp - new Date().getTime();\n        this.onServerInfoUpdate_({ serverTimeOffset: delta });\n    };\n    PersistentConnection.prototype.cancelSentTransactions_ = function () {\n        for (var i = 0; i < this.outstandingPuts_.length; i++) {\n            var put = this.outstandingPuts_[i];\n            if (put && /*hash*/ 'h' in put.request && put.queued) {\n                if (put.onComplete)\n                    put.onComplete('disconnect');\n                delete this.outstandingPuts_[i];\n                this.outstandingPutCount_--;\n            }\n        }\n        // Clean up array occasionally.\n        if (this.outstandingPutCount_ === 0)\n            this.outstandingPuts_ = [];\n    };\n    /**\n     * @param {!string} pathString\n     * @param {Array.<*>=} query\n     * @private\n     */\n    PersistentConnection.prototype.onListenRevoked_ = function (pathString, query) {\n        // Remove the listen and manufacture a \"permission_denied\" error for the failed listen.\n        var queryId;\n        if (!query) {\n            queryId = 'default';\n        }\n        else {\n            queryId = query.map(function (q) { return util_4.ObjectToUniqueKey(q); }).join('$');\n        }\n        var listen = this.removeListen_(pathString, queryId);\n        if (listen && listen.onComplete)\n            listen.onComplete('permission_denied');\n    };\n    /**\n     * @param {!string} pathString\n     * @param {!string} queryId\n     * @return {{queries:Array.<Query>, onComplete:function(string)}}\n     * @private\n     */\n    PersistentConnection.prototype.removeListen_ = function (pathString, queryId) {\n        var normalizedPathString = new Path_1.Path(pathString).toString(); // normalize path.\n        var listen;\n        if (this.listens_[normalizedPathString] !== undefined) {\n            listen = this.listens_[normalizedPathString][queryId];\n            delete this.listens_[normalizedPathString][queryId];\n            if (util_1.getCount(this.listens_[normalizedPathString]) === 0) {\n                delete this.listens_[normalizedPathString];\n            }\n        }\n        else {\n            // all listens for this path has already been removed\n            listen = undefined;\n        }\n        return listen;\n    };\n    PersistentConnection.prototype.onAuthRevoked_ = function (statusCode, explanation) {\n        util_4.log('Auth token revoked: ' + statusCode + '/' + explanation);\n        this.authToken_ = null;\n        this.forceTokenRefresh_ = true;\n        this.realtime_.close();\n        if (statusCode === 'invalid_token' || statusCode === 'permission_denied') {\n            // We'll wait a couple times before logging the warning / increasing the\n            // retry period since oauth tokens will report as \"invalid\" if they're\n            // just expired. Plus there may be transient issues that resolve themselves.\n            this.invalidAuthTokenCount_++;\n            if (this.invalidAuthTokenCount_ >= INVALID_AUTH_TOKEN_THRESHOLD) {\n                // Set a long reconnect delay because recovery is unlikely\n                this.reconnectDelay_ = RECONNECT_MAX_DELAY_FOR_ADMINS;\n                // Notify the auth token provider that the token is invalid, which will log\n                // a warning\n                this.authTokenProvider_.notifyForInvalidToken();\n            }\n        }\n    };\n    PersistentConnection.prototype.onSecurityDebugPacket_ = function (body) {\n        if (this.securityDebugCallback_) {\n            this.securityDebugCallback_(body);\n        }\n        else {\n            if ('msg' in body && typeof console !== 'undefined') {\n                console.log('FIREBASE: ' + body['msg'].replace('\\n', '\\nFIREBASE: '));\n            }\n        }\n    };\n    PersistentConnection.prototype.restoreState_ = function () {\n        var _this = this;\n        //Re-authenticate ourselves if we have a credential stored.\n        this.tryAuth();\n        // Puts depend on having received the corresponding data update from the server before they complete, so we must\n        // make sure to send listens before puts.\n        util_1.forEach(this.listens_, function (pathString, queries) {\n            util_1.forEach(queries, function (key, listenSpec) {\n                _this.sendListen_(listenSpec);\n            });\n        });\n        for (var i = 0; i < this.outstandingPuts_.length; i++) {\n            if (this.outstandingPuts_[i])\n                this.sendPut_(i);\n        }\n        while (this.onDisconnectRequestQueue_.length) {\n            var request = this.onDisconnectRequestQueue_.shift();\n            this.sendOnDisconnect_(request.action, request.pathString, request.data, request.onComplete);\n        }\n    };\n    /**\n     * Sends client stats for first connection\n     * @private\n     */\n    PersistentConnection.prototype.sendConnectStats_ = function () {\n        var stats = {};\n        var clientName = 'js';\n        if (util_6.CONSTANTS.NODE_ADMIN) {\n            clientName = 'admin_node';\n        }\n        else if (util_6.CONSTANTS.NODE_CLIENT) {\n            clientName = 'node';\n        }\n        stats['sdk.' + clientName + '.' + app_1.default.SDK_VERSION.replace(/\\./g, '-')] = 1;\n        if (util_7.isMobileCordova()) {\n            stats['framework.cordova'] = 1;\n        }\n        else if (util_7.isReactNative()) {\n            stats['framework.reactnative'] = 1;\n        }\n        this.reportStats(stats);\n    };\n    /**\n     * @return {boolean}\n     * @private\n     */\n    PersistentConnection.prototype.shouldReconnect_ = function () {\n        var online = OnlineMonitor_1.OnlineMonitor.getInstance().currentlyOnline();\n        return util_1.isEmpty(this.interruptReasons_) && online;\n    };\n    /**\n     * @private\n     */\n    PersistentConnection.nextPersistentConnectionId_ = 0;\n    /**\n     * Counter for number of connections created. Mainly used for tagging in the logs\n     * @type {number}\n     * @private\n     */\n    PersistentConnection.nextConnectionId_ = 0;\n    return PersistentConnection;\n}(ServerActions_1.ServerActions));\nexports.PersistentConnection = PersistentConnection;\n\n\n\n},{\"../realtime/Connection\":81,\"./ServerActions\":21,\"./util/OnlineMonitor\":56,\"./util/Path\":57,\"./util/VisibilityMonitor\":61,\"./util/util\":63,\"@firebase/app\":1,\"@firebase/util\":134}],16:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\nvar util_2 = require(\"./util/util\");\nvar util_3 = require(\"@firebase/util\");\nvar util_4 = require(\"@firebase/util\");\nvar util_5 = require(\"@firebase/util\");\nvar ServerActions_1 = require(\"./ServerActions\");\n/**\n * An implementation of ServerActions that communicates with the server via REST requests.\n * This is mostly useful for compatibility with crawlers, where we don't want to spin up a full\n * persistent connection (using WebSockets or long-polling)\n */\nvar ReadonlyRestClient = /** @class */ (function (_super) {\n    __extends(ReadonlyRestClient, _super);\n    /**\n     * @param {!RepoInfo} repoInfo_ Data about the namespace we are connecting to\n     * @param {function(string, *, boolean, ?number)} onDataUpdate_ A callback for new data from the server\n     * @param {AuthTokenProvider} authTokenProvider_\n     * @implements {ServerActions}\n     */\n    function ReadonlyRestClient(repoInfo_, onDataUpdate_, authTokenProvider_) {\n        var _this = _super.call(this) || this;\n        _this.repoInfo_ = repoInfo_;\n        _this.onDataUpdate_ = onDataUpdate_;\n        _this.authTokenProvider_ = authTokenProvider_;\n        /** @private {function(...[*])} */\n        _this.log_ = util_2.logWrapper('p:rest:');\n        /**\n         * We don't actually need to track listens, except to prevent us calling an onComplete for a listen\n         * that's been removed. :-/\n         *\n         * @private {!Object.<string, !Object>}\n         */\n        _this.listens_ = {};\n        return _this;\n    }\n    ReadonlyRestClient.prototype.reportStats = function (stats) {\n        throw new Error('Method not implemented.');\n    };\n    /**\n     * @param {!Query} query\n     * @param {?number=} tag\n     * @return {string}\n     * @private\n     */\n    ReadonlyRestClient.getListenId_ = function (query, tag) {\n        if (tag !== undefined) {\n            return 'tag$' + tag;\n        }\n        else {\n            util_1.assert(query.getQueryParams().isDefault(), \"should have a tag if it's not a default query.\");\n            return query.path.toString();\n        }\n    };\n    /** @inheritDoc */\n    ReadonlyRestClient.prototype.listen = function (query, currentHashFn, tag, onComplete) {\n        var _this = this;\n        var pathString = query.path.toString();\n        this.log_('Listen called for ' + pathString + ' ' + query.queryIdentifier());\n        // Mark this listener so we can tell if it's removed.\n        var listenId = ReadonlyRestClient.getListenId_(query, tag);\n        var thisListen = {};\n        this.listens_[listenId] = thisListen;\n        var queryStringParamaters = query\n            .getQueryParams()\n            .toRestQueryStringParameters();\n        this.restRequest_(pathString + '.json', queryStringParamaters, function (error, result) {\n            var data = result;\n            if (error === 404) {\n                data = null;\n                error = null;\n            }\n            if (error === null) {\n                _this.onDataUpdate_(pathString, data, /*isMerge=*/ false, tag);\n            }\n            if (util_4.safeGet(_this.listens_, listenId) === thisListen) {\n                var status_1;\n                if (!error) {\n                    status_1 = 'ok';\n                }\n                else if (error == 401) {\n                    status_1 = 'permission_denied';\n                }\n                else {\n                    status_1 = 'rest_error:' + error;\n                }\n                onComplete(status_1, null);\n            }\n        });\n    };\n    /** @inheritDoc */\n    ReadonlyRestClient.prototype.unlisten = function (query, tag) {\n        var listenId = ReadonlyRestClient.getListenId_(query, tag);\n        delete this.listens_[listenId];\n    };\n    /** @inheritDoc */\n    ReadonlyRestClient.prototype.refreshAuthToken = function (token) {\n        // no-op since we just always call getToken.\n    };\n    /**\n     * Performs a REST request to the given path, with the provided query string parameters,\n     * and any auth credentials we have.\n     *\n     * @param {!string} pathString\n     * @param {!Object.<string, *>} queryStringParameters\n     * @param {?function(?number, *=)} callback\n     * @private\n     */\n    ReadonlyRestClient.prototype.restRequest_ = function (pathString, queryStringParameters, callback) {\n        var _this = this;\n        if (queryStringParameters === void 0) { queryStringParameters = {}; }\n        queryStringParameters['format'] = 'export';\n        this.authTokenProvider_\n            .getToken(/*forceRefresh=*/ false)\n            .then(function (authTokenData) {\n            var authToken = authTokenData && authTokenData.accessToken;\n            if (authToken) {\n                queryStringParameters['auth'] = authToken;\n            }\n            var url = (_this.repoInfo_.secure ? 'https://' : 'http://') +\n                _this.repoInfo_.host +\n                pathString +\n                '?' +\n                util_5.querystring(queryStringParameters);\n            _this.log_('Sending REST request for ' + url);\n            var xhr = new XMLHttpRequest();\n            xhr.onreadystatechange = function () {\n                if (callback && xhr.readyState === 4) {\n                    _this.log_('REST Response for ' + url + ' received. status:', xhr.status, 'response:', xhr.responseText);\n                    var res = null;\n                    if (xhr.status >= 200 && xhr.status < 300) {\n                        try {\n                            res = util_3.jsonEval(xhr.responseText);\n                        }\n                        catch (e) {\n                            util_2.warn('Failed to parse JSON response for ' +\n                                url +\n                                ': ' +\n                                xhr.responseText);\n                        }\n                        callback(null, res);\n                    }\n                    else {\n                        // 401 and 404 are expected.\n                        if (xhr.status !== 401 && xhr.status !== 404) {\n                            util_2.warn('Got unsuccessful REST response for ' +\n                                url +\n                                ' Status: ' +\n                                xhr.status);\n                        }\n                        callback(xhr.status);\n                    }\n                    callback = null;\n                }\n            };\n            xhr.open('GET', url, /*asynchronous=*/ true);\n            xhr.send();\n        });\n    };\n    return ReadonlyRestClient;\n}(ServerActions_1.ServerActions));\nexports.ReadonlyRestClient = ReadonlyRestClient;\n\n\n\n},{\"./ServerActions\":21,\"./util/util\":63,\"@firebase/util\":134}],17:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ServerValues_1 = require(\"./util/ServerValues\");\nvar nodeFromJSON_1 = require(\"./snap/nodeFromJSON\");\nvar Path_1 = require(\"./util/Path\");\nvar SparseSnapshotTree_1 = require(\"./SparseSnapshotTree\");\nvar SyncTree_1 = require(\"./SyncTree\");\nvar SnapshotHolder_1 = require(\"./SnapshotHolder\");\nvar util_1 = require(\"@firebase/util\");\nvar util_2 = require(\"./util/util\");\nvar util_3 = require(\"@firebase/util\");\nvar AuthTokenProvider_1 = require(\"./AuthTokenProvider\");\nvar StatsManager_1 = require(\"./stats/StatsManager\");\nvar StatsReporter_1 = require(\"./stats/StatsReporter\");\nvar StatsListener_1 = require(\"./stats/StatsListener\");\nvar EventQueue_1 = require(\"./view/EventQueue\");\nvar PersistentConnection_1 = require(\"./PersistentConnection\");\nvar ReadonlyRestClient_1 = require(\"./ReadonlyRestClient\");\nvar Database_1 = require(\"../api/Database\");\nvar INTERRUPT_REASON = 'repo_interrupt';\n/**\n * A connection to a single data repository.\n */\nvar Repo = /** @class */ (function () {\n    /**\n     * @param {!RepoInfo} repoInfo_\n     * @param {boolean} forceRestClient\n     * @param {!FirebaseApp} app\n     */\n    function Repo(repoInfo_, forceRestClient, app) {\n        var _this = this;\n        this.repoInfo_ = repoInfo_;\n        this.app = app;\n        this.dataUpdateCount = 0;\n        this.statsListener_ = null;\n        this.eventQueue_ = new EventQueue_1.EventQueue();\n        this.nextWriteId_ = 1;\n        this.interceptServerDataCallback_ = null;\n        // A list of data pieces and paths to be set when this client disconnects.\n        this.onDisconnect_ = new SparseSnapshotTree_1.SparseSnapshotTree();\n        /**\n         * TODO: This should be @private but it's used by test_access.js and internal.js\n         * @type {?PersistentConnection}\n         */\n        this.persistentConnection_ = null;\n        /** @type {!AuthTokenProvider} */\n        var authTokenProvider = new AuthTokenProvider_1.AuthTokenProvider(app);\n        this.stats_ = StatsManager_1.StatsManager.getCollection(repoInfo_);\n        if (forceRestClient || util_2.beingCrawled()) {\n            this.server_ = new ReadonlyRestClient_1.ReadonlyRestClient(this.repoInfo_, this.onDataUpdate_.bind(this), authTokenProvider);\n            // Minor hack: Fire onConnect immediately, since there's no actual connection.\n            setTimeout(this.onConnectStatus_.bind(this, true), 0);\n        }\n        else {\n            var authOverride = app.options['databaseAuthVariableOverride'];\n            // Validate authOverride\n            if (typeof authOverride !== 'undefined' && authOverride !== null) {\n                if (typeof authOverride !== 'object') {\n                    throw new Error('Only objects are supported for option databaseAuthVariableOverride');\n                }\n                try {\n                    util_1.stringify(authOverride);\n                }\n                catch (e) {\n                    throw new Error('Invalid authOverride provided: ' + e);\n                }\n            }\n            this.persistentConnection_ = new PersistentConnection_1.PersistentConnection(this.repoInfo_, this.onDataUpdate_.bind(this), this.onConnectStatus_.bind(this), this.onServerInfoUpdate_.bind(this), authTokenProvider, authOverride);\n            this.server_ = this.persistentConnection_;\n        }\n        authTokenProvider.addTokenChangeListener(function (token) {\n            _this.server_.refreshAuthToken(token);\n        });\n        // In the case of multiple Repos for the same repoInfo (i.e. there are multiple Firebase.Contexts being used),\n        // we only want to create one StatsReporter.  As such, we'll report stats over the first Repo created.\n        this.statsReporter_ = StatsManager_1.StatsManager.getOrCreateReporter(repoInfo_, function () { return new StatsReporter_1.StatsReporter(_this.stats_, _this.server_); });\n        this.transactions_init_();\n        // Used for .info.\n        this.infoData_ = new SnapshotHolder_1.SnapshotHolder();\n        this.infoSyncTree_ = new SyncTree_1.SyncTree({\n            startListening: function (query, tag, currentHashFn, onComplete) {\n                var infoEvents = [];\n                var node = _this.infoData_.getNode(query.path);\n                // This is possibly a hack, but we have different semantics for .info endpoints. We don't raise null events\n                // on initial data...\n                if (!node.isEmpty()) {\n                    infoEvents = _this.infoSyncTree_.applyServerOverwrite(query.path, node);\n                    setTimeout(function () {\n                        onComplete('ok');\n                    }, 0);\n                }\n                return infoEvents;\n            },\n            stopListening: function () { }\n        });\n        this.updateInfo_('connected', false);\n        this.serverSyncTree_ = new SyncTree_1.SyncTree({\n            startListening: function (query, tag, currentHashFn, onComplete) {\n                _this.server_.listen(query, currentHashFn, tag, function (status, data) {\n                    var events = onComplete(status, data);\n                    _this.eventQueue_.raiseEventsForChangedPath(query.path, events);\n                });\n                // No synchronous events for network-backed sync trees\n                return [];\n            },\n            stopListening: function (query, tag) {\n                _this.server_.unlisten(query, tag);\n            }\n        });\n    }\n    /**\n     * @return {string}  The URL corresponding to the root of this Firebase.\n     */\n    Repo.prototype.toString = function () {\n        return ((this.repoInfo_.secure ? 'https://' : 'http://') + this.repoInfo_.host);\n    };\n    /**\n     * @return {!string} The namespace represented by the repo.\n     */\n    Repo.prototype.name = function () {\n        return this.repoInfo_.namespace;\n    };\n    /**\n     * @return {!number} The time in milliseconds, taking the server offset into account if we have one.\n     */\n    Repo.prototype.serverTime = function () {\n        var offsetNode = this.infoData_.getNode(new Path_1.Path('.info/serverTimeOffset'));\n        var offset = offsetNode.val() || 0;\n        return new Date().getTime() + offset;\n    };\n    /**\n     * Generate ServerValues using some variables from the repo object.\n     * @return {!Object}\n     */\n    Repo.prototype.generateServerValues = function () {\n        return ServerValues_1.generateWithValues({\n            timestamp: this.serverTime()\n        });\n    };\n    /**\n     * Called by realtime when we get new messages from the server.\n     *\n     * @private\n     * @param {string} pathString\n     * @param {*} data\n     * @param {boolean} isMerge\n     * @param {?number} tag\n     */\n    Repo.prototype.onDataUpdate_ = function (pathString, data, isMerge, tag) {\n        // For testing.\n        this.dataUpdateCount++;\n        var path = new Path_1.Path(pathString);\n        data = this.interceptServerDataCallback_\n            ? this.interceptServerDataCallback_(pathString, data)\n            : data;\n        var events = [];\n        if (tag) {\n            if (isMerge) {\n                var taggedChildren = util_3.map(data, function (raw) {\n                    return nodeFromJSON_1.nodeFromJSON(raw);\n                });\n                events = this.serverSyncTree_.applyTaggedQueryMerge(path, taggedChildren, tag);\n            }\n            else {\n                var taggedSnap = nodeFromJSON_1.nodeFromJSON(data);\n                events = this.serverSyncTree_.applyTaggedQueryOverwrite(path, taggedSnap, tag);\n            }\n        }\n        else if (isMerge) {\n            var changedChildren = util_3.map(data, function (raw) {\n                return nodeFromJSON_1.nodeFromJSON(raw);\n            });\n            events = this.serverSyncTree_.applyServerMerge(path, changedChildren);\n        }\n        else {\n            var snap = nodeFromJSON_1.nodeFromJSON(data);\n            events = this.serverSyncTree_.applyServerOverwrite(path, snap);\n        }\n        var affectedPath = path;\n        if (events.length > 0) {\n            // Since we have a listener outstanding for each transaction, receiving any events\n            // is a proxy for some change having occurred.\n            affectedPath = this.rerunTransactions_(path);\n        }\n        this.eventQueue_.raiseEventsForChangedPath(affectedPath, events);\n    };\n    /**\n     * TODO: This should be @private but it's used by test_access.js and internal.js\n     * @param {?function(!string, *):*} callback\n     * @private\n     */\n    Repo.prototype.interceptServerData_ = function (callback) {\n        this.interceptServerDataCallback_ = callback;\n    };\n    /**\n     * @param {!boolean} connectStatus\n     * @private\n     */\n    Repo.prototype.onConnectStatus_ = function (connectStatus) {\n        this.updateInfo_('connected', connectStatus);\n        if (connectStatus === false) {\n            this.runOnDisconnectEvents_();\n        }\n    };\n    /**\n     * @param {!Object} updates\n     * @private\n     */\n    Repo.prototype.onServerInfoUpdate_ = function (updates) {\n        var _this = this;\n        util_2.each(updates, function (value, key) {\n            _this.updateInfo_(key, value);\n        });\n    };\n    /**\n     *\n     * @param {!string} pathString\n     * @param {*} value\n     * @private\n     */\n    Repo.prototype.updateInfo_ = function (pathString, value) {\n        var path = new Path_1.Path('/.info/' + pathString);\n        var newNode = nodeFromJSON_1.nodeFromJSON(value);\n        this.infoData_.updateSnapshot(path, newNode);\n        var events = this.infoSyncTree_.applyServerOverwrite(path, newNode);\n        this.eventQueue_.raiseEventsForChangedPath(path, events);\n    };\n    /**\n     * @return {!number}\n     * @private\n     */\n    Repo.prototype.getNextWriteId_ = function () {\n        return this.nextWriteId_++;\n    };\n    /**\n     * @param {!Path} path\n     * @param {*} newVal\n     * @param {number|string|null} newPriority\n     * @param {?function(?Error, *=)} onComplete\n     */\n    Repo.prototype.setWithPriority = function (path, newVal, newPriority, onComplete) {\n        var _this = this;\n        this.log_('set', {\n            path: path.toString(),\n            value: newVal,\n            priority: newPriority\n        });\n        // TODO: Optimize this behavior to either (a) store flag to skip resolving where possible and / or\n        // (b) store unresolved paths on JSON parse\n        var serverValues = this.generateServerValues();\n        var newNodeUnresolved = nodeFromJSON_1.nodeFromJSON(newVal, newPriority);\n        var newNode = ServerValues_1.resolveDeferredValueSnapshot(newNodeUnresolved, serverValues);\n        var writeId = this.getNextWriteId_();\n        var events = this.serverSyncTree_.applyUserOverwrite(path, newNode, writeId, true);\n        this.eventQueue_.queueEvents(events);\n        this.server_.put(path.toString(), newNodeUnresolved.val(/*export=*/ true), function (status, errorReason) {\n            var success = status === 'ok';\n            if (!success) {\n                util_2.warn('set at ' + path + ' failed: ' + status);\n            }\n            var clearEvents = _this.serverSyncTree_.ackUserWrite(writeId, !success);\n            _this.eventQueue_.raiseEventsForChangedPath(path, clearEvents);\n            _this.callOnCompleteCallback(onComplete, status, errorReason);\n        });\n        var affectedPath = this.abortTransactions_(path);\n        this.rerunTransactions_(affectedPath);\n        // We queued the events above, so just flush the queue here\n        this.eventQueue_.raiseEventsForChangedPath(affectedPath, []);\n    };\n    /**\n     * @param {!Path} path\n     * @param {!Object} childrenToMerge\n     * @param {?function(?Error, *=)} onComplete\n     */\n    Repo.prototype.update = function (path, childrenToMerge, onComplete) {\n        var _this = this;\n        this.log_('update', { path: path.toString(), value: childrenToMerge });\n        // Start with our existing data and merge each child into it.\n        var empty = true;\n        var serverValues = this.generateServerValues();\n        var changedChildren = {};\n        util_3.forEach(childrenToMerge, function (changedKey, changedValue) {\n            empty = false;\n            var newNodeUnresolved = nodeFromJSON_1.nodeFromJSON(changedValue);\n            changedChildren[changedKey] = ServerValues_1.resolveDeferredValueSnapshot(newNodeUnresolved, serverValues);\n        });\n        if (!empty) {\n            var writeId_1 = this.getNextWriteId_();\n            var events = this.serverSyncTree_.applyUserMerge(path, changedChildren, writeId_1);\n            this.eventQueue_.queueEvents(events);\n            this.server_.merge(path.toString(), childrenToMerge, function (status, errorReason) {\n                var success = status === 'ok';\n                if (!success) {\n                    util_2.warn('update at ' + path + ' failed: ' + status);\n                }\n                var clearEvents = _this.serverSyncTree_.ackUserWrite(writeId_1, !success);\n                var affectedPath = clearEvents.length > 0 ? _this.rerunTransactions_(path) : path;\n                _this.eventQueue_.raiseEventsForChangedPath(affectedPath, clearEvents);\n                _this.callOnCompleteCallback(onComplete, status, errorReason);\n            });\n            util_3.forEach(childrenToMerge, function (changedPath) {\n                var affectedPath = _this.abortTransactions_(path.child(changedPath));\n                _this.rerunTransactions_(affectedPath);\n            });\n            // We queued the events above, so just flush the queue here\n            this.eventQueue_.raiseEventsForChangedPath(path, []);\n        }\n        else {\n            util_2.log(\"update() called with empty data.  Don't do anything.\");\n            this.callOnCompleteCallback(onComplete, 'ok');\n        }\n    };\n    /**\n     * Applies all of the changes stored up in the onDisconnect_ tree.\n     * @private\n     */\n    Repo.prototype.runOnDisconnectEvents_ = function () {\n        var _this = this;\n        this.log_('onDisconnectEvents');\n        var serverValues = this.generateServerValues();\n        var resolvedOnDisconnectTree = ServerValues_1.resolveDeferredValueTree(this.onDisconnect_, serverValues);\n        var events = [];\n        resolvedOnDisconnectTree.forEachTree(Path_1.Path.Empty, function (path, snap) {\n            events = events.concat(_this.serverSyncTree_.applyServerOverwrite(path, snap));\n            var affectedPath = _this.abortTransactions_(path);\n            _this.rerunTransactions_(affectedPath);\n        });\n        this.onDisconnect_ = new SparseSnapshotTree_1.SparseSnapshotTree();\n        this.eventQueue_.raiseEventsForChangedPath(Path_1.Path.Empty, events);\n    };\n    /**\n     * @param {!Path} path\n     * @param {?function(?Error, *=)} onComplete\n     */\n    Repo.prototype.onDisconnectCancel = function (path, onComplete) {\n        var _this = this;\n        this.server_.onDisconnectCancel(path.toString(), function (status, errorReason) {\n            if (status === 'ok') {\n                _this.onDisconnect_.forget(path);\n            }\n            _this.callOnCompleteCallback(onComplete, status, errorReason);\n        });\n    };\n    /**\n     * @param {!Path} path\n     * @param {*} value\n     * @param {?function(?Error, *=)} onComplete\n     */\n    Repo.prototype.onDisconnectSet = function (path, value, onComplete) {\n        var _this = this;\n        var newNode = nodeFromJSON_1.nodeFromJSON(value);\n        this.server_.onDisconnectPut(path.toString(), newNode.val(/*export=*/ true), function (status, errorReason) {\n            if (status === 'ok') {\n                _this.onDisconnect_.remember(path, newNode);\n            }\n            _this.callOnCompleteCallback(onComplete, status, errorReason);\n        });\n    };\n    /**\n     * @param {!Path} path\n     * @param {*} value\n     * @param {*} priority\n     * @param {?function(?Error, *=)} onComplete\n     */\n    Repo.prototype.onDisconnectSetWithPriority = function (path, value, priority, onComplete) {\n        var _this = this;\n        var newNode = nodeFromJSON_1.nodeFromJSON(value, priority);\n        this.server_.onDisconnectPut(path.toString(), newNode.val(/*export=*/ true), function (status, errorReason) {\n            if (status === 'ok') {\n                _this.onDisconnect_.remember(path, newNode);\n            }\n            _this.callOnCompleteCallback(onComplete, status, errorReason);\n        });\n    };\n    /**\n     * @param {!Path} path\n     * @param {*} childrenToMerge\n     * @param {?function(?Error, *=)} onComplete\n     */\n    Repo.prototype.onDisconnectUpdate = function (path, childrenToMerge, onComplete) {\n        var _this = this;\n        if (util_3.isEmpty(childrenToMerge)) {\n            util_2.log(\"onDisconnect().update() called with empty data.  Don't do anything.\");\n            this.callOnCompleteCallback(onComplete, 'ok');\n            return;\n        }\n        this.server_.onDisconnectMerge(path.toString(), childrenToMerge, function (status, errorReason) {\n            if (status === 'ok') {\n                util_3.forEach(childrenToMerge, function (childName, childNode) {\n                    var newChildNode = nodeFromJSON_1.nodeFromJSON(childNode);\n                    _this.onDisconnect_.remember(path.child(childName), newChildNode);\n                });\n            }\n            _this.callOnCompleteCallback(onComplete, status, errorReason);\n        });\n    };\n    /**\n     * @param {!Query} query\n     * @param {!EventRegistration} eventRegistration\n     */\n    Repo.prototype.addEventCallbackForQuery = function (query, eventRegistration) {\n        var events;\n        if (query.path.getFront() === '.info') {\n            events = this.infoSyncTree_.addEventRegistration(query, eventRegistration);\n        }\n        else {\n            events = this.serverSyncTree_.addEventRegistration(query, eventRegistration);\n        }\n        this.eventQueue_.raiseEventsAtPath(query.path, events);\n    };\n    /**\n     * @param {!Query} query\n     * @param {?EventRegistration} eventRegistration\n     */\n    Repo.prototype.removeEventCallbackForQuery = function (query, eventRegistration) {\n        // These are guaranteed not to raise events, since we're not passing in a cancelError. However, we can future-proof\n        // a little bit by handling the return values anyways.\n        var events;\n        if (query.path.getFront() === '.info') {\n            events = this.infoSyncTree_.removeEventRegistration(query, eventRegistration);\n        }\n        else {\n            events = this.serverSyncTree_.removeEventRegistration(query, eventRegistration);\n        }\n        this.eventQueue_.raiseEventsAtPath(query.path, events);\n    };\n    Repo.prototype.interrupt = function () {\n        if (this.persistentConnection_) {\n            this.persistentConnection_.interrupt(INTERRUPT_REASON);\n        }\n    };\n    Repo.prototype.resume = function () {\n        if (this.persistentConnection_) {\n            this.persistentConnection_.resume(INTERRUPT_REASON);\n        }\n    };\n    Repo.prototype.stats = function (showDelta) {\n        if (showDelta === void 0) { showDelta = false; }\n        if (typeof console === 'undefined')\n            return;\n        var stats;\n        if (showDelta) {\n            if (!this.statsListener_)\n                this.statsListener_ = new StatsListener_1.StatsListener(this.stats_);\n            stats = this.statsListener_.get();\n        }\n        else {\n            stats = this.stats_.get();\n        }\n        var longestName = Object.keys(stats).reduce(function (previousValue, currentValue) {\n            return Math.max(currentValue.length, previousValue);\n        }, 0);\n        util_3.forEach(stats, function (stat, value) {\n            // pad stat names to be the same length (plus 2 extra spaces).\n            for (var i = stat.length; i < longestName + 2; i++)\n                stat += ' ';\n            console.log(stat + value);\n        });\n    };\n    Repo.prototype.statsIncrementCounter = function (metric) {\n        this.stats_.incrementCounter(metric);\n        this.statsReporter_.includeStat(metric);\n    };\n    /**\n     * @param {...*} var_args\n     * @private\n     */\n    Repo.prototype.log_ = function () {\n        var var_args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            var_args[_i] = arguments[_i];\n        }\n        var prefix = '';\n        if (this.persistentConnection_) {\n            prefix = this.persistentConnection_.id + ':';\n        }\n        util_2.log.apply(void 0, [prefix].concat(var_args));\n    };\n    /**\n     * @param {?function(?Error, *=)} callback\n     * @param {!string} status\n     * @param {?string=} errorReason\n     */\n    Repo.prototype.callOnCompleteCallback = function (callback, status, errorReason) {\n        if (callback) {\n            util_2.exceptionGuard(function () {\n                if (status == 'ok') {\n                    callback(null);\n                }\n                else {\n                    var code = (status || 'error').toUpperCase();\n                    var message = code;\n                    if (errorReason)\n                        message += ': ' + errorReason;\n                    var error = new Error(message);\n                    error.code = code;\n                    callback(error);\n                }\n            });\n        }\n    };\n    Object.defineProperty(Repo.prototype, \"database\", {\n        get: function () {\n            return this.__database || (this.__database = new Database_1.Database(this));\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return Repo;\n}());\nexports.Repo = Repo;\n\n\n\n},{\"../api/Database\":6,\"./AuthTokenProvider\":13,\"./PersistentConnection\":15,\"./ReadonlyRestClient\":16,\"./SnapshotHolder\":22,\"./SparseSnapshotTree\":23,\"./SyncTree\":25,\"./snap/nodeFromJSON\":43,\"./stats/StatsListener\":46,\"./stats/StatsManager\":47,\"./stats/StatsReporter\":48,\"./util/Path\":57,\"./util/ServerValues\":58,\"./util/util\":63,\"./view/EventQueue\":71,\"@firebase/util\":134}],18:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\nvar util_2 = require(\"@firebase/util\");\nvar storage_1 = require(\"./storage/storage\");\nvar Constants_1 = require(\"../realtime/Constants\");\n/**\n * A class that holds metadata about a Repo object\n *\n * @constructor\n */\nvar RepoInfo = /** @class */ (function () {\n    /**\n     * @param {string} host Hostname portion of the url for the repo\n     * @param {boolean} secure Whether or not this repo is accessed over ssl\n     * @param {string} namespace The namespace represented by the repo\n     * @param {boolean} webSocketOnly Whether to prefer websockets over all other transports (used by Nest).\n     * @param {string=} persistenceKey Override the default session persistence storage key\n     */\n    function RepoInfo(host, secure, namespace, webSocketOnly, persistenceKey) {\n        if (persistenceKey === void 0) { persistenceKey = ''; }\n        this.secure = secure;\n        this.namespace = namespace;\n        this.webSocketOnly = webSocketOnly;\n        this.persistenceKey = persistenceKey;\n        this.host = host.toLowerCase();\n        this.domain = this.host.substr(this.host.indexOf('.') + 1);\n        this.internalHost = storage_1.PersistentStorage.get('host:' + host) || this.host;\n    }\n    RepoInfo.prototype.needsQueryParam = function () {\n        return this.host !== this.internalHost;\n    };\n    RepoInfo.prototype.isCacheableHost = function () {\n        return this.internalHost.substr(0, 2) === 's-';\n    };\n    RepoInfo.prototype.isDemoHost = function () {\n        return this.domain === 'firebaseio-demo.com';\n    };\n    RepoInfo.prototype.isCustomHost = function () {\n        return (this.domain !== 'firebaseio.com' && this.domain !== 'firebaseio-demo.com');\n    };\n    RepoInfo.prototype.updateHost = function (newHost) {\n        if (newHost !== this.internalHost) {\n            this.internalHost = newHost;\n            if (this.isCacheableHost()) {\n                storage_1.PersistentStorage.set('host:' + this.host, this.internalHost);\n            }\n        }\n    };\n    /**\n     * Returns the websocket URL for this repo\n     * @param {string} type of connection\n     * @param {Object} params list\n     * @return {string} The URL for this repo\n     */\n    RepoInfo.prototype.connectionURL = function (type, params) {\n        util_1.assert(typeof type === 'string', 'typeof type must == string');\n        util_1.assert(typeof params === 'object', 'typeof params must == object');\n        var connURL;\n        if (type === Constants_1.WEBSOCKET) {\n            connURL =\n                (this.secure ? 'wss://' : 'ws://') + this.internalHost + '/.ws?';\n        }\n        else if (type === Constants_1.LONG_POLLING) {\n            connURL =\n                (this.secure ? 'https://' : 'http://') + this.internalHost + '/.lp?';\n        }\n        else {\n            throw new Error('Unknown connection type: ' + type);\n        }\n        if (this.needsQueryParam()) {\n            params['ns'] = this.namespace;\n        }\n        var pairs = [];\n        util_2.forEach(params, function (key, value) {\n            pairs.push(key + '=' + value);\n        });\n        return connURL + pairs.join('&');\n    };\n    /** @return {string} */\n    RepoInfo.prototype.toString = function () {\n        var str = this.toURLString();\n        if (this.persistenceKey) {\n            str += '<' + this.persistenceKey + '>';\n        }\n        return str;\n    };\n    /** @return {string} */\n    RepoInfo.prototype.toURLString = function () {\n        return (this.secure ? 'https://' : 'http://') + this.host;\n    };\n    return RepoInfo;\n}());\nexports.RepoInfo = RepoInfo;\n\n\n\n},{\"../realtime/Constants\":82,\"./storage/storage\":51,\"@firebase/util\":134}],19:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\nvar Repo_1 = require(\"./Repo\");\nvar util_2 = require(\"./util/util\");\nvar parser_1 = require(\"./util/libs/parser\");\nvar validation_1 = require(\"./util/validation\");\nrequire(\"./Repo_transaction\");\n/** @const {string} */\nvar DATABASE_URL_OPTION = 'databaseURL';\nvar _staticInstance;\n/**\n * Creates and caches Repo instances.\n */\nvar RepoManager = /** @class */ (function () {\n    function RepoManager() {\n        /**\n         * @private {!Object.<string, Object<string, !fb.core.Repo>>}\n         */\n        this.repos_ = {};\n        /**\n         * If true, new Repos will be created to use ReadonlyRestClient (for testing purposes).\n         * @private {boolean}\n         */\n        this.useRestClient_ = false;\n    }\n    RepoManager.getInstance = function () {\n        if (!_staticInstance) {\n            _staticInstance = new RepoManager();\n        }\n        return _staticInstance;\n    };\n    // TODO(koss): Remove these functions unless used in tests?\n    RepoManager.prototype.interrupt = function () {\n        for (var appName in this.repos_) {\n            for (var dbUrl in this.repos_[appName]) {\n                this.repos_[appName][dbUrl].interrupt();\n            }\n        }\n    };\n    RepoManager.prototype.resume = function () {\n        for (var appName in this.repos_) {\n            for (var dbUrl in this.repos_[appName]) {\n                this.repos_[appName][dbUrl].resume();\n            }\n        }\n    };\n    /**\n     * This function should only ever be called to CREATE a new database instance.\n     *\n     * @param {!FirebaseApp} app\n     * @return {!Database}\n     */\n    RepoManager.prototype.databaseFromApp = function (app, url) {\n        var dbUrl = url || app.options[DATABASE_URL_OPTION];\n        if (dbUrl === undefined) {\n            util_2.fatal(\"Can't determine Firebase Database URL.  Be sure to include \" +\n                DATABASE_URL_OPTION +\n                ' option when calling firebase.intializeApp().');\n        }\n        var parsedUrl = parser_1.parseRepoInfo(dbUrl);\n        var repoInfo = parsedUrl.repoInfo;\n        validation_1.validateUrl('Invalid Firebase Database URL', 1, parsedUrl);\n        if (!parsedUrl.path.isEmpty()) {\n            util_2.fatal('Database URL must point to the root of a Firebase Database ' +\n                '(not including a child path).');\n        }\n        var repo = this.createRepo(repoInfo, app);\n        return repo.database;\n    };\n    /**\n     * Remove the repo and make sure it is disconnected.\n     *\n     * @param {!Repo} repo\n     */\n    RepoManager.prototype.deleteRepo = function (repo) {\n        var appRepos = util_1.safeGet(this.repos_, repo.app.name);\n        // This should never happen...\n        if (!appRepos || util_1.safeGet(appRepos, repo.repoInfo_.toURLString()) !== repo) {\n            util_2.fatal(\"Database \" + repo.app.name + \"(\" + repo.repoInfo_ + \") has already been deleted.\");\n        }\n        repo.interrupt();\n        delete appRepos[repo.repoInfo_.toURLString()];\n    };\n    /**\n     * Ensures a repo doesn't already exist and then creates one using the\n     * provided app.\n     *\n     * @param {!RepoInfo} repoInfo The metadata about the Repo\n     * @param {!FirebaseApp} app\n     * @return {!Repo} The Repo object for the specified server / repoName.\n     */\n    RepoManager.prototype.createRepo = function (repoInfo, app) {\n        var appRepos = util_1.safeGet(this.repos_, app.name);\n        if (!appRepos) {\n            appRepos = {};\n            this.repos_[app.name] = appRepos;\n        }\n        var repo = util_1.safeGet(appRepos, repoInfo.toURLString());\n        if (repo) {\n            util_2.fatal('Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.');\n        }\n        repo = new Repo_1.Repo(repoInfo, this.useRestClient_, app);\n        appRepos[repoInfo.toURLString()] = repo;\n        return repo;\n    };\n    /**\n     * Forces us to use ReadonlyRestClient instead of PersistentConnection for new Repos.\n     * @param {boolean} forceRestClient\n     */\n    RepoManager.prototype.forceRestClient = function (forceRestClient) {\n        this.useRestClient_ = forceRestClient;\n    };\n    return RepoManager;\n}());\nexports.RepoManager = RepoManager;\n\n\n\n},{\"./Repo\":17,\"./Repo_transaction\":20,\"./util/libs/parser\":62,\"./util/util\":63,\"./util/validation\":64,\"@firebase/util\":134}],20:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\nvar Reference_1 = require(\"../api/Reference\");\nvar DataSnapshot_1 = require(\"../api/DataSnapshot\");\nvar Path_1 = require(\"./util/Path\");\nvar Tree_1 = require(\"./util/Tree\");\nvar PriorityIndex_1 = require(\"./snap/indexes/PriorityIndex\");\nvar util_2 = require(\"./util/util\");\nvar ServerValues_1 = require(\"./util/ServerValues\");\nvar validation_1 = require(\"./util/validation\");\nvar util_3 = require(\"@firebase/util\");\nvar nodeFromJSON_1 = require(\"./snap/nodeFromJSON\");\nvar ChildrenNode_1 = require(\"./snap/ChildrenNode\");\nvar Repo_1 = require(\"./Repo\");\n// TODO: This is pretty messy.  Ideally, a lot of this would move into FirebaseData, or a transaction-specific\n// component used by FirebaseData, but it has ties to user callbacks (transaction update and onComplete) as well\n// as the realtime connection (to send transactions to the server).  So that all needs to be decoupled first.\n// For now it's part of Repo, but in its own file.\n/**\n * @enum {number}\n */\nvar TransactionStatus;\n(function (TransactionStatus) {\n    // We've run the transaction and updated transactionResultData_ with the result, but it isn't currently sent to the\n    // server. A transaction will go from RUN -> SENT -> RUN if it comes back from the server as rejected due to\n    // mismatched hash.\n    TransactionStatus[TransactionStatus[\"RUN\"] = 0] = \"RUN\";\n    // We've run the transaction and sent it to the server and it's currently outstanding (hasn't come back as accepted\n    // or rejected yet).\n    TransactionStatus[TransactionStatus[\"SENT\"] = 1] = \"SENT\";\n    // Temporary state used to mark completed transactions (whether successful or aborted).  The transaction will be\n    // removed when we get a chance to prune completed ones.\n    TransactionStatus[TransactionStatus[\"COMPLETED\"] = 2] = \"COMPLETED\";\n    // Used when an already-sent transaction needs to be aborted (e.g. due to a conflicting set() call that was made).\n    // If it comes back as unsuccessful, we'll abort it.\n    TransactionStatus[TransactionStatus[\"SENT_NEEDS_ABORT\"] = 3] = \"SENT_NEEDS_ABORT\";\n    // Temporary state used to mark transactions that need to be aborted.\n    TransactionStatus[TransactionStatus[\"NEEDS_ABORT\"] = 4] = \"NEEDS_ABORT\";\n})(TransactionStatus = exports.TransactionStatus || (exports.TransactionStatus = {}));\n/**\n * If a transaction does not succeed after 25 retries, we abort it.  Among other things this ensure that if there's\n * ever a bug causing a mismatch between client / server hashes for some data, we won't retry indefinitely.\n * @type {number}\n * @const\n * @private\n */\nRepo_1.Repo.MAX_TRANSACTION_RETRIES_ = 25;\n/**\n * Setup the transaction data structures\n * @private\n */\nRepo_1.Repo.prototype.transactions_init_ = function () {\n    /**\n     * Stores queues of outstanding transactions for Firebase locations.\n     *\n     * @type {!Tree.<Array.<!Transaction>>}\n     * @private\n     */\n    this.transactionQueueTree_ = new Tree_1.Tree();\n};\n/**\n * Creates a new transaction, adds it to the transactions we're tracking, and sends it to the server if possible.\n *\n * @param {!Path} path Path at which to do transaction.\n * @param {function(*):*} transactionUpdate Update callback.\n * @param {?function(?Error, boolean, ?DataSnapshot)} onComplete Completion callback.\n * @param {boolean} applyLocally Whether or not to make intermediate results visible\n */\nRepo_1.Repo.prototype.startTransaction = function (path, transactionUpdate, onComplete, applyLocally) {\n    this.log_('transaction on ' + path);\n    // Add a watch to make sure we get server updates.\n    var valueCallback = function () { };\n    var watchRef = new Reference_1.Reference(this, path);\n    watchRef.on('value', valueCallback);\n    var unwatcher = function () {\n        watchRef.off('value', valueCallback);\n    };\n    // Initialize transaction.\n    var transaction = {\n        path: path,\n        update: transactionUpdate,\n        onComplete: onComplete,\n        // One of TransactionStatus enums.\n        status: null,\n        // Used when combining transactions at different locations to figure out which one goes first.\n        order: util_2.LUIDGenerator(),\n        // Whether to raise local events for this transaction.\n        applyLocally: applyLocally,\n        // Count of how many times we've retried the transaction.\n        retryCount: 0,\n        // Function to call to clean up our .on() listener.\n        unwatcher: unwatcher,\n        // Stores why a transaction was aborted.\n        abortReason: null,\n        currentWriteId: null,\n        currentInputSnapshot: null,\n        currentOutputSnapshotRaw: null,\n        currentOutputSnapshotResolved: null\n    };\n    // Run transaction initially.\n    var currentState = this.getLatestState_(path);\n    transaction.currentInputSnapshot = currentState;\n    var newVal = transaction.update(currentState.val());\n    if (newVal === undefined) {\n        // Abort transaction.\n        transaction.unwatcher();\n        transaction.currentOutputSnapshotRaw = null;\n        transaction.currentOutputSnapshotResolved = null;\n        if (transaction.onComplete) {\n            // We just set the input snapshot, so this cast should be safe\n            var snapshot = new DataSnapshot_1.DataSnapshot(transaction.currentInputSnapshot, new Reference_1.Reference(this, transaction.path), PriorityIndex_1.PRIORITY_INDEX);\n            transaction.onComplete(null, false, snapshot);\n        }\n    }\n    else {\n        validation_1.validateFirebaseData('transaction failed: Data returned ', newVal, transaction.path);\n        // Mark as run and add to our queue.\n        transaction.status = TransactionStatus.RUN;\n        var queueNode = this.transactionQueueTree_.subTree(path);\n        var nodeQueue = queueNode.getValue() || [];\n        nodeQueue.push(transaction);\n        queueNode.setValue(nodeQueue);\n        // Update visibleData and raise events\n        // Note: We intentionally raise events after updating all of our transaction state, since the user could\n        // start new transactions from the event callbacks.\n        var priorityForNode = void 0;\n        if (typeof newVal === 'object' &&\n            newVal !== null &&\n            util_3.contains(newVal, '.priority')) {\n            priorityForNode = util_3.safeGet(newVal, '.priority');\n            util_1.assert(validation_1.isValidPriority(priorityForNode), 'Invalid priority returned by transaction. ' +\n                'Priority must be a valid string, finite number, server value, or null.');\n        }\n        else {\n            var currentNode = this.serverSyncTree_.calcCompleteEventCache(path) ||\n                ChildrenNode_1.ChildrenNode.EMPTY_NODE;\n            priorityForNode = currentNode.getPriority().val();\n        }\n        priorityForNode /** @type {null|number|string} */ = priorityForNode;\n        var serverValues = this.generateServerValues();\n        var newNodeUnresolved = nodeFromJSON_1.nodeFromJSON(newVal, priorityForNode);\n        var newNode = ServerValues_1.resolveDeferredValueSnapshot(newNodeUnresolved, serverValues);\n        transaction.currentOutputSnapshotRaw = newNodeUnresolved;\n        transaction.currentOutputSnapshotResolved = newNode;\n        transaction.currentWriteId = this.getNextWriteId_();\n        var events = this.serverSyncTree_.applyUserOverwrite(path, newNode, transaction.currentWriteId, transaction.applyLocally);\n        this.eventQueue_.raiseEventsForChangedPath(path, events);\n        this.sendReadyTransactions_();\n    }\n};\n/**\n * @param {!Path} path\n * @param {Array.<number>=} excludeSets A specific set to exclude\n * @return {Node}\n * @private\n */\nRepo_1.Repo.prototype.getLatestState_ = function (path, excludeSets) {\n    return (this.serverSyncTree_.calcCompleteEventCache(path, excludeSets) ||\n        ChildrenNode_1.ChildrenNode.EMPTY_NODE);\n};\n/**\n * Sends any already-run transactions that aren't waiting for outstanding transactions to\n * complete.\n *\n * Externally it's called with no arguments, but it calls itself recursively with a particular\n * transactionQueueTree node to recurse through the tree.\n *\n * @param {Tree.<Array.<Transaction>>=} node  transactionQueueTree node to start at.\n * @private\n */\nRepo_1.Repo.prototype.sendReadyTransactions_ = function (node) {\n    var _this = this;\n    if (node === void 0) { node = this.transactionQueueTree_; }\n    // Before recursing, make sure any completed transactions are removed.\n    if (!node) {\n        this.pruneCompletedTransactionsBelowNode_(node);\n    }\n    if (node.getValue() !== null) {\n        var queue = this.buildTransactionQueue_(node);\n        util_1.assert(queue.length > 0, 'Sending zero length transaction queue');\n        var allRun = queue.every(function (transaction) { return transaction.status === TransactionStatus.RUN; });\n        // If they're all run (and not sent), we can send them.  Else, we must wait.\n        if (allRun) {\n            this.sendTransactionQueue_(node.path(), queue);\n        }\n    }\n    else if (node.hasChildren()) {\n        node.forEachChild(function (childNode) {\n            _this.sendReadyTransactions_(childNode);\n        });\n    }\n};\n/**\n * Given a list of run transactions, send them to the server and then handle the result (success or failure).\n *\n * @param {!Path} path The location of the queue.\n * @param {!Array.<Transaction>} queue Queue of transactions under the specified location.\n * @private\n */\nRepo_1.Repo.prototype.sendTransactionQueue_ = function (path, queue) {\n    var _this = this;\n    // Mark transactions as sent and increment retry count!\n    var setsToIgnore = queue.map(function (txn) {\n        return txn.currentWriteId;\n    });\n    var latestState = this.getLatestState_(path, setsToIgnore);\n    var snapToSend = latestState;\n    var latestHash = latestState.hash();\n    for (var i = 0; i < queue.length; i++) {\n        var txn = queue[i];\n        util_1.assert(txn.status === TransactionStatus.RUN, 'tryToSendTransactionQueue_: items in queue should all be run.');\n        txn.status = TransactionStatus.SENT;\n        txn.retryCount++;\n        var relativePath = Path_1.Path.relativePath(path, txn.path);\n        // If we've gotten to this point, the output snapshot must be defined.\n        snapToSend = snapToSend.updateChild(relativePath /**@type {!Node} */, txn.currentOutputSnapshotRaw);\n    }\n    var dataToSend = snapToSend.val(true);\n    var pathToSend = path;\n    // Send the put.\n    this.server_.put(pathToSend.toString(), dataToSend, function (status) {\n        _this.log_('transaction put response', {\n            path: pathToSend.toString(),\n            status: status\n        });\n        var events = [];\n        if (status === 'ok') {\n            // Queue up the callbacks and fire them after cleaning up all of our transaction state, since\n            // the callback could trigger more transactions or sets.\n            var callbacks = [];\n            for (var i = 0; i < queue.length; i++) {\n                queue[i].status = TransactionStatus.COMPLETED;\n                events = events.concat(_this.serverSyncTree_.ackUserWrite(queue[i].currentWriteId));\n                if (queue[i].onComplete) {\n                    // We never unset the output snapshot, and given that this transaction is complete, it should be set\n                    var node = queue[i].currentOutputSnapshotResolved;\n                    var ref = new Reference_1.Reference(_this, queue[i].path);\n                    var snapshot = new DataSnapshot_1.DataSnapshot(node, ref, PriorityIndex_1.PRIORITY_INDEX);\n                    callbacks.push(queue[i].onComplete.bind(null, null, true, snapshot));\n                }\n                queue[i].unwatcher();\n            }\n            // Now remove the completed transactions.\n            _this.pruneCompletedTransactionsBelowNode_(_this.transactionQueueTree_.subTree(path));\n            // There may be pending transactions that we can now send.\n            _this.sendReadyTransactions_();\n            _this.eventQueue_.raiseEventsForChangedPath(path, events);\n            // Finally, trigger onComplete callbacks.\n            for (var i = 0; i < callbacks.length; i++) {\n                util_2.exceptionGuard(callbacks[i]);\n            }\n        }\n        else {\n            // transactions are no longer sent.  Update their status appropriately.\n            if (status === 'datastale') {\n                for (var i = 0; i < queue.length; i++) {\n                    if (queue[i].status === TransactionStatus.SENT_NEEDS_ABORT)\n                        queue[i].status = TransactionStatus.NEEDS_ABORT;\n                    else\n                        queue[i].status = TransactionStatus.RUN;\n                }\n            }\n            else {\n                util_2.warn('transaction at ' + pathToSend.toString() + ' failed: ' + status);\n                for (var i = 0; i < queue.length; i++) {\n                    queue[i].status = TransactionStatus.NEEDS_ABORT;\n                    queue[i].abortReason = status;\n                }\n            }\n            _this.rerunTransactions_(path);\n        }\n    }, latestHash);\n};\n/**\n * Finds all transactions dependent on the data at changedPath and reruns them.\n *\n * Should be called any time cached data changes.\n *\n * Return the highest path that was affected by rerunning transactions.  This is the path at which events need to\n * be raised for.\n *\n * @param {!Path} changedPath The path in mergedData that changed.\n * @return {!Path} The rootmost path that was affected by rerunning transactions.\n * @private\n */\nRepo_1.Repo.prototype.rerunTransactions_ = function (changedPath) {\n    var rootMostTransactionNode = this.getAncestorTransactionNode_(changedPath);\n    var path = rootMostTransactionNode.path();\n    var queue = this.buildTransactionQueue_(rootMostTransactionNode);\n    this.rerunTransactionQueue_(queue, path);\n    return path;\n};\n/**\n * Does all the work of rerunning transactions (as well as cleans up aborted transactions and whatnot).\n *\n * @param {Array.<Transaction>} queue The queue of transactions to run.\n * @param {!Path} path The path the queue is for.\n * @private\n */\nRepo_1.Repo.prototype.rerunTransactionQueue_ = function (queue, path) {\n    if (queue.length === 0) {\n        return; // Nothing to do!\n    }\n    // Queue up the callbacks and fire them after cleaning up all of our transaction state, since\n    // the callback could trigger more transactions or sets.\n    var callbacks = [];\n    var events = [];\n    // Ignore all of the sets we're going to re-run.\n    var txnsToRerun = queue.filter(function (q) {\n        return q.status === TransactionStatus.RUN;\n    });\n    var setsToIgnore = txnsToRerun.map(function (q) {\n        return q.currentWriteId;\n    });\n    for (var i = 0; i < queue.length; i++) {\n        var transaction = queue[i];\n        var relativePath = Path_1.Path.relativePath(path, transaction.path);\n        var abortTransaction = false, abortReason = void 0;\n        util_1.assert(relativePath !== null, 'rerunTransactionsUnderNode_: relativePath should not be null.');\n        if (transaction.status === TransactionStatus.NEEDS_ABORT) {\n            abortTransaction = true;\n            abortReason = transaction.abortReason;\n            events = events.concat(this.serverSyncTree_.ackUserWrite(transaction.currentWriteId, true));\n        }\n        else if (transaction.status === TransactionStatus.RUN) {\n            if (transaction.retryCount >= Repo_1.Repo.MAX_TRANSACTION_RETRIES_) {\n                abortTransaction = true;\n                abortReason = 'maxretry';\n                events = events.concat(this.serverSyncTree_.ackUserWrite(transaction.currentWriteId, true));\n            }\n            else {\n                // This code reruns a transaction\n                var currentNode = this.getLatestState_(transaction.path, setsToIgnore);\n                transaction.currentInputSnapshot = currentNode;\n                var newData = queue[i].update(currentNode.val());\n                if (newData !== undefined) {\n                    validation_1.validateFirebaseData('transaction failed: Data returned ', newData, transaction.path);\n                    var newDataNode = nodeFromJSON_1.nodeFromJSON(newData);\n                    var hasExplicitPriority = typeof newData === 'object' &&\n                        newData != null &&\n                        util_3.contains(newData, '.priority');\n                    if (!hasExplicitPriority) {\n                        // Keep the old priority if there wasn't a priority explicitly specified.\n                        newDataNode = newDataNode.updatePriority(currentNode.getPriority());\n                    }\n                    var oldWriteId = transaction.currentWriteId;\n                    var serverValues = this.generateServerValues();\n                    var newNodeResolved = ServerValues_1.resolveDeferredValueSnapshot(newDataNode, serverValues);\n                    transaction.currentOutputSnapshotRaw = newDataNode;\n                    transaction.currentOutputSnapshotResolved = newNodeResolved;\n                    transaction.currentWriteId = this.getNextWriteId_();\n                    // Mutates setsToIgnore in place\n                    setsToIgnore.splice(setsToIgnore.indexOf(oldWriteId), 1);\n                    events = events.concat(this.serverSyncTree_.applyUserOverwrite(transaction.path, newNodeResolved, transaction.currentWriteId, transaction.applyLocally));\n                    events = events.concat(this.serverSyncTree_.ackUserWrite(oldWriteId, true));\n                }\n                else {\n                    abortTransaction = true;\n                    abortReason = 'nodata';\n                    events = events.concat(this.serverSyncTree_.ackUserWrite(transaction.currentWriteId, true));\n                }\n            }\n        }\n        this.eventQueue_.raiseEventsForChangedPath(path, events);\n        events = [];\n        if (abortTransaction) {\n            // Abort.\n            queue[i].status = TransactionStatus.COMPLETED;\n            // Removing a listener can trigger pruning which can muck with mergedData/visibleData (as it prunes data).\n            // So defer the unwatcher until we're done.\n            (function (unwatcher) {\n                setTimeout(unwatcher, Math.floor(0));\n            })(queue[i].unwatcher);\n            if (queue[i].onComplete) {\n                if (abortReason === 'nodata') {\n                    var ref = new Reference_1.Reference(this, queue[i].path);\n                    // We set this field immediately, so it's safe to cast to an actual snapshot\n                    var lastInput /** @type {!Node} */ = queue[i].currentInputSnapshot;\n                    var snapshot = new DataSnapshot_1.DataSnapshot(lastInput, ref, PriorityIndex_1.PRIORITY_INDEX);\n                    callbacks.push(queue[i].onComplete.bind(null, null, false, snapshot));\n                }\n                else {\n                    callbacks.push(queue[i].onComplete.bind(null, new Error(abortReason), false, null));\n                }\n            }\n        }\n    }\n    // Clean up completed transactions.\n    this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_);\n    // Now fire callbacks, now that we're in a good, known state.\n    for (var i = 0; i < callbacks.length; i++) {\n        util_2.exceptionGuard(callbacks[i]);\n    }\n    // Try to send the transaction result to the server.\n    this.sendReadyTransactions_();\n};\n/**\n * Returns the rootmost ancestor node of the specified path that has a pending transaction on it, or just returns\n * the node for the given path if there are no pending transactions on any ancestor.\n *\n * @param {!Path} path The location to start at.\n * @return {!Tree.<Array.<!Transaction>>} The rootmost node with a transaction.\n * @private\n */\nRepo_1.Repo.prototype.getAncestorTransactionNode_ = function (path) {\n    var front;\n    // Start at the root and walk deeper into the tree towards path until we find a node with pending transactions.\n    var transactionNode = this.transactionQueueTree_;\n    while ((front = path.getFront()) !== null &&\n        transactionNode.getValue() === null) {\n        transactionNode = transactionNode.subTree(front);\n        path = path.popFront();\n    }\n    return transactionNode;\n};\n/**\n * Builds the queue of all transactions at or below the specified transactionNode.\n *\n * @param {!Tree.<Array.<Transaction>>} transactionNode\n * @return {Array.<Transaction>} The generated queue.\n * @private\n */\nRepo_1.Repo.prototype.buildTransactionQueue_ = function (transactionNode) {\n    // Walk any child transaction queues and aggregate them into a single queue.\n    var transactionQueue = [];\n    this.aggregateTransactionQueuesForNode_(transactionNode, transactionQueue);\n    // Sort them by the order the transactions were created.\n    transactionQueue.sort(function (a, b) {\n        return a.order - b.order;\n    });\n    return transactionQueue;\n};\n/**\n * @param {!Tree.<Array.<Transaction>>} node\n * @param {Array.<Transaction>} queue\n * @private\n */\nRepo_1.Repo.prototype.aggregateTransactionQueuesForNode_ = function (node, queue) {\n    var _this = this;\n    var nodeQueue = node.getValue();\n    if (nodeQueue !== null) {\n        for (var i = 0; i < nodeQueue.length; i++) {\n            queue.push(nodeQueue[i]);\n        }\n    }\n    node.forEachChild(function (child) {\n        _this.aggregateTransactionQueuesForNode_(child, queue);\n    });\n};\n/**\n * Remove COMPLETED transactions at or below this node in the transactionQueueTree_.\n *\n * @param {!Tree.<Array.<!Transaction>>} node\n * @private\n */\nRepo_1.Repo.prototype.pruneCompletedTransactionsBelowNode_ = function (node) {\n    var _this = this;\n    var queue = node.getValue();\n    if (queue) {\n        var to = 0;\n        for (var from = 0; from < queue.length; from++) {\n            if (queue[from].status !== TransactionStatus.COMPLETED) {\n                queue[to] = queue[from];\n                to++;\n            }\n        }\n        queue.length = to;\n        node.setValue(queue.length > 0 ? queue : null);\n    }\n    node.forEachChild(function (childNode) {\n        _this.pruneCompletedTransactionsBelowNode_(childNode);\n    });\n};\n/**\n * Aborts all transactions on ancestors or descendants of the specified path.  Called when doing a set() or update()\n * since we consider them incompatible with transactions.\n *\n * @param {!Path} path Path for which we want to abort related transactions.\n * @return {!Path}\n * @private\n */\nRepo_1.Repo.prototype.abortTransactions_ = function (path) {\n    var _this = this;\n    var affectedPath = this.getAncestorTransactionNode_(path).path();\n    var transactionNode = this.transactionQueueTree_.subTree(path);\n    transactionNode.forEachAncestor(function (node) {\n        _this.abortTransactionsOnNode_(node);\n    });\n    this.abortTransactionsOnNode_(transactionNode);\n    transactionNode.forEachDescendant(function (node) {\n        _this.abortTransactionsOnNode_(node);\n    });\n    return affectedPath;\n};\n/**\n * Abort transactions stored in this transaction queue node.\n *\n * @param {!Tree.<Array.<Transaction>>} node Node to abort transactions for.\n * @private\n */\nRepo_1.Repo.prototype.abortTransactionsOnNode_ = function (node) {\n    var queue = node.getValue();\n    if (queue !== null) {\n        // Queue up the callbacks and fire them after cleaning up all of our transaction state, since\n        // the callback could trigger more transactions or sets.\n        var callbacks = [];\n        // Go through queue.  Any already-sent transactions must be marked for abort, while the unsent ones\n        // can be immediately aborted and removed.\n        var events = [];\n        var lastSent = -1;\n        for (var i = 0; i < queue.length; i++) {\n            if (queue[i].status === TransactionStatus.SENT_NEEDS_ABORT) {\n                // Already marked.  No action needed.\n            }\n            else if (queue[i].status === TransactionStatus.SENT) {\n                util_1.assert(lastSent === i - 1, 'All SENT items should be at beginning of queue.');\n                lastSent = i;\n                // Mark transaction for abort when it comes back.\n                queue[i].status = TransactionStatus.SENT_NEEDS_ABORT;\n                queue[i].abortReason = 'set';\n            }\n            else {\n                util_1.assert(queue[i].status === TransactionStatus.RUN, 'Unexpected transaction status in abort');\n                // We can abort it immediately.\n                queue[i].unwatcher();\n                events = events.concat(this.serverSyncTree_.ackUserWrite(queue[i].currentWriteId, true));\n                if (queue[i].onComplete) {\n                    var snapshot = null;\n                    callbacks.push(queue[i].onComplete.bind(null, new Error('set'), false, snapshot));\n                }\n            }\n        }\n        if (lastSent === -1) {\n            // We're not waiting for any sent transactions.  We can clear the queue.\n            node.setValue(null);\n        }\n        else {\n            // Remove the transactions we aborted.\n            queue.length = lastSent + 1;\n        }\n        // Now fire the callbacks.\n        this.eventQueue_.raiseEventsForChangedPath(node.path(), events);\n        for (var i = 0; i < callbacks.length; i++) {\n            util_2.exceptionGuard(callbacks[i]);\n        }\n    }\n};\n\n\n\n},{\"../api/DataSnapshot\":5,\"../api/Reference\":8,\"./Repo\":17,\"./snap/ChildrenNode\":32,\"./snap/indexes/PriorityIndex\":41,\"./snap/nodeFromJSON\":43,\"./util/Path\":57,\"./util/ServerValues\":58,\"./util/Tree\":60,\"./util/util\":63,\"./util/validation\":64,\"@firebase/util\":134}],21:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Interface defining the set of actions that can be performed against the Firebase server\n * (basically corresponds to our wire protocol).\n *\n * @interface\n */\nvar ServerActions = /** @class */ (function () {\n    function ServerActions() {\n    }\n    /**\n     * @param {string} pathString\n     * @param {*} data\n     * @param {function(string, string)=} onComplete\n     * @param {string=} hash\n     */\n    ServerActions.prototype.put = function (pathString, data, onComplete, hash) { };\n    /**\n     * @param {string} pathString\n     * @param {*} data\n     * @param {function(string, ?string)} onComplete\n     * @param {string=} hash\n     */\n    ServerActions.prototype.merge = function (pathString, data, onComplete, hash) { };\n    /**\n     * Refreshes the auth token for the current connection.\n     * @param {string} token The authentication token\n     */\n    ServerActions.prototype.refreshAuthToken = function (token) { };\n    /**\n     * @param {string} pathString\n     * @param {*} data\n     * @param {function(string, string)=} onComplete\n     */\n    ServerActions.prototype.onDisconnectPut = function (pathString, data, onComplete) { };\n    /**\n     * @param {string} pathString\n     * @param {*} data\n     * @param {function(string, string)=} onComplete\n     */\n    ServerActions.prototype.onDisconnectMerge = function (pathString, data, onComplete) { };\n    /**\n     * @param {string} pathString\n     * @param {function(string, string)=} onComplete\n     */\n    ServerActions.prototype.onDisconnectCancel = function (pathString, onComplete) { };\n    /**\n     * @param {Object.<string, *>} stats\n     */\n    ServerActions.prototype.reportStats = function (stats) { };\n    return ServerActions;\n}());\nexports.ServerActions = ServerActions;\n\n\n\n},{}],22:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ChildrenNode_1 = require(\"./snap/ChildrenNode\");\n/**\n * Mutable object which basically just stores a reference to the \"latest\" immutable snapshot.\n *\n * @constructor\n */\nvar SnapshotHolder = /** @class */ (function () {\n    function SnapshotHolder() {\n        this.rootNode_ = ChildrenNode_1.ChildrenNode.EMPTY_NODE;\n    }\n    SnapshotHolder.prototype.getNode = function (path) {\n        return this.rootNode_.getChild(path);\n    };\n    SnapshotHolder.prototype.updateSnapshot = function (path, newSnapshotNode) {\n        this.rootNode_ = this.rootNode_.updateChild(path, newSnapshotNode);\n    };\n    return SnapshotHolder;\n}());\nexports.SnapshotHolder = SnapshotHolder;\n\n\n\n},{\"./snap/ChildrenNode\":32}],23:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Path_1 = require(\"./util/Path\");\nvar PriorityIndex_1 = require(\"./snap/indexes/PriorityIndex\");\nvar CountedSet_1 = require(\"./util/CountedSet\");\n/**\n * Helper class to store a sparse set of snapshots.\n *\n * @constructor\n */\nvar SparseSnapshotTree = /** @class */ (function () {\n    function SparseSnapshotTree() {\n        /**\n         * @private\n         * @type {Node}\n         */\n        this.value_ = null;\n        /**\n         * @private\n         * @type {CountedSet}\n         */\n        this.children_ = null;\n    }\n    /**\n     * Gets the node stored at the given path if one exists.\n     *\n     * @param {!Path} path Path to look up snapshot for.\n     * @return {?Node} The retrieved node, or null.\n     */\n    SparseSnapshotTree.prototype.find = function (path) {\n        if (this.value_ != null) {\n            return this.value_.getChild(path);\n        }\n        else if (!path.isEmpty() && this.children_ != null) {\n            var childKey = path.getFront();\n            path = path.popFront();\n            if (this.children_.contains(childKey)) {\n                var childTree = this.children_.get(childKey);\n                return childTree.find(path);\n            }\n            else {\n                return null;\n            }\n        }\n        else {\n            return null;\n        }\n    };\n    /**\n     * Stores the given node at the specified path. If there is already a node\n     * at a shallower path, it merges the new data into that snapshot node.\n     *\n     * @param {!Path} path Path to look up snapshot for.\n     * @param {!Node} data The new data, or null.\n     */\n    SparseSnapshotTree.prototype.remember = function (path, data) {\n        if (path.isEmpty()) {\n            this.value_ = data;\n            this.children_ = null;\n        }\n        else if (this.value_ !== null) {\n            this.value_ = this.value_.updateChild(path, data);\n        }\n        else {\n            if (this.children_ == null) {\n                this.children_ = new CountedSet_1.CountedSet();\n            }\n            var childKey = path.getFront();\n            if (!this.children_.contains(childKey)) {\n                this.children_.add(childKey, new SparseSnapshotTree());\n            }\n            var child = this.children_.get(childKey);\n            path = path.popFront();\n            child.remember(path, data);\n        }\n    };\n    /**\n     * Purge the data at path from the cache.\n     *\n     * @param {!Path} path Path to look up snapshot for.\n     * @return {boolean} True if this node should now be removed.\n     */\n    SparseSnapshotTree.prototype.forget = function (path) {\n        if (path.isEmpty()) {\n            this.value_ = null;\n            this.children_ = null;\n            return true;\n        }\n        else {\n            if (this.value_ !== null) {\n                if (this.value_.isLeafNode()) {\n                    // We're trying to forget a node that doesn't exist\n                    return false;\n                }\n                else {\n                    var value = this.value_;\n                    this.value_ = null;\n                    var self_1 = this;\n                    value.forEachChild(PriorityIndex_1.PRIORITY_INDEX, function (key, tree) {\n                        self_1.remember(new Path_1.Path(key), tree);\n                    });\n                    return this.forget(path);\n                }\n            }\n            else if (this.children_ !== null) {\n                var childKey = path.getFront();\n                path = path.popFront();\n                if (this.children_.contains(childKey)) {\n                    var safeToRemove = this.children_.get(childKey).forget(path);\n                    if (safeToRemove) {\n                        this.children_.remove(childKey);\n                    }\n                }\n                if (this.children_.isEmpty()) {\n                    this.children_ = null;\n                    return true;\n                }\n                else {\n                    return false;\n                }\n            }\n            else {\n                return true;\n            }\n        }\n    };\n    /**\n     * Recursively iterates through all of the stored tree and calls the\n     * callback on each one.\n     *\n     * @param {!Path} prefixPath Path to look up node for.\n     * @param {!Function} func The function to invoke for each tree.\n     */\n    SparseSnapshotTree.prototype.forEachTree = function (prefixPath, func) {\n        if (this.value_ !== null) {\n            func(prefixPath, this.value_);\n        }\n        else {\n            this.forEachChild(function (key, tree) {\n                var path = new Path_1.Path(prefixPath.toString() + '/' + key);\n                tree.forEachTree(path, func);\n            });\n        }\n    };\n    /**\n     * Iterates through each immediate child and triggers the callback.\n     *\n     * @param {!Function} func The function to invoke for each child.\n     */\n    SparseSnapshotTree.prototype.forEachChild = function (func) {\n        if (this.children_ !== null) {\n            this.children_.each(function (key, tree) {\n                func(key, tree);\n            });\n        }\n    };\n    return SparseSnapshotTree;\n}());\nexports.SparseSnapshotTree = SparseSnapshotTree;\n\n\n\n},{\"./snap/indexes/PriorityIndex\":41,\"./util/CountedSet\":52,\"./util/Path\":57}],24:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar CacheNode_1 = require(\"./view/CacheNode\");\nvar ChildrenNode_1 = require(\"./snap/ChildrenNode\");\nvar util_1 = require(\"@firebase/util\");\nvar util_2 = require(\"@firebase/util\");\nvar ViewCache_1 = require(\"./view/ViewCache\");\nvar View_1 = require(\"./view/View\");\nvar __referenceConstructor;\n/**\n * SyncPoint represents a single location in a SyncTree with 1 or more event registrations, meaning we need to\n * maintain 1 or more Views at this location to cache server data and raise appropriate events for server changes\n * and user writes (set, transaction, update).\n *\n * It's responsible for:\n *  - Maintaining the set of 1 or more views necessary at this location (a SyncPoint with 0 views should be removed).\n *  - Proxying user / server operations to the views as appropriate (i.e. applyServerOverwrite,\n *    applyUserOverwrite, etc.)\n */\nvar SyncPoint = /** @class */ (function () {\n    function SyncPoint() {\n        /**\n         * The Views being tracked at this location in the tree, stored as a map where the key is a\n         * queryId and the value is the View for that query.\n         *\n         * NOTE: This list will be quite small (usually 1, but perhaps 2 or 3; any more is an odd use case).\n         *\n         * @type {!Object.<!string, !View>}\n         * @private\n         */\n        this.views_ = {};\n    }\n    Object.defineProperty(SyncPoint, \"__referenceConstructor\", {\n        get: function () {\n            util_1.assert(__referenceConstructor, 'Reference.ts has not been loaded');\n            return __referenceConstructor;\n        },\n        set: function (val) {\n            util_1.assert(!__referenceConstructor, '__referenceConstructor has already been defined');\n            __referenceConstructor = val;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @return {boolean}\n     */\n    SyncPoint.prototype.isEmpty = function () {\n        return util_2.isEmpty(this.views_);\n    };\n    /**\n     *\n     * @param {!Operation} operation\n     * @param {!WriteTreeRef} writesCache\n     * @param {?Node} optCompleteServerCache\n     * @return {!Array.<!Event>}\n     */\n    SyncPoint.prototype.applyOperation = function (operation, writesCache, optCompleteServerCache) {\n        var queryId = operation.source.queryId;\n        if (queryId !== null) {\n            var view = util_2.safeGet(this.views_, queryId);\n            util_1.assert(view != null, 'SyncTree gave us an op for an invalid query.');\n            return view.applyOperation(operation, writesCache, optCompleteServerCache);\n        }\n        else {\n            var events_1 = [];\n            util_2.forEach(this.views_, function (key, view) {\n                events_1 = events_1.concat(view.applyOperation(operation, writesCache, optCompleteServerCache));\n            });\n            return events_1;\n        }\n    };\n    /**\n     * Add an event callback for the specified query.\n     *\n     * @param {!Query} query\n     * @param {!EventRegistration} eventRegistration\n     * @param {!WriteTreeRef} writesCache\n     * @param {?Node} serverCache Complete server cache, if we have it.\n     * @param {boolean} serverCacheComplete\n     * @return {!Array.<!Event>} Events to raise.\n     */\n    SyncPoint.prototype.addEventRegistration = function (query, eventRegistration, writesCache, serverCache, serverCacheComplete) {\n        var queryId = query.queryIdentifier();\n        var view = util_2.safeGet(this.views_, queryId);\n        if (!view) {\n            // TODO: make writesCache take flag for complete server node\n            var eventCache = writesCache.calcCompleteEventCache(serverCacheComplete ? serverCache : null);\n            var eventCacheComplete = false;\n            if (eventCache) {\n                eventCacheComplete = true;\n            }\n            else if (serverCache instanceof ChildrenNode_1.ChildrenNode) {\n                eventCache = writesCache.calcCompleteEventChildren(serverCache);\n                eventCacheComplete = false;\n            }\n            else {\n                eventCache = ChildrenNode_1.ChildrenNode.EMPTY_NODE;\n                eventCacheComplete = false;\n            }\n            var viewCache = new ViewCache_1.ViewCache(new CacheNode_1.CacheNode(\n            /** @type {!Node} */ (eventCache), eventCacheComplete, false), new CacheNode_1.CacheNode(\n            /** @type {!Node} */ (serverCache), serverCacheComplete, false));\n            view = new View_1.View(query, viewCache);\n            this.views_[queryId] = view;\n        }\n        // This is guaranteed to exist now, we just created anything that was missing\n        view.addEventRegistration(eventRegistration);\n        return view.getInitialEvents(eventRegistration);\n    };\n    /**\n     * Remove event callback(s).  Return cancelEvents if a cancelError is specified.\n     *\n     * If query is the default query, we'll check all views for the specified eventRegistration.\n     * If eventRegistration is null, we'll remove all callbacks for the specified view(s).\n     *\n     * @param {!Query} query\n     * @param {?EventRegistration} eventRegistration If null, remove all callbacks.\n     * @param {Error=} cancelError If a cancelError is provided, appropriate cancel events will be returned.\n     * @return {{removed:!Array.<!Query>, events:!Array.<!Event>}} removed queries and any cancel events\n     */\n    SyncPoint.prototype.removeEventRegistration = function (query, eventRegistration, cancelError) {\n        var queryId = query.queryIdentifier();\n        var removed = [];\n        var cancelEvents = [];\n        var hadCompleteView = this.hasCompleteView();\n        if (queryId === 'default') {\n            // When you do ref.off(...), we search all views for the registration to remove.\n            var self_1 = this;\n            util_2.forEach(this.views_, function (viewQueryId, view) {\n                cancelEvents = cancelEvents.concat(view.removeEventRegistration(eventRegistration, cancelError));\n                if (view.isEmpty()) {\n                    delete self_1.views_[viewQueryId];\n                    // We'll deal with complete views later.\n                    if (!view\n                        .getQuery()\n                        .getQueryParams()\n                        .loadsAllData()) {\n                        removed.push(view.getQuery());\n                    }\n                }\n            });\n        }\n        else {\n            // remove the callback from the specific view.\n            var view = util_2.safeGet(this.views_, queryId);\n            if (view) {\n                cancelEvents = cancelEvents.concat(view.removeEventRegistration(eventRegistration, cancelError));\n                if (view.isEmpty()) {\n                    delete this.views_[queryId];\n                    // We'll deal with complete views later.\n                    if (!view\n                        .getQuery()\n                        .getQueryParams()\n                        .loadsAllData()) {\n                        removed.push(view.getQuery());\n                    }\n                }\n            }\n        }\n        if (hadCompleteView && !this.hasCompleteView()) {\n            // We removed our last complete view.\n            removed.push(new SyncPoint.__referenceConstructor(query.repo, query.path));\n        }\n        return { removed: removed, events: cancelEvents };\n    };\n    /**\n     * @return {!Array.<!View>}\n     */\n    SyncPoint.prototype.getQueryViews = function () {\n        var _this = this;\n        var values = Object.keys(this.views_).map(function (key) { return _this.views_[key]; });\n        return values.filter(function (view) {\n            return !view\n                .getQuery()\n                .getQueryParams()\n                .loadsAllData();\n        });\n    };\n    /**\n     *\n     * @param {!Path} path The path to the desired complete snapshot\n     * @return {?Node} A complete cache, if it exists\n     */\n    SyncPoint.prototype.getCompleteServerCache = function (path) {\n        var serverCache = null;\n        util_2.forEach(this.views_, function (key, view) {\n            serverCache = serverCache || view.getCompleteServerCache(path);\n        });\n        return serverCache;\n    };\n    /**\n     * @param {!Query} query\n     * @return {?View}\n     */\n    SyncPoint.prototype.viewForQuery = function (query) {\n        var params = query.getQueryParams();\n        if (params.loadsAllData()) {\n            return this.getCompleteView();\n        }\n        else {\n            var queryId = query.queryIdentifier();\n            return util_2.safeGet(this.views_, queryId);\n        }\n    };\n    /**\n     * @param {!Query} query\n     * @return {boolean}\n     */\n    SyncPoint.prototype.viewExistsForQuery = function (query) {\n        return this.viewForQuery(query) != null;\n    };\n    /**\n     * @return {boolean}\n     */\n    SyncPoint.prototype.hasCompleteView = function () {\n        return this.getCompleteView() != null;\n    };\n    /**\n     * @return {?View}\n     */\n    SyncPoint.prototype.getCompleteView = function () {\n        var completeView = util_2.findValue(this.views_, function (view) {\n            return view\n                .getQuery()\n                .getQueryParams()\n                .loadsAllData();\n        });\n        return completeView || null;\n    };\n    return SyncPoint;\n}());\nexports.SyncPoint = SyncPoint;\n\n\n\n},{\"./snap/ChildrenNode\":32,\"./view/CacheNode\":65,\"./view/View\":74,\"./view/ViewCache\":75,\"@firebase/util\":134}],25:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\nvar util_2 = require(\"./util/util\");\nvar AckUserWrite_1 = require(\"./operation/AckUserWrite\");\nvar ChildrenNode_1 = require(\"./snap/ChildrenNode\");\nvar util_3 = require(\"@firebase/util\");\nvar ImmutableTree_1 = require(\"./util/ImmutableTree\");\nvar ListenComplete_1 = require(\"./operation/ListenComplete\");\nvar Merge_1 = require(\"./operation/Merge\");\nvar Operation_1 = require(\"./operation/Operation\");\nvar Overwrite_1 = require(\"./operation/Overwrite\");\nvar Path_1 = require(\"./util/Path\");\nvar SyncPoint_1 = require(\"./SyncPoint\");\nvar WriteTree_1 = require(\"./WriteTree\");\n/**\n * SyncTree is the central class for managing event callback registration, data caching, views\n * (query processing), and event generation.  There are typically two SyncTree instances for\n * each Repo, one for the normal Firebase data, and one for the .info data.\n *\n * It has a number of responsibilities, including:\n *  - Tracking all user event callbacks (registered via addEventRegistration() and removeEventRegistration()).\n *  - Applying and caching data changes for user set(), transaction(), and update() calls\n *    (applyUserOverwrite(), applyUserMerge()).\n *  - Applying and caching data changes for server data changes (applyServerOverwrite(),\n *    applyServerMerge()).\n *  - Generating user-facing events for server and user changes (all of the apply* methods\n *    return the set of events that need to be raised as a result).\n *  - Maintaining the appropriate set of server listens to ensure we are always subscribed\n *    to the correct set of paths and queries to satisfy the current set of user event\n *    callbacks (listens are started/stopped using the provided listenProvider).\n *\n * NOTE: Although SyncTree tracks event callbacks and calculates events to raise, the actual\n * events are returned to the caller rather than raised synchronously.\n *\n * @constructor\n */\nvar SyncTree = /** @class */ (function () {\n    /**\n     * @param {!ListenProvider} listenProvider_ Used by SyncTree to start / stop listening\n     *   to server data.\n     */\n    function SyncTree(listenProvider_) {\n        this.listenProvider_ = listenProvider_;\n        /**\n         * Tree of SyncPoints.  There's a SyncPoint at any location that has 1 or more views.\n         * @type {!ImmutableTree.<!SyncPoint>}\n         * @private\n         */\n        this.syncPointTree_ = ImmutableTree_1.ImmutableTree.Empty;\n        /**\n         * A tree of all pending user writes (user-initiated set()'s, transaction()'s, update()'s, etc.).\n         * @type {!WriteTree}\n         * @private\n         */\n        this.pendingWriteTree_ = new WriteTree_1.WriteTree();\n        this.tagToQueryMap_ = {};\n        this.queryToTagMap_ = {};\n    }\n    /**\n     * Apply the data changes for a user-generated set() or transaction() call.\n     *\n     * @param {!Path} path\n     * @param {!Node} newData\n     * @param {number} writeId\n     * @param {boolean=} visible\n     * @return {!Array.<!Event>} Events to raise.\n     */\n    SyncTree.prototype.applyUserOverwrite = function (path, newData, writeId, visible) {\n        // Record pending write.\n        this.pendingWriteTree_.addOverwrite(path, newData, writeId, visible);\n        if (!visible) {\n            return [];\n        }\n        else {\n            return this.applyOperationToSyncPoints_(new Overwrite_1.Overwrite(Operation_1.OperationSource.User, path, newData));\n        }\n    };\n    /**\n     * Apply the data from a user-generated update() call\n     *\n     * @param {!Path} path\n     * @param {!Object.<string, !Node>} changedChildren\n     * @param {!number} writeId\n     * @return {!Array.<!Event>} Events to raise.\n     */\n    SyncTree.prototype.applyUserMerge = function (path, changedChildren, writeId) {\n        // Record pending merge.\n        this.pendingWriteTree_.addMerge(path, changedChildren, writeId);\n        var changeTree = ImmutableTree_1.ImmutableTree.fromObject(changedChildren);\n        return this.applyOperationToSyncPoints_(new Merge_1.Merge(Operation_1.OperationSource.User, path, changeTree));\n    };\n    /**\n     * Acknowledge a pending user write that was previously registered with applyUserOverwrite() or applyUserMerge().\n     *\n     * @param {!number} writeId\n     * @param {boolean=} revert True if the given write failed and needs to be reverted\n     * @return {!Array.<!Event>} Events to raise.\n     */\n    SyncTree.prototype.ackUserWrite = function (writeId, revert) {\n        if (revert === void 0) { revert = false; }\n        var write = this.pendingWriteTree_.getWrite(writeId);\n        var needToReevaluate = this.pendingWriteTree_.removeWrite(writeId);\n        if (!needToReevaluate) {\n            return [];\n        }\n        else {\n            var affectedTree_1 = ImmutableTree_1.ImmutableTree.Empty;\n            if (write.snap != null) {\n                // overwrite\n                affectedTree_1 = affectedTree_1.set(Path_1.Path.Empty, true);\n            }\n            else {\n                util_3.forEach(write.children, function (pathString, node) {\n                    affectedTree_1 = affectedTree_1.set(new Path_1.Path(pathString), node);\n                });\n            }\n            return this.applyOperationToSyncPoints_(new AckUserWrite_1.AckUserWrite(write.path, affectedTree_1, revert));\n        }\n    };\n    /**\n     * Apply new server data for the specified path..\n     *\n     * @param {!Path} path\n     * @param {!Node} newData\n     * @return {!Array.<!Event>} Events to raise.\n     */\n    SyncTree.prototype.applyServerOverwrite = function (path, newData) {\n        return this.applyOperationToSyncPoints_(new Overwrite_1.Overwrite(Operation_1.OperationSource.Server, path, newData));\n    };\n    /**\n     * Apply new server data to be merged in at the specified path.\n     *\n     * @param {!Path} path\n     * @param {!Object.<string, !Node>} changedChildren\n     * @return {!Array.<!Event>} Events to raise.\n     */\n    SyncTree.prototype.applyServerMerge = function (path, changedChildren) {\n        var changeTree = ImmutableTree_1.ImmutableTree.fromObject(changedChildren);\n        return this.applyOperationToSyncPoints_(new Merge_1.Merge(Operation_1.OperationSource.Server, path, changeTree));\n    };\n    /**\n     * Apply a listen complete for a query\n     *\n     * @param {!Path} path\n     * @return {!Array.<!Event>} Events to raise.\n     */\n    SyncTree.prototype.applyListenComplete = function (path) {\n        return this.applyOperationToSyncPoints_(new ListenComplete_1.ListenComplete(Operation_1.OperationSource.Server, path));\n    };\n    /**\n     * Apply new server data for the specified tagged query.\n     *\n     * @param {!Path} path\n     * @param {!Node} snap\n     * @param {!number} tag\n     * @return {!Array.<!Event>} Events to raise.\n     */\n    SyncTree.prototype.applyTaggedQueryOverwrite = function (path, snap, tag) {\n        var queryKey = this.queryKeyForTag_(tag);\n        if (queryKey != null) {\n            var r = SyncTree.parseQueryKey_(queryKey);\n            var queryPath = r.path, queryId = r.queryId;\n            var relativePath = Path_1.Path.relativePath(queryPath, path);\n            var op = new Overwrite_1.Overwrite(Operation_1.OperationSource.forServerTaggedQuery(queryId), relativePath, snap);\n            return this.applyTaggedOperation_(queryPath, op);\n        }\n        else {\n            // Query must have been removed already\n            return [];\n        }\n    };\n    /**\n     * Apply server data to be merged in for the specified tagged query.\n     *\n     * @param {!Path} path\n     * @param {!Object.<string, !Node>} changedChildren\n     * @param {!number} tag\n     * @return {!Array.<!Event>} Events to raise.\n     */\n    SyncTree.prototype.applyTaggedQueryMerge = function (path, changedChildren, tag) {\n        var queryKey = this.queryKeyForTag_(tag);\n        if (queryKey) {\n            var r = SyncTree.parseQueryKey_(queryKey);\n            var queryPath = r.path, queryId = r.queryId;\n            var relativePath = Path_1.Path.relativePath(queryPath, path);\n            var changeTree = ImmutableTree_1.ImmutableTree.fromObject(changedChildren);\n            var op = new Merge_1.Merge(Operation_1.OperationSource.forServerTaggedQuery(queryId), relativePath, changeTree);\n            return this.applyTaggedOperation_(queryPath, op);\n        }\n        else {\n            // We've already removed the query. No big deal, ignore the update\n            return [];\n        }\n    };\n    /**\n     * Apply a listen complete for a tagged query\n     *\n     * @param {!Path} path\n     * @param {!number} tag\n     * @return {!Array.<!Event>} Events to raise.\n     */\n    SyncTree.prototype.applyTaggedListenComplete = function (path, tag) {\n        var queryKey = this.queryKeyForTag_(tag);\n        if (queryKey) {\n            var r = SyncTree.parseQueryKey_(queryKey);\n            var queryPath = r.path, queryId = r.queryId;\n            var relativePath = Path_1.Path.relativePath(queryPath, path);\n            var op = new ListenComplete_1.ListenComplete(Operation_1.OperationSource.forServerTaggedQuery(queryId), relativePath);\n            return this.applyTaggedOperation_(queryPath, op);\n        }\n        else {\n            // We've already removed the query. No big deal, ignore the update\n            return [];\n        }\n    };\n    /**\n     * Add an event callback for the specified query.\n     *\n     * @param {!Query} query\n     * @param {!EventRegistration} eventRegistration\n     * @return {!Array.<!Event>} Events to raise.\n     */\n    SyncTree.prototype.addEventRegistration = function (query, eventRegistration) {\n        var path = query.path;\n        var serverCache = null;\n        var foundAncestorDefaultView = false;\n        // Any covering writes will necessarily be at the root, so really all we need to find is the server cache.\n        // Consider optimizing this once there's a better understanding of what actual behavior will be.\n        this.syncPointTree_.foreachOnPath(path, function (pathToSyncPoint, sp) {\n            var relativePath = Path_1.Path.relativePath(pathToSyncPoint, path);\n            serverCache = serverCache || sp.getCompleteServerCache(relativePath);\n            foundAncestorDefaultView =\n                foundAncestorDefaultView || sp.hasCompleteView();\n        });\n        var syncPoint = this.syncPointTree_.get(path);\n        if (!syncPoint) {\n            syncPoint = new SyncPoint_1.SyncPoint();\n            this.syncPointTree_ = this.syncPointTree_.set(path, syncPoint);\n        }\n        else {\n            foundAncestorDefaultView =\n                foundAncestorDefaultView || syncPoint.hasCompleteView();\n            serverCache = serverCache || syncPoint.getCompleteServerCache(Path_1.Path.Empty);\n        }\n        var serverCacheComplete;\n        if (serverCache != null) {\n            serverCacheComplete = true;\n        }\n        else {\n            serverCacheComplete = false;\n            serverCache = ChildrenNode_1.ChildrenNode.EMPTY_NODE;\n            var subtree = this.syncPointTree_.subtree(path);\n            subtree.foreachChild(function (childName, childSyncPoint) {\n                var completeCache = childSyncPoint.getCompleteServerCache(Path_1.Path.Empty);\n                if (completeCache) {\n                    serverCache = serverCache.updateImmediateChild(childName, completeCache);\n                }\n            });\n        }\n        var viewAlreadyExists = syncPoint.viewExistsForQuery(query);\n        if (!viewAlreadyExists && !query.getQueryParams().loadsAllData()) {\n            // We need to track a tag for this query\n            var queryKey = SyncTree.makeQueryKey_(query);\n            util_1.assert(!(queryKey in this.queryToTagMap_), 'View does not exist, but we have a tag');\n            var tag = SyncTree.getNextQueryTag_();\n            this.queryToTagMap_[queryKey] = tag;\n            // Coerce to string to avoid sparse arrays.\n            this.tagToQueryMap_['_' + tag] = queryKey;\n        }\n        var writesCache = this.pendingWriteTree_.childWrites(path);\n        var events = syncPoint.addEventRegistration(query, eventRegistration, writesCache, serverCache, serverCacheComplete);\n        if (!viewAlreadyExists && !foundAncestorDefaultView) {\n            var view /** @type !View */ = syncPoint.viewForQuery(query);\n            events = events.concat(this.setupListener_(query, view));\n        }\n        return events;\n    };\n    /**\n     * Remove event callback(s).\n     *\n     * If query is the default query, we'll check all queries for the specified eventRegistration.\n     * If eventRegistration is null, we'll remove all callbacks for the specified query/queries.\n     *\n     * @param {!Query} query\n     * @param {?EventRegistration} eventRegistration If null, all callbacks are removed.\n     * @param {Error=} cancelError If a cancelError is provided, appropriate cancel events will be returned.\n     * @return {!Array.<!Event>} Cancel events, if cancelError was provided.\n     */\n    SyncTree.prototype.removeEventRegistration = function (query, eventRegistration, cancelError) {\n        var _this = this;\n        // Find the syncPoint first. Then deal with whether or not it has matching listeners\n        var path = query.path;\n        var maybeSyncPoint = this.syncPointTree_.get(path);\n        var cancelEvents = [];\n        // A removal on a default query affects all queries at that location. A removal on an indexed query, even one without\n        // other query constraints, does *not* affect all queries at that location. So this check must be for 'default', and\n        // not loadsAllData().\n        if (maybeSyncPoint &&\n            (query.queryIdentifier() === 'default' ||\n                maybeSyncPoint.viewExistsForQuery(query))) {\n            /**\n             * @type {{removed: !Array.<!Query>, events: !Array.<!Event>}}\n             */\n            var removedAndEvents = maybeSyncPoint.removeEventRegistration(query, eventRegistration, cancelError);\n            if (maybeSyncPoint.isEmpty()) {\n                this.syncPointTree_ = this.syncPointTree_.remove(path);\n            }\n            var removed = removedAndEvents.removed;\n            cancelEvents = removedAndEvents.events;\n            // We may have just removed one of many listeners and can short-circuit this whole process\n            // We may also not have removed a default listener, in which case all of the descendant listeners should already be\n            // properly set up.\n            //\n            // Since indexed queries can shadow if they don't have other query constraints, check for loadsAllData(), instead of\n            // queryId === 'default'\n            var removingDefault = -1 !==\n                removed.findIndex(function (query) {\n                    return query.getQueryParams().loadsAllData();\n                });\n            var covered = this.syncPointTree_.findOnPath(path, function (relativePath, parentSyncPoint) {\n                return parentSyncPoint.hasCompleteView();\n            });\n            if (removingDefault && !covered) {\n                var subtree = this.syncPointTree_.subtree(path);\n                // There are potentially child listeners. Determine what if any listens we need to send before executing the\n                // removal\n                if (!subtree.isEmpty()) {\n                    // We need to fold over our subtree and collect the listeners to send\n                    var newViews = this.collectDistinctViewsForSubTree_(subtree);\n                    // Ok, we've collected all the listens we need. Set them up.\n                    for (var i = 0; i < newViews.length; ++i) {\n                        var view = newViews[i], newQuery = view.getQuery();\n                        var listener = this.createListenerForView_(view);\n                        this.listenProvider_.startListening(SyncTree.queryForListening_(newQuery), this.tagForQuery_(newQuery), listener.hashFn, listener.onComplete);\n                    }\n                }\n                else {\n                    // There's nothing below us, so nothing we need to start listening on\n                }\n            }\n            // If we removed anything and we're not covered by a higher up listen, we need to stop listening on this query\n            // The above block has us covered in terms of making sure we're set up on listens lower in the tree.\n            // Also, note that if we have a cancelError, it's already been removed at the provider level.\n            if (!covered && removed.length > 0 && !cancelError) {\n                // If we removed a default, then we weren't listening on any of the other queries here. Just cancel the one\n                // default. Otherwise, we need to iterate through and cancel each individual query\n                if (removingDefault) {\n                    // We don't tag default listeners\n                    var defaultTag = null;\n                    this.listenProvider_.stopListening(SyncTree.queryForListening_(query), defaultTag);\n                }\n                else {\n                    removed.forEach(function (queryToRemove) {\n                        var tagToRemove = _this.queryToTagMap_[SyncTree.makeQueryKey_(queryToRemove)];\n                        _this.listenProvider_.stopListening(SyncTree.queryForListening_(queryToRemove), tagToRemove);\n                    });\n                }\n            }\n            // Now, clear all of the tags we're tracking for the removed listens\n            this.removeTags_(removed);\n        }\n        else {\n            // No-op, this listener must've been already removed\n        }\n        return cancelEvents;\n    };\n    /**\n     * Returns a complete cache, if we have one, of the data at a particular path. The location must have a listener above\n     * it, but as this is only used by transaction code, that should always be the case anyways.\n     *\n     * Note: this method will *include* hidden writes from transaction with applyLocally set to false.\n     * @param {!Path} path The path to the data we want\n     * @param {Array.<number>=} writeIdsToExclude A specific set to be excluded\n     * @return {?Node}\n     */\n    SyncTree.prototype.calcCompleteEventCache = function (path, writeIdsToExclude) {\n        var includeHiddenSets = true;\n        var writeTree = this.pendingWriteTree_;\n        var serverCache = this.syncPointTree_.findOnPath(path, function (pathSoFar, syncPoint) {\n            var relativePath = Path_1.Path.relativePath(pathSoFar, path);\n            var serverCache = syncPoint.getCompleteServerCache(relativePath);\n            if (serverCache) {\n                return serverCache;\n            }\n        });\n        return writeTree.calcCompleteEventCache(path, serverCache, writeIdsToExclude, includeHiddenSets);\n    };\n    /**\n     * This collapses multiple unfiltered views into a single view, since we only need a single\n     * listener for them.\n     *\n     * @param {!ImmutableTree.<!SyncPoint>} subtree\n     * @return {!Array.<!View>}\n     * @private\n     */\n    SyncTree.prototype.collectDistinctViewsForSubTree_ = function (subtree) {\n        return subtree.fold(function (relativePath, maybeChildSyncPoint, childMap) {\n            if (maybeChildSyncPoint && maybeChildSyncPoint.hasCompleteView()) {\n                var completeView = maybeChildSyncPoint.getCompleteView();\n                return [completeView];\n            }\n            else {\n                // No complete view here, flatten any deeper listens into an array\n                var views_1 = [];\n                if (maybeChildSyncPoint) {\n                    views_1 = maybeChildSyncPoint.getQueryViews();\n                }\n                util_3.forEach(childMap, function (key, childViews) {\n                    views_1 = views_1.concat(childViews);\n                });\n                return views_1;\n            }\n        });\n    };\n    /**\n     * @param {!Array.<!Query>} queries\n     * @private\n     */\n    SyncTree.prototype.removeTags_ = function (queries) {\n        for (var j = 0; j < queries.length; ++j) {\n            var removedQuery = queries[j];\n            if (!removedQuery.getQueryParams().loadsAllData()) {\n                // We should have a tag for this\n                var removedQueryKey = SyncTree.makeQueryKey_(removedQuery);\n                var removedQueryTag = this.queryToTagMap_[removedQueryKey];\n                delete this.queryToTagMap_[removedQueryKey];\n                delete this.tagToQueryMap_['_' + removedQueryTag];\n            }\n        }\n    };\n    /**\n     * Normalizes a query to a query we send the server for listening\n     * @param {!Query} query\n     * @return {!Query} The normalized query\n     * @private\n     */\n    SyncTree.queryForListening_ = function (query) {\n        if (query.getQueryParams().loadsAllData() &&\n            !query.getQueryParams().isDefault()) {\n            // We treat queries that load all data as default queries\n            // Cast is necessary because ref() technically returns Firebase which is actually fb.api.Firebase which inherits\n            // from Query\n            return /** @type {!Query} */ query.getRef();\n        }\n        else {\n            return query;\n        }\n    };\n    /**\n     * For a given new listen, manage the de-duplication of outstanding subscriptions.\n     *\n     * @param {!Query} query\n     * @param {!View} view\n     * @return {!Array.<!Event>} This method can return events to support synchronous data sources\n     * @private\n     */\n    SyncTree.prototype.setupListener_ = function (query, view) {\n        var path = query.path;\n        var tag = this.tagForQuery_(query);\n        var listener = this.createListenerForView_(view);\n        var events = this.listenProvider_.startListening(SyncTree.queryForListening_(query), tag, listener.hashFn, listener.onComplete);\n        var subtree = this.syncPointTree_.subtree(path);\n        // The root of this subtree has our query. We're here because we definitely need to send a listen for that, but we\n        // may need to shadow other listens as well.\n        if (tag) {\n            util_1.assert(!subtree.value.hasCompleteView(), \"If we're adding a query, it shouldn't be shadowed\");\n        }\n        else {\n            // Shadow everything at or below this location, this is a default listener.\n            var queriesToStop = subtree.fold(function (relativePath, maybeChildSyncPoint, childMap) {\n                if (!relativePath.isEmpty() &&\n                    maybeChildSyncPoint &&\n                    maybeChildSyncPoint.hasCompleteView()) {\n                    return [maybeChildSyncPoint.getCompleteView().getQuery()];\n                }\n                else {\n                    // No default listener here, flatten any deeper queries into an array\n                    var queries_1 = [];\n                    if (maybeChildSyncPoint) {\n                        queries_1 = queries_1.concat(maybeChildSyncPoint.getQueryViews().map(function (view) { return view.getQuery(); }));\n                    }\n                    util_3.forEach(childMap, function (key, childQueries) {\n                        queries_1 = queries_1.concat(childQueries);\n                    });\n                    return queries_1;\n                }\n            });\n            for (var i = 0; i < queriesToStop.length; ++i) {\n                var queryToStop = queriesToStop[i];\n                this.listenProvider_.stopListening(SyncTree.queryForListening_(queryToStop), this.tagForQuery_(queryToStop));\n            }\n        }\n        return events;\n    };\n    /**\n     *\n     * @param {!View} view\n     * @return {{hashFn: function(), onComplete: function(!string, *)}}\n     * @private\n     */\n    SyncTree.prototype.createListenerForView_ = function (view) {\n        var _this = this;\n        var query = view.getQuery();\n        var tag = this.tagForQuery_(query);\n        return {\n            hashFn: function () {\n                var cache = view.getServerCache() || ChildrenNode_1.ChildrenNode.EMPTY_NODE;\n                return cache.hash();\n            },\n            onComplete: function (status) {\n                if (status === 'ok') {\n                    if (tag) {\n                        return _this.applyTaggedListenComplete(query.path, tag);\n                    }\n                    else {\n                        return _this.applyListenComplete(query.path);\n                    }\n                }\n                else {\n                    // If a listen failed, kill all of the listeners here, not just the one that triggered the error.\n                    // Note that this may need to be scoped to just this listener if we change permissions on filtered children\n                    var error = util_2.errorForServerCode(status, query);\n                    return _this.removeEventRegistration(query, \n                    /*eventRegistration*/ null, error);\n                }\n            }\n        };\n    };\n    /**\n     * Given a query, computes a \"queryKey\" suitable for use in our queryToTagMap_.\n     * @private\n     * @param {!Query} query\n     * @return {string}\n     */\n    SyncTree.makeQueryKey_ = function (query) {\n        return query.path.toString() + '$' + query.queryIdentifier();\n    };\n    /**\n     * Given a queryKey (created by makeQueryKey), parse it back into a path and queryId.\n     * @private\n     * @param {!string} queryKey\n     * @return {{queryId: !string, path: !Path}}\n     */\n    SyncTree.parseQueryKey_ = function (queryKey) {\n        var splitIndex = queryKey.indexOf('$');\n        util_1.assert(splitIndex !== -1 && splitIndex < queryKey.length - 1, 'Bad queryKey.');\n        return {\n            queryId: queryKey.substr(splitIndex + 1),\n            path: new Path_1.Path(queryKey.substr(0, splitIndex))\n        };\n    };\n    /**\n     * Return the query associated with the given tag, if we have one\n     * @param {!number} tag\n     * @return {?string}\n     * @private\n     */\n    SyncTree.prototype.queryKeyForTag_ = function (tag) {\n        return this.tagToQueryMap_['_' + tag];\n    };\n    /**\n     * Return the tag associated with the given query.\n     * @param {!Query} query\n     * @return {?number}\n     * @private\n     */\n    SyncTree.prototype.tagForQuery_ = function (query) {\n        var queryKey = SyncTree.makeQueryKey_(query);\n        return util_3.safeGet(this.queryToTagMap_, queryKey);\n    };\n    /**\n     * Static accessor for query tags.\n     * @return {number}\n     * @private\n     */\n    SyncTree.getNextQueryTag_ = function () {\n        return SyncTree.nextQueryTag_++;\n    };\n    /**\n     * A helper method to apply tagged operations\n     *\n     * @param {!Path} queryPath\n     * @param {!Operation} operation\n     * @return {!Array.<!Event>}\n     * @private\n     */\n    SyncTree.prototype.applyTaggedOperation_ = function (queryPath, operation) {\n        var syncPoint = this.syncPointTree_.get(queryPath);\n        util_1.assert(syncPoint, \"Missing sync point for query tag that we're tracking\");\n        var writesCache = this.pendingWriteTree_.childWrites(queryPath);\n        return syncPoint.applyOperation(operation, writesCache, \n        /*serverCache=*/ null);\n    };\n    /**\n     * A helper method that visits all descendant and ancestor SyncPoints, applying the operation.\n     *\n     * NOTES:\n     * - Descendant SyncPoints will be visited first (since we raise events depth-first).\n  \n     * - We call applyOperation() on each SyncPoint passing three things:\n     *   1. A version of the Operation that has been made relative to the SyncPoint location.\n     *   2. A WriteTreeRef of any writes we have cached at the SyncPoint location.\n     *   3. A snapshot Node with cached server data, if we have it.\n  \n     * - We concatenate all of the events returned by each SyncPoint and return the result.\n     *\n     * @param {!Operation} operation\n     * @return {!Array.<!Event>}\n     * @private\n     */\n    SyncTree.prototype.applyOperationToSyncPoints_ = function (operation) {\n        return this.applyOperationHelper_(operation, this.syncPointTree_, \n        /*serverCache=*/ null, this.pendingWriteTree_.childWrites(Path_1.Path.Empty));\n    };\n    /**\n     * Recursive helper for applyOperationToSyncPoints_\n     *\n     * @private\n     * @param {!Operation} operation\n     * @param {ImmutableTree.<!SyncPoint>} syncPointTree\n     * @param {?Node} serverCache\n     * @param {!WriteTreeRef} writesCache\n     * @return {!Array.<!Event>}\n     */\n    SyncTree.prototype.applyOperationHelper_ = function (operation, syncPointTree, serverCache, writesCache) {\n        if (operation.path.isEmpty()) {\n            return this.applyOperationDescendantsHelper_(operation, syncPointTree, serverCache, writesCache);\n        }\n        else {\n            var syncPoint = syncPointTree.get(Path_1.Path.Empty);\n            // If we don't have cached server data, see if we can get it from this SyncPoint.\n            if (serverCache == null && syncPoint != null) {\n                serverCache = syncPoint.getCompleteServerCache(Path_1.Path.Empty);\n            }\n            var events = [];\n            var childName = operation.path.getFront();\n            var childOperation = operation.operationForChild(childName);\n            var childTree = syncPointTree.children.get(childName);\n            if (childTree && childOperation) {\n                var childServerCache = serverCache\n                    ? serverCache.getImmediateChild(childName)\n                    : null;\n                var childWritesCache = writesCache.child(childName);\n                events = events.concat(this.applyOperationHelper_(childOperation, childTree, childServerCache, childWritesCache));\n            }\n            if (syncPoint) {\n                events = events.concat(syncPoint.applyOperation(operation, writesCache, serverCache));\n            }\n            return events;\n        }\n    };\n    /**\n     * Recursive helper for applyOperationToSyncPoints_\n     *\n     * @private\n     * @param {!Operation} operation\n     * @param {ImmutableTree.<!SyncPoint>} syncPointTree\n     * @param {?Node} serverCache\n     * @param {!WriteTreeRef} writesCache\n     * @return {!Array.<!Event>}\n     */\n    SyncTree.prototype.applyOperationDescendantsHelper_ = function (operation, syncPointTree, serverCache, writesCache) {\n        var _this = this;\n        var syncPoint = syncPointTree.get(Path_1.Path.Empty);\n        // If we don't have cached server data, see if we can get it from this SyncPoint.\n        if (serverCache == null && syncPoint != null) {\n            serverCache = syncPoint.getCompleteServerCache(Path_1.Path.Empty);\n        }\n        var events = [];\n        syncPointTree.children.inorderTraversal(function (childName, childTree) {\n            var childServerCache = serverCache\n                ? serverCache.getImmediateChild(childName)\n                : null;\n            var childWritesCache = writesCache.child(childName);\n            var childOperation = operation.operationForChild(childName);\n            if (childOperation) {\n                events = events.concat(_this.applyOperationDescendantsHelper_(childOperation, childTree, childServerCache, childWritesCache));\n            }\n        });\n        if (syncPoint) {\n            events = events.concat(syncPoint.applyOperation(operation, writesCache, serverCache));\n        }\n        return events;\n    };\n    /**\n     * Static tracker for next query tag.\n     * @type {number}\n     * @private\n     */\n    SyncTree.nextQueryTag_ = 1;\n    return SyncTree;\n}());\nexports.SyncTree = SyncTree;\n\n\n\n},{\"./SyncPoint\":24,\"./WriteTree\":26,\"./operation/AckUserWrite\":27,\"./operation/ListenComplete\":28,\"./operation/Merge\":29,\"./operation/Operation\":30,\"./operation/Overwrite\":31,\"./snap/ChildrenNode\":32,\"./util/ImmutableTree\":54,\"./util/Path\":57,\"./util/util\":63,\"@firebase/util\":134}],26:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\nvar util_2 = require(\"@firebase/util\");\nvar Path_1 = require(\"./util/Path\");\nvar CompoundWrite_1 = require(\"./CompoundWrite\");\nvar PriorityIndex_1 = require(\"./snap/indexes/PriorityIndex\");\nvar ChildrenNode_1 = require(\"./snap/ChildrenNode\");\n/**\n * WriteTree tracks all pending user-initiated writes and has methods to calculate the result of merging them\n * with underlying server data (to create \"event cache\" data).  Pending writes are added with addOverwrite()\n * and addMerge(), and removed with removeWrite().\n *\n * @constructor\n */\nvar WriteTree = /** @class */ (function () {\n    function WriteTree() {\n        /**\n         * A tree tracking the result of applying all visible writes.  This does not include transactions with\n         * applyLocally=false or writes that are completely shadowed by other writes.\n         *\n         * @type {!CompoundWrite}\n         * @private\n         */\n        this.visibleWrites_ = CompoundWrite_1.CompoundWrite.Empty;\n        /**\n         * A list of all pending writes, regardless of visibility and shadowed-ness.  Used to calculate arbitrary\n         * sets of the changed data, such as hidden writes (from transactions) or changes with certain writes excluded (also\n         * used by transactions).\n         *\n         * @type {!Array.<!WriteRecord>}\n         * @private\n         */\n        this.allWrites_ = [];\n        this.lastWriteId_ = -1;\n    }\n    /**\n     * Create a new WriteTreeRef for the given path. For use with a new sync point at the given path.\n     *\n     * @param {!Path} path\n     * @return {!WriteTreeRef}\n     */\n    WriteTree.prototype.childWrites = function (path) {\n        return new WriteTreeRef(path, this);\n    };\n    /**\n     * Record a new overwrite from user code.\n     *\n     * @param {!Path} path\n     * @param {!Node} snap\n     * @param {!number} writeId\n     * @param {boolean=} visible This is set to false by some transactions. It should be excluded from event caches\n     */\n    WriteTree.prototype.addOverwrite = function (path, snap, writeId, visible) {\n        util_2.assert(writeId > this.lastWriteId_, 'Stacking an older write on top of newer ones');\n        if (visible === undefined) {\n            visible = true;\n        }\n        this.allWrites_.push({\n            path: path,\n            snap: snap,\n            writeId: writeId,\n            visible: visible\n        });\n        if (visible) {\n            this.visibleWrites_ = this.visibleWrites_.addWrite(path, snap);\n        }\n        this.lastWriteId_ = writeId;\n    };\n    /**\n     * Record a new merge from user code.\n     *\n     * @param {!Path} path\n     * @param {!Object.<string, !Node>} changedChildren\n     * @param {!number} writeId\n     */\n    WriteTree.prototype.addMerge = function (path, changedChildren, writeId) {\n        util_2.assert(writeId > this.lastWriteId_, 'Stacking an older merge on top of newer ones');\n        this.allWrites_.push({\n            path: path,\n            children: changedChildren,\n            writeId: writeId,\n            visible: true\n        });\n        this.visibleWrites_ = this.visibleWrites_.addWrites(path, changedChildren);\n        this.lastWriteId_ = writeId;\n    };\n    /**\n     * @param {!number} writeId\n     * @return {?WriteRecord}\n     */\n    WriteTree.prototype.getWrite = function (writeId) {\n        for (var i = 0; i < this.allWrites_.length; i++) {\n            var record = this.allWrites_[i];\n            if (record.writeId === writeId) {\n                return record;\n            }\n        }\n        return null;\n    };\n    /**\n     * Remove a write (either an overwrite or merge) that has been successfully acknowledge by the server. Recalculates\n     * the tree if necessary.  We return true if it may have been visible, meaning views need to reevaluate.\n     *\n     * @param {!number} writeId\n     * @return {boolean} true if the write may have been visible (meaning we'll need to reevaluate / raise\n     * events as a result).\n     */\n    WriteTree.prototype.removeWrite = function (writeId) {\n        // Note: disabling this check. It could be a transaction that preempted another transaction, and thus was applied\n        // out of order.\n        //const validClear = revert || this.allWrites_.length === 0 || writeId <= this.allWrites_[0].writeId;\n        //assert(validClear, \"Either we don't have this write, or it's the first one in the queue\");\n        var _this = this;\n        var idx = this.allWrites_.findIndex(function (s) {\n            return s.writeId === writeId;\n        });\n        util_2.assert(idx >= 0, 'removeWrite called with nonexistent writeId.');\n        var writeToRemove = this.allWrites_[idx];\n        this.allWrites_.splice(idx, 1);\n        var removedWriteWasVisible = writeToRemove.visible;\n        var removedWriteOverlapsWithOtherWrites = false;\n        var i = this.allWrites_.length - 1;\n        while (removedWriteWasVisible && i >= 0) {\n            var currentWrite = this.allWrites_[i];\n            if (currentWrite.visible) {\n                if (i >= idx &&\n                    this.recordContainsPath_(currentWrite, writeToRemove.path)) {\n                    // The removed write was completely shadowed by a subsequent write.\n                    removedWriteWasVisible = false;\n                }\n                else if (writeToRemove.path.contains(currentWrite.path)) {\n                    // Either we're covering some writes or they're covering part of us (depending on which came first).\n                    removedWriteOverlapsWithOtherWrites = true;\n                }\n            }\n            i--;\n        }\n        if (!removedWriteWasVisible) {\n            return false;\n        }\n        else if (removedWriteOverlapsWithOtherWrites) {\n            // There's some shadowing going on. Just rebuild the visible writes from scratch.\n            this.resetTree_();\n            return true;\n        }\n        else {\n            // There's no shadowing.  We can safely just remove the write(s) from visibleWrites.\n            if (writeToRemove.snap) {\n                this.visibleWrites_ = this.visibleWrites_.removeWrite(writeToRemove.path);\n            }\n            else {\n                var children = writeToRemove.children;\n                util_1.forEach(children, function (childName) {\n                    _this.visibleWrites_ = _this.visibleWrites_.removeWrite(writeToRemove.path.child(childName));\n                });\n            }\n            return true;\n        }\n    };\n    /**\n     * Return a complete snapshot for the given path if there's visible write data at that path, else null.\n     * No server data is considered.\n     *\n     * @param {!Path} path\n     * @return {?Node}\n     */\n    WriteTree.prototype.getCompleteWriteData = function (path) {\n        return this.visibleWrites_.getCompleteNode(path);\n    };\n    /**\n     * Given optional, underlying server data, and an optional set of constraints (exclude some sets, include hidden\n     * writes), attempt to calculate a complete snapshot for the given path\n     *\n     * @param {!Path} treePath\n     * @param {?Node} completeServerCache\n     * @param {Array.<number>=} writeIdsToExclude An optional set to be excluded\n     * @param {boolean=} includeHiddenWrites Defaults to false, whether or not to layer on writes with visible set to false\n     * @return {?Node}\n     */\n    WriteTree.prototype.calcCompleteEventCache = function (treePath, completeServerCache, writeIdsToExclude, includeHiddenWrites) {\n        if (!writeIdsToExclude && !includeHiddenWrites) {\n            var shadowingNode = this.visibleWrites_.getCompleteNode(treePath);\n            if (shadowingNode != null) {\n                return shadowingNode;\n            }\n            else {\n                var subMerge = this.visibleWrites_.childCompoundWrite(treePath);\n                if (subMerge.isEmpty()) {\n                    return completeServerCache;\n                }\n                else if (completeServerCache == null &&\n                    !subMerge.hasCompleteWrite(Path_1.Path.Empty)) {\n                    // We wouldn't have a complete snapshot, since there's no underlying data and no complete shadow\n                    return null;\n                }\n                else {\n                    var layeredCache = completeServerCache || ChildrenNode_1.ChildrenNode.EMPTY_NODE;\n                    return subMerge.apply(layeredCache);\n                }\n            }\n        }\n        else {\n            var merge = this.visibleWrites_.childCompoundWrite(treePath);\n            if (!includeHiddenWrites && merge.isEmpty()) {\n                return completeServerCache;\n            }\n            else {\n                // If the server cache is null, and we don't have a complete cache, we need to return null\n                if (!includeHiddenWrites &&\n                    completeServerCache == null &&\n                    !merge.hasCompleteWrite(Path_1.Path.Empty)) {\n                    return null;\n                }\n                else {\n                    var filter = function (write) {\n                        return ((write.visible || includeHiddenWrites) &&\n                            (!writeIdsToExclude ||\n                                !~writeIdsToExclude.indexOf(write.writeId)) &&\n                            (write.path.contains(treePath) || treePath.contains(write.path)));\n                    };\n                    var mergeAtPath = WriteTree.layerTree_(this.allWrites_, filter, treePath);\n                    var layeredCache = completeServerCache || ChildrenNode_1.ChildrenNode.EMPTY_NODE;\n                    return mergeAtPath.apply(layeredCache);\n                }\n            }\n        }\n    };\n    /**\n     * With optional, underlying server data, attempt to return a children node of children that we have complete data for.\n     * Used when creating new views, to pre-fill their complete event children snapshot.\n     *\n     * @param {!Path} treePath\n     * @param {?ChildrenNode} completeServerChildren\n     * @return {!ChildrenNode}\n     */\n    WriteTree.prototype.calcCompleteEventChildren = function (treePath, completeServerChildren) {\n        var completeChildren = ChildrenNode_1.ChildrenNode.EMPTY_NODE;\n        var topLevelSet = this.visibleWrites_.getCompleteNode(treePath);\n        if (topLevelSet) {\n            if (!topLevelSet.isLeafNode()) {\n                // we're shadowing everything. Return the children.\n                topLevelSet.forEachChild(PriorityIndex_1.PRIORITY_INDEX, function (childName, childSnap) {\n                    completeChildren = completeChildren.updateImmediateChild(childName, childSnap);\n                });\n            }\n            return completeChildren;\n        }\n        else if (completeServerChildren) {\n            // Layer any children we have on top of this\n            // We know we don't have a top-level set, so just enumerate existing children\n            var merge_1 = this.visibleWrites_.childCompoundWrite(treePath);\n            completeServerChildren.forEachChild(PriorityIndex_1.PRIORITY_INDEX, function (childName, childNode) {\n                var node = merge_1\n                    .childCompoundWrite(new Path_1.Path(childName))\n                    .apply(childNode);\n                completeChildren = completeChildren.updateImmediateChild(childName, node);\n            });\n            // Add any complete children we have from the set\n            merge_1.getCompleteChildren().forEach(function (namedNode) {\n                completeChildren = completeChildren.updateImmediateChild(namedNode.name, namedNode.node);\n            });\n            return completeChildren;\n        }\n        else {\n            // We don't have anything to layer on top of. Layer on any children we have\n            // Note that we can return an empty snap if we have a defined delete\n            var merge = this.visibleWrites_.childCompoundWrite(treePath);\n            merge.getCompleteChildren().forEach(function (namedNode) {\n                completeChildren = completeChildren.updateImmediateChild(namedNode.name, namedNode.node);\n            });\n            return completeChildren;\n        }\n    };\n    /**\n     * Given that the underlying server data has updated, determine what, if anything, needs to be\n     * applied to the event cache.\n     *\n     * Possibilities:\n     *\n     * 1. No writes are shadowing. Events should be raised, the snap to be applied comes from the server data\n     *\n     * 2. Some write is completely shadowing. No events to be raised\n     *\n     * 3. Is partially shadowed. Events\n     *\n     * Either existingEventSnap or existingServerSnap must exist\n     *\n     * @param {!Path} treePath\n     * @param {!Path} childPath\n     * @param {?Node} existingEventSnap\n     * @param {?Node} existingServerSnap\n     * @return {?Node}\n     */\n    WriteTree.prototype.calcEventCacheAfterServerOverwrite = function (treePath, childPath, existingEventSnap, existingServerSnap) {\n        util_2.assert(existingEventSnap || existingServerSnap, 'Either existingEventSnap or existingServerSnap must exist');\n        var path = treePath.child(childPath);\n        if (this.visibleWrites_.hasCompleteWrite(path)) {\n            // At this point we can probably guarantee that we're in case 2, meaning no events\n            // May need to check visibility while doing the findRootMostValueAndPath call\n            return null;\n        }\n        else {\n            // No complete shadowing. We're either partially shadowing or not shadowing at all.\n            var childMerge = this.visibleWrites_.childCompoundWrite(path);\n            if (childMerge.isEmpty()) {\n                // We're not shadowing at all. Case 1\n                return existingServerSnap.getChild(childPath);\n            }\n            else {\n                // This could be more efficient if the serverNode + updates doesn't change the eventSnap\n                // However this is tricky to find out, since user updates don't necessary change the server\n                // snap, e.g. priority updates on empty nodes, or deep deletes. Another special case is if the server\n                // adds nodes, but doesn't change any existing writes. It is therefore not enough to\n                // only check if the updates change the serverNode.\n                // Maybe check if the merge tree contains these special cases and only do a full overwrite in that case?\n                return childMerge.apply(existingServerSnap.getChild(childPath));\n            }\n        }\n    };\n    /**\n     * Returns a complete child for a given server snap after applying all user writes or null if there is no\n     * complete child for this ChildKey.\n     *\n     * @param {!Path} treePath\n     * @param {!string} childKey\n     * @param {!CacheNode} existingServerSnap\n     * @return {?Node}\n     */\n    WriteTree.prototype.calcCompleteChild = function (treePath, childKey, existingServerSnap) {\n        var path = treePath.child(childKey);\n        var shadowingNode = this.visibleWrites_.getCompleteNode(path);\n        if (shadowingNode != null) {\n            return shadowingNode;\n        }\n        else {\n            if (existingServerSnap.isCompleteForChild(childKey)) {\n                var childMerge = this.visibleWrites_.childCompoundWrite(path);\n                return childMerge.apply(existingServerSnap.getNode().getImmediateChild(childKey));\n            }\n            else {\n                return null;\n            }\n        }\n    };\n    /**\n     * Returns a node if there is a complete overwrite for this path. More specifically, if there is a write at\n     * a higher path, this will return the child of that write relative to the write and this path.\n     * Returns null if there is no write at this path.\n     *\n     * @param {!Path} path\n     * @return {?Node}\n     */\n    WriteTree.prototype.shadowingWrite = function (path) {\n        return this.visibleWrites_.getCompleteNode(path);\n    };\n    /**\n     * This method is used when processing child remove events on a query. If we can, we pull in children that were outside\n     * the window, but may now be in the window.\n     *\n     * @param {!Path} treePath\n     * @param {?Node} completeServerData\n     * @param {!NamedNode} startPost\n     * @param {!number} count\n     * @param {boolean} reverse\n     * @param {!Index} index\n     * @return {!Array.<!NamedNode>}\n     */\n    WriteTree.prototype.calcIndexedSlice = function (treePath, completeServerData, startPost, count, reverse, index) {\n        var toIterate;\n        var merge = this.visibleWrites_.childCompoundWrite(treePath);\n        var shadowingNode = merge.getCompleteNode(Path_1.Path.Empty);\n        if (shadowingNode != null) {\n            toIterate = shadowingNode;\n        }\n        else if (completeServerData != null) {\n            toIterate = merge.apply(completeServerData);\n        }\n        else {\n            // no children to iterate on\n            return [];\n        }\n        toIterate = toIterate.withIndex(index);\n        if (!toIterate.isEmpty() && !toIterate.isLeafNode()) {\n            var nodes = [];\n            var cmp = index.getCompare();\n            var iter = reverse\n                ? toIterate.getReverseIteratorFrom(startPost, index)\n                : toIterate.getIteratorFrom(startPost, index);\n            var next = iter.getNext();\n            while (next && nodes.length < count) {\n                if (cmp(next, startPost) !== 0) {\n                    nodes.push(next);\n                }\n                next = iter.getNext();\n            }\n            return nodes;\n        }\n        else {\n            return [];\n        }\n    };\n    /**\n     * @param {!WriteRecord} writeRecord\n     * @param {!Path} path\n     * @return {boolean}\n     * @private\n     */\n    WriteTree.prototype.recordContainsPath_ = function (writeRecord, path) {\n        if (writeRecord.snap) {\n            return writeRecord.path.contains(path);\n        }\n        else {\n            // findKey can return undefined, so use !! to coerce to boolean\n            return !!util_1.findKey(writeRecord.children, function (childSnap, childName) {\n                return writeRecord.path.child(childName).contains(path);\n            });\n        }\n    };\n    /**\n     * Re-layer the writes and merges into a tree so we can efficiently calculate event snapshots\n     * @private\n     */\n    WriteTree.prototype.resetTree_ = function () {\n        this.visibleWrites_ = WriteTree.layerTree_(this.allWrites_, WriteTree.DefaultFilter_, Path_1.Path.Empty);\n        if (this.allWrites_.length > 0) {\n            this.lastWriteId_ = this.allWrites_[this.allWrites_.length - 1].writeId;\n        }\n        else {\n            this.lastWriteId_ = -1;\n        }\n    };\n    /**\n     * The default filter used when constructing the tree. Keep everything that's visible.\n     *\n     * @param {!WriteRecord} write\n     * @return {boolean}\n     * @private\n     */\n    WriteTree.DefaultFilter_ = function (write) {\n        return write.visible;\n    };\n    /**\n     * Static method. Given an array of WriteRecords, a filter for which ones to include, and a path, construct the tree of\n     * event data at that path.\n     *\n     * @param {!Array.<!WriteRecord>} writes\n     * @param {!function(!WriteRecord):boolean} filter\n     * @param {!Path} treeRoot\n     * @return {!CompoundWrite}\n     * @private\n     */\n    WriteTree.layerTree_ = function (writes, filter, treeRoot) {\n        var compoundWrite = CompoundWrite_1.CompoundWrite.Empty;\n        for (var i = 0; i < writes.length; ++i) {\n            var write = writes[i];\n            // Theory, a later set will either:\n            // a) abort a relevant transaction, so no need to worry about excluding it from calculating that transaction\n            // b) not be relevant to a transaction (separate branch), so again will not affect the data for that transaction\n            if (filter(write)) {\n                var writePath = write.path;\n                var relativePath = void 0;\n                if (write.snap) {\n                    if (treeRoot.contains(writePath)) {\n                        relativePath = Path_1.Path.relativePath(treeRoot, writePath);\n                        compoundWrite = compoundWrite.addWrite(relativePath, write.snap);\n                    }\n                    else if (writePath.contains(treeRoot)) {\n                        relativePath = Path_1.Path.relativePath(writePath, treeRoot);\n                        compoundWrite = compoundWrite.addWrite(Path_1.Path.Empty, write.snap.getChild(relativePath));\n                    }\n                    else {\n                        // There is no overlap between root path and write path, ignore write\n                    }\n                }\n                else if (write.children) {\n                    if (treeRoot.contains(writePath)) {\n                        relativePath = Path_1.Path.relativePath(treeRoot, writePath);\n                        compoundWrite = compoundWrite.addWrites(relativePath, write.children);\n                    }\n                    else if (writePath.contains(treeRoot)) {\n                        relativePath = Path_1.Path.relativePath(writePath, treeRoot);\n                        if (relativePath.isEmpty()) {\n                            compoundWrite = compoundWrite.addWrites(Path_1.Path.Empty, write.children);\n                        }\n                        else {\n                            var child = util_1.safeGet(write.children, relativePath.getFront());\n                            if (child) {\n                                // There exists a child in this node that matches the root path\n                                var deepNode = child.getChild(relativePath.popFront());\n                                compoundWrite = compoundWrite.addWrite(Path_1.Path.Empty, deepNode);\n                            }\n                        }\n                    }\n                    else {\n                        // There is no overlap between root path and write path, ignore write\n                    }\n                }\n                else {\n                    throw util_2.assertionError('WriteRecord should have .snap or .children');\n                }\n            }\n        }\n        return compoundWrite;\n    };\n    return WriteTree;\n}());\nexports.WriteTree = WriteTree;\n/**\n * A WriteTreeRef wraps a WriteTree and a path, for convenient access to a particular subtree.  All of the methods\n * just proxy to the underlying WriteTree.\n *\n * @constructor\n */\nvar WriteTreeRef = /** @class */ (function () {\n    /**\n     * @param {!Path} path\n     * @param {!WriteTree} writeTree\n     */\n    function WriteTreeRef(path, writeTree) {\n        this.treePath_ = path;\n        this.writeTree_ = writeTree;\n    }\n    /**\n     * If possible, returns a complete event cache, using the underlying server data if possible. In addition, can be used\n     * to get a cache that includes hidden writes, and excludes arbitrary writes. Note that customizing the returned node\n     * can lead to a more expensive calculation.\n     *\n     * @param {?Node} completeServerCache\n     * @param {Array.<number>=} writeIdsToExclude Optional writes to exclude.\n     * @param {boolean=} includeHiddenWrites Defaults to false, whether or not to layer on writes with visible set to false\n     * @return {?Node}\n     */\n    WriteTreeRef.prototype.calcCompleteEventCache = function (completeServerCache, writeIdsToExclude, includeHiddenWrites) {\n        return this.writeTree_.calcCompleteEventCache(this.treePath_, completeServerCache, writeIdsToExclude, includeHiddenWrites);\n    };\n    /**\n     * If possible, returns a children node containing all of the complete children we have data for. The returned data is a\n     * mix of the given server data and write data.\n     *\n     * @param {?ChildrenNode} completeServerChildren\n     * @return {!ChildrenNode}\n     */\n    WriteTreeRef.prototype.calcCompleteEventChildren = function (completeServerChildren) {\n        return this.writeTree_.calcCompleteEventChildren(this.treePath_, completeServerChildren);\n    };\n    /**\n     * Given that either the underlying server data has updated or the outstanding writes have updated, determine what,\n     * if anything, needs to be applied to the event cache.\n     *\n     * Possibilities:\n     *\n     * 1. No writes are shadowing. Events should be raised, the snap to be applied comes from the server data\n     *\n     * 2. Some write is completely shadowing. No events to be raised\n     *\n     * 3. Is partially shadowed. Events should be raised\n     *\n     * Either existingEventSnap or existingServerSnap must exist, this is validated via an assert\n     *\n     * @param {!Path} path\n     * @param {?Node} existingEventSnap\n     * @param {?Node} existingServerSnap\n     * @return {?Node}\n     */\n    WriteTreeRef.prototype.calcEventCacheAfterServerOverwrite = function (path, existingEventSnap, existingServerSnap) {\n        return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_, path, existingEventSnap, existingServerSnap);\n    };\n    /**\n     * Returns a node if there is a complete overwrite for this path. More specifically, if there is a write at\n     * a higher path, this will return the child of that write relative to the write and this path.\n     * Returns null if there is no write at this path.\n     *\n     * @param {!Path} path\n     * @return {?Node}\n     */\n    WriteTreeRef.prototype.shadowingWrite = function (path) {\n        return this.writeTree_.shadowingWrite(this.treePath_.child(path));\n    };\n    /**\n     * This method is used when processing child remove events on a query. If we can, we pull in children that were outside\n     * the window, but may now be in the window\n     *\n     * @param {?Node} completeServerData\n     * @param {!NamedNode} startPost\n     * @param {!number} count\n     * @param {boolean} reverse\n     * @param {!Index} index\n     * @return {!Array.<!NamedNode>}\n     */\n    WriteTreeRef.prototype.calcIndexedSlice = function (completeServerData, startPost, count, reverse, index) {\n        return this.writeTree_.calcIndexedSlice(this.treePath_, completeServerData, startPost, count, reverse, index);\n    };\n    /**\n     * Returns a complete child for a given server snap after applying all user writes or null if there is no\n     * complete child for this ChildKey.\n     *\n     * @param {!string} childKey\n     * @param {!CacheNode} existingServerCache\n     * @return {?Node}\n     */\n    WriteTreeRef.prototype.calcCompleteChild = function (childKey, existingServerCache) {\n        return this.writeTree_.calcCompleteChild(this.treePath_, childKey, existingServerCache);\n    };\n    /**\n     * Return a WriteTreeRef for a child.\n     *\n     * @param {string} childName\n     * @return {!WriteTreeRef}\n     */\n    WriteTreeRef.prototype.child = function (childName) {\n        return new WriteTreeRef(this.treePath_.child(childName), this.writeTree_);\n    };\n    return WriteTreeRef;\n}());\nexports.WriteTreeRef = WriteTreeRef;\n\n\n\n},{\"./CompoundWrite\":14,\"./snap/ChildrenNode\":32,\"./snap/indexes/PriorityIndex\":41,\"./util/Path\":57,\"@firebase/util\":134}],27:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\nvar Path_1 = require(\"../util/Path\");\nvar Operation_1 = require(\"./Operation\");\nvar AckUserWrite = /** @class */ (function () {\n    /**\n     *\n     * @param {!Path} path\n     * @param {!ImmutableTree<!boolean>} affectedTree A tree containing true for each affected path. Affected paths can't overlap.\n     * @param {!boolean} revert\n     */\n    function AckUserWrite(\n        /**@inheritDoc */ path, \n        /**@inheritDoc */ affectedTree, \n        /**@inheritDoc */ revert) {\n        this.path = path;\n        this.affectedTree = affectedTree;\n        this.revert = revert;\n        /** @inheritDoc */\n        this.type = Operation_1.OperationType.ACK_USER_WRITE;\n        /** @inheritDoc */\n        this.source = Operation_1.OperationSource.User;\n    }\n    /**\n     * @inheritDoc\n     */\n    AckUserWrite.prototype.operationForChild = function (childName) {\n        if (!this.path.isEmpty()) {\n            util_1.assert(this.path.getFront() === childName, 'operationForChild called for unrelated child.');\n            return new AckUserWrite(this.path.popFront(), this.affectedTree, this.revert);\n        }\n        else if (this.affectedTree.value != null) {\n            util_1.assert(this.affectedTree.children.isEmpty(), 'affectedTree should not have overlapping affected paths.');\n            // All child locations are affected as well; just return same operation.\n            return this;\n        }\n        else {\n            var childTree = this.affectedTree.subtree(new Path_1.Path(childName));\n            return new AckUserWrite(Path_1.Path.Empty, childTree, this.revert);\n        }\n    };\n    return AckUserWrite;\n}());\nexports.AckUserWrite = AckUserWrite;\n\n\n\n},{\"../util/Path\":57,\"./Operation\":30,\"@firebase/util\":134}],28:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Path_1 = require(\"../util/Path\");\nvar Operation_1 = require(\"./Operation\");\n/**\n * @param {!OperationSource} source\n * @param {!Path} path\n * @constructor\n * @implements {Operation}\n */\nvar ListenComplete = /** @class */ (function () {\n    function ListenComplete(source, path) {\n        this.source = source;\n        this.path = path;\n        /** @inheritDoc */\n        this.type = Operation_1.OperationType.LISTEN_COMPLETE;\n    }\n    ListenComplete.prototype.operationForChild = function (childName) {\n        if (this.path.isEmpty()) {\n            return new ListenComplete(this.source, Path_1.Path.Empty);\n        }\n        else {\n            return new ListenComplete(this.source, this.path.popFront());\n        }\n    };\n    return ListenComplete;\n}());\nexports.ListenComplete = ListenComplete;\n\n\n\n},{\"../util/Path\":57,\"./Operation\":30}],29:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Operation_1 = require(\"./Operation\");\nvar Overwrite_1 = require(\"./Overwrite\");\nvar Path_1 = require(\"../util/Path\");\nvar util_1 = require(\"@firebase/util\");\n/**\n * @param {!OperationSource} source\n * @param {!Path} path\n * @param {!ImmutableTree.<!Node>} children\n * @constructor\n * @implements {Operation}\n */\nvar Merge = /** @class */ (function () {\n    function Merge(\n        /**@inheritDoc */ source, \n        /**@inheritDoc */ path, \n        /**@inheritDoc */ children) {\n        this.source = source;\n        this.path = path;\n        this.children = children;\n        /** @inheritDoc */\n        this.type = Operation_1.OperationType.MERGE;\n    }\n    /**\n     * @inheritDoc\n     */\n    Merge.prototype.operationForChild = function (childName) {\n        if (this.path.isEmpty()) {\n            var childTree = this.children.subtree(new Path_1.Path(childName));\n            if (childTree.isEmpty()) {\n                // This child is unaffected\n                return null;\n            }\n            else if (childTree.value) {\n                // We have a snapshot for the child in question.  This becomes an overwrite of the child.\n                return new Overwrite_1.Overwrite(this.source, Path_1.Path.Empty, childTree.value);\n            }\n            else {\n                // This is a merge at a deeper level\n                return new Merge(this.source, Path_1.Path.Empty, childTree);\n            }\n        }\n        else {\n            util_1.assert(this.path.getFront() === childName, \"Can't get a merge for a child not on the path of the operation\");\n            return new Merge(this.source, this.path.popFront(), this.children);\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    Merge.prototype.toString = function () {\n        return ('Operation(' +\n            this.path +\n            ': ' +\n            this.source.toString() +\n            ' merge: ' +\n            this.children.toString() +\n            ')');\n    };\n    return Merge;\n}());\nexports.Merge = Merge;\n\n\n\n},{\"../util/Path\":57,\"./Operation\":30,\"./Overwrite\":31,\"@firebase/util\":134}],30:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\n/**\n *\n * @enum\n */\nvar OperationType;\n(function (OperationType) {\n    OperationType[OperationType[\"OVERWRITE\"] = 0] = \"OVERWRITE\";\n    OperationType[OperationType[\"MERGE\"] = 1] = \"MERGE\";\n    OperationType[OperationType[\"ACK_USER_WRITE\"] = 2] = \"ACK_USER_WRITE\";\n    OperationType[OperationType[\"LISTEN_COMPLETE\"] = 3] = \"LISTEN_COMPLETE\";\n})(OperationType = exports.OperationType || (exports.OperationType = {}));\n/**\n * @param {boolean} fromUser\n * @param {boolean} fromServer\n * @param {?string} queryId\n * @param {boolean} tagged\n * @constructor\n */\nvar OperationSource = /** @class */ (function () {\n    function OperationSource(fromUser, fromServer, queryId, tagged) {\n        this.fromUser = fromUser;\n        this.fromServer = fromServer;\n        this.queryId = queryId;\n        this.tagged = tagged;\n        util_1.assert(!tagged || fromServer, 'Tagged queries must be from server.');\n    }\n    /**\n     * @const\n     * @type {!OperationSource}\n     */\n    OperationSource.User = new OperationSource(\n    /*fromUser=*/ true, false, null, \n    /*tagged=*/ false);\n    /**\n     * @const\n     * @type {!OperationSource}\n     */\n    OperationSource.Server = new OperationSource(false, \n    /*fromServer=*/ true, null, \n    /*tagged=*/ false);\n    /**\n     * @param {string} queryId\n     * @return {!OperationSource}\n     */\n    OperationSource.forServerTaggedQuery = function (queryId) {\n        return new OperationSource(false, \n        /*fromServer=*/ true, queryId, \n        /*tagged=*/ true);\n    };\n    return OperationSource;\n}());\nexports.OperationSource = OperationSource;\n\n\n\n},{\"@firebase/util\":134}],31:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Operation_1 = require(\"./Operation\");\nvar Path_1 = require(\"../util/Path\");\n/**\n * @param {!OperationSource} source\n * @param {!Path} path\n * @param {!Node} snap\n * @constructor\n * @implements {Operation}\n */\nvar Overwrite = /** @class */ (function () {\n    function Overwrite(source, path, snap) {\n        this.source = source;\n        this.path = path;\n        this.snap = snap;\n        /** @inheritDoc */\n        this.type = Operation_1.OperationType.OVERWRITE;\n    }\n    Overwrite.prototype.operationForChild = function (childName) {\n        if (this.path.isEmpty()) {\n            return new Overwrite(this.source, Path_1.Path.Empty, this.snap.getImmediateChild(childName));\n        }\n        else {\n            return new Overwrite(this.source, this.path.popFront(), this.snap);\n        }\n    };\n    return Overwrite;\n}());\nexports.Overwrite = Overwrite;\n\n\n\n},{\"../util/Path\":57,\"./Operation\":30}],32:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\nvar util_2 = require(\"../util/util\");\nvar SortedMap_1 = require(\"../util/SortedMap\");\nvar Node_1 = require(\"./Node\");\nvar snap_1 = require(\"./snap\");\nvar PriorityIndex_1 = require(\"./indexes/PriorityIndex\");\nvar KeyIndex_1 = require(\"./indexes/KeyIndex\");\nvar IndexMap_1 = require(\"./IndexMap\");\nvar LeafNode_1 = require(\"./LeafNode\");\nvar comparators_1 = require(\"./comparators\");\n// TODO: For memory savings, don't store priorityNode_ if it's empty.\nvar EMPTY_NODE;\n/**\n * ChildrenNode is a class for storing internal nodes in a DataSnapshot\n * (i.e. nodes with children).  It implements Node and stores the\n * list of children in the children property, sorted by child name.\n *\n * @constructor\n * @implements {Node}\n */\nvar ChildrenNode = /** @class */ (function () {\n    /**\n     *\n     * @param {!SortedMap.<string, !Node>} children_ List of children\n     * of this node..\n     * @param {?Node} priorityNode_ The priority of this node (as a snapshot node).\n     * @param {!IndexMap} indexMap_\n     */\n    function ChildrenNode(children_, priorityNode_, indexMap_) {\n        this.children_ = children_;\n        this.priorityNode_ = priorityNode_;\n        this.indexMap_ = indexMap_;\n        this.lazyHash_ = null;\n        /**\n         * Note: The only reason we allow null priority is for EMPTY_NODE, since we can't use\n         * EMPTY_NODE as the priority of EMPTY_NODE.  We might want to consider making EMPTY_NODE its own\n         * class instead of an empty ChildrenNode.\n         */\n        if (this.priorityNode_) {\n            snap_1.validatePriorityNode(this.priorityNode_);\n        }\n        if (this.children_.isEmpty()) {\n            util_1.assert(!this.priorityNode_ || this.priorityNode_.isEmpty(), 'An empty node cannot have a priority');\n        }\n    }\n    Object.defineProperty(ChildrenNode, \"EMPTY_NODE\", {\n        get: function () {\n            return (EMPTY_NODE ||\n                (EMPTY_NODE = new ChildrenNode(new SortedMap_1.SortedMap(comparators_1.NAME_COMPARATOR), null, IndexMap_1.IndexMap.Default)));\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /** @inheritDoc */\n    ChildrenNode.prototype.isLeafNode = function () {\n        return false;\n    };\n    /** @inheritDoc */\n    ChildrenNode.prototype.getPriority = function () {\n        return this.priorityNode_ || EMPTY_NODE;\n    };\n    /** @inheritDoc */\n    ChildrenNode.prototype.updatePriority = function (newPriorityNode) {\n        if (this.children_.isEmpty()) {\n            // Don't allow priorities on empty nodes\n            return this;\n        }\n        else {\n            return new ChildrenNode(this.children_, newPriorityNode, this.indexMap_);\n        }\n    };\n    /** @inheritDoc */\n    ChildrenNode.prototype.getImmediateChild = function (childName) {\n        // Hack to treat priority as a regular child\n        if (childName === '.priority') {\n            return this.getPriority();\n        }\n        else {\n            var child = this.children_.get(childName);\n            return child === null ? EMPTY_NODE : child;\n        }\n    };\n    /** @inheritDoc */\n    ChildrenNode.prototype.getChild = function (path) {\n        var front = path.getFront();\n        if (front === null)\n            return this;\n        return this.getImmediateChild(front).getChild(path.popFront());\n    };\n    /** @inheritDoc */\n    ChildrenNode.prototype.hasChild = function (childName) {\n        return this.children_.get(childName) !== null;\n    };\n    /** @inheritDoc */\n    ChildrenNode.prototype.updateImmediateChild = function (childName, newChildNode) {\n        util_1.assert(newChildNode, 'We should always be passing snapshot nodes');\n        if (childName === '.priority') {\n            return this.updatePriority(newChildNode);\n        }\n        else {\n            var namedNode = new Node_1.NamedNode(childName, newChildNode);\n            var newChildren = void 0, newIndexMap = void 0, newPriority = void 0;\n            if (newChildNode.isEmpty()) {\n                newChildren = this.children_.remove(childName);\n                newIndexMap = this.indexMap_.removeFromIndexes(namedNode, this.children_);\n            }\n            else {\n                newChildren = this.children_.insert(childName, newChildNode);\n                newIndexMap = this.indexMap_.addToIndexes(namedNode, this.children_);\n            }\n            newPriority = newChildren.isEmpty() ? EMPTY_NODE : this.priorityNode_;\n            return new ChildrenNode(newChildren, newPriority, newIndexMap);\n        }\n    };\n    /** @inheritDoc */\n    ChildrenNode.prototype.updateChild = function (path, newChildNode) {\n        var front = path.getFront();\n        if (front === null) {\n            return newChildNode;\n        }\n        else {\n            util_1.assert(path.getFront() !== '.priority' || path.getLength() === 1, '.priority must be the last token in a path');\n            var newImmediateChild = this.getImmediateChild(front).updateChild(path.popFront(), newChildNode);\n            return this.updateImmediateChild(front, newImmediateChild);\n        }\n    };\n    /** @inheritDoc */\n    ChildrenNode.prototype.isEmpty = function () {\n        return this.children_.isEmpty();\n    };\n    /** @inheritDoc */\n    ChildrenNode.prototype.numChildren = function () {\n        return this.children_.count();\n    };\n    /** @inheritDoc */\n    ChildrenNode.prototype.val = function (exportFormat) {\n        if (this.isEmpty())\n            return null;\n        var obj = {};\n        var numKeys = 0, maxKey = 0, allIntegerKeys = true;\n        this.forEachChild(PriorityIndex_1.PRIORITY_INDEX, function (key, childNode) {\n            obj[key] = childNode.val(exportFormat);\n            numKeys++;\n            if (allIntegerKeys && ChildrenNode.INTEGER_REGEXP_.test(key)) {\n                maxKey = Math.max(maxKey, Number(key));\n            }\n            else {\n                allIntegerKeys = false;\n            }\n        });\n        if (!exportFormat && allIntegerKeys && maxKey < 2 * numKeys) {\n            // convert to array.\n            var array = [];\n            for (var key in obj)\n                array[key] = obj[key];\n            return array;\n        }\n        else {\n            if (exportFormat && !this.getPriority().isEmpty()) {\n                obj['.priority'] = this.getPriority().val();\n            }\n            return obj;\n        }\n    };\n    /** @inheritDoc */\n    ChildrenNode.prototype.hash = function () {\n        if (this.lazyHash_ === null) {\n            var toHash_1 = '';\n            if (!this.getPriority().isEmpty())\n                toHash_1 +=\n                    'priority:' +\n                        snap_1.priorityHashText(this.getPriority().val()) +\n                        ':';\n            this.forEachChild(PriorityIndex_1.PRIORITY_INDEX, function (key, childNode) {\n                var childHash = childNode.hash();\n                if (childHash !== '')\n                    toHash_1 += ':' + key + ':' + childHash;\n            });\n            this.lazyHash_ = toHash_1 === '' ? '' : util_2.sha1(toHash_1);\n        }\n        return this.lazyHash_;\n    };\n    /** @inheritDoc */\n    ChildrenNode.prototype.getPredecessorChildName = function (childName, childNode, index) {\n        var idx = this.resolveIndex_(index);\n        if (idx) {\n            var predecessor = idx.getPredecessorKey(new Node_1.NamedNode(childName, childNode));\n            return predecessor ? predecessor.name : null;\n        }\n        else {\n            return this.children_.getPredecessorKey(childName);\n        }\n    };\n    /**\n     * @param {!Index} indexDefinition\n     * @return {?string}\n     */\n    ChildrenNode.prototype.getFirstChildName = function (indexDefinition) {\n        var idx = this.resolveIndex_(indexDefinition);\n        if (idx) {\n            var minKey = idx.minKey();\n            return minKey && minKey.name;\n        }\n        else {\n            return this.children_.minKey();\n        }\n    };\n    /**\n     * @param {!Index} indexDefinition\n     * @return {?NamedNode}\n     */\n    ChildrenNode.prototype.getFirstChild = function (indexDefinition) {\n        var minKey = this.getFirstChildName(indexDefinition);\n        if (minKey) {\n            return new Node_1.NamedNode(minKey, this.children_.get(minKey));\n        }\n        else {\n            return null;\n        }\n    };\n    /**\n     * Given an index, return the key name of the largest value we have, according to that index\n     * @param {!Index} indexDefinition\n     * @return {?string}\n     */\n    ChildrenNode.prototype.getLastChildName = function (indexDefinition) {\n        var idx = this.resolveIndex_(indexDefinition);\n        if (idx) {\n            var maxKey = idx.maxKey();\n            return maxKey && maxKey.name;\n        }\n        else {\n            return this.children_.maxKey();\n        }\n    };\n    /**\n     * @param {!Index} indexDefinition\n     * @return {?NamedNode}\n     */\n    ChildrenNode.prototype.getLastChild = function (indexDefinition) {\n        var maxKey = this.getLastChildName(indexDefinition);\n        if (maxKey) {\n            return new Node_1.NamedNode(maxKey, this.children_.get(maxKey));\n        }\n        else {\n            return null;\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    ChildrenNode.prototype.forEachChild = function (index, action) {\n        var idx = this.resolveIndex_(index);\n        if (idx) {\n            return idx.inorderTraversal(function (wrappedNode) {\n                return action(wrappedNode.name, wrappedNode.node);\n            });\n        }\n        else {\n            return this.children_.inorderTraversal(action);\n        }\n    };\n    /**\n     * @param {!Index} indexDefinition\n     * @return {SortedMapIterator}\n     */\n    ChildrenNode.prototype.getIterator = function (indexDefinition) {\n        return this.getIteratorFrom(indexDefinition.minPost(), indexDefinition);\n    };\n    /**\n     *\n     * @param {!NamedNode} startPost\n     * @param {!Index} indexDefinition\n     * @return {!SortedMapIterator}\n     */\n    ChildrenNode.prototype.getIteratorFrom = function (startPost, indexDefinition) {\n        var idx = this.resolveIndex_(indexDefinition);\n        if (idx) {\n            return idx.getIteratorFrom(startPost, function (key) { return key; });\n        }\n        else {\n            var iterator = this.children_.getIteratorFrom(startPost.name, Node_1.NamedNode.Wrap);\n            var next = iterator.peek();\n            while (next != null && indexDefinition.compare(next, startPost) < 0) {\n                iterator.getNext();\n                next = iterator.peek();\n            }\n            return iterator;\n        }\n    };\n    /**\n     * @param {!Index} indexDefinition\n     * @return {!SortedMapIterator}\n     */\n    ChildrenNode.prototype.getReverseIterator = function (indexDefinition) {\n        return this.getReverseIteratorFrom(indexDefinition.maxPost(), indexDefinition);\n    };\n    /**\n     * @param {!NamedNode} endPost\n     * @param {!Index} indexDefinition\n     * @return {!SortedMapIterator}\n     */\n    ChildrenNode.prototype.getReverseIteratorFrom = function (endPost, indexDefinition) {\n        var idx = this.resolveIndex_(indexDefinition);\n        if (idx) {\n            return idx.getReverseIteratorFrom(endPost, function (key) {\n                return key;\n            });\n        }\n        else {\n            var iterator = this.children_.getReverseIteratorFrom(endPost.name, Node_1.NamedNode.Wrap);\n            var next = iterator.peek();\n            while (next != null && indexDefinition.compare(next, endPost) > 0) {\n                iterator.getNext();\n                next = iterator.peek();\n            }\n            return iterator;\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    ChildrenNode.prototype.compareTo = function (other) {\n        if (this.isEmpty()) {\n            if (other.isEmpty()) {\n                return 0;\n            }\n            else {\n                return -1;\n            }\n        }\n        else if (other.isLeafNode() || other.isEmpty()) {\n            return 1;\n        }\n        else if (other === exports.MAX_NODE) {\n            return -1;\n        }\n        else {\n            // Must be another node with children.\n            return 0;\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    ChildrenNode.prototype.withIndex = function (indexDefinition) {\n        if (indexDefinition === KeyIndex_1.KEY_INDEX ||\n            this.indexMap_.hasIndex(indexDefinition)) {\n            return this;\n        }\n        else {\n            var newIndexMap = this.indexMap_.addIndex(indexDefinition, this.children_);\n            return new ChildrenNode(this.children_, this.priorityNode_, newIndexMap);\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    ChildrenNode.prototype.isIndexed = function (index) {\n        return index === KeyIndex_1.KEY_INDEX || this.indexMap_.hasIndex(index);\n    };\n    /**\n     * @inheritDoc\n     */\n    ChildrenNode.prototype.equals = function (other) {\n        if (other === this) {\n            return true;\n        }\n        else if (other.isLeafNode()) {\n            return false;\n        }\n        else {\n            var otherChildrenNode = other;\n            if (!this.getPriority().equals(otherChildrenNode.getPriority())) {\n                return false;\n            }\n            else if (this.children_.count() === otherChildrenNode.children_.count()) {\n                var thisIter = this.getIterator(PriorityIndex_1.PRIORITY_INDEX);\n                var otherIter = otherChildrenNode.getIterator(PriorityIndex_1.PRIORITY_INDEX);\n                var thisCurrent = thisIter.getNext();\n                var otherCurrent = otherIter.getNext();\n                while (thisCurrent && otherCurrent) {\n                    if (thisCurrent.name !== otherCurrent.name ||\n                        !thisCurrent.node.equals(otherCurrent.node)) {\n                        return false;\n                    }\n                    thisCurrent = thisIter.getNext();\n                    otherCurrent = otherIter.getNext();\n                }\n                return thisCurrent === null && otherCurrent === null;\n            }\n            else {\n                return false;\n            }\n        }\n    };\n    /**\n     * Returns a SortedMap ordered by index, or null if the default (by-key) ordering can be used\n     * instead.\n     *\n     * @private\n     * @param {!Index} indexDefinition\n     * @return {?SortedMap.<NamedNode, Node>}\n     */\n    ChildrenNode.prototype.resolveIndex_ = function (indexDefinition) {\n        if (indexDefinition === KeyIndex_1.KEY_INDEX) {\n            return null;\n        }\n        else {\n            return this.indexMap_.get(indexDefinition.toString());\n        }\n    };\n    /**\n     * @private\n     * @type {RegExp}\n     */\n    ChildrenNode.INTEGER_REGEXP_ = /^(0|[1-9]\\d*)$/;\n    return ChildrenNode;\n}());\nexports.ChildrenNode = ChildrenNode;\n/**\n * @constructor\n * @extends {ChildrenNode}\n * @private\n */\nvar MaxNode = /** @class */ (function (_super) {\n    __extends(MaxNode, _super);\n    function MaxNode() {\n        return _super.call(this, new SortedMap_1.SortedMap(comparators_1.NAME_COMPARATOR), ChildrenNode.EMPTY_NODE, IndexMap_1.IndexMap.Default) || this;\n    }\n    MaxNode.prototype.compareTo = function (other) {\n        if (other === this) {\n            return 0;\n        }\n        else {\n            return 1;\n        }\n    };\n    MaxNode.prototype.equals = function (other) {\n        // Not that we every compare it, but MAX_NODE is only ever equal to itself\n        return other === this;\n    };\n    MaxNode.prototype.getPriority = function () {\n        return this;\n    };\n    MaxNode.prototype.getImmediateChild = function (childName) {\n        return ChildrenNode.EMPTY_NODE;\n    };\n    MaxNode.prototype.isEmpty = function () {\n        return false;\n    };\n    return MaxNode;\n}(ChildrenNode));\nexports.MaxNode = MaxNode;\n/**\n * Marker that will sort higher than any other snapshot.\n * @type {!MAX_NODE}\n * @const\n */\nexports.MAX_NODE = new MaxNode();\nObject.defineProperties(Node_1.NamedNode, {\n    MIN: {\n        value: new Node_1.NamedNode(util_2.MIN_NAME, ChildrenNode.EMPTY_NODE)\n    },\n    MAX: {\n        value: new Node_1.NamedNode(util_2.MAX_NAME, exports.MAX_NODE)\n    }\n});\n/**\n * Reference Extensions\n */\nKeyIndex_1.KeyIndex.__EMPTY_NODE = ChildrenNode.EMPTY_NODE;\nLeafNode_1.LeafNode.__childrenNodeConstructor = ChildrenNode;\nsnap_1.setMaxNode(exports.MAX_NODE);\nPriorityIndex_1.setMaxNode(exports.MAX_NODE);\n\n\n\n},{\"../util/SortedMap\":59,\"../util/util\":63,\"./IndexMap\":33,\"./LeafNode\":34,\"./Node\":35,\"./comparators\":37,\"./indexes/KeyIndex\":39,\"./indexes/PriorityIndex\":41,\"./snap\":44,\"@firebase/util\":134}],33:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\nvar childSet_1 = require(\"./childSet\");\nvar util_2 = require(\"@firebase/util\");\nvar Node_1 = require(\"./Node\");\nvar PriorityIndex_1 = require(\"./indexes/PriorityIndex\");\nvar KeyIndex_1 = require(\"./indexes/KeyIndex\");\nvar _defaultIndexMap;\nvar fallbackObject = {};\n/**\n *\n * @param {Object.<string, FallbackType|SortedMap.<NamedNode, Node>>} indexes\n * @param {Object.<string, Index>} indexSet\n * @constructor\n */\nvar IndexMap = /** @class */ (function () {\n    function IndexMap(indexes_, indexSet_) {\n        this.indexes_ = indexes_;\n        this.indexSet_ = indexSet_;\n    }\n    Object.defineProperty(IndexMap, \"Default\", {\n        /**\n         * The default IndexMap for nodes without a priority\n         * @type {!IndexMap}\n         * @const\n         */\n        get: function () {\n            util_1.assert(fallbackObject && PriorityIndex_1.PRIORITY_INDEX, 'ChildrenNode.ts has not been loaded');\n            _defaultIndexMap =\n                _defaultIndexMap ||\n                    new IndexMap({ '.priority': fallbackObject }, { '.priority': PriorityIndex_1.PRIORITY_INDEX });\n            return _defaultIndexMap;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     *\n     * @param {!string} indexKey\n     * @return {?SortedMap.<NamedNode, Node>}\n     */\n    IndexMap.prototype.get = function (indexKey) {\n        var sortedMap = util_2.safeGet(this.indexes_, indexKey);\n        if (!sortedMap)\n            throw new Error('No index defined for ' + indexKey);\n        if (sortedMap === fallbackObject) {\n            // The index exists, but it falls back to just name comparison. Return null so that the calling code uses the\n            // regular child map\n            return null;\n        }\n        else {\n            return sortedMap;\n        }\n    };\n    /**\n     * @param {!Index} indexDefinition\n     * @return {boolean}\n     */\n    IndexMap.prototype.hasIndex = function (indexDefinition) {\n        return util_2.contains(this.indexSet_, indexDefinition.toString());\n    };\n    /**\n     * @param {!Index} indexDefinition\n     * @param {!SortedMap.<string, !Node>} existingChildren\n     * @return {!IndexMap}\n     */\n    IndexMap.prototype.addIndex = function (indexDefinition, existingChildren) {\n        util_1.assert(indexDefinition !== KeyIndex_1.KEY_INDEX, \"KeyIndex always exists and isn't meant to be added to the IndexMap.\");\n        var childList = [];\n        var sawIndexedValue = false;\n        var iter = existingChildren.getIterator(Node_1.NamedNode.Wrap);\n        var next = iter.getNext();\n        while (next) {\n            sawIndexedValue =\n                sawIndexedValue || indexDefinition.isDefinedOn(next.node);\n            childList.push(next);\n            next = iter.getNext();\n        }\n        var newIndex;\n        if (sawIndexedValue) {\n            newIndex = childSet_1.buildChildSet(childList, indexDefinition.getCompare());\n        }\n        else {\n            newIndex = fallbackObject;\n        }\n        var indexName = indexDefinition.toString();\n        var newIndexSet = util_2.clone(this.indexSet_);\n        newIndexSet[indexName] = indexDefinition;\n        var newIndexes = util_2.clone(this.indexes_);\n        newIndexes[indexName] = newIndex;\n        return new IndexMap(newIndexes, newIndexSet);\n    };\n    /**\n     * Ensure that this node is properly tracked in any indexes that we're maintaining\n     * @param {!NamedNode} namedNode\n     * @param {!SortedMap.<string, !Node>} existingChildren\n     * @return {!IndexMap}\n     */\n    IndexMap.prototype.addToIndexes = function (namedNode, existingChildren) {\n        var _this = this;\n        var newIndexes = util_2.map(this.indexes_, function (indexedChildren, indexName) {\n            var index = util_2.safeGet(_this.indexSet_, indexName);\n            util_1.assert(index, 'Missing index implementation for ' + indexName);\n            if (indexedChildren === fallbackObject) {\n                // Check to see if we need to index everything\n                if (index.isDefinedOn(namedNode.node)) {\n                    // We need to build this index\n                    var childList = [];\n                    var iter = existingChildren.getIterator(Node_1.NamedNode.Wrap);\n                    var next = iter.getNext();\n                    while (next) {\n                        if (next.name != namedNode.name) {\n                            childList.push(next);\n                        }\n                        next = iter.getNext();\n                    }\n                    childList.push(namedNode);\n                    return childSet_1.buildChildSet(childList, index.getCompare());\n                }\n                else {\n                    // No change, this remains a fallback\n                    return fallbackObject;\n                }\n            }\n            else {\n                var existingSnap = existingChildren.get(namedNode.name);\n                var newChildren = indexedChildren;\n                if (existingSnap) {\n                    newChildren = newChildren.remove(new Node_1.NamedNode(namedNode.name, existingSnap));\n                }\n                return newChildren.insert(namedNode, namedNode.node);\n            }\n        });\n        return new IndexMap(newIndexes, this.indexSet_);\n    };\n    /**\n     * Create a new IndexMap instance with the given value removed\n     * @param {!NamedNode} namedNode\n     * @param {!SortedMap.<string, !Node>} existingChildren\n     * @return {!IndexMap}\n     */\n    IndexMap.prototype.removeFromIndexes = function (namedNode, existingChildren) {\n        var newIndexes = util_2.map(this.indexes_, function (indexedChildren) {\n            if (indexedChildren === fallbackObject) {\n                // This is the fallback. Just return it, nothing to do in this case\n                return indexedChildren;\n            }\n            else {\n                var existingSnap = existingChildren.get(namedNode.name);\n                if (existingSnap) {\n                    return indexedChildren.remove(new Node_1.NamedNode(namedNode.name, existingSnap));\n                }\n                else {\n                    // No record of this child\n                    return indexedChildren;\n                }\n            }\n        });\n        return new IndexMap(newIndexes, this.indexSet_);\n    };\n    return IndexMap;\n}());\nexports.IndexMap = IndexMap;\n\n\n\n},{\"./Node\":35,\"./childSet\":36,\"./indexes/KeyIndex\":39,\"./indexes/PriorityIndex\":41,\"@firebase/util\":134}],34:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\nvar util_2 = require(\"../util/util\");\nvar snap_1 = require(\"./snap\");\nvar __childrenNodeConstructor;\n/**\n * LeafNode is a class for storing leaf nodes in a DataSnapshot.  It\n * implements Node and stores the value of the node (a string,\n * number, or boolean) accessible via getValue().\n */\nvar LeafNode = /** @class */ (function () {\n    /**\n     * @implements {Node}\n     * @param {!(string|number|boolean|Object)} value_ The value to store in this leaf node.\n     *                                         The object type is possible in the event of a deferred value\n     * @param {!Node=} priorityNode_ The priority of this node.\n     */\n    function LeafNode(value_, priorityNode_) {\n        if (priorityNode_ === void 0) { priorityNode_ = LeafNode.__childrenNodeConstructor.EMPTY_NODE; }\n        this.value_ = value_;\n        this.priorityNode_ = priorityNode_;\n        this.lazyHash_ = null;\n        util_1.assert(this.value_ !== undefined && this.value_ !== null, \"LeafNode shouldn't be created with null/undefined value.\");\n        snap_1.validatePriorityNode(this.priorityNode_);\n    }\n    Object.defineProperty(LeafNode, \"__childrenNodeConstructor\", {\n        get: function () {\n            return __childrenNodeConstructor;\n        },\n        set: function (val) {\n            __childrenNodeConstructor = val;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /** @inheritDoc */\n    LeafNode.prototype.isLeafNode = function () {\n        return true;\n    };\n    /** @inheritDoc */\n    LeafNode.prototype.getPriority = function () {\n        return this.priorityNode_;\n    };\n    /** @inheritDoc */\n    LeafNode.prototype.updatePriority = function (newPriorityNode) {\n        return new LeafNode(this.value_, newPriorityNode);\n    };\n    /** @inheritDoc */\n    LeafNode.prototype.getImmediateChild = function (childName) {\n        // Hack to treat priority as a regular child\n        if (childName === '.priority') {\n            return this.priorityNode_;\n        }\n        else {\n            return LeafNode.__childrenNodeConstructor.EMPTY_NODE;\n        }\n    };\n    /** @inheritDoc */\n    LeafNode.prototype.getChild = function (path) {\n        if (path.isEmpty()) {\n            return this;\n        }\n        else if (path.getFront() === '.priority') {\n            return this.priorityNode_;\n        }\n        else {\n            return LeafNode.__childrenNodeConstructor.EMPTY_NODE;\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    LeafNode.prototype.hasChild = function () {\n        return false;\n    };\n    /** @inheritDoc */\n    LeafNode.prototype.getPredecessorChildName = function (childName, childNode) {\n        return null;\n    };\n    /** @inheritDoc */\n    LeafNode.prototype.updateImmediateChild = function (childName, newChildNode) {\n        if (childName === '.priority') {\n            return this.updatePriority(newChildNode);\n        }\n        else if (newChildNode.isEmpty() && childName !== '.priority') {\n            return this;\n        }\n        else {\n            return LeafNode.__childrenNodeConstructor.EMPTY_NODE\n                .updateImmediateChild(childName, newChildNode)\n                .updatePriority(this.priorityNode_);\n        }\n    };\n    /** @inheritDoc */\n    LeafNode.prototype.updateChild = function (path, newChildNode) {\n        var front = path.getFront();\n        if (front === null) {\n            return newChildNode;\n        }\n        else if (newChildNode.isEmpty() && front !== '.priority') {\n            return this;\n        }\n        else {\n            util_1.assert(front !== '.priority' || path.getLength() === 1, '.priority must be the last token in a path');\n            return this.updateImmediateChild(front, LeafNode.__childrenNodeConstructor.EMPTY_NODE.updateChild(path.popFront(), newChildNode));\n        }\n    };\n    /** @inheritDoc */\n    LeafNode.prototype.isEmpty = function () {\n        return false;\n    };\n    /** @inheritDoc */\n    LeafNode.prototype.numChildren = function () {\n        return 0;\n    };\n    /** @inheritDoc */\n    LeafNode.prototype.forEachChild = function (index, action) {\n        return false;\n    };\n    /**\n     * @inheritDoc\n     */\n    LeafNode.prototype.val = function (exportFormat) {\n        if (exportFormat && !this.getPriority().isEmpty())\n            return {\n                '.value': this.getValue(),\n                '.priority': this.getPriority().val()\n            };\n        else\n            return this.getValue();\n    };\n    /** @inheritDoc */\n    LeafNode.prototype.hash = function () {\n        if (this.lazyHash_ === null) {\n            var toHash = '';\n            if (!this.priorityNode_.isEmpty())\n                toHash +=\n                    'priority:' +\n                        snap_1.priorityHashText(this.priorityNode_.val()) +\n                        ':';\n            var type = typeof this.value_;\n            toHash += type + ':';\n            if (type === 'number') {\n                toHash += util_2.doubleToIEEE754String(this.value_);\n            }\n            else {\n                toHash += this.value_;\n            }\n            this.lazyHash_ = util_2.sha1(toHash);\n        }\n        return this.lazyHash_;\n    };\n    /**\n     * Returns the value of the leaf node.\n     * @return {Object|string|number|boolean} The value of the node.\n     */\n    LeafNode.prototype.getValue = function () {\n        return this.value_;\n    };\n    /**\n     * @inheritDoc\n     */\n    LeafNode.prototype.compareTo = function (other) {\n        if (other === LeafNode.__childrenNodeConstructor.EMPTY_NODE) {\n            return 1;\n        }\n        else if (other instanceof LeafNode.__childrenNodeConstructor) {\n            return -1;\n        }\n        else {\n            util_1.assert(other.isLeafNode(), 'Unknown node type');\n            return this.compareToLeafNode_(other);\n        }\n    };\n    /**\n     * Comparison specifically for two leaf nodes\n     * @param {!LeafNode} otherLeaf\n     * @return {!number}\n     * @private\n     */\n    LeafNode.prototype.compareToLeafNode_ = function (otherLeaf) {\n        var otherLeafType = typeof otherLeaf.value_;\n        var thisLeafType = typeof this.value_;\n        var otherIndex = LeafNode.VALUE_TYPE_ORDER.indexOf(otherLeafType);\n        var thisIndex = LeafNode.VALUE_TYPE_ORDER.indexOf(thisLeafType);\n        util_1.assert(otherIndex >= 0, 'Unknown leaf type: ' + otherLeafType);\n        util_1.assert(thisIndex >= 0, 'Unknown leaf type: ' + thisLeafType);\n        if (otherIndex === thisIndex) {\n            // Same type, compare values\n            if (thisLeafType === 'object') {\n                // Deferred value nodes are all equal, but we should also never get to this point...\n                return 0;\n            }\n            else {\n                // Note that this works because true > false, all others are number or string comparisons\n                if (this.value_ < otherLeaf.value_) {\n                    return -1;\n                }\n                else if (this.value_ === otherLeaf.value_) {\n                    return 0;\n                }\n                else {\n                    return 1;\n                }\n            }\n        }\n        else {\n            return thisIndex - otherIndex;\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    LeafNode.prototype.withIndex = function () {\n        return this;\n    };\n    /**\n     * @inheritDoc\n     */\n    LeafNode.prototype.isIndexed = function () {\n        return true;\n    };\n    /**\n     * @inheritDoc\n     */\n    LeafNode.prototype.equals = function (other) {\n        /**\n         * @inheritDoc\n         */\n        if (other === this) {\n            return true;\n        }\n        else if (other.isLeafNode()) {\n            var otherLeaf = other;\n            return (this.value_ === otherLeaf.value_ &&\n                this.priorityNode_.equals(otherLeaf.priorityNode_));\n        }\n        else {\n            return false;\n        }\n    };\n    /**\n     * The sort order for comparing leaf nodes of different types. If two leaf nodes have\n     * the same type, the comparison falls back to their value\n     * @type {Array.<!string>}\n     * @const\n     */\n    LeafNode.VALUE_TYPE_ORDER = ['object', 'boolean', 'number', 'string'];\n    return LeafNode;\n}());\nexports.LeafNode = LeafNode;\n\n\n\n},{\"../util/util\":63,\"./snap\":44,\"@firebase/util\":134}],35:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n *\n * @param {!string} name\n * @param {!Node} node\n * @constructor\n * @struct\n */\nvar NamedNode = /** @class */ (function () {\n    function NamedNode(name, node) {\n        this.name = name;\n        this.node = node;\n    }\n    /**\n     *\n     * @param {!string} name\n     * @param {!Node} node\n     * @return {NamedNode}\n     */\n    NamedNode.Wrap = function (name, node) {\n        return new NamedNode(name, node);\n    };\n    return NamedNode;\n}());\nexports.NamedNode = NamedNode;\n\n\n\n},{}],36:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar SortedMap_1 = require(\"../util/SortedMap\");\nvar SortedMap_2 = require(\"../util/SortedMap\");\nvar LOG_2 = Math.log(2);\n/**\n * @constructor\n */\nvar Base12Num = /** @class */ (function () {\n    /**\n     * @param {number} length\n     */\n    function Base12Num(length) {\n        var logBase2 = function (num) {\n            return parseInt((Math.log(num) / LOG_2), 10);\n        };\n        var bitMask = function (bits) { return parseInt(Array(bits + 1).join('1'), 2); };\n        this.count = logBase2(length + 1);\n        this.current_ = this.count - 1;\n        var mask = bitMask(this.count);\n        this.bits_ = (length + 1) & mask;\n    }\n    /**\n     * @return {boolean}\n     */\n    Base12Num.prototype.nextBitIsOne = function () {\n        //noinspection JSBitwiseOperatorUsage\n        var result = !(this.bits_ & (0x1 << this.current_));\n        this.current_--;\n        return result;\n    };\n    return Base12Num;\n}());\n/**\n * Takes a list of child nodes and constructs a SortedSet using the given comparison\n * function\n *\n * Uses the algorithm described in the paper linked here:\n * http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.46.1458\n *\n * @template K, V\n * @param {Array.<!NamedNode>} childList Unsorted list of children\n * @param {function(!NamedNode, !NamedNode):number} cmp The comparison method to be used\n * @param {(function(NamedNode):K)=} keyFn An optional function to extract K from a node wrapper, if K's\n *                                                        type is not NamedNode\n * @param {(function(K, K):number)=} mapSortFn An optional override for comparator used by the generated sorted map\n * @return {SortedMap.<K, V>}\n */\nexports.buildChildSet = function (childList, cmp, keyFn, mapSortFn) {\n    childList.sort(cmp);\n    var buildBalancedTree = function (low, high) {\n        var length = high - low;\n        var namedNode;\n        var key;\n        if (length == 0) {\n            return null;\n        }\n        else if (length == 1) {\n            namedNode = childList[low];\n            key = keyFn ? keyFn(namedNode) : namedNode;\n            return new SortedMap_1.LLRBNode(key, namedNode.node, SortedMap_1.LLRBNode.BLACK, null, null);\n        }\n        else {\n            var middle = parseInt((length / 2), 10) + low;\n            var left = buildBalancedTree(low, middle);\n            var right = buildBalancedTree(middle + 1, high);\n            namedNode = childList[middle];\n            key = keyFn ? keyFn(namedNode) : namedNode;\n            return new SortedMap_1.LLRBNode(key, namedNode.node, SortedMap_1.LLRBNode.BLACK, left, right);\n        }\n    };\n    var buildFrom12Array = function (base12) {\n        var node = null;\n        var root = null;\n        var index = childList.length;\n        var buildPennant = function (chunkSize, color) {\n            var low = index - chunkSize;\n            var high = index;\n            index -= chunkSize;\n            var childTree = buildBalancedTree(low + 1, high);\n            var namedNode = childList[low];\n            var key = keyFn ? keyFn(namedNode) : namedNode;\n            attachPennant(new SortedMap_1.LLRBNode(key, namedNode.node, color, null, childTree));\n        };\n        var attachPennant = function (pennant) {\n            if (node) {\n                node.left = pennant;\n                node = pennant;\n            }\n            else {\n                root = pennant;\n                node = pennant;\n            }\n        };\n        for (var i = 0; i < base12.count; ++i) {\n            var isOne = base12.nextBitIsOne();\n            // The number of nodes taken in each slice is 2^(arr.length - (i + 1))\n            var chunkSize = Math.pow(2, base12.count - (i + 1));\n            if (isOne) {\n                buildPennant(chunkSize, SortedMap_1.LLRBNode.BLACK);\n            }\n            else {\n                // current == 2\n                buildPennant(chunkSize, SortedMap_1.LLRBNode.BLACK);\n                buildPennant(chunkSize, SortedMap_1.LLRBNode.RED);\n            }\n        }\n        return root;\n    };\n    var base12 = new Base12Num(childList.length);\n    var root = buildFrom12Array(base12);\n    return new SortedMap_2.SortedMap(mapSortFn || cmp, root);\n};\n\n\n\n},{\"../util/SortedMap\":59}],37:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"../util/util\");\nfunction NAME_ONLY_COMPARATOR(left, right) {\n    return util_1.nameCompare(left.name, right.name);\n}\nexports.NAME_ONLY_COMPARATOR = NAME_ONLY_COMPARATOR;\nfunction NAME_COMPARATOR(left, right) {\n    return util_1.nameCompare(left, right);\n}\nexports.NAME_COMPARATOR = NAME_COMPARATOR;\n\n\n\n},{\"../util/util\":63}],38:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Node_1 = require(\"../Node\");\nvar util_1 = require(\"../../util/util\");\n/**\n *\n * @constructor\n */\nvar Index = /** @class */ (function () {\n    function Index() {\n    }\n    /**\n     * @return {function(!NamedNode, !NamedNode):number} A standalone comparison function for\n     * this index\n     */\n    Index.prototype.getCompare = function () {\n        return this.compare.bind(this);\n    };\n    /**\n     * Given a before and after value for a node, determine if the indexed value has changed. Even if they are different,\n     * it's possible that the changes are isolated to parts of the snapshot that are not indexed.\n     *\n     * @param {!Node} oldNode\n     * @param {!Node} newNode\n     * @return {boolean} True if the portion of the snapshot being indexed changed between oldNode and newNode\n     */\n    Index.prototype.indexedValueChanged = function (oldNode, newNode) {\n        var oldWrapped = new Node_1.NamedNode(util_1.MIN_NAME, oldNode);\n        var newWrapped = new Node_1.NamedNode(util_1.MIN_NAME, newNode);\n        return this.compare(oldWrapped, newWrapped) !== 0;\n    };\n    /**\n     * @return {!NamedNode} a node wrapper that will sort equal to or less than\n     * any other node wrapper, using this index\n     */\n    Index.prototype.minPost = function () {\n        return Node_1.NamedNode.MIN;\n    };\n    return Index;\n}());\nexports.Index = Index;\n\n\n\n},{\"../../util/util\":63,\"../Node\":35}],39:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Index_1 = require(\"./Index\");\nvar Node_1 = require(\"../Node\");\nvar util_1 = require(\"../../util/util\");\nvar util_2 = require(\"@firebase/util\");\nvar __EMPTY_NODE;\nvar KeyIndex = /** @class */ (function (_super) {\n    __extends(KeyIndex, _super);\n    function KeyIndex() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(KeyIndex, \"__EMPTY_NODE\", {\n        get: function () {\n            return __EMPTY_NODE;\n        },\n        set: function (val) {\n            __EMPTY_NODE = val;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @inheritDoc\n     */\n    KeyIndex.prototype.compare = function (a, b) {\n        return util_1.nameCompare(a.name, b.name);\n    };\n    /**\n     * @inheritDoc\n     */\n    KeyIndex.prototype.isDefinedOn = function (node) {\n        // We could probably return true here (since every node has a key), but it's never called\n        // so just leaving unimplemented for now.\n        throw util_2.assertionError('KeyIndex.isDefinedOn not expected to be called.');\n    };\n    /**\n     * @inheritDoc\n     */\n    KeyIndex.prototype.indexedValueChanged = function (oldNode, newNode) {\n        return false; // The key for a node never changes.\n    };\n    /**\n     * @inheritDoc\n     */\n    KeyIndex.prototype.minPost = function () {\n        return Node_1.NamedNode.MIN;\n    };\n    /**\n     * @inheritDoc\n     */\n    KeyIndex.prototype.maxPost = function () {\n        // TODO: This should really be created once and cached in a static property, but\n        // NamedNode isn't defined yet, so I can't use it in a static.  Bleh.\n        return new Node_1.NamedNode(util_1.MAX_NAME, __EMPTY_NODE);\n    };\n    /**\n     * @param {*} indexValue\n     * @param {string} name\n     * @return {!NamedNode}\n     */\n    KeyIndex.prototype.makePost = function (indexValue, name) {\n        util_2.assert(typeof indexValue === 'string', 'KeyIndex indexValue must always be a string.');\n        // We just use empty node, but it'll never be compared, since our comparator only looks at name.\n        return new Node_1.NamedNode(indexValue, __EMPTY_NODE);\n    };\n    /**\n     * @return {!string} String representation for inclusion in a query spec\n     */\n    KeyIndex.prototype.toString = function () {\n        return '.key';\n    };\n    return KeyIndex;\n}(Index_1.Index));\nexports.KeyIndex = KeyIndex;\nexports.KEY_INDEX = new KeyIndex();\n\n\n\n},{\"../../util/util\":63,\"../Node\":35,\"./Index\":38,\"@firebase/util\":134}],40:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\nvar util_2 = require(\"../../util/util\");\nvar Index_1 = require(\"./Index\");\nvar ChildrenNode_1 = require(\"../ChildrenNode\");\nvar Node_1 = require(\"../Node\");\nvar nodeFromJSON_1 = require(\"../nodeFromJSON\");\n/**\n * @param {!Path} indexPath\n * @constructor\n * @extends {Index}\n */\nvar PathIndex = /** @class */ (function (_super) {\n    __extends(PathIndex, _super);\n    function PathIndex(indexPath_) {\n        var _this = _super.call(this) || this;\n        _this.indexPath_ = indexPath_;\n        util_1.assert(!indexPath_.isEmpty() && indexPath_.getFront() !== '.priority', \"Can't create PathIndex with empty path or .priority key\");\n        return _this;\n    }\n    /**\n     * @param {!Node} snap\n     * @return {!Node}\n     * @protected\n     */\n    PathIndex.prototype.extractChild = function (snap) {\n        return snap.getChild(this.indexPath_);\n    };\n    /**\n     * @inheritDoc\n     */\n    PathIndex.prototype.isDefinedOn = function (node) {\n        return !node.getChild(this.indexPath_).isEmpty();\n    };\n    /**\n     * @inheritDoc\n     */\n    PathIndex.prototype.compare = function (a, b) {\n        var aChild = this.extractChild(a.node);\n        var bChild = this.extractChild(b.node);\n        var indexCmp = aChild.compareTo(bChild);\n        if (indexCmp === 0) {\n            return util_2.nameCompare(a.name, b.name);\n        }\n        else {\n            return indexCmp;\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    PathIndex.prototype.makePost = function (indexValue, name) {\n        var valueNode = nodeFromJSON_1.nodeFromJSON(indexValue);\n        var node = ChildrenNode_1.ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_, valueNode);\n        return new Node_1.NamedNode(name, node);\n    };\n    /**\n     * @inheritDoc\n     */\n    PathIndex.prototype.maxPost = function () {\n        var node = ChildrenNode_1.ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_, ChildrenNode_1.MAX_NODE);\n        return new Node_1.NamedNode(util_2.MAX_NAME, node);\n    };\n    /**\n     * @inheritDoc\n     */\n    PathIndex.prototype.toString = function () {\n        return this.indexPath_.slice().join('/');\n    };\n    return PathIndex;\n}(Index_1.Index));\nexports.PathIndex = PathIndex;\n\n\n\n},{\"../../util/util\":63,\"../ChildrenNode\":32,\"../Node\":35,\"../nodeFromJSON\":43,\"./Index\":38,\"@firebase/util\":134}],41:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Index_1 = require(\"./Index\");\nvar util_1 = require(\"../../util/util\");\nvar Node_1 = require(\"../Node\");\nvar LeafNode_1 = require(\"../LeafNode\");\nvar nodeFromJSON;\nvar MAX_NODE;\nfunction setNodeFromJSON(val) {\n    nodeFromJSON = val;\n}\nexports.setNodeFromJSON = setNodeFromJSON;\nfunction setMaxNode(val) {\n    MAX_NODE = val;\n}\nexports.setMaxNode = setMaxNode;\n/**\n * @constructor\n * @extends {Index}\n * @private\n */\nvar PriorityIndex = /** @class */ (function (_super) {\n    __extends(PriorityIndex, _super);\n    function PriorityIndex() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    /**\n     * @inheritDoc\n     */\n    PriorityIndex.prototype.compare = function (a, b) {\n        var aPriority = a.node.getPriority();\n        var bPriority = b.node.getPriority();\n        var indexCmp = aPriority.compareTo(bPriority);\n        if (indexCmp === 0) {\n            return util_1.nameCompare(a.name, b.name);\n        }\n        else {\n            return indexCmp;\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    PriorityIndex.prototype.isDefinedOn = function (node) {\n        return !node.getPriority().isEmpty();\n    };\n    /**\n     * @inheritDoc\n     */\n    PriorityIndex.prototype.indexedValueChanged = function (oldNode, newNode) {\n        return !oldNode.getPriority().equals(newNode.getPriority());\n    };\n    /**\n     * @inheritDoc\n     */\n    PriorityIndex.prototype.minPost = function () {\n        return Node_1.NamedNode.MIN;\n    };\n    /**\n     * @inheritDoc\n     */\n    PriorityIndex.prototype.maxPost = function () {\n        return new Node_1.NamedNode(util_1.MAX_NAME, new LeafNode_1.LeafNode('[PRIORITY-POST]', MAX_NODE));\n    };\n    /**\n     * @param {*} indexValue\n     * @param {string} name\n     * @return {!NamedNode}\n     */\n    PriorityIndex.prototype.makePost = function (indexValue, name) {\n        var priorityNode = nodeFromJSON(indexValue);\n        return new Node_1.NamedNode(name, new LeafNode_1.LeafNode('[PRIORITY-POST]', priorityNode));\n    };\n    /**\n     * @return {!string} String representation for inclusion in a query spec\n     */\n    PriorityIndex.prototype.toString = function () {\n        return '.priority';\n    };\n    return PriorityIndex;\n}(Index_1.Index));\nexports.PriorityIndex = PriorityIndex;\nexports.PRIORITY_INDEX = new PriorityIndex();\n\n\n\n},{\"../../util/util\":63,\"../LeafNode\":34,\"../Node\":35,\"./Index\":38}],42:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Index_1 = require(\"./Index\");\nvar Node_1 = require(\"../Node\");\nvar util_1 = require(\"../../util/util\");\nvar nodeFromJSON_1 = require(\"../nodeFromJSON\");\n/**\n * @constructor\n * @extends {Index}\n * @private\n */\nvar ValueIndex = /** @class */ (function (_super) {\n    __extends(ValueIndex, _super);\n    function ValueIndex() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    /**\n     * @inheritDoc\n     */\n    ValueIndex.prototype.compare = function (a, b) {\n        var indexCmp = a.node.compareTo(b.node);\n        if (indexCmp === 0) {\n            return util_1.nameCompare(a.name, b.name);\n        }\n        else {\n            return indexCmp;\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    ValueIndex.prototype.isDefinedOn = function (node) {\n        return true;\n    };\n    /**\n     * @inheritDoc\n     */\n    ValueIndex.prototype.indexedValueChanged = function (oldNode, newNode) {\n        return !oldNode.equals(newNode);\n    };\n    /**\n     * @inheritDoc\n     */\n    ValueIndex.prototype.minPost = function () {\n        return Node_1.NamedNode.MIN;\n    };\n    /**\n     * @inheritDoc\n     */\n    ValueIndex.prototype.maxPost = function () {\n        return Node_1.NamedNode.MAX;\n    };\n    /**\n     * @param {*} indexValue\n     * @param {string} name\n     * @return {!NamedNode}\n     */\n    ValueIndex.prototype.makePost = function (indexValue, name) {\n        var valueNode = nodeFromJSON_1.nodeFromJSON(indexValue);\n        return new Node_1.NamedNode(name, valueNode);\n    };\n    /**\n     * @return {!string} String representation for inclusion in a query spec\n     */\n    ValueIndex.prototype.toString = function () {\n        return '.value';\n    };\n    return ValueIndex;\n}(Index_1.Index));\nexports.ValueIndex = ValueIndex;\nexports.VALUE_INDEX = new ValueIndex();\n\n\n\n},{\"../../util/util\":63,\"../Node\":35,\"../nodeFromJSON\":43,\"./Index\":38}],43:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ChildrenNode_1 = require(\"./ChildrenNode\");\nvar LeafNode_1 = require(\"./LeafNode\");\nvar Node_1 = require(\"./Node\");\nvar util_1 = require(\"@firebase/util\");\nvar util_2 = require(\"@firebase/util\");\nvar childSet_1 = require(\"./childSet\");\nvar comparators_1 = require(\"./comparators\");\nvar IndexMap_1 = require(\"./IndexMap\");\nvar PriorityIndex_1 = require(\"./indexes/PriorityIndex\");\nvar USE_HINZE = true;\n/**\n * Constructs a snapshot node representing the passed JSON and returns it.\n * @param {*} json JSON to create a node for.\n * @param {?string|?number=} priority Optional priority to use.  This will be ignored if the\n * passed JSON contains a .priority property.\n * @return {!Node}\n */\nfunction nodeFromJSON(json, priority) {\n    if (priority === void 0) { priority = null; }\n    if (json === null) {\n        return ChildrenNode_1.ChildrenNode.EMPTY_NODE;\n    }\n    if (typeof json === 'object' && '.priority' in json) {\n        priority = json['.priority'];\n    }\n    util_2.assert(priority === null ||\n        typeof priority === 'string' ||\n        typeof priority === 'number' ||\n        (typeof priority === 'object' && '.sv' in priority), 'Invalid priority type found: ' + typeof priority);\n    if (typeof json === 'object' && '.value' in json && json['.value'] !== null) {\n        json = json['.value'];\n    }\n    // Valid leaf nodes include non-objects or server-value wrapper objects\n    if (typeof json !== 'object' || '.sv' in json) {\n        var jsonLeaf = json;\n        return new LeafNode_1.LeafNode(jsonLeaf, nodeFromJSON(priority));\n    }\n    if (!(json instanceof Array) && USE_HINZE) {\n        var children_1 = [];\n        var childrenHavePriority_1 = false;\n        var hinzeJsonObj_1 = json;\n        util_1.forEach(hinzeJsonObj_1, function (key, child) {\n            if (typeof key !== 'string' || key.substring(0, 1) !== '.') {\n                // Ignore metadata nodes\n                var childNode = nodeFromJSON(hinzeJsonObj_1[key]);\n                if (!childNode.isEmpty()) {\n                    childrenHavePriority_1 =\n                        childrenHavePriority_1 || !childNode.getPriority().isEmpty();\n                    children_1.push(new Node_1.NamedNode(key, childNode));\n                }\n            }\n        });\n        if (children_1.length == 0) {\n            return ChildrenNode_1.ChildrenNode.EMPTY_NODE;\n        }\n        var childSet = childSet_1.buildChildSet(children_1, comparators_1.NAME_ONLY_COMPARATOR, function (namedNode) { return namedNode.name; }, comparators_1.NAME_COMPARATOR);\n        if (childrenHavePriority_1) {\n            var sortedChildSet = childSet_1.buildChildSet(children_1, PriorityIndex_1.PRIORITY_INDEX.getCompare());\n            return new ChildrenNode_1.ChildrenNode(childSet, nodeFromJSON(priority), new IndexMap_1.IndexMap({ '.priority': sortedChildSet }, { '.priority': PriorityIndex_1.PRIORITY_INDEX }));\n        }\n        else {\n            return new ChildrenNode_1.ChildrenNode(childSet, nodeFromJSON(priority), IndexMap_1.IndexMap.Default);\n        }\n    }\n    else {\n        var node_1 = ChildrenNode_1.ChildrenNode.EMPTY_NODE;\n        var jsonObj_1 = json;\n        util_1.forEach(jsonObj_1, function (key, childData) {\n            if (util_1.contains(jsonObj_1, key)) {\n                if (key.substring(0, 1) !== '.') {\n                    // ignore metadata nodes.\n                    var childNode = nodeFromJSON(childData);\n                    if (childNode.isLeafNode() || !childNode.isEmpty())\n                        node_1 = node_1.updateImmediateChild(key, childNode);\n                }\n            }\n        });\n        return node_1.updatePriority(nodeFromJSON(priority));\n    }\n}\nexports.nodeFromJSON = nodeFromJSON;\nPriorityIndex_1.setNodeFromJSON(nodeFromJSON);\n\n\n\n},{\"./ChildrenNode\":32,\"./IndexMap\":33,\"./LeafNode\":34,\"./Node\":35,\"./childSet\":36,\"./comparators\":37,\"./indexes/PriorityIndex\":41,\"@firebase/util\":134}],44:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\nvar util_2 = require(\"../util/util\");\nvar util_3 = require(\"@firebase/util\");\nvar MAX_NODE;\nfunction setMaxNode(val) {\n    MAX_NODE = val;\n}\nexports.setMaxNode = setMaxNode;\n/**\n * @param {(!string|!number)} priority\n * @return {!string}\n */\nexports.priorityHashText = function (priority) {\n    if (typeof priority === 'number')\n        return 'number:' + util_2.doubleToIEEE754String(priority);\n    else\n        return 'string:' + priority;\n};\n/**\n * Validates that a priority snapshot Node is valid.\n *\n * @param {!Node} priorityNode\n */\nexports.validatePriorityNode = function (priorityNode) {\n    if (priorityNode.isLeafNode()) {\n        var val = priorityNode.val();\n        util_1.assert(typeof val === 'string' ||\n            typeof val === 'number' ||\n            (typeof val === 'object' && util_3.contains(val, '.sv')), 'Priority must be a string or number.');\n    }\n    else {\n        util_1.assert(priorityNode === MAX_NODE || priorityNode.isEmpty(), 'priority of unexpected type.');\n    }\n    // Don't call getPriority() on MAX_NODE to avoid hitting assertion.\n    util_1.assert(priorityNode === MAX_NODE || priorityNode.getPriority().isEmpty(), \"Priority nodes can't have a priority of their own.\");\n};\n\n\n\n},{\"../util/util\":63,\"@firebase/util\":134}],45:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\nvar util_2 = require(\"@firebase/util\");\n/**\n * Tracks a collection of stats.\n *\n * @constructor\n */\nvar StatsCollection = /** @class */ (function () {\n    function StatsCollection() {\n        this.counters_ = {};\n    }\n    StatsCollection.prototype.incrementCounter = function (name, amount) {\n        if (amount === void 0) { amount = 1; }\n        if (!util_2.contains(this.counters_, name))\n            this.counters_[name] = 0;\n        this.counters_[name] += amount;\n    };\n    StatsCollection.prototype.get = function () {\n        return util_1.deepCopy(this.counters_);\n    };\n    return StatsCollection;\n}());\nexports.StatsCollection = StatsCollection;\n\n\n\n},{\"@firebase/util\":134}],46:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\n/**\n * Returns the delta from the previous call to get stats.\n *\n * @param collection_ The collection to \"listen\" to.\n * @constructor\n */\nvar StatsListener = /** @class */ (function () {\n    function StatsListener(collection_) {\n        this.collection_ = collection_;\n        this.last_ = null;\n    }\n    StatsListener.prototype.get = function () {\n        var newStats = this.collection_.get();\n        var delta = util_1.clone(newStats);\n        if (this.last_) {\n            util_1.forEach(this.last_, function (stat, value) {\n                delta[stat] = delta[stat] - value;\n            });\n        }\n        this.last_ = newStats;\n        return delta;\n    };\n    return StatsListener;\n}());\nexports.StatsListener = StatsListener;\n\n\n\n},{\"@firebase/util\":134}],47:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar StatsCollection_1 = require(\"./StatsCollection\");\nvar StatsManager = /** @class */ (function () {\n    function StatsManager() {\n    }\n    StatsManager.getCollection = function (repoInfo) {\n        var hashString = repoInfo.toString();\n        if (!this.collections_[hashString]) {\n            this.collections_[hashString] = new StatsCollection_1.StatsCollection();\n        }\n        return this.collections_[hashString];\n    };\n    StatsManager.getOrCreateReporter = function (repoInfo, creatorFunction) {\n        var hashString = repoInfo.toString();\n        if (!this.reporters_[hashString]) {\n            this.reporters_[hashString] = creatorFunction();\n        }\n        return this.reporters_[hashString];\n    };\n    StatsManager.collections_ = {};\n    StatsManager.reporters_ = {};\n    return StatsManager;\n}());\nexports.StatsManager = StatsManager;\n\n\n\n},{\"./StatsCollection\":45}],48:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\nvar util_2 = require(\"../util/util\");\nvar StatsListener_1 = require(\"./StatsListener\");\n// Assuming some apps may have a short amount of time on page, and a bulk of firebase operations probably\n// happen on page load, we try to report our first set of stats pretty quickly, but we wait at least 10\n// seconds to try to ensure the Firebase connection is established / settled.\nvar FIRST_STATS_MIN_TIME = 10 * 1000;\nvar FIRST_STATS_MAX_TIME = 30 * 1000;\n// We'll continue to report stats on average every 5 minutes.\nvar REPORT_STATS_INTERVAL = 5 * 60 * 1000;\n/**\n * @constructor\n */\nvar StatsReporter = /** @class */ (function () {\n    /**\n     * @param collection\n     * @param server_\n     */\n    function StatsReporter(collection, server_) {\n        this.server_ = server_;\n        this.statsToReport_ = {};\n        this.statsListener_ = new StatsListener_1.StatsListener(collection);\n        var timeout = FIRST_STATS_MIN_TIME +\n            (FIRST_STATS_MAX_TIME - FIRST_STATS_MIN_TIME) * Math.random();\n        util_2.setTimeoutNonBlocking(this.reportStats_.bind(this), Math.floor(timeout));\n    }\n    StatsReporter.prototype.includeStat = function (stat) {\n        this.statsToReport_[stat] = true;\n    };\n    StatsReporter.prototype.reportStats_ = function () {\n        var _this = this;\n        var stats = this.statsListener_.get();\n        var reportedStats = {};\n        var haveStatsToReport = false;\n        util_1.forEach(stats, function (stat, value) {\n            if (value > 0 && util_1.contains(_this.statsToReport_, stat)) {\n                reportedStats[stat] = value;\n                haveStatsToReport = true;\n            }\n        });\n        if (haveStatsToReport) {\n            this.server_.reportStats(reportedStats);\n        }\n        // queue our next run.\n        util_2.setTimeoutNonBlocking(this.reportStats_.bind(this), Math.floor(Math.random() * 2 * REPORT_STATS_INTERVAL));\n    };\n    return StatsReporter;\n}());\nexports.StatsReporter = StatsReporter;\n\n\n\n},{\"../util/util\":63,\"./StatsListener\":46,\"@firebase/util\":134}],49:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\n/**\n * Wraps a DOM Storage object and:\n * - automatically encode objects as JSON strings before storing them to allow us to store arbitrary types.\n * - prefixes names with \"firebase:\" to avoid collisions with app data.\n *\n * We automatically (see storage.js) create two such wrappers, one for sessionStorage,\n * and one for localStorage.\n *\n * @constructor\n */\nvar DOMStorageWrapper = /** @class */ (function () {\n    /**\n     * @param {Storage} domStorage_ The underlying storage object (e.g. localStorage or sessionStorage)\n     */\n    function DOMStorageWrapper(domStorage_) {\n        this.domStorage_ = domStorage_;\n        // Use a prefix to avoid collisions with other stuff saved by the app.\n        this.prefix_ = 'firebase:';\n    }\n    /**\n     * @param {string} key The key to save the value under\n     * @param {?Object} value The value being stored, or null to remove the key.\n     */\n    DOMStorageWrapper.prototype.set = function (key, value) {\n        if (value == null) {\n            this.domStorage_.removeItem(this.prefixedName_(key));\n        }\n        else {\n            this.domStorage_.setItem(this.prefixedName_(key), util_1.stringify(value));\n        }\n    };\n    /**\n     * @param {string} key\n     * @return {*} The value that was stored under this key, or null\n     */\n    DOMStorageWrapper.prototype.get = function (key) {\n        var storedVal = this.domStorage_.getItem(this.prefixedName_(key));\n        if (storedVal == null) {\n            return null;\n        }\n        else {\n            return util_1.jsonEval(storedVal);\n        }\n    };\n    /**\n     * @param {string} key\n     */\n    DOMStorageWrapper.prototype.remove = function (key) {\n        this.domStorage_.removeItem(this.prefixedName_(key));\n    };\n    /**\n     * @param {string} name\n     * @return {string}\n     */\n    DOMStorageWrapper.prototype.prefixedName_ = function (name) {\n        return this.prefix_ + name;\n    };\n    DOMStorageWrapper.prototype.toString = function () {\n        return this.domStorage_.toString();\n    };\n    return DOMStorageWrapper;\n}());\nexports.DOMStorageWrapper = DOMStorageWrapper;\n\n\n\n},{\"@firebase/util\":134}],50:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\n/**\n * An in-memory storage implementation that matches the API of DOMStorageWrapper\n * (TODO: create interface for both to implement).\n *\n * @constructor\n */\nvar MemoryStorage = /** @class */ (function () {\n    function MemoryStorage() {\n        this.cache_ = {};\n        this.isInMemoryStorage = true;\n    }\n    MemoryStorage.prototype.set = function (key, value) {\n        if (value == null) {\n            delete this.cache_[key];\n        }\n        else {\n            this.cache_[key] = value;\n        }\n    };\n    MemoryStorage.prototype.get = function (key) {\n        if (util_1.contains(this.cache_, key)) {\n            return this.cache_[key];\n        }\n        return null;\n    };\n    MemoryStorage.prototype.remove = function (key) {\n        delete this.cache_[key];\n    };\n    return MemoryStorage;\n}());\nexports.MemoryStorage = MemoryStorage;\n\n\n\n},{\"@firebase/util\":134}],51:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar DOMStorageWrapper_1 = require(\"./DOMStorageWrapper\");\nvar MemoryStorage_1 = require(\"./MemoryStorage\");\n/**\n * Helper to create a DOMStorageWrapper or else fall back to MemoryStorage.\n * TODO: Once MemoryStorage and DOMStorageWrapper have a shared interface this method annotation should change\n * to reflect this type\n *\n * @param {string} domStorageName Name of the underlying storage object\n *   (e.g. 'localStorage' or 'sessionStorage').\n * @return {?} Turning off type information until a common interface is defined.\n */\nvar createStoragefor = function (domStorageName) {\n    try {\n        // NOTE: just accessing \"localStorage\" or \"window['localStorage']\" may throw a security exception,\n        // so it must be inside the try/catch.\n        if (typeof window !== 'undefined' &&\n            typeof window[domStorageName] !== 'undefined') {\n            // Need to test cache. Just because it's here doesn't mean it works\n            var domStorage = window[domStorageName];\n            domStorage.setItem('firebase:sentinel', 'cache');\n            domStorage.removeItem('firebase:sentinel');\n            return new DOMStorageWrapper_1.DOMStorageWrapper(domStorage);\n        }\n    }\n    catch (e) { }\n    // Failed to create wrapper.  Just return in-memory storage.\n    // TODO: log?\n    return new MemoryStorage_1.MemoryStorage();\n};\n/** A storage object that lasts across sessions */\nexports.PersistentStorage = createStoragefor('localStorage');\n/** A storage object that only lasts one session */\nexports.SessionStorage = createStoragefor('sessionStorage');\n\n\n\n},{\"./DOMStorageWrapper\":49,\"./MemoryStorage\":50}],52:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\n/**\n * Implements a set with a count of elements.\n *\n * @template K, V\n */\nvar CountedSet = /** @class */ (function () {\n    function CountedSet() {\n        this.set = {};\n    }\n    /**\n     * @param {!K} item\n     * @param {V} val\n     */\n    CountedSet.prototype.add = function (item, val) {\n        this.set[item] = val !== null ? val : true;\n    };\n    /**\n     * @param {!K} key\n     * @return {boolean}\n     */\n    CountedSet.prototype.contains = function (key) {\n        return util_1.contains(this.set, key);\n    };\n    /**\n     * @param {!K} item\n     * @return {V}\n     */\n    CountedSet.prototype.get = function (item) {\n        return this.contains(item) ? this.set[item] : undefined;\n    };\n    /**\n     * @param {!K} item\n     */\n    CountedSet.prototype.remove = function (item) {\n        delete this.set[item];\n    };\n    /**\n     * Deletes everything in the set\n     */\n    CountedSet.prototype.clear = function () {\n        this.set = {};\n    };\n    /**\n     * True if there's nothing in the set\n     * @return {boolean}\n     */\n    CountedSet.prototype.isEmpty = function () {\n        return util_1.isEmpty(this.set);\n    };\n    /**\n     * @return {number} The number of items in the set\n     */\n    CountedSet.prototype.count = function () {\n        return util_1.getCount(this.set);\n    };\n    /**\n     * Run a function on each k,v pair in the set\n     * @param {function(K, V)} fn\n     */\n    CountedSet.prototype.each = function (fn) {\n        util_1.forEach(this.set, function (k, v) { return fn(k, v); });\n    };\n    /**\n     * Mostly for debugging\n     * @return {Array.<K>} The keys present in this CountedSet\n     */\n    CountedSet.prototype.keys = function () {\n        var keys = [];\n        util_1.forEach(this.set, function (k) {\n            keys.push(k);\n        });\n        return keys;\n    };\n    return CountedSet;\n}());\nexports.CountedSet = CountedSet;\n\n\n\n},{\"@firebase/util\":134}],53:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\n/**\n * Base class to be used if you want to emit events. Call the constructor with\n * the set of allowed event names.\n */\nvar EventEmitter = /** @class */ (function () {\n    /**\n     * @param {!Array.<string>} allowedEvents_\n     */\n    function EventEmitter(allowedEvents_) {\n        this.allowedEvents_ = allowedEvents_;\n        this.listeners_ = {};\n        util_1.assert(Array.isArray(allowedEvents_) && allowedEvents_.length > 0, 'Requires a non-empty array');\n    }\n    /**\n     * To be called by derived classes to trigger events.\n     * @param {!string} eventType\n     * @param {...*} var_args\n     */\n    EventEmitter.prototype.trigger = function (eventType) {\n        var var_args = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            var_args[_i - 1] = arguments[_i];\n        }\n        if (Array.isArray(this.listeners_[eventType])) {\n            // Clone the list, since callbacks could add/remove listeners.\n            var listeners = this.listeners_[eventType].slice();\n            for (var i = 0; i < listeners.length; i++) {\n                listeners[i].callback.apply(listeners[i].context, var_args);\n            }\n        }\n    };\n    EventEmitter.prototype.on = function (eventType, callback, context) {\n        this.validateEventType_(eventType);\n        this.listeners_[eventType] = this.listeners_[eventType] || [];\n        this.listeners_[eventType].push({ callback: callback, context: context });\n        var eventData = this.getInitialEvent(eventType);\n        if (eventData) {\n            callback.apply(context, eventData);\n        }\n    };\n    EventEmitter.prototype.off = function (eventType, callback, context) {\n        this.validateEventType_(eventType);\n        var listeners = this.listeners_[eventType] || [];\n        for (var i = 0; i < listeners.length; i++) {\n            if (listeners[i].callback === callback &&\n                (!context || context === listeners[i].context)) {\n                listeners.splice(i, 1);\n                return;\n            }\n        }\n    };\n    EventEmitter.prototype.validateEventType_ = function (eventType) {\n        util_1.assert(this.allowedEvents_.find(function (et) {\n            return et === eventType;\n        }), 'Unknown event: ' + eventType);\n    };\n    return EventEmitter;\n}());\nexports.EventEmitter = EventEmitter;\n\n\n\n},{\"@firebase/util\":134}],54:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar SortedMap_1 = require(\"./SortedMap\");\nvar Path_1 = require(\"./Path\");\nvar util_1 = require(\"./util\");\nvar util_2 = require(\"@firebase/util\");\nvar emptyChildrenSingleton;\n/**\n * Singleton empty children collection.\n *\n * @const\n * @type {!SortedMap.<string, !ImmutableTree.<?>>}\n */\nvar EmptyChildren = function () {\n    if (!emptyChildrenSingleton) {\n        emptyChildrenSingleton = new SortedMap_1.SortedMap(util_1.stringCompare);\n    }\n    return emptyChildrenSingleton;\n};\n/**\n * A tree with immutable elements.\n */\nvar ImmutableTree = /** @class */ (function () {\n    /**\n     * @template T\n     * @param {?T} value\n     * @param {SortedMap.<string, !ImmutableTree.<T>>=} children\n     */\n    function ImmutableTree(value, children) {\n        if (children === void 0) { children = EmptyChildren(); }\n        this.value = value;\n        this.children = children;\n    }\n    /**\n     * @template T\n     * @param {!Object.<string, !T>} obj\n     * @return {!ImmutableTree.<!T>}\n     */\n    ImmutableTree.fromObject = function (obj) {\n        var tree = ImmutableTree.Empty;\n        util_2.forEach(obj, function (childPath, childSnap) {\n            tree = tree.set(new Path_1.Path(childPath), childSnap);\n        });\n        return tree;\n    };\n    /**\n     * True if the value is empty and there are no children\n     * @return {boolean}\n     */\n    ImmutableTree.prototype.isEmpty = function () {\n        return this.value === null && this.children.isEmpty();\n    };\n    /**\n     * Given a path and predicate, return the first node and the path to that node\n     * where the predicate returns true.\n     *\n     * TODO Do a perf test -- If we're creating a bunch of {path: value:} objects\n     * on the way back out, it may be better to pass down a pathSoFar obj.\n     *\n     * @param {!Path} relativePath The remainder of the path\n     * @param {function(T):boolean} predicate The predicate to satisfy to return a\n     *   node\n     * @return {?{path:!Path, value:!T}}\n     */\n    ImmutableTree.prototype.findRootMostMatchingPathAndValue = function (relativePath, predicate) {\n        if (this.value != null && predicate(this.value)) {\n            return { path: Path_1.Path.Empty, value: this.value };\n        }\n        else {\n            if (relativePath.isEmpty()) {\n                return null;\n            }\n            else {\n                var front = relativePath.getFront();\n                var child = this.children.get(front);\n                if (child !== null) {\n                    var childExistingPathAndValue = child.findRootMostMatchingPathAndValue(relativePath.popFront(), predicate);\n                    if (childExistingPathAndValue != null) {\n                        var fullPath = new Path_1.Path(front).child(childExistingPathAndValue.path);\n                        return { path: fullPath, value: childExistingPathAndValue.value };\n                    }\n                    else {\n                        return null;\n                    }\n                }\n                else {\n                    return null;\n                }\n            }\n        }\n    };\n    /**\n     * Find, if it exists, the shortest subpath of the given path that points a defined\n     * value in the tree\n     * @param {!Path} relativePath\n     * @return {?{path: !Path, value: !T}}\n     */\n    ImmutableTree.prototype.findRootMostValueAndPath = function (relativePath) {\n        return this.findRootMostMatchingPathAndValue(relativePath, function () { return true; });\n    };\n    /**\n     * @param {!Path} relativePath\n     * @return {!ImmutableTree.<T>} The subtree at the given path\n     */\n    ImmutableTree.prototype.subtree = function (relativePath) {\n        if (relativePath.isEmpty()) {\n            return this;\n        }\n        else {\n            var front = relativePath.getFront();\n            var childTree = this.children.get(front);\n            if (childTree !== null) {\n                return childTree.subtree(relativePath.popFront());\n            }\n            else {\n                return ImmutableTree.Empty;\n            }\n        }\n    };\n    /**\n     * Sets a value at the specified path.\n     *\n     * @param {!Path} relativePath Path to set value at.\n     * @param {?T} toSet Value to set.\n     * @return {!ImmutableTree.<T>} Resulting tree.\n     */\n    ImmutableTree.prototype.set = function (relativePath, toSet) {\n        if (relativePath.isEmpty()) {\n            return new ImmutableTree(toSet, this.children);\n        }\n        else {\n            var front = relativePath.getFront();\n            var child = this.children.get(front) || ImmutableTree.Empty;\n            var newChild = child.set(relativePath.popFront(), toSet);\n            var newChildren = this.children.insert(front, newChild);\n            return new ImmutableTree(this.value, newChildren);\n        }\n    };\n    /**\n     * Removes the value at the specified path.\n     *\n     * @param {!Path} relativePath Path to value to remove.\n     * @return {!ImmutableTree.<T>} Resulting tree.\n     */\n    ImmutableTree.prototype.remove = function (relativePath) {\n        if (relativePath.isEmpty()) {\n            if (this.children.isEmpty()) {\n                return ImmutableTree.Empty;\n            }\n            else {\n                return new ImmutableTree(null, this.children);\n            }\n        }\n        else {\n            var front = relativePath.getFront();\n            var child = this.children.get(front);\n            if (child) {\n                var newChild = child.remove(relativePath.popFront());\n                var newChildren = void 0;\n                if (newChild.isEmpty()) {\n                    newChildren = this.children.remove(front);\n                }\n                else {\n                    newChildren = this.children.insert(front, newChild);\n                }\n                if (this.value === null && newChildren.isEmpty()) {\n                    return ImmutableTree.Empty;\n                }\n                else {\n                    return new ImmutableTree(this.value, newChildren);\n                }\n            }\n            else {\n                return this;\n            }\n        }\n    };\n    /**\n     * Gets a value from the tree.\n     *\n     * @param {!Path} relativePath Path to get value for.\n     * @return {?T} Value at path, or null.\n     */\n    ImmutableTree.prototype.get = function (relativePath) {\n        if (relativePath.isEmpty()) {\n            return this.value;\n        }\n        else {\n            var front = relativePath.getFront();\n            var child = this.children.get(front);\n            if (child) {\n                return child.get(relativePath.popFront());\n            }\n            else {\n                return null;\n            }\n        }\n    };\n    /**\n     * Replace the subtree at the specified path with the given new tree.\n     *\n     * @param {!Path} relativePath Path to replace subtree for.\n     * @param {!ImmutableTree} newTree New tree.\n     * @return {!ImmutableTree} Resulting tree.\n     */\n    ImmutableTree.prototype.setTree = function (relativePath, newTree) {\n        if (relativePath.isEmpty()) {\n            return newTree;\n        }\n        else {\n            var front = relativePath.getFront();\n            var child = this.children.get(front) || ImmutableTree.Empty;\n            var newChild = child.setTree(relativePath.popFront(), newTree);\n            var newChildren = void 0;\n            if (newChild.isEmpty()) {\n                newChildren = this.children.remove(front);\n            }\n            else {\n                newChildren = this.children.insert(front, newChild);\n            }\n            return new ImmutableTree(this.value, newChildren);\n        }\n    };\n    /**\n     * Performs a depth first fold on this tree. Transforms a tree into a single\n     * value, given a function that operates on the path to a node, an optional\n     * current value, and a map of child names to folded subtrees\n     * @template V\n     * @param {function(Path, ?T, Object.<string, V>):V} fn\n     * @return {V}\n     */\n    ImmutableTree.prototype.fold = function (fn) {\n        return this.fold_(Path_1.Path.Empty, fn);\n    };\n    /**\n     * Recursive helper for public-facing fold() method\n     * @template V\n     * @param {!Path} pathSoFar\n     * @param {function(Path, ?T, Object.<string, V>):V} fn\n     * @return {V}\n     * @private\n     */\n    ImmutableTree.prototype.fold_ = function (pathSoFar, fn) {\n        var accum = {};\n        this.children.inorderTraversal(function (childKey, childTree) {\n            accum[childKey] = childTree.fold_(pathSoFar.child(childKey), fn);\n        });\n        return fn(pathSoFar, this.value, accum);\n    };\n    /**\n     * Find the first matching value on the given path. Return the result of applying f to it.\n     * @template V\n     * @param {!Path} path\n     * @param {!function(!Path, !T):?V} f\n     * @return {?V}\n     */\n    ImmutableTree.prototype.findOnPath = function (path, f) {\n        return this.findOnPath_(path, Path_1.Path.Empty, f);\n    };\n    ImmutableTree.prototype.findOnPath_ = function (pathToFollow, pathSoFar, f) {\n        var result = this.value ? f(pathSoFar, this.value) : false;\n        if (result) {\n            return result;\n        }\n        else {\n            if (pathToFollow.isEmpty()) {\n                return null;\n            }\n            else {\n                var front = pathToFollow.getFront();\n                var nextChild = this.children.get(front);\n                if (nextChild) {\n                    return nextChild.findOnPath_(pathToFollow.popFront(), pathSoFar.child(front), f);\n                }\n                else {\n                    return null;\n                }\n            }\n        }\n    };\n    /**\n     *\n     * @param {!Path} path\n     * @param {!function(!Path, !T)} f\n     * @returns {!ImmutableTree.<T>}\n     */\n    ImmutableTree.prototype.foreachOnPath = function (path, f) {\n        return this.foreachOnPath_(path, Path_1.Path.Empty, f);\n    };\n    ImmutableTree.prototype.foreachOnPath_ = function (pathToFollow, currentRelativePath, f) {\n        if (pathToFollow.isEmpty()) {\n            return this;\n        }\n        else {\n            if (this.value) {\n                f(currentRelativePath, this.value);\n            }\n            var front = pathToFollow.getFront();\n            var nextChild = this.children.get(front);\n            if (nextChild) {\n                return nextChild.foreachOnPath_(pathToFollow.popFront(), currentRelativePath.child(front), f);\n            }\n            else {\n                return ImmutableTree.Empty;\n            }\n        }\n    };\n    /**\n     * Calls the given function for each node in the tree that has a value.\n     *\n     * @param {function(!Path, !T)} f A function to be called with\n     *   the path from the root of the tree to a node, and the value at that node.\n     *   Called in depth-first order.\n     */\n    ImmutableTree.prototype.foreach = function (f) {\n        this.foreach_(Path_1.Path.Empty, f);\n    };\n    ImmutableTree.prototype.foreach_ = function (currentRelativePath, f) {\n        this.children.inorderTraversal(function (childName, childTree) {\n            childTree.foreach_(currentRelativePath.child(childName), f);\n        });\n        if (this.value) {\n            f(currentRelativePath, this.value);\n        }\n    };\n    /**\n     *\n     * @param {function(string, !T)} f\n     */\n    ImmutableTree.prototype.foreachChild = function (f) {\n        this.children.inorderTraversal(function (childName, childTree) {\n            if (childTree.value) {\n                f(childName, childTree.value);\n            }\n        });\n    };\n    ImmutableTree.Empty = new ImmutableTree(null);\n    return ImmutableTree;\n}());\nexports.ImmutableTree = ImmutableTree;\n\n\n\n},{\"./Path\":57,\"./SortedMap\":59,\"./util\":63,\"@firebase/util\":134}],55:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\n/**\n * Fancy ID generator that creates 20-character string identifiers with the\n * following properties:\n *\n * 1. They're based on timestamp so that they sort *after* any existing ids.\n * 2. They contain 72-bits of random data after the timestamp so that IDs won't\n *    collide with other clients' IDs.\n * 3. They sort *lexicographically* (so the timestamp is converted to characters\n *    that will sort properly).\n * 4. They're monotonically increasing. Even if you generate more than one in\n *    the same timestamp, the latter ones will sort after the former ones. We do\n *    this by using the previous random bits but \"incrementing\" them by 1 (only\n *    in the case of a timestamp collision).\n */\nexports.nextPushId = (function () {\n    // Modeled after base64 web-safe chars, but ordered by ASCII.\n    var PUSH_CHARS = '-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz';\n    // Timestamp of last push, used to prevent local collisions if you push twice\n    // in one ms.\n    var lastPushTime = 0;\n    // We generate 72-bits of randomness which get turned into 12 characters and\n    // appended to the timestamp to prevent collisions with other clients. We\n    // store the last characters we generated because in the event of a collision,\n    // we'll use those same characters except \"incremented\" by one.\n    var lastRandChars = [];\n    return function (now) {\n        var duplicateTime = now === lastPushTime;\n        lastPushTime = now;\n        var i;\n        var timeStampChars = new Array(8);\n        for (i = 7; i >= 0; i--) {\n            timeStampChars[i] = PUSH_CHARS.charAt(now % 64);\n            // NOTE: Can't use << here because javascript will convert to int and lose\n            // the upper bits.\n            now = Math.floor(now / 64);\n        }\n        util_1.assert(now === 0, 'Cannot push at time == 0');\n        var id = timeStampChars.join('');\n        if (!duplicateTime) {\n            for (i = 0; i < 12; i++) {\n                lastRandChars[i] = Math.floor(Math.random() * 64);\n            }\n        }\n        else {\n            // If the timestamp hasn't changed since last push, use the same random\n            // number, except incremented by 1.\n            for (i = 11; i >= 0 && lastRandChars[i] === 63; i--) {\n                lastRandChars[i] = 0;\n            }\n            lastRandChars[i]++;\n        }\n        for (i = 0; i < 12; i++) {\n            id += PUSH_CHARS.charAt(lastRandChars[i]);\n        }\n        util_1.assert(id.length === 20, 'nextPushId: Length should be 20.');\n        return id;\n    };\n})();\n\n\n\n},{\"@firebase/util\":134}],56:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\nvar EventEmitter_1 = require(\"./EventEmitter\");\nvar util_2 = require(\"@firebase/util\");\n/**\n * Monitors online state (as reported by window.online/offline events).\n *\n * The expectation is that this could have many false positives (thinks we are online\n * when we're not), but no false negatives.  So we can safely use it to determine when\n * we definitely cannot reach the internet.\n *\n * @extends {EventEmitter}\n */\nvar OnlineMonitor = /** @class */ (function (_super) {\n    __extends(OnlineMonitor, _super);\n    function OnlineMonitor() {\n        var _this = _super.call(this, ['online']) || this;\n        _this.online_ = true;\n        // We've had repeated complaints that Cordova apps can get stuck \"offline\", e.g.\n        // https://forum.ionicframework.com/t/firebase-connection-is-lost-and-never-come-back/43810\n        // It would seem that the 'online' event does not always fire consistently. So we disable it\n        // for Cordova.\n        if (typeof window !== 'undefined' &&\n            typeof window.addEventListener !== 'undefined' &&\n            !util_2.isMobileCordova()) {\n            window.addEventListener('online', function () {\n                if (!_this.online_) {\n                    _this.online_ = true;\n                    _this.trigger('online', true);\n                }\n            }, false);\n            window.addEventListener('offline', function () {\n                if (_this.online_) {\n                    _this.online_ = false;\n                    _this.trigger('online', false);\n                }\n            }, false);\n        }\n        return _this;\n    }\n    OnlineMonitor.getInstance = function () {\n        return new OnlineMonitor();\n    };\n    /**\n     * @param {!string} eventType\n     * @return {Array.<boolean>}\n     */\n    OnlineMonitor.prototype.getInitialEvent = function (eventType) {\n        util_1.assert(eventType === 'online', 'Unknown event type: ' + eventType);\n        return [this.online_];\n    };\n    /**\n     * @return {boolean}\n     */\n    OnlineMonitor.prototype.currentlyOnline = function () {\n        return this.online_;\n    };\n    return OnlineMonitor;\n}(EventEmitter_1.EventEmitter));\nexports.OnlineMonitor = OnlineMonitor;\n\n\n\n},{\"./EventEmitter\":53,\"@firebase/util\":134}],57:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"./util\");\nvar util_2 = require(\"@firebase/util\");\n/**\n * An immutable object representing a parsed path.  It's immutable so that you\n * can pass them around to other functions without worrying about them changing\n * it.\n */\nvar Path = /** @class */ (function () {\n    /**\n     * @param {string|Array.<string>} pathOrString Path string to parse,\n     *      or another path, or the raw tokens array\n     * @param {number=} pieceNum\n     */\n    function Path(pathOrString, pieceNum) {\n        if (pieceNum === void 0) {\n            this.pieces_ = pathOrString.split('/');\n            // Remove empty pieces.\n            var copyTo = 0;\n            for (var i = 0; i < this.pieces_.length; i++) {\n                if (this.pieces_[i].length > 0) {\n                    this.pieces_[copyTo] = this.pieces_[i];\n                    copyTo++;\n                }\n            }\n            this.pieces_.length = copyTo;\n            this.pieceNum_ = 0;\n        }\n        else {\n            this.pieces_ = pathOrString;\n            this.pieceNum_ = pieceNum;\n        }\n    }\n    Object.defineProperty(Path, \"Empty\", {\n        /**\n         * Singleton to represent an empty path\n         *\n         * @const\n         */\n        get: function () {\n            return new Path('');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Path.prototype.getFront = function () {\n        if (this.pieceNum_ >= this.pieces_.length)\n            return null;\n        return this.pieces_[this.pieceNum_];\n    };\n    /**\n     * @return {number} The number of segments in this path\n     */\n    Path.prototype.getLength = function () {\n        return this.pieces_.length - this.pieceNum_;\n    };\n    /**\n     * @return {!Path}\n     */\n    Path.prototype.popFront = function () {\n        var pieceNum = this.pieceNum_;\n        if (pieceNum < this.pieces_.length) {\n            pieceNum++;\n        }\n        return new Path(this.pieces_, pieceNum);\n    };\n    /**\n     * @return {?string}\n     */\n    Path.prototype.getBack = function () {\n        if (this.pieceNum_ < this.pieces_.length)\n            return this.pieces_[this.pieces_.length - 1];\n        return null;\n    };\n    Path.prototype.toString = function () {\n        var pathString = '';\n        for (var i = this.pieceNum_; i < this.pieces_.length; i++) {\n            if (this.pieces_[i] !== '')\n                pathString += '/' + this.pieces_[i];\n        }\n        return pathString || '/';\n    };\n    Path.prototype.toUrlEncodedString = function () {\n        var pathString = '';\n        for (var i = this.pieceNum_; i < this.pieces_.length; i++) {\n            if (this.pieces_[i] !== '')\n                pathString += '/' + encodeURIComponent(String(this.pieces_[i]));\n        }\n        return pathString || '/';\n    };\n    /**\n     * Shallow copy of the parts of the path.\n     *\n     * @param {number=} begin\n     * @return {!Array<string>}\n     */\n    Path.prototype.slice = function (begin) {\n        if (begin === void 0) { begin = 0; }\n        return this.pieces_.slice(this.pieceNum_ + begin);\n    };\n    /**\n     * @return {?Path}\n     */\n    Path.prototype.parent = function () {\n        if (this.pieceNum_ >= this.pieces_.length)\n            return null;\n        var pieces = [];\n        for (var i = this.pieceNum_; i < this.pieces_.length - 1; i++)\n            pieces.push(this.pieces_[i]);\n        return new Path(pieces, 0);\n    };\n    /**\n     * @param {string|!Path} childPathObj\n     * @return {!Path}\n     */\n    Path.prototype.child = function (childPathObj) {\n        var pieces = [];\n        for (var i = this.pieceNum_; i < this.pieces_.length; i++)\n            pieces.push(this.pieces_[i]);\n        if (childPathObj instanceof Path) {\n            for (var i = childPathObj.pieceNum_; i < childPathObj.pieces_.length; i++) {\n                pieces.push(childPathObj.pieces_[i]);\n            }\n        }\n        else {\n            var childPieces = childPathObj.split('/');\n            for (var i = 0; i < childPieces.length; i++) {\n                if (childPieces[i].length > 0)\n                    pieces.push(childPieces[i]);\n            }\n        }\n        return new Path(pieces, 0);\n    };\n    /**\n     * @return {boolean} True if there are no segments in this path\n     */\n    Path.prototype.isEmpty = function () {\n        return this.pieceNum_ >= this.pieces_.length;\n    };\n    /**\n     * @param {!Path} outerPath\n     * @param {!Path} innerPath\n     * @return {!Path} The path from outerPath to innerPath\n     */\n    Path.relativePath = function (outerPath, innerPath) {\n        var outer = outerPath.getFront(), inner = innerPath.getFront();\n        if (outer === null) {\n            return innerPath;\n        }\n        else if (outer === inner) {\n            return Path.relativePath(outerPath.popFront(), innerPath.popFront());\n        }\n        else {\n            throw new Error('INTERNAL ERROR: innerPath (' +\n                innerPath +\n                ') is not within ' +\n                'outerPath (' +\n                outerPath +\n                ')');\n        }\n    };\n    /**\n     * @param {!Path} left\n     * @param {!Path} right\n     * @return {number} -1, 0, 1 if left is less, equal, or greater than the right.\n     */\n    Path.comparePaths = function (left, right) {\n        var leftKeys = left.slice();\n        var rightKeys = right.slice();\n        for (var i = 0; i < leftKeys.length && i < rightKeys.length; i++) {\n            var cmp = util_1.nameCompare(leftKeys[i], rightKeys[i]);\n            if (cmp !== 0)\n                return cmp;\n        }\n        if (leftKeys.length === rightKeys.length)\n            return 0;\n        return leftKeys.length < rightKeys.length ? -1 : 1;\n    };\n    /**\n     *\n     * @param {Path} other\n     * @return {boolean} true if paths are the same.\n     */\n    Path.prototype.equals = function (other) {\n        if (this.getLength() !== other.getLength()) {\n            return false;\n        }\n        for (var i = this.pieceNum_, j = other.pieceNum_; i <= this.pieces_.length; i++, j++) {\n            if (this.pieces_[i] !== other.pieces_[j]) {\n                return false;\n            }\n        }\n        return true;\n    };\n    /**\n     *\n     * @param {!Path} other\n     * @return {boolean} True if this path is a parent (or the same as) other\n     */\n    Path.prototype.contains = function (other) {\n        var i = this.pieceNum_;\n        var j = other.pieceNum_;\n        if (this.getLength() > other.getLength()) {\n            return false;\n        }\n        while (i < this.pieces_.length) {\n            if (this.pieces_[i] !== other.pieces_[j]) {\n                return false;\n            }\n            ++i;\n            ++j;\n        }\n        return true;\n    };\n    return Path;\n}()); // end Path\nexports.Path = Path;\n/**\n * Dynamic (mutable) path used to count path lengths.\n *\n * This class is used to efficiently check paths for valid\n * length (in UTF8 bytes) and depth (used in path validation).\n *\n * Throws Error exception if path is ever invalid.\n *\n * The definition of a path always begins with '/'.\n */\nvar ValidationPath = /** @class */ (function () {\n    /**\n     * @param {!Path} path Initial Path.\n     * @param {string} errorPrefix_ Prefix for any error messages.\n     */\n    function ValidationPath(path, errorPrefix_) {\n        this.errorPrefix_ = errorPrefix_;\n        /** @type {!Array<string>} */\n        this.parts_ = path.slice();\n        /** @type {number} Initialize to number of '/' chars needed in path. */\n        this.byteLength_ = Math.max(1, this.parts_.length);\n        for (var i = 0; i < this.parts_.length; i++) {\n            this.byteLength_ += util_2.stringLength(this.parts_[i]);\n        }\n        this.checkValid_();\n    }\n    Object.defineProperty(ValidationPath, \"MAX_PATH_DEPTH\", {\n        /** @const {number} Maximum key depth. */\n        get: function () {\n            return 32;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ValidationPath, \"MAX_PATH_LENGTH_BYTES\", {\n        /** @const {number} Maximum number of (UTF8) bytes in a Firebase path. */\n        get: function () {\n            return 768;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /** @param {string} child */\n    ValidationPath.prototype.push = function (child) {\n        // Count the needed '/'\n        if (this.parts_.length > 0) {\n            this.byteLength_ += 1;\n        }\n        this.parts_.push(child);\n        this.byteLength_ += util_2.stringLength(child);\n        this.checkValid_();\n    };\n    ValidationPath.prototype.pop = function () {\n        var last = this.parts_.pop();\n        this.byteLength_ -= util_2.stringLength(last);\n        // Un-count the previous '/'\n        if (this.parts_.length > 0) {\n            this.byteLength_ -= 1;\n        }\n    };\n    ValidationPath.prototype.checkValid_ = function () {\n        if (this.byteLength_ > ValidationPath.MAX_PATH_LENGTH_BYTES) {\n            throw new Error(this.errorPrefix_ +\n                'has a key path longer than ' +\n                ValidationPath.MAX_PATH_LENGTH_BYTES +\n                ' bytes (' +\n                this.byteLength_ +\n                ').');\n        }\n        if (this.parts_.length > ValidationPath.MAX_PATH_DEPTH) {\n            throw new Error(this.errorPrefix_ +\n                'path specified exceeds the maximum depth that can be written (' +\n                ValidationPath.MAX_PATH_DEPTH +\n                ') or object contains a cycle ' +\n                this.toErrorString());\n        }\n    };\n    /**\n     * String for use in error messages - uses '.' notation for path.\n     *\n     * @return {string}\n     */\n    ValidationPath.prototype.toErrorString = function () {\n        if (this.parts_.length == 0) {\n            return '';\n        }\n        return \"in property '\" + this.parts_.join('.') + \"'\";\n    };\n    return ValidationPath;\n}());\nexports.ValidationPath = ValidationPath;\n\n\n\n},{\"./util\":63,\"@firebase/util\":134}],58:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\nvar Path_1 = require(\"./Path\");\nvar SparseSnapshotTree_1 = require(\"../SparseSnapshotTree\");\nvar LeafNode_1 = require(\"../snap/LeafNode\");\nvar nodeFromJSON_1 = require(\"../snap/nodeFromJSON\");\nvar PriorityIndex_1 = require(\"../snap/indexes/PriorityIndex\");\n/**\n * Generate placeholders for deferred values.\n * @param {?Object} values\n * @return {!Object}\n */\nexports.generateWithValues = function (values) {\n    values = values || {};\n    values['timestamp'] = values['timestamp'] || new Date().getTime();\n    return values;\n};\n/**\n * Value to use when firing local events. When writing server values, fire\n * local events with an approximate value, otherwise return value as-is.\n * @param {(Object|string|number|boolean)} value\n * @param {!Object} serverValues\n * @return {!(string|number|boolean)}\n */\nexports.resolveDeferredValue = function (value, serverValues) {\n    if (!value || typeof value !== 'object') {\n        return value;\n    }\n    else {\n        util_1.assert('.sv' in value, 'Unexpected leaf node or priority contents');\n        return serverValues[value['.sv']];\n    }\n};\n/**\n * Recursively replace all deferred values and priorities in the tree with the\n * specified generated replacement values.\n * @param {!SparseSnapshotTree} tree\n * @param {!Object} serverValues\n * @return {!SparseSnapshotTree}\n */\nexports.resolveDeferredValueTree = function (tree, serverValues) {\n    var resolvedTree = new SparseSnapshotTree_1.SparseSnapshotTree();\n    tree.forEachTree(new Path_1.Path(''), function (path, node) {\n        resolvedTree.remember(path, exports.resolveDeferredValueSnapshot(node, serverValues));\n    });\n    return resolvedTree;\n};\n/**\n * Recursively replace all deferred values and priorities in the node with the\n * specified generated replacement values.  If there are no server values in the node,\n * it'll be returned as-is.\n * @param {!Node} node\n * @param {!Object} serverValues\n * @return {!Node}\n */\nexports.resolveDeferredValueSnapshot = function (node, serverValues) {\n    var rawPri = node.getPriority().val();\n    var priority = exports.resolveDeferredValue(rawPri, serverValues);\n    var newNode;\n    if (node.isLeafNode()) {\n        var leafNode = node;\n        var value = exports.resolveDeferredValue(leafNode.getValue(), serverValues);\n        if (value !== leafNode.getValue() ||\n            priority !== leafNode.getPriority().val()) {\n            return new LeafNode_1.LeafNode(value, nodeFromJSON_1.nodeFromJSON(priority));\n        }\n        else {\n            return node;\n        }\n    }\n    else {\n        var childrenNode = node;\n        newNode = childrenNode;\n        if (priority !== childrenNode.getPriority().val()) {\n            newNode = newNode.updatePriority(new LeafNode_1.LeafNode(priority));\n        }\n        childrenNode.forEachChild(PriorityIndex_1.PRIORITY_INDEX, function (childName, childNode) {\n            var newChildNode = exports.resolveDeferredValueSnapshot(childNode, serverValues);\n            if (newChildNode !== childNode) {\n                newNode = newNode.updateImmediateChild(childName, newChildNode);\n            }\n        });\n        return newNode;\n    }\n};\n\n\n\n},{\"../SparseSnapshotTree\":23,\"../snap/LeafNode\":34,\"../snap/indexes/PriorityIndex\":41,\"../snap/nodeFromJSON\":43,\"./Path\":57,\"@firebase/util\":134}],59:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * An iterator over an LLRBNode.\n */\nvar SortedMapIterator = /** @class */ (function () {\n    /**\n     * @template K, V, T\n     * @param {LLRBNode|LLRBEmptyNode} node Node to iterate.\n     * @param {?K} startKey\n     * @param {function(K, K): number} comparator\n     * @param {boolean} isReverse_ Whether or not to iterate in reverse\n     * @param {(function(K, V):T)=} resultGenerator_\n     */\n    function SortedMapIterator(node, startKey, comparator, isReverse_, resultGenerator_) {\n        if (resultGenerator_ === void 0) { resultGenerator_ = null; }\n        this.isReverse_ = isReverse_;\n        this.resultGenerator_ = resultGenerator_;\n        /** @private\n         * @type {Array.<!LLRBNode>}\n         */\n        this.nodeStack_ = [];\n        var cmp = 1;\n        while (!node.isEmpty()) {\n            node = node;\n            cmp = startKey ? comparator(node.key, startKey) : 1;\n            // flip the comparison if we're going in reverse\n            if (isReverse_)\n                cmp *= -1;\n            if (cmp < 0) {\n                // This node is less than our start key. ignore it\n                if (this.isReverse_) {\n                    node = node.left;\n                }\n                else {\n                    node = node.right;\n                }\n            }\n            else if (cmp === 0) {\n                // This node is exactly equal to our start key. Push it on the stack, but stop iterating;\n                this.nodeStack_.push(node);\n                break;\n            }\n            else {\n                // This node is greater than our start key, add it to the stack and move to the next one\n                this.nodeStack_.push(node);\n                if (this.isReverse_) {\n                    node = node.right;\n                }\n                else {\n                    node = node.left;\n                }\n            }\n        }\n    }\n    SortedMapIterator.prototype.getNext = function () {\n        if (this.nodeStack_.length === 0)\n            return null;\n        var node = this.nodeStack_.pop();\n        var result;\n        if (this.resultGenerator_)\n            result = this.resultGenerator_(node.key, node.value);\n        else\n            result = { key: node.key, value: node.value };\n        if (this.isReverse_) {\n            node = node.left;\n            while (!node.isEmpty()) {\n                this.nodeStack_.push(node);\n                node = node.right;\n            }\n        }\n        else {\n            node = node.right;\n            while (!node.isEmpty()) {\n                this.nodeStack_.push(node);\n                node = node.left;\n            }\n        }\n        return result;\n    };\n    SortedMapIterator.prototype.hasNext = function () {\n        return this.nodeStack_.length > 0;\n    };\n    SortedMapIterator.prototype.peek = function () {\n        if (this.nodeStack_.length === 0)\n            return null;\n        var node = this.nodeStack_[this.nodeStack_.length - 1];\n        if (this.resultGenerator_) {\n            return this.resultGenerator_(node.key, node.value);\n        }\n        else {\n            return { key: node.key, value: node.value };\n        }\n    };\n    return SortedMapIterator;\n}());\nexports.SortedMapIterator = SortedMapIterator;\n/**\n * Represents a node in a Left-leaning Red-Black tree.\n */\nvar LLRBNode = /** @class */ (function () {\n    /**\n     * @template K, V\n     * @param {!K} key Key associated with this node.\n     * @param {!V} value Value associated with this node.\n     * @param {?boolean} color Whether this node is red.\n     * @param {?(LLRBNode|LLRBEmptyNode)=} left Left child.\n     * @param {?(LLRBNode|LLRBEmptyNode)=} right Right child.\n     */\n    function LLRBNode(key, value, color, left, right) {\n        this.key = key;\n        this.value = value;\n        this.color = color != null ? color : LLRBNode.RED;\n        this.left =\n            left != null ? left : SortedMap.EMPTY_NODE;\n        this.right =\n            right != null ? right : SortedMap.EMPTY_NODE;\n    }\n    /**\n     * Returns a copy of the current node, optionally replacing pieces of it.\n     *\n     * @param {?K} key New key for the node, or null.\n     * @param {?V} value New value for the node, or null.\n     * @param {?boolean} color New color for the node, or null.\n     * @param {?LLRBNode|LLRBEmptyNode} left New left child for the node, or null.\n     * @param {?LLRBNode|LLRBEmptyNode} right New right child for the node, or null.\n     * @return {!LLRBNode} The node copy.\n     */\n    LLRBNode.prototype.copy = function (key, value, color, left, right) {\n        return new LLRBNode(key != null ? key : this.key, value != null ? value : this.value, color != null ? color : this.color, left != null ? left : this.left, right != null ? right : this.right);\n    };\n    /**\n     * @return {number} The total number of nodes in the tree.\n     */\n    LLRBNode.prototype.count = function () {\n        return this.left.count() + 1 + this.right.count();\n    };\n    /**\n     * @return {boolean} True if the tree is empty.\n     */\n    LLRBNode.prototype.isEmpty = function () {\n        return false;\n    };\n    /**\n     * Traverses the tree in key order and calls the specified action function\n     * for each node.\n     *\n     * @param {function(!K, !V):*} action Callback function to be called for each\n     *   node.  If it returns true, traversal is aborted.\n     * @return {*} The first truthy value returned by action, or the last falsey\n     *   value returned by action\n     */\n    LLRBNode.prototype.inorderTraversal = function (action) {\n        return (this.left.inorderTraversal(action) ||\n            action(this.key, this.value) ||\n            this.right.inorderTraversal(action));\n    };\n    /**\n     * Traverses the tree in reverse key order and calls the specified action function\n     * for each node.\n     *\n     * @param {function(!Object, !Object)} action Callback function to be called for each\n     * node.  If it returns true, traversal is aborted.\n     * @return {*} True if traversal was aborted.\n     */\n    LLRBNode.prototype.reverseTraversal = function (action) {\n        return (this.right.reverseTraversal(action) ||\n            action(this.key, this.value) ||\n            this.left.reverseTraversal(action));\n    };\n    /**\n     * @return {!Object} The minimum node in the tree.\n     * @private\n     */\n    LLRBNode.prototype.min_ = function () {\n        if (this.left.isEmpty()) {\n            return this;\n        }\n        else {\n            return this.left.min_();\n        }\n    };\n    /**\n     * @return {!K} The maximum key in the tree.\n     */\n    LLRBNode.prototype.minKey = function () {\n        return this.min_().key;\n    };\n    /**\n     * @return {!K} The maximum key in the tree.\n     */\n    LLRBNode.prototype.maxKey = function () {\n        if (this.right.isEmpty()) {\n            return this.key;\n        }\n        else {\n            return this.right.maxKey();\n        }\n    };\n    /**\n     *\n     * @param {!Object} key Key to insert.\n     * @param {!Object} value Value to insert.\n     * @param {Comparator} comparator Comparator.\n     * @return {!LLRBNode} New tree, with the key/value added.\n     */\n    LLRBNode.prototype.insert = function (key, value, comparator) {\n        var cmp, n;\n        n = this;\n        cmp = comparator(key, n.key);\n        if (cmp < 0) {\n            n = n.copy(null, null, null, n.left.insert(key, value, comparator), null);\n        }\n        else if (cmp === 0) {\n            n = n.copy(null, value, null, null, null);\n        }\n        else {\n            n = n.copy(null, null, null, null, n.right.insert(key, value, comparator));\n        }\n        return n.fixUp_();\n    };\n    /**\n     * @private\n     * @return {!LLRBNode|LLRBEmptyNode} New tree, with the minimum key removed.\n     */\n    LLRBNode.prototype.removeMin_ = function () {\n        if (this.left.isEmpty()) {\n            return SortedMap.EMPTY_NODE;\n        }\n        var n = this;\n        if (!n.left.isRed_() && !n.left.left.isRed_())\n            n = n.moveRedLeft_();\n        n = n.copy(null, null, null, n.left.removeMin_(), null);\n        return n.fixUp_();\n    };\n    /**\n     * @param {!Object} key The key of the item to remove.\n     * @param {Comparator} comparator Comparator.\n     * @return {!LLRBNode|LLRBEmptyNode} New tree, with the specified item removed.\n     */\n    LLRBNode.prototype.remove = function (key, comparator) {\n        var n, smallest;\n        n = this;\n        if (comparator(key, n.key) < 0) {\n            if (!n.left.isEmpty() && !n.left.isRed_() && !n.left.left.isRed_()) {\n                n = n.moveRedLeft_();\n            }\n            n = n.copy(null, null, null, n.left.remove(key, comparator), null);\n        }\n        else {\n            if (n.left.isRed_())\n                n = n.rotateRight_();\n            if (!n.right.isEmpty() && !n.right.isRed_() && !n.right.left.isRed_()) {\n                n = n.moveRedRight_();\n            }\n            if (comparator(key, n.key) === 0) {\n                if (n.right.isEmpty()) {\n                    return SortedMap.EMPTY_NODE;\n                }\n                else {\n                    smallest = n.right.min_();\n                    n = n.copy(smallest.key, smallest.value, null, null, n.right.removeMin_());\n                }\n            }\n            n = n.copy(null, null, null, null, n.right.remove(key, comparator));\n        }\n        return n.fixUp_();\n    };\n    /**\n     * @private\n     * @return {boolean} Whether this is a RED node.\n     */\n    LLRBNode.prototype.isRed_ = function () {\n        return this.color;\n    };\n    /**\n     * @private\n     * @return {!LLRBNode} New tree after performing any needed rotations.\n     */\n    LLRBNode.prototype.fixUp_ = function () {\n        var n = this;\n        if (n.right.isRed_() && !n.left.isRed_())\n            n = n.rotateLeft_();\n        if (n.left.isRed_() && n.left.left.isRed_())\n            n = n.rotateRight_();\n        if (n.left.isRed_() && n.right.isRed_())\n            n = n.colorFlip_();\n        return n;\n    };\n    /**\n     * @private\n     * @return {!LLRBNode} New tree, after moveRedLeft.\n     */\n    LLRBNode.prototype.moveRedLeft_ = function () {\n        var n = this.colorFlip_();\n        if (n.right.left.isRed_()) {\n            n = n.copy(null, null, null, null, n.right.rotateRight_());\n            n = n.rotateLeft_();\n            n = n.colorFlip_();\n        }\n        return n;\n    };\n    /**\n     * @private\n     * @return {!LLRBNode} New tree, after moveRedRight.\n     */\n    LLRBNode.prototype.moveRedRight_ = function () {\n        var n = this.colorFlip_();\n        if (n.left.left.isRed_()) {\n            n = n.rotateRight_();\n            n = n.colorFlip_();\n        }\n        return n;\n    };\n    /**\n     * @private\n     * @return {!LLRBNode} New tree, after rotateLeft.\n     */\n    LLRBNode.prototype.rotateLeft_ = function () {\n        var nl = this.copy(null, null, LLRBNode.RED, null, this.right.left);\n        return this.right.copy(null, null, this.color, nl, null);\n    };\n    /**\n     * @private\n     * @return {!LLRBNode} New tree, after rotateRight.\n     */\n    LLRBNode.prototype.rotateRight_ = function () {\n        var nr = this.copy(null, null, LLRBNode.RED, this.left.right, null);\n        return this.left.copy(null, null, this.color, null, nr);\n    };\n    /**\n     * @private\n     * @return {!LLRBNode} New tree, after colorFlip.\n     */\n    LLRBNode.prototype.colorFlip_ = function () {\n        var left = this.left.copy(null, null, !this.left.color, null, null);\n        var right = this.right.copy(null, null, !this.right.color, null, null);\n        return this.copy(null, null, !this.color, left, right);\n    };\n    /**\n     * For testing.\n     *\n     * @private\n     * @return {boolean} True if all is well.\n     */\n    LLRBNode.prototype.checkMaxDepth_ = function () {\n        var blackDepth = this.check_();\n        return Math.pow(2.0, blackDepth) <= this.count() + 1;\n    };\n    /**\n     * @private\n     * @return {number} Not sure what this returns exactly. :-).\n     */\n    LLRBNode.prototype.check_ = function () {\n        var blackDepth;\n        if (this.isRed_() && this.left.isRed_()) {\n            throw new Error('Red node has red child(' + this.key + ',' + this.value + ')');\n        }\n        if (this.right.isRed_()) {\n            throw new Error('Right child of (' + this.key + ',' + this.value + ') is red');\n        }\n        blackDepth = this.left.check_();\n        if (blackDepth !== this.right.check_()) {\n            throw new Error('Black depths differ');\n        }\n        else {\n            return blackDepth + (this.isRed_() ? 0 : 1);\n        }\n    };\n    LLRBNode.RED = true;\n    LLRBNode.BLACK = false;\n    return LLRBNode;\n}());\nexports.LLRBNode = LLRBNode;\n/**\n * Represents an empty node (a leaf node in the Red-Black Tree).\n */\nvar LLRBEmptyNode = /** @class */ (function () {\n    function LLRBEmptyNode() {\n    }\n    /**\n     * Returns a copy of the current node.\n     *\n     * @return {!LLRBEmptyNode} The node copy.\n     */\n    LLRBEmptyNode.prototype.copy = function (key, value, color, left, right) {\n        return this;\n    };\n    /**\n     * Returns a copy of the tree, with the specified key/value added.\n     *\n     * @param {!K} key Key to be added.\n     * @param {!V} value Value to be added.\n     * @param {Comparator} comparator Comparator.\n     * @return {!LLRBNode} New tree, with item added.\n     */\n    LLRBEmptyNode.prototype.insert = function (key, value, comparator) {\n        return new LLRBNode(key, value, null);\n    };\n    /**\n     * Returns a copy of the tree, with the specified key removed.\n     *\n     * @param {!K} key The key to remove.\n     * @param {Comparator} comparator Comparator.\n     * @return {!LLRBEmptyNode} New tree, with item removed.\n     */\n    LLRBEmptyNode.prototype.remove = function (key, comparator) {\n        return this;\n    };\n    /**\n     * @return {number} The total number of nodes in the tree.\n     */\n    LLRBEmptyNode.prototype.count = function () {\n        return 0;\n    };\n    /**\n     * @return {boolean} True if the tree is empty.\n     */\n    LLRBEmptyNode.prototype.isEmpty = function () {\n        return true;\n    };\n    /**\n     * Traverses the tree in key order and calls the specified action function\n     * for each node.\n     *\n     * @param {function(!K, !V):*} action Callback function to be called for each\n     * node.  If it returns true, traversal is aborted.\n     * @return {boolean} True if traversal was aborted.\n     */\n    LLRBEmptyNode.prototype.inorderTraversal = function (action) {\n        return false;\n    };\n    /**\n     * Traverses the tree in reverse key order and calls the specified action function\n     * for each node.\n     *\n     * @param {function(!K, !V)} action Callback function to be called for each\n     * node.  If it returns true, traversal is aborted.\n     * @return {boolean} True if traversal was aborted.\n     */\n    LLRBEmptyNode.prototype.reverseTraversal = function (action) {\n        return false;\n    };\n    /**\n     * @return {null}\n     */\n    LLRBEmptyNode.prototype.minKey = function () {\n        return null;\n    };\n    /**\n     * @return {null}\n     */\n    LLRBEmptyNode.prototype.maxKey = function () {\n        return null;\n    };\n    /**\n     * @private\n     * @return {number} Not sure what this returns exactly. :-).\n     */\n    LLRBEmptyNode.prototype.check_ = function () {\n        return 0;\n    };\n    /**\n     * @private\n     * @return {boolean} Whether this node is red.\n     */\n    LLRBEmptyNode.prototype.isRed_ = function () {\n        return false;\n    };\n    return LLRBEmptyNode;\n}());\nexports.LLRBEmptyNode = LLRBEmptyNode;\n/**\n * An immutable sorted map implementation, based on a Left-leaning Red-Black\n * tree.\n */\nvar SortedMap = /** @class */ (function () {\n    /**\n     * @template K, V\n     * @param {function(K, K):number} comparator_ Key comparator.\n     * @param {LLRBNode=} root_ (Optional) Root node for the map.\n     */\n    function SortedMap(comparator_, root_) {\n        if (root_ === void 0) { root_ = SortedMap.EMPTY_NODE; }\n        this.comparator_ = comparator_;\n        this.root_ = root_;\n    }\n    /**\n     * Returns a copy of the map, with the specified key/value added or replaced.\n     * (TODO: We should perhaps rename this method to 'put')\n     *\n     * @param {!K} key Key to be added.\n     * @param {!V} value Value to be added.\n     * @return {!SortedMap.<K, V>} New map, with item added.\n     */\n    SortedMap.prototype.insert = function (key, value) {\n        return new SortedMap(this.comparator_, this.root_\n            .insert(key, value, this.comparator_)\n            .copy(null, null, LLRBNode.BLACK, null, null));\n    };\n    /**\n     * Returns a copy of the map, with the specified key removed.\n     *\n     * @param {!K} key The key to remove.\n     * @return {!SortedMap.<K, V>} New map, with item removed.\n     */\n    SortedMap.prototype.remove = function (key) {\n        return new SortedMap(this.comparator_, this.root_\n            .remove(key, this.comparator_)\n            .copy(null, null, LLRBNode.BLACK, null, null));\n    };\n    /**\n     * Returns the value of the node with the given key, or null.\n     *\n     * @param {!K} key The key to look up.\n     * @return {?V} The value of the node with the given key, or null if the\n     * key doesn't exist.\n     */\n    SortedMap.prototype.get = function (key) {\n        var cmp;\n        var node = this.root_;\n        while (!node.isEmpty()) {\n            cmp = this.comparator_(key, node.key);\n            if (cmp === 0) {\n                return node.value;\n            }\n            else if (cmp < 0) {\n                node = node.left;\n            }\n            else if (cmp > 0) {\n                node = node.right;\n            }\n        }\n        return null;\n    };\n    /**\n     * Returns the key of the item *before* the specified key, or null if key is the first item.\n     * @param {K} key The key to find the predecessor of\n     * @return {?K} The predecessor key.\n     */\n    SortedMap.prototype.getPredecessorKey = function (key) {\n        var cmp, node = this.root_, rightParent = null;\n        while (!node.isEmpty()) {\n            cmp = this.comparator_(key, node.key);\n            if (cmp === 0) {\n                if (!node.left.isEmpty()) {\n                    node = node.left;\n                    while (!node.right.isEmpty())\n                        node = node.right;\n                    return node.key;\n                }\n                else if (rightParent) {\n                    return rightParent.key;\n                }\n                else {\n                    return null; // first item.\n                }\n            }\n            else if (cmp < 0) {\n                node = node.left;\n            }\n            else if (cmp > 0) {\n                rightParent = node;\n                node = node.right;\n            }\n        }\n        throw new Error('Attempted to find predecessor key for a nonexistent key.  What gives?');\n    };\n    /**\n     * @return {boolean} True if the map is empty.\n     */\n    SortedMap.prototype.isEmpty = function () {\n        return this.root_.isEmpty();\n    };\n    /**\n     * @return {number} The total number of nodes in the map.\n     */\n    SortedMap.prototype.count = function () {\n        return this.root_.count();\n    };\n    /**\n     * @return {?K} The minimum key in the map.\n     */\n    SortedMap.prototype.minKey = function () {\n        return this.root_.minKey();\n    };\n    /**\n     * @return {?K} The maximum key in the map.\n     */\n    SortedMap.prototype.maxKey = function () {\n        return this.root_.maxKey();\n    };\n    /**\n     * Traverses the map in key order and calls the specified action function\n     * for each key/value pair.\n     *\n     * @param {function(!K, !V):*} action Callback function to be called\n     * for each key/value pair.  If action returns true, traversal is aborted.\n     * @return {*} The first truthy value returned by action, or the last falsey\n     *   value returned by action\n     */\n    SortedMap.prototype.inorderTraversal = function (action) {\n        return this.root_.inorderTraversal(action);\n    };\n    /**\n     * Traverses the map in reverse key order and calls the specified action function\n     * for each key/value pair.\n     *\n     * @param {function(!Object, !Object)} action Callback function to be called\n     * for each key/value pair.  If action returns true, traversal is aborted.\n     * @return {*} True if the traversal was aborted.\n     */\n    SortedMap.prototype.reverseTraversal = function (action) {\n        return this.root_.reverseTraversal(action);\n    };\n    /**\n     * Returns an iterator over the SortedMap.\n     * @template T\n     * @param {(function(K, V):T)=} resultGenerator\n     * @return {SortedMapIterator.<K, V, T>} The iterator.\n     */\n    SortedMap.prototype.getIterator = function (resultGenerator) {\n        return new SortedMapIterator(this.root_, null, this.comparator_, false, resultGenerator);\n    };\n    SortedMap.prototype.getIteratorFrom = function (key, resultGenerator) {\n        return new SortedMapIterator(this.root_, key, this.comparator_, false, resultGenerator);\n    };\n    SortedMap.prototype.getReverseIteratorFrom = function (key, resultGenerator) {\n        return new SortedMapIterator(this.root_, key, this.comparator_, true, resultGenerator);\n    };\n    SortedMap.prototype.getReverseIterator = function (resultGenerator) {\n        return new SortedMapIterator(this.root_, null, this.comparator_, true, resultGenerator);\n    };\n    /**\n     * Always use the same empty node, to reduce memory.\n     * @const\n     */\n    SortedMap.EMPTY_NODE = new LLRBEmptyNode();\n    return SortedMap;\n}());\nexports.SortedMap = SortedMap;\n\n\n\n},{}],60:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\nvar Path_1 = require(\"./Path\");\nvar util_2 = require(\"@firebase/util\");\n/**\n * Node in a Tree.\n */\nvar TreeNode = /** @class */ (function () {\n    function TreeNode() {\n        // TODO: Consider making accessors that create children and value lazily or\n        // separate Internal / Leaf 'types'.\n        this.children = {};\n        this.childCount = 0;\n        this.value = null;\n    }\n    return TreeNode;\n}());\nexports.TreeNode = TreeNode;\n/**\n * A light-weight tree, traversable by path.  Nodes can have both values and children.\n * Nodes are not enumerated (by forEachChild) unless they have a value or non-empty\n * children.\n */\nvar Tree = /** @class */ (function () {\n    /**\n     * @template T\n     * @param {string=} name_ Optional name of the node.\n     * @param {Tree=} parent_ Optional parent node.\n     * @param {TreeNode=} node_ Optional node to wrap.\n     */\n    function Tree(name_, parent_, node_) {\n        if (name_ === void 0) { name_ = ''; }\n        if (parent_ === void 0) { parent_ = null; }\n        if (node_ === void 0) { node_ = new TreeNode(); }\n        this.name_ = name_;\n        this.parent_ = parent_;\n        this.node_ = node_;\n    }\n    /**\n     * Returns a sub-Tree for the given path.\n     *\n     * @param {!(string|Path)} pathObj Path to look up.\n     * @return {!Tree.<T>} Tree for path.\n     */\n    Tree.prototype.subTree = function (pathObj) {\n        // TODO: Require pathObj to be Path?\n        var path = pathObj instanceof Path_1.Path ? pathObj : new Path_1.Path(pathObj);\n        var child = this, next;\n        while ((next = path.getFront()) !== null) {\n            var childNode = util_2.safeGet(child.node_.children, next) || new TreeNode();\n            child = new Tree(next, child, childNode);\n            path = path.popFront();\n        }\n        return child;\n    };\n    /**\n     * Returns the data associated with this tree node.\n     *\n     * @return {?T} The data or null if no data exists.\n     */\n    Tree.prototype.getValue = function () {\n        return this.node_.value;\n    };\n    /**\n     * Sets data to this tree node.\n     *\n     * @param {!T} value Value to set.\n     */\n    Tree.prototype.setValue = function (value) {\n        util_1.assert(typeof value !== 'undefined', 'Cannot set value to undefined');\n        this.node_.value = value;\n        this.updateParents_();\n    };\n    /**\n     * Clears the contents of the tree node (its value and all children).\n     */\n    Tree.prototype.clear = function () {\n        this.node_.value = null;\n        this.node_.children = {};\n        this.node_.childCount = 0;\n        this.updateParents_();\n    };\n    /**\n     * @return {boolean} Whether the tree has any children.\n     */\n    Tree.prototype.hasChildren = function () {\n        return this.node_.childCount > 0;\n    };\n    /**\n     * @return {boolean} Whether the tree is empty (no value or children).\n     */\n    Tree.prototype.isEmpty = function () {\n        return this.getValue() === null && !this.hasChildren();\n    };\n    /**\n     * Calls action for each child of this tree node.\n     *\n     * @param {function(!Tree.<T>)} action Action to be called for each child.\n     */\n    Tree.prototype.forEachChild = function (action) {\n        var _this = this;\n        util_2.forEach(this.node_.children, function (child, childTree) {\n            action(new Tree(child, _this, childTree));\n        });\n    };\n    /**\n     * Does a depth-first traversal of this node's descendants, calling action for each one.\n     *\n     * @param {function(!Tree.<T>)} action Action to be called for each child.\n     * @param {boolean=} includeSelf Whether to call action on this node as well. Defaults to\n     *   false.\n     * @param {boolean=} childrenFirst Whether to call action on children before calling it on\n     *   parent.\n     */\n    Tree.prototype.forEachDescendant = function (action, includeSelf, childrenFirst) {\n        if (includeSelf && !childrenFirst)\n            action(this);\n        this.forEachChild(function (child) {\n            child.forEachDescendant(action, /*includeSelf=*/ true, childrenFirst);\n        });\n        if (includeSelf && childrenFirst)\n            action(this);\n    };\n    /**\n     * Calls action on each ancestor node.\n     *\n     * @param {function(!Tree.<T>)} action Action to be called on each parent; return\n     *   true to abort.\n     * @param {boolean=} includeSelf Whether to call action on this node as well.\n     * @return {boolean} true if the action callback returned true.\n     */\n    Tree.prototype.forEachAncestor = function (action, includeSelf) {\n        var node = includeSelf ? this : this.parent();\n        while (node !== null) {\n            if (action(node)) {\n                return true;\n            }\n            node = node.parent();\n        }\n        return false;\n    };\n    /**\n     * Does a depth-first traversal of this node's descendants.  When a descendant with a value\n     * is found, action is called on it and traversal does not continue inside the node.\n     * Action is *not* called on this node.\n     *\n     * @param {function(!Tree.<T>)} action Action to be called for each child.\n     */\n    Tree.prototype.forEachImmediateDescendantWithValue = function (action) {\n        this.forEachChild(function (child) {\n            if (child.getValue() !== null)\n                action(child);\n            else\n                child.forEachImmediateDescendantWithValue(action);\n        });\n    };\n    /**\n     * @return {!Path} The path of this tree node, as a Path.\n     */\n    Tree.prototype.path = function () {\n        return new Path_1.Path(this.parent_ === null\n            ? this.name_\n            : this.parent_.path() + '/' + this.name_);\n    };\n    /**\n     * @return {string} The name of the tree node.\n     */\n    Tree.prototype.name = function () {\n        return this.name_;\n    };\n    /**\n     * @return {?Tree} The parent tree node, or null if this is the root of the tree.\n     */\n    Tree.prototype.parent = function () {\n        return this.parent_;\n    };\n    /**\n     * Adds or removes this child from its parent based on whether it's empty or not.\n     *\n     * @private\n     */\n    Tree.prototype.updateParents_ = function () {\n        if (this.parent_ !== null)\n            this.parent_.updateChild_(this.name_, this);\n    };\n    /**\n     * Adds or removes the passed child to this tree node, depending on whether it's empty.\n     *\n     * @param {string} childName The name of the child to update.\n     * @param {!Tree.<T>} child The child to update.\n     * @private\n     */\n    Tree.prototype.updateChild_ = function (childName, child) {\n        var childEmpty = child.isEmpty();\n        var childExists = util_2.contains(this.node_.children, childName);\n        if (childEmpty && childExists) {\n            delete this.node_.children[childName];\n            this.node_.childCount--;\n            this.updateParents_();\n        }\n        else if (!childEmpty && !childExists) {\n            this.node_.children[childName] = child.node_;\n            this.node_.childCount++;\n            this.updateParents_();\n        }\n    };\n    return Tree;\n}());\nexports.Tree = Tree;\n\n\n\n},{\"./Path\":57,\"@firebase/util\":134}],61:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar EventEmitter_1 = require(\"./EventEmitter\");\nvar util_1 = require(\"@firebase/util\");\n/**\n * @extends {EventEmitter}\n */\nvar VisibilityMonitor = /** @class */ (function (_super) {\n    __extends(VisibilityMonitor, _super);\n    function VisibilityMonitor() {\n        var _this = _super.call(this, ['visible']) || this;\n        var hidden;\n        var visibilityChange;\n        if (typeof document !== 'undefined' &&\n            typeof document.addEventListener !== 'undefined') {\n            if (typeof document['hidden'] !== 'undefined') {\n                // Opera 12.10 and Firefox 18 and later support\n                visibilityChange = 'visibilitychange';\n                hidden = 'hidden';\n            }\n            else if (typeof document['mozHidden'] !== 'undefined') {\n                visibilityChange = 'mozvisibilitychange';\n                hidden = 'mozHidden';\n            }\n            else if (typeof document['msHidden'] !== 'undefined') {\n                visibilityChange = 'msvisibilitychange';\n                hidden = 'msHidden';\n            }\n            else if (typeof document['webkitHidden'] !== 'undefined') {\n                visibilityChange = 'webkitvisibilitychange';\n                hidden = 'webkitHidden';\n            }\n        }\n        // Initially, we always assume we are visible. This ensures that in browsers\n        // without page visibility support or in cases where we are never visible\n        // (e.g. chrome extension), we act as if we are visible, i.e. don't delay\n        // reconnects\n        _this.visible_ = true;\n        if (visibilityChange) {\n            document.addEventListener(visibilityChange, function () {\n                var visible = !document[hidden];\n                if (visible !== _this.visible_) {\n                    _this.visible_ = visible;\n                    _this.trigger('visible', visible);\n                }\n            }, false);\n        }\n        return _this;\n    }\n    VisibilityMonitor.getInstance = function () {\n        return new VisibilityMonitor();\n    };\n    /**\n     * @param {!string} eventType\n     * @return {Array.<boolean>}\n     */\n    VisibilityMonitor.prototype.getInitialEvent = function (eventType) {\n        util_1.assert(eventType === 'visible', 'Unknown event type: ' + eventType);\n        return [this.visible_];\n    };\n    return VisibilityMonitor;\n}(EventEmitter_1.EventEmitter));\nexports.VisibilityMonitor = VisibilityMonitor;\n\n\n\n},{\"./EventEmitter\":53,\"@firebase/util\":134}],62:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Path_1 = require(\"../Path\");\nvar RepoInfo_1 = require(\"../../RepoInfo\");\nvar util_1 = require(\"../util\");\n/**\n * @param {!string} pathString\n * @return {string}\n */\nfunction decodePath(pathString) {\n    var pathStringDecoded = '';\n    var pieces = pathString.split('/');\n    for (var i = 0; i < pieces.length; i++) {\n        if (pieces[i].length > 0) {\n            var piece = pieces[i];\n            try {\n                piece = decodeURIComponent(piece.replace(/\\+/g, ' '));\n            }\n            catch (e) { }\n            pathStringDecoded += '/' + piece;\n        }\n    }\n    return pathStringDecoded;\n}\n/**\n *\n * @param {!string} dataURL\n * @return {{repoInfo: !RepoInfo, path: !Path}}\n */\nexports.parseRepoInfo = function (dataURL) {\n    var parsedUrl = exports.parseURL(dataURL), namespace = parsedUrl.subdomain;\n    if (parsedUrl.domain === 'firebase') {\n        util_1.fatal(parsedUrl.host +\n            ' is no longer supported. ' +\n            'Please use <YOUR FIREBASE>.firebaseio.com instead');\n    }\n    // Catch common error of uninitialized namespace value.\n    if (!namespace || namespace == 'undefined') {\n        util_1.fatal('Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com');\n    }\n    if (!parsedUrl.secure) {\n        util_1.warnIfPageIsSecure();\n    }\n    var webSocketOnly = parsedUrl.scheme === 'ws' || parsedUrl.scheme === 'wss';\n    return {\n        repoInfo: new RepoInfo_1.RepoInfo(parsedUrl.host, parsedUrl.secure, namespace, webSocketOnly),\n        path: new Path_1.Path(parsedUrl.pathString)\n    };\n};\n/**\n *\n * @param {!string} dataURL\n * @return {{host: string, port: number, domain: string, subdomain: string, secure: boolean, scheme: string, pathString: string}}\n */\nexports.parseURL = function (dataURL) {\n    // Default to empty strings in the event of a malformed string.\n    var host = '', domain = '', subdomain = '', pathString = '';\n    // Always default to SSL, unless otherwise specified.\n    var secure = true, scheme = 'https', port = 443;\n    // Don't do any validation here. The caller is responsible for validating the result of parsing.\n    if (typeof dataURL === 'string') {\n        // Parse scheme.\n        var colonInd = dataURL.indexOf('//');\n        if (colonInd >= 0) {\n            scheme = dataURL.substring(0, colonInd - 1);\n            dataURL = dataURL.substring(colonInd + 2);\n        }\n        // Parse host and path.\n        var slashInd = dataURL.indexOf('/');\n        if (slashInd === -1) {\n            slashInd = dataURL.length;\n        }\n        host = dataURL.substring(0, slashInd);\n        pathString = decodePath(dataURL.substring(slashInd));\n        var parts = host.split('.');\n        if (parts.length === 3) {\n            // Normalize namespaces to lowercase to share storage / connection.\n            domain = parts[1];\n            subdomain = parts[0].toLowerCase();\n        }\n        else if (parts.length === 2) {\n            domain = parts[0];\n        }\n        // If we have a port, use scheme for determining if it's secure.\n        colonInd = host.indexOf(':');\n        if (colonInd >= 0) {\n            secure = scheme === 'https' || scheme === 'wss';\n            port = parseInt(host.substring(colonInd + 1), 10);\n        }\n    }\n    return {\n        host: host,\n        port: port,\n        domain: domain,\n        subdomain: subdomain,\n        secure: secure,\n        scheme: scheme,\n        pathString: pathString\n    };\n};\n\n\n\n},{\"../../RepoInfo\":18,\"../Path\":57,\"../util\":63}],63:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\nvar util_2 = require(\"@firebase/util\");\nvar util_3 = require(\"@firebase/util\");\nvar util_4 = require(\"@firebase/util\");\nvar util_5 = require(\"@firebase/util\");\nvar util_6 = require(\"@firebase/util\");\nvar storage_1 = require(\"../storage/storage\");\nvar util_7 = require(\"@firebase/util\");\n/**\n * Returns a locally-unique ID (generated by just incrementing up from 0 each time its called).\n * @type {function(): number} Generated ID.\n */\nexports.LUIDGenerator = (function () {\n    var id = 1;\n    return function () {\n        return id++;\n    };\n})();\n/**\n * Sha1 hash of the input string\n * @param {!string} str The string to hash\n * @return {!string} The resulting hash\n */\nexports.sha1 = function (str) {\n    var utf8Bytes = util_5.stringToByteArray(str);\n    var sha1 = new util_4.Sha1();\n    sha1.update(utf8Bytes);\n    var sha1Bytes = sha1.digest();\n    return util_3.base64.encodeByteArray(sha1Bytes);\n};\n/**\n * @param {...*} var_args\n * @return {string}\n * @private\n */\nvar buildLogMessage_ = function () {\n    var var_args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        var_args[_i] = arguments[_i];\n    }\n    var message = '';\n    for (var i = 0; i < var_args.length; i++) {\n        if (Array.isArray(var_args[i]) ||\n            (var_args[i] &&\n                typeof var_args[i] === 'object' &&\n                typeof var_args[i].length === 'number')) {\n            message += buildLogMessage_.apply(null, var_args[i]);\n        }\n        else if (typeof var_args[i] === 'object') {\n            message += util_6.stringify(var_args[i]);\n        }\n        else {\n            message += var_args[i];\n        }\n        message += ' ';\n    }\n    return message;\n};\n/**\n * Use this for all debug messages in Firebase.\n * @type {?function(string)}\n */\nexports.logger = null;\n/**\n * Flag to check for log availability on first log message\n * @type {boolean}\n * @private\n */\nvar firstLog_ = true;\n/**\n * The implementation of Firebase.enableLogging (defined here to break dependencies)\n * @param {boolean|?function(string)} logger_ A flag to turn on logging, or a custom logger\n * @param {boolean=} persistent Whether or not to persist logging settings across refreshes\n */\nexports.enableLogging = function (logger_, persistent) {\n    util_1.assert(!persistent || (logger_ === true || logger_ === false), \"Can't turn on custom loggers persistently.\");\n    if (logger_ === true) {\n        if (typeof console !== 'undefined') {\n            if (typeof console.log === 'function') {\n                exports.logger = console.log.bind(console);\n            }\n            else if (typeof console.log === 'object') {\n                // IE does this.\n                exports.logger = function (message) {\n                    console.log(message);\n                };\n            }\n        }\n        if (persistent)\n            storage_1.SessionStorage.set('logging_enabled', true);\n    }\n    else if (typeof logger_ === 'function') {\n        exports.logger = logger_;\n    }\n    else {\n        exports.logger = null;\n        storage_1.SessionStorage.remove('logging_enabled');\n    }\n};\n/**\n *\n * @param {...(string|Arguments)} var_args\n */\nexports.log = function () {\n    var var_args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        var_args[_i] = arguments[_i];\n    }\n    if (firstLog_ === true) {\n        firstLog_ = false;\n        if (exports.logger === null && storage_1.SessionStorage.get('logging_enabled') === true)\n            exports.enableLogging(true);\n    }\n    if (exports.logger) {\n        var message = buildLogMessage_.apply(null, var_args);\n        exports.logger(message);\n    }\n};\n/**\n * @param {!string} prefix\n * @return {function(...[*])}\n */\nexports.logWrapper = function (prefix) {\n    return function () {\n        var var_args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            var_args[_i] = arguments[_i];\n        }\n        exports.log.apply(void 0, [prefix].concat(var_args));\n    };\n};\n/**\n * @param {...string} var_args\n */\nexports.error = function () {\n    var var_args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        var_args[_i] = arguments[_i];\n    }\n    if (typeof console !== 'undefined') {\n        var message = 'FIREBASE INTERNAL ERROR: ' + buildLogMessage_.apply(void 0, var_args);\n        if (typeof console.error !== 'undefined') {\n            console.error(message);\n        }\n        else {\n            console.log(message);\n        }\n    }\n};\n/**\n * @param {...string} var_args\n */\nexports.fatal = function () {\n    var var_args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        var_args[_i] = arguments[_i];\n    }\n    var message = buildLogMessage_.apply(void 0, var_args);\n    throw new Error('FIREBASE FATAL ERROR: ' + message);\n};\n/**\n * @param {...*} var_args\n */\nexports.warn = function () {\n    var var_args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        var_args[_i] = arguments[_i];\n    }\n    if (typeof console !== 'undefined') {\n        var message = 'FIREBASE WARNING: ' + buildLogMessage_.apply(void 0, var_args);\n        if (typeof console.warn !== 'undefined') {\n            console.warn(message);\n        }\n        else {\n            console.log(message);\n        }\n    }\n};\n/**\n * Logs a warning if the containing page uses https. Called when a call to new Firebase\n * does not use https.\n */\nexports.warnIfPageIsSecure = function () {\n    // Be very careful accessing browser globals. Who knows what may or may not exist.\n    if (typeof window !== 'undefined' &&\n        window.location &&\n        window.location.protocol &&\n        window.location.protocol.indexOf('https:') !== -1) {\n        exports.warn('Insecure Firebase access from a secure page. ' +\n            'Please use https in calls to new Firebase().');\n    }\n};\n/**\n * @param {!String} methodName\n */\nexports.warnAboutUnsupportedMethod = function (methodName) {\n    exports.warn(methodName +\n        ' is unsupported and will likely change soon.  ' +\n        'Please do not use.');\n};\n/**\n * Returns true if data is NaN, or +/- Infinity.\n * @param {*} data\n * @return {boolean}\n */\nexports.isInvalidJSONNumber = function (data) {\n    return (typeof data === 'number' &&\n        (data != data || // NaN\n            data == Number.POSITIVE_INFINITY ||\n            data == Number.NEGATIVE_INFINITY));\n};\n/**\n * @param {function()} fn\n */\nexports.executeWhenDOMReady = function (fn) {\n    if (util_7.isNodeSdk() || document.readyState === 'complete') {\n        fn();\n    }\n    else {\n        // Modeled after jQuery. Try DOMContentLoaded and onreadystatechange (which\n        // fire before onload), but fall back to onload.\n        var called_1 = false;\n        var wrappedFn_1 = function () {\n            if (!document.body) {\n                setTimeout(wrappedFn_1, Math.floor(10));\n                return;\n            }\n            if (!called_1) {\n                called_1 = true;\n                fn();\n            }\n        };\n        if (document.addEventListener) {\n            document.addEventListener('DOMContentLoaded', wrappedFn_1, false);\n            // fallback to onload.\n            window.addEventListener('load', wrappedFn_1, false);\n        }\n        else if (document.attachEvent) {\n            // IE.\n            document.attachEvent('onreadystatechange', function () {\n                if (document.readyState === 'complete')\n                    wrappedFn_1();\n            });\n            // fallback to onload.\n            window.attachEvent('onload', wrappedFn_1);\n            // jQuery has an extra hack for IE that we could employ (based on\n            // http://javascript.nwbox.com/IEContentLoaded/) But it looks really old.\n            // I'm hoping we don't need it.\n        }\n    }\n};\n/**\n * Minimum key name. Invalid for actual data, used as a marker to sort before any valid names\n * @type {!string}\n */\nexports.MIN_NAME = '[MIN_NAME]';\n/**\n * Maximum key name. Invalid for actual data, used as a marker to sort above any valid names\n * @type {!string}\n */\nexports.MAX_NAME = '[MAX_NAME]';\n/**\n * Compares valid Firebase key names, plus min and max name\n * @param {!string} a\n * @param {!string} b\n * @return {!number}\n */\nexports.nameCompare = function (a, b) {\n    if (a === b) {\n        return 0;\n    }\n    else if (a === exports.MIN_NAME || b === exports.MAX_NAME) {\n        return -1;\n    }\n    else if (b === exports.MIN_NAME || a === exports.MAX_NAME) {\n        return 1;\n    }\n    else {\n        var aAsInt = exports.tryParseInt(a), bAsInt = exports.tryParseInt(b);\n        if (aAsInt !== null) {\n            if (bAsInt !== null) {\n                return aAsInt - bAsInt == 0 ? a.length - b.length : aAsInt - bAsInt;\n            }\n            else {\n                return -1;\n            }\n        }\n        else if (bAsInt !== null) {\n            return 1;\n        }\n        else {\n            return a < b ? -1 : 1;\n        }\n    }\n};\n/**\n * @param {!string} a\n * @param {!string} b\n * @return {!number} comparison result.\n */\nexports.stringCompare = function (a, b) {\n    if (a === b) {\n        return 0;\n    }\n    else if (a < b) {\n        return -1;\n    }\n    else {\n        return 1;\n    }\n};\n/**\n * @param {string} key\n * @param {Object} obj\n * @return {*}\n */\nexports.requireKey = function (key, obj) {\n    if (obj && key in obj) {\n        return obj[key];\n    }\n    else {\n        throw new Error('Missing required key (' + key + ') in object: ' + util_6.stringify(obj));\n    }\n};\n/**\n * @param {*} obj\n * @return {string}\n */\nexports.ObjectToUniqueKey = function (obj) {\n    if (typeof obj !== 'object' || obj === null)\n        return util_6.stringify(obj);\n    var keys = [];\n    for (var k in obj) {\n        keys.push(k);\n    }\n    // Export as json, but with the keys sorted.\n    keys.sort();\n    var key = '{';\n    for (var i = 0; i < keys.length; i++) {\n        if (i !== 0)\n            key += ',';\n        key += util_6.stringify(keys[i]);\n        key += ':';\n        key += exports.ObjectToUniqueKey(obj[keys[i]]);\n    }\n    key += '}';\n    return key;\n};\n/**\n * Splits a string into a number of smaller segments of maximum size\n * @param {!string} str The string\n * @param {!number} segsize The maximum number of chars in the string.\n * @return {Array.<string>} The string, split into appropriately-sized chunks\n */\nexports.splitStringBySize = function (str, segsize) {\n    var len = str.length;\n    if (len <= segsize) {\n        return [str];\n    }\n    var dataSegs = [];\n    for (var c = 0; c < len; c += segsize) {\n        if (c + segsize > len) {\n            dataSegs.push(str.substring(c, len));\n        }\n        else {\n            dataSegs.push(str.substring(c, c + segsize));\n        }\n    }\n    return dataSegs;\n};\n/**\n * Apply a function to each (key, value) pair in an object or\n * apply a function to each (index, value) pair in an array\n * @param {!(Object|Array)} obj The object or array to iterate over\n * @param {function(?, ?)} fn The function to apply\n */\nexports.each = function (obj, fn) {\n    if (Array.isArray(obj)) {\n        for (var i = 0; i < obj.length; ++i) {\n            fn(i, obj[i]);\n        }\n    }\n    else {\n        /**\n         * in the conversion of code we removed the goog.object.forEach\n         * function which did a value,key callback. We standardized on\n         * a single impl that does a key, value callback. So we invert\n         * to not have to touch the `each` code points\n         */\n        util_2.forEach(obj, function (key, val) { return fn(val, key); });\n    }\n};\n/**\n * Like goog.bind, but doesn't bother to create a closure if opt_context is null/undefined.\n * @param {function(*)} callback Callback function.\n * @param {?Object=} context Optional context to bind to.\n * @return {function(*)}\n */\nexports.bindCallback = function (callback, context) {\n    return context ? callback.bind(context) : callback;\n};\n/**\n * Borrowed from http://hg.secondlife.com/llsd/src/tip/js/typedarray.js (MIT License)\n * I made one modification at the end and removed the NaN / Infinity\n * handling (since it seemed broken [caused an overflow] and we don't need it).  See MJL comments.\n * @param {!number} v A double\n * @return {string}\n */\nexports.doubleToIEEE754String = function (v) {\n    util_1.assert(!exports.isInvalidJSONNumber(v), 'Invalid JSON number'); // MJL\n    var ebits = 11, fbits = 52;\n    var bias = (1 << (ebits - 1)) - 1, s, e, f, ln, i, bits, str;\n    // Compute sign, exponent, fraction\n    // Skip NaN / Infinity handling --MJL.\n    if (v === 0) {\n        e = 0;\n        f = 0;\n        s = 1 / v === -Infinity ? 1 : 0;\n    }\n    else {\n        s = v < 0;\n        v = Math.abs(v);\n        if (v >= Math.pow(2, 1 - bias)) {\n            // Normalized\n            ln = Math.min(Math.floor(Math.log(v) / Math.LN2), bias);\n            e = ln + bias;\n            f = Math.round(v * Math.pow(2, fbits - ln) - Math.pow(2, fbits));\n        }\n        else {\n            // Denormalized\n            e = 0;\n            f = Math.round(v / Math.pow(2, 1 - bias - fbits));\n        }\n    }\n    // Pack sign, exponent, fraction\n    bits = [];\n    for (i = fbits; i; i -= 1) {\n        bits.push(f % 2 ? 1 : 0);\n        f = Math.floor(f / 2);\n    }\n    for (i = ebits; i; i -= 1) {\n        bits.push(e % 2 ? 1 : 0);\n        e = Math.floor(e / 2);\n    }\n    bits.push(s ? 1 : 0);\n    bits.reverse();\n    str = bits.join('');\n    // Return the data as a hex string. --MJL\n    var hexByteString = '';\n    for (i = 0; i < 64; i += 8) {\n        var hexByte = parseInt(str.substr(i, 8), 2).toString(16);\n        if (hexByte.length === 1)\n            hexByte = '0' + hexByte;\n        hexByteString = hexByteString + hexByte;\n    }\n    return hexByteString.toLowerCase();\n};\n/**\n * Used to detect if we're in a Chrome content script (which executes in an\n * isolated environment where long-polling doesn't work).\n * @return {boolean}\n */\nexports.isChromeExtensionContentScript = function () {\n    return !!(typeof window === 'object' &&\n        window['chrome'] &&\n        window['chrome']['extension'] &&\n        !/^chrome/.test(window.location.href));\n};\n/**\n * Used to detect if we're in a Windows 8 Store app.\n * @return {boolean}\n */\nexports.isWindowsStoreApp = function () {\n    // Check for the presence of a couple WinRT globals\n    return typeof Windows === 'object' && typeof Windows.UI === 'object';\n};\n/**\n * Converts a server error code to a Javascript Error\n * @param {!string} code\n * @param {!Query} query\n * @return {Error}\n */\nexports.errorForServerCode = function (code, query) {\n    var reason = 'Unknown Error';\n    if (code === 'too_big') {\n        reason =\n            'The data requested exceeds the maximum size ' +\n                'that can be accessed with a single request.';\n    }\n    else if (code == 'permission_denied') {\n        reason = \"Client doesn't have permission to access the desired data.\";\n    }\n    else if (code == 'unavailable') {\n        reason = 'The service is unavailable';\n    }\n    var error = new Error(code + ' at ' + query.path.toString() + ': ' + reason);\n    error.code = code.toUpperCase();\n    return error;\n};\n/**\n * Used to test for integer-looking strings\n * @type {RegExp}\n * @private\n */\nexports.INTEGER_REGEXP_ = new RegExp('^-?\\\\d{1,10}$');\n/**\n * If the string contains a 32-bit integer, return it.  Else return null.\n * @param {!string} str\n * @return {?number}\n */\nexports.tryParseInt = function (str) {\n    if (exports.INTEGER_REGEXP_.test(str)) {\n        var intVal = Number(str);\n        if (intVal >= -2147483648 && intVal <= 2147483647) {\n            return intVal;\n        }\n    }\n    return null;\n};\n/**\n * Helper to run some code but catch any exceptions and re-throw them later.\n * Useful for preventing user callbacks from breaking internal code.\n *\n * Re-throwing the exception from a setTimeout is a little evil, but it's very\n * convenient (we don't have to try to figure out when is a safe point to\n * re-throw it), and the behavior seems reasonable:\n *\n * * If you aren't pausing on exceptions, you get an error in the console with\n *   the correct stack trace.\n * * If you're pausing on all exceptions, the debugger will pause on your\n *   exception and then again when we rethrow it.\n * * If you're only pausing on uncaught exceptions, the debugger will only pause\n *   on us re-throwing it.\n *\n * @param {!function()} fn The code to guard.\n */\nexports.exceptionGuard = function (fn) {\n    try {\n        fn();\n    }\n    catch (e) {\n        // Re-throw exception when it's safe.\n        setTimeout(function () {\n            // It used to be that \"throw e\" would result in a good console error with\n            // relevant context, but as of Chrome 39, you just get the firebase.js\n            // file/line number where we re-throw it, which is useless. So we log\n            // e.stack explicitly.\n            var stack = e.stack || '';\n            exports.warn('Exception was thrown by user callback.', stack);\n            throw e;\n        }, Math.floor(0));\n    }\n};\n/**\n * Helper function to safely call opt_callback with the specified arguments.  It:\n * 1. Turns into a no-op if opt_callback is null or undefined.\n * 2. Wraps the call inside exceptionGuard to prevent exceptions from breaking our state.\n *\n * @param {?Function=} callback Optional onComplete callback.\n * @param {...*} var_args Arbitrary args to be passed to opt_onComplete\n */\nexports.callUserCallback = function (callback) {\n    var var_args = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        var_args[_i - 1] = arguments[_i];\n    }\n    if (typeof callback === 'function') {\n        exports.exceptionGuard(function () {\n            callback.apply(void 0, var_args);\n        });\n    }\n};\n/**\n * @return {boolean} true if we think we're currently being crawled.\n */\nexports.beingCrawled = function () {\n    var userAgent = (typeof window === 'object' &&\n        window['navigator'] &&\n        window['navigator']['userAgent']) ||\n        '';\n    // For now we whitelist the most popular crawlers.  We should refine this to be the set of crawlers we\n    // believe to support JavaScript/AJAX rendering.\n    // NOTE: Google Webmaster Tools doesn't really belong, but their \"This is how a visitor to your website\n    // would have seen the page\" is flaky if we don't treat it as a crawler.\n    return (userAgent.search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i) >= 0);\n};\n/**\n * Export a property of an object using a getter function.\n *\n * @param {!Object} object\n * @param {string} name\n * @param {!function(): *} fnGet\n */\nexports.exportPropGetter = function (object, name, fnGet) {\n    Object.defineProperty(object, name, { get: fnGet });\n};\n/**\n * Same as setTimeout() except on Node.JS it will /not/ prevent the process from exiting.\n *\n * It is removed with clearTimeout() as normal.\n *\n * @param {Function} fn Function to run.\n * @param {number} time Milliseconds to wait before running.\n * @return {number|Object} The setTimeout() return value.\n */\nexports.setTimeoutNonBlocking = function (fn, time) {\n    var timeout = setTimeout(fn, time);\n    if (typeof timeout === 'object' && timeout['unref']) {\n        timeout['unref']();\n    }\n    return timeout;\n};\n\n\n\n},{\"../storage/storage\":51,\"@firebase/util\":134}],64:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Path_1 = require(\"./Path\");\nvar util_1 = require(\"@firebase/util\");\nvar util_2 = require(\"./util\");\nvar util_3 = require(\"@firebase/util\");\nvar util_4 = require(\"@firebase/util\");\n/**\n * True for invalid Firebase keys\n * @type {RegExp}\n * @private\n */\nexports.INVALID_KEY_REGEX_ = /[\\[\\].#$\\/\\u0000-\\u001F\\u007F]/;\n/**\n * True for invalid Firebase paths.\n * Allows '/' in paths.\n * @type {RegExp}\n * @private\n */\nexports.INVALID_PATH_REGEX_ = /[\\[\\].#$\\u0000-\\u001F\\u007F]/;\n/**\n * Maximum number of characters to allow in leaf value\n * @type {number}\n * @private\n */\nexports.MAX_LEAF_SIZE_ = 10 * 1024 * 1024;\n/**\n * @param {*} key\n * @return {boolean}\n */\nexports.isValidKey = function (key) {\n    return (typeof key === 'string' && key.length !== 0 && !exports.INVALID_KEY_REGEX_.test(key));\n};\n/**\n * @param {string} pathString\n * @return {boolean}\n */\nexports.isValidPathString = function (pathString) {\n    return (typeof pathString === 'string' &&\n        pathString.length !== 0 &&\n        !exports.INVALID_PATH_REGEX_.test(pathString));\n};\n/**\n * @param {string} pathString\n * @return {boolean}\n */\nexports.isValidRootPathString = function (pathString) {\n    if (pathString) {\n        // Allow '/.info/' at the beginning.\n        pathString = pathString.replace(/^\\/*\\.info(\\/|$)/, '/');\n    }\n    return exports.isValidPathString(pathString);\n};\n/**\n * @param {*} priority\n * @return {boolean}\n */\nexports.isValidPriority = function (priority) {\n    return (priority === null ||\n        typeof priority === 'string' ||\n        (typeof priority === 'number' && !util_2.isInvalidJSONNumber(priority)) ||\n        (priority && typeof priority === 'object' && util_1.contains(priority, '.sv')));\n};\n/**\n * Pre-validate a datum passed as an argument to Firebase function.\n *\n * @param {string} fnName\n * @param {number} argumentNumber\n * @param {*} data\n * @param {!Path} path\n * @param {boolean} optional\n */\nexports.validateFirebaseDataArg = function (fnName, argumentNumber, data, path, optional) {\n    if (optional && data === undefined)\n        return;\n    exports.validateFirebaseData(util_3.errorPrefix(fnName, argumentNumber, optional), data, path);\n};\n/**\n * Validate a data object client-side before sending to server.\n *\n * @param {string} errorPrefix\n * @param {*} data\n * @param {!Path|!ValidationPath} path_\n */\nexports.validateFirebaseData = function (errorPrefix, data, path_) {\n    var path = path_ instanceof Path_1.Path ? new Path_1.ValidationPath(path_, errorPrefix) : path_;\n    if (data === undefined) {\n        throw new Error(errorPrefix + 'contains undefined ' + path.toErrorString());\n    }\n    if (typeof data === 'function') {\n        throw new Error(errorPrefix +\n            'contains a function ' +\n            path.toErrorString() +\n            ' with contents = ' +\n            data.toString());\n    }\n    if (util_2.isInvalidJSONNumber(data)) {\n        throw new Error(errorPrefix + 'contains ' + data.toString() + ' ' + path.toErrorString());\n    }\n    // Check max leaf size, but try to avoid the utf8 conversion if we can.\n    if (typeof data === 'string' &&\n        data.length > exports.MAX_LEAF_SIZE_ / 3 &&\n        util_4.stringLength(data) > exports.MAX_LEAF_SIZE_) {\n        throw new Error(errorPrefix +\n            'contains a string greater than ' +\n            exports.MAX_LEAF_SIZE_ +\n            ' utf8 bytes ' +\n            path.toErrorString() +\n            \" ('\" +\n            data.substring(0, 50) +\n            \"...')\");\n    }\n    // TODO = Perf = Consider combining the recursive validation of keys into NodeFromJSON\n    // to save extra walking of large objects.\n    if (data && typeof data === 'object') {\n        var hasDotValue_1 = false, hasActualChild_1 = false;\n        util_1.forEach(data, function (key, value) {\n            if (key === '.value') {\n                hasDotValue_1 = true;\n            }\n            else if (key !== '.priority' && key !== '.sv') {\n                hasActualChild_1 = true;\n                if (!exports.isValidKey(key)) {\n                    throw new Error(errorPrefix +\n                        ' contains an invalid key (' +\n                        key +\n                        ') ' +\n                        path.toErrorString() +\n                        '.  Keys must be non-empty strings ' +\n                        'and can\\'t contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\"');\n                }\n            }\n            path.push(key);\n            exports.validateFirebaseData(errorPrefix, value, path);\n            path.pop();\n        });\n        if (hasDotValue_1 && hasActualChild_1) {\n            throw new Error(errorPrefix +\n                ' contains \".value\" child ' +\n                path.toErrorString() +\n                ' in addition to actual children.');\n        }\n    }\n};\n/**\n * Pre-validate paths passed in the firebase function.\n *\n * @param {string} errorPrefix\n * @param {Array<!Path>} mergePaths\n */\nexports.validateFirebaseMergePaths = function (errorPrefix, mergePaths) {\n    var i, curPath;\n    for (i = 0; i < mergePaths.length; i++) {\n        curPath = mergePaths[i];\n        var keys = curPath.slice();\n        for (var j = 0; j < keys.length; j++) {\n            if (keys[j] === '.priority' && j === keys.length - 1) {\n                // .priority is OK\n            }\n            else if (!exports.isValidKey(keys[j])) {\n                throw new Error(errorPrefix +\n                    'contains an invalid key (' +\n                    keys[j] +\n                    ') in path ' +\n                    curPath.toString() +\n                    '. Keys must be non-empty strings ' +\n                    'and can\\'t contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\"');\n            }\n        }\n    }\n    // Check that update keys are not descendants of each other.\n    // We rely on the property that sorting guarantees that ancestors come\n    // right before descendants.\n    mergePaths.sort(Path_1.Path.comparePaths);\n    var prevPath = null;\n    for (i = 0; i < mergePaths.length; i++) {\n        curPath = mergePaths[i];\n        if (prevPath !== null && prevPath.contains(curPath)) {\n            throw new Error(errorPrefix +\n                'contains a path ' +\n                prevPath.toString() +\n                ' that is ancestor of another path ' +\n                curPath.toString());\n        }\n        prevPath = curPath;\n    }\n};\n/**\n * pre-validate an object passed as an argument to firebase function (\n * must be an object - e.g. for firebase.update()).\n *\n * @param {string} fnName\n * @param {number} argumentNumber\n * @param {*} data\n * @param {!Path} path\n * @param {boolean} optional\n */\nexports.validateFirebaseMergeDataArg = function (fnName, argumentNumber, data, path, optional) {\n    if (optional && data === undefined)\n        return;\n    var errorPrefix = util_3.errorPrefix(fnName, argumentNumber, optional);\n    if (!(data && typeof data === 'object') || Array.isArray(data)) {\n        throw new Error(errorPrefix + ' must be an object containing the children to replace.');\n    }\n    var mergePaths = [];\n    util_1.forEach(data, function (key, value) {\n        var curPath = new Path_1.Path(key);\n        exports.validateFirebaseData(errorPrefix, value, path.child(curPath));\n        if (curPath.getBack() === '.priority') {\n            if (!exports.isValidPriority(value)) {\n                throw new Error(errorPrefix +\n                    \"contains an invalid value for '\" +\n                    curPath.toString() +\n                    \"', which must be a valid \" +\n                    'Firebase priority (a string, finite number, server value, or null).');\n            }\n        }\n        mergePaths.push(curPath);\n    });\n    exports.validateFirebaseMergePaths(errorPrefix, mergePaths);\n};\nexports.validatePriority = function (fnName, argumentNumber, priority, optional) {\n    if (optional && priority === undefined)\n        return;\n    if (util_2.isInvalidJSONNumber(priority))\n        throw new Error(util_3.errorPrefix(fnName, argumentNumber, optional) +\n            'is ' +\n            priority.toString() +\n            ', but must be a valid Firebase priority (a string, finite number, ' +\n            'server value, or null).');\n    // Special case to allow importing data with a .sv.\n    if (!exports.isValidPriority(priority))\n        throw new Error(util_3.errorPrefix(fnName, argumentNumber, optional) +\n            'must be a valid Firebase priority ' +\n            '(a string, finite number, server value, or null).');\n};\nexports.validateEventType = function (fnName, argumentNumber, eventType, optional) {\n    if (optional && eventType === undefined)\n        return;\n    switch (eventType) {\n        case 'value':\n        case 'child_added':\n        case 'child_removed':\n        case 'child_changed':\n        case 'child_moved':\n            break;\n        default:\n            throw new Error(util_3.errorPrefix(fnName, argumentNumber, optional) +\n                'must be a valid event type = \"value\", \"child_added\", \"child_removed\", ' +\n                '\"child_changed\", or \"child_moved\".');\n    }\n};\nexports.validateKey = function (fnName, argumentNumber, key, optional) {\n    if (optional && key === undefined)\n        return;\n    if (!exports.isValidKey(key))\n        throw new Error(util_3.errorPrefix(fnName, argumentNumber, optional) +\n            'was an invalid key = \"' +\n            key +\n            '\".  Firebase keys must be non-empty strings and ' +\n            'can\\'t contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\").');\n};\nexports.validatePathString = function (fnName, argumentNumber, pathString, optional) {\n    if (optional && pathString === undefined)\n        return;\n    if (!exports.isValidPathString(pathString))\n        throw new Error(util_3.errorPrefix(fnName, argumentNumber, optional) +\n            'was an invalid path = \"' +\n            pathString +\n            '\". Paths must be non-empty strings and ' +\n            'can\\'t contain \".\", \"#\", \"$\", \"[\", or \"]\"');\n};\nexports.validateRootPathString = function (fnName, argumentNumber, pathString, optional) {\n    if (pathString) {\n        // Allow '/.info/' at the beginning.\n        pathString = pathString.replace(/^\\/*\\.info(\\/|$)/, '/');\n    }\n    exports.validatePathString(fnName, argumentNumber, pathString, optional);\n};\nexports.validateWritablePath = function (fnName, path) {\n    if (path.getFront() === '.info') {\n        throw new Error(fnName + \" failed = Can't modify data under /.info/\");\n    }\n};\nexports.validateUrl = function (fnName, argumentNumber, parsedUrl) {\n    // TODO = Validate server better.\n    var pathString = parsedUrl.path.toString();\n    if (!(typeof parsedUrl.repoInfo.host === 'string') ||\n        parsedUrl.repoInfo.host.length === 0 ||\n        !exports.isValidKey(parsedUrl.repoInfo.namespace) ||\n        (pathString.length !== 0 && !exports.isValidRootPathString(pathString))) {\n        throw new Error(util_3.errorPrefix(fnName, argumentNumber, false) +\n            'must be a valid firebase URL and ' +\n            'the path can\\'t contain \".\", \"#\", \"$\", \"[\", or \"]\".');\n    }\n};\nexports.validateCredential = function (fnName, argumentNumber, cred, optional) {\n    if (optional && cred === undefined)\n        return;\n    if (!(typeof cred === 'string'))\n        throw new Error(util_3.errorPrefix(fnName, argumentNumber, optional) +\n            'must be a valid credential (a string).');\n};\nexports.validateBoolean = function (fnName, argumentNumber, bool, optional) {\n    if (optional && bool === undefined)\n        return;\n    if (typeof bool !== 'boolean')\n        throw new Error(util_3.errorPrefix(fnName, argumentNumber, optional) + 'must be a boolean.');\n};\nexports.validateString = function (fnName, argumentNumber, string, optional) {\n    if (optional && string === undefined)\n        return;\n    if (!(typeof string === 'string')) {\n        throw new Error(util_3.errorPrefix(fnName, argumentNumber, optional) +\n            'must be a valid string.');\n    }\n};\nexports.validateObject = function (fnName, argumentNumber, obj, optional) {\n    if (optional && obj === undefined)\n        return;\n    if (!(obj && typeof obj === 'object') || obj === null) {\n        throw new Error(util_3.errorPrefix(fnName, argumentNumber, optional) +\n            'must be a valid object.');\n    }\n};\nexports.validateObjectContainsKey = function (fnName, argumentNumber, obj, key, optional, opt_type) {\n    var objectContainsKey = obj && typeof obj === 'object' && util_1.contains(obj, key);\n    if (!objectContainsKey) {\n        if (optional) {\n            return;\n        }\n        else {\n            throw new Error(util_3.errorPrefix(fnName, argumentNumber, optional) +\n                'must contain the key \"' +\n                key +\n                '\"');\n        }\n    }\n    if (opt_type) {\n        var val = util_1.safeGet(obj, key);\n        if ((opt_type === 'number' && !(typeof val === 'number')) ||\n            (opt_type === 'string' && !(typeof val === 'string')) ||\n            (opt_type === 'boolean' && !(typeof val === 'boolean')) ||\n            (opt_type === 'function' && !(typeof val === 'function')) ||\n            (opt_type === 'object' && !(typeof val === 'object') && val)) {\n            if (optional) {\n                throw new Error(util_3.errorPrefix(fnName, argumentNumber, optional) +\n                    'contains invalid value for key \"' +\n                    key +\n                    '\" (must be of type \"' +\n                    opt_type +\n                    '\")');\n            }\n            else {\n                throw new Error(util_3.errorPrefix(fnName, argumentNumber, optional) +\n                    'must contain the key \"' +\n                    key +\n                    '\" with type \"' +\n                    opt_type +\n                    '\"');\n            }\n        }\n    }\n};\n\n\n\n},{\"./Path\":57,\"./util\":63,\"@firebase/util\":134}],65:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * A cache node only stores complete children. Additionally it holds a flag whether the node can be considered fully\n * initialized in the sense that we know at one point in time this represented a valid state of the world, e.g.\n * initialized with data from the server, or a complete overwrite by the client. The filtered flag also tracks\n * whether a node potentially had children removed due to a filter.\n */\nvar CacheNode = /** @class */ (function () {\n    /**\n     * @param {!Node} node_\n     * @param {boolean} fullyInitialized_\n     * @param {boolean} filtered_\n     */\n    function CacheNode(node_, fullyInitialized_, filtered_) {\n        this.node_ = node_;\n        this.fullyInitialized_ = fullyInitialized_;\n        this.filtered_ = filtered_;\n    }\n    /**\n     * Returns whether this node was fully initialized with either server data or a complete overwrite by the client\n     * @return {boolean}\n     */\n    CacheNode.prototype.isFullyInitialized = function () {\n        return this.fullyInitialized_;\n    };\n    /**\n     * Returns whether this node is potentially missing children due to a filter applied to the node\n     * @return {boolean}\n     */\n    CacheNode.prototype.isFiltered = function () {\n        return this.filtered_;\n    };\n    /**\n     * @param {!Path} path\n     * @return {boolean}\n     */\n    CacheNode.prototype.isCompleteForPath = function (path) {\n        if (path.isEmpty()) {\n            return this.isFullyInitialized() && !this.filtered_;\n        }\n        var childKey = path.getFront();\n        return this.isCompleteForChild(childKey);\n    };\n    /**\n     * @param {!string} key\n     * @return {boolean}\n     */\n    CacheNode.prototype.isCompleteForChild = function (key) {\n        return ((this.isFullyInitialized() && !this.filtered_) || this.node_.hasChild(key));\n    };\n    /**\n     * @return {!Node}\n     */\n    CacheNode.prototype.getNode = function () {\n        return this.node_;\n    };\n    return CacheNode;\n}());\nexports.CacheNode = CacheNode;\n\n\n\n},{}],66:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * @constructor\n * @struct\n * @param {!string} type The event type\n * @param {!Node} snapshotNode The data\n * @param {string=} childName The name for this child, if it's a child event\n * @param {Node=} oldSnap Used for intermediate processing of child changed events\n * @param {string=} prevName The name for the previous child, if applicable\n */\nvar Change = /** @class */ (function () {\n    function Change(type, snapshotNode, childName, oldSnap, prevName) {\n        this.type = type;\n        this.snapshotNode = snapshotNode;\n        this.childName = childName;\n        this.oldSnap = oldSnap;\n        this.prevName = prevName;\n    }\n    /**\n     * @param {!Node} snapshot\n     * @return {!Change}\n     */\n    Change.valueChange = function (snapshot) {\n        return new Change(Change.VALUE, snapshot);\n    };\n    /**\n     * @param {string} childKey\n     * @param {!Node} snapshot\n     * @return {!Change}\n     */\n    Change.childAddedChange = function (childKey, snapshot) {\n        return new Change(Change.CHILD_ADDED, snapshot, childKey);\n    };\n    /**\n     * @param {string} childKey\n     * @param {!Node} snapshot\n     * @return {!Change}\n     */\n    Change.childRemovedChange = function (childKey, snapshot) {\n        return new Change(Change.CHILD_REMOVED, snapshot, childKey);\n    };\n    /**\n     * @param {string} childKey\n     * @param {!Node} newSnapshot\n     * @param {!Node} oldSnapshot\n     * @return {!Change}\n     */\n    Change.childChangedChange = function (childKey, newSnapshot, oldSnapshot) {\n        return new Change(Change.CHILD_CHANGED, newSnapshot, childKey, oldSnapshot);\n    };\n    /**\n     * @param {string} childKey\n     * @param {!Node} snapshot\n     * @return {!Change}\n     */\n    Change.childMovedChange = function (childKey, snapshot) {\n        return new Change(Change.CHILD_MOVED, snapshot, childKey);\n    };\n    //event types\n    /** Event type for a child added */\n    Change.CHILD_ADDED = 'child_added';\n    /** Event type for a child removed */\n    Change.CHILD_REMOVED = 'child_removed';\n    /** Event type for a child changed */\n    Change.CHILD_CHANGED = 'child_changed';\n    /** Event type for a child moved */\n    Change.CHILD_MOVED = 'child_moved';\n    /** Event type for a value change */\n    Change.VALUE = 'value';\n    return Change;\n}());\nexports.Change = Change;\n\n\n\n},{}],67:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\nvar Change_1 = require(\"./Change\");\nvar util_2 = require(\"@firebase/util\");\n/**\n * @constructor\n */\nvar ChildChangeAccumulator = /** @class */ (function () {\n    function ChildChangeAccumulator() {\n        this.changeMap_ = {};\n    }\n    /**\n     * @param {!Change} change\n     */\n    ChildChangeAccumulator.prototype.trackChildChange = function (change) {\n        var type = change.type;\n        var childKey /** @type {!string} */ = change.childName;\n        util_2.assert(type == Change_1.Change.CHILD_ADDED ||\n            type == Change_1.Change.CHILD_CHANGED ||\n            type == Change_1.Change.CHILD_REMOVED, 'Only child changes supported for tracking');\n        util_2.assert(childKey !== '.priority', 'Only non-priority child changes can be tracked.');\n        var oldChange = util_1.safeGet(this.changeMap_, childKey);\n        if (oldChange) {\n            var oldType = oldChange.type;\n            if (type == Change_1.Change.CHILD_ADDED && oldType == Change_1.Change.CHILD_REMOVED) {\n                this.changeMap_[childKey] = Change_1.Change.childChangedChange(childKey, change.snapshotNode, oldChange.snapshotNode);\n            }\n            else if (type == Change_1.Change.CHILD_REMOVED &&\n                oldType == Change_1.Change.CHILD_ADDED) {\n                delete this.changeMap_[childKey];\n            }\n            else if (type == Change_1.Change.CHILD_REMOVED &&\n                oldType == Change_1.Change.CHILD_CHANGED) {\n                this.changeMap_[childKey] = Change_1.Change.childRemovedChange(childKey, oldChange.oldSnap);\n            }\n            else if (type == Change_1.Change.CHILD_CHANGED &&\n                oldType == Change_1.Change.CHILD_ADDED) {\n                this.changeMap_[childKey] = Change_1.Change.childAddedChange(childKey, change.snapshotNode);\n            }\n            else if (type == Change_1.Change.CHILD_CHANGED &&\n                oldType == Change_1.Change.CHILD_CHANGED) {\n                this.changeMap_[childKey] = Change_1.Change.childChangedChange(childKey, change.snapshotNode, oldChange.oldSnap);\n            }\n            else {\n                throw util_2.assertionError('Illegal combination of changes: ' +\n                    change +\n                    ' occurred after ' +\n                    oldChange);\n            }\n        }\n        else {\n            this.changeMap_[childKey] = change;\n        }\n    };\n    /**\n     * @return {!Array.<!Change>}\n     */\n    ChildChangeAccumulator.prototype.getChanges = function () {\n        return util_1.getValues(this.changeMap_);\n    };\n    return ChildChangeAccumulator;\n}());\nexports.ChildChangeAccumulator = ChildChangeAccumulator;\n\n\n\n},{\"./Change\":66,\"@firebase/util\":134}],68:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar CacheNode_1 = require(\"./CacheNode\");\n/**\n * An implementation of CompleteChildSource that never returns any additional children\n *\n * @private\n * @constructor\n * @implements CompleteChildSource\n */\nvar NoCompleteChildSource_ = /** @class */ (function () {\n    function NoCompleteChildSource_() {\n    }\n    /**\n     * @inheritDoc\n     */\n    NoCompleteChildSource_.prototype.getCompleteChild = function (childKey) {\n        return null;\n    };\n    /**\n     * @inheritDoc\n     */\n    NoCompleteChildSource_.prototype.getChildAfterChild = function (index, child, reverse) {\n        return null;\n    };\n    return NoCompleteChildSource_;\n}());\nexports.NoCompleteChildSource_ = NoCompleteChildSource_;\n/**\n * Singleton instance.\n * @const\n * @type {!CompleteChildSource}\n */\nexports.NO_COMPLETE_CHILD_SOURCE = new NoCompleteChildSource_();\n/**\n * An implementation of CompleteChildSource that uses a WriteTree in addition to any other server data or\n * old event caches available to calculate complete children.\n *\n *\n * @implements CompleteChildSource\n */\nvar WriteTreeCompleteChildSource = /** @class */ (function () {\n    /**\n     * @param {!WriteTreeRef} writes_\n     * @param {!ViewCache} viewCache_\n     * @param {?Node} optCompleteServerCache_\n     */\n    function WriteTreeCompleteChildSource(writes_, viewCache_, optCompleteServerCache_) {\n        if (optCompleteServerCache_ === void 0) { optCompleteServerCache_ = null; }\n        this.writes_ = writes_;\n        this.viewCache_ = viewCache_;\n        this.optCompleteServerCache_ = optCompleteServerCache_;\n    }\n    /**\n     * @inheritDoc\n     */\n    WriteTreeCompleteChildSource.prototype.getCompleteChild = function (childKey) {\n        var node = this.viewCache_.getEventCache();\n        if (node.isCompleteForChild(childKey)) {\n            return node.getNode().getImmediateChild(childKey);\n        }\n        else {\n            var serverNode = this.optCompleteServerCache_ != null\n                ? new CacheNode_1.CacheNode(this.optCompleteServerCache_, true, false)\n                : this.viewCache_.getServerCache();\n            return this.writes_.calcCompleteChild(childKey, serverNode);\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    WriteTreeCompleteChildSource.prototype.getChildAfterChild = function (index, child, reverse) {\n        var completeServerData = this.optCompleteServerCache_ != null\n            ? this.optCompleteServerCache_\n            : this.viewCache_.getCompleteServerSnap();\n        var nodes = this.writes_.calcIndexedSlice(completeServerData, child, 1, reverse, index);\n        if (nodes.length === 0) {\n            return null;\n        }\n        else {\n            return nodes[0];\n        }\n    };\n    return WriteTreeCompleteChildSource;\n}());\nexports.WriteTreeCompleteChildSource = WriteTreeCompleteChildSource;\n\n\n\n},{\"./CacheNode\":65}],69:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\n/**\n * Encapsulates the data needed to raise an event\n * @implements {Event}\n */\nvar DataEvent = /** @class */ (function () {\n    /**\n     * @param {!string} eventType One of: value, child_added, child_changed, child_moved, child_removed\n     * @param {!EventRegistration} eventRegistration The function to call to with the event data. User provided\n     * @param {!DataSnapshot} snapshot The data backing the event\n     * @param {?string=} prevName Optional, the name of the previous child for child_* events.\n     */\n    function DataEvent(eventType, eventRegistration, snapshot, prevName) {\n        this.eventType = eventType;\n        this.eventRegistration = eventRegistration;\n        this.snapshot = snapshot;\n        this.prevName = prevName;\n    }\n    /**\n     * @inheritDoc\n     */\n    DataEvent.prototype.getPath = function () {\n        var ref = this.snapshot.getRef();\n        if (this.eventType === 'value') {\n            return ref.path;\n        }\n        else {\n            return ref.getParent().path;\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    DataEvent.prototype.getEventType = function () {\n        return this.eventType;\n    };\n    /**\n     * @inheritDoc\n     */\n    DataEvent.prototype.getEventRunner = function () {\n        return this.eventRegistration.getEventRunner(this);\n    };\n    /**\n     * @inheritDoc\n     */\n    DataEvent.prototype.toString = function () {\n        return (this.getPath().toString() +\n            ':' +\n            this.eventType +\n            ':' +\n            util_1.stringify(this.snapshot.exportVal()));\n    };\n    return DataEvent;\n}());\nexports.DataEvent = DataEvent;\nvar CancelEvent = /** @class */ (function () {\n    /**\n     * @param {EventRegistration} eventRegistration\n     * @param {Error} error\n     * @param {!Path} path\n     */\n    function CancelEvent(eventRegistration, error, path) {\n        this.eventRegistration = eventRegistration;\n        this.error = error;\n        this.path = path;\n    }\n    /**\n     * @inheritDoc\n     */\n    CancelEvent.prototype.getPath = function () {\n        return this.path;\n    };\n    /**\n     * @inheritDoc\n     */\n    CancelEvent.prototype.getEventType = function () {\n        return 'cancel';\n    };\n    /**\n     * @inheritDoc\n     */\n    CancelEvent.prototype.getEventRunner = function () {\n        return this.eventRegistration.getEventRunner(this);\n    };\n    /**\n     * @inheritDoc\n     */\n    CancelEvent.prototype.toString = function () {\n        return this.path.toString() + ':cancel';\n    };\n    return CancelEvent;\n}());\nexports.CancelEvent = CancelEvent;\n\n\n\n},{\"@firebase/util\":134}],70:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Node_1 = require(\"../snap/Node\");\nvar Change_1 = require(\"./Change\");\nvar util_1 = require(\"@firebase/util\");\n/**\n * An EventGenerator is used to convert \"raw\" changes (Change) as computed by the\n * CacheDiffer into actual events (Event) that can be raised.  See generateEventsForChanges()\n * for details.\n *\n * @constructor\n */\nvar EventGenerator = /** @class */ (function () {\n    /**\n     *\n     * @param {!Query} query_\n     */\n    function EventGenerator(query_) {\n        this.query_ = query_;\n        /**\n         * @private\n         * @type {!Index}\n         */\n        this.index_ = this.query_.getQueryParams().getIndex();\n    }\n    /**\n     * Given a set of raw changes (no moved events and prevName not specified yet), and a set of\n     * EventRegistrations that should be notified of these changes, generate the actual events to be raised.\n     *\n     * Notes:\n     *  - child_moved events will be synthesized at this time for any child_changed events that affect\n     *    our index.\n     *  - prevName will be calculated based on the index ordering.\n     *\n     * @param {!Array.<!Change>} changes\n     * @param {!Node} eventCache\n     * @param {!Array.<!EventRegistration>} eventRegistrations\n     * @return {!Array.<!Event>}\n     */\n    EventGenerator.prototype.generateEventsForChanges = function (changes, eventCache, eventRegistrations) {\n        var _this = this;\n        var events = [];\n        var moves = [];\n        changes.forEach(function (change) {\n            if (change.type === Change_1.Change.CHILD_CHANGED &&\n                _this.index_.indexedValueChanged(change.oldSnap, change.snapshotNode)) {\n                moves.push(Change_1.Change.childMovedChange(change.childName, change.snapshotNode));\n            }\n        });\n        this.generateEventsForType_(events, Change_1.Change.CHILD_REMOVED, changes, eventRegistrations, eventCache);\n        this.generateEventsForType_(events, Change_1.Change.CHILD_ADDED, changes, eventRegistrations, eventCache);\n        this.generateEventsForType_(events, Change_1.Change.CHILD_MOVED, moves, eventRegistrations, eventCache);\n        this.generateEventsForType_(events, Change_1.Change.CHILD_CHANGED, changes, eventRegistrations, eventCache);\n        this.generateEventsForType_(events, Change_1.Change.VALUE, changes, eventRegistrations, eventCache);\n        return events;\n    };\n    /**\n     * Given changes of a single change type, generate the corresponding events.\n     *\n     * @param {!Array.<!Event>} events\n     * @param {!string} eventType\n     * @param {!Array.<!Change>} changes\n     * @param {!Array.<!EventRegistration>} registrations\n     * @param {!Node} eventCache\n     * @private\n     */\n    EventGenerator.prototype.generateEventsForType_ = function (events, eventType, changes, registrations, eventCache) {\n        var _this = this;\n        var filteredChanges = changes.filter(function (change) { return change.type === eventType; });\n        filteredChanges.sort(this.compareChanges_.bind(this));\n        filteredChanges.forEach(function (change) {\n            var materializedChange = _this.materializeSingleChange_(change, eventCache);\n            registrations.forEach(function (registration) {\n                if (registration.respondsTo(change.type)) {\n                    events.push(registration.createEvent(materializedChange, _this.query_));\n                }\n            });\n        });\n    };\n    /**\n     * @param {!Change} change\n     * @param {!Node} eventCache\n     * @return {!Change}\n     * @private\n     */\n    EventGenerator.prototype.materializeSingleChange_ = function (change, eventCache) {\n        if (change.type === 'value' || change.type === 'child_removed') {\n            return change;\n        }\n        else {\n            change.prevName = eventCache.getPredecessorChildName(\n            /** @type {!string} */\n            change.childName, change.snapshotNode, this.index_);\n            return change;\n        }\n    };\n    /**\n     * @param {!Change} a\n     * @param {!Change} b\n     * @return {number}\n     * @private\n     */\n    EventGenerator.prototype.compareChanges_ = function (a, b) {\n        if (a.childName == null || b.childName == null) {\n            throw util_1.assertionError('Should only compare child_ events.');\n        }\n        var aWrapped = new Node_1.NamedNode(a.childName, a.snapshotNode);\n        var bWrapped = new Node_1.NamedNode(b.childName, b.snapshotNode);\n        return this.index_.compare(aWrapped, bWrapped);\n    };\n    return EventGenerator;\n}());\nexports.EventGenerator = EventGenerator;\n\n\n\n},{\"../snap/Node\":35,\"./Change\":66,\"@firebase/util\":134}],71:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"../util/util\");\n/**\n * The event queue serves a few purposes:\n * 1. It ensures we maintain event order in the face of event callbacks doing operations that result in more\n *    events being queued.\n * 2. raiseQueuedEvents() handles being called reentrantly nicely.  That is, if in the course of raising events,\n *    raiseQueuedEvents() is called again, the \"inner\" call will pick up raising events where the \"outer\" call\n *    left off, ensuring that the events are still raised synchronously and in order.\n * 3. You can use raiseEventsAtPath and raiseEventsForChangedPath to ensure only relevant previously-queued\n *    events are raised synchronously.\n *\n * NOTE: This can all go away if/when we move to async events.\n *\n * @constructor\n */\nvar EventQueue = /** @class */ (function () {\n    function EventQueue() {\n        /**\n         * @private\n         * @type {!Array.<EventList>}\n         */\n        this.eventLists_ = [];\n        /**\n         * Tracks recursion depth of raiseQueuedEvents_, for debugging purposes.\n         * @private\n         * @type {!number}\n         */\n        this.recursionDepth_ = 0;\n    }\n    /**\n     * @param {!Array.<Event>} eventDataList The new events to queue.\n     */\n    EventQueue.prototype.queueEvents = function (eventDataList) {\n        // We group events by path, storing them in a single EventList, to make it easier to skip over them quickly.\n        var currList = null;\n        for (var i = 0; i < eventDataList.length; i++) {\n            var eventData = eventDataList[i];\n            var eventPath = eventData.getPath();\n            if (currList !== null && !eventPath.equals(currList.getPath())) {\n                this.eventLists_.push(currList);\n                currList = null;\n            }\n            if (currList === null) {\n                currList = new EventList(eventPath);\n            }\n            currList.add(eventData);\n        }\n        if (currList) {\n            this.eventLists_.push(currList);\n        }\n    };\n    /**\n     * Queues the specified events and synchronously raises all events (including previously queued ones)\n     * for the specified path.\n     *\n     * It is assumed that the new events are all for the specified path.\n     *\n     * @param {!Path} path The path to raise events for.\n     * @param {!Array.<Event>} eventDataList The new events to raise.\n     */\n    EventQueue.prototype.raiseEventsAtPath = function (path, eventDataList) {\n        this.queueEvents(eventDataList);\n        this.raiseQueuedEventsMatchingPredicate_(function (eventPath) {\n            return eventPath.equals(path);\n        });\n    };\n    /**\n     * Queues the specified events and synchronously raises all events (including previously queued ones) for\n     * locations related to the specified change path (i.e. all ancestors and descendants).\n     *\n     * It is assumed that the new events are all related (ancestor or descendant) to the specified path.\n     *\n     * @param {!Path} changedPath The path to raise events for.\n     * @param {!Array.<!Event>} eventDataList The events to raise\n     */\n    EventQueue.prototype.raiseEventsForChangedPath = function (changedPath, eventDataList) {\n        this.queueEvents(eventDataList);\n        this.raiseQueuedEventsMatchingPredicate_(function (eventPath) {\n            return eventPath.contains(changedPath) || changedPath.contains(eventPath);\n        });\n    };\n    /**\n     * @param {!function(!Path):boolean} predicate\n     * @private\n     */\n    EventQueue.prototype.raiseQueuedEventsMatchingPredicate_ = function (predicate) {\n        this.recursionDepth_++;\n        var sentAll = true;\n        for (var i = 0; i < this.eventLists_.length; i++) {\n            var eventList = this.eventLists_[i];\n            if (eventList) {\n                var eventPath = eventList.getPath();\n                if (predicate(eventPath)) {\n                    this.eventLists_[i].raise();\n                    this.eventLists_[i] = null;\n                }\n                else {\n                    sentAll = false;\n                }\n            }\n        }\n        if (sentAll) {\n            this.eventLists_ = [];\n        }\n        this.recursionDepth_--;\n    };\n    return EventQueue;\n}());\nexports.EventQueue = EventQueue;\n/**\n * @param {!Path} path\n * @constructor\n */\nvar EventList = /** @class */ (function () {\n    function EventList(path_) {\n        this.path_ = path_;\n        /**\n         * @type {!Array.<Event>}\n         * @private\n         */\n        this.events_ = [];\n    }\n    /**\n     * @param {!Event} eventData\n     */\n    EventList.prototype.add = function (eventData) {\n        this.events_.push(eventData);\n    };\n    /**\n     * Iterates through the list and raises each event\n     */\n    EventList.prototype.raise = function () {\n        for (var i = 0; i < this.events_.length; i++) {\n            var eventData = this.events_[i];\n            if (eventData !== null) {\n                this.events_[i] = null;\n                var eventFn = eventData.getEventRunner();\n                if (util_1.logger) {\n                    util_1.log('event: ' + eventData.toString());\n                }\n                util_1.exceptionGuard(eventFn);\n            }\n        }\n    };\n    /**\n     * @return {!Path}\n     */\n    EventList.prototype.getPath = function () {\n        return this.path_;\n    };\n    return EventList;\n}());\nexports.EventList = EventList;\n\n\n\n},{\"../util/util\":63}],72:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar DataSnapshot_1 = require(\"../../api/DataSnapshot\");\nvar Event_1 = require(\"./Event\");\nvar util_1 = require(\"@firebase/util\");\nvar util_2 = require(\"@firebase/util\");\n/**\n * Represents registration for 'value' events.\n */\nvar ValueEventRegistration = /** @class */ (function () {\n    /**\n     * @param {?function(!DataSnapshot)} callback_\n     * @param {?function(Error)} cancelCallback_\n     * @param {?Object} context_\n     */\n    function ValueEventRegistration(callback_, cancelCallback_, context_) {\n        this.callback_ = callback_;\n        this.cancelCallback_ = cancelCallback_;\n        this.context_ = context_;\n    }\n    /**\n     * @inheritDoc\n     */\n    ValueEventRegistration.prototype.respondsTo = function (eventType) {\n        return eventType === 'value';\n    };\n    /**\n     * @inheritDoc\n     */\n    ValueEventRegistration.prototype.createEvent = function (change, query) {\n        var index = query.getQueryParams().getIndex();\n        return new Event_1.DataEvent('value', this, new DataSnapshot_1.DataSnapshot(change.snapshotNode, query.getRef(), index));\n    };\n    /**\n     * @inheritDoc\n     */\n    ValueEventRegistration.prototype.getEventRunner = function (eventData) {\n        var ctx = this.context_;\n        if (eventData.getEventType() === 'cancel') {\n            util_2.assert(this.cancelCallback_, 'Raising a cancel event on a listener with no cancel callback');\n            var cancelCB_1 = this.cancelCallback_;\n            return function () {\n                // We know that error exists, we checked above that this is a cancel event\n                cancelCB_1.call(ctx, eventData.error);\n            };\n        }\n        else {\n            var cb_1 = this.callback_;\n            return function () {\n                cb_1.call(ctx, eventData.snapshot);\n            };\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    ValueEventRegistration.prototype.createCancelEvent = function (error, path) {\n        if (this.cancelCallback_) {\n            return new Event_1.CancelEvent(this, error, path);\n        }\n        else {\n            return null;\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    ValueEventRegistration.prototype.matches = function (other) {\n        if (!(other instanceof ValueEventRegistration)) {\n            return false;\n        }\n        else if (!other.callback_ || !this.callback_) {\n            // If no callback specified, we consider it to match any callback.\n            return true;\n        }\n        else {\n            return (other.callback_ === this.callback_ && other.context_ === this.context_);\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    ValueEventRegistration.prototype.hasAnyCallback = function () {\n        return this.callback_ !== null;\n    };\n    return ValueEventRegistration;\n}());\nexports.ValueEventRegistration = ValueEventRegistration;\n/**\n * Represents the registration of 1 or more child_xxx events.\n *\n * Currently, it is always exactly 1 child_xxx event, but the idea is we might let you\n * register a group of callbacks together in the future.\n *\n * @constructor\n * @implements {EventRegistration}\n */\nvar ChildEventRegistration = /** @class */ (function () {\n    /**\n     * @param {?Object.<string, function(!DataSnapshot, ?string=)>} callbacks_\n     * @param {?function(Error)} cancelCallback_\n     * @param {Object=} context_\n     */\n    function ChildEventRegistration(callbacks_, cancelCallback_, context_) {\n        this.callbacks_ = callbacks_;\n        this.cancelCallback_ = cancelCallback_;\n        this.context_ = context_;\n    }\n    /**\n     * @inheritDoc\n     */\n    ChildEventRegistration.prototype.respondsTo = function (eventType) {\n        var eventToCheck = eventType === 'children_added' ? 'child_added' : eventType;\n        eventToCheck =\n            eventToCheck === 'children_removed' ? 'child_removed' : eventToCheck;\n        return util_1.contains(this.callbacks_, eventToCheck);\n    };\n    /**\n     * @inheritDoc\n     */\n    ChildEventRegistration.prototype.createCancelEvent = function (error, path) {\n        if (this.cancelCallback_) {\n            return new Event_1.CancelEvent(this, error, path);\n        }\n        else {\n            return null;\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    ChildEventRegistration.prototype.createEvent = function (change, query) {\n        util_2.assert(change.childName != null, 'Child events should have a childName.');\n        var ref = query.getRef().child(/** @type {!string} */ (change.childName));\n        var index = query.getQueryParams().getIndex();\n        return new Event_1.DataEvent(change.type, this, new DataSnapshot_1.DataSnapshot(change.snapshotNode, ref, index), change.prevName);\n    };\n    /**\n     * @inheritDoc\n     */\n    ChildEventRegistration.prototype.getEventRunner = function (eventData) {\n        var ctx = this.context_;\n        if (eventData.getEventType() === 'cancel') {\n            util_2.assert(this.cancelCallback_, 'Raising a cancel event on a listener with no cancel callback');\n            var cancelCB_2 = this.cancelCallback_;\n            return function () {\n                // We know that error exists, we checked above that this is a cancel event\n                cancelCB_2.call(ctx, eventData.error);\n            };\n        }\n        else {\n            var cb_2 = this.callbacks_[eventData.eventType];\n            return function () {\n                cb_2.call(ctx, eventData.snapshot, eventData.prevName);\n            };\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    ChildEventRegistration.prototype.matches = function (other) {\n        if (other instanceof ChildEventRegistration) {\n            if (!this.callbacks_ || !other.callbacks_) {\n                return true;\n            }\n            else if (this.context_ === other.context_) {\n                var otherCount = util_1.getCount(other.callbacks_);\n                var thisCount = util_1.getCount(this.callbacks_);\n                if (otherCount === thisCount) {\n                    // If count is 1, do an exact match on eventType, if either is defined but null, it's a match.\n                    //  If event types don't match, not a match\n                    // If count is not 1, exact match across all\n                    if (otherCount === 1) {\n                        var otherKey /** @type {!string} */ = util_1.getAnyKey(other.callbacks_);\n                        var thisKey /** @type {!string} */ = util_1.getAnyKey(this.callbacks_);\n                        return (thisKey === otherKey &&\n                            (!other.callbacks_[otherKey] ||\n                                !this.callbacks_[thisKey] ||\n                                other.callbacks_[otherKey] === this.callbacks_[thisKey]));\n                    }\n                    else {\n                        // Exact match on each key.\n                        return util_1.every(this.callbacks_, function (eventType, cb) { return other.callbacks_[eventType] === cb; });\n                    }\n                }\n            }\n        }\n        return false;\n    };\n    /**\n     * @inheritDoc\n     */\n    ChildEventRegistration.prototype.hasAnyCallback = function () {\n        return this.callbacks_ !== null;\n    };\n    return ChildEventRegistration;\n}());\nexports.ChildEventRegistration = ChildEventRegistration;\n\n\n\n},{\"../../api/DataSnapshot\":5,\"./Event\":69,\"@firebase/util\":134}],73:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\nvar util_2 = require(\"../util/util\");\nvar KeyIndex_1 = require(\"../snap/indexes/KeyIndex\");\nvar PriorityIndex_1 = require(\"../snap/indexes/PriorityIndex\");\nvar ValueIndex_1 = require(\"../snap/indexes/ValueIndex\");\nvar PathIndex_1 = require(\"../snap/indexes/PathIndex\");\nvar IndexedFilter_1 = require(\"./filter/IndexedFilter\");\nvar LimitedFilter_1 = require(\"./filter/LimitedFilter\");\nvar RangedFilter_1 = require(\"./filter/RangedFilter\");\nvar util_3 = require(\"@firebase/util\");\n/**\n * This class is an immutable-from-the-public-api struct containing a set of query parameters defining a\n * range to be returned for a particular location. It is assumed that validation of parameters is done at the\n * user-facing API level, so it is not done here.\n * @constructor\n */\nvar QueryParams = /** @class */ (function () {\n    function QueryParams() {\n        this.limitSet_ = false;\n        this.startSet_ = false;\n        this.startNameSet_ = false;\n        this.endSet_ = false;\n        this.endNameSet_ = false;\n        this.limit_ = 0;\n        this.viewFrom_ = '';\n        this.indexStartValue_ = null;\n        this.indexStartName_ = '';\n        this.indexEndValue_ = null;\n        this.indexEndName_ = '';\n        this.index_ = PriorityIndex_1.PRIORITY_INDEX;\n    }\n    /**\n     * @return {boolean}\n     */\n    QueryParams.prototype.hasStart = function () {\n        return this.startSet_;\n    };\n    /**\n     * @return {boolean} True if it would return from left.\n     */\n    QueryParams.prototype.isViewFromLeft = function () {\n        if (this.viewFrom_ === '') {\n            // limit(), rather than limitToFirst or limitToLast was called.\n            // This means that only one of startSet_ and endSet_ is true. Use them\n            // to calculate which side of the view to anchor to. If neither is set,\n            // anchor to the end.\n            return this.startSet_;\n        }\n        else {\n            return (this.viewFrom_ === QueryParams.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT);\n        }\n    };\n    /**\n     * Only valid to call if hasStart() returns true\n     * @return {*}\n     */\n    QueryParams.prototype.getIndexStartValue = function () {\n        util_1.assert(this.startSet_, 'Only valid if start has been set');\n        return this.indexStartValue_;\n    };\n    /**\n     * Only valid to call if hasStart() returns true.\n     * Returns the starting key name for the range defined by these query parameters\n     * @return {!string}\n     */\n    QueryParams.prototype.getIndexStartName = function () {\n        util_1.assert(this.startSet_, 'Only valid if start has been set');\n        if (this.startNameSet_) {\n            return this.indexStartName_;\n        }\n        else {\n            return util_2.MIN_NAME;\n        }\n    };\n    /**\n     * @return {boolean}\n     */\n    QueryParams.prototype.hasEnd = function () {\n        return this.endSet_;\n    };\n    /**\n     * Only valid to call if hasEnd() returns true.\n     * @return {*}\n     */\n    QueryParams.prototype.getIndexEndValue = function () {\n        util_1.assert(this.endSet_, 'Only valid if end has been set');\n        return this.indexEndValue_;\n    };\n    /**\n     * Only valid to call if hasEnd() returns true.\n     * Returns the end key name for the range defined by these query parameters\n     * @return {!string}\n     */\n    QueryParams.prototype.getIndexEndName = function () {\n        util_1.assert(this.endSet_, 'Only valid if end has been set');\n        if (this.endNameSet_) {\n            return this.indexEndName_;\n        }\n        else {\n            return util_2.MAX_NAME;\n        }\n    };\n    /**\n     * @return {boolean}\n     */\n    QueryParams.prototype.hasLimit = function () {\n        return this.limitSet_;\n    };\n    /**\n     * @return {boolean} True if a limit has been set and it has been explicitly anchored\n     */\n    QueryParams.prototype.hasAnchoredLimit = function () {\n        return this.limitSet_ && this.viewFrom_ !== '';\n    };\n    /**\n     * Only valid to call if hasLimit() returns true\n     * @return {!number}\n     */\n    QueryParams.prototype.getLimit = function () {\n        util_1.assert(this.limitSet_, 'Only valid if limit has been set');\n        return this.limit_;\n    };\n    /**\n     * @return {!Index}\n     */\n    QueryParams.prototype.getIndex = function () {\n        return this.index_;\n    };\n    /**\n     * @return {!QueryParams}\n     * @private\n     */\n    QueryParams.prototype.copy_ = function () {\n        var copy = new QueryParams();\n        copy.limitSet_ = this.limitSet_;\n        copy.limit_ = this.limit_;\n        copy.startSet_ = this.startSet_;\n        copy.indexStartValue_ = this.indexStartValue_;\n        copy.startNameSet_ = this.startNameSet_;\n        copy.indexStartName_ = this.indexStartName_;\n        copy.endSet_ = this.endSet_;\n        copy.indexEndValue_ = this.indexEndValue_;\n        copy.endNameSet_ = this.endNameSet_;\n        copy.indexEndName_ = this.indexEndName_;\n        copy.index_ = this.index_;\n        copy.viewFrom_ = this.viewFrom_;\n        return copy;\n    };\n    /**\n     * @param {!number} newLimit\n     * @return {!QueryParams}\n     */\n    QueryParams.prototype.limit = function (newLimit) {\n        var newParams = this.copy_();\n        newParams.limitSet_ = true;\n        newParams.limit_ = newLimit;\n        newParams.viewFrom_ = '';\n        return newParams;\n    };\n    /**\n     * @param {!number} newLimit\n     * @return {!QueryParams}\n     */\n    QueryParams.prototype.limitToFirst = function (newLimit) {\n        var newParams = this.copy_();\n        newParams.limitSet_ = true;\n        newParams.limit_ = newLimit;\n        newParams.viewFrom_ = QueryParams.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT;\n        return newParams;\n    };\n    /**\n     * @param {!number} newLimit\n     * @return {!QueryParams}\n     */\n    QueryParams.prototype.limitToLast = function (newLimit) {\n        var newParams = this.copy_();\n        newParams.limitSet_ = true;\n        newParams.limit_ = newLimit;\n        newParams.viewFrom_ = QueryParams.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT;\n        return newParams;\n    };\n    /**\n     * @param {*} indexValue\n     * @param {?string=} key\n     * @return {!QueryParams}\n     */\n    QueryParams.prototype.startAt = function (indexValue, key) {\n        var newParams = this.copy_();\n        newParams.startSet_ = true;\n        if (!(indexValue !== undefined)) {\n            indexValue = null;\n        }\n        newParams.indexStartValue_ = indexValue;\n        if (key != null) {\n            newParams.startNameSet_ = true;\n            newParams.indexStartName_ = key;\n        }\n        else {\n            newParams.startNameSet_ = false;\n            newParams.indexStartName_ = '';\n        }\n        return newParams;\n    };\n    /**\n     * @param {*} indexValue\n     * @param {?string=} key\n     * @return {!QueryParams}\n     */\n    QueryParams.prototype.endAt = function (indexValue, key) {\n        var newParams = this.copy_();\n        newParams.endSet_ = true;\n        if (!(indexValue !== undefined)) {\n            indexValue = null;\n        }\n        newParams.indexEndValue_ = indexValue;\n        if (key !== undefined) {\n            newParams.endNameSet_ = true;\n            newParams.indexEndName_ = key;\n        }\n        else {\n            newParams.endNameSet_ = false;\n            newParams.indexEndName_ = '';\n        }\n        return newParams;\n    };\n    /**\n     * @param {!Index} index\n     * @return {!QueryParams}\n     */\n    QueryParams.prototype.orderBy = function (index) {\n        var newParams = this.copy_();\n        newParams.index_ = index;\n        return newParams;\n    };\n    /**\n     * @return {!Object}\n     */\n    QueryParams.prototype.getQueryObject = function () {\n        var WIRE_PROTOCOL_CONSTANTS = QueryParams.WIRE_PROTOCOL_CONSTANTS_;\n        var obj = {};\n        if (this.startSet_) {\n            obj[WIRE_PROTOCOL_CONSTANTS.INDEX_START_VALUE] = this.indexStartValue_;\n            if (this.startNameSet_) {\n                obj[WIRE_PROTOCOL_CONSTANTS.INDEX_START_NAME] = this.indexStartName_;\n            }\n        }\n        if (this.endSet_) {\n            obj[WIRE_PROTOCOL_CONSTANTS.INDEX_END_VALUE] = this.indexEndValue_;\n            if (this.endNameSet_) {\n                obj[WIRE_PROTOCOL_CONSTANTS.INDEX_END_NAME] = this.indexEndName_;\n            }\n        }\n        if (this.limitSet_) {\n            obj[WIRE_PROTOCOL_CONSTANTS.LIMIT] = this.limit_;\n            var viewFrom = this.viewFrom_;\n            if (viewFrom === '') {\n                if (this.isViewFromLeft()) {\n                    viewFrom = WIRE_PROTOCOL_CONSTANTS.VIEW_FROM_LEFT;\n                }\n                else {\n                    viewFrom = WIRE_PROTOCOL_CONSTANTS.VIEW_FROM_RIGHT;\n                }\n            }\n            obj[WIRE_PROTOCOL_CONSTANTS.VIEW_FROM] = viewFrom;\n        }\n        // For now, priority index is the default, so we only specify if it's some other index\n        if (this.index_ !== PriorityIndex_1.PRIORITY_INDEX) {\n            obj[WIRE_PROTOCOL_CONSTANTS.INDEX] = this.index_.toString();\n        }\n        return obj;\n    };\n    /**\n     * @return {boolean}\n     */\n    QueryParams.prototype.loadsAllData = function () {\n        return !(this.startSet_ || this.endSet_ || this.limitSet_);\n    };\n    /**\n     * @return {boolean}\n     */\n    QueryParams.prototype.isDefault = function () {\n        return this.loadsAllData() && this.index_ == PriorityIndex_1.PRIORITY_INDEX;\n    };\n    /**\n     * @return {!NodeFilter}\n     */\n    QueryParams.prototype.getNodeFilter = function () {\n        if (this.loadsAllData()) {\n            return new IndexedFilter_1.IndexedFilter(this.getIndex());\n        }\n        else if (this.hasLimit()) {\n            return new LimitedFilter_1.LimitedFilter(this);\n        }\n        else {\n            return new RangedFilter_1.RangedFilter(this);\n        }\n    };\n    /**\n     * Returns a set of REST query string parameters representing this query.\n     *\n     * @return {!Object.<string,*>} query string parameters\n     */\n    QueryParams.prototype.toRestQueryStringParameters = function () {\n        var REST_CONSTANTS = QueryParams.REST_QUERY_CONSTANTS_;\n        var qs = {};\n        if (this.isDefault()) {\n            return qs;\n        }\n        var orderBy;\n        if (this.index_ === PriorityIndex_1.PRIORITY_INDEX) {\n            orderBy = REST_CONSTANTS.PRIORITY_INDEX;\n        }\n        else if (this.index_ === ValueIndex_1.VALUE_INDEX) {\n            orderBy = REST_CONSTANTS.VALUE_INDEX;\n        }\n        else if (this.index_ === KeyIndex_1.KEY_INDEX) {\n            orderBy = REST_CONSTANTS.KEY_INDEX;\n        }\n        else {\n            util_1.assert(this.index_ instanceof PathIndex_1.PathIndex, 'Unrecognized index type!');\n            orderBy = this.index_.toString();\n        }\n        qs[REST_CONSTANTS.ORDER_BY] = util_3.stringify(orderBy);\n        if (this.startSet_) {\n            qs[REST_CONSTANTS.START_AT] = util_3.stringify(this.indexStartValue_);\n            if (this.startNameSet_) {\n                qs[REST_CONSTANTS.START_AT] += ',' + util_3.stringify(this.indexStartName_);\n            }\n        }\n        if (this.endSet_) {\n            qs[REST_CONSTANTS.END_AT] = util_3.stringify(this.indexEndValue_);\n            if (this.endNameSet_) {\n                qs[REST_CONSTANTS.END_AT] += ',' + util_3.stringify(this.indexEndName_);\n            }\n        }\n        if (this.limitSet_) {\n            if (this.isViewFromLeft()) {\n                qs[REST_CONSTANTS.LIMIT_TO_FIRST] = this.limit_;\n            }\n            else {\n                qs[REST_CONSTANTS.LIMIT_TO_LAST] = this.limit_;\n            }\n        }\n        return qs;\n    };\n    /**\n     * Wire Protocol Constants\n     * @const\n     * @enum {string}\n     * @private\n     */\n    QueryParams.WIRE_PROTOCOL_CONSTANTS_ = {\n        INDEX_START_VALUE: 'sp',\n        INDEX_START_NAME: 'sn',\n        INDEX_END_VALUE: 'ep',\n        INDEX_END_NAME: 'en',\n        LIMIT: 'l',\n        VIEW_FROM: 'vf',\n        VIEW_FROM_LEFT: 'l',\n        VIEW_FROM_RIGHT: 'r',\n        INDEX: 'i'\n    };\n    /**\n     * REST Query Constants\n     * @const\n     * @enum {string}\n     * @private\n     */\n    QueryParams.REST_QUERY_CONSTANTS_ = {\n        ORDER_BY: 'orderBy',\n        PRIORITY_INDEX: '$priority',\n        VALUE_INDEX: '$value',\n        KEY_INDEX: '$key',\n        START_AT: 'startAt',\n        END_AT: 'endAt',\n        LIMIT_TO_FIRST: 'limitToFirst',\n        LIMIT_TO_LAST: 'limitToLast'\n    };\n    /**\n     * Default, empty query parameters\n     * @type {!QueryParams}\n     * @const\n     */\n    QueryParams.DEFAULT = new QueryParams();\n    return QueryParams;\n}());\nexports.QueryParams = QueryParams;\n\n\n\n},{\"../snap/indexes/KeyIndex\":39,\"../snap/indexes/PathIndex\":40,\"../snap/indexes/PriorityIndex\":41,\"../snap/indexes/ValueIndex\":42,\"../util/util\":63,\"./filter/IndexedFilter\":77,\"./filter/LimitedFilter\":78,\"./filter/RangedFilter\":79,\"@firebase/util\":134}],74:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar IndexedFilter_1 = require(\"./filter/IndexedFilter\");\nvar ViewProcessor_1 = require(\"./ViewProcessor\");\nvar ChildrenNode_1 = require(\"../snap/ChildrenNode\");\nvar CacheNode_1 = require(\"./CacheNode\");\nvar ViewCache_1 = require(\"./ViewCache\");\nvar EventGenerator_1 = require(\"./EventGenerator\");\nvar util_1 = require(\"@firebase/util\");\nvar Operation_1 = require(\"../operation/Operation\");\nvar Change_1 = require(\"./Change\");\nvar PriorityIndex_1 = require(\"../snap/indexes/PriorityIndex\");\n/**\n * A view represents a specific location and query that has 1 or more event registrations.\n *\n * It does several things:\n *  - Maintains the list of event registrations for this location/query.\n *  - Maintains a cache of the data visible for this location/query.\n *  - Applies new operations (via applyOperation), updates the cache, and based on the event\n *    registrations returns the set of events to be raised.\n * @constructor\n */\nvar View = /** @class */ (function () {\n    /**\n     *\n     * @param {!Query} query_\n     * @param {!ViewCache} initialViewCache\n     */\n    function View(query_, initialViewCache) {\n        this.query_ = query_;\n        this.eventRegistrations_ = [];\n        var params = this.query_.getQueryParams();\n        var indexFilter = new IndexedFilter_1.IndexedFilter(params.getIndex());\n        var filter = params.getNodeFilter();\n        /**\n         * @type {ViewProcessor}\n         * @private\n         */\n        this.processor_ = new ViewProcessor_1.ViewProcessor(filter);\n        var initialServerCache = initialViewCache.getServerCache();\n        var initialEventCache = initialViewCache.getEventCache();\n        // Don't filter server node with other filter than index, wait for tagged listen\n        var serverSnap = indexFilter.updateFullNode(ChildrenNode_1.ChildrenNode.EMPTY_NODE, initialServerCache.getNode(), null);\n        var eventSnap = filter.updateFullNode(ChildrenNode_1.ChildrenNode.EMPTY_NODE, initialEventCache.getNode(), null);\n        var newServerCache = new CacheNode_1.CacheNode(serverSnap, initialServerCache.isFullyInitialized(), indexFilter.filtersNodes());\n        var newEventCache = new CacheNode_1.CacheNode(eventSnap, initialEventCache.isFullyInitialized(), filter.filtersNodes());\n        /**\n         * @type {!ViewCache}\n         * @private\n         */\n        this.viewCache_ = new ViewCache_1.ViewCache(newEventCache, newServerCache);\n        /**\n         * @type {!EventGenerator}\n         * @private\n         */\n        this.eventGenerator_ = new EventGenerator_1.EventGenerator(this.query_);\n    }\n    /**\n     * @return {!Query}\n     */\n    View.prototype.getQuery = function () {\n        return this.query_;\n    };\n    /**\n     * @return {?Node}\n     */\n    View.prototype.getServerCache = function () {\n        return this.viewCache_.getServerCache().getNode();\n    };\n    /**\n     * @param {!Path} path\n     * @return {?Node}\n     */\n    View.prototype.getCompleteServerCache = function (path) {\n        var cache = this.viewCache_.getCompleteServerSnap();\n        if (cache) {\n            // If this isn't a \"loadsAllData\" view, then cache isn't actually a complete cache and\n            // we need to see if it contains the child we're interested in.\n            if (this.query_.getQueryParams().loadsAllData() ||\n                (!path.isEmpty() && !cache.getImmediateChild(path.getFront()).isEmpty())) {\n                return cache.getChild(path);\n            }\n        }\n        return null;\n    };\n    /**\n     * @return {boolean}\n     */\n    View.prototype.isEmpty = function () {\n        return this.eventRegistrations_.length === 0;\n    };\n    /**\n     * @param {!EventRegistration} eventRegistration\n     */\n    View.prototype.addEventRegistration = function (eventRegistration) {\n        this.eventRegistrations_.push(eventRegistration);\n    };\n    /**\n     * @param {?EventRegistration} eventRegistration If null, remove all callbacks.\n     * @param {Error=} cancelError If a cancelError is provided, appropriate cancel events will be returned.\n     * @return {!Array.<!Event>} Cancel events, if cancelError was provided.\n     */\n    View.prototype.removeEventRegistration = function (eventRegistration, cancelError) {\n        var cancelEvents = [];\n        if (cancelError) {\n            util_1.assert(eventRegistration == null, 'A cancel should cancel all event registrations.');\n            var path_1 = this.query_.path;\n            this.eventRegistrations_.forEach(function (registration) {\n                cancelError /** @type {!Error} */ = cancelError;\n                var maybeEvent = registration.createCancelEvent(cancelError, path_1);\n                if (maybeEvent) {\n                    cancelEvents.push(maybeEvent);\n                }\n            });\n        }\n        if (eventRegistration) {\n            var remaining = [];\n            for (var i = 0; i < this.eventRegistrations_.length; ++i) {\n                var existing = this.eventRegistrations_[i];\n                if (!existing.matches(eventRegistration)) {\n                    remaining.push(existing);\n                }\n                else if (eventRegistration.hasAnyCallback()) {\n                    // We're removing just this one\n                    remaining = remaining.concat(this.eventRegistrations_.slice(i + 1));\n                    break;\n                }\n            }\n            this.eventRegistrations_ = remaining;\n        }\n        else {\n            this.eventRegistrations_ = [];\n        }\n        return cancelEvents;\n    };\n    /**\n     * Applies the given Operation, updates our cache, and returns the appropriate events.\n     *\n     * @param {!Operation} operation\n     * @param {!WriteTreeRef} writesCache\n     * @param {?Node} completeServerCache\n     * @return {!Array.<!Event>}\n     */\n    View.prototype.applyOperation = function (operation, writesCache, completeServerCache) {\n        if (operation.type === Operation_1.OperationType.MERGE &&\n            operation.source.queryId !== null) {\n            util_1.assert(this.viewCache_.getCompleteServerSnap(), 'We should always have a full cache before handling merges');\n            util_1.assert(this.viewCache_.getCompleteEventSnap(), 'Missing event cache, even though we have a server cache');\n        }\n        var oldViewCache = this.viewCache_;\n        var result = this.processor_.applyOperation(oldViewCache, operation, writesCache, completeServerCache);\n        this.processor_.assertIndexed(result.viewCache);\n        util_1.assert(result.viewCache.getServerCache().isFullyInitialized() ||\n            !oldViewCache.getServerCache().isFullyInitialized(), 'Once a server snap is complete, it should never go back');\n        this.viewCache_ = result.viewCache;\n        return this.generateEventsForChanges_(result.changes, result.viewCache.getEventCache().getNode(), null);\n    };\n    /**\n     * @param {!EventRegistration} registration\n     * @return {!Array.<!Event>}\n     */\n    View.prototype.getInitialEvents = function (registration) {\n        var eventSnap = this.viewCache_.getEventCache();\n        var initialChanges = [];\n        if (!eventSnap.getNode().isLeafNode()) {\n            var eventNode = eventSnap.getNode();\n            eventNode.forEachChild(PriorityIndex_1.PRIORITY_INDEX, function (key, childNode) {\n                initialChanges.push(Change_1.Change.childAddedChange(key, childNode));\n            });\n        }\n        if (eventSnap.isFullyInitialized()) {\n            initialChanges.push(Change_1.Change.valueChange(eventSnap.getNode()));\n        }\n        return this.generateEventsForChanges_(initialChanges, eventSnap.getNode(), registration);\n    };\n    /**\n     * @private\n     * @param {!Array.<!Change>} changes\n     * @param {!Node} eventCache\n     * @param {EventRegistration=} eventRegistration\n     * @return {!Array.<!Event>}\n     */\n    View.prototype.generateEventsForChanges_ = function (changes, eventCache, eventRegistration) {\n        var registrations = eventRegistration\n            ? [eventRegistration]\n            : this.eventRegistrations_;\n        return this.eventGenerator_.generateEventsForChanges(changes, eventCache, registrations);\n    };\n    return View;\n}());\nexports.View = View;\n\n\n\n},{\"../operation/Operation\":30,\"../snap/ChildrenNode\":32,\"../snap/indexes/PriorityIndex\":41,\"./CacheNode\":65,\"./Change\":66,\"./EventGenerator\":70,\"./ViewCache\":75,\"./ViewProcessor\":76,\"./filter/IndexedFilter\":77,\"@firebase/util\":134}],75:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ChildrenNode_1 = require(\"../snap/ChildrenNode\");\nvar CacheNode_1 = require(\"./CacheNode\");\n/**\n * Stores the data we have cached for a view.\n *\n * serverSnap is the cached server data, eventSnap is the cached event data (server data plus any local writes).\n *\n * @constructor\n */\nvar ViewCache = /** @class */ (function () {\n    /**\n     *\n     * @param {!CacheNode} eventCache_\n     * @param {!CacheNode} serverCache_\n     */\n    function ViewCache(eventCache_, serverCache_) {\n        this.eventCache_ = eventCache_;\n        this.serverCache_ = serverCache_;\n    }\n    /**\n     * @param {!Node} eventSnap\n     * @param {boolean} complete\n     * @param {boolean} filtered\n     * @return {!ViewCache}\n     */\n    ViewCache.prototype.updateEventSnap = function (eventSnap, complete, filtered) {\n        return new ViewCache(new CacheNode_1.CacheNode(eventSnap, complete, filtered), this.serverCache_);\n    };\n    /**\n     * @param {!Node} serverSnap\n     * @param {boolean} complete\n     * @param {boolean} filtered\n     * @return {!ViewCache}\n     */\n    ViewCache.prototype.updateServerSnap = function (serverSnap, complete, filtered) {\n        return new ViewCache(this.eventCache_, new CacheNode_1.CacheNode(serverSnap, complete, filtered));\n    };\n    /**\n     * @return {!CacheNode}\n     */\n    ViewCache.prototype.getEventCache = function () {\n        return this.eventCache_;\n    };\n    /**\n     * @return {?Node}\n     */\n    ViewCache.prototype.getCompleteEventSnap = function () {\n        return this.eventCache_.isFullyInitialized()\n            ? this.eventCache_.getNode()\n            : null;\n    };\n    /**\n     * @return {!CacheNode}\n     */\n    ViewCache.prototype.getServerCache = function () {\n        return this.serverCache_;\n    };\n    /**\n     * @return {?Node}\n     */\n    ViewCache.prototype.getCompleteServerSnap = function () {\n        return this.serverCache_.isFullyInitialized()\n            ? this.serverCache_.getNode()\n            : null;\n    };\n    /**\n     * @const\n     * @type {ViewCache}\n     */\n    ViewCache.Empty = new ViewCache(new CacheNode_1.CacheNode(ChildrenNode_1.ChildrenNode.EMPTY_NODE, \n    /*fullyInitialized=*/ false, \n    /*filtered=*/ false), new CacheNode_1.CacheNode(ChildrenNode_1.ChildrenNode.EMPTY_NODE, \n    /*fullyInitialized=*/ false, \n    /*filtered=*/ false));\n    return ViewCache;\n}());\nexports.ViewCache = ViewCache;\n\n\n\n},{\"../snap/ChildrenNode\":32,\"./CacheNode\":65}],76:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Operation_1 = require(\"../operation/Operation\");\nvar util_1 = require(\"@firebase/util\");\nvar ChildChangeAccumulator_1 = require(\"./ChildChangeAccumulator\");\nvar Change_1 = require(\"./Change\");\nvar ChildrenNode_1 = require(\"../snap/ChildrenNode\");\nvar KeyIndex_1 = require(\"../snap/indexes/KeyIndex\");\nvar ImmutableTree_1 = require(\"../util/ImmutableTree\");\nvar Path_1 = require(\"../util/Path\");\nvar CompleteChildSource_1 = require(\"./CompleteChildSource\");\n/**\n * @constructor\n * @struct\n */\nvar ProcessorResult = /** @class */ (function () {\n    /**\n     * @param {!ViewCache} viewCache\n     * @param {!Array.<!Change>} changes\n     */\n    function ProcessorResult(viewCache, changes) {\n        this.viewCache = viewCache;\n        this.changes = changes;\n    }\n    return ProcessorResult;\n}());\nexports.ProcessorResult = ProcessorResult;\n/**\n * @constructor\n */\nvar ViewProcessor = /** @class */ (function () {\n    /**\n     * @param {!NodeFilter} filter_\n     */\n    function ViewProcessor(filter_) {\n        this.filter_ = filter_;\n    }\n    /**\n     * @param {!ViewCache} viewCache\n     */\n    ViewProcessor.prototype.assertIndexed = function (viewCache) {\n        util_1.assert(viewCache\n            .getEventCache()\n            .getNode()\n            .isIndexed(this.filter_.getIndex()), 'Event snap not indexed');\n        util_1.assert(viewCache\n            .getServerCache()\n            .getNode()\n            .isIndexed(this.filter_.getIndex()), 'Server snap not indexed');\n    };\n    /**\n     * @param {!ViewCache} oldViewCache\n     * @param {!Operation} operation\n     * @param {!WriteTreeRef} writesCache\n     * @param {?Node} completeCache\n     * @return {!ProcessorResult}\n     */\n    ViewProcessor.prototype.applyOperation = function (oldViewCache, operation, writesCache, completeCache) {\n        var accumulator = new ChildChangeAccumulator_1.ChildChangeAccumulator();\n        var newViewCache, filterServerNode;\n        if (operation.type === Operation_1.OperationType.OVERWRITE) {\n            var overwrite = operation;\n            if (overwrite.source.fromUser) {\n                newViewCache = this.applyUserOverwrite_(oldViewCache, overwrite.path, overwrite.snap, writesCache, completeCache, accumulator);\n            }\n            else {\n                util_1.assert(overwrite.source.fromServer, 'Unknown source.');\n                // We filter the node if it's a tagged update or the node has been previously filtered  and the\n                // update is not at the root in which case it is ok (and necessary) to mark the node unfiltered\n                // again\n                filterServerNode =\n                    overwrite.source.tagged ||\n                        (oldViewCache.getServerCache().isFiltered() &&\n                            !overwrite.path.isEmpty());\n                newViewCache = this.applyServerOverwrite_(oldViewCache, overwrite.path, overwrite.snap, writesCache, completeCache, filterServerNode, accumulator);\n            }\n        }\n        else if (operation.type === Operation_1.OperationType.MERGE) {\n            var merge = operation;\n            if (merge.source.fromUser) {\n                newViewCache = this.applyUserMerge_(oldViewCache, merge.path, merge.children, writesCache, completeCache, accumulator);\n            }\n            else {\n                util_1.assert(merge.source.fromServer, 'Unknown source.');\n                // We filter the node if it's a tagged update or the node has been previously filtered\n                filterServerNode =\n                    merge.source.tagged || oldViewCache.getServerCache().isFiltered();\n                newViewCache = this.applyServerMerge_(oldViewCache, merge.path, merge.children, writesCache, completeCache, filterServerNode, accumulator);\n            }\n        }\n        else if (operation.type === Operation_1.OperationType.ACK_USER_WRITE) {\n            var ackUserWrite = operation;\n            if (!ackUserWrite.revert) {\n                newViewCache = this.ackUserWrite_(oldViewCache, ackUserWrite.path, ackUserWrite.affectedTree, writesCache, completeCache, accumulator);\n            }\n            else {\n                newViewCache = this.revertUserWrite_(oldViewCache, ackUserWrite.path, writesCache, completeCache, accumulator);\n            }\n        }\n        else if (operation.type === Operation_1.OperationType.LISTEN_COMPLETE) {\n            newViewCache = this.listenComplete_(oldViewCache, operation.path, writesCache, accumulator);\n        }\n        else {\n            throw util_1.assertionError('Unknown operation type: ' + operation.type);\n        }\n        var changes = accumulator.getChanges();\n        ViewProcessor.maybeAddValueEvent_(oldViewCache, newViewCache, changes);\n        return new ProcessorResult(newViewCache, changes);\n    };\n    /**\n     * @param {!ViewCache} oldViewCache\n     * @param {!ViewCache} newViewCache\n     * @param {!Array.<!Change>} accumulator\n     * @private\n     */\n    ViewProcessor.maybeAddValueEvent_ = function (oldViewCache, newViewCache, accumulator) {\n        var eventSnap = newViewCache.getEventCache();\n        if (eventSnap.isFullyInitialized()) {\n            var isLeafOrEmpty = eventSnap.getNode().isLeafNode() || eventSnap.getNode().isEmpty();\n            var oldCompleteSnap = oldViewCache.getCompleteEventSnap();\n            if (accumulator.length > 0 ||\n                !oldViewCache.getEventCache().isFullyInitialized() ||\n                (isLeafOrEmpty &&\n                    !eventSnap\n                        .getNode()\n                        .equals(/** @type {!Node} */ (oldCompleteSnap))) ||\n                !eventSnap\n                    .getNode()\n                    .getPriority()\n                    .equals(oldCompleteSnap.getPriority())) {\n                accumulator.push(Change_1.Change.valueChange(\n                /** @type {!Node} */ newViewCache.getCompleteEventSnap()));\n            }\n        }\n    };\n    /**\n     * @param {!ViewCache} viewCache\n     * @param {!Path} changePath\n     * @param {!WriteTreeRef} writesCache\n     * @param {!CompleteChildSource} source\n     * @param {!ChildChangeAccumulator} accumulator\n     * @return {!ViewCache}\n     * @private\n     */\n    ViewProcessor.prototype.generateEventCacheAfterServerEvent_ = function (viewCache, changePath, writesCache, source, accumulator) {\n        var oldEventSnap = viewCache.getEventCache();\n        if (writesCache.shadowingWrite(changePath) != null) {\n            // we have a shadowing write, ignore changes\n            return viewCache;\n        }\n        else {\n            var newEventCache = void 0, serverNode = void 0;\n            if (changePath.isEmpty()) {\n                // TODO: figure out how this plays with \"sliding ack windows\"\n                util_1.assert(viewCache.getServerCache().isFullyInitialized(), 'If change path is empty, we must have complete server data');\n                if (viewCache.getServerCache().isFiltered()) {\n                    // We need to special case this, because we need to only apply writes to complete children, or\n                    // we might end up raising events for incomplete children. If the server data is filtered deep\n                    // writes cannot be guaranteed to be complete\n                    var serverCache = viewCache.getCompleteServerSnap();\n                    var completeChildren = serverCache instanceof ChildrenNode_1.ChildrenNode\n                        ? serverCache\n                        : ChildrenNode_1.ChildrenNode.EMPTY_NODE;\n                    var completeEventChildren = writesCache.calcCompleteEventChildren(completeChildren);\n                    newEventCache = this.filter_.updateFullNode(viewCache.getEventCache().getNode(), completeEventChildren, accumulator);\n                }\n                else {\n                    var completeNode = writesCache.calcCompleteEventCache(viewCache.getCompleteServerSnap());\n                    newEventCache = this.filter_.updateFullNode(viewCache.getEventCache().getNode(), completeNode, accumulator);\n                }\n            }\n            else {\n                var childKey = changePath.getFront();\n                if (childKey == '.priority') {\n                    util_1.assert(changePath.getLength() == 1, \"Can't have a priority with additional path components\");\n                    var oldEventNode = oldEventSnap.getNode();\n                    serverNode = viewCache.getServerCache().getNode();\n                    // we might have overwrites for this priority\n                    var updatedPriority = writesCache.calcEventCacheAfterServerOverwrite(changePath, oldEventNode, serverNode);\n                    if (updatedPriority != null) {\n                        newEventCache = this.filter_.updatePriority(oldEventNode, updatedPriority);\n                    }\n                    else {\n                        // priority didn't change, keep old node\n                        newEventCache = oldEventSnap.getNode();\n                    }\n                }\n                else {\n                    var childChangePath = changePath.popFront();\n                    // update child\n                    var newEventChild = void 0;\n                    if (oldEventSnap.isCompleteForChild(childKey)) {\n                        serverNode = viewCache.getServerCache().getNode();\n                        var eventChildUpdate = writesCache.calcEventCacheAfterServerOverwrite(changePath, oldEventSnap.getNode(), serverNode);\n                        if (eventChildUpdate != null) {\n                            newEventChild = oldEventSnap\n                                .getNode()\n                                .getImmediateChild(childKey)\n                                .updateChild(childChangePath, eventChildUpdate);\n                        }\n                        else {\n                            // Nothing changed, just keep the old child\n                            newEventChild = oldEventSnap\n                                .getNode()\n                                .getImmediateChild(childKey);\n                        }\n                    }\n                    else {\n                        newEventChild = writesCache.calcCompleteChild(childKey, viewCache.getServerCache());\n                    }\n                    if (newEventChild != null) {\n                        newEventCache = this.filter_.updateChild(oldEventSnap.getNode(), childKey, newEventChild, childChangePath, source, accumulator);\n                    }\n                    else {\n                        // no complete child available or no change\n                        newEventCache = oldEventSnap.getNode();\n                    }\n                }\n            }\n            return viewCache.updateEventSnap(newEventCache, oldEventSnap.isFullyInitialized() || changePath.isEmpty(), this.filter_.filtersNodes());\n        }\n    };\n    /**\n     * @param {!ViewCache} oldViewCache\n     * @param {!Path} changePath\n     * @param {!Node} changedSnap\n     * @param {!WriteTreeRef} writesCache\n     * @param {?Node} completeCache\n     * @param {boolean} filterServerNode\n     * @param {!ChildChangeAccumulator} accumulator\n     * @return {!ViewCache}\n     * @private\n     */\n    ViewProcessor.prototype.applyServerOverwrite_ = function (oldViewCache, changePath, changedSnap, writesCache, completeCache, filterServerNode, accumulator) {\n        var oldServerSnap = oldViewCache.getServerCache();\n        var newServerCache;\n        var serverFilter = filterServerNode\n            ? this.filter_\n            : this.filter_.getIndexedFilter();\n        if (changePath.isEmpty()) {\n            newServerCache = serverFilter.updateFullNode(oldServerSnap.getNode(), changedSnap, null);\n        }\n        else if (serverFilter.filtersNodes() && !oldServerSnap.isFiltered()) {\n            // we want to filter the server node, but we didn't filter the server node yet, so simulate a full update\n            var newServerNode = oldServerSnap\n                .getNode()\n                .updateChild(changePath, changedSnap);\n            newServerCache = serverFilter.updateFullNode(oldServerSnap.getNode(), newServerNode, null);\n        }\n        else {\n            var childKey = changePath.getFront();\n            if (!oldServerSnap.isCompleteForPath(changePath) &&\n                changePath.getLength() > 1) {\n                // We don't update incomplete nodes with updates intended for other listeners\n                return oldViewCache;\n            }\n            var childChangePath = changePath.popFront();\n            var childNode = oldServerSnap.getNode().getImmediateChild(childKey);\n            var newChildNode = childNode.updateChild(childChangePath, changedSnap);\n            if (childKey == '.priority') {\n                newServerCache = serverFilter.updatePriority(oldServerSnap.getNode(), newChildNode);\n            }\n            else {\n                newServerCache = serverFilter.updateChild(oldServerSnap.getNode(), childKey, newChildNode, childChangePath, CompleteChildSource_1.NO_COMPLETE_CHILD_SOURCE, null);\n            }\n        }\n        var newViewCache = oldViewCache.updateServerSnap(newServerCache, oldServerSnap.isFullyInitialized() || changePath.isEmpty(), serverFilter.filtersNodes());\n        var source = new CompleteChildSource_1.WriteTreeCompleteChildSource(writesCache, newViewCache, completeCache);\n        return this.generateEventCacheAfterServerEvent_(newViewCache, changePath, writesCache, source, accumulator);\n    };\n    /**\n     * @param {!ViewCache} oldViewCache\n     * @param {!Path} changePath\n     * @param {!Node} changedSnap\n     * @param {!WriteTreeRef} writesCache\n     * @param {?Node} completeCache\n     * @param {!ChildChangeAccumulator} accumulator\n     * @return {!ViewCache}\n     * @private\n     */\n    ViewProcessor.prototype.applyUserOverwrite_ = function (oldViewCache, changePath, changedSnap, writesCache, completeCache, accumulator) {\n        var oldEventSnap = oldViewCache.getEventCache();\n        var newViewCache, newEventCache;\n        var source = new CompleteChildSource_1.WriteTreeCompleteChildSource(writesCache, oldViewCache, completeCache);\n        if (changePath.isEmpty()) {\n            newEventCache = this.filter_.updateFullNode(oldViewCache.getEventCache().getNode(), changedSnap, accumulator);\n            newViewCache = oldViewCache.updateEventSnap(newEventCache, true, this.filter_.filtersNodes());\n        }\n        else {\n            var childKey = changePath.getFront();\n            if (childKey === '.priority') {\n                newEventCache = this.filter_.updatePriority(oldViewCache.getEventCache().getNode(), changedSnap);\n                newViewCache = oldViewCache.updateEventSnap(newEventCache, oldEventSnap.isFullyInitialized(), oldEventSnap.isFiltered());\n            }\n            else {\n                var childChangePath = changePath.popFront();\n                var oldChild = oldEventSnap.getNode().getImmediateChild(childKey);\n                var newChild = void 0;\n                if (childChangePath.isEmpty()) {\n                    // Child overwrite, we can replace the child\n                    newChild = changedSnap;\n                }\n                else {\n                    var childNode = source.getCompleteChild(childKey);\n                    if (childNode != null) {\n                        if (childChangePath.getBack() === '.priority' &&\n                            childNode.getChild(childChangePath.parent()).isEmpty()) {\n                            // This is a priority update on an empty node. If this node exists on the server, the\n                            // server will send down the priority in the update, so ignore for now\n                            newChild = childNode;\n                        }\n                        else {\n                            newChild = childNode.updateChild(childChangePath, changedSnap);\n                        }\n                    }\n                    else {\n                        // There is no complete child node available\n                        newChild = ChildrenNode_1.ChildrenNode.EMPTY_NODE;\n                    }\n                }\n                if (!oldChild.equals(newChild)) {\n                    var newEventSnap = this.filter_.updateChild(oldEventSnap.getNode(), childKey, newChild, childChangePath, source, accumulator);\n                    newViewCache = oldViewCache.updateEventSnap(newEventSnap, oldEventSnap.isFullyInitialized(), this.filter_.filtersNodes());\n                }\n                else {\n                    newViewCache = oldViewCache;\n                }\n            }\n        }\n        return newViewCache;\n    };\n    /**\n     * @param {!ViewCache} viewCache\n     * @param {string} childKey\n     * @return {boolean}\n     * @private\n     */\n    ViewProcessor.cacheHasChild_ = function (viewCache, childKey) {\n        return viewCache.getEventCache().isCompleteForChild(childKey);\n    };\n    /**\n     * @param {!ViewCache} viewCache\n     * @param {!Path} path\n     * @param {ImmutableTree.<!Node>} changedChildren\n     * @param {!WriteTreeRef} writesCache\n     * @param {?Node} serverCache\n     * @param {!ChildChangeAccumulator} accumulator\n     * @return {!ViewCache}\n     * @private\n     */\n    ViewProcessor.prototype.applyUserMerge_ = function (viewCache, path, changedChildren, writesCache, serverCache, accumulator) {\n        var _this = this;\n        // HACK: In the case of a limit query, there may be some changes that bump things out of the\n        // window leaving room for new items.  It's important we process these changes first, so we\n        // iterate the changes twice, first processing any that affect items currently in view.\n        // TODO: I consider an item \"in view\" if cacheHasChild is true, which checks both the server\n        // and event snap.  I'm not sure if this will result in edge cases when a child is in one but\n        // not the other.\n        var curViewCache = viewCache;\n        changedChildren.foreach(function (relativePath, childNode) {\n            var writePath = path.child(relativePath);\n            if (ViewProcessor.cacheHasChild_(viewCache, writePath.getFront())) {\n                curViewCache = _this.applyUserOverwrite_(curViewCache, writePath, childNode, writesCache, serverCache, accumulator);\n            }\n        });\n        changedChildren.foreach(function (relativePath, childNode) {\n            var writePath = path.child(relativePath);\n            if (!ViewProcessor.cacheHasChild_(viewCache, writePath.getFront())) {\n                curViewCache = _this.applyUserOverwrite_(curViewCache, writePath, childNode, writesCache, serverCache, accumulator);\n            }\n        });\n        return curViewCache;\n    };\n    /**\n     * @param {!Node} node\n     * @param {ImmutableTree.<!Node>} merge\n     * @return {!Node}\n     * @private\n     */\n    ViewProcessor.prototype.applyMerge_ = function (node, merge) {\n        merge.foreach(function (relativePath, childNode) {\n            node = node.updateChild(relativePath, childNode);\n        });\n        return node;\n    };\n    /**\n     * @param {!ViewCache} viewCache\n     * @param {!Path} path\n     * @param {!ImmutableTree.<!Node>} changedChildren\n     * @param {!WriteTreeRef} writesCache\n     * @param {?Node} serverCache\n     * @param {boolean} filterServerNode\n     * @param {!ChildChangeAccumulator} accumulator\n     * @return {!ViewCache}\n     * @private\n     */\n    ViewProcessor.prototype.applyServerMerge_ = function (viewCache, path, changedChildren, writesCache, serverCache, filterServerNode, accumulator) {\n        var _this = this;\n        // If we don't have a cache yet, this merge was intended for a previously listen in the same location. Ignore it and\n        // wait for the complete data update coming soon.\n        if (viewCache\n            .getServerCache()\n            .getNode()\n            .isEmpty() &&\n            !viewCache.getServerCache().isFullyInitialized()) {\n            return viewCache;\n        }\n        // HACK: In the case of a limit query, there may be some changes that bump things out of the\n        // window leaving room for new items.  It's important we process these changes first, so we\n        // iterate the changes twice, first processing any that affect items currently in view.\n        // TODO: I consider an item \"in view\" if cacheHasChild is true, which checks both the server\n        // and event snap.  I'm not sure if this will result in edge cases when a child is in one but\n        // not the other.\n        var curViewCache = viewCache;\n        var viewMergeTree;\n        if (path.isEmpty()) {\n            viewMergeTree = changedChildren;\n        }\n        else {\n            viewMergeTree = ImmutableTree_1.ImmutableTree.Empty.setTree(path, changedChildren);\n        }\n        var serverNode = viewCache.getServerCache().getNode();\n        viewMergeTree.children.inorderTraversal(function (childKey, childTree) {\n            if (serverNode.hasChild(childKey)) {\n                var serverChild = viewCache\n                    .getServerCache()\n                    .getNode()\n                    .getImmediateChild(childKey);\n                var newChild = _this.applyMerge_(serverChild, childTree);\n                curViewCache = _this.applyServerOverwrite_(curViewCache, new Path_1.Path(childKey), newChild, writesCache, serverCache, filterServerNode, accumulator);\n            }\n        });\n        viewMergeTree.children.inorderTraversal(function (childKey, childMergeTree) {\n            var isUnknownDeepMerge = !viewCache.getServerCache().isCompleteForChild(childKey) &&\n                childMergeTree.value == null;\n            if (!serverNode.hasChild(childKey) && !isUnknownDeepMerge) {\n                var serverChild = viewCache\n                    .getServerCache()\n                    .getNode()\n                    .getImmediateChild(childKey);\n                var newChild = _this.applyMerge_(serverChild, childMergeTree);\n                curViewCache = _this.applyServerOverwrite_(curViewCache, new Path_1.Path(childKey), newChild, writesCache, serverCache, filterServerNode, accumulator);\n            }\n        });\n        return curViewCache;\n    };\n    /**\n     * @param {!ViewCache} viewCache\n     * @param {!Path} ackPath\n     * @param {!ImmutableTree<!boolean>} affectedTree\n     * @param {!WriteTreeRef} writesCache\n     * @param {?Node} completeCache\n     * @param {!ChildChangeAccumulator} accumulator\n     * @return {!ViewCache}\n     * @private\n     */\n    ViewProcessor.prototype.ackUserWrite_ = function (viewCache, ackPath, affectedTree, writesCache, completeCache, accumulator) {\n        if (writesCache.shadowingWrite(ackPath) != null) {\n            return viewCache;\n        }\n        // Only filter server node if it is currently filtered\n        var filterServerNode = viewCache.getServerCache().isFiltered();\n        // Essentially we'll just get our existing server cache for the affected paths and re-apply it as a server update\n        // now that it won't be shadowed.\n        var serverCache = viewCache.getServerCache();\n        if (affectedTree.value != null) {\n            // This is an overwrite.\n            if ((ackPath.isEmpty() && serverCache.isFullyInitialized()) ||\n                serverCache.isCompleteForPath(ackPath)) {\n                return this.applyServerOverwrite_(viewCache, ackPath, serverCache.getNode().getChild(ackPath), writesCache, completeCache, filterServerNode, accumulator);\n            }\n            else if (ackPath.isEmpty()) {\n                // This is a goofy edge case where we are acking data at this location but don't have full data.  We\n                // should just re-apply whatever we have in our cache as a merge.\n                var changedChildren_1 = ImmutableTree_1.ImmutableTree.Empty;\n                serverCache.getNode().forEachChild(KeyIndex_1.KEY_INDEX, function (name, node) {\n                    changedChildren_1 = changedChildren_1.set(new Path_1.Path(name), node);\n                });\n                return this.applyServerMerge_(viewCache, ackPath, changedChildren_1, writesCache, completeCache, filterServerNode, accumulator);\n            }\n            else {\n                return viewCache;\n            }\n        }\n        else {\n            // This is a merge.\n            var changedChildren_2 = ImmutableTree_1.ImmutableTree.Empty;\n            affectedTree.foreach(function (mergePath, value) {\n                var serverCachePath = ackPath.child(mergePath);\n                if (serverCache.isCompleteForPath(serverCachePath)) {\n                    changedChildren_2 = changedChildren_2.set(mergePath, serverCache.getNode().getChild(serverCachePath));\n                }\n            });\n            return this.applyServerMerge_(viewCache, ackPath, changedChildren_2, writesCache, completeCache, filterServerNode, accumulator);\n        }\n    };\n    /**\n     * @param {!ViewCache} viewCache\n     * @param {!Path} path\n     * @param {!WriteTreeRef} writesCache\n     * @param {!ChildChangeAccumulator} accumulator\n     * @return {!ViewCache}\n     * @private\n     */\n    ViewProcessor.prototype.listenComplete_ = function (viewCache, path, writesCache, accumulator) {\n        var oldServerNode = viewCache.getServerCache();\n        var newViewCache = viewCache.updateServerSnap(oldServerNode.getNode(), oldServerNode.isFullyInitialized() || path.isEmpty(), oldServerNode.isFiltered());\n        return this.generateEventCacheAfterServerEvent_(newViewCache, path, writesCache, CompleteChildSource_1.NO_COMPLETE_CHILD_SOURCE, accumulator);\n    };\n    /**\n     * @param {!ViewCache} viewCache\n     * @param {!Path} path\n     * @param {!WriteTreeRef} writesCache\n     * @param {?Node} completeServerCache\n     * @param {!ChildChangeAccumulator} accumulator\n     * @return {!ViewCache}\n     * @private\n     */\n    ViewProcessor.prototype.revertUserWrite_ = function (viewCache, path, writesCache, completeServerCache, accumulator) {\n        var complete;\n        if (writesCache.shadowingWrite(path) != null) {\n            return viewCache;\n        }\n        else {\n            var source = new CompleteChildSource_1.WriteTreeCompleteChildSource(writesCache, viewCache, completeServerCache);\n            var oldEventCache = viewCache.getEventCache().getNode();\n            var newEventCache = void 0;\n            if (path.isEmpty() || path.getFront() === '.priority') {\n                var newNode = void 0;\n                if (viewCache.getServerCache().isFullyInitialized()) {\n                    newNode = writesCache.calcCompleteEventCache(viewCache.getCompleteServerSnap());\n                }\n                else {\n                    var serverChildren = viewCache.getServerCache().getNode();\n                    util_1.assert(serverChildren instanceof ChildrenNode_1.ChildrenNode, 'serverChildren would be complete if leaf node');\n                    newNode = writesCache.calcCompleteEventChildren(serverChildren);\n                }\n                newNode = newNode;\n                newEventCache = this.filter_.updateFullNode(oldEventCache, newNode, accumulator);\n            }\n            else {\n                var childKey = path.getFront();\n                var newChild = writesCache.calcCompleteChild(childKey, viewCache.getServerCache());\n                if (newChild == null &&\n                    viewCache.getServerCache().isCompleteForChild(childKey)) {\n                    newChild = oldEventCache.getImmediateChild(childKey);\n                }\n                if (newChild != null) {\n                    newEventCache = this.filter_.updateChild(oldEventCache, childKey, newChild, path.popFront(), source, accumulator);\n                }\n                else if (viewCache\n                    .getEventCache()\n                    .getNode()\n                    .hasChild(childKey)) {\n                    // No complete child available, delete the existing one, if any\n                    newEventCache = this.filter_.updateChild(oldEventCache, childKey, ChildrenNode_1.ChildrenNode.EMPTY_NODE, path.popFront(), source, accumulator);\n                }\n                else {\n                    newEventCache = oldEventCache;\n                }\n                if (newEventCache.isEmpty() &&\n                    viewCache.getServerCache().isFullyInitialized()) {\n                    // We might have reverted all child writes. Maybe the old event was a leaf node\n                    complete = writesCache.calcCompleteEventCache(viewCache.getCompleteServerSnap());\n                    if (complete.isLeafNode()) {\n                        newEventCache = this.filter_.updateFullNode(newEventCache, complete, accumulator);\n                    }\n                }\n            }\n            complete =\n                viewCache.getServerCache().isFullyInitialized() ||\n                    writesCache.shadowingWrite(Path_1.Path.Empty) != null;\n            return viewCache.updateEventSnap(newEventCache, complete, this.filter_.filtersNodes());\n        }\n    };\n    return ViewProcessor;\n}());\nexports.ViewProcessor = ViewProcessor;\n\n\n\n},{\"../operation/Operation\":30,\"../snap/ChildrenNode\":32,\"../snap/indexes/KeyIndex\":39,\"../util/ImmutableTree\":54,\"../util/Path\":57,\"./Change\":66,\"./ChildChangeAccumulator\":67,\"./CompleteChildSource\":68,\"@firebase/util\":134}],77:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\nvar Change_1 = require(\"../Change\");\nvar ChildrenNode_1 = require(\"../../snap/ChildrenNode\");\nvar PriorityIndex_1 = require(\"../../snap/indexes/PriorityIndex\");\n/**\n * Doesn't really filter nodes but applies an index to the node and keeps track of any changes\n *\n * @constructor\n * @implements {NodeFilter}\n * @param {!Index} index\n */\nvar IndexedFilter = /** @class */ (function () {\n    function IndexedFilter(index_) {\n        this.index_ = index_;\n    }\n    IndexedFilter.prototype.updateChild = function (snap, key, newChild, affectedPath, source, optChangeAccumulator) {\n        util_1.assert(snap.isIndexed(this.index_), 'A node must be indexed if only a child is updated');\n        var oldChild = snap.getImmediateChild(key);\n        // Check if anything actually changed.\n        if (oldChild.getChild(affectedPath).equals(newChild.getChild(affectedPath))) {\n            // There's an edge case where a child can enter or leave the view because affectedPath was set to null.\n            // In this case, affectedPath will appear null in both the old and new snapshots.  So we need\n            // to avoid treating these cases as \"nothing changed.\"\n            if (oldChild.isEmpty() == newChild.isEmpty()) {\n                // Nothing changed.\n                // This assert should be valid, but it's expensive (can dominate perf testing) so don't actually do it.\n                //assert(oldChild.equals(newChild), 'Old and new snapshots should be equal.');\n                return snap;\n            }\n        }\n        if (optChangeAccumulator != null) {\n            if (newChild.isEmpty()) {\n                if (snap.hasChild(key)) {\n                    optChangeAccumulator.trackChildChange(Change_1.Change.childRemovedChange(key, oldChild));\n                }\n                else {\n                    util_1.assert(snap.isLeafNode(), 'A child remove without an old child only makes sense on a leaf node');\n                }\n            }\n            else if (oldChild.isEmpty()) {\n                optChangeAccumulator.trackChildChange(Change_1.Change.childAddedChange(key, newChild));\n            }\n            else {\n                optChangeAccumulator.trackChildChange(Change_1.Change.childChangedChange(key, newChild, oldChild));\n            }\n        }\n        if (snap.isLeafNode() && newChild.isEmpty()) {\n            return snap;\n        }\n        else {\n            // Make sure the node is indexed\n            return snap.updateImmediateChild(key, newChild).withIndex(this.index_);\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    IndexedFilter.prototype.updateFullNode = function (oldSnap, newSnap, optChangeAccumulator) {\n        if (optChangeAccumulator != null) {\n            if (!oldSnap.isLeafNode()) {\n                oldSnap.forEachChild(PriorityIndex_1.PRIORITY_INDEX, function (key, childNode) {\n                    if (!newSnap.hasChild(key)) {\n                        optChangeAccumulator.trackChildChange(Change_1.Change.childRemovedChange(key, childNode));\n                    }\n                });\n            }\n            if (!newSnap.isLeafNode()) {\n                newSnap.forEachChild(PriorityIndex_1.PRIORITY_INDEX, function (key, childNode) {\n                    if (oldSnap.hasChild(key)) {\n                        var oldChild = oldSnap.getImmediateChild(key);\n                        if (!oldChild.equals(childNode)) {\n                            optChangeAccumulator.trackChildChange(Change_1.Change.childChangedChange(key, childNode, oldChild));\n                        }\n                    }\n                    else {\n                        optChangeAccumulator.trackChildChange(Change_1.Change.childAddedChange(key, childNode));\n                    }\n                });\n            }\n        }\n        return newSnap.withIndex(this.index_);\n    };\n    /**\n     * @inheritDoc\n     */\n    IndexedFilter.prototype.updatePriority = function (oldSnap, newPriority) {\n        if (oldSnap.isEmpty()) {\n            return ChildrenNode_1.ChildrenNode.EMPTY_NODE;\n        }\n        else {\n            return oldSnap.updatePriority(newPriority);\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    IndexedFilter.prototype.filtersNodes = function () {\n        return false;\n    };\n    /**\n     * @inheritDoc\n     */\n    IndexedFilter.prototype.getIndexedFilter = function () {\n        return this;\n    };\n    /**\n     * @inheritDoc\n     */\n    IndexedFilter.prototype.getIndex = function () {\n        return this.index_;\n    };\n    return IndexedFilter;\n}());\nexports.IndexedFilter = IndexedFilter;\n\n\n\n},{\"../../snap/ChildrenNode\":32,\"../../snap/indexes/PriorityIndex\":41,\"../Change\":66,\"@firebase/util\":134}],78:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar RangedFilter_1 = require(\"./RangedFilter\");\nvar ChildrenNode_1 = require(\"../../snap/ChildrenNode\");\nvar Node_1 = require(\"../../snap/Node\");\nvar util_1 = require(\"@firebase/util\");\nvar Change_1 = require(\"../Change\");\n/**\n * Applies a limit and a range to a node and uses RangedFilter to do the heavy lifting where possible\n *\n * @constructor\n * @implements {NodeFilter}\n */\nvar LimitedFilter = /** @class */ (function () {\n    /**\n     * @param {!QueryParams} params\n     */\n    function LimitedFilter(params) {\n        this.rangedFilter_ = new RangedFilter_1.RangedFilter(params);\n        this.index_ = params.getIndex();\n        this.limit_ = params.getLimit();\n        this.reverse_ = !params.isViewFromLeft();\n    }\n    /**\n     * @inheritDoc\n     */\n    LimitedFilter.prototype.updateChild = function (snap, key, newChild, affectedPath, source, optChangeAccumulator) {\n        if (!this.rangedFilter_.matches(new Node_1.NamedNode(key, newChild))) {\n            newChild = ChildrenNode_1.ChildrenNode.EMPTY_NODE;\n        }\n        if (snap.getImmediateChild(key).equals(newChild)) {\n            // No change\n            return snap;\n        }\n        else if (snap.numChildren() < this.limit_) {\n            return this.rangedFilter_\n                .getIndexedFilter()\n                .updateChild(snap, key, newChild, affectedPath, source, optChangeAccumulator);\n        }\n        else {\n            return this.fullLimitUpdateChild_(snap, key, newChild, source, optChangeAccumulator);\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    LimitedFilter.prototype.updateFullNode = function (oldSnap, newSnap, optChangeAccumulator) {\n        var filtered;\n        if (newSnap.isLeafNode() || newSnap.isEmpty()) {\n            // Make sure we have a children node with the correct index, not a leaf node;\n            filtered = ChildrenNode_1.ChildrenNode.EMPTY_NODE.withIndex(this.index_);\n        }\n        else {\n            if (this.limit_ * 2 < newSnap.numChildren() &&\n                newSnap.isIndexed(this.index_)) {\n                // Easier to build up a snapshot, since what we're given has more than twice the elements we want\n                filtered = ChildrenNode_1.ChildrenNode.EMPTY_NODE.withIndex(this.index_);\n                // anchor to the startPost, endPost, or last element as appropriate\n                var iterator = void 0;\n                if (this.reverse_) {\n                    iterator = newSnap.getReverseIteratorFrom(this.rangedFilter_.getEndPost(), this.index_);\n                }\n                else {\n                    iterator = newSnap.getIteratorFrom(this.rangedFilter_.getStartPost(), this.index_);\n                }\n                var count = 0;\n                while (iterator.hasNext() && count < this.limit_) {\n                    var next = iterator.getNext();\n                    var inRange = void 0;\n                    if (this.reverse_) {\n                        inRange =\n                            this.index_.compare(this.rangedFilter_.getStartPost(), next) <= 0;\n                    }\n                    else {\n                        inRange =\n                            this.index_.compare(next, this.rangedFilter_.getEndPost()) <= 0;\n                    }\n                    if (inRange) {\n                        filtered = filtered.updateImmediateChild(next.name, next.node);\n                        count++;\n                    }\n                    else {\n                        // if we have reached the end post, we cannot keep adding elemments\n                        break;\n                    }\n                }\n            }\n            else {\n                // The snap contains less than twice the limit. Faster to delete from the snap than build up a new one\n                filtered = newSnap.withIndex(this.index_);\n                // Don't support priorities on queries\n                filtered = filtered.updatePriority(ChildrenNode_1.ChildrenNode.EMPTY_NODE);\n                var startPost = void 0;\n                var endPost = void 0;\n                var cmp = void 0;\n                var iterator = void 0;\n                if (this.reverse_) {\n                    iterator = filtered.getReverseIterator(this.index_);\n                    startPost = this.rangedFilter_.getEndPost();\n                    endPost = this.rangedFilter_.getStartPost();\n                    var indexCompare_1 = this.index_.getCompare();\n                    cmp = function (a, b) { return indexCompare_1(b, a); };\n                }\n                else {\n                    iterator = filtered.getIterator(this.index_);\n                    startPost = this.rangedFilter_.getStartPost();\n                    endPost = this.rangedFilter_.getEndPost();\n                    cmp = this.index_.getCompare();\n                }\n                var count = 0;\n                var foundStartPost = false;\n                while (iterator.hasNext()) {\n                    var next = iterator.getNext();\n                    if (!foundStartPost && cmp(startPost, next) <= 0) {\n                        // start adding\n                        foundStartPost = true;\n                    }\n                    var inRange = foundStartPost && count < this.limit_ && cmp(next, endPost) <= 0;\n                    if (inRange) {\n                        count++;\n                    }\n                    else {\n                        filtered = filtered.updateImmediateChild(next.name, ChildrenNode_1.ChildrenNode.EMPTY_NODE);\n                    }\n                }\n            }\n        }\n        return this.rangedFilter_\n            .getIndexedFilter()\n            .updateFullNode(oldSnap, filtered, optChangeAccumulator);\n    };\n    /**\n     * @inheritDoc\n     */\n    LimitedFilter.prototype.updatePriority = function (oldSnap, newPriority) {\n        // Don't support priorities on queries\n        return oldSnap;\n    };\n    /**\n     * @inheritDoc\n     */\n    LimitedFilter.prototype.filtersNodes = function () {\n        return true;\n    };\n    /**\n     * @inheritDoc\n     */\n    LimitedFilter.prototype.getIndexedFilter = function () {\n        return this.rangedFilter_.getIndexedFilter();\n    };\n    /**\n     * @inheritDoc\n     */\n    LimitedFilter.prototype.getIndex = function () {\n        return this.index_;\n    };\n    /**\n     * @param {!Node} snap\n     * @param {string} childKey\n     * @param {!Node} childSnap\n     * @param {!CompleteChildSource} source\n     * @param {?ChildChangeAccumulator} changeAccumulator\n     * @return {!Node}\n     * @private\n     */\n    LimitedFilter.prototype.fullLimitUpdateChild_ = function (snap, childKey, childSnap, source, changeAccumulator) {\n        // TODO: rename all cache stuff etc to general snap terminology\n        var cmp;\n        if (this.reverse_) {\n            var indexCmp_1 = this.index_.getCompare();\n            cmp = function (a, b) { return indexCmp_1(b, a); };\n        }\n        else {\n            cmp = this.index_.getCompare();\n        }\n        var oldEventCache = snap;\n        util_1.assert(oldEventCache.numChildren() == this.limit_, '');\n        var newChildNamedNode = new Node_1.NamedNode(childKey, childSnap);\n        var windowBoundary = this.reverse_\n            ? oldEventCache.getFirstChild(this.index_)\n            : oldEventCache.getLastChild(this.index_);\n        var inRange = this.rangedFilter_.matches(newChildNamedNode);\n        if (oldEventCache.hasChild(childKey)) {\n            var oldChildSnap = oldEventCache.getImmediateChild(childKey);\n            var nextChild = source.getChildAfterChild(this.index_, windowBoundary, this.reverse_);\n            while (nextChild != null &&\n                (nextChild.name == childKey || oldEventCache.hasChild(nextChild.name))) {\n                // There is a weird edge case where a node is updated as part of a merge in the write tree, but hasn't\n                // been applied to the limited filter yet. Ignore this next child which will be updated later in\n                // the limited filter...\n                nextChild = source.getChildAfterChild(this.index_, nextChild, this.reverse_);\n            }\n            var compareNext = nextChild == null ? 1 : cmp(nextChild, newChildNamedNode);\n            var remainsInWindow = inRange && !childSnap.isEmpty() && compareNext >= 0;\n            if (remainsInWindow) {\n                if (changeAccumulator != null) {\n                    changeAccumulator.trackChildChange(Change_1.Change.childChangedChange(childKey, childSnap, oldChildSnap));\n                }\n                return oldEventCache.updateImmediateChild(childKey, childSnap);\n            }\n            else {\n                if (changeAccumulator != null) {\n                    changeAccumulator.trackChildChange(Change_1.Change.childRemovedChange(childKey, oldChildSnap));\n                }\n                var newEventCache = oldEventCache.updateImmediateChild(childKey, ChildrenNode_1.ChildrenNode.EMPTY_NODE);\n                var nextChildInRange = nextChild != null && this.rangedFilter_.matches(nextChild);\n                if (nextChildInRange) {\n                    if (changeAccumulator != null) {\n                        changeAccumulator.trackChildChange(Change_1.Change.childAddedChange(nextChild.name, nextChild.node));\n                    }\n                    return newEventCache.updateImmediateChild(nextChild.name, nextChild.node);\n                }\n                else {\n                    return newEventCache;\n                }\n            }\n        }\n        else if (childSnap.isEmpty()) {\n            // we're deleting a node, but it was not in the window, so ignore it\n            return snap;\n        }\n        else if (inRange) {\n            if (cmp(windowBoundary, newChildNamedNode) >= 0) {\n                if (changeAccumulator != null) {\n                    changeAccumulator.trackChildChange(Change_1.Change.childRemovedChange(windowBoundary.name, windowBoundary.node));\n                    changeAccumulator.trackChildChange(Change_1.Change.childAddedChange(childKey, childSnap));\n                }\n                return oldEventCache\n                    .updateImmediateChild(childKey, childSnap)\n                    .updateImmediateChild(windowBoundary.name, ChildrenNode_1.ChildrenNode.EMPTY_NODE);\n            }\n            else {\n                return snap;\n            }\n        }\n        else {\n            return snap;\n        }\n    };\n    return LimitedFilter;\n}());\nexports.LimitedFilter = LimitedFilter;\n\n\n\n},{\"../../snap/ChildrenNode\":32,\"../../snap/Node\":35,\"../Change\":66,\"./RangedFilter\":79,\"@firebase/util\":134}],79:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar IndexedFilter_1 = require(\"./IndexedFilter\");\nvar PriorityIndex_1 = require(\"../../snap/indexes/PriorityIndex\");\nvar Node_1 = require(\"../../../core/snap/Node\");\nvar ChildrenNode_1 = require(\"../../snap/ChildrenNode\");\n/**\n * Filters nodes by range and uses an IndexFilter to track any changes after filtering the node\n *\n * @constructor\n * @implements {NodeFilter}\n */\nvar RangedFilter = /** @class */ (function () {\n    /**\n     * @param {!QueryParams} params\n     */\n    function RangedFilter(params) {\n        this.indexedFilter_ = new IndexedFilter_1.IndexedFilter(params.getIndex());\n        this.index_ = params.getIndex();\n        this.startPost_ = RangedFilter.getStartPost_(params);\n        this.endPost_ = RangedFilter.getEndPost_(params);\n    }\n    /**\n     * @return {!NamedNode}\n     */\n    RangedFilter.prototype.getStartPost = function () {\n        return this.startPost_;\n    };\n    /**\n     * @return {!NamedNode}\n     */\n    RangedFilter.prototype.getEndPost = function () {\n        return this.endPost_;\n    };\n    /**\n     * @param {!NamedNode} node\n     * @return {boolean}\n     */\n    RangedFilter.prototype.matches = function (node) {\n        return (this.index_.compare(this.getStartPost(), node) <= 0 &&\n            this.index_.compare(node, this.getEndPost()) <= 0);\n    };\n    /**\n     * @inheritDoc\n     */\n    RangedFilter.prototype.updateChild = function (snap, key, newChild, affectedPath, source, optChangeAccumulator) {\n        if (!this.matches(new Node_1.NamedNode(key, newChild))) {\n            newChild = ChildrenNode_1.ChildrenNode.EMPTY_NODE;\n        }\n        return this.indexedFilter_.updateChild(snap, key, newChild, affectedPath, source, optChangeAccumulator);\n    };\n    /**\n     * @inheritDoc\n     */\n    RangedFilter.prototype.updateFullNode = function (oldSnap, newSnap, optChangeAccumulator) {\n        if (newSnap.isLeafNode()) {\n            // Make sure we have a children node with the correct index, not a leaf node;\n            newSnap = ChildrenNode_1.ChildrenNode.EMPTY_NODE;\n        }\n        var filtered = newSnap.withIndex(this.index_);\n        // Don't support priorities on queries\n        filtered = filtered.updatePriority(ChildrenNode_1.ChildrenNode.EMPTY_NODE);\n        var self = this;\n        newSnap.forEachChild(PriorityIndex_1.PRIORITY_INDEX, function (key, childNode) {\n            if (!self.matches(new Node_1.NamedNode(key, childNode))) {\n                filtered = filtered.updateImmediateChild(key, ChildrenNode_1.ChildrenNode.EMPTY_NODE);\n            }\n        });\n        return this.indexedFilter_.updateFullNode(oldSnap, filtered, optChangeAccumulator);\n    };\n    /**\n     * @inheritDoc\n     */\n    RangedFilter.prototype.updatePriority = function (oldSnap, newPriority) {\n        // Don't support priorities on queries\n        return oldSnap;\n    };\n    /**\n     * @inheritDoc\n     */\n    RangedFilter.prototype.filtersNodes = function () {\n        return true;\n    };\n    /**\n     * @inheritDoc\n     */\n    RangedFilter.prototype.getIndexedFilter = function () {\n        return this.indexedFilter_;\n    };\n    /**\n     * @inheritDoc\n     */\n    RangedFilter.prototype.getIndex = function () {\n        return this.index_;\n    };\n    /**\n     * @param {!QueryParams} params\n     * @return {!NamedNode}\n     * @private\n     */\n    RangedFilter.getStartPost_ = function (params) {\n        if (params.hasStart()) {\n            var startName = params.getIndexStartName();\n            return params.getIndex().makePost(params.getIndexStartValue(), startName);\n        }\n        else {\n            return params.getIndex().minPost();\n        }\n    };\n    /**\n     * @param {!QueryParams} params\n     * @return {!NamedNode}\n     * @private\n     */\n    RangedFilter.getEndPost_ = function (params) {\n        if (params.hasEnd()) {\n            var endName = params.getIndexEndName();\n            return params.getIndex().makePost(params.getIndexEndValue(), endName);\n        }\n        else {\n            return params.getIndex().maxPost();\n        }\n    };\n    return RangedFilter;\n}());\nexports.RangedFilter = RangedFilter;\n\n\n\n},{\"../../../core/snap/Node\":35,\"../../snap/ChildrenNode\":32,\"../../snap/indexes/PriorityIndex\":41,\"./IndexedFilter\":77}],80:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"../core/util/util\");\nvar CountedSet_1 = require(\"../core/util/CountedSet\");\nvar StatsManager_1 = require(\"../core/stats/StatsManager\");\nvar PacketReceiver_1 = require(\"./polling/PacketReceiver\");\nvar Constants_1 = require(\"./Constants\");\nvar util_2 = require(\"@firebase/util\");\nvar util_3 = require(\"@firebase/util\");\n// URL query parameters associated with longpolling\nexports.FIREBASE_LONGPOLL_START_PARAM = 'start';\nexports.FIREBASE_LONGPOLL_CLOSE_COMMAND = 'close';\nexports.FIREBASE_LONGPOLL_COMMAND_CB_NAME = 'pLPCommand';\nexports.FIREBASE_LONGPOLL_DATA_CB_NAME = 'pRTLPCB';\nexports.FIREBASE_LONGPOLL_ID_PARAM = 'id';\nexports.FIREBASE_LONGPOLL_PW_PARAM = 'pw';\nexports.FIREBASE_LONGPOLL_SERIAL_PARAM = 'ser';\nexports.FIREBASE_LONGPOLL_CALLBACK_ID_PARAM = 'cb';\nexports.FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM = 'seg';\nexports.FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET = 'ts';\nexports.FIREBASE_LONGPOLL_DATA_PARAM = 'd';\nexports.FIREBASE_LONGPOLL_DISCONN_FRAME_PARAM = 'disconn';\nexports.FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM = 'dframe';\n//Data size constants.\n//TODO: Perf: the maximum length actually differs from browser to browser.\n// We should check what browser we're on and set accordingly.\nvar MAX_URL_DATA_SIZE = 1870;\nvar SEG_HEADER_SIZE = 30; //ie: &seg=8299234&ts=982389123&d=\nvar MAX_PAYLOAD_SIZE = MAX_URL_DATA_SIZE - SEG_HEADER_SIZE;\n/**\n * Keepalive period\n * send a fresh request at minimum every 25 seconds. Opera has a maximum request\n * length of 30 seconds that we can't exceed.\n * @const\n * @type {number}\n */\nvar KEEPALIVE_REQUEST_INTERVAL = 25000;\n/**\n * How long to wait before aborting a long-polling connection attempt.\n * @const\n * @type {number}\n */\nvar LP_CONNECT_TIMEOUT = 30000;\n/**\n * This class manages a single long-polling connection.\n *\n * @constructor\n * @implements {Transport}\n */\nvar BrowserPollConnection = /** @class */ (function () {\n    /**\n     * @param {string} connId An identifier for this connection, used for logging\n     * @param {RepoInfo} repoInfo The info for the endpoint to send data to.\n     * @param {string=} transportSessionId Optional transportSessionid if we are reconnecting for an existing\n     *                                         transport session\n     * @param {string=}  lastSessionId Optional lastSessionId if the PersistentConnection has already created a\n     *                                     connection previously\n     */\n    function BrowserPollConnection(connId, repoInfo, transportSessionId, lastSessionId) {\n        this.connId = connId;\n        this.repoInfo = repoInfo;\n        this.transportSessionId = transportSessionId;\n        this.lastSessionId = lastSessionId;\n        this.bytesSent = 0;\n        this.bytesReceived = 0;\n        this.everConnected_ = false;\n        this.log_ = util_1.logWrapper(connId);\n        this.stats_ = StatsManager_1.StatsManager.getCollection(repoInfo);\n        this.urlFn = function (params) {\n            return repoInfo.connectionURL(Constants_1.LONG_POLLING, params);\n        };\n    }\n    /**\n     *\n     * @param {function(Object)} onMessage Callback when messages arrive\n     * @param {function()} onDisconnect Callback with connection lost.\n     */\n    BrowserPollConnection.prototype.open = function (onMessage, onDisconnect) {\n        var _this = this;\n        this.curSegmentNum = 0;\n        this.onDisconnect_ = onDisconnect;\n        this.myPacketOrderer = new PacketReceiver_1.PacketReceiver(onMessage);\n        this.isClosed_ = false;\n        this.connectTimeoutTimer_ = setTimeout(function () {\n            _this.log_('Timed out trying to connect.');\n            // Make sure we clear the host cache\n            _this.onClosed_();\n            _this.connectTimeoutTimer_ = null;\n        }, Math.floor(LP_CONNECT_TIMEOUT));\n        // Ensure we delay the creation of the iframe until the DOM is loaded.\n        util_1.executeWhenDOMReady(function () {\n            if (_this.isClosed_)\n                return;\n            //Set up a callback that gets triggered once a connection is set up.\n            _this.scriptTagHolder = new FirebaseIFrameScriptHolder(function () {\n                var args = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    args[_i] = arguments[_i];\n                }\n                var command = args[0], arg1 = args[1], arg2 = args[2], arg3 = args[3], arg4 = args[4];\n                _this.incrementIncomingBytes_(args);\n                if (!_this.scriptTagHolder)\n                    return; // we closed the connection.\n                if (_this.connectTimeoutTimer_) {\n                    clearTimeout(_this.connectTimeoutTimer_);\n                    _this.connectTimeoutTimer_ = null;\n                }\n                _this.everConnected_ = true;\n                if (command == exports.FIREBASE_LONGPOLL_START_PARAM) {\n                    _this.id = arg1;\n                    _this.password = arg2;\n                }\n                else if (command === exports.FIREBASE_LONGPOLL_CLOSE_COMMAND) {\n                    // Don't clear the host cache. We got a response from the server, so we know it's reachable\n                    if (arg1) {\n                        // We aren't expecting any more data (other than what the server's already in the process of sending us\n                        // through our already open polls), so don't send any more.\n                        _this.scriptTagHolder.sendNewPolls = false;\n                        // arg1 in this case is the last response number sent by the server. We should try to receive\n                        // all of the responses up to this one before closing\n                        _this.myPacketOrderer.closeAfter(arg1, function () {\n                            _this.onClosed_();\n                        });\n                    }\n                    else {\n                        _this.onClosed_();\n                    }\n                }\n                else {\n                    throw new Error('Unrecognized command received: ' + command);\n                }\n            }, function () {\n                var args = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    args[_i] = arguments[_i];\n                }\n                var pN = args[0], data = args[1];\n                _this.incrementIncomingBytes_(args);\n                _this.myPacketOrderer.handleResponse(pN, data);\n            }, function () {\n                _this.onClosed_();\n            }, _this.urlFn);\n            //Send the initial request to connect. The serial number is simply to keep the browser from pulling previous results\n            //from cache.\n            var urlParams = {};\n            urlParams[exports.FIREBASE_LONGPOLL_START_PARAM] = 't';\n            urlParams[exports.FIREBASE_LONGPOLL_SERIAL_PARAM] = Math.floor(Math.random() * 100000000);\n            if (_this.scriptTagHolder.uniqueCallbackIdentifier)\n                urlParams[exports.FIREBASE_LONGPOLL_CALLBACK_ID_PARAM] = _this.scriptTagHolder.uniqueCallbackIdentifier;\n            urlParams[Constants_1.VERSION_PARAM] = Constants_1.PROTOCOL_VERSION;\n            if (_this.transportSessionId) {\n                urlParams[Constants_1.TRANSPORT_SESSION_PARAM] = _this.transportSessionId;\n            }\n            if (_this.lastSessionId) {\n                urlParams[Constants_1.LAST_SESSION_PARAM] = _this.lastSessionId;\n            }\n            if (!util_3.isNodeSdk() &&\n                typeof location !== 'undefined' &&\n                location.href &&\n                location.href.indexOf(Constants_1.FORGE_DOMAIN) !== -1) {\n                urlParams[Constants_1.REFERER_PARAM] = Constants_1.FORGE_REF;\n            }\n            var connectURL = _this.urlFn(urlParams);\n            _this.log_('Connecting via long-poll to ' + connectURL);\n            _this.scriptTagHolder.addTag(connectURL, function () {\n                /* do nothing */\n            });\n        });\n    };\n    /**\n     * Call this when a handshake has completed successfully and we want to consider the connection established\n     */\n    BrowserPollConnection.prototype.start = function () {\n        this.scriptTagHolder.startLongPoll(this.id, this.password);\n        this.addDisconnectPingFrame(this.id, this.password);\n    };\n    /**\n     * Forces long polling to be considered as a potential transport\n     */\n    BrowserPollConnection.forceAllow = function () {\n        BrowserPollConnection.forceAllow_ = true;\n    };\n    /**\n     * Forces longpolling to not be considered as a potential transport\n     */\n    BrowserPollConnection.forceDisallow = function () {\n        BrowserPollConnection.forceDisallow_ = true;\n    };\n    // Static method, use string literal so it can be accessed in a generic way\n    BrowserPollConnection.isAvailable = function () {\n        // NOTE: In React-Native there's normally no 'document', but if you debug a React-Native app in\n        // the Chrome debugger, 'document' is defined, but document.createElement is null (2015/06/08).\n        return (BrowserPollConnection.forceAllow_ ||\n            (!BrowserPollConnection.forceDisallow_ &&\n                typeof document !== 'undefined' &&\n                document.createElement != null &&\n                !util_1.isChromeExtensionContentScript() &&\n                !util_1.isWindowsStoreApp() &&\n                !util_3.isNodeSdk()));\n    };\n    /**\n     * No-op for polling\n     */\n    BrowserPollConnection.prototype.markConnectionHealthy = function () { };\n    /**\n     * Stops polling and cleans up the iframe\n     * @private\n     */\n    BrowserPollConnection.prototype.shutdown_ = function () {\n        this.isClosed_ = true;\n        if (this.scriptTagHolder) {\n            this.scriptTagHolder.close();\n            this.scriptTagHolder = null;\n        }\n        //remove the disconnect frame, which will trigger an XHR call to the server to tell it we're leaving.\n        if (this.myDisconnFrame) {\n            document.body.removeChild(this.myDisconnFrame);\n            this.myDisconnFrame = null;\n        }\n        if (this.connectTimeoutTimer_) {\n            clearTimeout(this.connectTimeoutTimer_);\n            this.connectTimeoutTimer_ = null;\n        }\n    };\n    /**\n     * Triggered when this transport is closed\n     * @private\n     */\n    BrowserPollConnection.prototype.onClosed_ = function () {\n        if (!this.isClosed_) {\n            this.log_('Longpoll is closing itself');\n            this.shutdown_();\n            if (this.onDisconnect_) {\n                this.onDisconnect_(this.everConnected_);\n                this.onDisconnect_ = null;\n            }\n        }\n    };\n    /**\n     * External-facing close handler. RealTime has requested we shut down. Kill our connection and tell the server\n     * that we've left.\n     */\n    BrowserPollConnection.prototype.close = function () {\n        if (!this.isClosed_) {\n            this.log_('Longpoll is being closed.');\n            this.shutdown_();\n        }\n    };\n    /**\n     * Send the JSON object down to the server. It will need to be stringified, base64 encoded, and then\n     * broken into chunks (since URLs have a small maximum length).\n     * @param {!Object} data The JSON data to transmit.\n     */\n    BrowserPollConnection.prototype.send = function (data) {\n        var dataStr = util_2.stringify(data);\n        this.bytesSent += dataStr.length;\n        this.stats_.incrementCounter('bytes_sent', dataStr.length);\n        //first, lets get the base64-encoded data\n        var base64data = util_2.base64Encode(dataStr);\n        //We can only fit a certain amount in each URL, so we need to split this request\n        //up into multiple pieces if it doesn't fit in one request.\n        var dataSegs = util_1.splitStringBySize(base64data, MAX_PAYLOAD_SIZE);\n        //Enqueue each segment for transmission. We assign each chunk a sequential ID and a total number\n        //of segments so that we can reassemble the packet on the server.\n        for (var i = 0; i < dataSegs.length; i++) {\n            this.scriptTagHolder.enqueueSegment(this.curSegmentNum, dataSegs.length, dataSegs[i]);\n            this.curSegmentNum++;\n        }\n    };\n    /**\n     * This is how we notify the server that we're leaving.\n     * We aren't able to send requests with DHTML on a window close event, but we can\n     * trigger XHR requests in some browsers (everything but Opera basically).\n     * @param {!string} id\n     * @param {!string} pw\n     */\n    BrowserPollConnection.prototype.addDisconnectPingFrame = function (id, pw) {\n        if (util_3.isNodeSdk())\n            return;\n        this.myDisconnFrame = document.createElement('iframe');\n        var urlParams = {};\n        urlParams[exports.FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM] = 't';\n        urlParams[exports.FIREBASE_LONGPOLL_ID_PARAM] = id;\n        urlParams[exports.FIREBASE_LONGPOLL_PW_PARAM] = pw;\n        this.myDisconnFrame.src = this.urlFn(urlParams);\n        this.myDisconnFrame.style.display = 'none';\n        document.body.appendChild(this.myDisconnFrame);\n    };\n    /**\n     * Used to track the bytes received by this client\n     * @param {*} args\n     * @private\n     */\n    BrowserPollConnection.prototype.incrementIncomingBytes_ = function (args) {\n        // TODO: This is an annoying perf hit just to track the number of incoming bytes.  Maybe it should be opt-in.\n        var bytesReceived = util_2.stringify(args).length;\n        this.bytesReceived += bytesReceived;\n        this.stats_.incrementCounter('bytes_received', bytesReceived);\n    };\n    return BrowserPollConnection;\n}());\nexports.BrowserPollConnection = BrowserPollConnection;\n/*********************************************************************************************\n * A wrapper around an iframe that is used as a long-polling script holder.\n * @constructor\n *********************************************************************************************/\nvar FirebaseIFrameScriptHolder = /** @class */ (function () {\n    /**\n     * @param commandCB - The callback to be called when control commands are recevied from the server.\n     * @param onMessageCB - The callback to be triggered when responses arrive from the server.\n     * @param onDisconnect - The callback to be triggered when this tag holder is closed\n     * @param urlFn - A function that provides the URL of the endpoint to send data to.\n     */\n    function FirebaseIFrameScriptHolder(commandCB, onMessageCB, onDisconnect, urlFn) {\n        this.onDisconnect = onDisconnect;\n        this.urlFn = urlFn;\n        //We maintain a count of all of the outstanding requests, because if we have too many active at once it can cause\n        //problems in some browsers.\n        /**\n         * @type {CountedSet.<number, number>}\n         */\n        this.outstandingRequests = new CountedSet_1.CountedSet();\n        //A queue of the pending segments waiting for transmission to the server.\n        this.pendingSegs = [];\n        //A serial number. We use this for two things:\n        // 1) A way to ensure the browser doesn't cache responses to polls\n        // 2) A way to make the server aware when long-polls arrive in a different order than we started them. The\n        //    server needs to release both polls in this case or it will cause problems in Opera since Opera can only execute\n        //    JSONP code in the order it was added to the iframe.\n        this.currentSerial = Math.floor(Math.random() * 100000000);\n        // This gets set to false when we're \"closing down\" the connection (e.g. we're switching transports but there's still\n        // incoming data from the server that we're waiting for).\n        this.sendNewPolls = true;\n        if (!util_3.isNodeSdk()) {\n            //Each script holder registers a couple of uniquely named callbacks with the window. These are called from the\n            //iframes where we put the long-polling script tags. We have two callbacks:\n            //   1) Command Callback - Triggered for control issues, like starting a connection.\n            //   2) Message Callback - Triggered when new data arrives.\n            this.uniqueCallbackIdentifier = util_1.LUIDGenerator();\n            window[exports.FIREBASE_LONGPOLL_COMMAND_CB_NAME + this.uniqueCallbackIdentifier] = commandCB;\n            window[exports.FIREBASE_LONGPOLL_DATA_CB_NAME + this.uniqueCallbackIdentifier] = onMessageCB;\n            //Create an iframe for us to add script tags to.\n            this.myIFrame = FirebaseIFrameScriptHolder.createIFrame_();\n            // Set the iframe's contents.\n            var script = '';\n            // if we set a javascript url, it's IE and we need to set the document domain. The javascript url is sufficient\n            // for ie9, but ie8 needs to do it again in the document itself.\n            if (this.myIFrame.src &&\n                this.myIFrame.src.substr(0, 'javascript:'.length) === 'javascript:') {\n                var currentDomain = document.domain;\n                script = '<script>document.domain=\"' + currentDomain + '\";</script>';\n            }\n            var iframeContents = '<html><body>' + script + '</body></html>';\n            try {\n                this.myIFrame.doc.open();\n                this.myIFrame.doc.write(iframeContents);\n                this.myIFrame.doc.close();\n            }\n            catch (e) {\n                util_1.log('frame writing exception');\n                if (e.stack) {\n                    util_1.log(e.stack);\n                }\n                util_1.log(e);\n            }\n        }\n        else {\n            this.commandCB = commandCB;\n            this.onMessageCB = onMessageCB;\n        }\n    }\n    /**\n     * Each browser has its own funny way to handle iframes. Here we mush them all together into one object that I can\n     * actually use.\n     * @private\n     * @return {Element}\n     */\n    FirebaseIFrameScriptHolder.createIFrame_ = function () {\n        var iframe = document.createElement('iframe');\n        iframe.style.display = 'none';\n        // This is necessary in order to initialize the document inside the iframe\n        if (document.body) {\n            document.body.appendChild(iframe);\n            try {\n                // If document.domain has been modified in IE, this will throw an error, and we need to set the\n                // domain of the iframe's document manually. We can do this via a javascript: url as the src attribute\n                // Also note that we must do this *after* the iframe has been appended to the page. Otherwise it doesn't work.\n                var a = iframe.contentWindow.document;\n                if (!a) {\n                    // Apologies for the log-spam, I need to do something to keep closure from optimizing out the assignment above.\n                    util_1.log('No IE domain setting required');\n                }\n            }\n            catch (e) {\n                var domain = document.domain;\n                iframe.src =\n                    \"javascript:void((function(){document.open();document.domain='\" +\n                        domain +\n                        \"';document.close();})())\";\n            }\n        }\n        else {\n            // LongPollConnection attempts to delay initialization until the document is ready, so hopefully this\n            // never gets hit.\n            throw 'Document body has not initialized. Wait to initialize Firebase until after the document is ready.';\n        }\n        // Get the document of the iframe in a browser-specific way.\n        if (iframe.contentDocument) {\n            iframe.doc = iframe.contentDocument; // Firefox, Opera, Safari\n        }\n        else if (iframe.contentWindow) {\n            iframe.doc = iframe.contentWindow.document; // Internet Explorer\n        }\n        else if (iframe.document) {\n            iframe.doc = iframe.document; //others?\n        }\n        return iframe;\n    };\n    /**\n     * Cancel all outstanding queries and remove the frame.\n     */\n    FirebaseIFrameScriptHolder.prototype.close = function () {\n        var _this = this;\n        //Mark this iframe as dead, so no new requests are sent.\n        this.alive = false;\n        if (this.myIFrame) {\n            //We have to actually remove all of the html inside this iframe before removing it from the\n            //window, or IE will continue loading and executing the script tags we've already added, which\n            //can lead to some errors being thrown. Setting innerHTML seems to be the easiest way to do this.\n            this.myIFrame.doc.body.innerHTML = '';\n            setTimeout(function () {\n                if (_this.myIFrame !== null) {\n                    document.body.removeChild(_this.myIFrame);\n                    _this.myIFrame = null;\n                }\n            }, Math.floor(0));\n        }\n        if (util_3.isNodeSdk() && this.myID) {\n            var urlParams = {};\n            urlParams[exports.FIREBASE_LONGPOLL_DISCONN_FRAME_PARAM] = 't';\n            urlParams[exports.FIREBASE_LONGPOLL_ID_PARAM] = this.myID;\n            urlParams[exports.FIREBASE_LONGPOLL_PW_PARAM] = this.myPW;\n            var theURL = this.urlFn(urlParams);\n            FirebaseIFrameScriptHolder.nodeRestRequest(theURL);\n        }\n        // Protect from being called recursively.\n        var onDisconnect = this.onDisconnect;\n        if (onDisconnect) {\n            this.onDisconnect = null;\n            onDisconnect();\n        }\n    };\n    /**\n     * Actually start the long-polling session by adding the first script tag(s) to the iframe.\n     * @param {!string} id - The ID of this connection\n     * @param {!string} pw - The password for this connection\n     */\n    FirebaseIFrameScriptHolder.prototype.startLongPoll = function (id, pw) {\n        this.myID = id;\n        this.myPW = pw;\n        this.alive = true;\n        //send the initial request. If there are requests queued, make sure that we transmit as many as we are currently able to.\n        while (this.newRequest_()) { }\n    };\n    /**\n     * This is called any time someone might want a script tag to be added. It adds a script tag when there aren't\n     * too many outstanding requests and we are still alive.\n     *\n     * If there are outstanding packet segments to send, it sends one. If there aren't, it sends a long-poll anyways if\n     * needed.\n     */\n    FirebaseIFrameScriptHolder.prototype.newRequest_ = function () {\n        // We keep one outstanding request open all the time to receive data, but if we need to send data\n        // (pendingSegs.length > 0) then we create a new request to send the data.  The server will automatically\n        // close the old request.\n        if (this.alive &&\n            this.sendNewPolls &&\n            this.outstandingRequests.count() < (this.pendingSegs.length > 0 ? 2 : 1)) {\n            //construct our url\n            this.currentSerial++;\n            var urlParams = {};\n            urlParams[exports.FIREBASE_LONGPOLL_ID_PARAM] = this.myID;\n            urlParams[exports.FIREBASE_LONGPOLL_PW_PARAM] = this.myPW;\n            urlParams[exports.FIREBASE_LONGPOLL_SERIAL_PARAM] = this.currentSerial;\n            var theURL = this.urlFn(urlParams);\n            //Now add as much data as we can.\n            var curDataString = '';\n            var i = 0;\n            while (this.pendingSegs.length > 0) {\n                //first, lets see if the next segment will fit.\n                var nextSeg = this.pendingSegs[0];\n                if (nextSeg.d.length + SEG_HEADER_SIZE + curDataString.length <=\n                    MAX_URL_DATA_SIZE) {\n                    //great, the segment will fit. Lets append it.\n                    var theSeg = this.pendingSegs.shift();\n                    curDataString =\n                        curDataString +\n                            '&' +\n                            exports.FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM +\n                            i +\n                            '=' +\n                            theSeg.seg +\n                            '&' +\n                            exports.FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET +\n                            i +\n                            '=' +\n                            theSeg.ts +\n                            '&' +\n                            exports.FIREBASE_LONGPOLL_DATA_PARAM +\n                            i +\n                            '=' +\n                            theSeg.d;\n                    i++;\n                }\n                else {\n                    break;\n                }\n            }\n            theURL = theURL + curDataString;\n            this.addLongPollTag_(theURL, this.currentSerial);\n            return true;\n        }\n        else {\n            return false;\n        }\n    };\n    /**\n     * Queue a packet for transmission to the server.\n     * @param segnum - A sequential id for this packet segment used for reassembly\n     * @param totalsegs - The total number of segments in this packet\n     * @param data - The data for this segment.\n     */\n    FirebaseIFrameScriptHolder.prototype.enqueueSegment = function (segnum, totalsegs, data) {\n        //add this to the queue of segments to send.\n        this.pendingSegs.push({ seg: segnum, ts: totalsegs, d: data });\n        //send the data immediately if there isn't already data being transmitted, unless\n        //startLongPoll hasn't been called yet.\n        if (this.alive) {\n            this.newRequest_();\n        }\n    };\n    /**\n     * Add a script tag for a regular long-poll request.\n     * @param {!string} url - The URL of the script tag.\n     * @param {!number} serial - The serial number of the request.\n     * @private\n     */\n    FirebaseIFrameScriptHolder.prototype.addLongPollTag_ = function (url, serial) {\n        var _this = this;\n        //remember that we sent this request.\n        this.outstandingRequests.add(serial, 1);\n        var doNewRequest = function () {\n            _this.outstandingRequests.remove(serial);\n            _this.newRequest_();\n        };\n        // If this request doesn't return on its own accord (by the server sending us some data), we'll\n        // create a new one after the KEEPALIVE interval to make sure we always keep a fresh request open.\n        var keepaliveTimeout = setTimeout(doNewRequest, Math.floor(KEEPALIVE_REQUEST_INTERVAL));\n        var readyStateCB = function () {\n            // Request completed.  Cancel the keepalive.\n            clearTimeout(keepaliveTimeout);\n            // Trigger a new request so we can continue receiving data.\n            doNewRequest();\n        };\n        this.addTag(url, readyStateCB);\n    };\n    /**\n     * Add an arbitrary script tag to the iframe.\n     * @param {!string} url - The URL for the script tag source.\n     * @param {!function()} loadCB - A callback to be triggered once the script has loaded.\n     */\n    FirebaseIFrameScriptHolder.prototype.addTag = function (url, loadCB) {\n        var _this = this;\n        if (util_3.isNodeSdk()) {\n            this.doNodeLongPoll(url, loadCB);\n        }\n        else {\n            setTimeout(function () {\n                try {\n                    // if we're already closed, don't add this poll\n                    if (!_this.sendNewPolls)\n                        return;\n                    var newScript_1 = _this.myIFrame.doc.createElement('script');\n                    newScript_1.type = 'text/javascript';\n                    newScript_1.async = true;\n                    newScript_1.src = url;\n                    newScript_1.onload = newScript_1.onreadystatechange = function () {\n                        var rstate = newScript_1.readyState;\n                        if (!rstate || rstate === 'loaded' || rstate === 'complete') {\n                            newScript_1.onload = newScript_1.onreadystatechange = null;\n                            if (newScript_1.parentNode) {\n                                newScript_1.parentNode.removeChild(newScript_1);\n                            }\n                            loadCB();\n                        }\n                    };\n                    newScript_1.onerror = function () {\n                        util_1.log('Long-poll script failed to load: ' + url);\n                        _this.sendNewPolls = false;\n                        _this.close();\n                    };\n                    _this.myIFrame.doc.body.appendChild(newScript_1);\n                }\n                catch (e) {\n                    // TODO: we should make this error visible somehow\n                }\n            }, Math.floor(1));\n        }\n    };\n    return FirebaseIFrameScriptHolder;\n}());\nexports.FirebaseIFrameScriptHolder = FirebaseIFrameScriptHolder;\n\n\n\n},{\"../core/stats/StatsManager\":47,\"../core/util/CountedSet\":52,\"../core/util/util\":63,\"./Constants\":82,\"./polling/PacketReceiver\":85,\"@firebase/util\":134}],81:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"../core/util/util\");\nvar storage_1 = require(\"../core/storage/storage\");\nvar Constants_1 = require(\"./Constants\");\nvar TransportManager_1 = require(\"./TransportManager\");\n// Abort upgrade attempt if it takes longer than 60s.\nvar UPGRADE_TIMEOUT = 60000;\n// For some transports (WebSockets), we need to \"validate\" the transport by exchanging a few requests and responses.\n// If we haven't sent enough requests within 5s, we'll start sending noop ping requests.\nvar DELAY_BEFORE_SENDING_EXTRA_REQUESTS = 5000;\n// If the initial data sent triggers a lot of bandwidth (i.e. it's a large put or a listen for a large amount of data)\n// then we may not be able to exchange our ping/pong requests within the healthy timeout.  So if we reach the timeout\n// but we've sent/received enough bytes, we don't cancel the connection.\nvar BYTES_SENT_HEALTHY_OVERRIDE = 10 * 1024;\nvar BYTES_RECEIVED_HEALTHY_OVERRIDE = 100 * 1024;\nvar MESSAGE_TYPE = 't';\nvar MESSAGE_DATA = 'd';\nvar CONTROL_SHUTDOWN = 's';\nvar CONTROL_RESET = 'r';\nvar CONTROL_ERROR = 'e';\nvar CONTROL_PONG = 'o';\nvar SWITCH_ACK = 'a';\nvar END_TRANSMISSION = 'n';\nvar PING = 'p';\nvar SERVER_HELLO = 'h';\n/**\n * Creates a new real-time connection to the server using whichever method works\n * best in the current browser.\n *\n * @constructor\n */\nvar Connection = /** @class */ (function () {\n    /**\n     * @param {!string} id - an id for this connection\n     * @param {!RepoInfo} repoInfo_ - the info for the endpoint to connect to\n     * @param {function(Object)} onMessage_ - the callback to be triggered when a server-push message arrives\n     * @param {function(number, string)} onReady_ - the callback to be triggered when this connection is ready to send messages.\n     * @param {function()} onDisconnect_ - the callback to be triggered when a connection was lost\n     * @param {function(string)} onKill_ - the callback to be triggered when this connection has permanently shut down.\n     * @param {string=} lastSessionId - last session id in persistent connection. is used to clean up old session in real-time server\n     */\n    function Connection(id, repoInfo_, onMessage_, onReady_, onDisconnect_, onKill_, lastSessionId) {\n        this.id = id;\n        this.repoInfo_ = repoInfo_;\n        this.onMessage_ = onMessage_;\n        this.onReady_ = onReady_;\n        this.onDisconnect_ = onDisconnect_;\n        this.onKill_ = onKill_;\n        this.lastSessionId = lastSessionId;\n        this.connectionCount = 0;\n        this.pendingDataMessages = [];\n        this.state_ = 0 /* CONNECTING */;\n        this.log_ = util_1.logWrapper('c:' + this.id + ':');\n        this.transportManager_ = new TransportManager_1.TransportManager(repoInfo_);\n        this.log_('Connection created');\n        this.start_();\n    }\n    /**\n     * Starts a connection attempt\n     * @private\n     */\n    Connection.prototype.start_ = function () {\n        var _this = this;\n        var conn = this.transportManager_.initialTransport();\n        this.conn_ = new conn(this.nextTransportId_(), this.repoInfo_, undefined, this.lastSessionId);\n        // For certain transports (WebSockets), we need to send and receive several messages back and forth before we\n        // can consider the transport healthy.\n        this.primaryResponsesRequired_ = conn['responsesRequiredToBeHealthy'] || 0;\n        var onMessageReceived = this.connReceiver_(this.conn_);\n        var onConnectionLost = this.disconnReceiver_(this.conn_);\n        this.tx_ = this.conn_;\n        this.rx_ = this.conn_;\n        this.secondaryConn_ = null;\n        this.isHealthy_ = false;\n        /*\n         * Firefox doesn't like when code from one iframe tries to create another iframe by way of the parent frame.\n         * This can occur in the case of a redirect, i.e. we guessed wrong on what server to connect to and received a reset.\n         * Somehow, setTimeout seems to make this ok. That doesn't make sense from a security perspective, since you should\n         * still have the context of your originating frame.\n         */\n        setTimeout(function () {\n            // this.conn_ gets set to null in some of the tests. Check to make sure it still exists before using it\n            _this.conn_ && _this.conn_.open(onMessageReceived, onConnectionLost);\n        }, Math.floor(0));\n        var healthyTimeout_ms = conn['healthyTimeout'] || 0;\n        if (healthyTimeout_ms > 0) {\n            this.healthyTimeout_ = util_1.setTimeoutNonBlocking(function () {\n                _this.healthyTimeout_ = null;\n                if (!_this.isHealthy_) {\n                    if (_this.conn_ &&\n                        _this.conn_.bytesReceived > BYTES_RECEIVED_HEALTHY_OVERRIDE) {\n                        _this.log_('Connection exceeded healthy timeout but has received ' +\n                            _this.conn_.bytesReceived +\n                            ' bytes.  Marking connection healthy.');\n                        _this.isHealthy_ = true;\n                        _this.conn_.markConnectionHealthy();\n                    }\n                    else if (_this.conn_ &&\n                        _this.conn_.bytesSent > BYTES_SENT_HEALTHY_OVERRIDE) {\n                        _this.log_('Connection exceeded healthy timeout but has sent ' +\n                            _this.conn_.bytesSent +\n                            ' bytes.  Leaving connection alive.');\n                        // NOTE: We don't want to mark it healthy, since we have no guarantee that the bytes have made it to\n                        // the server.\n                    }\n                    else {\n                        _this.log_('Closing unhealthy connection after timeout.');\n                        _this.close();\n                    }\n                }\n            }, Math.floor(healthyTimeout_ms));\n        }\n    };\n    /**\n     * @return {!string}\n     * @private\n     */\n    Connection.prototype.nextTransportId_ = function () {\n        return 'c:' + this.id + ':' + this.connectionCount++;\n    };\n    Connection.prototype.disconnReceiver_ = function (conn) {\n        var _this = this;\n        return function (everConnected) {\n            if (conn === _this.conn_) {\n                _this.onConnectionLost_(everConnected);\n            }\n            else if (conn === _this.secondaryConn_) {\n                _this.log_('Secondary connection lost.');\n                _this.onSecondaryConnectionLost_();\n            }\n            else {\n                _this.log_('closing an old connection');\n            }\n        };\n    };\n    Connection.prototype.connReceiver_ = function (conn) {\n        var _this = this;\n        return function (message) {\n            if (_this.state_ != 2 /* DISCONNECTED */) {\n                if (conn === _this.rx_) {\n                    _this.onPrimaryMessageReceived_(message);\n                }\n                else if (conn === _this.secondaryConn_) {\n                    _this.onSecondaryMessageReceived_(message);\n                }\n                else {\n                    _this.log_('message on old connection');\n                }\n            }\n        };\n    };\n    /**\n     *\n     * @param {Object} dataMsg An arbitrary data message to be sent to the server\n     */\n    Connection.prototype.sendRequest = function (dataMsg) {\n        // wrap in a data message envelope and send it on\n        var msg = { t: 'd', d: dataMsg };\n        this.sendData_(msg);\n    };\n    Connection.prototype.tryCleanupConnection = function () {\n        if (this.tx_ === this.secondaryConn_ && this.rx_ === this.secondaryConn_) {\n            this.log_('cleaning up and promoting a connection: ' + this.secondaryConn_.connId);\n            this.conn_ = this.secondaryConn_;\n            this.secondaryConn_ = null;\n            // the server will shutdown the old connection\n        }\n    };\n    Connection.prototype.onSecondaryControl_ = function (controlData) {\n        if (MESSAGE_TYPE in controlData) {\n            var cmd = controlData[MESSAGE_TYPE];\n            if (cmd === SWITCH_ACK) {\n                this.upgradeIfSecondaryHealthy_();\n            }\n            else if (cmd === CONTROL_RESET) {\n                // Most likely the session wasn't valid. Abandon the switch attempt\n                this.log_('Got a reset on secondary, closing it');\n                this.secondaryConn_.close();\n                // If we were already using this connection for something, than we need to fully close\n                if (this.tx_ === this.secondaryConn_ ||\n                    this.rx_ === this.secondaryConn_) {\n                    this.close();\n                }\n            }\n            else if (cmd === CONTROL_PONG) {\n                this.log_('got pong on secondary.');\n                this.secondaryResponsesRequired_--;\n                this.upgradeIfSecondaryHealthy_();\n            }\n        }\n    };\n    Connection.prototype.onSecondaryMessageReceived_ = function (parsedData) {\n        var layer = util_1.requireKey('t', parsedData);\n        var data = util_1.requireKey('d', parsedData);\n        if (layer == 'c') {\n            this.onSecondaryControl_(data);\n        }\n        else if (layer == 'd') {\n            // got a data message, but we're still second connection. Need to buffer it up\n            this.pendingDataMessages.push(data);\n        }\n        else {\n            throw new Error('Unknown protocol layer: ' + layer);\n        }\n    };\n    Connection.prototype.upgradeIfSecondaryHealthy_ = function () {\n        if (this.secondaryResponsesRequired_ <= 0) {\n            this.log_('Secondary connection is healthy.');\n            this.isHealthy_ = true;\n            this.secondaryConn_.markConnectionHealthy();\n            this.proceedWithUpgrade_();\n        }\n        else {\n            // Send a ping to make sure the connection is healthy.\n            this.log_('sending ping on secondary.');\n            this.secondaryConn_.send({ t: 'c', d: { t: PING, d: {} } });\n        }\n    };\n    Connection.prototype.proceedWithUpgrade_ = function () {\n        // tell this connection to consider itself open\n        this.secondaryConn_.start();\n        // send ack\n        this.log_('sending client ack on secondary');\n        this.secondaryConn_.send({ t: 'c', d: { t: SWITCH_ACK, d: {} } });\n        // send end packet on primary transport, switch to sending on this one\n        // can receive on this one, buffer responses until end received on primary transport\n        this.log_('Ending transmission on primary');\n        this.conn_.send({ t: 'c', d: { t: END_TRANSMISSION, d: {} } });\n        this.tx_ = this.secondaryConn_;\n        this.tryCleanupConnection();\n    };\n    Connection.prototype.onPrimaryMessageReceived_ = function (parsedData) {\n        // Must refer to parsedData properties in quotes, so closure doesn't touch them.\n        var layer = util_1.requireKey('t', parsedData);\n        var data = util_1.requireKey('d', parsedData);\n        if (layer == 'c') {\n            this.onControl_(data);\n        }\n        else if (layer == 'd') {\n            this.onDataMessage_(data);\n        }\n    };\n    Connection.prototype.onDataMessage_ = function (message) {\n        this.onPrimaryResponse_();\n        // We don't do anything with data messages, just kick them up a level\n        this.onMessage_(message);\n    };\n    Connection.prototype.onPrimaryResponse_ = function () {\n        if (!this.isHealthy_) {\n            this.primaryResponsesRequired_--;\n            if (this.primaryResponsesRequired_ <= 0) {\n                this.log_('Primary connection is healthy.');\n                this.isHealthy_ = true;\n                this.conn_.markConnectionHealthy();\n            }\n        }\n    };\n    Connection.prototype.onControl_ = function (controlData) {\n        var cmd = util_1.requireKey(MESSAGE_TYPE, controlData);\n        if (MESSAGE_DATA in controlData) {\n            var payload = controlData[MESSAGE_DATA];\n            if (cmd === SERVER_HELLO) {\n                this.onHandshake_(payload);\n            }\n            else if (cmd === END_TRANSMISSION) {\n                this.log_('recvd end transmission on primary');\n                this.rx_ = this.secondaryConn_;\n                for (var i = 0; i < this.pendingDataMessages.length; ++i) {\n                    this.onDataMessage_(this.pendingDataMessages[i]);\n                }\n                this.pendingDataMessages = [];\n                this.tryCleanupConnection();\n            }\n            else if (cmd === CONTROL_SHUTDOWN) {\n                // This was previously the 'onKill' callback passed to the lower-level connection\n                // payload in this case is the reason for the shutdown. Generally a human-readable error\n                this.onConnectionShutdown_(payload);\n            }\n            else if (cmd === CONTROL_RESET) {\n                // payload in this case is the host we should contact\n                this.onReset_(payload);\n            }\n            else if (cmd === CONTROL_ERROR) {\n                util_1.error('Server Error: ' + payload);\n            }\n            else if (cmd === CONTROL_PONG) {\n                this.log_('got pong on primary.');\n                this.onPrimaryResponse_();\n                this.sendPingOnPrimaryIfNecessary_();\n            }\n            else {\n                util_1.error('Unknown control packet command: ' + cmd);\n            }\n        }\n    };\n    /**\n     *\n     * @param {Object} handshake The handshake data returned from the server\n     * @private\n     */\n    Connection.prototype.onHandshake_ = function (handshake) {\n        var timestamp = handshake.ts;\n        var version = handshake.v;\n        var host = handshake.h;\n        this.sessionId = handshake.s;\n        this.repoInfo_.updateHost(host);\n        // if we've already closed the connection, then don't bother trying to progress further\n        if (this.state_ == 0 /* CONNECTING */) {\n            this.conn_.start();\n            this.onConnectionEstablished_(this.conn_, timestamp);\n            if (Constants_1.PROTOCOL_VERSION !== version) {\n                util_1.warn('Protocol version mismatch detected');\n            }\n            // TODO: do we want to upgrade? when? maybe a delay?\n            this.tryStartUpgrade_();\n        }\n    };\n    Connection.prototype.tryStartUpgrade_ = function () {\n        var conn = this.transportManager_.upgradeTransport();\n        if (conn) {\n            this.startUpgrade_(conn);\n        }\n    };\n    Connection.prototype.startUpgrade_ = function (conn) {\n        var _this = this;\n        this.secondaryConn_ = new conn(this.nextTransportId_(), this.repoInfo_, this.sessionId);\n        // For certain transports (WebSockets), we need to send and receive several messages back and forth before we\n        // can consider the transport healthy.\n        this.secondaryResponsesRequired_ =\n            conn['responsesRequiredToBeHealthy'] || 0;\n        var onMessage = this.connReceiver_(this.secondaryConn_);\n        var onDisconnect = this.disconnReceiver_(this.secondaryConn_);\n        this.secondaryConn_.open(onMessage, onDisconnect);\n        // If we haven't successfully upgraded after UPGRADE_TIMEOUT, give up and kill the secondary.\n        util_1.setTimeoutNonBlocking(function () {\n            if (_this.secondaryConn_) {\n                _this.log_('Timed out trying to upgrade.');\n                _this.secondaryConn_.close();\n            }\n        }, Math.floor(UPGRADE_TIMEOUT));\n    };\n    Connection.prototype.onReset_ = function (host) {\n        this.log_('Reset packet received.  New host: ' + host);\n        this.repoInfo_.updateHost(host);\n        // TODO: if we're already \"connected\", we need to trigger a disconnect at the next layer up.\n        // We don't currently support resets after the connection has already been established\n        if (this.state_ === 1 /* CONNECTED */) {\n            this.close();\n        }\n        else {\n            // Close whatever connections we have open and start again.\n            this.closeConnections_();\n            this.start_();\n        }\n    };\n    Connection.prototype.onConnectionEstablished_ = function (conn, timestamp) {\n        var _this = this;\n        this.log_('Realtime connection established.');\n        this.conn_ = conn;\n        this.state_ = 1 /* CONNECTED */;\n        if (this.onReady_) {\n            this.onReady_(timestamp, this.sessionId);\n            this.onReady_ = null;\n        }\n        // If after 5 seconds we haven't sent enough requests to the server to get the connection healthy,\n        // send some pings.\n        if (this.primaryResponsesRequired_ === 0) {\n            this.log_('Primary connection is healthy.');\n            this.isHealthy_ = true;\n        }\n        else {\n            util_1.setTimeoutNonBlocking(function () {\n                _this.sendPingOnPrimaryIfNecessary_();\n            }, Math.floor(DELAY_BEFORE_SENDING_EXTRA_REQUESTS));\n        }\n    };\n    Connection.prototype.sendPingOnPrimaryIfNecessary_ = function () {\n        // If the connection isn't considered healthy yet, we'll send a noop ping packet request.\n        if (!this.isHealthy_ && this.state_ === 1 /* CONNECTED */) {\n            this.log_('sending ping on primary.');\n            this.sendData_({ t: 'c', d: { t: PING, d: {} } });\n        }\n    };\n    Connection.prototype.onSecondaryConnectionLost_ = function () {\n        var conn = this.secondaryConn_;\n        this.secondaryConn_ = null;\n        if (this.tx_ === conn || this.rx_ === conn) {\n            // we are relying on this connection already in some capacity. Therefore, a failure is real\n            this.close();\n        }\n    };\n    /**\n     *\n     * @param {boolean} everConnected Whether or not the connection ever reached a server. Used to determine if\n     * we should flush the host cache\n     * @private\n     */\n    Connection.prototype.onConnectionLost_ = function (everConnected) {\n        this.conn_ = null;\n        // NOTE: IF you're seeing a Firefox error for this line, I think it might be because it's getting\n        // called on window close and RealtimeState.CONNECTING is no longer defined.  Just a guess.\n        if (!everConnected && this.state_ === 0 /* CONNECTING */) {\n            this.log_('Realtime connection failed.');\n            // Since we failed to connect at all, clear any cached entry for this namespace in case the machine went away\n            if (this.repoInfo_.isCacheableHost()) {\n                storage_1.PersistentStorage.remove('host:' + this.repoInfo_.host);\n                // reset the internal host to what we would show the user, i.e. <ns>.firebaseio.com\n                this.repoInfo_.internalHost = this.repoInfo_.host;\n            }\n        }\n        else if (this.state_ === 1 /* CONNECTED */) {\n            this.log_('Realtime connection lost.');\n        }\n        this.close();\n    };\n    /**\n     *\n     * @param {string} reason\n     * @private\n     */\n    Connection.prototype.onConnectionShutdown_ = function (reason) {\n        this.log_('Connection shutdown command received. Shutting down...');\n        if (this.onKill_) {\n            this.onKill_(reason);\n            this.onKill_ = null;\n        }\n        // We intentionally don't want to fire onDisconnect (kill is a different case),\n        // so clear the callback.\n        this.onDisconnect_ = null;\n        this.close();\n    };\n    Connection.prototype.sendData_ = function (data) {\n        if (this.state_ !== 1 /* CONNECTED */) {\n            throw 'Connection is not connected';\n        }\n        else {\n            this.tx_.send(data);\n        }\n    };\n    /**\n     * Cleans up this connection, calling the appropriate callbacks\n     */\n    Connection.prototype.close = function () {\n        if (this.state_ !== 2 /* DISCONNECTED */) {\n            this.log_('Closing realtime connection.');\n            this.state_ = 2 /* DISCONNECTED */;\n            this.closeConnections_();\n            if (this.onDisconnect_) {\n                this.onDisconnect_();\n                this.onDisconnect_ = null;\n            }\n        }\n    };\n    /**\n     *\n     * @private\n     */\n    Connection.prototype.closeConnections_ = function () {\n        this.log_('Shutting down all connections');\n        if (this.conn_) {\n            this.conn_.close();\n            this.conn_ = null;\n        }\n        if (this.secondaryConn_) {\n            this.secondaryConn_.close();\n            this.secondaryConn_ = null;\n        }\n        if (this.healthyTimeout_) {\n            clearTimeout(this.healthyTimeout_);\n            this.healthyTimeout_ = null;\n        }\n    };\n    return Connection;\n}());\nexports.Connection = Connection;\n\n\n\n},{\"../core/storage/storage\":51,\"../core/util/util\":63,\"./Constants\":82,\"./TransportManager\":83}],82:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PROTOCOL_VERSION = '5';\nexports.VERSION_PARAM = 'v';\nexports.TRANSPORT_SESSION_PARAM = 's';\nexports.REFERER_PARAM = 'r';\nexports.FORGE_REF = 'f';\nexports.FORGE_DOMAIN = 'firebaseio.com';\nexports.LAST_SESSION_PARAM = 'ls';\nexports.WEBSOCKET = 'websocket';\nexports.LONG_POLLING = 'long_polling';\n\n\n\n},{}],83:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar BrowserPollConnection_1 = require(\"./BrowserPollConnection\");\nvar WebSocketConnection_1 = require(\"./WebSocketConnection\");\nvar util_1 = require(\"../core/util/util\");\n/**\n * Currently simplistic, this class manages what transport a Connection should use at various stages of its\n * lifecycle.\n *\n * It starts with longpolling in a browser, and httppolling on node. It then upgrades to websockets if\n * they are available.\n * @constructor\n */\nvar TransportManager = /** @class */ (function () {\n    /**\n     * @param {!RepoInfo} repoInfo Metadata around the namespace we're connecting to\n     */\n    function TransportManager(repoInfo) {\n        this.initTransports_(repoInfo);\n    }\n    Object.defineProperty(TransportManager, \"ALL_TRANSPORTS\", {\n        /**\n         * @const\n         * @type {!Array.<function(new:Transport, string, RepoInfo, string=)>}\n         */\n        get: function () {\n            return [BrowserPollConnection_1.BrowserPollConnection, WebSocketConnection_1.WebSocketConnection];\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @param {!RepoInfo} repoInfo\n     * @private\n     */\n    TransportManager.prototype.initTransports_ = function (repoInfo) {\n        var isWebSocketsAvailable = WebSocketConnection_1.WebSocketConnection && WebSocketConnection_1.WebSocketConnection['isAvailable']();\n        var isSkipPollConnection = isWebSocketsAvailable && !WebSocketConnection_1.WebSocketConnection.previouslyFailed();\n        if (repoInfo.webSocketOnly) {\n            if (!isWebSocketsAvailable)\n                util_1.warn(\"wss:// URL used, but browser isn't known to support websockets.  Trying anyway.\");\n            isSkipPollConnection = true;\n        }\n        if (isSkipPollConnection) {\n            this.transports_ = [WebSocketConnection_1.WebSocketConnection];\n        }\n        else {\n            var transports_1 = (this.transports_ = []);\n            util_1.each(TransportManager.ALL_TRANSPORTS, function (i, transport) {\n                if (transport && transport['isAvailable']()) {\n                    transports_1.push(transport);\n                }\n            });\n        }\n    };\n    /**\n     * @return {function(new:Transport, !string, !RepoInfo, string=, string=)} The constructor for the\n     * initial transport to use\n     */\n    TransportManager.prototype.initialTransport = function () {\n        if (this.transports_.length > 0) {\n            return this.transports_[0];\n        }\n        else {\n            throw new Error('No transports available');\n        }\n    };\n    /**\n     * @return {?function(new:Transport, function(),function(), string=)} The constructor for the next\n     * transport, or null\n     */\n    TransportManager.prototype.upgradeTransport = function () {\n        if (this.transports_.length > 1) {\n            return this.transports_[1];\n        }\n        else {\n            return null;\n        }\n    };\n    return TransportManager;\n}());\nexports.TransportManager = TransportManager;\n\n\n\n},{\"../core/util/util\":63,\"./BrowserPollConnection\":80,\"./WebSocketConnection\":84}],84:[function(require,module,exports){\n(function (process){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar app_1 = require(\"@firebase/app\");\nvar util_1 = require(\"@firebase/util\");\nvar util_2 = require(\"../core/util/util\");\nvar StatsManager_1 = require(\"../core/stats/StatsManager\");\nvar Constants_1 = require(\"./Constants\");\nvar util_3 = require(\"@firebase/util\");\nvar storage_1 = require(\"../core/storage/storage\");\nvar util_4 = require(\"@firebase/util\");\nvar util_5 = require(\"@firebase/util\");\nvar WEBSOCKET_MAX_FRAME_SIZE = 16384;\nvar WEBSOCKET_KEEPALIVE_INTERVAL = 45000;\nvar WebSocketImpl = null;\nif (typeof MozWebSocket !== 'undefined') {\n    WebSocketImpl = MozWebSocket;\n}\nelse if (typeof WebSocket !== 'undefined') {\n    WebSocketImpl = WebSocket;\n}\nfunction setWebSocketImpl(impl) {\n    WebSocketImpl = impl;\n}\nexports.setWebSocketImpl = setWebSocketImpl;\n/**\n * Create a new websocket connection with the given callbacks.\n * @constructor\n * @implements {Transport}\n */\nvar WebSocketConnection = /** @class */ (function () {\n    /**\n     * @param {string} connId identifier for this transport\n     * @param {RepoInfo} repoInfo The info for the websocket endpoint.\n     * @param {string=} transportSessionId Optional transportSessionId if this is connecting to an existing transport\n     *                                         session\n     * @param {string=} lastSessionId Optional lastSessionId if there was a previous connection\n     */\n    function WebSocketConnection(connId, repoInfo, transportSessionId, lastSessionId) {\n        this.connId = connId;\n        this.keepaliveTimer = null;\n        this.frames = null;\n        this.totalFrames = 0;\n        this.bytesSent = 0;\n        this.bytesReceived = 0;\n        this.log_ = util_2.logWrapper(this.connId);\n        this.stats_ = StatsManager_1.StatsManager.getCollection(repoInfo);\n        this.connURL = WebSocketConnection.connectionURL_(repoInfo, transportSessionId, lastSessionId);\n    }\n    /**\n     * @param {RepoInfo} repoInfo The info for the websocket endpoint.\n     * @param {string=} transportSessionId Optional transportSessionId if this is connecting to an existing transport\n     *                                         session\n     * @param {string=} lastSessionId Optional lastSessionId if there was a previous connection\n     * @return {string} connection url\n     * @private\n     */\n    WebSocketConnection.connectionURL_ = function (repoInfo, transportSessionId, lastSessionId) {\n        var urlParams = {};\n        urlParams[Constants_1.VERSION_PARAM] = Constants_1.PROTOCOL_VERSION;\n        if (!util_5.isNodeSdk() &&\n            typeof location !== 'undefined' &&\n            location.href &&\n            location.href.indexOf(Constants_1.FORGE_DOMAIN) !== -1) {\n            urlParams[Constants_1.REFERER_PARAM] = Constants_1.FORGE_REF;\n        }\n        if (transportSessionId) {\n            urlParams[Constants_1.TRANSPORT_SESSION_PARAM] = transportSessionId;\n        }\n        if (lastSessionId) {\n            urlParams[Constants_1.LAST_SESSION_PARAM] = lastSessionId;\n        }\n        return repoInfo.connectionURL(Constants_1.WEBSOCKET, urlParams);\n    };\n    /**\n     *\n     * @param onMessage Callback when messages arrive\n     * @param onDisconnect Callback with connection lost.\n     */\n    WebSocketConnection.prototype.open = function (onMessage, onDisconnect) {\n        var _this = this;\n        this.onDisconnect = onDisconnect;\n        this.onMessage = onMessage;\n        this.log_('Websocket connecting to ' + this.connURL);\n        this.everConnected_ = false;\n        // Assume failure until proven otherwise.\n        storage_1.PersistentStorage.set('previous_websocket_failure', true);\n        try {\n            if (util_5.isNodeSdk()) {\n                var device = util_3.CONSTANTS.NODE_ADMIN ? 'AdminNode' : 'Node';\n                // UA Format: Firebase/<wire_protocol>/<sdk_version>/<platform>/<device>\n                var options = {\n                    headers: {\n                        'User-Agent': \"Firebase/\" + Constants_1.PROTOCOL_VERSION + \"/\" + app_1.default.SDK_VERSION + \"/\" + process.platform + \"/\" + device\n                    }\n                };\n                // Plumb appropriate http_proxy environment variable into faye-websocket if it exists.\n                var env = process['env'];\n                var proxy = this.connURL.indexOf('wss://') == 0\n                    ? env['HTTPS_PROXY'] || env['https_proxy']\n                    : env['HTTP_PROXY'] || env['http_proxy'];\n                if (proxy) {\n                    options['proxy'] = { origin: proxy };\n                }\n                this.mySock = new WebSocketImpl(this.connURL, [], options);\n            }\n            else {\n                this.mySock = new WebSocketImpl(this.connURL);\n            }\n        }\n        catch (e) {\n            this.log_('Error instantiating WebSocket.');\n            var error = e.message || e.data;\n            if (error) {\n                this.log_(error);\n            }\n            this.onClosed_();\n            return;\n        }\n        this.mySock.onopen = function () {\n            _this.log_('Websocket connected.');\n            _this.everConnected_ = true;\n        };\n        this.mySock.onclose = function () {\n            _this.log_('Websocket connection was disconnected.');\n            _this.mySock = null;\n            _this.onClosed_();\n        };\n        this.mySock.onmessage = function (m) {\n            _this.handleIncomingFrame(m);\n        };\n        this.mySock.onerror = function (e) {\n            _this.log_('WebSocket error.  Closing connection.');\n            var error = e.message || e.data;\n            if (error) {\n                _this.log_(error);\n            }\n            _this.onClosed_();\n        };\n    };\n    /**\n     * No-op for websockets, we don't need to do anything once the connection is confirmed as open\n     */\n    WebSocketConnection.prototype.start = function () { };\n    WebSocketConnection.forceDisallow = function () {\n        WebSocketConnection.forceDisallow_ = true;\n    };\n    WebSocketConnection.isAvailable = function () {\n        var isOldAndroid = false;\n        if (typeof navigator !== 'undefined' && navigator.userAgent) {\n            var oldAndroidRegex = /Android ([0-9]{0,}\\.[0-9]{0,})/;\n            var oldAndroidMatch = navigator.userAgent.match(oldAndroidRegex);\n            if (oldAndroidMatch && oldAndroidMatch.length > 1) {\n                if (parseFloat(oldAndroidMatch[1]) < 4.4) {\n                    isOldAndroid = true;\n                }\n            }\n        }\n        return (!isOldAndroid &&\n            WebSocketImpl !== null &&\n            !WebSocketConnection.forceDisallow_);\n    };\n    /**\n     * Returns true if we previously failed to connect with this transport.\n     * @return {boolean}\n     */\n    WebSocketConnection.previouslyFailed = function () {\n        // If our persistent storage is actually only in-memory storage,\n        // we default to assuming that it previously failed to be safe.\n        return (storage_1.PersistentStorage.isInMemoryStorage ||\n            storage_1.PersistentStorage.get('previous_websocket_failure') === true);\n    };\n    WebSocketConnection.prototype.markConnectionHealthy = function () {\n        storage_1.PersistentStorage.remove('previous_websocket_failure');\n    };\n    WebSocketConnection.prototype.appendFrame_ = function (data) {\n        this.frames.push(data);\n        if (this.frames.length == this.totalFrames) {\n            var fullMess = this.frames.join('');\n            this.frames = null;\n            var jsonMess = util_4.jsonEval(fullMess);\n            //handle the message\n            this.onMessage(jsonMess);\n        }\n    };\n    /**\n     * @param {number} frameCount The number of frames we are expecting from the server\n     * @private\n     */\n    WebSocketConnection.prototype.handleNewFrameCount_ = function (frameCount) {\n        this.totalFrames = frameCount;\n        this.frames = [];\n    };\n    /**\n     * Attempts to parse a frame count out of some text. If it can't, assumes a value of 1\n     * @param {!String} data\n     * @return {?String} Any remaining data to be process, or null if there is none\n     * @private\n     */\n    WebSocketConnection.prototype.extractFrameCount_ = function (data) {\n        util_1.assert(this.frames === null, 'We already have a frame buffer');\n        // TODO: The server is only supposed to send up to 9999 frames (i.e. length <= 4), but that isn't being enforced\n        // currently.  So allowing larger frame counts (length <= 6).  See https://app.asana.com/0/search/8688598998380/8237608042508\n        if (data.length <= 6) {\n            var frameCount = Number(data);\n            if (!isNaN(frameCount)) {\n                this.handleNewFrameCount_(frameCount);\n                return null;\n            }\n        }\n        this.handleNewFrameCount_(1);\n        return data;\n    };\n    /**\n     * Process a websocket frame that has arrived from the server.\n     * @param mess The frame data\n     */\n    WebSocketConnection.prototype.handleIncomingFrame = function (mess) {\n        if (this.mySock === null)\n            return; // Chrome apparently delivers incoming packets even after we .close() the connection sometimes.\n        var data = mess['data'];\n        this.bytesReceived += data.length;\n        this.stats_.incrementCounter('bytes_received', data.length);\n        this.resetKeepAlive();\n        if (this.frames !== null) {\n            // we're buffering\n            this.appendFrame_(data);\n        }\n        else {\n            // try to parse out a frame count, otherwise, assume 1 and process it\n            var remainingData = this.extractFrameCount_(data);\n            if (remainingData !== null) {\n                this.appendFrame_(remainingData);\n            }\n        }\n    };\n    /**\n     * Send a message to the server\n     * @param {Object} data The JSON object to transmit\n     */\n    WebSocketConnection.prototype.send = function (data) {\n        this.resetKeepAlive();\n        var dataStr = util_4.stringify(data);\n        this.bytesSent += dataStr.length;\n        this.stats_.incrementCounter('bytes_sent', dataStr.length);\n        //We can only fit a certain amount in each websocket frame, so we need to split this request\n        //up into multiple pieces if it doesn't fit in one request.\n        var dataSegs = util_2.splitStringBySize(dataStr, WEBSOCKET_MAX_FRAME_SIZE);\n        //Send the length header\n        if (dataSegs.length > 1) {\n            this.sendString_(String(dataSegs.length));\n        }\n        //Send the actual data in segments.\n        for (var i = 0; i < dataSegs.length; i++) {\n            this.sendString_(dataSegs[i]);\n        }\n    };\n    WebSocketConnection.prototype.shutdown_ = function () {\n        this.isClosed_ = true;\n        if (this.keepaliveTimer) {\n            clearInterval(this.keepaliveTimer);\n            this.keepaliveTimer = null;\n        }\n        if (this.mySock) {\n            this.mySock.close();\n            this.mySock = null;\n        }\n    };\n    WebSocketConnection.prototype.onClosed_ = function () {\n        if (!this.isClosed_) {\n            this.log_('WebSocket is closing itself');\n            this.shutdown_();\n            // since this is an internal close, trigger the close listener\n            if (this.onDisconnect) {\n                this.onDisconnect(this.everConnected_);\n                this.onDisconnect = null;\n            }\n        }\n    };\n    /**\n     * External-facing close handler.\n     * Close the websocket and kill the connection.\n     */\n    WebSocketConnection.prototype.close = function () {\n        if (!this.isClosed_) {\n            this.log_('WebSocket is being closed');\n            this.shutdown_();\n        }\n    };\n    /**\n     * Kill the current keepalive timer and start a new one, to ensure that it always fires N seconds after\n     * the last activity.\n     */\n    WebSocketConnection.prototype.resetKeepAlive = function () {\n        var _this = this;\n        clearInterval(this.keepaliveTimer);\n        this.keepaliveTimer = setInterval(function () {\n            //If there has been no websocket activity for a while, send a no-op\n            if (_this.mySock) {\n                _this.sendString_('0');\n            }\n            _this.resetKeepAlive();\n        }, Math.floor(WEBSOCKET_KEEPALIVE_INTERVAL));\n    };\n    /**\n     * Send a string over the websocket.\n     *\n     * @param {string} str String to send.\n     * @private\n     */\n    WebSocketConnection.prototype.sendString_ = function (str) {\n        // Firefox seems to sometimes throw exceptions (NS_ERROR_UNEXPECTED) from websocket .send()\n        // calls for some unknown reason.  We treat these as an error and disconnect.\n        // See https://app.asana.com/0/58926111402292/68021340250410\n        try {\n            this.mySock.send(str);\n        }\n        catch (e) {\n            this.log_('Exception thrown from WebSocket.send():', e.message || e.data, 'Closing connection.');\n            setTimeout(this.onClosed_.bind(this), 0);\n        }\n    };\n    /**\n     * Number of response before we consider the connection \"healthy.\"\n     * @type {number}\n     */\n    WebSocketConnection.responsesRequiredToBeHealthy = 2;\n    /**\n     * Time to wait for the connection te become healthy before giving up.\n     * @type {number}\n     */\n    WebSocketConnection.healthyTimeout = 30000;\n    return WebSocketConnection;\n}());\nexports.WebSocketConnection = WebSocketConnection;\n\n\n\n}).call(this,require('_process'))\n\n},{\"../core/stats/StatsManager\":47,\"../core/storage/storage\":51,\"../core/util/util\":63,\"./Constants\":82,\"@firebase/app\":1,\"@firebase/util\":134,\"_process\":157}],85:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"../../core/util/util\");\n/**\n * This class ensures the packets from the server arrive in order\n * This class takes data from the server and ensures it gets passed into the callbacks in order.\n * @constructor\n */\nvar PacketReceiver = /** @class */ (function () {\n    /**\n     * @param onMessage_\n     */\n    function PacketReceiver(onMessage_) {\n        this.onMessage_ = onMessage_;\n        this.pendingResponses = [];\n        this.currentResponseNum = 0;\n        this.closeAfterResponse = -1;\n        this.onClose = null;\n    }\n    PacketReceiver.prototype.closeAfter = function (responseNum, callback) {\n        this.closeAfterResponse = responseNum;\n        this.onClose = callback;\n        if (this.closeAfterResponse < this.currentResponseNum) {\n            this.onClose();\n            this.onClose = null;\n        }\n    };\n    /**\n     * Each message from the server comes with a response number, and an array of data. The responseNumber\n     * allows us to ensure that we process them in the right order, since we can't be guaranteed that all\n     * browsers will respond in the same order as the requests we sent\n     * @param {number} requestNum\n     * @param {Array} data\n     */\n    PacketReceiver.prototype.handleResponse = function (requestNum, data) {\n        var _this = this;\n        this.pendingResponses[requestNum] = data;\n        var _loop_1 = function () {\n            var toProcess = this_1.pendingResponses[this_1.currentResponseNum];\n            delete this_1.pendingResponses[this_1.currentResponseNum];\n            var _loop_2 = function (i) {\n                if (toProcess[i]) {\n                    util_1.exceptionGuard(function () {\n                        _this.onMessage_(toProcess[i]);\n                    });\n                }\n            };\n            for (var i = 0; i < toProcess.length; ++i) {\n                _loop_2(i);\n            }\n            if (this_1.currentResponseNum === this_1.closeAfterResponse) {\n                if (this_1.onClose) {\n                    this_1.onClose();\n                    this_1.onClose = null;\n                }\n                return \"break\";\n            }\n            this_1.currentResponseNum++;\n        };\n        var this_1 = this;\n        while (this.pendingResponses[this.currentResponseNum]) {\n            var state_1 = _loop_1();\n            if (state_1 === \"break\")\n                break;\n        }\n    };\n    return PacketReceiver;\n}());\nexports.PacketReceiver = PacketReceiver;\n\n\n\n},{\"../../core/util/util\":63}],86:[function(require,module,exports){\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar window_controller_1 = require(\"./src/controllers/window-controller\");\nvar sw_controller_1 = require(\"./src/controllers/sw-controller\");\nvar app_1 = require(\"@firebase/app\");\nfunction registerMessaging(instance) {\n    var messagingName = 'messaging';\n    var factoryMethod = function (app) {\n        if (self && 'ServiceWorkerGlobalScope' in self) {\n            return new sw_controller_1.default(app);\n        }\n        // Assume we are in the window context.\n        return new window_controller_1.default(app);\n    };\n    var namespaceExports = {\n        // no-inline\n        Messaging: window_controller_1.default\n    };\n    instance.INTERNAL.registerService(messagingName, factoryMethod, namespaceExports);\n}\nexports.registerMessaging = registerMessaging;\nregisterMessaging(app_1.default);\n\n\n\n},{\"./src/controllers/sw-controller\":88,\"./src/controllers/window-controller\":89,\"@firebase/app\":1}],87:[function(require,module,exports){\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\nvar errors_1 = require(\"../models/errors\");\nvar token_manager_1 = require(\"../models/token-manager\");\nvar notification_permission_1 = require(\"../models/notification-permission\");\nvar SENDER_ID_OPTION_NAME = 'messagingSenderId';\nvar ControllerInterface = /** @class */ (function () {\n    /**\n     * An interface of the Messaging Service API\n     * @param {!firebase.app.App} app\n     */\n    function ControllerInterface(app) {\n        var _this = this;\n        this.errorFactory_ = new util_1.ErrorFactory('messaging', 'Messaging', errors_1.default.map);\n        if (!app.options[SENDER_ID_OPTION_NAME] ||\n            typeof app.options[SENDER_ID_OPTION_NAME] !== 'string') {\n            throw this.errorFactory_.create(errors_1.default.codes.BAD_SENDER_ID);\n        }\n        this.messagingSenderId_ = app.options[SENDER_ID_OPTION_NAME];\n        this.tokenManager_ = new token_manager_1.default();\n        this.app = app;\n        this.INTERNAL = {};\n        this.INTERNAL.delete = function () { return _this.delete; };\n    }\n    /**\n     * @export\n     * @return {Promise<string> | Promise<null>} Returns a promise that\n     * resolves to an FCM token.\n     */\n    ControllerInterface.prototype.getToken = function () {\n        var _this = this;\n        // Check with permissions\n        var currentPermission = this.getNotificationPermission_();\n        if (currentPermission !== notification_permission_1.default.granted) {\n            if (currentPermission === notification_permission_1.default.denied) {\n                return Promise.reject(this.errorFactory_.create(errors_1.default.codes.NOTIFICATIONS_BLOCKED));\n            }\n            // We must wait for permission to be granted\n            return Promise.resolve(null);\n        }\n        return this.getSWRegistration_().then(function (registration) {\n            return _this.tokenManager_\n                .getSavedToken(_this.messagingSenderId_, registration)\n                .then(function (token) {\n                if (token) {\n                    return token;\n                }\n                return _this.tokenManager_.createToken(_this.messagingSenderId_, registration);\n            });\n        });\n    };\n    /**\n     * This method deletes tokens that the token manager looks after and then\n     * unregisters the push subscription if it exists.\n     * @export\n     * @param {string} token\n     * @return {Promise<void>}\n     */\n    ControllerInterface.prototype.deleteToken = function (token) {\n        var _this = this;\n        return this.tokenManager_.deleteToken(token).then(function () {\n            return _this.getSWRegistration_()\n                .then(function (registration) {\n                if (registration) {\n                    return registration.pushManager.getSubscription();\n                }\n            })\n                .then(function (subscription) {\n                if (subscription) {\n                    return subscription.unsubscribe();\n                }\n            });\n        });\n    };\n    ControllerInterface.prototype.getSWRegistration_ = function () {\n        throw this.errorFactory_.create(errors_1.default.codes.SHOULD_BE_INHERITED);\n    };\n    //\n    // The following methods should only be available in the window.\n    //\n    ControllerInterface.prototype.requestPermission = function () {\n        throw this.errorFactory_.create(errors_1.default.codes.AVAILABLE_IN_WINDOW);\n    };\n    /**\n     * @export\n     * @param {!ServiceWorkerRegistration} registration\n     */\n    ControllerInterface.prototype.useServiceWorker = function (registration) {\n        throw this.errorFactory_.create(errors_1.default.codes.AVAILABLE_IN_WINDOW);\n    };\n    /**\n     * @export\n     * @param {!firebase.Observer|function(*)} nextOrObserver\n     * @param {function(!Error)=} optError\n     * @param {function()=} optCompleted\n     * @return {!function()}\n     */\n    ControllerInterface.prototype.onMessage = function (nextOrObserver, optError, optCompleted) {\n        throw this.errorFactory_.create(errors_1.default.codes.AVAILABLE_IN_WINDOW);\n    };\n    /**\n     * @export\n     * @param {!firebase.Observer|function()} nextOrObserver An observer object\n     * or a function triggered on token refresh.\n     * @param {function(!Error)=} optError Optional A function\n     * triggered on token refresh error.\n     * @param {function()=} optCompleted Optional function triggered when the\n     * observer is removed.\n     * @return {!function()} The unsubscribe function for the observer.\n     */\n    ControllerInterface.prototype.onTokenRefresh = function (nextOrObserver, optError, optCompleted) {\n        throw this.errorFactory_.create(errors_1.default.codes.AVAILABLE_IN_WINDOW);\n    };\n    //\n    // The following methods are used by the service worker only.\n    //\n    /**\n     * @export\n     * @param {function(Object)} callback\n     */\n    ControllerInterface.prototype.setBackgroundMessageHandler = function (callback) {\n        throw this.errorFactory_.create(errors_1.default.codes.AVAILABLE_IN_SW);\n    };\n    //\n    // The following methods are used by the service themselves and not exposed\n    // publicly or not expected to be used by developers.\n    //\n    /**\n     * This method is required to adhere to the Firebase interface.\n     * It closes any currently open indexdb database connections.\n     */\n    ControllerInterface.prototype.delete = function () {\n        return this.tokenManager_.closeDatabase();\n    };\n    /**\n     * Returns the current Notification Permission state.\n     * @private\n     * @return {string} The currenct permission state.\n     */\n    ControllerInterface.prototype.getNotificationPermission_ = function () {\n        return Notification.permission;\n    };\n    /**\n     * @protected\n     * @returns {TokenManager}\n     */\n    ControllerInterface.prototype.getTokenManager = function () {\n        return this.tokenManager_;\n    };\n    return ControllerInterface;\n}());\nexports.default = ControllerInterface;\n\n\n\n},{\"../models/errors\":92,\"../models/notification-permission\":94,\"../models/token-manager\":95,\"@firebase/util\":134}],88:[function(require,module,exports){\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar controller_interface_1 = require(\"./controller-interface\");\nvar errors_1 = require(\"../models/errors\");\nvar worker_page_message_1 = require(\"../models/worker-page-message\");\nvar fcm_details_1 = require(\"../models/fcm-details\");\nvar FCM_MSG = 'FCM_MSG';\nvar SWController = /** @class */ (function (_super) {\n    __extends(SWController, _super);\n    function SWController(app) {\n        var _this = _super.call(this, app) || this;\n        self.addEventListener('push', function (e) { return _this.onPush_(e); }, false);\n        self.addEventListener('pushsubscriptionchange', function (e) { return _this.onSubChange_(e); }, false);\n        self.addEventListener('notificationclick', function (e) { return _this.onNotificationClick_(e); }, false);\n        /**\n         * @private\n         * @type {function(Object)|null}\n         */\n        _this.bgMessageHandler_ = null;\n        return _this;\n    }\n    /**\n    * A handler for push events that shows notifications based on the content of\n    * the payload.\n    *\n    * The payload must be a JSON-encoded Object with a `notification` key. The\n    * value of the `notification` property will be used as the NotificationOptions\n    * object passed to showNotification. Additionally, the `title` property of the\n    * notification object will be used as the title.\n    *\n    * If there is no notification data in the payload then no notification will be\n    * shown.\n    * @private\n    */\n    SWController.prototype.onPush_ = function (event) {\n        var _this = this;\n        var msgPayload;\n        try {\n            msgPayload = event.data.json();\n        }\n        catch (err) {\n            // Not JSON so not an FCM message\n            return;\n        }\n        var handleMsgPromise = this.hasVisibleClients_().then(function (hasVisibleClients) {\n            if (hasVisibleClients) {\n                // Do not need to show a notification.\n                if (msgPayload.notification || _this.bgMessageHandler_) {\n                    // Send to page\n                    return _this.sendMessageToWindowClients_(msgPayload);\n                }\n                return;\n            }\n            var notificationDetails = _this.getNotificationData_(msgPayload);\n            if (notificationDetails) {\n                var notificationTitle = notificationDetails.title || '';\n                return self.registration.showNotification(notificationTitle, notificationDetails);\n            }\n            else if (_this.bgMessageHandler_) {\n                return _this.bgMessageHandler_(msgPayload);\n            }\n        });\n        event.waitUntil(handleMsgPromise);\n    };\n    /**\n    * @private\n    */\n    SWController.prototype.onSubChange_ = function (event) {\n        var _this = this;\n        var promiseChain = this.getToken().then(function (token) {\n            if (!token) {\n                // We can't resubscribe if we don't have an FCM token for this scope.\n                throw _this.errorFactory_.create(errors_1.default.codes.NO_FCM_TOKEN_FOR_RESUBSCRIBE);\n            }\n            var tokenDetails = null;\n            var tokenManager = _this.getTokenManager();\n            return tokenManager\n                .getTokenDetailsFromToken(token)\n                .then(function (details) {\n                tokenDetails = details;\n                if (!tokenDetails) {\n                    throw _this.errorFactory_.create(errors_1.default.codes.INVALID_SAVED_TOKEN);\n                }\n                // Attempt to get a new subscription\n                return self.registration.pushManager.subscribe(fcm_details_1.default.SUBSCRIPTION_OPTIONS);\n            })\n                .then(function (newSubscription) {\n                // Send new subscription to FCM.\n                return tokenManager.subscribeToFCM(tokenDetails.fcmSenderId, newSubscription, tokenDetails.fcmPushSet);\n            })\n                .catch(function (err) {\n                // The best thing we can do is log this to the terminal so\n                // developers might notice the error.\n                return tokenManager.deleteToken(tokenDetails.fcmToken).then(function () {\n                    throw _this.errorFactory_.create(errors_1.default.codes.UNABLE_TO_RESUBSCRIBE, {\n                        message: err\n                    });\n                });\n            });\n        });\n        event.waitUntil(promiseChain);\n    };\n    /**\n    * @private\n    */\n    SWController.prototype.onNotificationClick_ = function (event) {\n        var _this = this;\n        if (!(event.notification &&\n            event.notification.data &&\n            event.notification.data[FCM_MSG])) {\n            // Not an FCM notification, do nothing.\n            return;\n        }\n        // Prevent other listeners from receiving the event\n        event.stopImmediatePropagation();\n        event.notification.close();\n        var msgPayload = event.notification.data[FCM_MSG];\n        var clickAction = msgPayload['notification']['click_action'];\n        if (!clickAction) {\n            // Nothing to do.\n            return;\n        }\n        var promiseChain = this.getWindowClient_(clickAction)\n            .then(function (windowClient) {\n            if (!windowClient) {\n                // Unable to find window client so need to open one.\n                return self.clients.openWindow(clickAction);\n            }\n            return windowClient;\n        })\n            .then(function (windowClient) {\n            if (!windowClient) {\n                // Window Client will not be returned if it's for a third party origin.\n                return;\n            }\n            // Delete notification data from payload before sending to the page.\n            var notificationData = msgPayload['notification'];\n            delete msgPayload['notification'];\n            var internalMsg = worker_page_message_1.default.createNewMsg(worker_page_message_1.default.TYPES_OF_MSG.NOTIFICATION_CLICKED, msgPayload);\n            // Attempt to send a message to the client to handle the data\n            // Is affected by: https://github.com/slightlyoff/ServiceWorker/issues/728\n            return _this.attemptToMessageClient_(windowClient, internalMsg);\n        });\n        event.waitUntil(promiseChain);\n    };\n    /**\n     * @private\n     * @param {Object} msgPayload\n     * @return {NotificationOptions|undefined}\n     */\n    SWController.prototype.getNotificationData_ = function (msgPayload) {\n        if (!msgPayload) {\n            return;\n        }\n        if (typeof msgPayload.notification !== 'object') {\n            return;\n        }\n        var notificationInformation = Object.assign({}, msgPayload.notification);\n        // Put the message payload under FCM_MSG name so we can identify the\n        // notification as being an FCM notification vs a notification from\n        // somewhere else (i.e. normal web push or developer generated\n        // notification).\n        notificationInformation['data'] = (_a = {},\n            _a[FCM_MSG] = msgPayload,\n            _a);\n        return notificationInformation;\n        var _a;\n    };\n    /**\n     * Calling setBackgroundMessageHandler will opt in to some specific\n     * behaviours.\n     * 1.) If a notification doesn't need to be shown due to a window already\n     * being visible, then push messages will be sent to the page.\n     * 2.) If a notification needs to be shown, and the message contains no\n     * notification data this method will be called\n     * and the promise it returns will be passed to event.waitUntil.\n     * If you do not set this callback then all push messages will let and the\n     * developer can handle them in a their own 'push' event callback\n     * @export\n     * @param {function(Object)} callback The callback to be called when a push\n     * message is received and a notification must be shown. The callback will\n     * be given the data from the push message.\n     */\n    SWController.prototype.setBackgroundMessageHandler = function (callback) {\n        if (callback && typeof callback !== 'function') {\n            throw this.errorFactory_.create(errors_1.default.codes.BG_HANDLER_FUNCTION_EXPECTED);\n        }\n        this.bgMessageHandler_ = callback;\n    };\n    /**\n     * @private\n     * @param {string} url The URL to look for when focusing a client.\n     * @return {Object} Returns an existing window client or a newly opened\n     * WindowClient.\n     */\n    SWController.prototype.getWindowClient_ = function (url) {\n        // Use URL to normalize the URL when comparing to windowClients.\n        // This at least handles whether to include trailing slashes or not\n        var parsedURL = new URL(url).href;\n        return self.clients\n            .matchAll({\n            type: 'window',\n            includeUncontrolled: true\n        })\n            .then(function (clientList) {\n            var suitableClient = null;\n            for (var i = 0; i < clientList.length; i++) {\n                var parsedClientUrl = new URL(clientList[i].url).href;\n                if (parsedClientUrl === parsedURL) {\n                    suitableClient = clientList[i];\n                    break;\n                }\n            }\n            if (suitableClient) {\n                suitableClient.focus();\n                return suitableClient;\n            }\n        });\n    };\n    /**\n     * This message will attempt to send the message to a window client.\n     * @private\n     * @param {Object} client The WindowClient to send the message to.\n     * @param {Object} message The message to send to the client.\n     * @returns {Promise} Returns a promise that resolves after sending the\n     * message. This does not guarantee that the message was successfully\n     * received.\n     */\n    SWController.prototype.attemptToMessageClient_ = function (client, message) {\n        var _this = this;\n        return new Promise(function (resolve, reject) {\n            if (!client) {\n                return reject(_this.errorFactory_.create(errors_1.default.codes.NO_WINDOW_CLIENT_TO_MSG));\n            }\n            client.postMessage(message);\n            resolve();\n        });\n    };\n    /**\n     * @private\n     * @returns {Promise<boolean>} If there is currently a visible WindowClient,\n     * this method will resolve to true, otherwise false.\n     */\n    SWController.prototype.hasVisibleClients_ = function () {\n        return self.clients\n            .matchAll({\n            type: 'window',\n            includeUncontrolled: true\n        })\n            .then(function (clientList) {\n            return clientList.some(function (client) { return client.visibilityState === 'visible'; });\n        });\n    };\n    /**\n     * @private\n     * @param {Object} msgPayload The data from the push event that should be sent\n     * to all available pages.\n     * @returns {Promise} Returns a promise that resolves once the message\n     * has been sent to all WindowClients.\n     */\n    SWController.prototype.sendMessageToWindowClients_ = function (msgPayload) {\n        var _this = this;\n        return self.clients\n            .matchAll({\n            type: 'window',\n            includeUncontrolled: true\n        })\n            .then(function (clientList) {\n            var internalMsg = worker_page_message_1.default.createNewMsg(worker_page_message_1.default.TYPES_OF_MSG.PUSH_MSG_RECEIVED, msgPayload);\n            return Promise.all(clientList.map(function (client) {\n                return _this.attemptToMessageClient_(client, internalMsg);\n            }));\n        });\n    };\n    /**\n     * This will register the default service worker and return the registration.\n     * @private\n     * @return {Promise<!ServiceWorkerRegistration>} The service worker\n     * registration to be used for the push service.\n     */\n    SWController.prototype.getSWRegistration_ = function () {\n        return Promise.resolve(self.registration);\n    };\n    return SWController;\n}(controller_interface_1.default));\nexports.default = SWController;\n\n\n\n},{\"../models/errors\":92,\"../models/fcm-details\":93,\"../models/worker-page-message\":96,\"./controller-interface\":87}],89:[function(require,module,exports){\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar controller_interface_1 = require(\"./controller-interface\");\nvar errors_1 = require(\"../models/errors\");\nvar worker_page_message_1 = require(\"../models/worker-page-message\");\nvar default_sw_1 = require(\"../models/default-sw\");\nvar notification_permission_1 = require(\"../models/notification-permission\");\nvar util_1 = require(\"@firebase/util\");\nvar WindowController = /** @class */ (function (_super) {\n    __extends(WindowController, _super);\n    /**\n     * A service that provides a MessagingService instance.\n     * @param {!firebase.app.App} app\n     */\n    function WindowController(app) {\n        var _this = _super.call(this, app) || this;\n        /**\n         * @private\n         * @type {ServiceWorkerRegistration}\n         */\n        _this.registrationToUse_;\n        /**\n         * @private\n         * @type {Promise}\n         */\n        _this.manifestCheckPromise_;\n        /**\n         * @private\n         * @type {firebase.Observer}\n         */\n        _this.messageObserver_ = null;\n        /**\n         * @private {!firebase.Subscribe} The subscribe function to the onMessage\n         * observer.\n         */\n        _this.onMessage_ = util_1.createSubscribe(function (observer) {\n            _this.messageObserver_ = observer;\n        });\n        /**\n         * @private\n         * @type {firebase.Observer}\n         */\n        _this.tokenRefreshObserver_ = null;\n        _this.onTokenRefresh_ = util_1.createSubscribe(function (observer) {\n            _this.tokenRefreshObserver_ = observer;\n        });\n        _this.setupSWMessageListener_();\n        return _this;\n    }\n    /**\n     * This method returns an FCM token if it can be generated.\n     * The return promise will reject if the browser doesn't support\n     * FCM, if permission is denied for notifications or it's not\n     * possible to generate a token.\n     * @export\n     * @return {Promise<string> | Promise<null>} Returns a promise the\n     * resolves to an FCM token or null if permission isn't granted.\n     */\n    WindowController.prototype.getToken = function () {\n        var _this = this;\n        // Check that the required API's are available\n        if (!this.isSupported_()) {\n            return Promise.reject(this.errorFactory_.create(errors_1.default.codes.UNSUPPORTED_BROWSER));\n        }\n        return this.manifestCheck_().then(function () {\n            return _super.prototype.getToken.call(_this);\n        });\n    };\n    /**\n     * The method checks that a manifest is defined and has the correct GCM\n     * sender ID.\n     * @private\n     * @return {Promise} Returns a promise that resolves if the manifest matches\n     * our required sender ID\n     */\n    WindowController.prototype.manifestCheck_ = function () {\n        var _this = this;\n        if (this.manifestCheckPromise_) {\n            return this.manifestCheckPromise_;\n        }\n        var manifestTag = document.querySelector('link[rel=\"manifest\"]');\n        if (!manifestTag) {\n            this.manifestCheckPromise_ = Promise.resolve();\n        }\n        else {\n            this.manifestCheckPromise_ = fetch(manifestTag.href)\n                .then(function (response) {\n                return response.json();\n            })\n                .catch(function () {\n                // If the download or parsing fails allow check.\n                // We only want to error if we KNOW that the gcm_sender_id is incorrect.\n                return Promise.resolve();\n            })\n                .then(function (manifestContent) {\n                if (!manifestContent) {\n                    return;\n                }\n                if (!manifestContent['gcm_sender_id']) {\n                    return;\n                }\n                if (manifestContent['gcm_sender_id'] !== '103953800507') {\n                    throw _this.errorFactory_.create(errors_1.default.codes.INCORRECT_GCM_SENDER_ID);\n                }\n            });\n        }\n        return this.manifestCheckPromise_;\n    };\n    /**\n     * Request permission if it is not currently granted\n     * @export\n     * @returns {Promise} Resolves if the permission was granted, otherwise\n     * rejects\n     */\n    WindowController.prototype.requestPermission = function () {\n        var _this = this;\n        if (Notification.permission === notification_permission_1.default.granted) {\n            return Promise.resolve();\n        }\n        return new Promise(function (resolve, reject) {\n            var managePermissionResult = function (result) {\n                if (result === notification_permission_1.default.granted) {\n                    return resolve();\n                }\n                else if (result === notification_permission_1.default.denied) {\n                    return reject(_this.errorFactory_.create(errors_1.default.codes.PERMISSION_BLOCKED));\n                }\n                else {\n                    return reject(_this.errorFactory_.create(errors_1.default.codes.PERMISSION_DEFAULT));\n                }\n            };\n            // The Notification.requestPermission API was changed to\n            // return a promise so now have to handle both in case\n            // browsers stop support callbacks for promised version\n            var permissionPromise = Notification.requestPermission(function (result) {\n                if (permissionPromise) {\n                    // Let the promise manage this\n                    return;\n                }\n                managePermissionResult(result);\n            });\n            if (permissionPromise) {\n                // Prefer the promise version as it's the future API.\n                permissionPromise.then(managePermissionResult);\n            }\n        });\n    };\n    /**\n     * This method allows a developer to override the default service worker and\n     * instead use a custom service worker.\n     * @export\n     * @param {!ServiceWorkerRegistration} registration The service worker\n     * registration that should be used to receive the push messages.\n     */\n    WindowController.prototype.useServiceWorker = function (registration) {\n        if (!(registration instanceof ServiceWorkerRegistration)) {\n            throw this.errorFactory_.create(errors_1.default.codes.SW_REGISTRATION_EXPECTED);\n        }\n        if (typeof this.registrationToUse_ !== 'undefined') {\n            throw this.errorFactory_.create(errors_1.default.codes.USE_SW_BEFORE_GET_TOKEN);\n        }\n        this.registrationToUse_ = registration;\n    };\n    /**\n     * @export\n     * @param {!firebase.Observer|function(*)} nextOrObserver An observer object\n     * or a function triggered on message.\n     * @param {function(!Error)=} optError Optional A function triggered on\n     * message error.\n     * @param {function()=} optCompleted Optional function triggered when the\n     * observer is removed.\n     * @return {!function()} The unsubscribe function for the observer.\n     */\n    WindowController.prototype.onMessage = function (nextOrObserver, optError, optCompleted) {\n        return this.onMessage_(nextOrObserver, optError, optCompleted);\n    };\n    /**\n     * @export\n     * @param {!firebase.Observer|function()} nextOrObserver An observer object\n     * or a function triggered on token refresh.\n     * @param {function(!Error)=} optError Optional A function\n     * triggered on token refresh error.\n     * @param {function()=} optCompleted Optional function triggered when the\n     * observer is removed.\n     * @return {!function()} The unsubscribe function for the observer.\n     */\n    WindowController.prototype.onTokenRefresh = function (nextOrObserver, optError, optCompleted) {\n        return this.onTokenRefresh_(nextOrObserver, optError, optCompleted);\n    };\n    /**\n     * Given a registration, wait for the service worker it relates to\n     * become activer\n     * @private\n     * @param  {ServiceWorkerRegistration} registration Registration to wait\n     * for service worker to become active\n     * @return {Promise<!ServiceWorkerRegistration>} Wait for service worker\n     * registration to become active\n     */\n    WindowController.prototype.waitForRegistrationToActivate_ = function (registration) {\n        var _this = this;\n        var serviceWorker = registration.installing || registration.waiting || registration.active;\n        return new Promise(function (resolve, reject) {\n            if (!serviceWorker) {\n                // This is a rare scenario but has occured in firefox\n                reject(_this.errorFactory_.create(errors_1.default.codes.NO_SW_IN_REG));\n                return;\n            }\n            // Because the Promise function is called on next tick there is a\n            // small chance that the worker became active or redundant already.\n            if (serviceWorker.state === 'activated') {\n                resolve(registration);\n                return;\n            }\n            if (serviceWorker.state === 'redundant') {\n                reject(_this.errorFactory_.create(errors_1.default.codes.SW_REG_REDUNDANT));\n                return;\n            }\n            var stateChangeListener = function () {\n                if (serviceWorker.state === 'activated') {\n                    resolve(registration);\n                }\n                else if (serviceWorker.state === 'redundant') {\n                    reject(_this.errorFactory_.create(errors_1.default.codes.SW_REG_REDUNDANT));\n                }\n                else {\n                    // Return early and wait to next state change\n                    return;\n                }\n                serviceWorker.removeEventListener('statechange', stateChangeListener);\n            };\n            serviceWorker.addEventListener('statechange', stateChangeListener);\n        });\n    };\n    /**\n     * This will regiater the default service worker and return the registration\n     * @private\n     * @return {Promise<!ServiceWorkerRegistration>} The service worker\n     * registration to be used for the push service.\n     */\n    WindowController.prototype.getSWRegistration_ = function () {\n        var _this = this;\n        if (this.registrationToUse_) {\n            return this.waitForRegistrationToActivate_(this.registrationToUse_);\n        }\n        // Make the registration null so we know useServiceWorker will not\n        // use a new service worker as registrationToUse_ is no longer undefined\n        this.registrationToUse_ = null;\n        return navigator.serviceWorker\n            .register(default_sw_1.default.path, {\n            scope: default_sw_1.default.scope\n        })\n            .catch(function (err) {\n            throw _this.errorFactory_.create(errors_1.default.codes.FAILED_DEFAULT_REGISTRATION, {\n                browserErrorMessage: err.message\n            });\n        })\n            .then(function (registration) {\n            return _this.waitForRegistrationToActivate_(registration).then(function () {\n                _this.registrationToUse_ = registration;\n                // We update after activation due to an issue with Firefox v49 where\n                // a race condition occassionally causes the service work to not\n                // install\n                registration.update();\n                return registration;\n            });\n        });\n    };\n    /**\n     * This method will set up a message listener to handle\n     * events from the service worker that should trigger\n     * events in the page.\n     *\n     * @private\n     */\n    WindowController.prototype.setupSWMessageListener_ = function () {\n        var _this = this;\n        if (!('serviceWorker' in navigator)) {\n            return;\n        }\n        navigator.serviceWorker.addEventListener('message', function (event) {\n            if (!event.data || !event.data[worker_page_message_1.default.PARAMS.TYPE_OF_MSG]) {\n                // Not a message from FCM\n                return;\n            }\n            var workerPageMessage = event.data;\n            switch (workerPageMessage[worker_page_message_1.default.PARAMS.TYPE_OF_MSG]) {\n                case worker_page_message_1.default.TYPES_OF_MSG.PUSH_MSG_RECEIVED:\n                case worker_page_message_1.default.TYPES_OF_MSG.NOTIFICATION_CLICKED:\n                    var pushMessage = workerPageMessage[worker_page_message_1.default.PARAMS.DATA];\n                    _this.messageObserver_.next(pushMessage);\n                    break;\n                default:\n                    // Noop.\n                    break;\n            }\n        }, false);\n    };\n    /**\n     * Checks to see if the required API's are valid or not.\n     * @private\n     * @return {boolean} Returns true if the desired APIs are available.\n     */\n    WindowController.prototype.isSupported_ = function () {\n        return ('serviceWorker' in navigator &&\n            'PushManager' in window &&\n            'Notification' in window &&\n            'fetch' in window &&\n            ServiceWorkerRegistration.prototype.hasOwnProperty('showNotification') &&\n            PushSubscription.prototype.hasOwnProperty('getKey'));\n    };\n    return WindowController;\n}(controller_interface_1.default));\nexports.default = WindowController;\n\n\n\n},{\"../models/default-sw\":91,\"../models/errors\":92,\"../models/notification-permission\":94,\"../models/worker-page-message\":96,\"./controller-interface\":87,\"@firebase/util\":134}],90:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nfunction toBase64(arrayBuffer) {\n    var uint8Version = new Uint8Array(arrayBuffer);\n    return window.btoa(String.fromCharCode.apply(null, uint8Version));\n}\nexports.default = function (arrayBuffer) {\n    var base64String = toBase64(arrayBuffer);\n    return base64String\n        .replace(/=/g, '')\n        .replace(/\\+/g, '-')\n        .replace(/\\//g, '_');\n};\n\n\n\n},{}],91:[function(require,module,exports){\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = {\n    path: '/firebase-messaging-sw.js',\n    scope: '/firebase-cloud-messaging-push-scope'\n};\n\n\n\n},{}],92:[function(require,module,exports){\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar CODES = {\n    AVAILABLE_IN_WINDOW: 'only-available-in-window',\n    AVAILABLE_IN_SW: 'only-available-in-sw',\n    SHOULD_BE_INHERITED: 'should-be-overriden',\n    BAD_SENDER_ID: 'bad-sender-id',\n    INCORRECT_GCM_SENDER_ID: 'incorrect-gcm-sender-id',\n    PERMISSION_DEFAULT: 'permission-default',\n    PERMISSION_BLOCKED: 'permission-blocked',\n    UNSUPPORTED_BROWSER: 'unsupported-browser',\n    NOTIFICATIONS_BLOCKED: 'notifications-blocked',\n    FAILED_DEFAULT_REGISTRATION: 'failed-serviceworker-registration',\n    SW_REGISTRATION_EXPECTED: 'sw-registration-expected',\n    GET_SUBSCRIPTION_FAILED: 'get-subscription-failed',\n    INVALID_SAVED_TOKEN: 'invalid-saved-token',\n    SW_REG_REDUNDANT: 'sw-reg-redundant',\n    TOKEN_SUBSCRIBE_FAILED: 'token-subscribe-failed',\n    TOKEN_SUBSCRIBE_NO_TOKEN: 'token-subscribe-no-token',\n    TOKEN_SUBSCRIBE_NO_PUSH_SET: 'token-subscribe-no-push-set',\n    USE_SW_BEFORE_GET_TOKEN: 'use-sw-before-get-token',\n    INVALID_DELETE_TOKEN: 'invalid-delete-token',\n    DELETE_TOKEN_NOT_FOUND: 'delete-token-not-found',\n    DELETE_SCOPE_NOT_FOUND: 'delete-scope-not-found',\n    BG_HANDLER_FUNCTION_EXPECTED: 'bg-handler-function-expected',\n    NO_WINDOW_CLIENT_TO_MSG: 'no-window-client-to-msg',\n    UNABLE_TO_RESUBSCRIBE: 'unable-to-resubscribe',\n    NO_FCM_TOKEN_FOR_RESUBSCRIBE: 'no-fcm-token-for-resubscribe',\n    FAILED_TO_DELETE_TOKEN: 'failed-to-delete-token',\n    NO_SW_IN_REG: 'no-sw-in-reg',\n    BAD_SCOPE: 'bad-scope',\n    BAD_VAPID_KEY: 'bad-vapid-key',\n    BAD_SUBSCRIPTION: 'bad-subscription',\n    BAD_TOKEN: 'bad-token',\n    BAD_PUSH_SET: 'bad-push-set',\n    FAILED_DELETE_VAPID_KEY: 'failed-delete-vapid-key'\n};\nvar ERROR_MAP = (_a = {},\n    _a[CODES.AVAILABLE_IN_WINDOW] = 'This method is available in a Window context.',\n    _a[CODES.AVAILABLE_IN_SW] = 'This method is available in a service worker ' + 'context.',\n    _a[CODES.SHOULD_BE_INHERITED] = 'This method should be overriden by ' + 'extended classes.',\n    _a[CODES.BAD_SENDER_ID] = \"Please ensure that 'messagingSenderId' is set \" +\n        'correctly in the options passed into firebase.initializeApp().',\n    _a[CODES.PERMISSION_DEFAULT] = 'The required permissions were not granted and ' + 'dismissed instead.',\n    _a[CODES.PERMISSION_BLOCKED] = 'The required permissions were not granted and ' + 'blocked instead.',\n    _a[CODES.UNSUPPORTED_BROWSER] = \"This browser doesn't support the API's \" +\n        'required to use the firebase SDK.',\n    _a[CODES.NOTIFICATIONS_BLOCKED] = 'Notifications have been blocked.',\n    _a[CODES.FAILED_DEFAULT_REGISTRATION] = 'We are unable to register the ' +\n        'default service worker. {$browserErrorMessage}',\n    _a[CODES.SW_REGISTRATION_EXPECTED] = 'A service worker registration was the ' + 'expected input.',\n    _a[CODES.GET_SUBSCRIPTION_FAILED] = 'There was an error when trying to get ' +\n        'any existing Push Subscriptions.',\n    _a[CODES.INVALID_SAVED_TOKEN] = 'Unable to access details of the saved token.',\n    _a[CODES.SW_REG_REDUNDANT] = 'The service worker being used for push was made ' + 'redundant.',\n    _a[CODES.TOKEN_SUBSCRIBE_FAILED] = 'A problem occured while subscribing the ' + 'user to FCM: {$message}',\n    _a[CODES.TOKEN_SUBSCRIBE_NO_TOKEN] = 'FCM returned no token when subscribing ' + 'the user to push.',\n    _a[CODES.TOKEN_SUBSCRIBE_NO_PUSH_SET] = 'FCM returned an invalid response ' + 'when getting an FCM token.',\n    _a[CODES.USE_SW_BEFORE_GET_TOKEN] = 'You must call useServiceWorker() before ' +\n        'calling getToken() to ensure your service worker is used.',\n    _a[CODES.INVALID_DELETE_TOKEN] = 'You must pass a valid token into ' +\n        'deleteToken(), i.e. the token from getToken().',\n    _a[CODES.DELETE_TOKEN_NOT_FOUND] = 'The deletion attempt for token could not ' +\n        'be performed as the token was not found.',\n    _a[CODES.DELETE_SCOPE_NOT_FOUND] = 'The deletion attempt for service worker ' +\n        'scope could not be performed as the scope was not found.',\n    _a[CODES.BG_HANDLER_FUNCTION_EXPECTED] = 'The input to ' + 'setBackgroundMessageHandler() must be a function.',\n    _a[CODES.NO_WINDOW_CLIENT_TO_MSG] = 'An attempt was made to message a ' + 'non-existant window client.',\n    _a[CODES.UNABLE_TO_RESUBSCRIBE] = 'There was an error while re-subscribing ' +\n        'the FCM token for push messaging. Will have to resubscribe the ' +\n        'user on next visit. {$message}',\n    _a[CODES.NO_FCM_TOKEN_FOR_RESUBSCRIBE] = 'Could not find an FCM token ' +\n        'and as a result, unable to resubscribe. Will have to resubscribe the ' +\n        'user on next visit.',\n    _a[CODES.FAILED_TO_DELETE_TOKEN] = 'Unable to delete the currently saved token.',\n    _a[CODES.NO_SW_IN_REG] = 'Even though the service worker registration was ' +\n        'successful, there was a problem accessing the service worker itself.',\n    _a[CODES.INCORRECT_GCM_SENDER_ID] = \"Please change your web app manifest's \" +\n        \"'gcm_sender_id' value to '103953800507' to use Firebase messaging.\",\n    _a[CODES.BAD_SCOPE] = 'The service worker scope must be a string with at ' +\n        'least one character.',\n    _a[CODES.BAD_VAPID_KEY] = 'The public VAPID key must be a string with at ' + 'least one character.',\n    _a[CODES.BAD_SUBSCRIPTION] = 'The subscription must be a valid ' + 'PushSubscription.',\n    _a[CODES.BAD_TOKEN] = 'The FCM Token used for storage / lookup was not ' +\n        'a valid token string.',\n    _a[CODES.BAD_PUSH_SET] = 'The FCM push set used for storage / lookup was not ' +\n        'not a valid push set string.',\n    _a[CODES.FAILED_DELETE_VAPID_KEY] = 'The VAPID key could not be deleted.',\n    _a);\nexports.default = {\n    codes: CODES,\n    map: ERROR_MAP\n};\nvar _a;\n\n\n\n},{}],93:[function(require,module,exports){\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar FCM_APPLICATION_SERVER_KEY = [\n    0x04,\n    0x33,\n    0x94,\n    0xf7,\n    0xdf,\n    0xa1,\n    0xeb,\n    0xb1,\n    0xdc,\n    0x03,\n    0xa2,\n    0x5e,\n    0x15,\n    0x71,\n    0xdb,\n    0x48,\n    0xd3,\n    0x2e,\n    0xed,\n    0xed,\n    0xb2,\n    0x34,\n    0xdb,\n    0xb7,\n    0x47,\n    0x3a,\n    0x0c,\n    0x8f,\n    0xc4,\n    0xcc,\n    0xe1,\n    0x6f,\n    0x3c,\n    0x8c,\n    0x84,\n    0xdf,\n    0xab,\n    0xb6,\n    0x66,\n    0x3e,\n    0xf2,\n    0x0c,\n    0xd4,\n    0x8b,\n    0xfe,\n    0xe3,\n    0xf9,\n    0x76,\n    0x2f,\n    0x14,\n    0x1c,\n    0x63,\n    0x08,\n    0x6a,\n    0x6f,\n    0x2d,\n    0xb1,\n    0x1a,\n    0x95,\n    0xb0,\n    0xce,\n    0x37,\n    0xc0,\n    0x9c,\n    0x6e\n];\nvar SUBSCRIPTION_DETAILS = {\n    userVisibleOnly: true,\n    applicationServerKey: new Uint8Array(FCM_APPLICATION_SERVER_KEY)\n};\nexports.default = {\n    ENDPOINT: 'https://fcm.googleapis.com',\n    APPLICATION_SERVER_KEY: FCM_APPLICATION_SERVER_KEY,\n    SUBSCRIPTION_OPTIONS: SUBSCRIPTION_DETAILS\n};\n\n\n\n},{}],94:[function(require,module,exports){\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = {\n    granted: 'granted',\n    default: 'default',\n    denied: 'denied'\n};\n\n\n\n},{}],95:[function(require,module,exports){\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\nvar errors_1 = require(\"./errors\");\nvar array_buffer_to_base64_1 = require(\"../helpers/array-buffer-to-base64\");\nvar fcm_details_1 = require(\"./fcm-details\");\nvar FCM_TOKEN_OBJ_STORE = 'fcm_token_object_Store';\nvar FCM_TOKEN_DETAILS_DB_VERSION = 1;\nvar TokenManager = /** @class */ (function () {\n    function TokenManager() {\n        this.errorFactory_ = new util_1.ErrorFactory('messaging', 'Messaging', errors_1.default.map);\n        this.openDbPromise_ = null;\n    }\n    /**\n     * Get the indexedDB as a promsie.\n     * @private\n     * @return {Promise<IDBDatabase>} The IndexedDB database\n     */\n    TokenManager.prototype.openDatabase_ = function () {\n        if (this.openDbPromise_) {\n            return this.openDbPromise_;\n        }\n        this.openDbPromise_ = new Promise(function (resolve, reject) {\n            var request = indexedDB.open(TokenManager.DB_NAME, FCM_TOKEN_DETAILS_DB_VERSION);\n            request.onerror = function (event) {\n                reject(event.target.error);\n            };\n            request.onsuccess = function (event) {\n                resolve(event.target.result);\n            };\n            request.onupgradeneeded = function (event) {\n                var db = event.target.result;\n                var objectStore = db.createObjectStore(FCM_TOKEN_OBJ_STORE, {\n                    keyPath: 'swScope'\n                });\n                // Make sure the sender ID can be searched\n                objectStore.createIndex('fcmSenderId', 'fcmSenderId', {\n                    unique: false\n                });\n                objectStore.createIndex('fcmToken', 'fcmToken', {\n                    unique: true\n                });\n            };\n        });\n        return this.openDbPromise_;\n    };\n    /**\n     * Close the currently open database.\n     * @return {Promise<?>} Returns the result of the promise chain.\n     */\n    TokenManager.prototype.closeDatabase = function () {\n        var _this = this;\n        if (this.openDbPromise_) {\n            return this.openDbPromise_.then(function (db) {\n                db.close();\n                _this.openDbPromise_ = null;\n            });\n        }\n        return Promise.resolve();\n    };\n    /**\n     * Given a token, this method will look up the details in indexedDB.\n     * @public\n     * @param {string} fcmToken\n     * @return {Promise<Object>} The details associated with that token.\n     */\n    TokenManager.prototype.getTokenDetailsFromToken = function (fcmToken) {\n        return this.openDatabase_().then(function (db) {\n            return new Promise(function (resolve, reject) {\n                var transaction = db.transaction([FCM_TOKEN_OBJ_STORE]);\n                var objectStore = transaction.objectStore(FCM_TOKEN_OBJ_STORE);\n                var index = objectStore.index('fcmToken');\n                var request = index.get(fcmToken);\n                request.onerror = function (event) {\n                    reject(event.target.error);\n                };\n                request.onsuccess = function (event) {\n                    resolve(event.target.result);\n                };\n            });\n        });\n    };\n    TokenManager.prototype.getTokenDetailsFromSWScope_ = function (swScope) {\n        return this.openDatabase_().then(function (db) {\n            return new Promise(function (resolve, reject) {\n                var transaction = db.transaction([FCM_TOKEN_OBJ_STORE]);\n                var objectStore = transaction.objectStore(FCM_TOKEN_OBJ_STORE);\n                var scopeRequest = objectStore.get(swScope);\n                scopeRequest.onerror = function (event) {\n                    reject(event.target.error);\n                };\n                scopeRequest.onsuccess = function (event) {\n                    resolve(event.target.result);\n                };\n            });\n        });\n    };\n    TokenManager.prototype.getAllTokenDetailsForSenderId_ = function (senderId) {\n        return this.openDatabase_().then(function (db) {\n            return new Promise(function (resolve, reject) {\n                var transaction = db.transaction([FCM_TOKEN_OBJ_STORE]);\n                var objectStore = transaction.objectStore(FCM_TOKEN_OBJ_STORE);\n                var senderIdTokens = [];\n                var cursorRequest = objectStore.openCursor();\n                cursorRequest.onerror = function (event) {\n                    reject(event.target.error);\n                };\n                cursorRequest.onsuccess = function (event) {\n                    var cursor = event.target.result;\n                    if (cursor) {\n                        if (cursor.value['fcmSenderId'] === senderId) {\n                            senderIdTokens.push(cursor.value);\n                        }\n                        cursor.continue();\n                    }\n                    else {\n                        resolve(senderIdTokens);\n                    }\n                };\n            });\n        });\n    };\n    /**\n     * Given a PushSubscription and messagingSenderId, get an FCM token.\n     * @public\n     * @param  {string} senderId The 'messagingSenderId' to tie the token to.\n     * @param  {PushSubscription} subscription The PushSusbcription to \"federate\".\n     * @param  {string=} pushSet If defined this will swap the subscription for\n     * matching FCM token.\n     * @return {Promise<!Object>} Returns the FCM token to be used in place\n     * of the PushSubscription.\n     */\n    TokenManager.prototype.subscribeToFCM = function (senderId, subscription, pushSet) {\n        var _this = this;\n        var p256dh = array_buffer_to_base64_1.default(subscription['getKey']('p256dh'));\n        var auth = array_buffer_to_base64_1.default(subscription['getKey']('auth'));\n        var fcmSubscribeBody = \"authorized_entity=\" + senderId + \"&\" +\n            (\"endpoint=\" + subscription.endpoint + \"&\") +\n            (\"encryption_key=\" + p256dh + \"&\") +\n            (\"encryption_auth=\" + auth);\n        if (pushSet) {\n            fcmSubscribeBody += \"&pushSet=\" + pushSet;\n        }\n        var headers = new Headers();\n        headers.append('Content-Type', 'application/x-www-form-urlencoded');\n        var subscribeOptions = {\n            method: 'POST',\n            headers: headers,\n            body: fcmSubscribeBody\n        };\n        return fetch(fcm_details_1.default.ENDPOINT + '/fcm/connect/subscribe', subscribeOptions)\n            .then(function (response) { return response.json(); })\n            .then(function (response) {\n            var fcmTokenResponse = response;\n            if (fcmTokenResponse['error']) {\n                var message = fcmTokenResponse['error']['message'];\n                throw _this.errorFactory_.create(errors_1.default.codes.TOKEN_SUBSCRIBE_FAILED, {\n                    message: message\n                });\n            }\n            if (!fcmTokenResponse['token']) {\n                throw _this.errorFactory_.create(errors_1.default.codes.TOKEN_SUBSCRIBE_NO_TOKEN);\n            }\n            if (!fcmTokenResponse['pushSet']) {\n                throw _this.errorFactory_.create(errors_1.default.codes.TOKEN_SUBSCRIBE_NO_PUSH_SET);\n            }\n            return {\n                token: fcmTokenResponse['token'],\n                pushSet: fcmTokenResponse['pushSet']\n            };\n        });\n    };\n    /**\n     * Checks the that fields in the PushSubscription are equivalent to the\n     * details stores in the masterTokenDetails.\n     * @private\n     * @param  {PushSubscription} subscription The push subscription we expect\n     * the master token to match.\n     * @param  {Object}  masterTokenDetails The saved details we wish to compare\n     * with the PushSubscription\n     * @return {boolean} true if the subscription and token details are\n     * equivalent.\n     */\n    TokenManager.prototype.isSameSubscription_ = function (subscription, masterTokenDetails) {\n        // getKey() isn't defined in the PushSubscription externs file, hence\n        // subscription['getKey']('<key name>').\n        return (subscription.endpoint === masterTokenDetails['endpoint'] &&\n            array_buffer_to_base64_1.default(subscription['getKey']('auth')) ===\n                masterTokenDetails['auth'] &&\n            array_buffer_to_base64_1.default(subscription['getKey']('p256dh')) ===\n                masterTokenDetails['p256dh']);\n    };\n    /**\n     * Save the details for the fcm token for re-use at a later date.\n     * @private\n     * @param  {string} senderId The 'messagingSenderId' used for this project\n     * @param  {ServiceWorkerRegistration} swRegistration The service worker\n     * used to subscribe the user for web push\n     * @param  {PushSubscription} subscription The push subscription passed to\n     * FCM for the current token.\n     * @param  {string} fcmToken The FCM token currently used on this\n     * device.\n     * @param  {string} fcmPushSet The FCM push tied to the fcm token.\n     * @return {Promise<void>}\n     */\n    TokenManager.prototype.saveTokenDetails_ = function (senderId, swRegistration, subscription, fcmToken, fcmPushSet) {\n        var details = {\n            swScope: swRegistration.scope,\n            endpoint: subscription.endpoint,\n            auth: array_buffer_to_base64_1.default(subscription['getKey']('auth')),\n            p256dh: array_buffer_to_base64_1.default(subscription['getKey']('p256dh')),\n            fcmToken: fcmToken,\n            fcmPushSet: fcmPushSet,\n            fcmSenderId: senderId\n        };\n        return this.openDatabase_().then(function (db) {\n            return new Promise(function (resolve, reject) {\n                var transaction = db.transaction([FCM_TOKEN_OBJ_STORE], 'readwrite');\n                var objectStore = transaction.objectStore(FCM_TOKEN_OBJ_STORE);\n                var request = objectStore.put(details);\n                request.onerror = function (event) {\n                    reject(event.target.error);\n                };\n                request.onsuccess = function (event) {\n                    resolve();\n                };\n            });\n        });\n    };\n    /**\n     * Returns the saved FCM Token if one is available and still valid,\n     * otherwise `null` is returned.\n     * @param {string} senderId This should be the sender ID associated with the\n     * FCM Token being retrieved.\n     * @param {ServiceWorkerRegistration} swRegistration Registration to be used\n     * to subscribe the user to push.\n     * @return {Promise<string> | Promise} Returns the saved FCM Token if\n     * avilable and valid.\n     * @export\n     */\n    TokenManager.prototype.getSavedToken = function (senderId, swRegistration) {\n        var _this = this;\n        if (!(swRegistration instanceof ServiceWorkerRegistration)) {\n            return Promise.reject(this.errorFactory_.create(errors_1.default.codes.SW_REGISTRATION_EXPECTED));\n        }\n        if (typeof senderId !== 'string' || senderId.length === 0) {\n            return Promise.reject(this.errorFactory_.create(errors_1.default.codes.BAD_SENDER_ID));\n        }\n        return this.getAllTokenDetailsForSenderId_(senderId)\n            .then(function (allTokenDetails) {\n            if (allTokenDetails.length === 0) {\n                return;\n            }\n            var index = allTokenDetails.findIndex(function (tokenDetails) {\n                return (swRegistration.scope === tokenDetails['swScope'] &&\n                    senderId === tokenDetails['fcmSenderId']);\n            });\n            if (index === -1) {\n                return;\n            }\n            return allTokenDetails[index];\n        })\n            .then(function (tokenDetails) {\n            if (!tokenDetails) {\n                return;\n            }\n            return swRegistration.pushManager\n                .getSubscription()\n                .catch(function (err) {\n                throw _this.errorFactory_.create(errors_1.default.codes.GET_SUBSCRIPTION_FAILED);\n            })\n                .then(function (subscription) {\n                if (subscription &&\n                    _this.isSameSubscription_(subscription, tokenDetails)) {\n                    return tokenDetails['fcmToken'];\n                }\n            });\n        });\n    };\n    /**\n     * Creates a new FCM token.\n     */\n    TokenManager.prototype.createToken = function (senderId, swRegistration) {\n        var _this = this;\n        if (typeof senderId !== 'string' || senderId.length === 0) {\n            return Promise.reject(this.errorFactory_.create(errors_1.default.codes.BAD_SENDER_ID));\n        }\n        if (!(swRegistration instanceof ServiceWorkerRegistration)) {\n            return Promise.reject(this.errorFactory_.create(errors_1.default.codes.SW_REGISTRATION_EXPECTED));\n        }\n        // Check for existing subscription first\n        var subscription;\n        var fcmTokenDetails;\n        return swRegistration.pushManager\n            .getSubscription()\n            .then(function (subscription) {\n            if (subscription) {\n                return subscription;\n            }\n            return swRegistration.pushManager.subscribe(fcm_details_1.default.SUBSCRIPTION_OPTIONS);\n        })\n            .then(function (sub) {\n            subscription = sub;\n            return _this.subscribeToFCM(senderId, subscription);\n        })\n            .then(function (tokenDetails) {\n            fcmTokenDetails = tokenDetails;\n            return _this.saveTokenDetails_(senderId, swRegistration, subscription, fcmTokenDetails['token'], fcmTokenDetails['pushSet']);\n        })\n            .then(function () { return fcmTokenDetails['token']; });\n    };\n    /**\n     * This method deletes details of the current FCM token.\n     * It's returning a promise in case we need to move to an async\n     * method for deleting at a later date.\n     * @param {string} token Token to be deleted\n     * @return {Promise<Object>} Resolves once the FCM token details have been\n     * deleted and returns the deleted details.\n     */\n    TokenManager.prototype.deleteToken = function (token) {\n        var _this = this;\n        if (typeof token !== 'string' || token.length === 0) {\n            return Promise.reject(this.errorFactory_.create(errors_1.default.codes.INVALID_DELETE_TOKEN));\n        }\n        return this.getTokenDetailsFromToken(token).then(function (details) {\n            if (!details) {\n                throw _this.errorFactory_.create(errors_1.default.codes.DELETE_TOKEN_NOT_FOUND);\n            }\n            return _this.openDatabase_().then(function (db) {\n                return new Promise(function (resolve, reject) {\n                    var transaction = db.transaction([FCM_TOKEN_OBJ_STORE], 'readwrite');\n                    var objectStore = transaction.objectStore(FCM_TOKEN_OBJ_STORE);\n                    var request = objectStore.delete(details['swScope']);\n                    request.onerror = function (event) {\n                        reject(event.target.error);\n                    };\n                    request.onsuccess = function (event) {\n                        if (event.target.result === 0) {\n                            reject(_this.errorFactory_.create(errors_1.default.codes.FAILED_TO_DELETE_TOKEN));\n                            return;\n                        }\n                        resolve(details);\n                    };\n                });\n            });\n        });\n    };\n    return TokenManager;\n}());\nexports.default = TokenManager;\n\n\n\n},{\"../helpers/array-buffer-to-base64\":90,\"./errors\":92,\"./fcm-details\":93,\"@firebase/util\":134}],96:[function(require,module,exports){\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// These fields are strings to prevent closure from thinking goog.getMsg\n// should be used to initialise the values\nvar PARAMS = {\n    TYPE_OF_MSG: 'firebase-messaging-msg-type',\n    DATA: 'firebase-messaging-msg-data'\n};\n// This value isn't using the TYPE_OF_MSG short hand as closure\n// expects the variable to be defined via goog.getMsg\nvar msgType = {\n    PUSH_MSG_RECEIVED: 'push-msg-received',\n    NOTIFICATION_CLICKED: 'notification-clicked'\n};\nvar createNewMsg = function (msgType, msgData) {\n    var message = (_a = {},\n        _a[PARAMS.TYPE_OF_MSG] = msgType,\n        _a[PARAMS.DATA] = msgData,\n        _a);\n    return message;\n    var _a;\n};\nexports.default = {\n    PARAMS: PARAMS,\n    TYPES_OF_MSG: msgType,\n    createNewMsg: createNewMsg\n};\n\n\n\n},{}],97:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nrequire(\"./src/polyfills/promise\");\nrequire(\"./src/shims/find\");\nrequire(\"./src/shims/findIndex\");\n\n\n\n},{\"./src/polyfills/promise\":98,\"./src/shims/find\":99,\"./src/shims/findIndex\":100}],98:[function(require,module,exports){\n(function (global){\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __global = (function () {\n    if (typeof global !== 'undefined') {\n        return global;\n    }\n    if (typeof window !== 'undefined') {\n        return window;\n    }\n    if (typeof self !== 'undefined') {\n        return self;\n    }\n    throw new Error('unable to locate global object');\n})();\n// Polyfill Promise\nif (typeof Promise === 'undefined') {\n    // HACK: TS throws an error if I attempt to use 'dot-notation'\n    __global['Promise'] = Promise = require('promise-polyfill');\n}\n\n\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n\n},{\"promise-polyfill\":158}],99:[function(require,module,exports){\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * This is the Array.prototype.find polyfill from MDN\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/find\n * https://tc39.github.io/ecma262/#sec-array.prototype.find\n */\nif (!Array.prototype.find) {\n    Object.defineProperty(Array.prototype, 'find', {\n        value: function (predicate) {\n            // 1. Let O be ? ToObject(this value).\n            if (this == null) {\n                throw new TypeError('\"this\" is null or not defined');\n            }\n            var o = Object(this);\n            // 2. Let len be ? ToLength(? Get(O, \"length\")).\n            var len = o.length >>> 0;\n            // 3. If IsCallable(predicate) is false, throw a TypeError exception.\n            if (typeof predicate !== 'function') {\n                throw new TypeError('predicate must be a function');\n            }\n            // 4. If thisArg was supplied, let T be thisArg; else let T be undefined.\n            var thisArg = arguments[1];\n            // 5. Let k be 0.\n            var k = 0;\n            // 6. Repeat, while k < len\n            while (k < len) {\n                // a. Let Pk be ! ToString(k).\n                // b. Let kValue be ? Get(O, Pk).\n                // c. Let testResult be ToBoolean(? Call(predicate, T, « kValue, k, O »)).\n                // d. If testResult is true, return kValue.\n                var kValue = o[k];\n                if (predicate.call(thisArg, kValue, k, o)) {\n                    return kValue;\n                }\n                // e. Increase k by 1.\n                k++;\n            }\n            // 7. Return undefined.\n            return undefined;\n        }\n    });\n}\n\n\n\n},{}],100:[function(require,module,exports){\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * This is the Array.prototype.findIndex polyfill from MDN\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/findIndex\n * https://tc39.github.io/ecma262/#sec-array.prototype.findIndex\n */\nif (!Array.prototype.findIndex) {\n    Object.defineProperty(Array.prototype, 'findIndex', {\n        value: function (predicate) {\n            // 1. Let O be ? ToObject(this value).\n            if (this == null) {\n                throw new TypeError('\"this\" is null or not defined');\n            }\n            var o = Object(this);\n            // 2. Let len be ? ToLength(? Get(O, \"length\")).\n            var len = o.length >>> 0;\n            // 3. If IsCallable(predicate) is false, throw a TypeError exception.\n            if (typeof predicate !== 'function') {\n                throw new TypeError('predicate must be a function');\n            }\n            // 4. If thisArg was supplied, let T be thisArg; else let T be undefined.\n            var thisArg = arguments[1];\n            // 5. Let k be 0.\n            var k = 0;\n            // 6. Repeat, while k < len\n            while (k < len) {\n                // a. Let Pk be ! ToString(k).\n                // b. Let kValue be ? Get(O, Pk).\n                // c. Let testResult be ToBoolean(? Call(predicate, T, « kValue, k, O »)).\n                // d. If testResult is true, return k.\n                var kValue = o[k];\n                if (predicate.call(thisArg, kValue, k, o)) {\n                    return k;\n                }\n                // e. Increase k by 1.\n                k++;\n            }\n            // 7. Return -1.\n            return -1;\n        }\n    });\n}\n\n\n\n},{}],101:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar app_1 = require(\"@firebase/app\");\nvar string_1 = require(\"./src/implementation/string\");\nvar taskenums_1 = require(\"./src/implementation/taskenums\");\nvar taskenums_2 = require(\"./src/implementation/taskenums\");\nvar xhriopool_1 = require(\"./src/implementation/xhriopool\");\nvar reference_1 = require(\"./src/reference\");\nvar service_1 = require(\"./src/service\");\n/**\n * Type constant for Firebase Storage.\n */\nvar STORAGE_TYPE = 'storage';\nfunction factory(app, unused, opt_url) {\n    return new service_1.Service(app, new xhriopool_1.XhrIoPool(), opt_url);\n}\nfunction registerStorage(instance) {\n    var namespaceExports = {\n        // no-inline\n        TaskState: taskenums_2.TaskState,\n        TaskEvent: taskenums_1.TaskEvent,\n        StringFormat: string_1.StringFormat,\n        Storage: service_1.Service,\n        Reference: reference_1.Reference\n    };\n    instance.INTERNAL.registerService(STORAGE_TYPE, factory, namespaceExports, undefined, \n    // Allow multiple storage instances per app.\n    true);\n}\nexports.registerStorage = registerStorage;\nregisterStorage(app_1.default);\n\n\n\n},{\"./src/implementation/string\":123,\"./src/implementation/taskenums\":124,\"./src/implementation/xhriopool\":129,\"./src/reference\":130,\"./src/service\":131,\"@firebase/app\":1}],102:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar errorsExports = require(\"./error\");\nvar MetadataUtils = require(\"./metadata\");\nvar type = require(\"./type\");\n/**\n * @param name Name of the function.\n * @param specs Argument specs.\n * @param passed The actual arguments passed to the function.\n * @throws {fbs.Error} If the arguments are invalid.\n */\nfunction validate(name, specs, passed) {\n    var minArgs = specs.length;\n    var maxArgs = specs.length;\n    for (var i = 0; i < specs.length; i++) {\n        if (specs[i].optional) {\n            minArgs = i;\n            break;\n        }\n    }\n    var validLength = minArgs <= passed.length && passed.length <= maxArgs;\n    if (!validLength) {\n        throw errorsExports.invalidArgumentCount(minArgs, maxArgs, name, passed.length);\n    }\n    for (var i = 0; i < passed.length; i++) {\n        try {\n            specs[i].validator(passed[i]);\n        }\n        catch (e) {\n            if (e instanceof Error) {\n                throw errorsExports.invalidArgument(i, name, e.message);\n            }\n            else {\n                throw errorsExports.invalidArgument(i, name, e);\n            }\n        }\n    }\n}\nexports.validate = validate;\n/**\n * @struct\n */\nvar ArgSpec = /** @class */ (function () {\n    function ArgSpec(validator, opt_optional) {\n        var self = this;\n        this.validator = function (p) {\n            if (self.optional && !type.isJustDef(p)) {\n                return;\n            }\n            validator(p);\n        };\n        this.optional = !!opt_optional;\n    }\n    return ArgSpec;\n}());\nexports.ArgSpec = ArgSpec;\nfunction and_(v1, v2) {\n    return function (p) {\n        v1(p);\n        v2(p);\n    };\n}\nexports.and_ = and_;\nfunction stringSpec(opt_validator, opt_optional) {\n    function stringValidator(p) {\n        if (!type.isString(p)) {\n            throw 'Expected string.';\n        }\n    }\n    var validator;\n    if (opt_validator) {\n        validator = and_(stringValidator, opt_validator);\n    }\n    else {\n        validator = stringValidator;\n    }\n    return new ArgSpec(validator, opt_optional);\n}\nexports.stringSpec = stringSpec;\nfunction uploadDataSpec() {\n    function validator(p) {\n        var valid = p instanceof Uint8Array ||\n            p instanceof ArrayBuffer ||\n            (type.isNativeBlobDefined() && p instanceof Blob);\n        if (!valid) {\n            throw 'Expected Blob or File.';\n        }\n    }\n    return new ArgSpec(validator);\n}\nexports.uploadDataSpec = uploadDataSpec;\nfunction metadataSpec(opt_optional) {\n    return new ArgSpec(MetadataUtils.metadataValidator, opt_optional);\n}\nexports.metadataSpec = metadataSpec;\nfunction nonNegativeNumberSpec() {\n    function validator(p) {\n        var valid = type.isNumber(p) && p >= 0;\n        if (!valid) {\n            throw 'Expected a number 0 or greater.';\n        }\n    }\n    return new ArgSpec(validator);\n}\nexports.nonNegativeNumberSpec = nonNegativeNumberSpec;\nfunction looseObjectSpec(opt_validator, opt_optional) {\n    function validator(p) {\n        var isLooseObject = p === null || (type.isDef(p) && p instanceof Object);\n        if (!isLooseObject) {\n            throw 'Expected an Object.';\n        }\n        if (opt_validator !== undefined && opt_validator !== null) {\n            opt_validator(p);\n        }\n    }\n    return new ArgSpec(validator, opt_optional);\n}\nexports.looseObjectSpec = looseObjectSpec;\nfunction nullFunctionSpec(opt_optional) {\n    function validator(p) {\n        var valid = p === null || type.isFunction(p);\n        if (!valid) {\n            throw 'Expected a Function.';\n        }\n    }\n    return new ArgSpec(validator, opt_optional);\n}\nexports.nullFunctionSpec = nullFunctionSpec;\n\n\n\n},{\"./error\":109,\"./metadata\":114,\"./type\":125}],103:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Returns true if the object is contained in the array (compared with ===).\n * @template T\n */\nfunction contains(array, elem) {\n    return array.indexOf(elem) !== -1;\n}\nexports.contains = contains;\n/**\n * Returns a shallow copy of the array or array-like object (e.g. arguments).\n * @template T\n */\nfunction clone(arraylike) {\n    return Array.prototype.slice.call(arraylike);\n}\nexports.clone = clone;\n/**\n * Removes the given element from the given array, if it is contained.\n * Directly modifies the passed-in array.\n * @template T\n */\nfunction remove(array, elem) {\n    var i = array.indexOf(elem);\n    if (i !== -1) {\n        array.splice(i, 1);\n    }\n}\nexports.remove = remove;\n\n\n\n},{}],104:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * @fileoverview Method for invoking a callback asynchronously.\n */\nvar promiseimpl = require(\"./promise_external\");\n/**\n * Returns a function that invokes f with its arguments asynchronously as a\n * microtask, i.e. as soon as possible after the current script returns back\n * into browser code.\n */\nfunction async(f) {\n    return function () {\n        var argsToForward = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            argsToForward[_i] = arguments[_i];\n        }\n        promiseimpl.resolve(true).then(function () {\n            f.apply(null, argsToForward);\n        });\n    };\n}\nexports.async = async;\n\n\n\n},{\"./promise_external\":118}],105:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar constants = require(\"./constants\");\nvar errorsExports = require(\"./error\");\nvar failrequest_1 = require(\"./failrequest\");\nvar location_1 = require(\"./location\");\nvar promiseimpl = require(\"./promise_external\");\nvar requestmap_1 = require(\"./requestmap\");\nvar type = require(\"./type\");\n/**\n * @param app If null, getAuthToken always resolves with null.\n * @param service The storage service associated with this auth wrapper.\n *     Untyped to avoid circular type dependencies.\n * @struct\n */\nvar AuthWrapper = /** @class */ (function () {\n    function AuthWrapper(app, maker, requestMaker, service, pool) {\n        this.bucket_ = null;\n        this.deleted_ = false;\n        this.app_ = app;\n        if (this.app_ !== null) {\n            var options = this.app_.options;\n            if (type.isDef(options)) {\n                this.bucket_ = AuthWrapper.extractBucket_(options);\n            }\n        }\n        this.storageRefMaker_ = maker;\n        this.requestMaker_ = requestMaker;\n        this.pool_ = pool;\n        this.service_ = service;\n        this.maxOperationRetryTime_ = constants.defaultMaxOperationRetryTime;\n        this.maxUploadRetryTime_ = constants.defaultMaxUploadRetryTime;\n        this.requestMap_ = new requestmap_1.RequestMap();\n    }\n    AuthWrapper.extractBucket_ = function (config) {\n        var bucketString = config[constants.configOption] || null;\n        if (bucketString == null) {\n            return null;\n        }\n        var loc = location_1.Location.makeFromBucketSpec(bucketString);\n        return loc.bucket;\n    };\n    AuthWrapper.prototype.getAuthToken = function () {\n        // TODO(andysoto): remove ifDef checks after firebase-app implements stubs\n        // (b/28673818).\n        if (this.app_ !== null &&\n            type.isDef(this.app_.INTERNAL) &&\n            type.isDef(this.app_.INTERNAL.getToken)) {\n            return this.app_.INTERNAL.getToken().then(function (response) {\n                if (response !== null) {\n                    return response.accessToken;\n                }\n                else {\n                    return null;\n                }\n            }, function (_error) {\n                return null;\n            });\n        }\n        else {\n            return promiseimpl.resolve(null);\n        }\n    };\n    AuthWrapper.prototype.bucket = function () {\n        if (this.deleted_) {\n            throw errorsExports.appDeleted();\n        }\n        else {\n            return this.bucket_;\n        }\n    };\n    /**\n     * The service associated with this auth wrapper. Untyped to avoid circular\n     * type dependencies.\n     */\n    AuthWrapper.prototype.service = function () {\n        return this.service_;\n    };\n    /**\n     * Returns a new firebaseStorage.Reference object referencing this AuthWrapper\n     * at the given Location.\n     * @param loc The Location.\n     * @return Actually a firebaseStorage.Reference, typing not allowed\n     *     because of circular dependency problems.\n     */\n    AuthWrapper.prototype.makeStorageReference = function (loc) {\n        return this.storageRefMaker_(this, loc);\n    };\n    AuthWrapper.prototype.makeRequest = function (requestInfo, authToken) {\n        if (!this.deleted_) {\n            var request = this.requestMaker_(requestInfo, authToken, this.pool_);\n            this.requestMap_.addRequest(request);\n            return request;\n        }\n        else {\n            return new failrequest_1.FailRequest(errorsExports.appDeleted());\n        }\n    };\n    /**\n     * Stop running requests and prevent more from being created.\n     */\n    AuthWrapper.prototype.deleteApp = function () {\n        this.deleted_ = true;\n        this.app_ = null;\n        this.requestMap_.clear();\n    };\n    AuthWrapper.prototype.maxUploadRetryTime = function () {\n        return this.maxUploadRetryTime_;\n    };\n    AuthWrapper.prototype.setMaxUploadRetryTime = function (time) {\n        this.maxUploadRetryTime_ = time;\n    };\n    AuthWrapper.prototype.maxOperationRetryTime = function () {\n        return this.maxOperationRetryTime_;\n    };\n    AuthWrapper.prototype.setMaxOperationRetryTime = function (time) {\n        this.maxOperationRetryTime_ = time;\n    };\n    return AuthWrapper;\n}());\nexports.AuthWrapper = AuthWrapper;\n\n\n\n},{\"./constants\":108,\"./error\":109,\"./failrequest\":110,\"./location\":113,\"./promise_external\":118,\"./requestmap\":121,\"./type\":125}],106:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * @param f May be invoked\n *     before the function returns.\n * @param callback Get all the arguments passed to the function\n *     passed to f, including the initial boolean.\n */\nfunction start(f, callback, timeout) {\n    // TODO(andysoto): make this code cleaner (probably refactor into an actual\n    // type instead of a bunch of functions with state shared in the closure)\n    var waitSeconds = 1;\n    // Would type this as \"number\" but that doesn't work for Node so ¯\\_(ツ)_/¯\n    var timeoutId = null;\n    var hitTimeout = false;\n    var cancelState = 0;\n    function canceled() {\n        return cancelState === 2;\n    }\n    var triggeredCallback = false;\n    function triggerCallback() {\n        if (!triggeredCallback) {\n            triggeredCallback = true;\n            callback.apply(null, arguments);\n        }\n    }\n    function callWithDelay(millis) {\n        timeoutId = setTimeout(function () {\n            timeoutId = null;\n            f(handler, canceled());\n        }, millis);\n    }\n    function handler(success) {\n        var var_args = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            var_args[_i - 1] = arguments[_i];\n        }\n        if (triggeredCallback) {\n            return;\n        }\n        if (success) {\n            triggerCallback.apply(null, arguments);\n            return;\n        }\n        var mustStop = canceled() || hitTimeout;\n        if (mustStop) {\n            triggerCallback.apply(null, arguments);\n            return;\n        }\n        if (waitSeconds < 64) {\n            /* TODO(andysoto): don't back off so quickly if we know we're offline. */\n            waitSeconds *= 2;\n        }\n        var waitMillis;\n        if (cancelState === 1) {\n            cancelState = 2;\n            waitMillis = 0;\n        }\n        else {\n            waitMillis = (waitSeconds + Math.random()) * 1000;\n        }\n        callWithDelay(waitMillis);\n    }\n    var stopped = false;\n    function stop(wasTimeout) {\n        if (stopped) {\n            return;\n        }\n        stopped = true;\n        if (triggeredCallback) {\n            return;\n        }\n        if (timeoutId !== null) {\n            if (!wasTimeout) {\n                cancelState = 2;\n            }\n            clearTimeout(timeoutId);\n            callWithDelay(0);\n        }\n        else {\n            if (!wasTimeout) {\n                cancelState = 1;\n            }\n        }\n    }\n    callWithDelay(0);\n    setTimeout(function () {\n        hitTimeout = true;\n        stop(true);\n    }, timeout);\n    return stop;\n}\nexports.start = start;\n/**\n * Stops the retry loop from repeating.\n * If the function is currently \"in between\" retries, it is invoked immediately\n * with the second parameter as \"true\". Otherwise, it will be invoked once more\n * after the current invocation finishes iff the current invocation would have\n * triggered another retry.\n */\nfunction stop(id) {\n    id(false);\n}\nexports.stop = stop;\n\n\n\n},{}],107:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * @file Provides a Blob-like wrapper for various binary types (including the\n * native Blob type). This makes it possible to upload types like ArrayBuffers,\n * making uploads possible in environments without the native Blob type.\n */\nvar fs = require(\"./fs\");\nvar string = require(\"./string\");\nvar string_1 = require(\"./string\");\nvar type = require(\"./type\");\n/**\n * @param opt_elideCopy If true, doesn't copy mutable input data\n *     (e.g. Uint8Arrays). Pass true only if you know the objects will not be\n *     modified after this blob's construction.\n */\nvar FbsBlob = /** @class */ (function () {\n    function FbsBlob(data, opt_elideCopy) {\n        var size = 0;\n        var blobType = '';\n        if (type.isNativeBlob(data)) {\n            this.data_ = data;\n            size = data.size;\n            blobType = data.type;\n        }\n        else if (data instanceof ArrayBuffer) {\n            if (opt_elideCopy) {\n                this.data_ = new Uint8Array(data);\n            }\n            else {\n                this.data_ = new Uint8Array(data.byteLength);\n                this.data_.set(new Uint8Array(data));\n            }\n            size = this.data_.length;\n        }\n        else if (data instanceof Uint8Array) {\n            if (opt_elideCopy) {\n                this.data_ = data;\n            }\n            else {\n                this.data_ = new Uint8Array(data.length);\n                this.data_.set(data);\n            }\n            size = data.length;\n        }\n        this.size_ = size;\n        this.type_ = blobType;\n    }\n    FbsBlob.prototype.size = function () {\n        return this.size_;\n    };\n    FbsBlob.prototype.type = function () {\n        return this.type_;\n    };\n    FbsBlob.prototype.slice = function (startByte, endByte) {\n        if (type.isNativeBlob(this.data_)) {\n            var realBlob = this.data_;\n            var sliced = fs.sliceBlob(realBlob, startByte, endByte);\n            if (sliced === null) {\n                return null;\n            }\n            return new FbsBlob(sliced);\n        }\n        else {\n            var slice = new Uint8Array(this.data_.buffer, startByte, endByte - startByte);\n            return new FbsBlob(slice, true);\n        }\n    };\n    FbsBlob.getBlob = function () {\n        var var_args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            var_args[_i] = arguments[_i];\n        }\n        if (type.isNativeBlobDefined()) {\n            var blobby = var_args.map(function (val) {\n                if (val instanceof FbsBlob) {\n                    return val.data_;\n                }\n                else {\n                    return val;\n                }\n            });\n            return new FbsBlob(fs.getBlob.apply(null, blobby));\n        }\n        else {\n            var uint8Arrays = var_args.map(function (val) {\n                if (type.isString(val)) {\n                    return string.dataFromString(string_1.StringFormat.RAW, val).data;\n                }\n                else {\n                    // Blobs don't exist, so this has to be a Uint8Array.\n                    return val.data_;\n                }\n            });\n            var finalLength_1 = 0;\n            uint8Arrays.forEach(function (array) {\n                finalLength_1 += array.byteLength;\n            });\n            var merged_1 = new Uint8Array(finalLength_1);\n            var index_1 = 0;\n            uint8Arrays.forEach(function (array) {\n                for (var i = 0; i < array.length; i++) {\n                    merged_1[index_1++] = array[i];\n                }\n            });\n            return new FbsBlob(merged_1, true);\n        }\n    };\n    FbsBlob.prototype.uploadData = function () {\n        return this.data_;\n    };\n    return FbsBlob;\n}());\nexports.FbsBlob = FbsBlob;\n\n\n\n},{\"./fs\":111,\"./string\":123,\"./type\":125}],108:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @fileoverview Constants used in the Firebase Storage library.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Domain and scheme for API calls.\n */\nexports.domainBase = 'https://firebasestorage.googleapis.com';\n/**\n * Domain and scheme for object downloads.\n */\nexports.downloadBase = 'https://firebasestorage.googleapis.com';\n/**\n * Base URL for non-upload calls to the API.\n */\nexports.apiBaseUrl = '/v0';\n/**\n * Base URL for upload calls to the API.\n */\nexports.apiUploadBaseUrl = '/v0';\nfunction setDomainBase(domainBase) {\n    domainBase = domainBase;\n}\nexports.setDomainBase = setDomainBase;\nexports.configOption = 'storageBucket';\n/**\n * 1 minute\n */\nexports.shortMaxOperationRetryTime = 1 * 60 * 1000;\n/**\n * 2 minutes\n */\nexports.defaultMaxOperationRetryTime = 2 * 60 * 1000;\n/**\n * 10 minutes\n */\nexports.defaultMaxUploadRetryTime = 10 * 60 * 100;\n/**\n * This is the value of Number.MIN_SAFE_INTEGER, which is not well supported\n * enough for us to use it directly.\n */\nexports.minSafeInteger = -9007199254740991;\n\n\n\n},{}],109:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar constants_1 = require(\"./constants\");\nvar FirebaseStorageError = /** @class */ (function () {\n    function FirebaseStorageError(code, message) {\n        this.code_ = prependCode(code);\n        this.message_ = 'Firebase Storage: ' + message;\n        this.serverResponse_ = null;\n        this.name_ = 'FirebaseError';\n    }\n    FirebaseStorageError.prototype.codeProp = function () {\n        return this.code;\n    };\n    FirebaseStorageError.prototype.codeEquals = function (code) {\n        return prependCode(code) === this.codeProp();\n    };\n    FirebaseStorageError.prototype.serverResponseProp = function () {\n        return this.serverResponse_;\n    };\n    FirebaseStorageError.prototype.setServerResponseProp = function (serverResponse) {\n        this.serverResponse_ = serverResponse;\n    };\n    Object.defineProperty(FirebaseStorageError.prototype, \"name\", {\n        get: function () {\n            return this.name_;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(FirebaseStorageError.prototype, \"code\", {\n        get: function () {\n            return this.code_;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(FirebaseStorageError.prototype, \"message\", {\n        get: function () {\n            return this.message_;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(FirebaseStorageError.prototype, \"serverResponse\", {\n        get: function () {\n            return this.serverResponse_;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return FirebaseStorageError;\n}());\nexports.FirebaseStorageError = FirebaseStorageError;\nexports.errors = {};\nexports.Code = {\n    // Shared between all platforms\n    UNKNOWN: 'unknown',\n    OBJECT_NOT_FOUND: 'object-not-found',\n    BUCKET_NOT_FOUND: 'bucket-not-found',\n    PROJECT_NOT_FOUND: 'project-not-found',\n    QUOTA_EXCEEDED: 'quota-exceeded',\n    UNAUTHENTICATED: 'unauthenticated',\n    UNAUTHORIZED: 'unauthorized',\n    RETRY_LIMIT_EXCEEDED: 'retry-limit-exceeded',\n    INVALID_CHECKSUM: 'invalid-checksum',\n    CANCELED: 'canceled',\n    // JS specific\n    INVALID_EVENT_NAME: 'invalid-event-name',\n    INVALID_URL: 'invalid-url',\n    INVALID_DEFAULT_BUCKET: 'invalid-default-bucket',\n    NO_DEFAULT_BUCKET: 'no-default-bucket',\n    CANNOT_SLICE_BLOB: 'cannot-slice-blob',\n    SERVER_FILE_WRONG_SIZE: 'server-file-wrong-size',\n    NO_DOWNLOAD_URL: 'no-download-url',\n    INVALID_ARGUMENT: 'invalid-argument',\n    INVALID_ARGUMENT_COUNT: 'invalid-argument-count',\n    APP_DELETED: 'app-deleted',\n    INVALID_ROOT_OPERATION: 'invalid-root-operation',\n    INVALID_FORMAT: 'invalid-format',\n    INTERNAL_ERROR: 'internal-error'\n};\nfunction prependCode(code) {\n    return 'storage/' + code;\n}\nexports.prependCode = prependCode;\nfunction unknown() {\n    var message = 'An unknown error occurred, please check the error payload for ' +\n        'server response.';\n    return new FirebaseStorageError(exports.Code.UNKNOWN, message);\n}\nexports.unknown = unknown;\nfunction objectNotFound(path) {\n    return new FirebaseStorageError(exports.Code.OBJECT_NOT_FOUND, \"Object '\" + path + \"' does not exist.\");\n}\nexports.objectNotFound = objectNotFound;\nfunction bucketNotFound(bucket) {\n    return new FirebaseStorageError(exports.Code.BUCKET_NOT_FOUND, \"Bucket '\" + bucket + \"' does not exist.\");\n}\nexports.bucketNotFound = bucketNotFound;\nfunction projectNotFound(project) {\n    return new FirebaseStorageError(exports.Code.PROJECT_NOT_FOUND, \"Project '\" + project + \"' does not exist.\");\n}\nexports.projectNotFound = projectNotFound;\nfunction quotaExceeded(bucket) {\n    return new FirebaseStorageError(exports.Code.QUOTA_EXCEEDED, \"Quota for bucket '\" +\n        bucket +\n        \"' exceeded, please view quota on \" +\n        'https://firebase.google.com/pricing/.');\n}\nexports.quotaExceeded = quotaExceeded;\nfunction unauthenticated() {\n    var message = 'User is not authenticated, please authenticate using Firebase ' +\n        'Authentication and try again.';\n    return new FirebaseStorageError(exports.Code.UNAUTHENTICATED, message);\n}\nexports.unauthenticated = unauthenticated;\nfunction unauthorized(path) {\n    return new FirebaseStorageError(exports.Code.UNAUTHORIZED, \"User does not have permission to access '\" + path + \"'.\");\n}\nexports.unauthorized = unauthorized;\nfunction retryLimitExceeded() {\n    return new FirebaseStorageError(exports.Code.RETRY_LIMIT_EXCEEDED, 'Max retry time for operation exceeded, please try again.');\n}\nexports.retryLimitExceeded = retryLimitExceeded;\nfunction invalidChecksum(path, checksum, calculated) {\n    return new FirebaseStorageError(exports.Code.INVALID_CHECKSUM, \"Uploaded/downloaded object '\" +\n        path +\n        \"' has checksum '\" +\n        checksum +\n        \"' which does not match '\" +\n        calculated +\n        \"'. Please retry the upload/download.\");\n}\nexports.invalidChecksum = invalidChecksum;\nfunction canceled() {\n    return new FirebaseStorageError(exports.Code.CANCELED, 'User canceled the upload/download.');\n}\nexports.canceled = canceled;\nfunction invalidEventName(name) {\n    return new FirebaseStorageError(exports.Code.INVALID_EVENT_NAME, \"Invalid event name '\" + name + \"'.\");\n}\nexports.invalidEventName = invalidEventName;\nfunction invalidUrl(url) {\n    return new FirebaseStorageError(exports.Code.INVALID_URL, \"Invalid URL '\" + url + \"'.\");\n}\nexports.invalidUrl = invalidUrl;\nfunction invalidDefaultBucket(bucket) {\n    return new FirebaseStorageError(exports.Code.INVALID_DEFAULT_BUCKET, \"Invalid default bucket '\" + bucket + \"'.\");\n}\nexports.invalidDefaultBucket = invalidDefaultBucket;\nfunction noDefaultBucket() {\n    return new FirebaseStorageError(exports.Code.NO_DEFAULT_BUCKET, 'No default bucket ' +\n        \"found. Did you set the '\" +\n        constants_1.configOption +\n        \"' property when initializing the app?\");\n}\nexports.noDefaultBucket = noDefaultBucket;\nfunction cannotSliceBlob() {\n    return new FirebaseStorageError(exports.Code.CANNOT_SLICE_BLOB, 'Cannot slice blob for upload. Please retry the upload.');\n}\nexports.cannotSliceBlob = cannotSliceBlob;\nfunction serverFileWrongSize() {\n    return new FirebaseStorageError(exports.Code.SERVER_FILE_WRONG_SIZE, 'Server recorded incorrect upload file size, please retry the upload.');\n}\nexports.serverFileWrongSize = serverFileWrongSize;\nfunction noDownloadURL() {\n    return new FirebaseStorageError(exports.Code.NO_DOWNLOAD_URL, 'The given file does not have any download URLs.');\n}\nexports.noDownloadURL = noDownloadURL;\nfunction invalidArgument(index, fnName, message) {\n    return new FirebaseStorageError(exports.Code.INVALID_ARGUMENT, 'Invalid argument in `' + fnName + '` at index ' + index + ': ' + message);\n}\nexports.invalidArgument = invalidArgument;\nfunction invalidArgumentCount(argMin, argMax, fnName, real) {\n    var countPart;\n    var plural;\n    if (argMin === argMax) {\n        countPart = argMin;\n        plural = argMin === 1 ? 'argument' : 'arguments';\n    }\n    else {\n        countPart = 'between ' + argMin + ' and ' + argMax;\n        plural = 'arguments';\n    }\n    return new FirebaseStorageError(exports.Code.INVALID_ARGUMENT_COUNT, 'Invalid argument count in `' +\n        fnName +\n        '`: Expected ' +\n        countPart +\n        ' ' +\n        plural +\n        ', received ' +\n        real +\n        '.');\n}\nexports.invalidArgumentCount = invalidArgumentCount;\nfunction appDeleted() {\n    return new FirebaseStorageError(exports.Code.APP_DELETED, 'The Firebase app was deleted.');\n}\nexports.appDeleted = appDeleted;\n/**\n * @param name The name of the operation that was invalid.\n */\nfunction invalidRootOperation(name) {\n    return new FirebaseStorageError(exports.Code.INVALID_ROOT_OPERATION, \"The operation '\" +\n        name +\n        \"' cannot be performed on a root reference, create a non-root \" +\n        \"reference using child, such as .child('file.png').\");\n}\nexports.invalidRootOperation = invalidRootOperation;\n/**\n * @param format The format that was not valid.\n * @param message A message describing the format violation.\n */\nfunction invalidFormat(format, message) {\n    return new FirebaseStorageError(exports.Code.INVALID_FORMAT, \"String does not match format '\" + format + \"': \" + message);\n}\nexports.invalidFormat = invalidFormat;\n/**\n * @param message A message describing the internal error.\n */\nfunction internalError(message) {\n    throw new FirebaseStorageError(exports.Code.INTERNAL_ERROR, 'Internal error: ' + message);\n}\nexports.internalError = internalError;\n\n\n\n},{\"./constants\":108}],110:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar promiseimpl = require(\"./promise_external\");\n/**\n * A request whose promise always fails.\n * @struct\n * @template T\n */\nvar FailRequest = /** @class */ (function () {\n    function FailRequest(error) {\n        this.promise_ = promiseimpl.reject(error);\n    }\n    /** @inheritDoc */\n    FailRequest.prototype.getPromise = function () {\n        return this.promise_;\n    };\n    /** @inheritDoc */\n    FailRequest.prototype.cancel = function (appDelete) {\n        if (appDelete === void 0) { appDelete = false; }\n    };\n    return FailRequest;\n}());\nexports.FailRequest = FailRequest;\n\n\n\n},{\"./promise_external\":118}],111:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar type = require(\"./type\");\nfunction getBlobBuilder() {\n    if (typeof BlobBuilder !== 'undefined') {\n        return BlobBuilder;\n    }\n    else if (typeof WebKitBlobBuilder !== 'undefined') {\n        return WebKitBlobBuilder;\n    }\n    else {\n        return undefined;\n    }\n}\n/**\n * Concatenates one or more values together and converts them to a Blob.\n *\n * @param var_args The values that will make up the resulting blob.\n * @return The blob.\n */\nfunction getBlob() {\n    var var_args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        var_args[_i] = arguments[_i];\n    }\n    var BlobBuilder = getBlobBuilder();\n    if (BlobBuilder !== undefined) {\n        var bb = new BlobBuilder();\n        for (var i = 0; i < var_args.length; i++) {\n            bb.append(var_args[i]);\n        }\n        return bb.getBlob();\n    }\n    else {\n        if (type.isNativeBlobDefined()) {\n            return new Blob(var_args);\n        }\n        else {\n            throw Error(\"This browser doesn't seem to support creating Blobs\");\n        }\n    }\n}\nexports.getBlob = getBlob;\n/**\n * Slices the blob. The returned blob contains data from the start byte\n * (inclusive) till the end byte (exclusive). Negative indices cannot be used.\n *\n * @param blob The blob to be sliced.\n * @param start Index of the starting byte.\n * @param end Index of the ending byte.\n * @return The blob slice or null if not supported.\n */\nfunction sliceBlob(blob, start, end) {\n    if (blob.webkitSlice) {\n        return blob.webkitSlice(start, end);\n    }\n    else if (blob.mozSlice) {\n        return blob.mozSlice(start, end);\n    }\n    else if (blob.slice) {\n        return blob.slice(start, end);\n    }\n    return null;\n}\nexports.sliceBlob = sliceBlob;\n\n\n\n},{\"./type\":125}],112:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar type = require(\"./type\");\n/**\n * Returns the Object resulting from parsing the given JSON, or null if the\n * given string does not represent a JSON object.\n */\nfunction jsonObjectOrNull(s) {\n    var obj;\n    try {\n        obj = JSON.parse(s);\n    }\n    catch (e) {\n        return null;\n    }\n    if (type.isNonArrayObject(obj)) {\n        return obj;\n    }\n    else {\n        return null;\n    }\n}\nexports.jsonObjectOrNull = jsonObjectOrNull;\n\n\n\n},{\"./type\":125}],113:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * @fileoverview Functionality related to the parsing/composition of bucket/\n * object location.\n */\nvar errorsExports = require(\"./error\");\n/**\n * @struct\n */\nvar Location = /** @class */ (function () {\n    function Location(bucket, path) {\n        this.bucket = bucket;\n        this.path_ = path;\n    }\n    Object.defineProperty(Location.prototype, \"path\", {\n        get: function () {\n            return this.path_;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Location.prototype.fullServerUrl = function () {\n        var encode = encodeURIComponent;\n        return '/b/' + encode(this.bucket) + '/o/' + encode(this.path);\n    };\n    Location.prototype.bucketOnlyServerUrl = function () {\n        var encode = encodeURIComponent;\n        return '/b/' + encode(this.bucket) + '/o';\n    };\n    Location.makeFromBucketSpec = function (bucketString) {\n        var bucketLocation;\n        try {\n            bucketLocation = Location.makeFromUrl(bucketString);\n        }\n        catch (e) {\n            // Not valid URL, use as-is. This lets you put bare bucket names in\n            // config.\n            return new Location(bucketString, '');\n        }\n        if (bucketLocation.path === '') {\n            return bucketLocation;\n        }\n        else {\n            throw errorsExports.invalidDefaultBucket(bucketString);\n        }\n    };\n    Location.makeFromUrl = function (url) {\n        var location = null;\n        var bucketDomain = '([A-Za-z0-9.\\\\-]+)';\n        function gsModify(loc) {\n            if (loc.path.charAt(loc.path.length - 1) === '/') {\n                loc.path_ = loc.path_.slice(0, -1);\n            }\n        }\n        var gsPath = '(/(.*))?$';\n        var path = '(/([^?#]*).*)?$';\n        var gsRegex = new RegExp('^gs://' + bucketDomain + gsPath, 'i');\n        var gsIndices = { bucket: 1, path: 3 };\n        function httpModify(loc) {\n            loc.path_ = decodeURIComponent(loc.path);\n        }\n        var version = 'v[A-Za-z0-9_]+';\n        var httpRegex = new RegExp('^https?://firebasestorage\\\\.googleapis\\\\.com/' +\n            version +\n            '/b/' +\n            bucketDomain +\n            '/o' +\n            path, 'i');\n        var httpIndices = { bucket: 1, path: 3 };\n        var groups = [\n            { regex: gsRegex, indices: gsIndices, postModify: gsModify },\n            { regex: httpRegex, indices: httpIndices, postModify: httpModify }\n        ];\n        for (var i = 0; i < groups.length; i++) {\n            var group = groups[i];\n            var captures = group.regex.exec(url);\n            if (captures) {\n                var bucketValue = captures[group.indices.bucket];\n                var pathValue = captures[group.indices.path];\n                if (!pathValue) {\n                    pathValue = '';\n                }\n                location = new Location(bucketValue, pathValue);\n                group.postModify(location);\n                break;\n            }\n        }\n        if (location == null) {\n            throw errorsExports.invalidUrl(url);\n        }\n        return location;\n    };\n    return Location;\n}());\nexports.Location = Location;\n\n\n\n},{\"./error\":109}],114:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar json = require(\"./json\");\nvar location_1 = require(\"./location\");\nvar path = require(\"./path\");\nvar type = require(\"./type\");\nvar UrlUtils = require(\"./url\");\nfunction noXform_(metadata, value) {\n    return value;\n}\nexports.noXform_ = noXform_;\n/**\n * @struct\n */\nvar Mapping = /** @class */ (function () {\n    function Mapping(server, opt_local, opt_writable, opt_xform) {\n        this.server = server;\n        this.local = opt_local || server;\n        this.writable = !!opt_writable;\n        this.xform = opt_xform || noXform_;\n    }\n    return Mapping;\n}());\nexports.Mapping = Mapping;\nvar mappings_ = null;\nfunction xformPath(fullPath) {\n    var valid = type.isString(fullPath);\n    if (!valid || fullPath.length < 2) {\n        return fullPath;\n    }\n    else {\n        fullPath = fullPath;\n        return path.lastComponent(fullPath);\n    }\n}\nexports.xformPath = xformPath;\nfunction getMappings() {\n    if (mappings_) {\n        return mappings_;\n    }\n    var mappings = [];\n    mappings.push(new Mapping('bucket'));\n    mappings.push(new Mapping('generation'));\n    mappings.push(new Mapping('metageneration'));\n    mappings.push(new Mapping('name', 'fullPath', true));\n    function mappingsXformPath(metadata, fullPath) {\n        return xformPath(fullPath);\n    }\n    var nameMapping = new Mapping('name');\n    nameMapping.xform = mappingsXformPath;\n    mappings.push(nameMapping);\n    /**\n     * Coerces the second param to a number, if it is defined.\n     */\n    function xformSize(metadata, size) {\n        if (type.isDef(size)) {\n            return +size;\n        }\n        else {\n            return size;\n        }\n    }\n    var sizeMapping = new Mapping('size');\n    sizeMapping.xform = xformSize;\n    mappings.push(sizeMapping);\n    mappings.push(new Mapping('timeCreated'));\n    mappings.push(new Mapping('updated'));\n    mappings.push(new Mapping('md5Hash', null, true));\n    mappings.push(new Mapping('cacheControl', null, true));\n    mappings.push(new Mapping('contentDisposition', null, true));\n    mappings.push(new Mapping('contentEncoding', null, true));\n    mappings.push(new Mapping('contentLanguage', null, true));\n    mappings.push(new Mapping('contentType', null, true));\n    mappings.push(new Mapping('metadata', 'customMetadata', true));\n    /**\n     * Transforms a comma-separated string of tokens into a list of download\n     * URLs.\n     */\n    function xformTokens(metadata, tokens) {\n        var valid = type.isString(tokens) && tokens.length > 0;\n        if (!valid) {\n            // This can happen if objects are uploaded through GCS and retrieved\n            // through list, so we don't want to throw an Error.\n            return [];\n        }\n        var encode = encodeURIComponent;\n        var tokensList = tokens.split(',');\n        var urls = tokensList.map(function (token) {\n            var bucket = metadata['bucket'];\n            var path = metadata['fullPath'];\n            var urlPart = '/b/' + encode(bucket) + '/o/' + encode(path);\n            var base = UrlUtils.makeDownloadUrl(urlPart);\n            var queryString = UrlUtils.makeQueryString({\n                alt: 'media',\n                token: token\n            });\n            return base + queryString;\n        });\n        return urls;\n    }\n    mappings.push(new Mapping('downloadTokens', 'downloadURLs', false, xformTokens));\n    mappings_ = mappings;\n    return mappings_;\n}\nexports.getMappings = getMappings;\nfunction addRef(metadata, authWrapper) {\n    function generateRef() {\n        var bucket = metadata['bucket'];\n        var path = metadata['fullPath'];\n        var loc = new location_1.Location(bucket, path);\n        return authWrapper.makeStorageReference(loc);\n    }\n    Object.defineProperty(metadata, 'ref', { get: generateRef });\n}\nexports.addRef = addRef;\nfunction fromResource(authWrapper, resource, mappings) {\n    var metadata = {};\n    metadata['type'] = 'file';\n    var len = mappings.length;\n    for (var i = 0; i < len; i++) {\n        var mapping = mappings[i];\n        metadata[mapping.local] = mapping.xform(metadata, resource[mapping.server]);\n    }\n    addRef(metadata, authWrapper);\n    return metadata;\n}\nexports.fromResource = fromResource;\nfunction fromResourceString(authWrapper, resourceString, mappings) {\n    var obj = json.jsonObjectOrNull(resourceString);\n    if (obj === null) {\n        return null;\n    }\n    var resource = obj;\n    return fromResource(authWrapper, resource, mappings);\n}\nexports.fromResourceString = fromResourceString;\nfunction toResourceString(metadata, mappings) {\n    var resource = {};\n    var len = mappings.length;\n    for (var i = 0; i < len; i++) {\n        var mapping = mappings[i];\n        if (mapping.writable) {\n            resource[mapping.server] = metadata[mapping.local];\n        }\n    }\n    return JSON.stringify(resource);\n}\nexports.toResourceString = toResourceString;\nfunction metadataValidator(p) {\n    var validType = p && type.isObject(p);\n    if (!validType) {\n        throw 'Expected Metadata object.';\n    }\n    for (var key in p) {\n        var val = p[key];\n        if (key === 'customMetadata') {\n            if (!type.isObject(val)) {\n                throw 'Expected object for \\'customMetadata\\' mapping.';\n            }\n        }\n        else {\n            if (type.isNonNullObject(val)) {\n                throw \"Mapping for '\" + key + \"' cannot be an object.\";\n            }\n        }\n    }\n}\nexports.metadataValidator = metadataValidator;\n\n\n\n},{\"./json\":112,\"./location\":113,\"./path\":117,\"./type\":125,\"./url\":126}],115:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * @fileoverview Contains methods for working with objects.\n */\nfunction contains(obj, prop) {\n    return Object.prototype.hasOwnProperty.call(obj, prop);\n}\nexports.contains = contains;\nfunction forEach(obj, f) {\n    for (var key in obj) {\n        if (contains(obj, key)) {\n            f(key, obj[key]);\n        }\n    }\n}\nexports.forEach = forEach;\nfunction clone(obj) {\n    if (obj == null) {\n        return {};\n    }\n    var c = {};\n    forEach(obj, function (key, val) {\n        c[key] = val;\n    });\n    return c;\n}\nexports.clone = clone;\n\n\n\n},{}],116:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar type = require(\"./type\");\n/**\n * @struct\n */\nvar Observer = /** @class */ (function () {\n    function Observer(nextOrObserver, opt_error, opt_complete) {\n        var asFunctions = type.isFunction(nextOrObserver) ||\n            type.isDef(opt_error) ||\n            type.isDef(opt_complete);\n        if (asFunctions) {\n            this.next = nextOrObserver;\n            this.error = opt_error || null;\n            this.complete = opt_complete || null;\n        }\n        else {\n            var observer = nextOrObserver;\n            this.next = observer.next || null;\n            this.error = observer.error || null;\n            this.complete = observer.complete || null;\n        }\n    }\n    return Observer;\n}());\nexports.Observer = Observer;\n\n\n\n},{\"./type\":125}],117:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * @fileoverview Contains helper methods for manipulating paths.\n */\n/**\n * @return Null if the path is already at the root.\n */\nfunction parent(path) {\n    if (path.length == 0) {\n        return null;\n    }\n    var index = path.lastIndexOf('/');\n    if (index === -1) {\n        return '';\n    }\n    var newPath = path.slice(0, index);\n    return newPath;\n}\nexports.parent = parent;\nfunction child(path, childPath) {\n    var canonicalChildPath = childPath\n        .split('/')\n        .filter(function (component) {\n        return component.length > 0;\n    })\n        .join('/');\n    if (path.length === 0) {\n        return canonicalChildPath;\n    }\n    else {\n        return path + '/' + canonicalChildPath;\n    }\n}\nexports.child = child;\n/**\n * Returns the last component of a path.\n * '/foo/bar' -> 'bar'\n * '/foo/bar/baz/' -> 'baz/'\n * '/a' -> 'a'\n */\nfunction lastComponent(path) {\n    var index = path.lastIndexOf('/', path.length - 2);\n    if (index === -1) {\n        return path;\n    }\n    else {\n        return path.slice(index + 1);\n    }\n}\nexports.lastComponent = lastComponent;\n\n\n\n},{}],118:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * @fileoverview Implements the promise abstraction interface for external\n * (public SDK) packaging, which just passes through to the firebase-app impl.\n */\n/**\n * @template T\n * @param {function((function(T): void),\n *                  (function(!Error): void))} resolver\n */\nfunction make(resolver) {\n    return new Promise(resolver);\n}\nexports.make = make;\n/**\n * @template T\n */\nfunction resolve(value) {\n    return Promise.resolve(value);\n}\nexports.resolve = resolve;\nfunction reject(error) {\n    return Promise.reject(error);\n}\nexports.reject = reject;\n\n\n\n},{}],119:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * @fileoverview Defines methods used to actually send HTTP requests from\n * abstract representations.\n */\nvar app_1 = require(\"@firebase/app\");\nvar array = require(\"./array\");\nvar backoff = require(\"./backoff\");\nvar errorsExports = require(\"./error\");\nvar object = require(\"./object\");\nvar promiseimpl = require(\"./promise_external\");\nvar type = require(\"./type\");\nvar UrlUtils = require(\"./url\");\nvar XhrIoExports = require(\"./xhrio\");\n/**\n * @struct\n * @template T\n */\nvar NetworkRequest = /** @class */ (function () {\n    function NetworkRequest(url, method, headers, body, successCodes, additionalRetryCodes, callback, errorCallback, timeout, progressCallback, pool) {\n        this.pendingXhr_ = null;\n        this.backoffId_ = null;\n        this.resolve_ = null;\n        this.reject_ = null;\n        this.canceled_ = false;\n        this.appDelete_ = false;\n        this.url_ = url;\n        this.method_ = method;\n        this.headers_ = headers;\n        this.body_ = body;\n        this.successCodes_ = successCodes.slice();\n        this.additionalRetryCodes_ = additionalRetryCodes.slice();\n        this.callback_ = callback;\n        this.errorCallback_ = errorCallback;\n        this.progressCallback_ = progressCallback;\n        this.timeout_ = timeout;\n        this.pool_ = pool;\n        var self = this;\n        this.promise_ = promiseimpl.make(function (resolve, reject) {\n            self.resolve_ = resolve;\n            self.reject_ = reject;\n            self.start_();\n        });\n    }\n    /**\n     * Actually starts the retry loop.\n     */\n    NetworkRequest.prototype.start_ = function () {\n        var self = this;\n        function doTheRequest(backoffCallback, canceled) {\n            if (canceled) {\n                backoffCallback(false, new RequestEndStatus(false, null, true));\n                return;\n            }\n            var xhr = self.pool_.createXhrIo();\n            self.pendingXhr_ = xhr;\n            function progressListener(progressEvent) {\n                var loaded = progressEvent.loaded;\n                var total = progressEvent.lengthComputable ? progressEvent.total : -1;\n                if (self.progressCallback_ !== null) {\n                    self.progressCallback_(loaded, total);\n                }\n            }\n            if (self.progressCallback_ !== null) {\n                xhr.addUploadProgressListener(progressListener);\n            }\n            xhr\n                .send(self.url_, self.method_, self.body_, self.headers_)\n                .then(function (xhr) {\n                if (self.progressCallback_ !== null) {\n                    xhr.removeUploadProgressListener(progressListener);\n                }\n                self.pendingXhr_ = null;\n                xhr = xhr;\n                var hitServer = xhr.getErrorCode() === XhrIoExports.ErrorCode.NO_ERROR;\n                var status = xhr.getStatus();\n                if (!hitServer || self.isRetryStatusCode_(status)) {\n                    var wasCanceled = xhr.getErrorCode() === XhrIoExports.ErrorCode.ABORT;\n                    backoffCallback(false, new RequestEndStatus(false, null, wasCanceled));\n                    return;\n                }\n                var successCode = array.contains(self.successCodes_, status);\n                backoffCallback(true, new RequestEndStatus(successCode, xhr));\n            });\n        }\n        /**\n         * @param requestWentThrough True if the request eventually went\n         *     through, false if it hit the retry limit or was canceled.\n         */\n        function backoffDone(requestWentThrough, status) {\n            var resolve = self.resolve_;\n            var reject = self.reject_;\n            var xhr = status.xhr;\n            if (status.wasSuccessCode) {\n                try {\n                    var result = self.callback_(xhr, xhr.getResponseText());\n                    if (type.isJustDef(result)) {\n                        resolve(result);\n                    }\n                    else {\n                        resolve();\n                    }\n                }\n                catch (e) {\n                    reject(e);\n                }\n            }\n            else {\n                if (xhr !== null) {\n                    var err = errorsExports.unknown();\n                    err.setServerResponseProp(xhr.getResponseText());\n                    if (self.errorCallback_) {\n                        reject(self.errorCallback_(xhr, err));\n                    }\n                    else {\n                        reject(err);\n                    }\n                }\n                else {\n                    if (status.canceled) {\n                        var err = self.appDelete_\n                            ? errorsExports.appDeleted()\n                            : errorsExports.canceled();\n                        reject(err);\n                    }\n                    else {\n                        var err = errorsExports.retryLimitExceeded();\n                        reject(err);\n                    }\n                }\n            }\n        }\n        if (this.canceled_) {\n            backoffDone(false, new RequestEndStatus(false, null, true));\n        }\n        else {\n            this.backoffId_ = backoff.start(doTheRequest, backoffDone, this.timeout_);\n        }\n    };\n    /** @inheritDoc */\n    NetworkRequest.prototype.getPromise = function () {\n        return this.promise_;\n    };\n    /** @inheritDoc */\n    NetworkRequest.prototype.cancel = function (appDelete) {\n        this.canceled_ = true;\n        this.appDelete_ = appDelete || false;\n        if (this.backoffId_ !== null) {\n            backoff.stop(this.backoffId_);\n        }\n        if (this.pendingXhr_ !== null) {\n            this.pendingXhr_.abort();\n        }\n    };\n    NetworkRequest.prototype.isRetryStatusCode_ = function (status) {\n        // The codes for which to retry came from this page:\n        // https://cloud.google.com/storage/docs/exponential-backoff\n        var isFiveHundredCode = status >= 500 && status < 600;\n        var extraRetryCodes = [\n            // Request Timeout: web server didn't receive full request in time.\n            408,\n            // Too Many Requests: you're getting rate-limited, basically.\n            429\n        ];\n        var isExtraRetryCode = array.contains(extraRetryCodes, status);\n        var isRequestSpecificRetryCode = array.contains(this.additionalRetryCodes_, status);\n        return isFiveHundredCode || isExtraRetryCode || isRequestSpecificRetryCode;\n    };\n    return NetworkRequest;\n}());\n/**\n * A collection of information about the result of a network request.\n * @param opt_canceled Defaults to false.\n * @struct\n */\nvar RequestEndStatus = /** @class */ (function () {\n    function RequestEndStatus(wasSuccessCode, xhr, opt_canceled) {\n        this.wasSuccessCode = wasSuccessCode;\n        this.xhr = xhr;\n        this.canceled = !!opt_canceled;\n    }\n    return RequestEndStatus;\n}());\nexports.RequestEndStatus = RequestEndStatus;\nfunction addAuthHeader_(headers, authToken) {\n    if (authToken !== null && authToken.length > 0) {\n        headers['Authorization'] = 'Firebase ' + authToken;\n    }\n}\nexports.addAuthHeader_ = addAuthHeader_;\nfunction addVersionHeader_(headers) {\n    var number = typeof app_1.default !== 'undefined' ? app_1.default.SDK_VERSION : 'AppManager';\n    headers['X-Firebase-Storage-Version'] = 'webjs/' + number;\n}\nexports.addVersionHeader_ = addVersionHeader_;\n/**\n * @template T\n */\nfunction makeRequest(requestInfo, authToken, pool) {\n    var queryPart = UrlUtils.makeQueryString(requestInfo.urlParams);\n    var url = requestInfo.url + queryPart;\n    var headers = object.clone(requestInfo.headers);\n    addAuthHeader_(headers, authToken);\n    addVersionHeader_(headers);\n    return new NetworkRequest(url, requestInfo.method, headers, requestInfo.body, requestInfo.successCodes, requestInfo.additionalRetryCodes, requestInfo.handler, requestInfo.errorHandler, requestInfo.timeout, requestInfo.progressCallback, pool);\n}\nexports.makeRequest = makeRequest;\n\n\n\n},{\"./array\":103,\"./backoff\":106,\"./error\":109,\"./object\":115,\"./promise_external\":118,\"./type\":125,\"./url\":126,\"./xhrio\":127,\"@firebase/app\":1}],120:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar RequestInfo = /** @class */ (function () {\n    function RequestInfo(url, method, \n        /**\n           * Returns the value with which to resolve the request's promise. Only called\n           * if the request is successful. Throw from this function to reject the\n           * returned Request's promise with the thrown error.\n           * Note: The XhrIo passed to this function may be reused after this callback\n           * returns. Do not keep a reference to it in any way.\n           */\n        handler, timeout) {\n        this.url = url;\n        this.method = method;\n        this.handler = handler;\n        this.timeout = timeout;\n        this.urlParams = {};\n        this.headers = {};\n        this.body = null;\n        this.errorHandler = null;\n        /**\n         * Called with the current number of bytes uploaded and total size (-1 if not\n         * computable) of the request body (i.e. used to report upload progress).\n         */\n        this.progressCallback = null;\n        this.successCodes = [200];\n        this.additionalRetryCodes = [];\n    }\n    return RequestInfo;\n}());\nexports.RequestInfo = RequestInfo;\n\n\n\n},{}],121:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar object = require(\"./object\");\nvar constants = require(\"./constants\");\n/**\n * @struct\n */\nvar RequestMap = /** @class */ (function () {\n    function RequestMap() {\n        this.map_ = {};\n        this.id_ = constants.minSafeInteger;\n    }\n    /**\n     * Registers the given request with this map.\n     * The request is unregistered when it completes.\n     * @param r The request to register.\n     */\n    RequestMap.prototype.addRequest = function (r) {\n        var id = this.id_;\n        this.id_++;\n        this.map_[id] = r;\n        var self = this;\n        function unmap() {\n            delete self.map_[id];\n        }\n        r.getPromise().then(unmap, unmap);\n    };\n    /**\n     * Cancels all registered requests.\n     */\n    RequestMap.prototype.clear = function () {\n        object.forEach(this.map_, function (key, val) {\n            if (val) {\n                val.cancel(true);\n            }\n        });\n        this.map_ = {};\n    };\n    return RequestMap;\n}());\nexports.RequestMap = RequestMap;\n\n\n\n},{\"./constants\":108,\"./object\":115}],122:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar array = require(\"./array\");\nvar blob_1 = require(\"./blob\");\nvar errorsExports = require(\"./error\");\nvar MetadataUtils = require(\"./metadata\");\nvar object = require(\"./object\");\nvar requestinfo_1 = require(\"./requestinfo\");\nvar type = require(\"./type\");\nvar UrlUtils = require(\"./url\");\n/**\n * Throws the UNKNOWN FirebaseStorageError if cndn is false.\n */\nfunction handlerCheck(cndn) {\n    if (!cndn) {\n        throw errorsExports.unknown();\n    }\n}\nexports.handlerCheck = handlerCheck;\nfunction metadataHandler(authWrapper, mappings) {\n    function handler(xhr, text) {\n        var metadata = MetadataUtils.fromResourceString(authWrapper, text, mappings);\n        handlerCheck(metadata !== null);\n        return metadata;\n    }\n    return handler;\n}\nexports.metadataHandler = metadataHandler;\nfunction sharedErrorHandler(location) {\n    function errorHandler(xhr, err) {\n        var newErr;\n        if (xhr.getStatus() === 401) {\n            newErr = errorsExports.unauthenticated();\n        }\n        else {\n            if (xhr.getStatus() === 402) {\n                newErr = errorsExports.quotaExceeded(location.bucket);\n            }\n            else {\n                if (xhr.getStatus() === 403) {\n                    newErr = errorsExports.unauthorized(location.path);\n                }\n                else {\n                    newErr = err;\n                }\n            }\n        }\n        newErr.setServerResponseProp(err.serverResponseProp());\n        return newErr;\n    }\n    return errorHandler;\n}\nexports.sharedErrorHandler = sharedErrorHandler;\nfunction objectErrorHandler(location) {\n    var shared = sharedErrorHandler(location);\n    function errorHandler(xhr, err) {\n        var newErr = shared(xhr, err);\n        if (xhr.getStatus() === 404) {\n            newErr = errorsExports.objectNotFound(location.path);\n        }\n        newErr.setServerResponseProp(err.serverResponseProp());\n        return newErr;\n    }\n    return errorHandler;\n}\nexports.objectErrorHandler = objectErrorHandler;\nfunction getMetadata(authWrapper, location, mappings) {\n    var urlPart = location.fullServerUrl();\n    var url = UrlUtils.makeNormalUrl(urlPart);\n    var method = 'GET';\n    var timeout = authWrapper.maxOperationRetryTime();\n    var requestInfo = new requestinfo_1.RequestInfo(url, method, metadataHandler(authWrapper, mappings), timeout);\n    requestInfo.errorHandler = objectErrorHandler(location);\n    return requestInfo;\n}\nexports.getMetadata = getMetadata;\nfunction updateMetadata(authWrapper, location, metadata, mappings) {\n    var urlPart = location.fullServerUrl();\n    var url = UrlUtils.makeNormalUrl(urlPart);\n    var method = 'PATCH';\n    var body = MetadataUtils.toResourceString(metadata, mappings);\n    var headers = { 'Content-Type': 'application/json; charset=utf-8' };\n    var timeout = authWrapper.maxOperationRetryTime();\n    var requestInfo = new requestinfo_1.RequestInfo(url, method, metadataHandler(authWrapper, mappings), timeout);\n    requestInfo.headers = headers;\n    requestInfo.body = body;\n    requestInfo.errorHandler = objectErrorHandler(location);\n    return requestInfo;\n}\nexports.updateMetadata = updateMetadata;\nfunction deleteObject(authWrapper, location) {\n    var urlPart = location.fullServerUrl();\n    var url = UrlUtils.makeNormalUrl(urlPart);\n    var method = 'DELETE';\n    var timeout = authWrapper.maxOperationRetryTime();\n    function handler(xhr, text) { }\n    var requestInfo = new requestinfo_1.RequestInfo(url, method, handler, timeout);\n    requestInfo.successCodes = [200, 204];\n    requestInfo.errorHandler = objectErrorHandler(location);\n    return requestInfo;\n}\nexports.deleteObject = deleteObject;\nfunction determineContentType_(metadata, blob) {\n    return ((metadata && metadata['contentType']) ||\n        (blob && blob.type()) ||\n        'application/octet-stream');\n}\nexports.determineContentType_ = determineContentType_;\nfunction metadataForUpload_(location, blob, opt_metadata) {\n    var metadata = object.clone(opt_metadata);\n    metadata['fullPath'] = location.path;\n    metadata['size'] = blob.size();\n    if (!metadata['contentType']) {\n        metadata['contentType'] = determineContentType_(null, blob);\n    }\n    return metadata;\n}\nexports.metadataForUpload_ = metadataForUpload_;\nfunction multipartUpload(authWrapper, location, mappings, blob, opt_metadata) {\n    var urlPart = location.bucketOnlyServerUrl();\n    var headers = {\n        'X-Goog-Upload-Protocol': 'multipart'\n    };\n    function genBoundary() {\n        var str = '';\n        for (var i = 0; i < 2; i++) {\n            str =\n                str +\n                    Math.random()\n                        .toString()\n                        .slice(2);\n        }\n        return str;\n    }\n    var boundary = genBoundary();\n    headers['Content-Type'] = 'multipart/related; boundary=' + boundary;\n    var metadata = metadataForUpload_(location, blob, opt_metadata);\n    var metadataString = MetadataUtils.toResourceString(metadata, mappings);\n    var preBlobPart = '--' +\n        boundary +\n        '\\r\\n' +\n        'Content-Type: application/json; charset=utf-8\\r\\n\\r\\n' +\n        metadataString +\n        '\\r\\n--' +\n        boundary +\n        '\\r\\n' +\n        'Content-Type: ' +\n        metadata['contentType'] +\n        '\\r\\n\\r\\n';\n    var postBlobPart = '\\r\\n--' + boundary + '--';\n    var body = blob_1.FbsBlob.getBlob(preBlobPart, blob, postBlobPart);\n    if (body === null) {\n        throw errorsExports.cannotSliceBlob();\n    }\n    var urlParams = { name: metadata['fullPath'] };\n    var url = UrlUtils.makeUploadUrl(urlPart);\n    var method = 'POST';\n    var timeout = authWrapper.maxUploadRetryTime();\n    var requestInfo = new requestinfo_1.RequestInfo(url, method, metadataHandler(authWrapper, mappings), timeout);\n    requestInfo.urlParams = urlParams;\n    requestInfo.headers = headers;\n    requestInfo.body = body.uploadData();\n    requestInfo.errorHandler = sharedErrorHandler(location);\n    return requestInfo;\n}\nexports.multipartUpload = multipartUpload;\n/**\n * @param current The number of bytes that have been uploaded so far.\n * @param total The total number of bytes in the upload.\n * @param opt_finalized True if the server has finished the upload.\n * @param opt_metadata The upload metadata, should\n *     only be passed if opt_finalized is true.\n * @struct\n */\nvar ResumableUploadStatus = /** @class */ (function () {\n    function ResumableUploadStatus(current, total, finalized, metadata) {\n        this.current = current;\n        this.total = total;\n        this.finalized = !!finalized;\n        this.metadata = metadata || null;\n    }\n    return ResumableUploadStatus;\n}());\nexports.ResumableUploadStatus = ResumableUploadStatus;\nfunction checkResumeHeader_(xhr, opt_allowed) {\n    var status;\n    try {\n        status = xhr.getResponseHeader('X-Goog-Upload-Status');\n    }\n    catch (e) {\n        handlerCheck(false);\n    }\n    var allowed = opt_allowed || ['active'];\n    handlerCheck(array.contains(allowed, status));\n    return status;\n}\nexports.checkResumeHeader_ = checkResumeHeader_;\nfunction createResumableUpload(authWrapper, location, mappings, blob, opt_metadata) {\n    var urlPart = location.bucketOnlyServerUrl();\n    var metadata = metadataForUpload_(location, blob, opt_metadata);\n    var urlParams = { name: metadata['fullPath'] };\n    var url = UrlUtils.makeUploadUrl(urlPart);\n    var method = 'POST';\n    var headers = {\n        'X-Goog-Upload-Protocol': 'resumable',\n        'X-Goog-Upload-Command': 'start',\n        'X-Goog-Upload-Header-Content-Length': blob.size(),\n        'X-Goog-Upload-Header-Content-Type': metadata['contentType'],\n        'Content-Type': 'application/json; charset=utf-8'\n    };\n    var body = MetadataUtils.toResourceString(metadata, mappings);\n    var timeout = authWrapper.maxUploadRetryTime();\n    function handler(xhr, text) {\n        checkResumeHeader_(xhr);\n        var url;\n        try {\n            url = xhr.getResponseHeader('X-Goog-Upload-URL');\n        }\n        catch (e) {\n            handlerCheck(false);\n        }\n        handlerCheck(type.isString(url));\n        return url;\n    }\n    var requestInfo = new requestinfo_1.RequestInfo(url, method, handler, timeout);\n    requestInfo.urlParams = urlParams;\n    requestInfo.headers = headers;\n    requestInfo.body = body;\n    requestInfo.errorHandler = sharedErrorHandler(location);\n    return requestInfo;\n}\nexports.createResumableUpload = createResumableUpload;\n/**\n * @param url From a call to fbs.requests.createResumableUpload.\n */\nfunction getResumableUploadStatus(authWrapper, location, url, blob) {\n    var headers = { 'X-Goog-Upload-Command': 'query' };\n    function handler(xhr, text) {\n        var status = checkResumeHeader_(xhr, ['active', 'final']);\n        var sizeString;\n        try {\n            sizeString = xhr.getResponseHeader('X-Goog-Upload-Size-Received');\n        }\n        catch (e) {\n            handlerCheck(false);\n        }\n        var size = parseInt(sizeString, 10);\n        handlerCheck(!isNaN(size));\n        return new ResumableUploadStatus(size, blob.size(), status === 'final');\n    }\n    var method = 'POST';\n    var timeout = authWrapper.maxUploadRetryTime();\n    var requestInfo = new requestinfo_1.RequestInfo(url, method, handler, timeout);\n    requestInfo.headers = headers;\n    requestInfo.errorHandler = sharedErrorHandler(location);\n    return requestInfo;\n}\nexports.getResumableUploadStatus = getResumableUploadStatus;\n/**\n * Any uploads via the resumable upload API must transfer a number of bytes\n * that is a multiple of this number.\n */\nexports.resumableUploadChunkSize = 256 * 1024;\n/**\n * @param url From a call to fbs.requests.createResumableUpload.\n * @param chunkSize Number of bytes to upload.\n * @param opt_status The previous status.\n *     If not passed or null, we start from the beginning.\n * @throws fbs.Error If the upload is already complete, the passed in status\n *     has a final size inconsistent with the blob, or the blob cannot be sliced\n *     for upload.\n */\nfunction continueResumableUpload(location, authWrapper, url, blob, chunkSize, mappings, opt_status, opt_progressCallback) {\n    // TODO(andysoto): standardize on internal asserts\n    // assert(!(opt_status && opt_status.finalized));\n    var status = new ResumableUploadStatus(0, 0);\n    if (opt_status) {\n        status.current = opt_status.current;\n        status.total = opt_status.total;\n    }\n    else {\n        status.current = 0;\n        status.total = blob.size();\n    }\n    if (blob.size() !== status.total) {\n        throw errorsExports.serverFileWrongSize();\n    }\n    var bytesLeft = status.total - status.current;\n    var bytesToUpload = bytesLeft;\n    if (chunkSize > 0) {\n        bytesToUpload = Math.min(bytesToUpload, chunkSize);\n    }\n    var startByte = status.current;\n    var endByte = startByte + bytesToUpload;\n    var uploadCommand = bytesToUpload === bytesLeft ? 'upload, finalize' : 'upload';\n    var headers = {\n        'X-Goog-Upload-Command': uploadCommand,\n        'X-Goog-Upload-Offset': status.current\n    };\n    var body = blob.slice(startByte, endByte);\n    if (body === null) {\n        throw errorsExports.cannotSliceBlob();\n    }\n    function handler(xhr, text) {\n        // TODO(andysoto): Verify the MD5 of each uploaded range:\n        // the 'x-range-md5' header comes back with status code 308 responses.\n        // We'll only be able to bail out though, because you can't re-upload a\n        // range that you previously uploaded.\n        var uploadStatus = checkResumeHeader_(xhr, ['active', 'final']);\n        var newCurrent = status.current + bytesToUpload;\n        var size = blob.size();\n        var metadata;\n        if (uploadStatus === 'final') {\n            metadata = metadataHandler(authWrapper, mappings)(xhr, text);\n        }\n        else {\n            metadata = null;\n        }\n        return new ResumableUploadStatus(newCurrent, size, uploadStatus === 'final', metadata);\n    }\n    var method = 'POST';\n    var timeout = authWrapper.maxUploadRetryTime();\n    var requestInfo = new requestinfo_1.RequestInfo(url, method, handler, timeout);\n    requestInfo.headers = headers;\n    requestInfo.body = body.uploadData();\n    requestInfo.progressCallback = opt_progressCallback || null;\n    requestInfo.errorHandler = sharedErrorHandler(location);\n    return requestInfo;\n}\nexports.continueResumableUpload = continueResumableUpload;\n\n\n\n},{\"./array\":103,\"./blob\":107,\"./error\":109,\"./metadata\":114,\"./object\":115,\"./requestinfo\":120,\"./type\":125,\"./url\":126}],123:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar errorsExports = require(\"./error\");\nexports.StringFormat = {\n    RAW: 'raw',\n    BASE64: 'base64',\n    BASE64URL: 'base64url',\n    DATA_URL: 'data_url'\n};\nfunction formatValidator(stringFormat) {\n    switch (stringFormat) {\n        case exports.StringFormat.RAW:\n        case exports.StringFormat.BASE64:\n        case exports.StringFormat.BASE64URL:\n        case exports.StringFormat.DATA_URL:\n            return;\n        default:\n            throw 'Expected one of the event types: [' +\n                exports.StringFormat.RAW +\n                ', ' +\n                exports.StringFormat.BASE64 +\n                ', ' +\n                exports.StringFormat.BASE64URL +\n                ', ' +\n                exports.StringFormat.DATA_URL +\n                '].';\n    }\n}\nexports.formatValidator = formatValidator;\n/**\n * @struct\n */\nvar StringData = /** @class */ (function () {\n    function StringData(data, opt_contentType) {\n        this.data = data;\n        this.contentType = opt_contentType || null;\n    }\n    return StringData;\n}());\nexports.StringData = StringData;\nfunction dataFromString(format, string) {\n    switch (format) {\n        case exports.StringFormat.RAW:\n            return new StringData(utf8Bytes_(string));\n        case exports.StringFormat.BASE64:\n        case exports.StringFormat.BASE64URL:\n            return new StringData(base64Bytes_(format, string));\n        case exports.StringFormat.DATA_URL:\n            return new StringData(dataURLBytes_(string), dataURLContentType_(string));\n    }\n    // assert(false);\n    throw errorsExports.unknown();\n}\nexports.dataFromString = dataFromString;\nfunction utf8Bytes_(string) {\n    var b = [];\n    for (var i = 0; i < string.length; i++) {\n        var c = string.charCodeAt(i);\n        if (c <= 127) {\n            b.push(c);\n        }\n        else {\n            if (c <= 2047) {\n                b.push(192 | (c >> 6), 128 | (c & 63));\n            }\n            else {\n                if ((c & 64512) == 55296) {\n                    // The start of a surrogate pair.\n                    var valid = i < string.length - 1 &&\n                        (string.charCodeAt(i + 1) & 64512) == 56320;\n                    if (!valid) {\n                        // The second surrogate wasn't there.\n                        b.push(239, 191, 189);\n                    }\n                    else {\n                        var hi = c;\n                        var lo = string.charCodeAt(++i);\n                        c = 65536 | ((hi & 1023) << 10) | (lo & 1023);\n                        b.push(240 | (c >> 18), 128 | ((c >> 12) & 63), 128 | ((c >> 6) & 63), 128 | (c & 63));\n                    }\n                }\n                else {\n                    if ((c & 64512) == 56320) {\n                        // Invalid low surrogate.\n                        b.push(239, 191, 189);\n                    }\n                    else {\n                        b.push(224 | (c >> 12), 128 | ((c >> 6) & 63), 128 | (c & 63));\n                    }\n                }\n            }\n        }\n    }\n    return new Uint8Array(b);\n}\nexports.utf8Bytes_ = utf8Bytes_;\nfunction percentEncodedBytes_(string) {\n    var decoded;\n    try {\n        decoded = decodeURIComponent(string);\n    }\n    catch (e) {\n        throw errorsExports.invalidFormat(exports.StringFormat.DATA_URL, 'Malformed data URL.');\n    }\n    return utf8Bytes_(decoded);\n}\nexports.percentEncodedBytes_ = percentEncodedBytes_;\nfunction base64Bytes_(format, string) {\n    switch (format) {\n        case exports.StringFormat.BASE64: {\n            var hasMinus = string.indexOf('-') !== -1;\n            var hasUnder = string.indexOf('_') !== -1;\n            if (hasMinus || hasUnder) {\n                var invalidChar = hasMinus ? '-' : '_';\n                throw errorsExports.invalidFormat(format, \"Invalid character '\" +\n                    invalidChar +\n                    \"' found: is it base64url encoded?\");\n            }\n            break;\n        }\n        case exports.StringFormat.BASE64URL: {\n            var hasPlus = string.indexOf('+') !== -1;\n            var hasSlash = string.indexOf('/') !== -1;\n            if (hasPlus || hasSlash) {\n                var invalidChar = hasPlus ? '+' : '/';\n                throw errorsExports.invalidFormat(format, \"Invalid character '\" + invalidChar + \"' found: is it base64 encoded?\");\n            }\n            string = string.replace(/-/g, '+').replace(/_/g, '/');\n            break;\n        }\n    }\n    var bytes;\n    try {\n        bytes = atob(string);\n    }\n    catch (e) {\n        throw errorsExports.invalidFormat(format, 'Invalid character found');\n    }\n    var array = new Uint8Array(bytes.length);\n    for (var i = 0; i < bytes.length; i++) {\n        array[i] = bytes.charCodeAt(i);\n    }\n    return array;\n}\nexports.base64Bytes_ = base64Bytes_;\n/**\n * @struct\n */\nvar DataURLParts = /** @class */ (function () {\n    function DataURLParts(dataURL) {\n        this.base64 = false;\n        this.contentType = null;\n        var matches = dataURL.match(/^data:([^,]+)?,/);\n        if (matches === null) {\n            throw errorsExports.invalidFormat(exports.StringFormat.DATA_URL, \"Must be formatted 'data:[<mediatype>][;base64],<data>\");\n        }\n        var middle = matches[1] || null;\n        if (middle != null) {\n            this.base64 = endsWith(middle, ';base64');\n            this.contentType = this.base64\n                ? middle.substring(0, middle.length - ';base64'.length)\n                : middle;\n        }\n        this.rest = dataURL.substring(dataURL.indexOf(',') + 1);\n    }\n    return DataURLParts;\n}());\nfunction dataURLBytes_(string) {\n    var parts = new DataURLParts(string);\n    if (parts.base64) {\n        return base64Bytes_(exports.StringFormat.BASE64, parts.rest);\n    }\n    else {\n        return percentEncodedBytes_(parts.rest);\n    }\n}\nexports.dataURLBytes_ = dataURLBytes_;\nfunction dataURLContentType_(string) {\n    var parts = new DataURLParts(string);\n    return parts.contentType;\n}\nexports.dataURLContentType_ = dataURLContentType_;\nfunction endsWith(s, end) {\n    var longEnough = s.length >= end.length;\n    if (!longEnough) {\n        return false;\n    }\n    return s.substring(s.length - end.length) === end;\n}\n\n\n\n},{\"./error\":109}],124:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.TaskEvent = {\n    /** Triggered whenever the task changes or progress is updated. */\n    STATE_CHANGED: 'state_changed'\n};\nexports.InternalTaskState = {\n    RUNNING: 'running',\n    PAUSING: 'pausing',\n    PAUSED: 'paused',\n    SUCCESS: 'success',\n    CANCELING: 'canceling',\n    CANCELED: 'canceled',\n    ERROR: 'error'\n};\nexports.TaskState = {\n    /** The task is currently transferring data. */\n    RUNNING: 'running',\n    /** The task was paused by the user. */\n    PAUSED: 'paused',\n    /** The task completed successfully. */\n    SUCCESS: 'success',\n    /** The task was canceled. */\n    CANCELED: 'canceled',\n    /** The task failed with an error. */\n    ERROR: 'error'\n};\nfunction taskStateFromInternalTaskState(state) {\n    switch (state) {\n        case exports.InternalTaskState.RUNNING:\n        case exports.InternalTaskState.PAUSING:\n        case exports.InternalTaskState.CANCELING:\n            return exports.TaskState.RUNNING;\n        case exports.InternalTaskState.PAUSED:\n            return exports.TaskState.PAUSED;\n        case exports.InternalTaskState.SUCCESS:\n            return exports.TaskState.SUCCESS;\n        case exports.InternalTaskState.CANCELED:\n            return exports.TaskState.CANCELED;\n        case exports.InternalTaskState.ERROR:\n            return exports.TaskState.ERROR;\n        default:\n            // TODO(andysoto): assert(false);\n            return exports.TaskState.ERROR;\n    }\n}\nexports.taskStateFromInternalTaskState = taskStateFromInternalTaskState;\n\n\n\n},{}],125:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * @return False if the object is undefined or null, true otherwise.\n */\nfunction isDef(p) {\n    return p != null;\n}\nexports.isDef = isDef;\nfunction isJustDef(p) {\n    return p !== void 0;\n}\nexports.isJustDef = isJustDef;\nfunction isFunction(p) {\n    return typeof p === 'function';\n}\nexports.isFunction = isFunction;\nfunction isObject(p) {\n    return typeof p === 'object';\n}\nexports.isObject = isObject;\nfunction isNonNullObject(p) {\n    return isObject(p) && p !== null;\n}\nexports.isNonNullObject = isNonNullObject;\nfunction isNonArrayObject(p) {\n    return isObject(p) && !Array.isArray(p);\n}\nexports.isNonArrayObject = isNonArrayObject;\nfunction isString(p) {\n    return typeof p === 'string' || p instanceof String;\n}\nexports.isString = isString;\nfunction isNumber(p) {\n    return typeof p === 'number' || p instanceof Number;\n}\nexports.isNumber = isNumber;\nfunction isNativeBlob(p) {\n    return isNativeBlobDefined() && p instanceof Blob;\n}\nexports.isNativeBlob = isNativeBlob;\nfunction isNativeBlobDefined() {\n    return typeof Blob !== 'undefined';\n}\nexports.isNativeBlobDefined = isNativeBlobDefined;\n\n\n\n},{}],126:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * @fileoverview Functions to create and manipulate URLs for the server API.\n */\nvar constants = require(\"./constants\");\nvar object = require(\"./object\");\nfunction makeNormalUrl(urlPart) {\n    return constants.domainBase + constants.apiBaseUrl + urlPart;\n}\nexports.makeNormalUrl = makeNormalUrl;\nfunction makeDownloadUrl(urlPart) {\n    return constants.downloadBase + constants.apiBaseUrl + urlPart;\n}\nexports.makeDownloadUrl = makeDownloadUrl;\nfunction makeUploadUrl(urlPart) {\n    return constants.domainBase + constants.apiUploadBaseUrl + urlPart;\n}\nexports.makeUploadUrl = makeUploadUrl;\nfunction makeQueryString(params) {\n    var encode = encodeURIComponent;\n    var queryPart = '?';\n    object.forEach(params, function (key, val) {\n        var nextPart = encode(key) + '=' + encode(val);\n        queryPart = queryPart + nextPart + '&';\n    });\n    // Chop off the extra '&' or '?' on the end\n    queryPart = queryPart.slice(0, -1);\n    return queryPart;\n}\nexports.makeQueryString = makeQueryString;\n\n\n\n},{\"./constants\":108,\"./object\":115}],127:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * @enum{number}\n */\nvar ErrorCode;\n(function (ErrorCode) {\n    ErrorCode[ErrorCode[\"NO_ERROR\"] = 0] = \"NO_ERROR\";\n    ErrorCode[ErrorCode[\"NETWORK_ERROR\"] = 1] = \"NETWORK_ERROR\";\n    ErrorCode[ErrorCode[\"ABORT\"] = 2] = \"ABORT\";\n})(ErrorCode = exports.ErrorCode || (exports.ErrorCode = {}));\n\n\n\n},{}],128:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar errorsExports = require(\"./error\");\nvar object = require(\"./object\");\nvar promiseimpl = require(\"./promise_external\");\nvar type = require(\"./type\");\nvar XhrIoExports = require(\"./xhrio\");\n/**\n * We use this instead of goog.net.XhrIo because goog.net.XhrIo is hyuuuuge and\n * doesn't work in React Native on Android.\n */\nvar NetworkXhrIo = /** @class */ (function () {\n    function NetworkXhrIo() {\n        var _this = this;\n        this.sent_ = false;\n        this.xhr_ = new XMLHttpRequest();\n        this.errorCode_ = XhrIoExports.ErrorCode.NO_ERROR;\n        this.sendPromise_ = promiseimpl.make(function (resolve, reject) {\n            _this.xhr_.addEventListener('abort', function (event) {\n                _this.errorCode_ = XhrIoExports.ErrorCode.ABORT;\n                resolve(_this);\n            });\n            _this.xhr_.addEventListener('error', function (event) {\n                _this.errorCode_ = XhrIoExports.ErrorCode.NETWORK_ERROR;\n                resolve(_this);\n            });\n            _this.xhr_.addEventListener('load', function (event) {\n                resolve(_this);\n            });\n        });\n    }\n    /**\n     * @override\n     */\n    NetworkXhrIo.prototype.send = function (url, method, opt_body, opt_headers) {\n        var _this = this;\n        if (this.sent_) {\n            throw errorsExports.internalError('cannot .send() more than once');\n        }\n        this.sent_ = true;\n        this.xhr_.open(method, url, true);\n        if (type.isDef(opt_headers)) {\n            var headers = opt_headers;\n            object.forEach(headers, function (key, val) {\n                _this.xhr_.setRequestHeader(key, val.toString());\n            });\n        }\n        if (type.isDef(opt_body)) {\n            this.xhr_.send(opt_body);\n        }\n        else {\n            this.xhr_.send();\n        }\n        return this.sendPromise_;\n    };\n    /**\n     * @override\n     */\n    NetworkXhrIo.prototype.getErrorCode = function () {\n        if (!this.sent_) {\n            throw errorsExports.internalError('cannot .getErrorCode() before sending');\n        }\n        return this.errorCode_;\n    };\n    /**\n     * @override\n     */\n    NetworkXhrIo.prototype.getStatus = function () {\n        if (!this.sent_) {\n            throw errorsExports.internalError('cannot .getStatus() before sending');\n        }\n        try {\n            return this.xhr_.status;\n        }\n        catch (e) {\n            return -1;\n        }\n    };\n    /**\n     * @override\n     */\n    NetworkXhrIo.prototype.getResponseText = function () {\n        if (!this.sent_) {\n            throw errorsExports.internalError('cannot .getResponseText() before sending');\n        }\n        return this.xhr_.responseText;\n    };\n    /**\n     * Aborts the request.\n     * @override\n     */\n    NetworkXhrIo.prototype.abort = function () {\n        this.xhr_.abort();\n    };\n    /**\n     * @override\n     */\n    NetworkXhrIo.prototype.getResponseHeader = function (header) {\n        return this.xhr_.getResponseHeader(header);\n    };\n    /**\n     * @override\n     */\n    NetworkXhrIo.prototype.addUploadProgressListener = function (listener) {\n        if (type.isDef(this.xhr_.upload)) {\n            this.xhr_.upload.addEventListener('progress', listener);\n        }\n    };\n    /**\n     * @override\n     */\n    NetworkXhrIo.prototype.removeUploadProgressListener = function (listener) {\n        if (type.isDef(this.xhr_.upload)) {\n            this.xhr_.upload.removeEventListener('progress', listener);\n        }\n    };\n    return NetworkXhrIo;\n}());\nexports.NetworkXhrIo = NetworkXhrIo;\n\n\n\n},{\"./error\":109,\"./object\":115,\"./promise_external\":118,\"./type\":125,\"./xhrio\":127}],129:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar xhrio_network_1 = require(\"./xhrio_network\");\n/**\n * Factory-like class for creating XhrIo instances.\n */\nvar XhrIoPool = /** @class */ (function () {\n    function XhrIoPool() {\n    }\n    XhrIoPool.prototype.createXhrIo = function () {\n        return new xhrio_network_1.NetworkXhrIo();\n    };\n    return XhrIoPool;\n}());\nexports.XhrIoPool = XhrIoPool;\n\n\n\n},{\"./xhrio_network\":128}],130:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * @fileoverview Defines the Firebase Storage Reference class.\n */\nvar args = require(\"./implementation/args\");\nvar blob_1 = require(\"./implementation/blob\");\nvar errorsExports = require(\"./implementation/error\");\nvar location_1 = require(\"./implementation/location\");\nvar metadata = require(\"./implementation/metadata\");\nvar object = require(\"./implementation/object\");\nvar path = require(\"./implementation/path\");\nvar requests = require(\"./implementation/requests\");\nvar fbsString = require(\"./implementation/string\");\nvar string_1 = require(\"./implementation/string\");\nvar type = require(\"./implementation/type\");\nvar task_1 = require(\"./task\");\n/**\n * Provides methods to interact with a bucket in the Firebase Storage service.\n * @param location An fbs.location, or the URL at\n *     which to base this object, in one of the following forms:\n *         gs://<bucket>/<object-path>\n *         http[s]://firebasestorage.googleapis.com/\n *                     <api-version>/b/<bucket>/o/<object-path>\n *     Any query or fragment strings will be ignored in the http[s]\n *     format. If no value is passed, the storage object will use a URL based on\n *     the project ID of the base firebase.App instance.\n */\nvar Reference = /** @class */ (function () {\n    function Reference(authWrapper, location) {\n        this.authWrapper = authWrapper;\n        if (location instanceof location_1.Location) {\n            this.location = location;\n        }\n        else {\n            this.location = location_1.Location.makeFromUrl(location);\n        }\n    }\n    /**\n     * @return The URL for the bucket and path this object references,\n     *     in the form gs://<bucket>/<object-path>\n     * @override\n     */\n    Reference.prototype.toString = function () {\n        args.validate('toString', [], arguments);\n        return 'gs://' + this.location.bucket + '/' + this.location.path;\n    };\n    Reference.prototype.newRef = function (authWrapper, location) {\n        return new Reference(authWrapper, location);\n    };\n    Reference.prototype.mappings = function () {\n        return metadata.getMappings();\n    };\n    /**\n     * @return A reference to the object obtained by\n     *     appending childPath, removing any duplicate, beginning, or trailing\n     *     slashes.\n     */\n    Reference.prototype.child = function (childPath) {\n        args.validate('child', [args.stringSpec()], arguments);\n        var newPath = path.child(this.location.path, childPath);\n        var location = new location_1.Location(this.location.bucket, newPath);\n        return this.newRef(this.authWrapper, location);\n    };\n    Object.defineProperty(Reference.prototype, \"parent\", {\n        /**\n         * @return A reference to the parent of the\n         *     current object, or null if the current object is the root.\n         */\n        get: function () {\n            var newPath = path.parent(this.location.path);\n            if (newPath === null) {\n                return null;\n            }\n            var location = new location_1.Location(this.location.bucket, newPath);\n            return this.newRef(this.authWrapper, location);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Reference.prototype, \"root\", {\n        /**\n         * @return An reference to the root of this\n         *     object's bucket.\n         */\n        get: function () {\n            var location = new location_1.Location(this.location.bucket, '');\n            return this.newRef(this.authWrapper, location);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Reference.prototype, \"bucket\", {\n        get: function () {\n            return this.location.bucket;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Reference.prototype, \"fullPath\", {\n        get: function () {\n            return this.location.path;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Reference.prototype, \"name\", {\n        get: function () {\n            return path.lastComponent(this.location.path);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Reference.prototype, \"storage\", {\n        get: function () {\n            return this.authWrapper.service();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Uploads a blob to this object's location.\n     * @param data The blob to upload.\n     * @return An UploadTask that lets you control and\n     *     observe the upload.\n     */\n    Reference.prototype.put = function (data, metadata) {\n        if (metadata === void 0) { metadata = null; }\n        args.validate('put', [args.uploadDataSpec(), args.metadataSpec(true)], arguments);\n        this.throwIfRoot_('put');\n        return new task_1.UploadTask(this, this.authWrapper, this.location, this.mappings(), new blob_1.FbsBlob(data), metadata);\n    };\n    /**\n     * Uploads a string to this object's location.\n     * @param string The string to upload.\n     * @param opt_format The format of the string to upload.\n     * @return An UploadTask that lets you control and\n     *     observe the upload.\n     */\n    Reference.prototype.putString = function (string, format, opt_metadata) {\n        if (format === void 0) { format = string_1.StringFormat.RAW; }\n        args.validate('putString', [\n            args.stringSpec(),\n            args.stringSpec(fbsString.formatValidator, true),\n            args.metadataSpec(true)\n        ], arguments);\n        this.throwIfRoot_('putString');\n        var data = fbsString.dataFromString(format, string);\n        var metadata = object.clone(opt_metadata);\n        if (!type.isDef(metadata['contentType']) && type.isDef(data.contentType)) {\n            metadata['contentType'] = data.contentType;\n        }\n        return new task_1.UploadTask(this, this.authWrapper, this.location, this.mappings(), new blob_1.FbsBlob(data.data, true), metadata);\n    };\n    /**\n     * Deletes the object at this location.\n     * @return A promise that resolves if the deletion succeeds.\n     */\n    Reference.prototype.delete = function () {\n        args.validate('delete', [], arguments);\n        this.throwIfRoot_('delete');\n        var self = this;\n        return this.authWrapper.getAuthToken().then(function (authToken) {\n            var requestInfo = requests.deleteObject(self.authWrapper, self.location);\n            return self.authWrapper.makeRequest(requestInfo, authToken).getPromise();\n        });\n    };\n    /**\n     *     A promise that resolves with the metadata for this object. If this\n     *     object doesn't exist or metadata cannot be retreived, the promise is\n     *     rejected.\n     */\n    Reference.prototype.getMetadata = function () {\n        args.validate('getMetadata', [], arguments);\n        this.throwIfRoot_('getMetadata');\n        var self = this;\n        return this.authWrapper.getAuthToken().then(function (authToken) {\n            var requestInfo = requests.getMetadata(self.authWrapper, self.location, self.mappings());\n            return self.authWrapper.makeRequest(requestInfo, authToken).getPromise();\n        });\n    };\n    /**\n     * Updates the metadata for this object.\n     * @param metadata The new metadata for the object.\n     *     Only values that have been explicitly set will be changed. Explicitly\n     *     setting a value to null will remove the metadata.\n     * @return A promise that resolves\n     *     with the new metadata for this object.\n     *     @see firebaseStorage.Reference.prototype.getMetadata\n     */\n    Reference.prototype.updateMetadata = function (metadata) {\n        args.validate('updateMetadata', [args.metadataSpec()], arguments);\n        this.throwIfRoot_('updateMetadata');\n        var self = this;\n        return this.authWrapper.getAuthToken().then(function (authToken) {\n            var requestInfo = requests.updateMetadata(self.authWrapper, self.location, metadata, self.mappings());\n            return self.authWrapper.makeRequest(requestInfo, authToken).getPromise();\n        });\n    };\n    /**\n     * @return A promise that resolves with the download\n     *     URL for this object.\n     */\n    Reference.prototype.getDownloadURL = function () {\n        args.validate('getDownloadURL', [], arguments);\n        this.throwIfRoot_('getDownloadURL');\n        return this.getMetadata().then(function (metadata) {\n            var url = metadata['downloadURLs'][0];\n            if (type.isDef(url)) {\n                return url;\n            }\n            else {\n                throw errorsExports.noDownloadURL();\n            }\n        });\n    };\n    Reference.prototype.throwIfRoot_ = function (name) {\n        if (this.location.path === '') {\n            throw errorsExports.invalidRootOperation(name);\n        }\n    };\n    return Reference;\n}());\nexports.Reference = Reference;\n\n\n\n},{\"./implementation/args\":102,\"./implementation/blob\":107,\"./implementation/error\":109,\"./implementation/location\":113,\"./implementation/metadata\":114,\"./implementation/object\":115,\"./implementation/path\":117,\"./implementation/requests\":122,\"./implementation/string\":123,\"./implementation/type\":125,\"./task\":132}],131:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar args = require(\"./implementation/args\");\nvar authwrapper_1 = require(\"./implementation/authwrapper\");\nvar location_1 = require(\"./implementation/location\");\nvar fbsPromiseImpl = require(\"./implementation/promise_external\");\nvar RequestExports = require(\"./implementation/request\");\nvar reference_1 = require(\"./reference\");\n/**\n * A service that provides firebaseStorage.Reference instances.\n * @param opt_url gs:// url to a custom Storage Bucket\n *\n * @struct\n */\nvar Service = /** @class */ (function () {\n    function Service(app, pool, url) {\n        this.bucket_ = null;\n        function maker(authWrapper, loc) {\n            return new reference_1.Reference(authWrapper, loc);\n        }\n        this.authWrapper_ = new authwrapper_1.AuthWrapper(app, maker, RequestExports.makeRequest, this, pool);\n        this.app_ = app;\n        if (url != null) {\n            this.bucket_ = location_1.Location.makeFromBucketSpec(url);\n        }\n        else {\n            var authWrapperBucket = this.authWrapper_.bucket();\n            if (authWrapperBucket != null) {\n                this.bucket_ = new location_1.Location(authWrapperBucket, '');\n            }\n        }\n        this.internals_ = new ServiceInternals(this);\n    }\n    /**\n     * Returns a firebaseStorage.Reference for the given path in the default\n     * bucket.\n     */\n    Service.prototype.ref = function (path) {\n        function validator(path) {\n            if (/^[A-Za-z]+:\\/\\//.test(path)) {\n                throw 'Expected child path but got a URL, use refFromURL instead.';\n            }\n        }\n        args.validate('ref', [args.stringSpec(validator, true)], arguments);\n        if (this.bucket_ == null) {\n            throw new Error('No Storage Bucket defined in Firebase Options.');\n        }\n        var ref = new reference_1.Reference(this.authWrapper_, this.bucket_);\n        if (path != null) {\n            return ref.child(path);\n        }\n        else {\n            return ref;\n        }\n    };\n    /**\n     * Returns a firebaseStorage.Reference object for the given absolute URL,\n     * which must be a gs:// or http[s]:// URL.\n     */\n    Service.prototype.refFromURL = function (url) {\n        function validator(p) {\n            if (!/^[A-Za-z]+:\\/\\//.test(p)) {\n                throw 'Expected full URL but got a child path, use ref instead.';\n            }\n            try {\n                location_1.Location.makeFromUrl(p);\n            }\n            catch (e) {\n                throw 'Expected valid full URL but got an invalid one.';\n            }\n        }\n        args.validate('refFromURL', [args.stringSpec(validator, false)], arguments);\n        return new reference_1.Reference(this.authWrapper_, url);\n    };\n    Object.defineProperty(Service.prototype, \"maxUploadRetryTime\", {\n        get: function () {\n            return this.authWrapper_.maxUploadRetryTime();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Service.prototype.setMaxUploadRetryTime = function (time) {\n        args.validate('setMaxUploadRetryTime', [args.nonNegativeNumberSpec()], arguments);\n        this.authWrapper_.setMaxUploadRetryTime(time);\n    };\n    Object.defineProperty(Service.prototype, \"maxOperationRetryTime\", {\n        get: function () {\n            return this.authWrapper_.maxOperationRetryTime();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Service.prototype.setMaxOperationRetryTime = function (time) {\n        args.validate('setMaxOperationRetryTime', [args.nonNegativeNumberSpec()], arguments);\n        this.authWrapper_.setMaxOperationRetryTime(time);\n    };\n    Object.defineProperty(Service.prototype, \"app\", {\n        get: function () {\n            return this.app_;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Service.prototype, \"INTERNAL\", {\n        get: function () {\n            return this.internals_;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return Service;\n}());\nexports.Service = Service;\n/**\n * @struct\n */\nvar ServiceInternals = /** @class */ (function () {\n    function ServiceInternals(service) {\n        this.service_ = service;\n    }\n    /**\n     * Called when the associated app is deleted.\n     * @see {!fbs.AuthWrapper.prototype.deleteApp}\n     */\n    ServiceInternals.prototype.delete = function () {\n        this.service_.authWrapper_.deleteApp();\n        return fbsPromiseImpl.resolve(undefined);\n    };\n    return ServiceInternals;\n}());\nexports.ServiceInternals = ServiceInternals;\n\n\n\n},{\"./implementation/args\":102,\"./implementation/authwrapper\":105,\"./implementation/location\":113,\"./implementation/promise_external\":118,\"./implementation/request\":119,\"./reference\":130}],132:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @fileoverview Defines types for interacting with blob transfer tasks.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar taskenums_1 = require(\"./implementation/taskenums\");\nvar observer_1 = require(\"./implementation/observer\");\nvar taskenums_2 = require(\"./implementation/taskenums\");\nvar tasksnapshot_1 = require(\"./tasksnapshot\");\nvar fbsArgs = require(\"./implementation/args\");\nvar fbsArray = require(\"./implementation/array\");\nvar async_1 = require(\"./implementation/async\");\nvar errors = require(\"./implementation/error\");\nvar fbsPromiseimpl = require(\"./implementation/promise_external\");\nvar fbsRequests = require(\"./implementation/requests\");\nvar fbsTaskEnums = require(\"./implementation/taskenums\");\nvar typeUtils = require(\"./implementation/type\");\n/**\n * Represents a blob being uploaded. Can be used to pause/resume/cancel the\n * upload and manage callbacks for various events.\n */\nvar UploadTask = /** @class */ (function () {\n    /**\n     * @param ref The firebaseStorage.Reference object this task came\n     *     from, untyped to avoid cyclic dependencies.\n     * @param blob The blob to upload.\n     */\n    function UploadTask(ref, authWrapper, location, mappings, blob, metadata) {\n        if (metadata === void 0) { metadata = null; }\n        var _this = this;\n        this.transferred_ = 0;\n        this.needToFetchStatus_ = false;\n        this.needToFetchMetadata_ = false;\n        this.observers_ = [];\n        this.error_ = null;\n        this.uploadUrl_ = null;\n        this.request_ = null;\n        this.chunkMultiplier_ = 1;\n        this.resolve_ = null;\n        this.reject_ = null;\n        this.ref_ = ref;\n        this.authWrapper_ = authWrapper;\n        this.location_ = location;\n        this.blob_ = blob;\n        this.metadata_ = metadata;\n        this.mappings_ = mappings;\n        this.resumable_ = this.shouldDoResumable_(this.blob_);\n        this.state_ = taskenums_1.InternalTaskState.RUNNING;\n        this.errorHandler_ = function (error) {\n            _this.request_ = null;\n            _this.chunkMultiplier_ = 1;\n            if (error.codeEquals(errors.Code.CANCELED)) {\n                _this.needToFetchStatus_ = true;\n                _this.completeTransitions_();\n            }\n            else {\n                _this.error_ = error;\n                _this.transition_(taskenums_1.InternalTaskState.ERROR);\n            }\n        };\n        this.metadataErrorHandler_ = function (error) {\n            _this.request_ = null;\n            if (error.codeEquals(errors.Code.CANCELED)) {\n                _this.completeTransitions_();\n            }\n            else {\n                _this.error_ = error;\n                _this.transition_(taskenums_1.InternalTaskState.ERROR);\n            }\n        };\n        this.promise_ = fbsPromiseimpl.make(function (resolve, reject) {\n            _this.resolve_ = resolve;\n            _this.reject_ = reject;\n            _this.start_();\n        });\n        // Prevent uncaught rejections on the internal promise from bubbling out\n        // to the top level with a dummy handler.\n        this.promise_.then(null, function () { });\n    }\n    UploadTask.prototype.makeProgressCallback_ = function () {\n        var _this = this;\n        var sizeBefore = this.transferred_;\n        return function (loaded, total) {\n            _this.updateProgress_(sizeBefore + loaded);\n        };\n    };\n    UploadTask.prototype.shouldDoResumable_ = function (blob) {\n        return blob.size() > 256 * 1024;\n    };\n    UploadTask.prototype.start_ = function () {\n        if (this.state_ !== taskenums_1.InternalTaskState.RUNNING) {\n            // This can happen if someone pauses us in a resume callback, for example.\n            return;\n        }\n        if (this.request_ !== null) {\n            return;\n        }\n        if (this.resumable_) {\n            if (this.uploadUrl_ === null) {\n                this.createResumable_();\n            }\n            else {\n                if (this.needToFetchStatus_) {\n                    this.fetchStatus_();\n                }\n                else {\n                    if (this.needToFetchMetadata_) {\n                        // Happens if we miss the metadata on upload completion.\n                        this.fetchMetadata_();\n                    }\n                    else {\n                        this.continueUpload_();\n                    }\n                }\n            }\n        }\n        else {\n            this.oneShotUpload_();\n        }\n    };\n    UploadTask.prototype.resolveToken_ = function (callback) {\n        var _this = this;\n        this.authWrapper_.getAuthToken().then(function (authToken) {\n            switch (_this.state_) {\n                case taskenums_1.InternalTaskState.RUNNING:\n                    callback(authToken);\n                    break;\n                case taskenums_1.InternalTaskState.CANCELING:\n                    _this.transition_(taskenums_1.InternalTaskState.CANCELED);\n                    break;\n                case taskenums_1.InternalTaskState.PAUSING:\n                    _this.transition_(taskenums_1.InternalTaskState.PAUSED);\n                    break;\n                default:\n            }\n        });\n    };\n    // TODO(andysoto): assert false\n    UploadTask.prototype.createResumable_ = function () {\n        var _this = this;\n        this.resolveToken_(function (authToken) {\n            var requestInfo = fbsRequests.createResumableUpload(_this.authWrapper_, _this.location_, _this.mappings_, _this.blob_, _this.metadata_);\n            var createRequest = _this.authWrapper_.makeRequest(requestInfo, authToken);\n            _this.request_ = createRequest;\n            createRequest.getPromise().then(function (url) {\n                _this.request_ = null;\n                _this.uploadUrl_ = url;\n                _this.needToFetchStatus_ = false;\n                _this.completeTransitions_();\n            }, _this.errorHandler_);\n        });\n    };\n    UploadTask.prototype.fetchStatus_ = function () {\n        var _this = this;\n        // TODO(andysoto): assert(this.uploadUrl_ !== null);\n        var url = this.uploadUrl_;\n        this.resolveToken_(function (authToken) {\n            var requestInfo = fbsRequests.getResumableUploadStatus(_this.authWrapper_, _this.location_, url, _this.blob_);\n            var statusRequest = _this.authWrapper_.makeRequest(requestInfo, authToken);\n            _this.request_ = statusRequest;\n            statusRequest.getPromise().then(function (status) {\n                status = status;\n                _this.request_ = null;\n                _this.updateProgress_(status.current);\n                _this.needToFetchStatus_ = false;\n                if (status.finalized) {\n                    _this.needToFetchMetadata_ = true;\n                }\n                _this.completeTransitions_();\n            }, _this.errorHandler_);\n        });\n    };\n    UploadTask.prototype.continueUpload_ = function () {\n        var _this = this;\n        var chunkSize = fbsRequests.resumableUploadChunkSize * this.chunkMultiplier_;\n        var status = new fbsRequests.ResumableUploadStatus(this.transferred_, this.blob_.size());\n        // TODO(andysoto): assert(this.uploadUrl_ !== null);\n        var url = this.uploadUrl_;\n        this.resolveToken_(function (authToken) {\n            var requestInfo;\n            try {\n                requestInfo = fbsRequests.continueResumableUpload(_this.location_, _this.authWrapper_, url, _this.blob_, chunkSize, _this.mappings_, status, _this.makeProgressCallback_());\n            }\n            catch (e) {\n                _this.error_ = e;\n                _this.transition_(taskenums_1.InternalTaskState.ERROR);\n                return;\n            }\n            var uploadRequest = _this.authWrapper_.makeRequest(requestInfo, authToken);\n            _this.request_ = uploadRequest;\n            uploadRequest\n                .getPromise()\n                .then(function (newStatus) {\n                _this.increaseMultiplier_();\n                _this.request_ = null;\n                _this.updateProgress_(newStatus.current);\n                if (newStatus.finalized) {\n                    _this.metadata_ = newStatus.metadata;\n                    _this.transition_(taskenums_1.InternalTaskState.SUCCESS);\n                }\n                else {\n                    _this.completeTransitions_();\n                }\n            }, _this.errorHandler_);\n        });\n    };\n    UploadTask.prototype.increaseMultiplier_ = function () {\n        var currentSize = fbsRequests.resumableUploadChunkSize * this.chunkMultiplier_;\n        // Max chunk size is 32M.\n        if (currentSize < 32 * 1024 * 1024) {\n            this.chunkMultiplier_ *= 2;\n        }\n    };\n    UploadTask.prototype.fetchMetadata_ = function () {\n        var _this = this;\n        this.resolveToken_(function (authToken) {\n            var requestInfo = fbsRequests.getMetadata(_this.authWrapper_, _this.location_, _this.mappings_);\n            var metadataRequest = _this.authWrapper_.makeRequest(requestInfo, authToken);\n            _this.request_ = metadataRequest;\n            metadataRequest.getPromise().then(function (metadata) {\n                _this.request_ = null;\n                _this.metadata_ = metadata;\n                _this.transition_(taskenums_1.InternalTaskState.SUCCESS);\n            }, _this.metadataErrorHandler_);\n        });\n    };\n    UploadTask.prototype.oneShotUpload_ = function () {\n        var _this = this;\n        this.resolveToken_(function (authToken) {\n            var requestInfo = fbsRequests.multipartUpload(_this.authWrapper_, _this.location_, _this.mappings_, _this.blob_, _this.metadata_);\n            var multipartRequest = _this.authWrapper_.makeRequest(requestInfo, authToken);\n            _this.request_ = multipartRequest;\n            multipartRequest.getPromise().then(function (metadata) {\n                _this.request_ = null;\n                _this.metadata_ = metadata;\n                _this.updateProgress_(_this.blob_.size());\n                _this.transition_(taskenums_1.InternalTaskState.SUCCESS);\n            }, _this.errorHandler_);\n        });\n    };\n    UploadTask.prototype.updateProgress_ = function (transferred) {\n        var old = this.transferred_;\n        this.transferred_ = transferred;\n        // A progress update can make the \"transferred\" value smaller (e.g. a\n        // partial upload not completed by server, after which the \"transferred\"\n        // value may reset to the value at the beginning of the request).\n        if (this.transferred_ !== old) {\n            this.notifyObservers_();\n        }\n    };\n    UploadTask.prototype.transition_ = function (state) {\n        if (this.state_ === state) {\n            return;\n        }\n        switch (state) {\n            case taskenums_1.InternalTaskState.CANCELING:\n                // TODO(andysoto):\n                // assert(this.state_ === InternalTaskState.RUNNING ||\n                //        this.state_ === InternalTaskState.PAUSING);\n                this.state_ = state;\n                if (this.request_ !== null) {\n                    this.request_.cancel();\n                }\n                break;\n            case taskenums_1.InternalTaskState.PAUSING:\n                // TODO(andysoto):\n                // assert(this.state_ === InternalTaskState.RUNNING);\n                this.state_ = state;\n                if (this.request_ !== null) {\n                    this.request_.cancel();\n                }\n                break;\n            case taskenums_1.InternalTaskState.RUNNING:\n                // TODO(andysoto):\n                // assert(this.state_ === InternalTaskState.PAUSED ||\n                //        this.state_ === InternalTaskState.PAUSING);\n                var wasPaused = this.state_ === taskenums_1.InternalTaskState.PAUSED;\n                this.state_ = state;\n                if (wasPaused) {\n                    this.notifyObservers_();\n                    this.start_();\n                }\n                break;\n            case taskenums_1.InternalTaskState.PAUSED:\n                // TODO(andysoto):\n                // assert(this.state_ === InternalTaskState.PAUSING);\n                this.state_ = state;\n                this.notifyObservers_();\n                break;\n            case taskenums_1.InternalTaskState.CANCELED:\n                // TODO(andysoto):\n                // assert(this.state_ === InternalTaskState.PAUSED ||\n                //        this.state_ === InternalTaskState.CANCELING);\n                this.error_ = errors.canceled();\n                this.state_ = state;\n                this.notifyObservers_();\n                break;\n            case taskenums_1.InternalTaskState.ERROR:\n                // TODO(andysoto):\n                // assert(this.state_ === InternalTaskState.RUNNING ||\n                //        this.state_ === InternalTaskState.PAUSING ||\n                //        this.state_ === InternalTaskState.CANCELING);\n                this.state_ = state;\n                this.notifyObservers_();\n                break;\n            case taskenums_1.InternalTaskState.SUCCESS:\n                // TODO(andysoto):\n                // assert(this.state_ === InternalTaskState.RUNNING ||\n                //        this.state_ === InternalTaskState.PAUSING ||\n                //        this.state_ === InternalTaskState.CANCELING);\n                this.state_ = state;\n                this.notifyObservers_();\n                break;\n        }\n    };\n    UploadTask.prototype.completeTransitions_ = function () {\n        switch (this.state_) {\n            case taskenums_1.InternalTaskState.PAUSING:\n                this.transition_(taskenums_1.InternalTaskState.PAUSED);\n                break;\n            case taskenums_1.InternalTaskState.CANCELING:\n                this.transition_(taskenums_1.InternalTaskState.CANCELED);\n                break;\n            case taskenums_1.InternalTaskState.RUNNING:\n                this.start_();\n                break;\n            default:\n                // TODO(andysoto): assert(false);\n                break;\n        }\n    };\n    Object.defineProperty(UploadTask.prototype, \"snapshot\", {\n        get: function () {\n            var externalState = fbsTaskEnums.taskStateFromInternalTaskState(this.state_);\n            return new tasksnapshot_1.UploadTaskSnapshot(this.transferred_, this.blob_.size(), externalState, this.metadata_, this, this.ref_);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Adds a callback for an event.\n     * @param type The type of event to listen for.\n     */\n    UploadTask.prototype.on = function (type, nextOrObserver, error, completed) {\n        if (nextOrObserver === void 0) { nextOrObserver = undefined; }\n        if (error === void 0) { error = undefined; }\n        if (completed === void 0) { completed = undefined; }\n        function typeValidator(_p) {\n            if (type !== taskenums_2.TaskEvent.STATE_CHANGED) {\n                throw \"Expected one of the event types: [\" + taskenums_2.TaskEvent.STATE_CHANGED + \"].\";\n            }\n        }\n        var nextOrObserverMessage = 'Expected a function or an Object with one of ' +\n            '`next`, `error`, `complete` properties.';\n        var nextValidator = fbsArgs.nullFunctionSpec(true).validator;\n        var observerValidator = fbsArgs.looseObjectSpec(null, true).validator;\n        function nextOrObserverValidator(p) {\n            try {\n                nextValidator(p);\n                return;\n            }\n            catch (e) { }\n            try {\n                observerValidator(p);\n                var anyDefined = typeUtils.isJustDef(p['next']) ||\n                    typeUtils.isJustDef(p['error']) ||\n                    typeUtils.isJustDef(p['complete']);\n                if (!anyDefined) {\n                    throw '';\n                }\n                return;\n            }\n            catch (e) {\n                throw nextOrObserverMessage;\n            }\n        }\n        var specs = [\n            fbsArgs.stringSpec(typeValidator),\n            fbsArgs.looseObjectSpec(nextOrObserverValidator, true),\n            fbsArgs.nullFunctionSpec(true),\n            fbsArgs.nullFunctionSpec(true)\n        ];\n        fbsArgs.validate('on', specs, arguments);\n        var self = this;\n        function makeBinder(specs) {\n            function binder(nextOrObserver, error, opt_complete) {\n                if (specs !== null) {\n                    fbsArgs.validate('on', specs, arguments);\n                }\n                var observer = new observer_1.Observer(nextOrObserver, error, completed);\n                self.addObserver_(observer);\n                return function () {\n                    self.removeObserver_(observer);\n                };\n            }\n            return binder;\n        }\n        function binderNextOrObserverValidator(p) {\n            if (p === null) {\n                throw nextOrObserverMessage;\n            }\n            nextOrObserverValidator(p);\n        }\n        var binderSpecs = [\n            fbsArgs.looseObjectSpec(binderNextOrObserverValidator),\n            fbsArgs.nullFunctionSpec(true),\n            fbsArgs.nullFunctionSpec(true)\n        ];\n        var typeOnly = !(typeUtils.isJustDef(nextOrObserver) ||\n            typeUtils.isJustDef(error) ||\n            typeUtils.isJustDef(completed));\n        if (typeOnly) {\n            return makeBinder(binderSpecs);\n        }\n        else {\n            return makeBinder(null)(nextOrObserver, error, completed);\n        }\n    };\n    /**\n     * This object behaves like a Promise, and resolves with its snapshot data\n     * when the upload completes.\n     * @param onFulfilled The fulfillment callback. Promise chaining works as normal.\n     * @param onRejected The rejection callback.\n     */\n    UploadTask.prototype.then = function (onFulfilled, onRejected) {\n        // These casts are needed so that TypeScript can infer the types of the\n        // resulting Promise.\n        return this.promise_.then(onFulfilled, onRejected);\n    };\n    /**\n     * Equivalent to calling `then(null, onRejected)`.\n     */\n    UploadTask.prototype.catch = function (onRejected) {\n        return this.then(null, onRejected);\n    };\n    /**\n     * Adds the given observer.\n     */\n    UploadTask.prototype.addObserver_ = function (observer) {\n        this.observers_.push(observer);\n        this.notifyObserver_(observer);\n    };\n    /**\n     * Removes the given observer.\n     */\n    UploadTask.prototype.removeObserver_ = function (observer) {\n        fbsArray.remove(this.observers_, observer);\n    };\n    UploadTask.prototype.notifyObservers_ = function () {\n        var _this = this;\n        this.finishPromise_();\n        var observers = fbsArray.clone(this.observers_);\n        observers.forEach(function (observer) {\n            _this.notifyObserver_(observer);\n        });\n    };\n    UploadTask.prototype.finishPromise_ = function () {\n        if (this.resolve_ !== null) {\n            var triggered = true;\n            switch (fbsTaskEnums.taskStateFromInternalTaskState(this.state_)) {\n                case taskenums_2.TaskState.SUCCESS:\n                    async_1.async(this.resolve_.bind(null, this.snapshot))();\n                    break;\n                case taskenums_2.TaskState.CANCELED:\n                case taskenums_2.TaskState.ERROR:\n                    var toCall = this.reject_;\n                    async_1.async(toCall.bind(null, this.error_))();\n                    break;\n                default:\n                    triggered = false;\n                    break;\n            }\n            if (triggered) {\n                this.resolve_ = null;\n                this.reject_ = null;\n            }\n        }\n    };\n    UploadTask.prototype.notifyObserver_ = function (observer) {\n        var externalState = fbsTaskEnums.taskStateFromInternalTaskState(this.state_);\n        switch (externalState) {\n            case taskenums_2.TaskState.RUNNING:\n            case taskenums_2.TaskState.PAUSED:\n                if (observer.next !== null) {\n                    async_1.async(observer.next.bind(observer, this.snapshot))();\n                }\n                break;\n            case taskenums_2.TaskState.SUCCESS:\n                if (observer.complete !== null) {\n                    async_1.async(observer.complete.bind(observer))();\n                }\n                break;\n            case taskenums_2.TaskState.CANCELED:\n            case taskenums_2.TaskState.ERROR:\n                if (observer.error !== null) {\n                    async_1.async(observer.error.bind(observer, this.error_))();\n                }\n                break;\n            default:\n                // TODO(andysoto): assert(false);\n                if (observer.error !== null) {\n                    async_1.async(observer.error.bind(observer, this.error_))();\n                }\n        }\n    };\n    /**\n     * Resumes a paused task. Has no effect on a currently running or failed task.\n     * @return True if the operation took effect, false if ignored.\n     */\n    UploadTask.prototype.resume = function () {\n        fbsArgs.validate('resume', [], arguments);\n        var valid = this.state_ === taskenums_1.InternalTaskState.PAUSED ||\n            this.state_ === taskenums_1.InternalTaskState.PAUSING;\n        if (valid) {\n            this.transition_(taskenums_1.InternalTaskState.RUNNING);\n        }\n        return valid;\n    };\n    /**\n     * Pauses a currently running task. Has no effect on a paused or failed task.\n     * @return True if the operation took effect, false if ignored.\n     */\n    UploadTask.prototype.pause = function () {\n        fbsArgs.validate('pause', [], arguments);\n        var valid = this.state_ === taskenums_1.InternalTaskState.RUNNING;\n        if (valid) {\n            this.transition_(taskenums_1.InternalTaskState.PAUSING);\n        }\n        return valid;\n    };\n    /**\n     * Cancels a currently running or paused task. Has no effect on a complete or\n     * failed task.\n     * @return True if the operation took effect, false if ignored.\n     */\n    UploadTask.prototype.cancel = function () {\n        fbsArgs.validate('cancel', [], arguments);\n        var valid = this.state_ === taskenums_1.InternalTaskState.RUNNING ||\n            this.state_ === taskenums_1.InternalTaskState.PAUSING;\n        if (valid) {\n            this.transition_(taskenums_1.InternalTaskState.CANCELING);\n        }\n        return valid;\n    };\n    return UploadTask;\n}());\nexports.UploadTask = UploadTask;\n\n\n\n},{\"./implementation/args\":102,\"./implementation/array\":103,\"./implementation/async\":104,\"./implementation/error\":109,\"./implementation/observer\":116,\"./implementation/promise_external\":118,\"./implementation/requests\":122,\"./implementation/taskenums\":124,\"./implementation/type\":125,\"./tasksnapshot\":133}],133:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar UploadTaskSnapshot = /** @class */ (function () {\n    function UploadTaskSnapshot(bytesTransferred, totalBytes, state, metadata, task, ref) {\n        this.bytesTransferred = bytesTransferred;\n        this.totalBytes = totalBytes;\n        this.state = state;\n        this.metadata = metadata;\n        this.task = task;\n        this.ref = ref;\n    }\n    Object.defineProperty(UploadTaskSnapshot.prototype, \"downloadURL\", {\n        get: function () {\n            if (this.metadata !== null) {\n                var urls = this.metadata['downloadURLs'];\n                if (urls != null && urls[0] != null) {\n                    return urls[0];\n                }\n                else {\n                    return null;\n                }\n            }\n            else {\n                return null;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return UploadTaskSnapshot;\n}());\nexports.UploadTaskSnapshot = UploadTaskSnapshot;\n\n\n\n},{}],134:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./src/assert\"));\n__export(require(\"./src/crypt\"));\n__export(require(\"./src/constants\"));\n__export(require(\"./src/deepCopy\"));\n__export(require(\"./src/deferred\"));\n__export(require(\"./src/environment\"));\n__export(require(\"./src/errors\"));\n__export(require(\"./src/json\"));\n__export(require(\"./src/jwt\"));\n__export(require(\"./src/obj\"));\n__export(require(\"./src/query\"));\n__export(require(\"./src/sha1\"));\n__export(require(\"./src/subscribe\"));\n__export(require(\"./src/validation\"));\n__export(require(\"./src/utf8\"));\n\n\n\n},{\"./src/assert\":135,\"./src/constants\":136,\"./src/crypt\":137,\"./src/deepCopy\":138,\"./src/deferred\":139,\"./src/environment\":140,\"./src/errors\":141,\"./src/json\":143,\"./src/jwt\":144,\"./src/obj\":145,\"./src/query\":146,\"./src/sha1\":147,\"./src/subscribe\":148,\"./src/utf8\":149,\"./src/validation\":150}],135:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar constants_1 = require(\"./constants\");\n/**\n * Throws an error if the provided assertion is falsy\n * @param {*} assertion The assertion to be tested for falsiness\n * @param {!string} message The message to display if the check fails\n */\nexports.assert = function (assertion, message) {\n    if (!assertion) {\n        throw exports.assertionError(message);\n    }\n};\n/**\n * Returns an Error object suitable for throwing.\n * @param {string} message\n * @return {!Error}\n */\nexports.assertionError = function (message) {\n    return new Error('Firebase Database (' +\n        constants_1.CONSTANTS.SDK_VERSION +\n        ') INTERNAL ASSERT FAILED: ' +\n        message);\n};\n\n\n\n},{\"./constants\":136}],136:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * @fileoverview Firebase constants.  Some of these (@defines) can be overridden at compile-time.\n */\nexports.CONSTANTS = {\n    /**\n     * @define {boolean} Whether this is the client Node.js SDK.\n     */\n    NODE_CLIENT: false,\n    /**\n     * @define {boolean} Whether this is the Admin Node.js SDK.\n     */\n    NODE_ADMIN: false,\n    /**\n     * Firebase SDK Version\n     */\n    SDK_VERSION: '${JSCORE_VERSION}'\n};\n\n\n\n},{}],137:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar stringToByteArray = function (str) {\n    var output = [], p = 0;\n    for (var i = 0; i < str.length; i++) {\n        var c = str.charCodeAt(i);\n        while (c > 255) {\n            output[p++] = c & 255;\n            c >>= 8;\n        }\n        output[p++] = c;\n    }\n    return output;\n};\n/**\n * Turns an array of numbers into the string given by the concatenation of the\n * characters to which the numbers correspond.\n * @param {Array<number>} bytes Array of numbers representing characters.\n * @return {string} Stringification of the array.\n */\nvar byteArrayToString = function (bytes) {\n    var CHUNK_SIZE = 8192;\n    // Special-case the simple case for speed's sake.\n    if (bytes.length < CHUNK_SIZE) {\n        return String.fromCharCode.apply(null, bytes);\n    }\n    // The remaining logic splits conversion by chunks since\n    // Function#apply() has a maximum parameter count.\n    // See discussion: http://goo.gl/LrWmZ9\n    var str = '';\n    for (var i = 0; i < bytes.length; i += CHUNK_SIZE) {\n        var chunk = bytes.slice(i, i + CHUNK_SIZE);\n        str += String.fromCharCode.apply(null, chunk);\n    }\n    return str;\n};\n// Static lookup maps, lazily populated by init_()\nexports.base64 = {\n    /**\n     * Maps bytes to characters.\n     * @type {Object}\n     * @private\n     */\n    byteToCharMap_: null,\n    /**\n     * Maps characters to bytes.\n     * @type {Object}\n     * @private\n     */\n    charToByteMap_: null,\n    /**\n     * Maps bytes to websafe characters.\n     * @type {Object}\n     * @private\n     */\n    byteToCharMapWebSafe_: null,\n    /**\n     * Maps websafe characters to bytes.\n     * @type {Object}\n     * @private\n     */\n    charToByteMapWebSafe_: null,\n    /**\n     * Our default alphabet, shared between\n     * ENCODED_VALS and ENCODED_VALS_WEBSAFE\n     * @type {string}\n     */\n    ENCODED_VALS_BASE: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' + 'abcdefghijklmnopqrstuvwxyz' + '0123456789',\n    /**\n     * Our default alphabet. Value 64 (=) is special; it means \"nothing.\"\n     * @type {string}\n     */\n    get ENCODED_VALS() {\n        return this.ENCODED_VALS_BASE + '+/=';\n    },\n    /**\n     * Our websafe alphabet.\n     * @type {string}\n     */\n    get ENCODED_VALS_WEBSAFE() {\n        return this.ENCODED_VALS_BASE + '-_.';\n    },\n    /**\n     * Whether this browser supports the atob and btoa functions. This extension\n     * started at Mozilla but is now implemented by many browsers. We use the\n     * ASSUME_* variables to avoid pulling in the full useragent detection library\n     * but still allowing the standard per-browser compilations.\n     *\n     * @type {boolean}\n     */\n    HAS_NATIVE_SUPPORT: typeof atob === 'function',\n    /**\n     * Base64-encode an array of bytes.\n     *\n     * @param {Array<number>|Uint8Array} input An array of bytes (numbers with\n     *     value in [0, 255]) to encode.\n     * @param {boolean=} opt_webSafe Boolean indicating we should use the\n     *     alternative alphabet.\n     * @return {string} The base64 encoded string.\n     */\n    encodeByteArray: function (input, opt_webSafe) {\n        if (!Array.isArray(input)) {\n            throw Error('encodeByteArray takes an array as a parameter');\n        }\n        this.init_();\n        var byteToCharMap = opt_webSafe\n            ? this.byteToCharMapWebSafe_\n            : this.byteToCharMap_;\n        var output = [];\n        for (var i = 0; i < input.length; i += 3) {\n            var byte1 = input[i];\n            var haveByte2 = i + 1 < input.length;\n            var byte2 = haveByte2 ? input[i + 1] : 0;\n            var haveByte3 = i + 2 < input.length;\n            var byte3 = haveByte3 ? input[i + 2] : 0;\n            var outByte1 = byte1 >> 2;\n            var outByte2 = ((byte1 & 0x03) << 4) | (byte2 >> 4);\n            var outByte3 = ((byte2 & 0x0f) << 2) | (byte3 >> 6);\n            var outByte4 = byte3 & 0x3f;\n            if (!haveByte3) {\n                outByte4 = 64;\n                if (!haveByte2) {\n                    outByte3 = 64;\n                }\n            }\n            output.push(byteToCharMap[outByte1], byteToCharMap[outByte2], byteToCharMap[outByte3], byteToCharMap[outByte4]);\n        }\n        return output.join('');\n    },\n    /**\n     * Base64-encode a string.\n     *\n     * @param {string} input A string to encode.\n     * @param {boolean=} opt_webSafe If true, we should use the\n     *     alternative alphabet.\n     * @return {string} The base64 encoded string.\n     */\n    encodeString: function (input, opt_webSafe) {\n        // Shortcut for Mozilla browsers that implement\n        // a native base64 encoder in the form of \"btoa/atob\"\n        if (this.HAS_NATIVE_SUPPORT && !opt_webSafe) {\n            return btoa(input);\n        }\n        return this.encodeByteArray(stringToByteArray(input), opt_webSafe);\n    },\n    /**\n     * Base64-decode a string.\n     *\n     * @param {string} input to decode.\n     * @param {boolean=} opt_webSafe True if we should use the\n     *     alternative alphabet.\n     * @return {string} string representing the decoded value.\n     */\n    decodeString: function (input, opt_webSafe) {\n        // Shortcut for Mozilla browsers that implement\n        // a native base64 encoder in the form of \"btoa/atob\"\n        if (this.HAS_NATIVE_SUPPORT && !opt_webSafe) {\n            return atob(input);\n        }\n        return byteArrayToString(this.decodeStringToByteArray(input, opt_webSafe));\n    },\n    /**\n     * Base64-decode a string.\n     *\n     * In base-64 decoding, groups of four characters are converted into three\n     * bytes.  If the encoder did not apply padding, the input length may not\n     * be a multiple of 4.\n     *\n     * In this case, the last group will have fewer than 4 characters, and\n     * padding will be inferred.  If the group has one or two characters, it decodes\n     * to one byte.  If the group has three characters, it decodes to two bytes.\n     *\n     * @param {string} input Input to decode.\n     * @param {boolean=} opt_webSafe True if we should use the web-safe alphabet.\n     * @return {!Array<number>} bytes representing the decoded value.\n     */\n    decodeStringToByteArray: function (input, opt_webSafe) {\n        this.init_();\n        var charToByteMap = opt_webSafe\n            ? this.charToByteMapWebSafe_\n            : this.charToByteMap_;\n        var output = [];\n        for (var i = 0; i < input.length;) {\n            var byte1 = charToByteMap[input.charAt(i++)];\n            var haveByte2 = i < input.length;\n            var byte2 = haveByte2 ? charToByteMap[input.charAt(i)] : 0;\n            ++i;\n            var haveByte3 = i < input.length;\n            var byte3 = haveByte3 ? charToByteMap[input.charAt(i)] : 64;\n            ++i;\n            var haveByte4 = i < input.length;\n            var byte4 = haveByte4 ? charToByteMap[input.charAt(i)] : 64;\n            ++i;\n            if (byte1 == null || byte2 == null || byte3 == null || byte4 == null) {\n                throw Error();\n            }\n            var outByte1 = (byte1 << 2) | (byte2 >> 4);\n            output.push(outByte1);\n            if (byte3 != 64) {\n                var outByte2 = ((byte2 << 4) & 0xf0) | (byte3 >> 2);\n                output.push(outByte2);\n                if (byte4 != 64) {\n                    var outByte3 = ((byte3 << 6) & 0xc0) | byte4;\n                    output.push(outByte3);\n                }\n            }\n        }\n        return output;\n    },\n    /**\n     * Lazy static initialization function. Called before\n     * accessing any of the static map variables.\n     * @private\n     */\n    init_: function () {\n        if (!this.byteToCharMap_) {\n            this.byteToCharMap_ = {};\n            this.charToByteMap_ = {};\n            this.byteToCharMapWebSafe_ = {};\n            this.charToByteMapWebSafe_ = {};\n            // We want quick mappings back and forth, so we precompute two maps.\n            for (var i = 0; i < this.ENCODED_VALS.length; i++) {\n                this.byteToCharMap_[i] = this.ENCODED_VALS.charAt(i);\n                this.charToByteMap_[this.byteToCharMap_[i]] = i;\n                this.byteToCharMapWebSafe_[i] = this.ENCODED_VALS_WEBSAFE.charAt(i);\n                this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]] = i;\n                // Be forgiving when decoding and correctly decode both encodings.\n                if (i >= this.ENCODED_VALS_BASE.length) {\n                    this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)] = i;\n                    this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)] = i;\n                }\n            }\n        }\n    }\n};\n/**\n * URL-safe base64 encoding\n * @param {!string} str\n * @return {!string}\n */\nexports.base64Encode = function (str) {\n    var utf8Bytes = stringToByteArray(str);\n    return exports.base64.encodeByteArray(utf8Bytes, true);\n};\n/**\n * URL-safe base64 decoding\n *\n * NOTE: DO NOT use the global atob() function - it does NOT support the\n * base64Url variant encoding.\n *\n * @param {string} str To be decoded\n * @return {?string} Decoded result, if possible\n */\nexports.base64Decode = function (str) {\n    try {\n        return exports.base64.decodeString(str, true);\n    }\n    catch (e) {\n        console.error('base64Decode failed: ', e);\n    }\n    return null;\n};\n\n\n\n},{}],138:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Do a deep-copy of basic JavaScript Objects or Arrays.\n */\nfunction deepCopy(value) {\n    return deepExtend(undefined, value);\n}\nexports.deepCopy = deepCopy;\n/**\n * Copy properties from source to target (recursively allows extension\n * of Objects and Arrays).  Scalar values in the target are over-written.\n * If target is undefined, an object of the appropriate type will be created\n * (and returned).\n *\n * We recursively copy all child properties of plain Objects in the source- so\n * that namespace- like dictionaries are merged.\n *\n * Note that the target can be a function, in which case the properties in\n * the source Object are copied onto it as static properties of the Function.\n */\nfunction deepExtend(target, source) {\n    if (!(source instanceof Object)) {\n        return source;\n    }\n    switch (source.constructor) {\n        case Date:\n            // Treat Dates like scalars; if the target date object had any child\n            // properties - they will be lost!\n            var dateValue = source;\n            return new Date(dateValue.getTime());\n        case Object:\n            if (target === undefined) {\n                target = {};\n            }\n            break;\n        case Array:\n            // Always copy the array source and overwrite the target.\n            target = [];\n            break;\n        default:\n            // Not a plain Object - treat it as a scalar.\n            return source;\n    }\n    for (var prop in source) {\n        if (!source.hasOwnProperty(prop)) {\n            continue;\n        }\n        target[prop] = deepExtend(target[prop], source[prop]);\n    }\n    return target;\n}\nexports.deepExtend = deepExtend;\n// TODO: Really needed (for JSCompiler type checking)?\nfunction patchProperty(obj, prop, value) {\n    obj[prop] = value;\n}\nexports.patchProperty = patchProperty;\n\n\n\n},{}],139:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Deferred = /** @class */ (function () {\n    function Deferred() {\n        var _this = this;\n        this.promise = new Promise(function (resolve, reject) {\n            _this.resolve = resolve;\n            _this.reject = reject;\n        });\n    }\n    /**\n    * Our API internals are not promiseified and cannot because our callback APIs have subtle expectations around\n    * invoking promises inline, which Promises are forbidden to do. This method accepts an optional node-style callback\n    * and returns a node-style callback which will resolve or reject the Deferred's promise.\n    * @param {((?function(?(Error)): (?|undefined))| (?function(?(Error),?=): (?|undefined)))=} callback\n    * @return {!function(?(Error), ?=)}\n    */\n    Deferred.prototype.wrapCallback = function (callback) {\n        var _this = this;\n        return function (error, value) {\n            if (error) {\n                _this.reject(error);\n            }\n            else {\n                _this.resolve(value);\n            }\n            if (typeof callback === 'function') {\n                // Attaching noop handler just in case developer wasn't expecting\n                // promises\n                _this.promise.catch(function () { });\n                // Some of our callbacks don't expect a value and our own tests\n                // assert that the parameter length is 1\n                if (callback.length === 1) {\n                    callback(error);\n                }\n                else {\n                    callback(error, value);\n                }\n            }\n        };\n    };\n    return Deferred;\n}());\nexports.Deferred = Deferred;\n\n\n\n},{}],140:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar constants_1 = require(\"./constants\");\n/**\n * Returns navigator.userAgent string or '' if it's not defined.\n * @return {string} user agent string\n */\nexports.getUA = function () {\n    if (typeof navigator !== 'undefined' &&\n        typeof navigator['userAgent'] === 'string') {\n        return navigator['userAgent'];\n    }\n    else {\n        return '';\n    }\n};\n/**\n * Detect Cordova / PhoneGap / Ionic frameworks on a mobile device.\n *\n * Deliberately does not rely on checking `file://` URLs (as this fails PhoneGap in the Ripple emulator) nor\n * Cordova `onDeviceReady`, which would normally wait for a callback.\n *\n * @return {boolean} isMobileCordova\n */\nexports.isMobileCordova = function () {\n    return (typeof window !== 'undefined' &&\n        !!(window['cordova'] || window['phonegap'] || window['PhoneGap']) &&\n        /ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(exports.getUA()));\n};\n/**\n * Detect React Native.\n *\n * @return {boolean} True if ReactNative environment is detected.\n */\nexports.isReactNative = function () {\n    return (typeof navigator === 'object' && navigator['product'] === 'ReactNative');\n};\n/**\n * Detect Node.js.\n *\n * @return {boolean} True if Node.js environment is detected.\n */\nexports.isNodeSdk = function () {\n    return constants_1.CONSTANTS.NODE_CLIENT === true || constants_1.CONSTANTS.NODE_ADMIN === true;\n};\n\n\n\n},{\"./constants\":136}],141:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ERROR_NAME = 'FirebaseError';\nvar captureStackTrace = Error\n    .captureStackTrace;\n// Export for faking in tests\nfunction patchCapture(captureFake) {\n    var result = captureStackTrace;\n    captureStackTrace = captureFake;\n    return result;\n}\nexports.patchCapture = patchCapture;\nvar FirebaseError = /** @class */ (function () {\n    function FirebaseError(code, message) {\n        this.code = code;\n        this.message = message;\n        var stack;\n        // We want the stack value, if implemented by Error\n        if (captureStackTrace) {\n            // Patches this.stack, omitted calls above ErrorFactory#create\n            captureStackTrace(this, ErrorFactory.prototype.create);\n        }\n        else {\n            var err_1 = Error.apply(this, arguments);\n            this.name = ERROR_NAME;\n            // Make non-enumerable getter for the property.\n            Object.defineProperty(this, 'stack', {\n                get: function () {\n                    return err_1.stack;\n                }\n            });\n        }\n    }\n    return FirebaseError;\n}());\nexports.FirebaseError = FirebaseError;\n// Back-door inheritance\nFirebaseError.prototype = Object.create(Error.prototype);\nFirebaseError.prototype.constructor = FirebaseError;\nFirebaseError.prototype.name = ERROR_NAME;\nvar ErrorFactory = /** @class */ (function () {\n    function ErrorFactory(service, serviceName, errors) {\n        this.service = service;\n        this.serviceName = serviceName;\n        this.errors = errors;\n        // Matches {$name}, by default.\n        this.pattern = /\\{\\$([^}]+)}/g;\n        // empty\n    }\n    ErrorFactory.prototype.create = function (code, data) {\n        if (data === undefined) {\n            data = {};\n        }\n        var template = this.errors[code];\n        var fullCode = this.service + '/' + code;\n        var message;\n        if (template === undefined) {\n            message = 'Error';\n        }\n        else {\n            message = template.replace(this.pattern, function (match, key) {\n                var value = data[key];\n                return value !== undefined ? value.toString() : '<' + key + '?>';\n            });\n        }\n        // Service: Error message (service/code).\n        message = this.serviceName + ': ' + message + ' (' + fullCode + ').';\n        var err = new FirebaseError(fullCode, message);\n        // Populate the Error object with message parts for programmatic\n        // accesses (e.g., e.file).\n        for (var prop in data) {\n            if (!data.hasOwnProperty(prop) || prop.slice(-1) === '_') {\n                continue;\n            }\n            err[prop] = data[prop];\n        }\n        return err;\n    };\n    return ErrorFactory;\n}());\nexports.ErrorFactory = ErrorFactory;\n\n\n\n},{}],142:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// Copyright 2011 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n/**\n * @fileoverview Abstract cryptographic hash interface.\n *\n * See Sha1 and Md5 for sample implementations.\n *\n */\n/**\n * Create a cryptographic hash instance.\n *\n * @constructor\n * @struct\n */\nvar Hash = /** @class */ (function () {\n    function Hash() {\n        /**\n         * The block size for the hasher.\n         * @type {number}\n         */\n        this.blockSize = -1;\n    }\n    return Hash;\n}());\nexports.Hash = Hash;\n\n\n\n},{}],143:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Evaluates a JSON string into a javascript object.\n *\n * @param {string} str A string containing JSON.\n * @return {*} The javascript object representing the specified JSON.\n */\nfunction jsonEval(str) {\n    return JSON.parse(str);\n}\nexports.jsonEval = jsonEval;\n/**\n * Returns JSON representing a javascript object.\n * @param {*} data Javascript object to be stringified.\n * @return {string} The JSON contents of the object.\n */\nfunction stringify(data) {\n    return JSON.stringify(data);\n}\nexports.stringify = stringify;\n\n\n\n},{}],144:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar crypt_1 = require(\"./crypt\");\nvar json_1 = require(\"./json\");\n/**\n * Decodes a Firebase auth. token into constituent parts.\n *\n * Notes:\n * - May return with invalid / incomplete claims if there's no native base64 decoding support.\n * - Doesn't check if the token is actually valid.\n *\n * @param {?string} token\n * @return {{header: *, claims: *, data: *, signature: string}}\n */\nexports.decode = function (token) {\n    var header = {}, claims = {}, data = {}, signature = '';\n    try {\n        var parts = token.split('.');\n        header = json_1.jsonEval(crypt_1.base64Decode(parts[0]) || '');\n        claims = json_1.jsonEval(crypt_1.base64Decode(parts[1]) || '');\n        signature = parts[2];\n        data = claims['d'] || {};\n        delete claims['d'];\n    }\n    catch (e) { }\n    return {\n        header: header,\n        claims: claims,\n        data: data,\n        signature: signature\n    };\n};\n/**\n * Decodes a Firebase auth. token and checks the validity of its time-based claims. Will return true if the\n * token is within the time window authorized by the 'nbf' (not-before) and 'iat' (issued-at) claims.\n *\n * Notes:\n * - May return a false negative if there's no native base64 decoding support.\n * - Doesn't check if the token is actually valid.\n *\n * @param {?string} token\n * @return {boolean}\n */\nexports.isValidTimestamp = function (token) {\n    var claims = exports.decode(token).claims, now = Math.floor(new Date().getTime() / 1000), validSince, validUntil;\n    if (typeof claims === 'object') {\n        if (claims.hasOwnProperty('nbf')) {\n            validSince = claims['nbf'];\n        }\n        else if (claims.hasOwnProperty('iat')) {\n            validSince = claims['iat'];\n        }\n        if (claims.hasOwnProperty('exp')) {\n            validUntil = claims['exp'];\n        }\n        else {\n            // token will expire after 24h by default\n            validUntil = validSince + 86400;\n        }\n    }\n    return (now && validSince && validUntil && now >= validSince && now <= validUntil);\n};\n/**\n * Decodes a Firebase auth. token and returns its issued at time if valid, null otherwise.\n *\n * Notes:\n * - May return null if there's no native base64 decoding support.\n * - Doesn't check if the token is actually valid.\n *\n * @param {?string} token\n * @return {?number}\n */\nexports.issuedAtTime = function (token) {\n    var claims = exports.decode(token).claims;\n    if (typeof claims === 'object' && claims.hasOwnProperty('iat')) {\n        return claims['iat'];\n    }\n    return null;\n};\n/**\n * Decodes a Firebase auth. token and checks the validity of its format. Expects a valid issued-at time and non-empty\n * signature.\n *\n * Notes:\n * - May return a false negative if there's no native base64 decoding support.\n * - Doesn't check if the token is actually valid.\n *\n * @param {?string} token\n * @return {boolean}\n */\nexports.isValidFormat = function (token) {\n    var decoded = exports.decode(token), claims = decoded.claims;\n    return (!!decoded.signature &&\n        !!claims &&\n        typeof claims === 'object' &&\n        claims.hasOwnProperty('iat'));\n};\n/**\n * Attempts to peer into an auth token and determine if it's an admin auth token by looking at the claims portion.\n *\n * Notes:\n * - May return a false negative if there's no native base64 decoding support.\n * - Doesn't check if the token is actually valid.\n *\n * @param {?string} token\n * @return {boolean}\n */\nexports.isAdmin = function (token) {\n    var claims = exports.decode(token).claims;\n    return typeof claims === 'object' && claims['admin'] === true;\n};\n\n\n\n},{\"./crypt\":137,\"./json\":143}],145:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// See http://www.devthought.com/2012/01/18/an-object-is-not-a-hash/\nexports.contains = function (obj, key) {\n    return Object.prototype.hasOwnProperty.call(obj, key);\n};\nexports.safeGet = function (obj, key) {\n    if (Object.prototype.hasOwnProperty.call(obj, key))\n        return obj[key];\n    // else return undefined.\n};\n/**\n * Enumerates the keys/values in an object, excluding keys defined on the prototype.\n *\n * @param {?Object.<K,V>} obj Object to enumerate.\n * @param {!function(K, V)} fn Function to call for each key and value.\n * @template K,V\n */\nexports.forEach = function (obj, fn) {\n    for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) {\n            fn(key, obj[key]);\n        }\n    }\n};\n/**\n * Copies all the (own) properties from one object to another.\n * @param {!Object} objTo\n * @param {!Object} objFrom\n * @return {!Object} objTo\n */\nexports.extend = function (objTo, objFrom) {\n    exports.forEach(objFrom, function (key, value) {\n        objTo[key] = value;\n    });\n    return objTo;\n};\n/**\n * Returns a clone of the specified object.\n * @param {!Object} obj\n * @return {!Object} cloned obj.\n */\nexports.clone = function (obj) {\n    return exports.extend({}, obj);\n};\n/**\n * Returns true if obj has typeof \"object\" and is not null.  Unlike goog.isObject(), does not return true\n * for functions.\n *\n * @param obj {*} A potential object.\n * @returns {boolean} True if it's an object.\n */\nexports.isNonNullObject = function (obj) {\n    return typeof obj === 'object' && obj !== null;\n};\nexports.isEmpty = function (obj) {\n    for (var key in obj) {\n        return false;\n    }\n    return true;\n};\nexports.getCount = function (obj) {\n    var rv = 0;\n    for (var key in obj) {\n        rv++;\n    }\n    return rv;\n};\nexports.map = function (obj, f, opt_obj) {\n    var res = {};\n    for (var key in obj) {\n        res[key] = f.call(opt_obj, obj[key], key, obj);\n    }\n    return res;\n};\nexports.findKey = function (obj, fn, opt_this) {\n    for (var key in obj) {\n        if (fn.call(opt_this, obj[key], key, obj)) {\n            return key;\n        }\n    }\n    return undefined;\n};\nexports.findValue = function (obj, fn, opt_this) {\n    var key = exports.findKey(obj, fn, opt_this);\n    return key && obj[key];\n};\nexports.getAnyKey = function (obj) {\n    for (var key in obj) {\n        return key;\n    }\n};\nexports.getValues = function (obj) {\n    var res = [];\n    var i = 0;\n    for (var key in obj) {\n        res[i++] = obj[key];\n    }\n    return res;\n};\n/**\n * Tests whether every key/value pair in an object pass the test implemented\n * by the provided function\n *\n * @param {?Object.<K,V>} obj Object to test.\n * @param {!function(K, V)} fn Function to call for each key and value.\n * @template K,V\n */\nexports.every = function (obj, fn) {\n    for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) {\n            if (!fn(key, obj[key])) {\n                return false;\n            }\n        }\n    }\n    return true;\n};\n\n\n\n},{}],146:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar obj_1 = require(\"./obj\");\n/**\n * Returns a querystring-formatted string (e.g. &arg=val&arg2=val2) from a params\n * object (e.g. {arg: 'val', arg2: 'val2'})\n * Note: You must prepend it with ? when adding it to a URL.\n *\n * @param {!Object} querystringParams\n * @return {string}\n */\nexports.querystring = function (querystringParams) {\n    var params = [];\n    obj_1.forEach(querystringParams, function (key, value) {\n        if (Array.isArray(value)) {\n            value.forEach(function (arrayVal) {\n                params.push(encodeURIComponent(key) + '=' + encodeURIComponent(arrayVal));\n            });\n        }\n        else {\n            params.push(encodeURIComponent(key) + '=' + encodeURIComponent(value));\n        }\n    });\n    return params.length ? '&' + params.join('&') : '';\n};\n/**\n * Decodes a querystring (e.g. ?arg=val&arg2=val2) into a params object (e.g. {arg: 'val', arg2: 'val2'})\n *\n * @param {string} querystring\n * @return {!Object}\n */\nexports.querystringDecode = function (querystring) {\n    var obj = {};\n    var tokens = querystring.replace(/^\\?/, '').split('&');\n    tokens.forEach(function (token) {\n        if (token) {\n            var key = token.split('=');\n            obj[key[0]] = key[1];\n        }\n    });\n    return obj;\n};\n\n\n\n},{\"./obj\":145}],147:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar hash_1 = require(\"./hash\");\n/**\n * @fileoverview SHA-1 cryptographic hash.\n * Variable names follow the notation in FIPS PUB 180-3:\n * http://csrc.nist.gov/publications/fips/fips180-3/fips180-3_final.pdf.\n *\n * Usage:\n *   var sha1 = new sha1();\n *   sha1.update(bytes);\n *   var hash = sha1.digest();\n *\n * Performance:\n *   Chrome 23:   ~400 Mbit/s\n *   Firefox 16:  ~250 Mbit/s\n *\n */\n/**\n * SHA-1 cryptographic hash constructor.\n *\n * The properties declared here are discussed in the above algorithm document.\n * @constructor\n * @extends {Hash}\n * @final\n * @struct\n */\nvar Sha1 = /** @class */ (function (_super) {\n    __extends(Sha1, _super);\n    function Sha1() {\n        var _this = _super.call(this) || this;\n        /**\n         * Holds the previous values of accumulated variables a-e in the compress_\n         * function.\n         * @type {!Array<number>}\n         * @private\n         */\n        _this.chain_ = [];\n        /**\n         * A buffer holding the partially computed hash result.\n         * @type {!Array<number>}\n         * @private\n         */\n        _this.buf_ = [];\n        /**\n         * An array of 80 bytes, each a part of the message to be hashed.  Referred to\n         * as the message schedule in the docs.\n         * @type {!Array<number>}\n         * @private\n         */\n        _this.W_ = [];\n        /**\n         * Contains data needed to pad messages less than 64 bytes.\n         * @type {!Array<number>}\n         * @private\n         */\n        _this.pad_ = [];\n        /**\n         * @private {number}\n         */\n        _this.inbuf_ = 0;\n        /**\n         * @private {number}\n         */\n        _this.total_ = 0;\n        _this.blockSize = 512 / 8;\n        _this.pad_[0] = 128;\n        for (var i = 1; i < _this.blockSize; ++i) {\n            _this.pad_[i] = 0;\n        }\n        _this.reset();\n        return _this;\n    }\n    Sha1.prototype.reset = function () {\n        this.chain_[0] = 0x67452301;\n        this.chain_[1] = 0xefcdab89;\n        this.chain_[2] = 0x98badcfe;\n        this.chain_[3] = 0x10325476;\n        this.chain_[4] = 0xc3d2e1f0;\n        this.inbuf_ = 0;\n        this.total_ = 0;\n    };\n    /**\n     * Internal compress helper function.\n     * @param {!Array<number>|!Uint8Array|string} buf Block to compress.\n     * @param {number=} opt_offset Offset of the block in the buffer.\n     * @private\n     */\n    Sha1.prototype.compress_ = function (buf, opt_offset) {\n        if (!opt_offset) {\n            opt_offset = 0;\n        }\n        var W = this.W_;\n        // get 16 big endian words\n        if (typeof buf === 'string') {\n            for (var i = 0; i < 16; i++) {\n                // TODO(user): [bug 8140122] Recent versions of Safari for Mac OS and iOS\n                // have a bug that turns the post-increment ++ operator into pre-increment\n                // during JIT compilation.  We have code that depends heavily on SHA-1 for\n                // correctness and which is affected by this bug, so I've removed all uses\n                // of post-increment ++ in which the result value is used.  We can revert\n                // this change once the Safari bug\n                // (https://bugs.webkit.org/show_bug.cgi?id=109036) has been fixed and\n                // most clients have been updated.\n                W[i] =\n                    (buf.charCodeAt(opt_offset) << 24) |\n                        (buf.charCodeAt(opt_offset + 1) << 16) |\n                        (buf.charCodeAt(opt_offset + 2) << 8) |\n                        buf.charCodeAt(opt_offset + 3);\n                opt_offset += 4;\n            }\n        }\n        else {\n            for (var i = 0; i < 16; i++) {\n                W[i] =\n                    (buf[opt_offset] << 24) |\n                        (buf[opt_offset + 1] << 16) |\n                        (buf[opt_offset + 2] << 8) |\n                        buf[opt_offset + 3];\n                opt_offset += 4;\n            }\n        }\n        // expand to 80 words\n        for (var i = 16; i < 80; i++) {\n            var t = W[i - 3] ^ W[i - 8] ^ W[i - 14] ^ W[i - 16];\n            W[i] = ((t << 1) | (t >>> 31)) & 0xffffffff;\n        }\n        var a = this.chain_[0];\n        var b = this.chain_[1];\n        var c = this.chain_[2];\n        var d = this.chain_[3];\n        var e = this.chain_[4];\n        var f, k;\n        // TODO(user): Try to unroll this loop to speed up the computation.\n        for (var i = 0; i < 80; i++) {\n            if (i < 40) {\n                if (i < 20) {\n                    f = d ^ (b & (c ^ d));\n                    k = 0x5a827999;\n                }\n                else {\n                    f = b ^ c ^ d;\n                    k = 0x6ed9eba1;\n                }\n            }\n            else {\n                if (i < 60) {\n                    f = (b & c) | (d & (b | c));\n                    k = 0x8f1bbcdc;\n                }\n                else {\n                    f = b ^ c ^ d;\n                    k = 0xca62c1d6;\n                }\n            }\n            var t = (((a << 5) | (a >>> 27)) + f + e + k + W[i]) & 0xffffffff;\n            e = d;\n            d = c;\n            c = ((b << 30) | (b >>> 2)) & 0xffffffff;\n            b = a;\n            a = t;\n        }\n        this.chain_[0] = (this.chain_[0] + a) & 0xffffffff;\n        this.chain_[1] = (this.chain_[1] + b) & 0xffffffff;\n        this.chain_[2] = (this.chain_[2] + c) & 0xffffffff;\n        this.chain_[3] = (this.chain_[3] + d) & 0xffffffff;\n        this.chain_[4] = (this.chain_[4] + e) & 0xffffffff;\n    };\n    Sha1.prototype.update = function (bytes, opt_length) {\n        // TODO(johnlenz): tighten the function signature and remove this check\n        if (bytes == null) {\n            return;\n        }\n        if (opt_length === undefined) {\n            opt_length = bytes.length;\n        }\n        var lengthMinusBlock = opt_length - this.blockSize;\n        var n = 0;\n        // Using local instead of member variables gives ~5% speedup on Firefox 16.\n        var buf = this.buf_;\n        var inbuf = this.inbuf_;\n        // The outer while loop should execute at most twice.\n        while (n < opt_length) {\n            // When we have no data in the block to top up, we can directly process the\n            // input buffer (assuming it contains sufficient data). This gives ~25%\n            // speedup on Chrome 23 and ~15% speedup on Firefox 16, but requires that\n            // the data is provided in large chunks (or in multiples of 64 bytes).\n            if (inbuf == 0) {\n                while (n <= lengthMinusBlock) {\n                    this.compress_(bytes, n);\n                    n += this.blockSize;\n                }\n            }\n            if (typeof bytes === 'string') {\n                while (n < opt_length) {\n                    buf[inbuf] = bytes.charCodeAt(n);\n                    ++inbuf;\n                    ++n;\n                    if (inbuf == this.blockSize) {\n                        this.compress_(buf);\n                        inbuf = 0;\n                        // Jump to the outer loop so we use the full-block optimization.\n                        break;\n                    }\n                }\n            }\n            else {\n                while (n < opt_length) {\n                    buf[inbuf] = bytes[n];\n                    ++inbuf;\n                    ++n;\n                    if (inbuf == this.blockSize) {\n                        this.compress_(buf);\n                        inbuf = 0;\n                        // Jump to the outer loop so we use the full-block optimization.\n                        break;\n                    }\n                }\n            }\n        }\n        this.inbuf_ = inbuf;\n        this.total_ += opt_length;\n    };\n    /** @override */\n    Sha1.prototype.digest = function () {\n        var digest = [];\n        var totalBits = this.total_ * 8;\n        // Add pad 0x80 0x00*.\n        if (this.inbuf_ < 56) {\n            this.update(this.pad_, 56 - this.inbuf_);\n        }\n        else {\n            this.update(this.pad_, this.blockSize - (this.inbuf_ - 56));\n        }\n        // Add # bits.\n        for (var i = this.blockSize - 1; i >= 56; i--) {\n            this.buf_[i] = totalBits & 255;\n            totalBits /= 256; // Don't use bit-shifting here!\n        }\n        this.compress_(this.buf_);\n        var n = 0;\n        for (var i = 0; i < 5; i++) {\n            for (var j = 24; j >= 0; j -= 8) {\n                digest[n] = (this.chain_[i] >> j) & 255;\n                ++n;\n            }\n        }\n        return digest;\n    };\n    return Sha1;\n}(hash_1.Hash));\nexports.Sha1 = Sha1;\n\n\n\n},{\"./hash\":142}],148:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Helper to make a Subscribe function (just like Promise helps make a\n * Thenable).\n *\n * @param executor Function which can make calls to a single Observer\n *     as a proxy.\n * @param onNoObservers Callback when count of Observers goes to zero.\n */\nfunction createSubscribe(executor, onNoObservers) {\n    var proxy = new ObserverProxy(executor, onNoObservers);\n    return proxy.subscribe.bind(proxy);\n}\nexports.createSubscribe = createSubscribe;\n/**\n * Implement fan-out for any number of Observers attached via a subscribe\n * function.\n */\nvar ObserverProxy = /** @class */ (function () {\n    /**\n     * @param executor Function which can make calls to a single Observer\n     *     as a proxy.\n     * @param onNoObservers Callback when count of Observers goes to zero.\n     */\n    function ObserverProxy(executor, onNoObservers) {\n        var _this = this;\n        this.observers = [];\n        this.unsubscribes = [];\n        this.observerCount = 0;\n        // Micro-task scheduling by calling task.then().\n        this.task = Promise.resolve();\n        this.finalized = false;\n        this.onNoObservers = onNoObservers;\n        // Call the executor asynchronously so subscribers that are called\n        // synchronously after the creation of the subscribe function\n        // can still receive the very first value generated in the executor.\n        this.task\n            .then(function () {\n            executor(_this);\n        })\n            .catch(function (e) {\n            _this.error(e);\n        });\n    }\n    ObserverProxy.prototype.next = function (value) {\n        this.forEachObserver(function (observer) {\n            observer.next(value);\n        });\n    };\n    ObserverProxy.prototype.error = function (error) {\n        this.forEachObserver(function (observer) {\n            observer.error(error);\n        });\n        this.close(error);\n    };\n    ObserverProxy.prototype.complete = function () {\n        this.forEachObserver(function (observer) {\n            observer.complete();\n        });\n        this.close();\n    };\n    /**\n     * Subscribe function that can be used to add an Observer to the fan-out list.\n     *\n     * - We require that no event is sent to a subscriber sychronously to their\n     *   call to subscribe().\n     */\n    ObserverProxy.prototype.subscribe = function (nextOrObserver, error, complete) {\n        var _this = this;\n        var observer;\n        if (nextOrObserver === undefined &&\n            error === undefined &&\n            complete === undefined) {\n            throw new Error('Missing Observer.');\n        }\n        // Assemble an Observer object when passed as callback functions.\n        if (implementsAnyMethods(nextOrObserver, ['next', 'error', 'complete'])) {\n            observer = nextOrObserver;\n        }\n        else {\n            observer = {\n                next: nextOrObserver,\n                error: error,\n                complete: complete\n            };\n        }\n        if (observer.next === undefined) {\n            observer.next = noop;\n        }\n        if (observer.error === undefined) {\n            observer.error = noop;\n        }\n        if (observer.complete === undefined) {\n            observer.complete = noop;\n        }\n        var unsub = this.unsubscribeOne.bind(this, this.observers.length);\n        // Attempt to subscribe to a terminated Observable - we\n        // just respond to the Observer with the final error or complete\n        // event.\n        if (this.finalized) {\n            this.task.then(function () {\n                try {\n                    if (_this.finalError) {\n                        observer.error(_this.finalError);\n                    }\n                    else {\n                        observer.complete();\n                    }\n                }\n                catch (e) {\n                    // nothing\n                }\n                return;\n            });\n        }\n        this.observers.push(observer);\n        return unsub;\n    };\n    // Unsubscribe is synchronous - we guarantee that no events are sent to\n    // any unsubscribed Observer.\n    ObserverProxy.prototype.unsubscribeOne = function (i) {\n        if (this.observers === undefined || this.observers[i] === undefined) {\n            return;\n        }\n        delete this.observers[i];\n        this.observerCount -= 1;\n        if (this.observerCount === 0 && this.onNoObservers !== undefined) {\n            this.onNoObservers(this);\n        }\n    };\n    ObserverProxy.prototype.forEachObserver = function (fn) {\n        if (this.finalized) {\n            // Already closed by previous event....just eat the additional values.\n            return;\n        }\n        // Since sendOne calls asynchronously - there is no chance that\n        // this.observers will become undefined.\n        for (var i = 0; i < this.observers.length; i++) {\n            this.sendOne(i, fn);\n        }\n    };\n    // Call the Observer via one of it's callback function. We are careful to\n    // confirm that the observe has not been unsubscribed since this asynchronous\n    // function had been queued.\n    ObserverProxy.prototype.sendOne = function (i, fn) {\n        var _this = this;\n        // Execute the callback asynchronously\n        this.task.then(function () {\n            if (_this.observers !== undefined && _this.observers[i] !== undefined) {\n                try {\n                    fn(_this.observers[i]);\n                }\n                catch (e) {\n                    // Ignore exceptions raised in Observers or missing methods of an\n                    // Observer.\n                    // Log error to console. b/31404806\n                    if (typeof console !== 'undefined' && console.error) {\n                        console.error(e);\n                    }\n                }\n            }\n        });\n    };\n    ObserverProxy.prototype.close = function (err) {\n        var _this = this;\n        if (this.finalized) {\n            return;\n        }\n        this.finalized = true;\n        if (err !== undefined) {\n            this.finalError = err;\n        }\n        // Proxy is no longer needed - garbage collect references\n        this.task.then(function () {\n            _this.observers = undefined;\n            _this.onNoObservers = undefined;\n        });\n    };\n    return ObserverProxy;\n}());\n/** Turn synchronous function into one called asynchronously. */\nfunction async(fn, onError) {\n    return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        Promise.resolve(true)\n            .then(function () {\n            fn.apply(void 0, args);\n        })\n            .catch(function (error) {\n            if (onError) {\n                onError(error);\n            }\n        });\n    };\n}\nexports.async = async;\n/**\n * Return true if the object passed in implements any of the named methods.\n */\nfunction implementsAnyMethods(obj, methods) {\n    if (typeof obj !== 'object' || obj === null) {\n        return false;\n    }\n    for (var _i = 0, methods_1 = methods; _i < methods_1.length; _i++) {\n        var method = methods_1[_i];\n        if (method in obj && typeof obj[method] === 'function') {\n            return true;\n        }\n    }\n    return false;\n}\nfunction noop() {\n    // do nothing\n}\n\n\n\n},{}],149:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar assert_1 = require(\"./assert\");\n// Code originally came from goog.crypt.stringToUtf8ByteArray, but for some reason they\n// automatically replaced '\\r\\n' with '\\n', and they didn't handle surrogate pairs,\n// so it's been modified.\n// Note that not all Unicode characters appear as single characters in JavaScript strings.\n// fromCharCode returns the UTF-16 encoding of a character - so some Unicode characters\n// use 2 characters in Javascript.  All 4-byte UTF-8 characters begin with a first\n// character in the range 0xD800 - 0xDBFF (the first character of a so-called surrogate\n// pair).\n// See http://www.ecma-international.org/ecma-262/5.1/#sec-15.1.3\n/**\n * @param {string} str\n * @return {Array}\n */\nexports.stringToByteArray = function (str) {\n    var out = [], p = 0;\n    for (var i = 0; i < str.length; i++) {\n        var c = str.charCodeAt(i);\n        // Is this the lead surrogate in a surrogate pair?\n        if (c >= 0xd800 && c <= 0xdbff) {\n            var high = c - 0xd800; // the high 10 bits.\n            i++;\n            assert_1.assert(i < str.length, 'Surrogate pair missing trail surrogate.');\n            var low = str.charCodeAt(i) - 0xdc00; // the low 10 bits.\n            c = 0x10000 + (high << 10) + low;\n        }\n        if (c < 128) {\n            out[p++] = c;\n        }\n        else if (c < 2048) {\n            out[p++] = (c >> 6) | 192;\n            out[p++] = (c & 63) | 128;\n        }\n        else if (c < 65536) {\n            out[p++] = (c >> 12) | 224;\n            out[p++] = ((c >> 6) & 63) | 128;\n            out[p++] = (c & 63) | 128;\n        }\n        else {\n            out[p++] = (c >> 18) | 240;\n            out[p++] = ((c >> 12) & 63) | 128;\n            out[p++] = ((c >> 6) & 63) | 128;\n            out[p++] = (c & 63) | 128;\n        }\n    }\n    return out;\n};\n/**\n * Calculate length without actually converting; useful for doing cheaper validation.\n * @param {string} str\n * @return {number}\n */\nexports.stringLength = function (str) {\n    var p = 0;\n    for (var i = 0; i < str.length; i++) {\n        var c = str.charCodeAt(i);\n        if (c < 128) {\n            p++;\n        }\n        else if (c < 2048) {\n            p += 2;\n        }\n        else if (c >= 0xd800 && c <= 0xdbff) {\n            // Lead surrogate of a surrogate pair.  The pair together will take 4 bytes to represent.\n            p += 4;\n            i++; // skip trail surrogate.\n        }\n        else {\n            p += 3;\n        }\n    }\n    return p;\n};\n\n\n\n},{\"./assert\":135}],150:[function(require,module,exports){\n\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Check to make sure the appropriate number of arguments are provided for a public function.\n * Throws an error if it fails.\n *\n * @param {!string} fnName The function name\n * @param {!number} minCount The minimum number of arguments to allow for the function call\n * @param {!number} maxCount The maximum number of argument to allow for the function call\n * @param {!number} argCount The actual number of arguments provided.\n */\nexports.validateArgCount = function (fnName, minCount, maxCount, argCount) {\n    var argError;\n    if (argCount < minCount) {\n        argError = 'at least ' + minCount;\n    }\n    else if (argCount > maxCount) {\n        argError = maxCount === 0 ? 'none' : 'no more than ' + maxCount;\n    }\n    if (argError) {\n        var error = fnName +\n            ' failed: Was called with ' +\n            argCount +\n            (argCount === 1 ? ' argument.' : ' arguments.') +\n            ' Expects ' +\n            argError +\n            '.';\n        throw new Error(error);\n    }\n};\n/**\n * Generates a string to prefix an error message about failed argument validation\n *\n * @param {!string} fnName The function name\n * @param {!number} argumentNumber The index of the argument\n * @param {boolean} optional Whether or not the argument is optional\n * @return {!string} The prefix to add to the error thrown for validation.\n */\nfunction errorPrefix(fnName, argumentNumber, optional) {\n    var argName = '';\n    switch (argumentNumber) {\n        case 1:\n            argName = optional ? 'first' : 'First';\n            break;\n        case 2:\n            argName = optional ? 'second' : 'Second';\n            break;\n        case 3:\n            argName = optional ? 'third' : 'Third';\n            break;\n        case 4:\n            argName = optional ? 'fourth' : 'Fourth';\n            break;\n        default:\n            throw new Error('errorPrefix called with argumentNumber > 4.  Need to update it?');\n    }\n    var error = fnName + ' failed: ';\n    error += argName + ' argument ';\n    return error;\n}\nexports.errorPrefix = errorPrefix;\n/**\n * @param {!string} fnName\n * @param {!number} argumentNumber\n * @param {!string} namespace\n * @param {boolean} optional\n */\nfunction validateNamespace(fnName, argumentNumber, namespace, optional) {\n    if (optional && !namespace)\n        return;\n    if (typeof namespace !== 'string') {\n        //TODO: I should do more validation here. We only allow certain chars in namespaces.\n        throw new Error(errorPrefix(fnName, argumentNumber, optional) +\n            'must be a valid firebase namespace.');\n    }\n}\nexports.validateNamespace = validateNamespace;\nfunction validateCallback(fnName, argumentNumber, callback, optional) {\n    if (optional && !callback)\n        return;\n    if (typeof callback !== 'function')\n        throw new Error(errorPrefix(fnName, argumentNumber, optional) +\n            'must be a valid function.');\n}\nexports.validateCallback = validateCallback;\nfunction validateContextObject(fnName, argumentNumber, context, optional) {\n    if (optional && !context)\n        return;\n    if (typeof context !== 'object' || context === null)\n        throw new Error(errorPrefix(fnName, argumentNumber, optional) +\n            'must be a valid context object.');\n}\nexports.validateContextObject = validateContextObject;\n\n\n\n},{}],151:[function(require,module,exports){\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nrequire('@firebase/polyfill');\nmodule.exports = require('@firebase/app').default;\n\n},{\"@firebase/app\":1,\"@firebase/polyfill\":97}],152:[function(require,module,exports){\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nrequire('@firebase/auth');\n\n},{\"@firebase/auth\":3}],153:[function(require,module,exports){\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nmodule.exports = require('@firebase/database');\n\n},{\"@firebase/database\":4}],154:[function(require,module,exports){\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar firebase = require('./app');\nrequire('./auth');\nrequire('./database');\nrequire('./messaging');\nrequire('./storage');\n\nmodule.exports = firebase;\n\n},{\"./app\":151,\"./auth\":152,\"./database\":153,\"./messaging\":155,\"./storage\":156}],155:[function(require,module,exports){\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nrequire('@firebase/messaging');\n\n},{\"@firebase/messaging\":86}],156:[function(require,module,exports){\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nrequire('@firebase/storage');\n\n},{\"@firebase/storage\":101}],157:[function(require,module,exports){\n// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n},{}],158:[function(require,module,exports){\n(function (root) {\n\n  // Store setTimeout reference so promise-polyfill will be unaffected by\n  // other code modifying setTimeout (like sinon.useFakeTimers())\n  var setTimeoutFunc = setTimeout;\n\n  function noop() {}\n  \n  // Polyfill for Function.prototype.bind\n  function bind(fn, thisArg) {\n    return function () {\n      fn.apply(thisArg, arguments);\n    };\n  }\n\n  function Promise(fn) {\n    if (typeof this !== 'object') throw new TypeError('Promises must be constructed via new');\n    if (typeof fn !== 'function') throw new TypeError('not a function');\n    this._state = 0;\n    this._handled = false;\n    this._value = undefined;\n    this._deferreds = [];\n\n    doResolve(fn, this);\n  }\n\n  function handle(self, deferred) {\n    while (self._state === 3) {\n      self = self._value;\n    }\n    if (self._state === 0) {\n      self._deferreds.push(deferred);\n      return;\n    }\n    self._handled = true;\n    Promise._immediateFn(function () {\n      var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n      if (cb === null) {\n        (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n        return;\n      }\n      var ret;\n      try {\n        ret = cb(self._value);\n      } catch (e) {\n        reject(deferred.promise, e);\n        return;\n      }\n      resolve(deferred.promise, ret);\n    });\n  }\n\n  function resolve(self, newValue) {\n    try {\n      // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n      if (newValue === self) throw new TypeError('A promise cannot be resolved with itself.');\n      if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n        var then = newValue.then;\n        if (newValue instanceof Promise) {\n          self._state = 3;\n          self._value = newValue;\n          finale(self);\n          return;\n        } else if (typeof then === 'function') {\n          doResolve(bind(then, newValue), self);\n          return;\n        }\n      }\n      self._state = 1;\n      self._value = newValue;\n      finale(self);\n    } catch (e) {\n      reject(self, e);\n    }\n  }\n\n  function reject(self, newValue) {\n    self._state = 2;\n    self._value = newValue;\n    finale(self);\n  }\n\n  function finale(self) {\n    if (self._state === 2 && self._deferreds.length === 0) {\n      Promise._immediateFn(function() {\n        if (!self._handled) {\n          Promise._unhandledRejectionFn(self._value);\n        }\n      });\n    }\n\n    for (var i = 0, len = self._deferreds.length; i < len; i++) {\n      handle(self, self._deferreds[i]);\n    }\n    self._deferreds = null;\n  }\n\n  function Handler(onFulfilled, onRejected, promise) {\n    this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n    this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n    this.promise = promise;\n  }\n\n  /**\n   * Take a potentially misbehaving resolver function and make sure\n   * onFulfilled and onRejected are only called once.\n   *\n   * Makes no guarantees about asynchrony.\n   */\n  function doResolve(fn, self) {\n    var done = false;\n    try {\n      fn(function (value) {\n        if (done) return;\n        done = true;\n        resolve(self, value);\n      }, function (reason) {\n        if (done) return;\n        done = true;\n        reject(self, reason);\n      });\n    } catch (ex) {\n      if (done) return;\n      done = true;\n      reject(self, ex);\n    }\n  }\n\n  Promise.prototype['catch'] = function (onRejected) {\n    return this.then(null, onRejected);\n  };\n\n  Promise.prototype.then = function (onFulfilled, onRejected) {\n    var prom = new (this.constructor)(noop);\n\n    handle(this, new Handler(onFulfilled, onRejected, prom));\n    return prom;\n  };\n\n  Promise.all = function (arr) {\n    var args = Array.prototype.slice.call(arr);\n\n    return new Promise(function (resolve, reject) {\n      if (args.length === 0) return resolve([]);\n      var remaining = args.length;\n\n      function res(i, val) {\n        try {\n          if (val && (typeof val === 'object' || typeof val === 'function')) {\n            var then = val.then;\n            if (typeof then === 'function') {\n              then.call(val, function (val) {\n                res(i, val);\n              }, reject);\n              return;\n            }\n          }\n          args[i] = val;\n          if (--remaining === 0) {\n            resolve(args);\n          }\n        } catch (ex) {\n          reject(ex);\n        }\n      }\n\n      for (var i = 0; i < args.length; i++) {\n        res(i, args[i]);\n      }\n    });\n  };\n\n  Promise.resolve = function (value) {\n    if (value && typeof value === 'object' && value.constructor === Promise) {\n      return value;\n    }\n\n    return new Promise(function (resolve) {\n      resolve(value);\n    });\n  };\n\n  Promise.reject = function (value) {\n    return new Promise(function (resolve, reject) {\n      reject(value);\n    });\n  };\n\n  Promise.race = function (values) {\n    return new Promise(function (resolve, reject) {\n      for (var i = 0, len = values.length; i < len; i++) {\n        values[i].then(resolve, reject);\n      }\n    });\n  };\n\n  // Use polyfill for setImmediate for performance gains\n  Promise._immediateFn = (typeof setImmediate === 'function' && function (fn) { setImmediate(fn); }) ||\n    function (fn) {\n      setTimeoutFunc(fn, 0);\n    };\n\n  Promise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n    if (typeof console !== 'undefined' && console) {\n      console.warn('Possible Unhandled Promise Rejection:', err); // eslint-disable-line no-console\n    }\n  };\n\n  /**\n   * Set the immediate function to execute callbacks\n   * @param fn {function} Function to execute\n   * @deprecated\n   */\n  Promise._setImmediateFn = function _setImmediateFn(fn) {\n    Promise._immediateFn = fn;\n  };\n\n  /**\n   * Change the function to execute on unhandled rejection\n   * @param {function} fn Function to execute on unhandled rejection\n   * @deprecated\n   */\n  Promise._setUnhandledRejectionFn = function _setUnhandledRejectionFn(fn) {\n    Promise._unhandledRejectionFn = fn;\n  };\n  \n  if (typeof module !== 'undefined' && module.exports) {\n    module.exports = Promise;\n  } else if (!root.Promise) {\n    root.Promise = Promise;\n  }\n\n})(this);\n\n},{}],159:[function(require,module,exports){\n\"use strict\";\n\nmodule.exports = {\n    apiKey: \"AIzaSyCGWEpvuy4sPR3n5xzwfATLzyMDvwE6tOY\",\n    authDomain: \"illinois-tech-acm.firebaseapp.com\",\n    databaseURL: \"https://illinois-tech-acm.firebaseio.com\",\n    projectId: \"illinois-tech-acm\",\n    storageBucket: \"illinois-tech-acm.appspot.com\",\n    messagingSenderId: \"344533734310\"\n};\n\n},{}],160:[function(require,module,exports){\n'use strict';\n\nvar config = require('./config');\nvar firebase = require('firebase');\nvar FirebaseApp = firebase.initializeApp(config);\nvar db = FirebaseApp.database();\n\nvar PARAMS = getQueryParams(document.location.search);\nvar GAME = PARAMS.game;\n\nvar PINK = '#EA38B9';\nvar PURPLE = '#422E6E';\n\nfunction getQueryParams(qs) {\n\tqs = qs.split('+').join(' ');\n\tvar params = {},\n\t    tokens,\n\t    re = /[?&]?([^=]+)=([^&]*)/g;\n\twhile (tokens = re.exec(qs)) {\n\t\tparams[decodeURIComponent(tokens[1])] = decodeURIComponent(tokens[2]);\n\t}\n\treturn params;\n}\n\nfunction onResults(gameid, callback) {\n\tdb.ref('lyft/results/' + gameid).on('value', function (snap) {\n\t\tvar val = snap.val() || {};\n\t\tcallback(val);\n\t});\n}\n\nfunction getTeamData(res) {\n\tvar inMap = res || {};\n\tvar sims = Object.keys(inMap).map(function (key) {\n\t\treturn res[key];\n\t}).sort(function (a, b) {\n\t\treturn a.start - b.start;\n\t});\n\tvar time = [];\n\tvar map = {};\n\tif (sims.length > 0) {\n\t\tvar first = sims[0];\n\t\tfor (var teamid in first.data) {\n\t\t\tif (!(teamid in map)) {\n\t\t\t\tmap[teamid] = {\n\t\t\t\t\tinfo: { teamid: teamid },\n\t\t\t\t\ttrips: [],\n\t\t\t\t\trevenue: []\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\tsims.forEach(function (sim) {\n\t\t\ttime.push(sim.start);\n\t\t\tfor (var _teamid in sim.data) {\n\t\t\t\tif (_teamid in map) {\n\t\t\t\t\tvar step = sim.data[_teamid];\n\t\t\t\t\tmap[_teamid].trips.push(step.trips);\n\t\t\t\t\tvar inRev = step.revenue;\n\t\t\t\t\tvar rev = {\n\t\t\t\t\t\tlyft: parseFloat(inRev.lyft),\n\t\t\t\t\t\ttaxi: parseFloat(inRev.taxi)\n\t\t\t\t\t};\n\t\t\t\t\tmap[_teamid].revenue.push(rev);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\treturn {\n\t\ttime: time,\n\t\tmap: map\n\t};\n}\n\nfunction plotMain(time, map) {\n\tvar datasets = [];\n\n\tvar _loop = function _loop(teamid) {\n\t\tvar line = [];\n\t\tvar total = 0;\n\t\tmap[teamid].revenue.forEach(function (step, idx) {\n\t\t\ttotal += step.lyft;\n\t\t\tline.push({\n\t\t\t\tx: time[idx],\n\t\t\t\ty: total\n\t\t\t});\n\t\t});\n\t\tdatasets.push({\n\t\t\tlabel: teamid,\n\t\t\tborderColor: PINK,\n\t\t\tfill: false,\n\t\t\tcubicInterpolationMode: 'monotone',\n\t\t\tdata: line\n\t\t});\n\t};\n\n\tfor (var teamid in map) {\n\t\t_loop(teamid);\n\t}\n\tvar ctx = document.getElementById('plot1').getContext('2d');\n\tvar chart = new Chart(ctx, {\n\t\ttype: 'line',\n\t\tdata: {\n\t\t\tdatasets: datasets\n\t\t},\n\t\toptions: {\n\t\t\tresponsive: false,\n\t\t\tmaintainAspectRatio: true,\n\t\t\tlegend: {\n\t\t\t\tposition: 'bottom'\n\t\t\t},\n\t\t\ttitle: {\n\t\t\t\tdisplay: true,\n\t\t\t\ttext: 'Revenue over Time'\n\t\t\t},\n\t\t\tscales: {\n\t\t\t\txAxes: [{\n\t\t\t\t\tdisplay: true,\n\t\t\t\t\ttype: 'linear'\n\t\t\t\t}],\n\t\t\t\tyAxes: [{\n\t\t\t\t\tdisplay: true,\n\t\t\t\t\ttype: 'linear'\n\t\t\t\t}]\n\t\t\t},\n\t\t\telements: {\n\t\t\t\tpoint: {\n\t\t\t\t\tradius: 0\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n}\n\nif (GAME) {\n\tonResults(GAME, function (res) {\n\t\tvar data = getTeamData(res);\n\t\tconsole.log(data);\n\t\tplotMain(data.time, data.map);\n\t});\n}\n\n},{\"./config\":159,\"firebase\":154}]},{},[160])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL2FwcC9kaXN0L2Nqcy9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXBwL2Rpc3QvY2pzL3NyYy9maXJlYmFzZUFwcC5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9kaXN0L2F1dGguanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL2RhdGFiYXNlL2Rpc3QvY2pzL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9kYXRhYmFzZS9kaXN0L2Nqcy9zcmMvYXBpL0RhdGFTbmFwc2hvdC5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL2FwaS9EYXRhYmFzZS5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL2FwaS9RdWVyeS5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL2FwaS9SZWZlcmVuY2UuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL2RhdGFiYXNlL2Rpc3QvY2pzL3NyYy9hcGkvVHJhbnNhY3Rpb25SZXN1bHQuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL2RhdGFiYXNlL2Rpc3QvY2pzL3NyYy9hcGkvaW50ZXJuYWwuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL2RhdGFiYXNlL2Rpc3QvY2pzL3NyYy9hcGkvb25EaXNjb25uZWN0LmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9kYXRhYmFzZS9kaXN0L2Nqcy9zcmMvYXBpL3Rlc3RfYWNjZXNzLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9kYXRhYmFzZS9kaXN0L2Nqcy9zcmMvY29yZS9BdXRoVG9rZW5Qcm92aWRlci5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL2NvcmUvQ29tcG91bmRXcml0ZS5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL2NvcmUvUGVyc2lzdGVudENvbm5lY3Rpb24uanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL2RhdGFiYXNlL2Rpc3QvY2pzL3NyYy9jb3JlL1JlYWRvbmx5UmVzdENsaWVudC5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL2NvcmUvUmVwby5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL2NvcmUvUmVwb0luZm8uanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL2RhdGFiYXNlL2Rpc3QvY2pzL3NyYy9jb3JlL1JlcG9NYW5hZ2VyLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9kYXRhYmFzZS9kaXN0L2Nqcy9zcmMvY29yZS9SZXBvX3RyYW5zYWN0aW9uLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9kYXRhYmFzZS9kaXN0L2Nqcy9zcmMvY29yZS9TZXJ2ZXJBY3Rpb25zLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9kYXRhYmFzZS9kaXN0L2Nqcy9zcmMvY29yZS9TbmFwc2hvdEhvbGRlci5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL2NvcmUvU3BhcnNlU25hcHNob3RUcmVlLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9kYXRhYmFzZS9kaXN0L2Nqcy9zcmMvY29yZS9TeW5jUG9pbnQuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL2RhdGFiYXNlL2Rpc3QvY2pzL3NyYy9jb3JlL1N5bmNUcmVlLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9kYXRhYmFzZS9kaXN0L2Nqcy9zcmMvY29yZS9Xcml0ZVRyZWUuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL2RhdGFiYXNlL2Rpc3QvY2pzL3NyYy9jb3JlL29wZXJhdGlvbi9BY2tVc2VyV3JpdGUuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL2RhdGFiYXNlL2Rpc3QvY2pzL3NyYy9jb3JlL29wZXJhdGlvbi9MaXN0ZW5Db21wbGV0ZS5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL2NvcmUvb3BlcmF0aW9uL01lcmdlLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9kYXRhYmFzZS9kaXN0L2Nqcy9zcmMvY29yZS9vcGVyYXRpb24vT3BlcmF0aW9uLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9kYXRhYmFzZS9kaXN0L2Nqcy9zcmMvY29yZS9vcGVyYXRpb24vT3ZlcndyaXRlLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9kYXRhYmFzZS9kaXN0L2Nqcy9zcmMvY29yZS9zbmFwL0NoaWxkcmVuTm9kZS5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL2NvcmUvc25hcC9JbmRleE1hcC5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL2NvcmUvc25hcC9MZWFmTm9kZS5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL2NvcmUvc25hcC9Ob2RlLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9kYXRhYmFzZS9kaXN0L2Nqcy9zcmMvY29yZS9zbmFwL2NoaWxkU2V0LmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9kYXRhYmFzZS9kaXN0L2Nqcy9zcmMvY29yZS9zbmFwL2NvbXBhcmF0b3JzLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9kYXRhYmFzZS9kaXN0L2Nqcy9zcmMvY29yZS9zbmFwL2luZGV4ZXMvSW5kZXguanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL2RhdGFiYXNlL2Rpc3QvY2pzL3NyYy9jb3JlL3NuYXAvaW5kZXhlcy9LZXlJbmRleC5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL2NvcmUvc25hcC9pbmRleGVzL1BhdGhJbmRleC5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL2NvcmUvc25hcC9pbmRleGVzL1ByaW9yaXR5SW5kZXguanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL2RhdGFiYXNlL2Rpc3QvY2pzL3NyYy9jb3JlL3NuYXAvaW5kZXhlcy9WYWx1ZUluZGV4LmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9kYXRhYmFzZS9kaXN0L2Nqcy9zcmMvY29yZS9zbmFwL25vZGVGcm9tSlNPTi5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL2NvcmUvc25hcC9zbmFwLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9kYXRhYmFzZS9kaXN0L2Nqcy9zcmMvY29yZS9zdGF0cy9TdGF0c0NvbGxlY3Rpb24uanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL2RhdGFiYXNlL2Rpc3QvY2pzL3NyYy9jb3JlL3N0YXRzL1N0YXRzTGlzdGVuZXIuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL2RhdGFiYXNlL2Rpc3QvY2pzL3NyYy9jb3JlL3N0YXRzL1N0YXRzTWFuYWdlci5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL2NvcmUvc3RhdHMvU3RhdHNSZXBvcnRlci5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL2NvcmUvc3RvcmFnZS9ET01TdG9yYWdlV3JhcHBlci5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL2NvcmUvc3RvcmFnZS9NZW1vcnlTdG9yYWdlLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9kYXRhYmFzZS9kaXN0L2Nqcy9zcmMvY29yZS9zdG9yYWdlL3N0b3JhZ2UuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL2RhdGFiYXNlL2Rpc3QvY2pzL3NyYy9jb3JlL3V0aWwvQ291bnRlZFNldC5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL2NvcmUvdXRpbC9FdmVudEVtaXR0ZXIuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL2RhdGFiYXNlL2Rpc3QvY2pzL3NyYy9jb3JlL3V0aWwvSW1tdXRhYmxlVHJlZS5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL2NvcmUvdXRpbC9OZXh0UHVzaElkLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9kYXRhYmFzZS9kaXN0L2Nqcy9zcmMvY29yZS91dGlsL09ubGluZU1vbml0b3IuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL2RhdGFiYXNlL2Rpc3QvY2pzL3NyYy9jb3JlL3V0aWwvUGF0aC5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL2NvcmUvdXRpbC9TZXJ2ZXJWYWx1ZXMuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL2RhdGFiYXNlL2Rpc3QvY2pzL3NyYy9jb3JlL3V0aWwvU29ydGVkTWFwLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9kYXRhYmFzZS9kaXN0L2Nqcy9zcmMvY29yZS91dGlsL1RyZWUuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL2RhdGFiYXNlL2Rpc3QvY2pzL3NyYy9jb3JlL3V0aWwvVmlzaWJpbGl0eU1vbml0b3IuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL2RhdGFiYXNlL2Rpc3QvY2pzL3NyYy9jb3JlL3V0aWwvbGlicy9wYXJzZXIuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL2RhdGFiYXNlL2Rpc3QvY2pzL3NyYy9jb3JlL3V0aWwvdXRpbC5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL2NvcmUvdXRpbC92YWxpZGF0aW9uLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9kYXRhYmFzZS9kaXN0L2Nqcy9zcmMvY29yZS92aWV3L0NhY2hlTm9kZS5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL2NvcmUvdmlldy9DaGFuZ2UuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL2RhdGFiYXNlL2Rpc3QvY2pzL3NyYy9jb3JlL3ZpZXcvQ2hpbGRDaGFuZ2VBY2N1bXVsYXRvci5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL2NvcmUvdmlldy9Db21wbGV0ZUNoaWxkU291cmNlLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9kYXRhYmFzZS9kaXN0L2Nqcy9zcmMvY29yZS92aWV3L0V2ZW50LmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9kYXRhYmFzZS9kaXN0L2Nqcy9zcmMvY29yZS92aWV3L0V2ZW50R2VuZXJhdG9yLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9kYXRhYmFzZS9kaXN0L2Nqcy9zcmMvY29yZS92aWV3L0V2ZW50UXVldWUuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL2RhdGFiYXNlL2Rpc3QvY2pzL3NyYy9jb3JlL3ZpZXcvRXZlbnRSZWdpc3RyYXRpb24uanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL2RhdGFiYXNlL2Rpc3QvY2pzL3NyYy9jb3JlL3ZpZXcvUXVlcnlQYXJhbXMuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL2RhdGFiYXNlL2Rpc3QvY2pzL3NyYy9jb3JlL3ZpZXcvVmlldy5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL2NvcmUvdmlldy9WaWV3Q2FjaGUuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL2RhdGFiYXNlL2Rpc3QvY2pzL3NyYy9jb3JlL3ZpZXcvVmlld1Byb2Nlc3Nvci5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL2NvcmUvdmlldy9maWx0ZXIvSW5kZXhlZEZpbHRlci5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL2NvcmUvdmlldy9maWx0ZXIvTGltaXRlZEZpbHRlci5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL2NvcmUvdmlldy9maWx0ZXIvUmFuZ2VkRmlsdGVyLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9kYXRhYmFzZS9kaXN0L2Nqcy9zcmMvcmVhbHRpbWUvQnJvd3NlclBvbGxDb25uZWN0aW9uLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9kYXRhYmFzZS9kaXN0L2Nqcy9zcmMvcmVhbHRpbWUvQ29ubmVjdGlvbi5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL3JlYWx0aW1lL0NvbnN0YW50cy5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZGF0YWJhc2UvZGlzdC9janMvc3JjL3JlYWx0aW1lL1RyYW5zcG9ydE1hbmFnZXIuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL2RhdGFiYXNlL2Rpc3QvY2pzL3NyYy9yZWFsdGltZS9XZWJTb2NrZXRDb25uZWN0aW9uLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9kYXRhYmFzZS9kaXN0L2Nqcy9zcmMvcmVhbHRpbWUvcG9sbGluZy9QYWNrZXRSZWNlaXZlci5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvbWVzc2FnaW5nL2Rpc3QvY2pzL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9tZXNzYWdpbmcvZGlzdC9janMvc3JjL2NvbnRyb2xsZXJzL2NvbnRyb2xsZXItaW50ZXJmYWNlLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9tZXNzYWdpbmcvZGlzdC9janMvc3JjL2NvbnRyb2xsZXJzL3N3LWNvbnRyb2xsZXIuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL21lc3NhZ2luZy9kaXN0L2Nqcy9zcmMvY29udHJvbGxlcnMvd2luZG93LWNvbnRyb2xsZXIuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL21lc3NhZ2luZy9kaXN0L2Nqcy9zcmMvaGVscGVycy9hcnJheS1idWZmZXItdG8tYmFzZTY0LmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9tZXNzYWdpbmcvZGlzdC9janMvc3JjL21vZGVscy9kZWZhdWx0LXN3LmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9tZXNzYWdpbmcvZGlzdC9janMvc3JjL21vZGVscy9lcnJvcnMuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL21lc3NhZ2luZy9kaXN0L2Nqcy9zcmMvbW9kZWxzL2ZjbS1kZXRhaWxzLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9tZXNzYWdpbmcvZGlzdC9janMvc3JjL21vZGVscy9ub3RpZmljYXRpb24tcGVybWlzc2lvbi5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvbWVzc2FnaW5nL2Rpc3QvY2pzL3NyYy9tb2RlbHMvdG9rZW4tbWFuYWdlci5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvbWVzc2FnaW5nL2Rpc3QvY2pzL3NyYy9tb2RlbHMvd29ya2VyLXBhZ2UtbWVzc2FnZS5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvcG9seWZpbGwvZGlzdC9janMvaW5kZXguanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL3BvbHlmaWxsL2Rpc3QvY2pzL3NyYy9wb2x5ZmlsbHMvcHJvbWlzZS5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvcG9seWZpbGwvZGlzdC9janMvc3JjL3NoaW1zL2ZpbmQuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL3BvbHlmaWxsL2Rpc3QvY2pzL3NyYy9zaGltcy9maW5kSW5kZXguanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL3N0b3JhZ2UvZGlzdC9janMvaW5kZXguanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL3N0b3JhZ2UvZGlzdC9janMvc3JjL2ltcGxlbWVudGF0aW9uL2FyZ3MuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL3N0b3JhZ2UvZGlzdC9janMvc3JjL2ltcGxlbWVudGF0aW9uL2FycmF5LmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9zdG9yYWdlL2Rpc3QvY2pzL3NyYy9pbXBsZW1lbnRhdGlvbi9hc3luYy5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2Uvc3RvcmFnZS9kaXN0L2Nqcy9zcmMvaW1wbGVtZW50YXRpb24vYXV0aHdyYXBwZXIuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL3N0b3JhZ2UvZGlzdC9janMvc3JjL2ltcGxlbWVudGF0aW9uL2JhY2tvZmYuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL3N0b3JhZ2UvZGlzdC9janMvc3JjL2ltcGxlbWVudGF0aW9uL2Jsb2IuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL3N0b3JhZ2UvZGlzdC9janMvc3JjL2ltcGxlbWVudGF0aW9uL2NvbnN0YW50cy5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2Uvc3RvcmFnZS9kaXN0L2Nqcy9zcmMvaW1wbGVtZW50YXRpb24vZXJyb3IuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL3N0b3JhZ2UvZGlzdC9janMvc3JjL2ltcGxlbWVudGF0aW9uL2ZhaWxyZXF1ZXN0LmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9zdG9yYWdlL2Rpc3QvY2pzL3NyYy9pbXBsZW1lbnRhdGlvbi9mcy5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2Uvc3RvcmFnZS9kaXN0L2Nqcy9zcmMvaW1wbGVtZW50YXRpb24vanNvbi5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2Uvc3RvcmFnZS9kaXN0L2Nqcy9zcmMvaW1wbGVtZW50YXRpb24vbG9jYXRpb24uanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL3N0b3JhZ2UvZGlzdC9janMvc3JjL2ltcGxlbWVudGF0aW9uL21ldGFkYXRhLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9zdG9yYWdlL2Rpc3QvY2pzL3NyYy9pbXBsZW1lbnRhdGlvbi9vYmplY3QuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL3N0b3JhZ2UvZGlzdC9janMvc3JjL2ltcGxlbWVudGF0aW9uL29ic2VydmVyLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9zdG9yYWdlL2Rpc3QvY2pzL3NyYy9pbXBsZW1lbnRhdGlvbi9wYXRoLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9zdG9yYWdlL2Rpc3QvY2pzL3NyYy9pbXBsZW1lbnRhdGlvbi9wcm9taXNlX2V4dGVybmFsLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9zdG9yYWdlL2Rpc3QvY2pzL3NyYy9pbXBsZW1lbnRhdGlvbi9yZXF1ZXN0LmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9zdG9yYWdlL2Rpc3QvY2pzL3NyYy9pbXBsZW1lbnRhdGlvbi9yZXF1ZXN0aW5mby5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2Uvc3RvcmFnZS9kaXN0L2Nqcy9zcmMvaW1wbGVtZW50YXRpb24vcmVxdWVzdG1hcC5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2Uvc3RvcmFnZS9kaXN0L2Nqcy9zcmMvaW1wbGVtZW50YXRpb24vcmVxdWVzdHMuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL3N0b3JhZ2UvZGlzdC9janMvc3JjL2ltcGxlbWVudGF0aW9uL3N0cmluZy5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2Uvc3RvcmFnZS9kaXN0L2Nqcy9zcmMvaW1wbGVtZW50YXRpb24vdGFza2VudW1zLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9zdG9yYWdlL2Rpc3QvY2pzL3NyYy9pbXBsZW1lbnRhdGlvbi90eXBlLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9zdG9yYWdlL2Rpc3QvY2pzL3NyYy9pbXBsZW1lbnRhdGlvbi91cmwuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL3N0b3JhZ2UvZGlzdC9janMvc3JjL2ltcGxlbWVudGF0aW9uL3hocmlvLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9zdG9yYWdlL2Rpc3QvY2pzL3NyYy9pbXBsZW1lbnRhdGlvbi94aHJpb19uZXR3b3JrLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9zdG9yYWdlL2Rpc3QvY2pzL3NyYy9pbXBsZW1lbnRhdGlvbi94aHJpb3Bvb2wuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL3N0b3JhZ2UvZGlzdC9janMvc3JjL3JlZmVyZW5jZS5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2Uvc3RvcmFnZS9kaXN0L2Nqcy9zcmMvc2VydmljZS5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2Uvc3RvcmFnZS9kaXN0L2Nqcy9zcmMvdGFzay5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2Uvc3RvcmFnZS9kaXN0L2Nqcy9zcmMvdGFza3NuYXBzaG90LmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS91dGlsL2Rpc3QvY2pzL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS91dGlsL2Rpc3QvY2pzL3NyYy9hc3NlcnQuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL3V0aWwvZGlzdC9janMvc3JjL2NvbnN0YW50cy5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvdXRpbC9kaXN0L2Nqcy9zcmMvY3J5cHQuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL3V0aWwvZGlzdC9janMvc3JjL2RlZXBDb3B5LmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS91dGlsL2Rpc3QvY2pzL3NyYy9kZWZlcnJlZC5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvdXRpbC9kaXN0L2Nqcy9zcmMvZW52aXJvbm1lbnQuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL3V0aWwvZGlzdC9janMvc3JjL2Vycm9ycy5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvdXRpbC9kaXN0L2Nqcy9zcmMvaGFzaC5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvdXRpbC9kaXN0L2Nqcy9zcmMvanNvbi5qcyIsIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvdXRpbC9kaXN0L2Nqcy9zcmMvand0LmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS91dGlsL2Rpc3QvY2pzL3NyYy9vYmouanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL3V0aWwvZGlzdC9janMvc3JjL3F1ZXJ5LmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS91dGlsL2Rpc3QvY2pzL3NyYy9zaGExLmpzIiwibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS91dGlsL2Rpc3QvY2pzL3NyYy9zdWJzY3JpYmUuanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL3V0aWwvZGlzdC9janMvc3JjL3V0ZjguanMiLCJub2RlX21vZHVsZXMvQGZpcmViYXNlL3V0aWwvZGlzdC9janMvc3JjL3ZhbGlkYXRpb24uanMiLCJub2RlX21vZHVsZXMvZmlyZWJhc2UvYXBwL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL2ZpcmViYXNlL2F1dGgvaW5kZXguanMiLCJub2RlX21vZHVsZXMvZmlyZWJhc2UvZGF0YWJhc2UvaW5kZXguanMiLCJub2RlX21vZHVsZXMvZmlyZWJhc2UvaW5kZXguanMiLCJub2RlX21vZHVsZXMvZmlyZWJhc2UvbWVzc2FnaW5nL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL2ZpcmViYXNlL3N0b3JhZ2UvaW5kZXguanMiLCJub2RlX21vZHVsZXMvcHJvY2Vzcy9icm93c2VyLmpzIiwibm9kZV9tb2R1bGVzL3Byb21pc2UtcG9seWZpbGwvcHJvbWlzZS5qcyIsInNyYy9qcy9jb25maWcuanMiLCJzcmMvanMvbWFpbi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDNVdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQzdUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3S0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNySUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFmQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcFRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDenlCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoaEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9HQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JqQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdnNCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6bkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeGZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckxBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3UUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25EQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcldBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdFVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbHBCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbk9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNySEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2bkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdYQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0VBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1S0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RaQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNubEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcklBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDblFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JuQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3ZUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ25HQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQy9WQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDelRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcFZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9HQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9XQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ3RCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDbENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbklBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25FQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6TEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDak9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM1ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5TUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4SUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwakJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2SUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2UkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1TkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4TEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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LEdBTkQ7QUFPQSxXQUFTLElBQVQsQ0FBYztBQUNiLFVBQU8sTUFETTtBQUViLGdCQUFhLElBRkE7QUFHYixTQUFNLEtBSE87QUFJYiwyQkFBd0IsVUFKWDtBQUtiLFNBQU07QUFMTyxHQUFkO0FBWjJCOztBQUU1QixNQUFLLElBQUksTUFBVCxJQUFtQixHQUFuQixFQUF3QjtBQUFBLFFBQWYsTUFBZTtBQWlCdkI7QUFDRCxLQUFJLE1BQU0sU0FBUyxjQUFULENBQXdCLE9BQXhCLEVBQWlDLFVBQWpDLENBQTRDLElBQTVDLENBQVY7QUFDQSxLQUFJLFFBQVEsSUFBSSxLQUFKLENBQVUsR0FBVixFQUFlO0FBQzFCLGNBRDBCO0FBRTFCLFFBQU07QUFDTCxhQUFVO0FBREwsR0FGb0I7QUFLMUIsV0FBUztBQUNSLGVBQVksS0FESjtBQUVSLHdCQUFxQixJQUZiO0FBR1IsV0FBUTtBQUNQO0FBRE8sSUFIQTtBQU1SLFVBQU87QUFDTixhQUFTLElBREg7QUFFTjtBQUZNLElBTkM7QUFVUixXQUFRO0FBQ1AsV0FBTyxDQUFDO0FBQ1AsY0FBUyxJQURGO0FBRVA7QUFGTyxLQUFELENBREE7QUFLUCxXQUFPLENBQUM7QUFDUCxjQUFTLElBREY7QUFFUDtBQUZPLEtBQUQ7QUFMQSxJQVZBO0FBb0JSLGFBQVU7QUFDVCxXQUFPO0FBQ04sYUFBUTtBQURGO0FBREU7QUFwQkY7QUFMaUIsRUFBZixDQUFaO0FBZ0NBOztBQUVELElBQUksSUFBSixFQUFVO0FBQ1QsV0FBVSxJQUFWLEVBQWdCLFVBQUMsR0FBRCxFQUFTO0FBQ3hCLE1BQUksT0FBTyxZQUFZLEdBQVosQ0FBWDtBQUNBLFVBQVEsR0FBUixDQUFZLElBQVo7QUFDQSxXQUFTLEtBQUssSUFBZCxFQUFvQixLQUFLLEdBQXpCO0FBQ0EsRUFKRDtBQUtBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBmaXJlYmFzZUFwcF8xID0gcmVxdWlyZShcIi4vc3JjL2ZpcmViYXNlQXBwXCIpO1xuZXhwb3J0cy5maXJlYmFzZSA9IGZpcmViYXNlQXBwXzEuY3JlYXRlRmlyZWJhc2VOYW1lc3BhY2UoKTtcbmV4cG9ydHMuZGVmYXVsdCA9IGV4cG9ydHMuZmlyZWJhc2U7XG5cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG52YXIgdXRpbF8xID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xudmFyIHV0aWxfMiA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvdXRpbFwiKTtcbnZhciBjb250YWlucyA9IGZ1bmN0aW9uIChvYmosIGtleSkge1xuICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpO1xufTtcbnZhciBERUZBVUxUX0VOVFJZX05BTUUgPSAnW0RFRkFVTFRdJztcbi8vIEFuIGFycmF5IHRvIGNhcHR1cmUgbGlzdGVuZXJzIGJlZm9yZSB0aGUgdHJ1ZSBhdXRoIGZ1bmN0aW9uc1xuLy8gZXhpc3RcbnZhciB0b2tlbkxpc3RlbmVycyA9IFtdO1xuLyoqXG4gKiBHbG9iYWwgY29udGV4dCBvYmplY3QgZm9yIGEgY29sbGVjdGlvbiBvZiBzZXJ2aWNlcyB1c2luZ1xuICogYSBzaGFyZWQgYXV0aGVudGljYXRpb24gc3RhdGUuXG4gKi9cbnZhciBGaXJlYmFzZUFwcEltcGwgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRmlyZWJhc2VBcHBJbXBsKG9wdGlvbnMsIG5hbWUsIGZpcmViYXNlXykge1xuICAgICAgICB0aGlzLmZpcmViYXNlXyA9IGZpcmViYXNlXztcbiAgICAgICAgdGhpcy5pc0RlbGV0ZWRfID0gZmFsc2U7XG4gICAgICAgIHRoaXMuc2VydmljZXNfID0ge307XG4gICAgICAgIHRoaXMubmFtZV8gPSBuYW1lO1xuICAgICAgICB0aGlzLm9wdGlvbnNfID0gdXRpbF8yLmRlZXBDb3B5KG9wdGlvbnMpO1xuICAgICAgICB0aGlzLklOVEVSTkFMID0ge1xuICAgICAgICAgICAgZ2V0VWlkOiBmdW5jdGlvbiAoKSB7IHJldHVybiBudWxsOyB9LFxuICAgICAgICAgICAgZ2V0VG9rZW46IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFByb21pc2UucmVzb2x2ZShudWxsKTsgfSxcbiAgICAgICAgICAgIGFkZEF1dGhUb2tlbkxpc3RlbmVyOiBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICB0b2tlbkxpc3RlbmVycy5wdXNoKGNhbGxiYWNrKTtcbiAgICAgICAgICAgICAgICAvLyBNYWtlIHN1cmUgY2FsbGJhY2sgaXMgY2FsbGVkLCBhc3luY2hyb25vdXNseSwgaW4gdGhlIGFic2VuY2Ugb2YgdGhlIGF1dGggbW9kdWxlXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHJldHVybiBjYWxsYmFjayhudWxsKTsgfSwgMCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmVtb3ZlQXV0aFRva2VuTGlzdGVuZXI6IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIHRva2VuTGlzdGVuZXJzID0gdG9rZW5MaXN0ZW5lcnMuZmlsdGVyKGZ1bmN0aW9uIChsaXN0ZW5lcikgeyByZXR1cm4gbGlzdGVuZXIgIT09IGNhbGxiYWNrOyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpcmViYXNlQXBwSW1wbC5wcm90b3R5cGUsIFwibmFtZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5jaGVja0Rlc3Ryb3llZF8oKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5hbWVfO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmlyZWJhc2VBcHBJbXBsLnByb3RvdHlwZSwgXCJvcHRpb25zXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLmNoZWNrRGVzdHJveWVkXygpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9uc187XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEZpcmViYXNlQXBwSW1wbC5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgICAgIF90aGlzLmNoZWNrRGVzdHJveWVkXygpO1xuICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3RoaXMuZmlyZWJhc2VfLklOVEVSTkFMLnJlbW92ZUFwcChfdGhpcy5uYW1lXyk7XG4gICAgICAgICAgICB2YXIgc2VydmljZXMgPSBbXTtcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKF90aGlzLnNlcnZpY2VzXykuZm9yRWFjaChmdW5jdGlvbiAoc2VydmljZUtleSkge1xuICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKF90aGlzLnNlcnZpY2VzX1tzZXJ2aWNlS2V5XSkuZm9yRWFjaChmdW5jdGlvbiAoaW5zdGFuY2VLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VydmljZXMucHVzaChfdGhpcy5zZXJ2aWNlc19bc2VydmljZUtleV1baW5zdGFuY2VLZXldKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKHNlcnZpY2VzLm1hcChmdW5jdGlvbiAoc2VydmljZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzZXJ2aWNlLklOVEVSTkFMLmRlbGV0ZSgpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3RoaXMuaXNEZWxldGVkXyA9IHRydWU7XG4gICAgICAgICAgICBfdGhpcy5zZXJ2aWNlc18gPSB7fTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYSBzZXJ2aWNlIGluc3RhbmNlIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGFwcCAoY3JlYXRpbmcgaXRcbiAgICAgKiBvbiBkZW1hbmQpLCBpZGVudGlmaWVkIGJ5IHRoZSBwYXNzZWQgaW5zdGFuY2VJZGVudGlmaWVyLlxuICAgICAqXG4gICAgICogTk9URTogQ3VycmVudGx5IHN0b3JhZ2UgaXMgdGhlIG9ubHkgb25lIHRoYXQgaXMgbGV2ZXJhZ2luZyB0aGlzXG4gICAgICogZnVuY3Rpb25hbGl0eS4gVGhleSBpbnZva2UgaXQgYnkgY2FsbGluZzpcbiAgICAgKlxuICAgICAqIGBgYGphdmFzY3JpcHRcbiAgICAgKiBmaXJlYmFzZS5hcHAoKS5zdG9yYWdlKCdTVE9SQUdFIEJVQ0tFVCBJRCcpXG4gICAgICogYGBgXG4gICAgICpcbiAgICAgKiBUaGUgc2VydmljZSBuYW1lIGlzIHBhc3NlZCB0byB0aGlzIGFscmVhZHlcbiAgICAgKiBAaW50ZXJuYWxcbiAgICAgKi9cbiAgICBGaXJlYmFzZUFwcEltcGwucHJvdG90eXBlLl9nZXRTZXJ2aWNlID0gZnVuY3Rpb24gKG5hbWUsIGluc3RhbmNlSWRlbnRpZmllcikge1xuICAgICAgICBpZiAoaW5zdGFuY2VJZGVudGlmaWVyID09PSB2b2lkIDApIHsgaW5zdGFuY2VJZGVudGlmaWVyID0gREVGQVVMVF9FTlRSWV9OQU1FOyB9XG4gICAgICAgIHRoaXMuY2hlY2tEZXN0cm95ZWRfKCk7XG4gICAgICAgIGlmICghdGhpcy5zZXJ2aWNlc19bbmFtZV0pIHtcbiAgICAgICAgICAgIHRoaXMuc2VydmljZXNfW25hbWVdID0ge307XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLnNlcnZpY2VzX1tuYW1lXVtpbnN0YW5jZUlkZW50aWZpZXJdKSB7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIElmIGEgY3VzdG9tIGluc3RhbmNlIGhhcyBiZWVuIGRlZmluZWQgKGkuZS4gbm90ICdbREVGQVVMVF0nKVxuICAgICAgICAgICAgICogdGhlbiB3ZSB3aWxsIHBhc3MgdGhhdCBpbnN0YW5jZSBvbiwgb3RoZXJ3aXNlIHdlIHBhc3MgYG51bGxgXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHZhciBpbnN0YW5jZVNwZWNpZmllciA9IGluc3RhbmNlSWRlbnRpZmllciAhPT0gREVGQVVMVF9FTlRSWV9OQU1FXG4gICAgICAgICAgICAgICAgPyBpbnN0YW5jZUlkZW50aWZpZXJcbiAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHZhciBzZXJ2aWNlID0gdGhpcy5maXJlYmFzZV8uSU5URVJOQUwuZmFjdG9yaWVzW25hbWVdKHRoaXMsIHRoaXMuZXh0ZW5kQXBwLmJpbmQodGhpcyksIGluc3RhbmNlU3BlY2lmaWVyKTtcbiAgICAgICAgICAgIHRoaXMuc2VydmljZXNfW25hbWVdW2luc3RhbmNlSWRlbnRpZmllcl0gPSBzZXJ2aWNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnNlcnZpY2VzX1tuYW1lXVtpbnN0YW5jZUlkZW50aWZpZXJdO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQ2FsbGJhY2sgZnVuY3Rpb24gdXNlZCB0byBleHRlbmQgYW4gQXBwIGluc3RhbmNlIGF0IHRoZSB0aW1lXG4gICAgICogb2Ygc2VydmljZSBpbnN0YW5jZSBjcmVhdGlvbi5cbiAgICAgKi9cbiAgICBGaXJlYmFzZUFwcEltcGwucHJvdG90eXBlLmV4dGVuZEFwcCA9IGZ1bmN0aW9uIChwcm9wcykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAvLyBDb3B5IHRoZSBvYmplY3Qgb250byB0aGUgRmlyZWJhc2VBcHBJbXBsIHByb3RvdHlwZVxuICAgICAgICB1dGlsXzIuZGVlcEV4dGVuZCh0aGlzLCBwcm9wcyk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJZiB0aGUgYXBwIGhhcyBvdmVyd3JpdHRlbiB0aGUgYWRkQXV0aFRva2VuTGlzdGVuZXIgc3R1YiwgZm9yd2FyZFxuICAgICAgICAgKiB0aGUgYWN0aXZlIHRva2VuIGxpc3RlbmVycyBvbiB0byB0aGUgdHJ1ZSBmeG4uXG4gICAgICAgICAqXG4gICAgICAgICAqIFRPRE86IFRoaXMgZnVuY3Rpb24gaXMgcmVxdWlyZWQgZHVlIHRvIG91ciBjdXJyZW50IG1vZHVsZVxuICAgICAgICAgKiBzdHJ1Y3R1cmUuIE9uY2Ugd2UgYXJlIGFibGUgdG8gcmVseSBzdHJpY3RseSB1cG9uIGEgc2luZ2xlIG1vZHVsZVxuICAgICAgICAgKiBpbXBsZW1lbnRhdGlvbiwgdGhpcyBjb2RlIHNob3VsZCBiZSByZWZhY3RvcmVkIGFuZCBBdXRoIHNob3VsZFxuICAgICAgICAgKiBwcm92aWRlIHRoZXNlIHN0dWJzIGFuZCB0aGUgdXBncmFkZSBsb2dpY1xuICAgICAgICAgKi9cbiAgICAgICAgaWYgKHByb3BzLklOVEVSTkFMICYmIHByb3BzLklOVEVSTkFMLmFkZEF1dGhUb2tlbkxpc3RlbmVyKSB7XG4gICAgICAgICAgICB0b2tlbkxpc3RlbmVycy5mb3JFYWNoKGZ1bmN0aW9uIChsaXN0ZW5lcikge1xuICAgICAgICAgICAgICAgIF90aGlzLklOVEVSTkFMLmFkZEF1dGhUb2tlbkxpc3RlbmVyKGxpc3RlbmVyKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdG9rZW5MaXN0ZW5lcnMgPSBbXTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogVGhpcyBmdW5jdGlvbiB3aWxsIHRocm93IGFuIEVycm9yIGlmIHRoZSBBcHAgaGFzIGFscmVhZHkgYmVlbiBkZWxldGVkIC1cbiAgICAgKiB1c2UgYmVmb3JlIHBlcmZvcm1pbmcgQVBJIGFjdGlvbnMgb24gdGhlIEFwcC5cbiAgICAgKi9cbiAgICBGaXJlYmFzZUFwcEltcGwucHJvdG90eXBlLmNoZWNrRGVzdHJveWVkXyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNEZWxldGVkXykge1xuICAgICAgICAgICAgZXJyb3IoJ2FwcC1kZWxldGVkJywgeyBuYW1lOiB0aGlzLm5hbWVfIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gRmlyZWJhc2VBcHBJbXBsO1xufSgpKTtcbi8vIFByZXZlbnQgZGVhZC1jb2RlIGVsaW1pbmF0aW9uIG9mIHRoZXNlIG1ldGhvZHMgdy9vIGludmFsaWQgcHJvcGVydHlcbi8vIGNvcHlpbmcuXG4oRmlyZWJhc2VBcHBJbXBsLnByb3RvdHlwZS5uYW1lICYmIEZpcmViYXNlQXBwSW1wbC5wcm90b3R5cGUub3B0aW9ucykgfHxcbiAgICBGaXJlYmFzZUFwcEltcGwucHJvdG90eXBlLmRlbGV0ZSB8fFxuICAgIGNvbnNvbGUubG9nKCdkYycpO1xuLyoqXG4gKiBSZXR1cm4gYSBmaXJlYmFzZSBuYW1lc3BhY2Ugb2JqZWN0LlxuICpcbiAqIEluIHByb2R1Y3Rpb24sIHRoaXMgd2lsbCBiZSBjYWxsZWQgZXhhY3RseSBvbmNlIGFuZCB0aGUgcmVzdWx0XG4gKiBhc3NpZ25lZCB0byB0aGUgJ2ZpcmViYXNlJyBnbG9iYWwuICBJdCBtYXkgYmUgY2FsbGVkIG11bHRpcGxlIHRpbWVzXG4gKiBpbiB1bml0IHRlc3RzLlxuICovXG5mdW5jdGlvbiBjcmVhdGVGaXJlYmFzZU5hbWVzcGFjZSgpIHtcbiAgICB2YXIgYXBwc18gPSB7fTtcbiAgICB2YXIgZmFjdG9yaWVzID0ge307XG4gICAgdmFyIGFwcEhvb2tzID0ge307XG4gICAgLy8gQSBuYW1lc3BhY2UgaXMgYSBwbGFpbiBKYXZhU2NyaXB0IE9iamVjdC5cbiAgICB2YXIgbmFtZXNwYWNlID0ge1xuICAgICAgICAvLyBIYWNrIHRvIHByZXZlbnQgQmFiZWwgZnJvbSBtb2RpZnlpbmcgdGhlIG9iamVjdCByZXR1cm5lZFxuICAgICAgICAvLyBhcyB0aGUgZmlyZWJhc2UgbmFtZXNwYWNlLlxuICAgICAgICBfX2VzTW9kdWxlOiB0cnVlLFxuICAgICAgICBpbml0aWFsaXplQXBwOiBpbml0aWFsaXplQXBwLFxuICAgICAgICBhcHA6IGFwcCxcbiAgICAgICAgYXBwczogbnVsbCxcbiAgICAgICAgUHJvbWlzZTogUHJvbWlzZSxcbiAgICAgICAgU0RLX1ZFUlNJT046ICc0LjUuMicsXG4gICAgICAgIElOVEVSTkFMOiB7XG4gICAgICAgICAgICByZWdpc3RlclNlcnZpY2U6IHJlZ2lzdGVyU2VydmljZSxcbiAgICAgICAgICAgIGNyZWF0ZUZpcmViYXNlTmFtZXNwYWNlOiBjcmVhdGVGaXJlYmFzZU5hbWVzcGFjZSxcbiAgICAgICAgICAgIGV4dGVuZE5hbWVzcGFjZTogZXh0ZW5kTmFtZXNwYWNlLFxuICAgICAgICAgICAgY3JlYXRlU3Vic2NyaWJlOiB1dGlsXzEuY3JlYXRlU3Vic2NyaWJlLFxuICAgICAgICAgICAgRXJyb3JGYWN0b3J5OiB1dGlsXzIuRXJyb3JGYWN0b3J5LFxuICAgICAgICAgICAgcmVtb3ZlQXBwOiByZW1vdmVBcHAsXG4gICAgICAgICAgICBmYWN0b3JpZXM6IGZhY3RvcmllcyxcbiAgICAgICAgICAgIHVzZUFzU2VydmljZTogdXNlQXNTZXJ2aWNlLFxuICAgICAgICAgICAgUHJvbWlzZTogUHJvbWlzZSxcbiAgICAgICAgICAgIGRlZXBFeHRlbmQ6IHV0aWxfMi5kZWVwRXh0ZW5kXG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8vIEluamVjdCBhIGNpcmN1bGFyIGRlZmF1bHQgZXhwb3J0IHRvIGFsbG93IEJhYmVsIHVzZXJzIHdobyB3ZXJlIHByZXZpb3VzbHlcbiAgICAvLyB1c2luZzpcbiAgICAvL1xuICAgIC8vICAgaW1wb3J0IGZpcmViYXNlIGZyb20gJ2ZpcmViYXNlJztcbiAgICAvLyAgIHdoaWNoIGJlY29tZXM6IHZhciBmaXJlYmFzZSA9IHJlcXVpcmUoJ2ZpcmViYXNlJykuZGVmYXVsdDtcbiAgICAvL1xuICAgIC8vIGluc3RlYWQgb2ZcbiAgICAvL1xuICAgIC8vICAgaW1wb3J0ICogYXMgZmlyZWJhc2UgZnJvbSAnZmlyZWJhc2UnO1xuICAgIC8vICAgd2hpY2ggYmVjb21lczogdmFyIGZpcmViYXNlID0gcmVxdWlyZSgnZmlyZWJhc2UnKTtcbiAgICB1dGlsXzIucGF0Y2hQcm9wZXJ0eShuYW1lc3BhY2UsICdkZWZhdWx0JywgbmFtZXNwYWNlKTtcbiAgICAvLyBmaXJlYmFzZS5hcHBzIGlzIGEgcmVhZC1vbmx5IGdldHRlci5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmFtZXNwYWNlLCAnYXBwcycsIHtcbiAgICAgICAgZ2V0OiBnZXRBcHBzXG4gICAgfSk7XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIGJ5IEFwcC5kZWxldGUoKSAtIGJ1dCBiZWZvcmUgYW55IHNlcnZpY2VzIGFzc29jaWF0ZWQgd2l0aCB0aGUgQXBwXG4gICAgICogYXJlIGRlbGV0ZWQuXG4gICAgICovXG4gICAgZnVuY3Rpb24gcmVtb3ZlQXBwKG5hbWUpIHtcbiAgICAgICAgdmFyIGFwcCA9IGFwcHNfW25hbWVdO1xuICAgICAgICBjYWxsQXBwSG9va3MoYXBwLCAnZGVsZXRlJyk7XG4gICAgICAgIGRlbGV0ZSBhcHBzX1tuYW1lXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBBcHAgb2JqZWN0IGZvciBhIGdpdmVuIG5hbWUgKG9yIERFRkFVTFQpLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGFwcChuYW1lKSB7XG4gICAgICAgIG5hbWUgPSBuYW1lIHx8IERFRkFVTFRfRU5UUllfTkFNRTtcbiAgICAgICAgaWYgKCFjb250YWlucyhhcHBzXywgbmFtZSkpIHtcbiAgICAgICAgICAgIGVycm9yKCduby1hcHAnLCB7IG5hbWU6IG5hbWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFwcHNfW25hbWVdO1xuICAgIH1cbiAgICB1dGlsXzIucGF0Y2hQcm9wZXJ0eShhcHAsICdBcHAnLCBGaXJlYmFzZUFwcEltcGwpO1xuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIG5ldyBBcHAgaW5zdGFuY2UgKG5hbWUgbXVzdCBiZSB1bmlxdWUpLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGluaXRpYWxpemVBcHAob3B0aW9ucywgbmFtZSkge1xuICAgICAgICBpZiAobmFtZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBuYW1lID0gREVGQVVMVF9FTlRSWV9OQU1FO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBuYW1lICE9PSAnc3RyaW5nJyB8fCBuYW1lID09PSAnJykge1xuICAgICAgICAgICAgICAgIGVycm9yKCdiYWQtYXBwLW5hbWUnLCB7IG5hbWU6IG5hbWUgKyAnJyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoY29udGFpbnMoYXBwc18sIG5hbWUpKSB7XG4gICAgICAgICAgICBlcnJvcignZHVwbGljYXRlLWFwcCcsIHsgbmFtZTogbmFtZSB9KTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYXBwID0gbmV3IEZpcmViYXNlQXBwSW1wbChvcHRpb25zLCBuYW1lLCBuYW1lc3BhY2UpO1xuICAgICAgICBhcHBzX1tuYW1lXSA9IGFwcDtcbiAgICAgICAgY2FsbEFwcEhvb2tzKGFwcCwgJ2NyZWF0ZScpO1xuICAgICAgICByZXR1cm4gYXBwO1xuICAgIH1cbiAgICAvKlxuICAgICAqIFJldHVybiBhbiBhcnJheSBvZiBhbGwgdGhlIG5vbi1kZWxldGVkIEZpcmViYXNlQXBwcy5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBnZXRBcHBzKCkge1xuICAgICAgICAvLyBNYWtlIGEgY29weSBzbyBjYWxsZXIgY2Fubm90IG11dGF0ZSB0aGUgYXBwcyBsaXN0LlxuICAgICAgICByZXR1cm4gT2JqZWN0LmtleXMoYXBwc18pLm1hcChmdW5jdGlvbiAobmFtZSkgeyByZXR1cm4gYXBwc19bbmFtZV07IH0pO1xuICAgIH1cbiAgICAvKlxuICAgICAqIFJlZ2lzdGVyIGEgRmlyZWJhc2UgU2VydmljZS5cbiAgICAgKlxuICAgICAqIGZpcmViYXNlLklOVEVSTkFMLnJlZ2lzdGVyU2VydmljZSgpXG4gICAgICpcbiAgICAgKiBUT0RPOiBJbXBsZW1lbnQgc2VydmljZVByb3BlcnRpZXMuXG4gICAgICovXG4gICAgZnVuY3Rpb24gcmVnaXN0ZXJTZXJ2aWNlKG5hbWUsIGNyZWF0ZVNlcnZpY2UsIHNlcnZpY2VQcm9wZXJ0aWVzLCBhcHBIb29rLCBhbGxvd011bHRpcGxlSW5zdGFuY2VzKSB7XG4gICAgICAgIC8vIENhbm5vdCByZS1yZWdpc3RlciBhIHNlcnZpY2UgdGhhdCBhbHJlYWR5IGV4aXN0c1xuICAgICAgICBpZiAoZmFjdG9yaWVzW25hbWVdKSB7XG4gICAgICAgICAgICBlcnJvcignZHVwbGljYXRlLXNlcnZpY2UnLCB7IG5hbWU6IG5hbWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQ2FwdHVyZSB0aGUgc2VydmljZSBmYWN0b3J5IGZvciBsYXRlciBzZXJ2aWNlIGluc3RhbnRpYXRpb25cbiAgICAgICAgZmFjdG9yaWVzW25hbWVdID0gY3JlYXRlU2VydmljZTtcbiAgICAgICAgLy8gQ2FwdHVyZSB0aGUgYXBwSG9vaywgaWYgcGFzc2VkXG4gICAgICAgIGlmIChhcHBIb29rKSB7XG4gICAgICAgICAgICBhcHBIb29rc1tuYW1lXSA9IGFwcEhvb2s7XG4gICAgICAgICAgICAvLyBSdW4gdGhlICoqbmV3KiogYXBwIGhvb2sgb24gYWxsIGV4aXN0aW5nIGFwcHNcbiAgICAgICAgICAgIGdldEFwcHMoKS5mb3JFYWNoKGZ1bmN0aW9uIChhcHApIHtcbiAgICAgICAgICAgICAgICBhcHBIb29rKCdjcmVhdGUnLCBhcHApO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gVGhlIFNlcnZpY2UgbmFtZXNwYWNlIGlzIGFuIGFjY2Vzc29yIGZ1bmN0aW9uIC4uLlxuICAgICAgICB2YXIgc2VydmljZU5hbWVzcGFjZSA9IGZ1bmN0aW9uIChhcHBBcmcpIHtcbiAgICAgICAgICAgIGlmIChhcHBBcmcgPT09IHZvaWQgMCkgeyBhcHBBcmcgPSBhcHAoKTsgfVxuICAgICAgICAgICAgaWYgKHR5cGVvZiBhcHBBcmdbbmFtZV0gIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAvLyBJbnZhbGlkIGFyZ3VtZW50LlxuICAgICAgICAgICAgICAgIC8vIFRoaXMgaGFwcGVucyBpbiB0aGUgZm9sbG93aW5nIGNhc2U6IGZpcmViYXNlLnN0b3JhZ2UoJ2dzOi8nKVxuICAgICAgICAgICAgICAgIGVycm9yKCdpbnZhbGlkLWFwcC1hcmd1bWVudCcsIHsgbmFtZTogbmFtZSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIEZvcndhcmQgc2VydmljZSBpbnN0YW5jZSBsb29rdXAgdG8gdGhlIEZpcmViYXNlQXBwLlxuICAgICAgICAgICAgcmV0dXJuIGFwcEFyZ1tuYW1lXSgpO1xuICAgICAgICB9O1xuICAgICAgICAvLyAuLi4gYW5kIGEgY29udGFpbmVyIGZvciBzZXJ2aWNlLWxldmVsIHByb3BlcnRpZXMuXG4gICAgICAgIGlmIChzZXJ2aWNlUHJvcGVydGllcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB1dGlsXzIuZGVlcEV4dGVuZChzZXJ2aWNlTmFtZXNwYWNlLCBzZXJ2aWNlUHJvcGVydGllcyk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gTW9ua2V5LXBhdGNoIHRoZSBzZXJ2aWNlTmFtZXNwYWNlIG9udG8gdGhlIGZpcmViYXNlIG5hbWVzcGFjZVxuICAgICAgICBuYW1lc3BhY2VbbmFtZV0gPSBzZXJ2aWNlTmFtZXNwYWNlO1xuICAgICAgICAvLyBQYXRjaCB0aGUgRmlyZWJhc2VBcHBJbXBsIHByb3RvdHlwZVxuICAgICAgICBGaXJlYmFzZUFwcEltcGwucHJvdG90eXBlW25hbWVdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHNlcnZpY2VGeG4gPSB0aGlzLl9nZXRTZXJ2aWNlLmJpbmQodGhpcywgbmFtZSk7XG4gICAgICAgICAgICByZXR1cm4gc2VydmljZUZ4bi5hcHBseSh0aGlzLCBhbGxvd011bHRpcGxlSW5zdGFuY2VzID8gYXJncyA6IFtdKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHNlcnZpY2VOYW1lc3BhY2U7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBhdGNoIHRoZSB0b3AtbGV2ZWwgZmlyZWJhc2UgbmFtZXNwYWNlIHdpdGggYWRkaXRpb25hbCBwcm9wZXJ0aWVzLlxuICAgICAqXG4gICAgICogZmlyZWJhc2UuSU5URVJOQUwuZXh0ZW5kTmFtZXNwYWNlKClcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBleHRlbmROYW1lc3BhY2UocHJvcHMpIHtcbiAgICAgICAgdXRpbF8yLmRlZXBFeHRlbmQobmFtZXNwYWNlLCBwcm9wcyk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGNhbGxBcHBIb29rcyhhcHAsIGV2ZW50TmFtZSkge1xuICAgICAgICBPYmplY3Qua2V5cyhmYWN0b3JpZXMpLmZvckVhY2goZnVuY3Rpb24gKHNlcnZpY2VOYW1lKSB7XG4gICAgICAgICAgICAvLyBJZ25vcmUgdmlydHVhbCBzZXJ2aWNlc1xuICAgICAgICAgICAgdmFyIGZhY3RvcnlOYW1lID0gdXNlQXNTZXJ2aWNlKGFwcCwgc2VydmljZU5hbWUpO1xuICAgICAgICAgICAgaWYgKGZhY3RvcnlOYW1lID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFwcEhvb2tzW2ZhY3RvcnlOYW1lXSkge1xuICAgICAgICAgICAgICAgIGFwcEhvb2tzW2ZhY3RvcnlOYW1lXShldmVudE5hbWUsIGFwcCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvLyBNYXAgdGhlIHJlcXVlc3RlZCBzZXJ2aWNlIHRvIGEgcmVnaXN0ZXJlZCBzZXJ2aWNlIG5hbWVcbiAgICAvLyAodXNlZCB0byBtYXAgYXV0aCB0byBzZXJ2ZXJBdXRoIHNlcnZpY2Ugd2hlbiBuZWVkZWQpLlxuICAgIGZ1bmN0aW9uIHVzZUFzU2VydmljZShhcHAsIG5hbWUpIHtcbiAgICAgICAgaWYgKG5hbWUgPT09ICdzZXJ2ZXJBdXRoJykge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHVzZVNlcnZpY2UgPSBuYW1lO1xuICAgICAgICB2YXIgb3B0aW9ucyA9IGFwcC5vcHRpb25zO1xuICAgICAgICByZXR1cm4gdXNlU2VydmljZTtcbiAgICB9XG4gICAgcmV0dXJuIG5hbWVzcGFjZTtcbn1cbmV4cG9ydHMuY3JlYXRlRmlyZWJhc2VOYW1lc3BhY2UgPSBjcmVhdGVGaXJlYmFzZU5hbWVzcGFjZTtcbmZ1bmN0aW9uIGVycm9yKGNvZGUsIGFyZ3MpIHtcbiAgICB0aHJvdyBhcHBFcnJvcnMuY3JlYXRlKGNvZGUsIGFyZ3MpO1xufVxuLy8gVHlwZVNjcmlwdCBkb2VzIG5vdCBzdXBwb3J0IG5vbi1zdHJpbmcgaW5kZXhlcyFcbi8vIGxldCBlcnJvcnM6IHtbY29kZTogQXBwRXJyb3I6IHN0cmluZ30gPSB7XG52YXIgZXJyb3JzID0ge1xuICAgICduby1hcHAnOiBcIk5vIEZpcmViYXNlIEFwcCAneyRuYW1lfScgaGFzIGJlZW4gY3JlYXRlZCAtIFwiICtcbiAgICAgICAgJ2NhbGwgRmlyZWJhc2UgQXBwLmluaXRpYWxpemVBcHAoKScsXG4gICAgJ2JhZC1hcHAtbmFtZSc6IFwiSWxsZWdhbCBBcHAgbmFtZTogJ3skbmFtZX1cIixcbiAgICAnZHVwbGljYXRlLWFwcCc6IFwiRmlyZWJhc2UgQXBwIG5hbWVkICd7JG5hbWV9JyBhbHJlYWR5IGV4aXN0c1wiLFxuICAgICdhcHAtZGVsZXRlZCc6IFwiRmlyZWJhc2UgQXBwIG5hbWVkICd7JG5hbWV9JyBhbHJlYWR5IGRlbGV0ZWRcIixcbiAgICAnZHVwbGljYXRlLXNlcnZpY2UnOiBcIkZpcmViYXNlIHNlcnZpY2UgbmFtZWQgJ3skbmFtZX0nIGFscmVhZHkgcmVnaXN0ZXJlZFwiLFxuICAgICdzYS1ub3Qtc3VwcG9ydGVkJzogJ0luaXRpYWxpemluZyB0aGUgRmlyZWJhc2UgU0RLIHdpdGggYSBzZXJ2aWNlICcgK1xuICAgICAgICAnYWNjb3VudCBpcyBvbmx5IGFsbG93ZWQgaW4gYSBOb2RlLmpzIGVudmlyb25tZW50LiBPbiBjbGllbnQgJyArXG4gICAgICAgICdkZXZpY2VzLCB5b3Ugc2hvdWxkIGluc3RlYWQgaW5pdGlhbGl6ZSB0aGUgU0RLIHdpdGggYW4gYXBpIGtleSBhbmQgJyArXG4gICAgICAgICdhdXRoIGRvbWFpbicsXG4gICAgJ2ludmFsaWQtYXBwLWFyZ3VtZW50JzogJ2ZpcmViYXNlLnskbmFtZX0oKSB0YWtlcyBlaXRoZXIgbm8gYXJndW1lbnQgb3IgYSAnICtcbiAgICAgICAgJ0ZpcmViYXNlIEFwcCBpbnN0YW5jZS4nXG59O1xudmFyIGFwcEVycm9ycyA9IG5ldyB1dGlsXzIuRXJyb3JGYWN0b3J5KCdhcHAnLCAnRmlyZWJhc2UnLCBlcnJvcnMpO1xuXG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWZpcmViYXNlQXBwLmpzLm1hcFxuIiwidmFyIGZpcmViYXNlID0gcmVxdWlyZSgnQGZpcmViYXNlL2FwcCcpLmRlZmF1bHQ7IChmdW5jdGlvbigpey8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbihmdW5jdGlvbigpe3ZhciBoLGFhPWFhfHx7fSxrPXRoaXMsYmE9ZnVuY3Rpb24oYSl7cmV0dXJuIHZvaWQgMCE9PWF9LG09ZnVuY3Rpb24oYSl7cmV0dXJuXCJzdHJpbmdcIj09dHlwZW9mIGF9LGNhPWZ1bmN0aW9uKGEpe3JldHVyblwiYm9vbGVhblwiPT10eXBlb2YgYX0sZGE9ZnVuY3Rpb24oKXt9LGVhPWZ1bmN0aW9uKGEpe3ZhciBiPXR5cGVvZiBhO2lmKFwib2JqZWN0XCI9PWIpaWYoYSl7aWYoYSBpbnN0YW5jZW9mIEFycmF5KXJldHVyblwiYXJyYXlcIjtpZihhIGluc3RhbmNlb2YgT2JqZWN0KXJldHVybiBiO3ZhciBjPU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChhKTtpZihcIltvYmplY3QgV2luZG93XVwiPT1jKXJldHVyblwib2JqZWN0XCI7aWYoXCJbb2JqZWN0IEFycmF5XVwiPT1jfHxcIm51bWJlclwiPT10eXBlb2YgYS5sZW5ndGgmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBhLnNwbGljZSYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGEucHJvcGVydHlJc0VudW1lcmFibGUmJiFhLnByb3BlcnR5SXNFbnVtZXJhYmxlKFwic3BsaWNlXCIpKXJldHVyblwiYXJyYXlcIjtcbmlmKFwiW29iamVjdCBGdW5jdGlvbl1cIj09Y3x8XCJ1bmRlZmluZWRcIiE9dHlwZW9mIGEuY2FsbCYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGEucHJvcGVydHlJc0VudW1lcmFibGUmJiFhLnByb3BlcnR5SXNFbnVtZXJhYmxlKFwiY2FsbFwiKSlyZXR1cm5cImZ1bmN0aW9uXCJ9ZWxzZSByZXR1cm5cIm51bGxcIjtlbHNlIGlmKFwiZnVuY3Rpb25cIj09YiYmXCJ1bmRlZmluZWRcIj09dHlwZW9mIGEuY2FsbClyZXR1cm5cIm9iamVjdFwiO3JldHVybiBifSxmYT1mdW5jdGlvbihhKXtyZXR1cm4gbnVsbD09PWF9LGhhPWZ1bmN0aW9uKGEpe3JldHVyblwiYXJyYXlcIj09ZWEoYSl9LGlhPWZ1bmN0aW9uKGEpe3ZhciBiPWVhKGEpO3JldHVyblwiYXJyYXlcIj09Ynx8XCJvYmplY3RcIj09YiYmXCJudW1iZXJcIj09dHlwZW9mIGEubGVuZ3RofSxwPWZ1bmN0aW9uKGEpe3JldHVyblwiZnVuY3Rpb25cIj09ZWEoYSl9LHE9ZnVuY3Rpb24oYSl7dmFyIGI9dHlwZW9mIGE7cmV0dXJuXCJvYmplY3RcIj09YiYmbnVsbCE9YXx8XCJmdW5jdGlvblwiPT1cbmJ9LGphPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gYS5jYWxsLmFwcGx5KGEuYmluZCxhcmd1bWVudHMpfSxrYT1mdW5jdGlvbihhLGIsYyl7aWYoIWEpdGhyb3cgRXJyb3IoKTtpZigyPGFyZ3VtZW50cy5sZW5ndGgpe3ZhciBkPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKTtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgYz1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpO0FycmF5LnByb3RvdHlwZS51bnNoaWZ0LmFwcGx5KGMsZCk7cmV0dXJuIGEuYXBwbHkoYixjKX19cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGEuYXBwbHkoYixhcmd1bWVudHMpfX0scj1mdW5jdGlvbihhLGIsYyl7cj1GdW5jdGlvbi5wcm90b3R5cGUuYmluZCYmLTEhPUZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kLnRvU3RyaW5nKCkuaW5kZXhPZihcIm5hdGl2ZSBjb2RlXCIpP2phOmthO3JldHVybiByLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sbGE9ZnVuY3Rpb24oYSxiKXt2YXIgYz1cbkFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKTtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgYj1jLnNsaWNlKCk7Yi5wdXNoLmFwcGx5KGIsYXJndW1lbnRzKTtyZXR1cm4gYS5hcHBseSh0aGlzLGIpfX0sbWE9RGF0ZS5ub3d8fGZ1bmN0aW9uKCl7cmV0dXJuK25ldyBEYXRlfSx0PWZ1bmN0aW9uKGEsYil7ZnVuY3Rpb24gYygpe31jLnByb3RvdHlwZT1iLnByb3RvdHlwZTthLlVjPWIucHJvdG90eXBlO2EucHJvdG90eXBlPW5ldyBjO2EucHJvdG90eXBlLmNvbnN0cnVjdG9yPWE7YS5PZz1mdW5jdGlvbihhLGMsZil7Zm9yKHZhciBkPUFycmF5KGFyZ3VtZW50cy5sZW5ndGgtMiksZT0yO2U8YXJndW1lbnRzLmxlbmd0aDtlKyspZFtlLTJdPWFyZ3VtZW50c1tlXTtyZXR1cm4gYi5wcm90b3R5cGVbY10uYXBwbHkoYSxkKX19O3ZhciB1PWZ1bmN0aW9uKGEpe2lmKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKUVycm9yLmNhcHR1cmVTdGFja1RyYWNlKHRoaXMsdSk7ZWxzZXt2YXIgYj1FcnJvcigpLnN0YWNrO2ImJih0aGlzLnN0YWNrPWIpfWEmJih0aGlzLm1lc3NhZ2U9U3RyaW5nKGEpKX07dCh1LEVycm9yKTt1LnByb3RvdHlwZS5uYW1lPVwiQ3VzdG9tRXJyb3JcIjt2YXIgbmE9ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9YS5zcGxpdChcIiVzXCIpLGQ9XCJcIixlPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKTtlLmxlbmd0aCYmMTxjLmxlbmd0aDspZCs9Yy5zaGlmdCgpK2Uuc2hpZnQoKTtyZXR1cm4gZCtjLmpvaW4oXCIlc1wiKX0sb2E9U3RyaW5nLnByb3RvdHlwZS50cmltP2Z1bmN0aW9uKGEpe3JldHVybiBhLnRyaW0oKX06ZnVuY3Rpb24oYSl7cmV0dXJuIGEucmVwbGFjZSgvXltcXHNcXHhhMF0rfFtcXHNcXHhhMF0rJC9nLFwiXCIpfSx3YT1mdW5jdGlvbihhKXtpZighcGEudGVzdChhKSlyZXR1cm4gYTstMSE9YS5pbmRleE9mKFwiJlwiKSYmKGE9YS5yZXBsYWNlKHFhLFwiJmFtcDtcIikpOy0xIT1hLmluZGV4T2YoXCI8XCIpJiYoYT1hLnJlcGxhY2UocmEsXCImbHQ7XCIpKTstMSE9YS5pbmRleE9mKFwiPlwiKSYmKGE9YS5yZXBsYWNlKHNhLFwiJmd0O1wiKSk7LTEhPWEuaW5kZXhPZignXCInKSYmKGE9YS5yZXBsYWNlKHRhLFwiJnF1b3Q7XCIpKTstMSE9YS5pbmRleE9mKFwiJ1wiKSYmXG4oYT1hLnJlcGxhY2UodWEsXCImIzM5O1wiKSk7LTEhPWEuaW5kZXhPZihcIlxceDAwXCIpJiYoYT1hLnJlcGxhY2UodmEsXCImIzA7XCIpKTtyZXR1cm4gYX0scWE9LyYvZyxyYT0vPC9nLHNhPS8+L2csdGE9L1wiL2csdWE9LycvZyx2YT0vXFx4MDAvZyxwYT0vW1xceDAwJjw+XCInXS8sdj1mdW5jdGlvbihhLGIpe3JldHVybi0xIT1hLmluZGV4T2YoYil9LHhhPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGE8Yj8tMTphPmI/MTowfTt2YXIgeWE9ZnVuY3Rpb24oYSxiKXtiLnVuc2hpZnQoYSk7dS5jYWxsKHRoaXMsbmEuYXBwbHkobnVsbCxiKSk7Yi5zaGlmdCgpfTt0KHlhLHUpO3lhLnByb3RvdHlwZS5uYW1lPVwiQXNzZXJ0aW9uRXJyb3JcIjtcbnZhciB6YT1mdW5jdGlvbihhLGIsYyxkKXt2YXIgZT1cIkFzc2VydGlvbiBmYWlsZWRcIjtpZihjKXtlKz1cIjogXCIrYzt2YXIgZj1kfWVsc2UgYSYmKGUrPVwiOiBcIithLGY9Yik7dGhyb3cgbmV3IHlhKFwiXCIrZSxmfHxbXSk7fSx3PWZ1bmN0aW9uKGEsYixjKXthfHx6YShcIlwiLG51bGwsYixBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMikpO3JldHVybiBhfSxBYT1mdW5jdGlvbihhLGIpe3Rocm93IG5ldyB5YShcIkZhaWx1cmVcIisoYT9cIjogXCIrYTpcIlwiKSxBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpO30sQmE9ZnVuY3Rpb24oYSxiLGMpe1wibnVtYmVyXCI9PXR5cGVvZiBhfHx6YShcIkV4cGVjdGVkIG51bWJlciBidXQgZ290ICVzOiAlcy5cIixbZWEoYSksYV0sYixBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMikpO3JldHVybiBhfSxDYT1mdW5jdGlvbihhLGIsYyl7bShhKXx8emEoXCJFeHBlY3RlZCBzdHJpbmcgYnV0IGdvdCAlczogJXMuXCIsXG5bZWEoYSksYV0sYixBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMikpfSxEYT1mdW5jdGlvbihhLGIsYyl7cChhKXx8emEoXCJFeHBlY3RlZCBmdW5jdGlvbiBidXQgZ290ICVzOiAlcy5cIixbZWEoYSksYV0sYixBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMikpfTt2YXIgRmE9ZnVuY3Rpb24oKXt0aGlzLlRjPVwiXCI7dGhpcy5rZj1FYX07RmEucHJvdG90eXBlLnFiPSEwO0ZhLnByb3RvdHlwZS5vYj1mdW5jdGlvbigpe3JldHVybiB0aGlzLlRjfTtGYS5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm5cIkNvbnN0e1wiK3RoaXMuVGMrXCJ9XCJ9O3ZhciBHYT1mdW5jdGlvbihhKXtpZihhIGluc3RhbmNlb2YgRmEmJmEuY29uc3RydWN0b3I9PT1GYSYmYS5rZj09PUVhKXJldHVybiBhLlRjO0FhKFwiZXhwZWN0ZWQgb2JqZWN0IG9mIHR5cGUgQ29uc3QsIGdvdCAnXCIrYStcIidcIik7cmV0dXJuXCJ0eXBlX2Vycm9yOkNvbnN0XCJ9LEVhPXt9LEhhPWZ1bmN0aW9uKGEpe3ZhciBiPW5ldyBGYTtiLlRjPWE7cmV0dXJuIGJ9O0hhKFwiXCIpO3ZhciBKYT1mdW5jdGlvbigpe3RoaXMuTGM9XCJcIjt0aGlzLmxmPUlhfTtKYS5wcm90b3R5cGUucWI9ITA7SmEucHJvdG90eXBlLm9iPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuTGN9O0phLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVyblwiVHJ1c3RlZFJlc291cmNlVXJse1wiK3RoaXMuTGMrXCJ9XCJ9O1xudmFyIEthPWZ1bmN0aW9uKGEpe2lmKGEgaW5zdGFuY2VvZiBKYSYmYS5jb25zdHJ1Y3Rvcj09PUphJiZhLmxmPT09SWEpcmV0dXJuIGEuTGM7QWEoXCJleHBlY3RlZCBvYmplY3Qgb2YgdHlwZSBUcnVzdGVkUmVzb3VyY2VVcmwsIGdvdCAnXCIrYStcIicgb2YgdHlwZSBcIitlYShhKSk7cmV0dXJuXCJ0eXBlX2Vycm9yOlRydXN0ZWRSZXNvdXJjZVVybFwifSxPYT1mdW5jdGlvbihhLGIpe3ZhciBjPUdhKGEpO2lmKCFMYS50ZXN0KGMpKXRocm93IEVycm9yKFwiSW52YWxpZCBUcnVzdGVkUmVzb3VyY2VVcmwgZm9ybWF0OiBcIitjKTthPWMucmVwbGFjZShNYSxmdW5jdGlvbihhLGUpe2lmKCFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYixlKSl0aHJvdyBFcnJvcignRm91bmQgbWFya2VyLCBcIicrZSsnXCIsIGluIGZvcm1hdCBzdHJpbmcsIFwiJytjKydcIiwgYnV0IG5vIHZhbGlkIGxhYmVsIG1hcHBpbmcgZm91bmQgaW4gYXJnczogJytKU09OLnN0cmluZ2lmeShiKSk7YT1iW2VdO1xucmV0dXJuIGEgaW5zdGFuY2VvZiBGYT9HYShhKTplbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKGEpKX0pO3JldHVybiBOYShhKX0sTWE9LyV7KFxcdyspfS9nLExhPS9eKD86aHR0cHM6KT9cXC9cXC9bMC05YS16LjpbXFxdLV0rXFwvfF5cXC9bXlxcL1xcXFxdfF5hYm91dDpibGFuaygjfCQpL2ksSWE9e30sTmE9ZnVuY3Rpb24oYSl7dmFyIGI9bmV3IEphO2IuTGM9YTtyZXR1cm4gYn07dmFyIFBhPUFycmF5LnByb3RvdHlwZS5pbmRleE9mP2Z1bmN0aW9uKGEsYixjKXt3KG51bGwhPWEubGVuZ3RoKTtyZXR1cm4gQXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbChhLGIsYyl9OmZ1bmN0aW9uKGEsYixjKXtjPW51bGw9PWM/MDowPmM/TWF0aC5tYXgoMCxhLmxlbmd0aCtjKTpjO2lmKG0oYSkpcmV0dXJuIG0oYikmJjE9PWIubGVuZ3RoP2EuaW5kZXhPZihiLGMpOi0xO2Zvcig7YzxhLmxlbmd0aDtjKyspaWYoYyBpbiBhJiZhW2NdPT09YilyZXR1cm4gYztyZXR1cm4tMX0seD1BcnJheS5wcm90b3R5cGUuZm9yRWFjaD9mdW5jdGlvbihhLGIsYyl7dyhudWxsIT1hLmxlbmd0aCk7QXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChhLGIsYyl9OmZ1bmN0aW9uKGEsYixjKXtmb3IodmFyIGQ9YS5sZW5ndGgsZT1tKGEpP2Euc3BsaXQoXCJcIik6YSxmPTA7ZjxkO2YrKylmIGluIGUmJmIuY2FsbChjLGVbZl0sZixhKX0sUWE9ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9bShhKT9cbmEuc3BsaXQoXCJcIik6YSxkPWEubGVuZ3RoLTE7MDw9ZDstLWQpZCBpbiBjJiZiLmNhbGwodm9pZCAwLGNbZF0sZCxhKX0sUmE9QXJyYXkucHJvdG90eXBlLm1hcD9mdW5jdGlvbihhLGIsYyl7dyhudWxsIT1hLmxlbmd0aCk7cmV0dXJuIEFycmF5LnByb3RvdHlwZS5tYXAuY2FsbChhLGIsYyl9OmZ1bmN0aW9uKGEsYixjKXtmb3IodmFyIGQ9YS5sZW5ndGgsZT1BcnJheShkKSxmPW0oYSk/YS5zcGxpdChcIlwiKTphLGc9MDtnPGQ7ZysrKWcgaW4gZiYmKGVbZ109Yi5jYWxsKGMsZltnXSxnLGEpKTtyZXR1cm4gZX0sU2E9QXJyYXkucHJvdG90eXBlLnNvbWU/ZnVuY3Rpb24oYSxiLGMpe3cobnVsbCE9YS5sZW5ndGgpO3JldHVybiBBcnJheS5wcm90b3R5cGUuc29tZS5jYWxsKGEsYixjKX06ZnVuY3Rpb24oYSxiLGMpe2Zvcih2YXIgZD1hLmxlbmd0aCxlPW0oYSk/YS5zcGxpdChcIlwiKTphLGY9MDtmPGQ7ZisrKWlmKGYgaW4gZSYmYi5jYWxsKGMsZVtmXSxmLGEpKXJldHVybiEwO3JldHVybiExfSxcblVhPWZ1bmN0aW9uKGEpe2E6e3ZhciBiPVRhO2Zvcih2YXIgYz1hLmxlbmd0aCxkPW0oYSk/YS5zcGxpdChcIlwiKTphLGU9MDtlPGM7ZSsrKWlmKGUgaW4gZCYmYi5jYWxsKHZvaWQgMCxkW2VdLGUsYSkpe2I9ZTticmVhayBhfWI9LTF9cmV0dXJuIDA+Yj9udWxsOm0oYSk/YS5jaGFyQXQoYik6YVtiXX0sVmE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gMDw9UGEoYSxiKX0sWGE9ZnVuY3Rpb24oYSxiKXtiPVBhKGEsYik7dmFyIGM7KGM9MDw9YikmJldhKGEsYik7cmV0dXJuIGN9LFdhPWZ1bmN0aW9uKGEsYil7dyhudWxsIT1hLmxlbmd0aCk7cmV0dXJuIDE9PUFycmF5LnByb3RvdHlwZS5zcGxpY2UuY2FsbChhLGIsMSkubGVuZ3RofSxZYT1mdW5jdGlvbihhLGIpe3ZhciBjPTA7UWEoYSxmdW5jdGlvbihkLGUpe2IuY2FsbCh2b2lkIDAsZCxlLGEpJiZXYShhLGUpJiZjKyt9KX0sWmE9ZnVuY3Rpb24oYSl7cmV0dXJuIEFycmF5LnByb3RvdHlwZS5jb25jYXQuYXBwbHkoW10sYXJndW1lbnRzKX0sXG4kYT1mdW5jdGlvbihhKXt2YXIgYj1hLmxlbmd0aDtpZigwPGIpe2Zvcih2YXIgYz1BcnJheShiKSxkPTA7ZDxiO2QrKyljW2RdPWFbZF07cmV0dXJuIGN9cmV0dXJuW119O3ZhciBhYj1mdW5jdGlvbihhKXtyZXR1cm4gUmEoYSxmdW5jdGlvbihhKXthPWEudG9TdHJpbmcoMTYpO3JldHVybiAxPGEubGVuZ3RoP2E6XCIwXCIrYX0pLmpvaW4oXCJcIil9O3ZhciBiYjthOnt2YXIgY2I9ay5uYXZpZ2F0b3I7aWYoY2Ipe3ZhciBkYj1jYi51c2VyQWdlbnQ7aWYoZGIpe2JiPWRiO2JyZWFrIGF9fWJiPVwiXCJ9dmFyIHk9ZnVuY3Rpb24oYSl7cmV0dXJuIHYoYmIsYSl9O3ZhciBlYj1mdW5jdGlvbihhLGIpe2Zvcih2YXIgYyBpbiBhKWIuY2FsbCh2b2lkIDAsYVtjXSxjLGEpfSxmYj1mdW5jdGlvbihhLGIpe2Zvcih2YXIgYyBpbiBhKWlmKGIuY2FsbCh2b2lkIDAsYVtjXSxjLGEpKXJldHVybiEwO3JldHVybiExfSxnYj1mdW5jdGlvbihhKXt2YXIgYj1bXSxjPTAsZDtmb3IoZCBpbiBhKWJbYysrXT1hW2RdO3JldHVybiBifSxoYj1mdW5jdGlvbihhKXt2YXIgYj1bXSxjPTAsZDtmb3IoZCBpbiBhKWJbYysrXT1kO3JldHVybiBifSxpYj1mdW5jdGlvbihhKXtmb3IodmFyIGIgaW4gYSlyZXR1cm4hMTtyZXR1cm4hMH0samI9ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGMgaW4gYSlpZighKGMgaW4gYil8fGFbY10hPT1iW2NdKXJldHVybiExO2ZvcihjIGluIGIpaWYoIShjIGluIGEpKXJldHVybiExO3JldHVybiEwfSxrYj1mdW5jdGlvbihhKXt2YXIgYj17fSxjO2ZvcihjIGluIGEpYltjXT1hW2NdO3JldHVybiBifSxsYj1cImNvbnN0cnVjdG9yIGhhc093blByb3BlcnR5IGlzUHJvdG90eXBlT2YgcHJvcGVydHlJc0VudW1lcmFibGUgdG9Mb2NhbGVTdHJpbmcgdG9TdHJpbmcgdmFsdWVPZlwiLnNwbGl0KFwiIFwiKSxcbm1iPWZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjLGQsZT0xO2U8YXJndW1lbnRzLmxlbmd0aDtlKyspe2Q9YXJndW1lbnRzW2VdO2ZvcihjIGluIGQpYVtjXT1kW2NdO2Zvcih2YXIgZj0wO2Y8bGIubGVuZ3RoO2YrKyljPWxiW2ZdLE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChkLGMpJiYoYVtjXT1kW2NdKX19O3ZhciBuYj1mdW5jdGlvbihhKXtuYltcIiBcIl0oYSk7cmV0dXJuIGF9O25iW1wiIFwiXT1kYTt2YXIgcGI9ZnVuY3Rpb24oYSxiKXt2YXIgYz1vYjtyZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGMsYSk/Y1thXTpjW2FdPWIoYSl9O3ZhciBxYj15KFwiT3BlcmFcIiksej15KFwiVHJpZGVudFwiKXx8eShcIk1TSUVcIikscmI9eShcIkVkZ2VcIiksc2I9cmJ8fHosdGI9eShcIkdlY2tvXCIpJiYhKHYoYmIudG9Mb3dlckNhc2UoKSxcIndlYmtpdFwiKSYmIXkoXCJFZGdlXCIpKSYmISh5KFwiVHJpZGVudFwiKXx8eShcIk1TSUVcIikpJiYheShcIkVkZ2VcIiksdWI9dihiYi50b0xvd2VyQ2FzZSgpLFwid2Via2l0XCIpJiYheShcIkVkZ2VcIiksdmI9ZnVuY3Rpb24oKXt2YXIgYT1rLmRvY3VtZW50O3JldHVybiBhP2EuZG9jdW1lbnRNb2RlOnZvaWQgMH0sd2I7XG5hOnt2YXIgeGI9XCJcIix5Yj1mdW5jdGlvbigpe3ZhciBhPWJiO2lmKHRiKXJldHVybi9ydjooW15cXCk7XSspKFxcKXw7KS8uZXhlYyhhKTtpZihyYilyZXR1cm4vRWRnZVxcLyhbXFxkXFwuXSspLy5leGVjKGEpO2lmKHopcmV0dXJuL1xcYig/Ok1TSUV8cnYpWzogXShbXlxcKTtdKykoXFwpfDspLy5leGVjKGEpO2lmKHViKXJldHVybi9XZWJLaXRcXC8oXFxTKykvLmV4ZWMoYSk7aWYocWIpcmV0dXJuLyg/OlZlcnNpb24pWyBcXC9dPyhcXFMrKS8uZXhlYyhhKX0oKTt5YiYmKHhiPXliP3liWzFdOlwiXCIpO2lmKHope3ZhciBBYj12YigpO2lmKG51bGwhPUFiJiZBYj5wYXJzZUZsb2F0KHhiKSl7d2I9U3RyaW5nKEFiKTticmVhayBhfX13Yj14Yn1cbnZhciBCYj13YixvYj17fSxBPWZ1bmN0aW9uKGEpe3JldHVybiBwYihhLGZ1bmN0aW9uKCl7Zm9yKHZhciBiPTAsYz1vYShTdHJpbmcoQmIpKS5zcGxpdChcIi5cIiksZD1vYShTdHJpbmcoYSkpLnNwbGl0KFwiLlwiKSxlPU1hdGgubWF4KGMubGVuZ3RoLGQubGVuZ3RoKSxmPTA7MD09YiYmZjxlO2YrKyl7dmFyIGc9Y1tmXXx8XCJcIixsPWRbZl18fFwiXCI7ZG97Zz0vKFxcZCopKFxcRCopKC4qKS8uZXhlYyhnKXx8W1wiXCIsXCJcIixcIlwiLFwiXCJdO2w9LyhcXGQqKShcXEQqKSguKikvLmV4ZWMobCl8fFtcIlwiLFwiXCIsXCJcIixcIlwiXTtpZigwPT1nWzBdLmxlbmd0aCYmMD09bFswXS5sZW5ndGgpYnJlYWs7Yj14YSgwPT1nWzFdLmxlbmd0aD8wOnBhcnNlSW50KGdbMV0sMTApLDA9PWxbMV0ubGVuZ3RoPzA6cGFyc2VJbnQobFsxXSwxMCkpfHx4YSgwPT1nWzJdLmxlbmd0aCwwPT1sWzJdLmxlbmd0aCl8fHhhKGdbMl0sbFsyXSk7Zz1nWzNdO2w9bFszXX13aGlsZSgwPT1iKX1yZXR1cm4gMDw9Yn0pfSxDYjt2YXIgRGI9ay5kb2N1bWVudDtcbkNiPURiJiZ6P3ZiKCl8fChcIkNTUzFDb21wYXRcIj09RGIuY29tcGF0TW9kZT9wYXJzZUludChCYiwxMCk6NSk6dm9pZCAwO3ZhciBFYj1udWxsLEZiPW51bGwsSGI9ZnVuY3Rpb24oYSl7dmFyIGI9XCJcIjtHYihhLGZ1bmN0aW9uKGEpe2IrPVN0cmluZy5mcm9tQ2hhckNvZGUoYSl9KTtyZXR1cm4gYn0sR2I9ZnVuY3Rpb24oYSxiKXtmdW5jdGlvbiBjKGIpe2Zvcig7ZDxhLmxlbmd0aDspe3ZhciBjPWEuY2hhckF0KGQrKyksZT1GYltjXTtpZihudWxsIT1lKXJldHVybiBlO2lmKCEvXltcXHNcXHhhMF0qJC8udGVzdChjKSl0aHJvdyBFcnJvcihcIlVua25vd24gYmFzZTY0IGVuY29kaW5nIGF0IGNoYXI6IFwiK2MpO31yZXR1cm4gYn1JYigpO2Zvcih2YXIgZD0wOzspe3ZhciBlPWMoLTEpLGY9YygwKSxnPWMoNjQpLGw9Yyg2NCk7aWYoNjQ9PT1sJiYtMT09PWUpYnJlYWs7YihlPDwyfGY+PjQpOzY0IT1nJiYoYihmPDw0JjI0MHxnPj4yKSw2NCE9bCYmYihnPDw2JjE5MnxsKSl9fSxJYj1mdW5jdGlvbigpe2lmKCFFYil7RWI9e307RmI9e307Zm9yKHZhciBhPTA7NjU+YTthKyspRWJbYV09XCJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvPVwiLmNoYXJBdChhKSxcbkZiW0ViW2FdXT1hLDYyPD1hJiYoRmJbXCJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OS1fLlwiLmNoYXJBdChhKV09YSl9fTt2YXIgSmI9ZnVuY3Rpb24oKXt0aGlzLkRhPS0xfTt2YXIgTWI9ZnVuY3Rpb24oYSxiKXt0aGlzLkRhPS0xO3RoaXMuRGE9NjQ7dGhpcy5xYz1rLlVpbnQ4QXJyYXk/bmV3IFVpbnQ4QXJyYXkodGhpcy5EYSk6QXJyYXkodGhpcy5EYSk7dGhpcy5YYz10aGlzLnJiPTA7dGhpcy5sPVtdO3RoaXMuYmc9YTt0aGlzLkZlPWI7dGhpcy5DZz1rLkludDMyQXJyYXk/bmV3IEludDMyQXJyYXkoNjQpOkFycmF5KDY0KTtiYShLYil8fChLYj1rLkludDMyQXJyYXk/bmV3IEludDMyQXJyYXkoTGIpOkxiKTt0aGlzLnJlc2V0KCl9LEtiO3QoTWIsSmIpO2Zvcih2YXIgTmI9W10sT2I9MDs2Mz5PYjtPYisrKU5iW09iXT0wO3ZhciBQYj1aYSgxMjgsTmIpO01iLnByb3RvdHlwZS5yZXNldD1mdW5jdGlvbigpe3RoaXMuWGM9dGhpcy5yYj0wO3RoaXMubD1rLkludDMyQXJyYXk/bmV3IEludDMyQXJyYXkodGhpcy5GZSk6JGEodGhpcy5GZSl9O1xudmFyIFFiPWZ1bmN0aW9uKGEpe3ZhciBiPWEucWM7dyhiLmxlbmd0aD09YS5EYSk7Zm9yKHZhciBjPWEuQ2csZD0wLGU9MDtlPGIubGVuZ3RoOyljW2QrK109YltlXTw8MjR8YltlKzFdPDwxNnxiW2UrMl08PDh8YltlKzNdLGU9NCpkO2ZvcihiPTE2OzY0PmI7YisrKXtlPWNbYi0xNV18MDtkPWNbYi0yXXwwO3ZhciBmPShjW2ItMTZdfDApKygoZT4+Pjd8ZTw8MjUpXihlPj4+MTh8ZTw8MTQpXmU+Pj4zKXwwLGc9KGNbYi03XXwwKSsoKGQ+Pj4xN3xkPDwxNSleKGQ+Pj4xOXxkPDwxMyleZD4+PjEwKXwwO2NbYl09ZitnfDB9ZD1hLmxbMF18MDtlPWEubFsxXXwwO3ZhciBsPWEubFsyXXwwLG49YS5sWzNdfDAsRj1hLmxbNF18MCx6Yj1hLmxbNV18MCxpYz1hLmxbNl18MDtmPWEubFs3XXwwO2ZvcihiPTA7NjQ+YjtiKyspe3ZhciB5aT0oKGQ+Pj4yfGQ8PDMwKV4oZD4+PjEzfGQ8PDE5KV4oZD4+PjIyfGQ8PDEwKSkrKGQmZV5kJmxeZSZsKXwwO2c9RiZ6Yl5+RiZpYztmPWYrKChGPj4+XG42fEY8PDI2KV4oRj4+PjExfEY8PDIxKV4oRj4+PjI1fEY8PDcpKXwwO2c9ZysoS2JbYl18MCl8MDtnPWYrKGcrKGNbYl18MCl8MCl8MDtmPWljO2ljPXpiO3piPUY7Rj1uK2d8MDtuPWw7bD1lO2U9ZDtkPWcreWl8MH1hLmxbMF09YS5sWzBdK2R8MDthLmxbMV09YS5sWzFdK2V8MDthLmxbMl09YS5sWzJdK2x8MDthLmxbM109YS5sWzNdK258MDthLmxbNF09YS5sWzRdK0Z8MDthLmxbNV09YS5sWzVdK3pifDA7YS5sWzZdPWEubFs2XStpY3wwO2EubFs3XT1hLmxbN10rZnwwfTtcbk1iLnByb3RvdHlwZS51cGRhdGU9ZnVuY3Rpb24oYSxiKXtiYShiKXx8KGI9YS5sZW5ndGgpO3ZhciBjPTAsZD10aGlzLnJiO2lmKG0oYSkpZm9yKDtjPGI7KXRoaXMucWNbZCsrXT1hLmNoYXJDb2RlQXQoYysrKSxkPT10aGlzLkRhJiYoUWIodGhpcyksZD0wKTtlbHNlIGlmKGlhKGEpKWZvcig7YzxiOyl7dmFyIGU9YVtjKytdO2lmKCEoXCJudW1iZXJcIj09dHlwZW9mIGUmJjA8PWUmJjI1NT49ZSYmZT09KGV8MCkpKXRocm93IEVycm9yKFwibWVzc2FnZSBtdXN0IGJlIGEgYnl0ZSBhcnJheVwiKTt0aGlzLnFjW2QrK109ZTtkPT10aGlzLkRhJiYoUWIodGhpcyksZD0wKX1lbHNlIHRocm93IEVycm9yKFwibWVzc2FnZSBtdXN0IGJlIHN0cmluZyBvciBhcnJheVwiKTt0aGlzLnJiPWQ7dGhpcy5YYys9Yn07XG5NYi5wcm90b3R5cGUuZGlnZXN0PWZ1bmN0aW9uKCl7dmFyIGE9W10sYj04KnRoaXMuWGM7NTY+dGhpcy5yYj90aGlzLnVwZGF0ZShQYiw1Ni10aGlzLnJiKTp0aGlzLnVwZGF0ZShQYix0aGlzLkRhLSh0aGlzLnJiLTU2KSk7Zm9yKHZhciBjPTYzOzU2PD1jO2MtLSl0aGlzLnFjW2NdPWImMjU1LGIvPTI1NjtRYih0aGlzKTtmb3IoYz1iPTA7Yzx0aGlzLmJnO2MrKylmb3IodmFyIGQ9MjQ7MDw9ZDtkLT04KWFbYisrXT10aGlzLmxbY10+PmQmMjU1O3JldHVybiBhfTtcbnZhciBMYj1bMTExNjM1MjQwOCwxODk5NDQ3NDQxLDMwNDkzMjM0NzEsMzkyMTAwOTU3Myw5NjE5ODcxNjMsMTUwODk3MDk5MywyNDUzNjM1NzQ4LDI4NzA3NjMyMjEsMzYyNDM4MTA4MCwzMTA1OTg0MDEsNjA3MjI1Mjc4LDE0MjY4ODE5ODcsMTkyNTA3ODM4OCwyMTYyMDc4MjA2LDI2MTQ4ODgxMDMsMzI0ODIyMjU4MCwzODM1MzkwNDAxLDQwMjIyMjQ3NzQsMjY0MzQ3MDc4LDYwNDgwNzYyOCw3NzAyNTU5ODMsMTI0OTE1MDEyMiwxNTU1MDgxNjkyLDE5OTYwNjQ5ODYsMjU1NDIyMDg4MiwyODIxODM0MzQ5LDI5NTI5OTY4MDgsMzIxMDMxMzY3MSwzMzM2NTcxODkxLDM1ODQ1Mjg3MTEsMTEzOTI2OTkzLDMzODI0MTg5NSw2NjYzMDcyMDUsNzczNTI5OTEyLDEyOTQ3NTczNzIsMTM5NjE4MjI5MSwxNjk1MTgzNzAwLDE5ODY2NjEwNTEsMjE3NzAyNjM1MCwyNDU2OTU2MDM3LDI3MzA0ODU5MjEsMjgyMDMwMjQxMSwzMjU5NzMwODAwLDMzNDU3NjQ3NzEsMzUxNjA2NTgxNywzNjAwMzUyODA0LFxuNDA5NDU3MTkwOSwyNzU0MjMzNDQsNDMwMjI3NzM0LDUwNjk0ODYxNiw2NTkwNjA1NTYsODgzOTk3ODc3LDk1ODEzOTU3MSwxMzIyODIyMjE4LDE1MzcwMDIwNjMsMTc0Nzg3Mzc3OSwxOTU1NTYyMjIyLDIwMjQxMDQ4MTUsMjIyNzczMDQ1MiwyMzYxODUyNDI0LDI0Mjg0MzY0NzQsMjc1NjczNDE4NywzMjA0MDMxNDc5LDMzMjkzMjUyOThdO3ZhciBTYj1mdW5jdGlvbigpe01iLmNhbGwodGhpcyw4LFJiKX07dChTYixNYik7dmFyIFJiPVsxNzc5MDMzNzAzLDMxNDQxMzQyNzcsMTAxMzkwNDI0MiwyNzczNDgwNzYyLDEzNTk4OTMxMTksMjYwMDgyMjkyNCw1Mjg3MzQ2MzUsMTU0MTQ1OTIyNV07dmFyIFRiPU9iamVjdC5mcmVlemV8fGZ1bmN0aW9uKGEpe3JldHVybiBhfTt2YXIgVWI9ZnVuY3Rpb24oKXt0aGlzLk1hPXRoaXMuTWE7dGhpcy5JYz10aGlzLkljfTtVYi5wcm90b3R5cGUuTWE9ITE7VWIucHJvdG90eXBlLmlzRGlzcG9zZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5NYX07VWIucHJvdG90eXBlLmxiPWZ1bmN0aW9uKCl7aWYodGhpcy5JYylmb3IoO3RoaXMuSWMubGVuZ3RoOyl0aGlzLkljLnNoaWZ0KCkoKX07dmFyIFZiPSF6fHw5PD1OdW1iZXIoQ2IpLFdiPXomJiFBKFwiOVwiKTshdWJ8fEEoXCI1MjhcIik7dGImJkEoXCIxLjliXCIpfHx6JiZBKFwiOFwiKXx8cWImJkEoXCI5LjVcIil8fHViJiZBKFwiNTI4XCIpO3RiJiYhQShcIjhcIil8fHomJkEoXCI5XCIpO3ZhciBYYj1mdW5jdGlvbigpe2lmKCFrLmFkZEV2ZW50TGlzdGVuZXJ8fCFPYmplY3QuZGVmaW5lUHJvcGVydHkpcmV0dXJuITE7dmFyIGE9ITEsYj1PYmplY3QuZGVmaW5lUHJvcGVydHkoe30sXCJwYXNzaXZlXCIse2dldDpmdW5jdGlvbigpe2E9ITB9fSk7ay5hZGRFdmVudExpc3RlbmVyKFwidGVzdFwiLGRhLGIpO2sucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInRlc3RcIixkYSxiKTtyZXR1cm4gYX0oKTt2YXIgQj1mdW5jdGlvbihhLGIpe3RoaXMudHlwZT1hO3RoaXMuY3VycmVudFRhcmdldD10aGlzLnRhcmdldD1iO3RoaXMuZGVmYXVsdFByZXZlbnRlZD10aGlzLldhPSExO3RoaXMuVWU9ITB9O0IucHJvdG90eXBlLnN0b3BQcm9wYWdhdGlvbj1mdW5jdGlvbigpe3RoaXMuV2E9ITB9O0IucHJvdG90eXBlLnByZXZlbnREZWZhdWx0PWZ1bmN0aW9uKCl7dGhpcy5kZWZhdWx0UHJldmVudGVkPSEwO3RoaXMuVWU9ITF9O3ZhciBZYj1mdW5jdGlvbihhLGIpe0IuY2FsbCh0aGlzLGE/YS50eXBlOlwiXCIpO3RoaXMucmVsYXRlZFRhcmdldD10aGlzLmN1cnJlbnRUYXJnZXQ9dGhpcy50YXJnZXQ9bnVsbDt0aGlzLmJ1dHRvbj10aGlzLnNjcmVlblk9dGhpcy5zY3JlZW5YPXRoaXMuY2xpZW50WT10aGlzLmNsaWVudFg9dGhpcy5vZmZzZXRZPXRoaXMub2Zmc2V0WD0wO3RoaXMua2V5PVwiXCI7dGhpcy5jaGFyQ29kZT10aGlzLmtleUNvZGU9MDt0aGlzLm1ldGFLZXk9dGhpcy5zaGlmdEtleT10aGlzLmFsdEtleT10aGlzLmN0cmxLZXk9ITE7dGhpcy5zdGF0ZT1udWxsO3RoaXMucG9pbnRlcklkPTA7dGhpcy5wb2ludGVyVHlwZT1cIlwiO3RoaXMuUj1udWxsO2EmJnRoaXMuaW5pdChhLGIpfTt0KFliLEIpO3ZhciBaYj1UYih7MjpcInRvdWNoXCIsMzpcInBlblwiLDQ6XCJtb3VzZVwifSk7XG5ZYi5wcm90b3R5cGUuaW5pdD1mdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMudHlwZT1hLnR5cGUsZD1hLmNoYW5nZWRUb3VjaGVzP2EuY2hhbmdlZFRvdWNoZXNbMF06bnVsbDt0aGlzLnRhcmdldD1hLnRhcmdldHx8YS5zcmNFbGVtZW50O3RoaXMuY3VycmVudFRhcmdldD1iO2lmKGI9YS5yZWxhdGVkVGFyZ2V0KXtpZih0Yil7YTp7dHJ5e25iKGIubm9kZU5hbWUpO3ZhciBlPSEwO2JyZWFrIGF9Y2F0Y2goZil7fWU9ITF9ZXx8KGI9bnVsbCl9fWVsc2VcIm1vdXNlb3ZlclwiPT1jP2I9YS5mcm9tRWxlbWVudDpcIm1vdXNlb3V0XCI9PWMmJihiPWEudG9FbGVtZW50KTt0aGlzLnJlbGF0ZWRUYXJnZXQ9YjtudWxsPT09ZD8odGhpcy5vZmZzZXRYPXVifHx2b2lkIDAhPT1hLm9mZnNldFg/YS5vZmZzZXRYOmEubGF5ZXJYLHRoaXMub2Zmc2V0WT11Ynx8dm9pZCAwIT09YS5vZmZzZXRZP2Eub2Zmc2V0WTphLmxheWVyWSx0aGlzLmNsaWVudFg9dm9pZCAwIT09YS5jbGllbnRYP2EuY2xpZW50WDphLnBhZ2VYLFxudGhpcy5jbGllbnRZPXZvaWQgMCE9PWEuY2xpZW50WT9hLmNsaWVudFk6YS5wYWdlWSx0aGlzLnNjcmVlblg9YS5zY3JlZW5YfHwwLHRoaXMuc2NyZWVuWT1hLnNjcmVlbll8fDApOih0aGlzLmNsaWVudFg9dm9pZCAwIT09ZC5jbGllbnRYP2QuY2xpZW50WDpkLnBhZ2VYLHRoaXMuY2xpZW50WT12b2lkIDAhPT1kLmNsaWVudFk/ZC5jbGllbnRZOmQucGFnZVksdGhpcy5zY3JlZW5YPWQuc2NyZWVuWHx8MCx0aGlzLnNjcmVlblk9ZC5zY3JlZW5ZfHwwKTt0aGlzLmJ1dHRvbj1hLmJ1dHRvbjt0aGlzLmtleUNvZGU9YS5rZXlDb2RlfHwwO3RoaXMua2V5PWEua2V5fHxcIlwiO3RoaXMuY2hhckNvZGU9YS5jaGFyQ29kZXx8KFwia2V5cHJlc3NcIj09Yz9hLmtleUNvZGU6MCk7dGhpcy5jdHJsS2V5PWEuY3RybEtleTt0aGlzLmFsdEtleT1hLmFsdEtleTt0aGlzLnNoaWZ0S2V5PWEuc2hpZnRLZXk7dGhpcy5tZXRhS2V5PWEubWV0YUtleTt0aGlzLnBvaW50ZXJJZD1hLnBvaW50ZXJJZHx8MDt0aGlzLnBvaW50ZXJUeXBlPVxubShhLnBvaW50ZXJUeXBlKT9hLnBvaW50ZXJUeXBlOlpiW2EucG9pbnRlclR5cGVdfHxcIlwiO3RoaXMuc3RhdGU9YS5zdGF0ZTt0aGlzLlI9YTthLmRlZmF1bHRQcmV2ZW50ZWQmJnRoaXMucHJldmVudERlZmF1bHQoKX07WWIucHJvdG90eXBlLnN0b3BQcm9wYWdhdGlvbj1mdW5jdGlvbigpe1liLlVjLnN0b3BQcm9wYWdhdGlvbi5jYWxsKHRoaXMpO3RoaXMuUi5zdG9wUHJvcGFnYXRpb24/dGhpcy5SLnN0b3BQcm9wYWdhdGlvbigpOnRoaXMuUi5jYW5jZWxCdWJibGU9ITB9O1liLnByb3RvdHlwZS5wcmV2ZW50RGVmYXVsdD1mdW5jdGlvbigpe1liLlVjLnByZXZlbnREZWZhdWx0LmNhbGwodGhpcyk7dmFyIGE9dGhpcy5SO2lmKGEucHJldmVudERlZmF1bHQpYS5wcmV2ZW50RGVmYXVsdCgpO2Vsc2UgaWYoYS5yZXR1cm5WYWx1ZT0hMSxXYil0cnl7aWYoYS5jdHJsS2V5fHwxMTI8PWEua2V5Q29kZSYmMTIzPj1hLmtleUNvZGUpYS5rZXlDb2RlPS0xfWNhdGNoKGIpe319O1xuWWIucHJvdG90eXBlLkhmPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuUn07dmFyICRiPVwiY2xvc3VyZV9saXN0ZW5hYmxlX1wiKygxRTYqTWF0aC5yYW5kb20oKXwwKSxhYz0wO3ZhciBiYz1mdW5jdGlvbihhLGIsYyxkLGUpe3RoaXMubGlzdGVuZXI9YTt0aGlzLk1jPW51bGw7dGhpcy5zcmM9Yjt0aGlzLnR5cGU9Yzt0aGlzLmNhcHR1cmU9ISFkO3RoaXMudmM9ZTt0aGlzLmtleT0rK2FjO3RoaXMuQmI9dGhpcy5wYz0hMX0sY2M9ZnVuY3Rpb24oYSl7YS5CYj0hMDthLmxpc3RlbmVyPW51bGw7YS5NYz1udWxsO2Euc3JjPW51bGw7YS52Yz1udWxsfTt2YXIgZGM9ZnVuY3Rpb24oYSl7dGhpcy5zcmM9YTt0aGlzLkk9e307dGhpcy5qYz0wfTtkYy5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9YS50b1N0cmluZygpO2E9dGhpcy5JW2ZdO2F8fChhPXRoaXMuSVtmXT1bXSx0aGlzLmpjKyspO3ZhciBnPWVjKGEsYixkLGUpOy0xPGc/KGI9YVtnXSxjfHwoYi5wYz0hMSkpOihiPW5ldyBiYyhiLHRoaXMuc3JjLGYsISFkLGUpLGIucGM9YyxhLnB1c2goYikpO3JldHVybiBifTtkYy5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKGEsYixjLGQpe2E9YS50b1N0cmluZygpO2lmKCEoYSBpbiB0aGlzLkkpKXJldHVybiExO3ZhciBlPXRoaXMuSVthXTtiPWVjKGUsYixjLGQpO3JldHVybi0xPGI/KGNjKGVbYl0pLFdhKGUsYiksMD09ZS5sZW5ndGgmJihkZWxldGUgdGhpcy5JW2FdLHRoaXMuamMtLSksITApOiExfTtcbnZhciBmYz1mdW5jdGlvbihhLGIpe3ZhciBjPWIudHlwZTtjIGluIGEuSSYmWGEoYS5JW2NdLGIpJiYoY2MoYiksMD09YS5JW2NdLmxlbmd0aCYmKGRlbGV0ZSBhLklbY10sYS5qYy0tKSl9O2RjLnByb3RvdHlwZS50ZD1mdW5jdGlvbihhLGIsYyxkKXthPXRoaXMuSVthLnRvU3RyaW5nKCldO3ZhciBlPS0xO2EmJihlPWVjKGEsYixjLGQpKTtyZXR1cm4tMTxlP2FbZV06bnVsbH07ZGMucHJvdG90eXBlLmhhc0xpc3RlbmVyPWZ1bmN0aW9uKGEsYil7dmFyIGM9YmEoYSksZD1jP2EudG9TdHJpbmcoKTpcIlwiLGU9YmEoYik7cmV0dXJuIGZiKHRoaXMuSSxmdW5jdGlvbihhKXtmb3IodmFyIGY9MDtmPGEubGVuZ3RoOysrZilpZighKGMmJmFbZl0udHlwZSE9ZHx8ZSYmYVtmXS5jYXB0dXJlIT1iKSlyZXR1cm4hMDtyZXR1cm4hMX0pfTtcbnZhciBlYz1mdW5jdGlvbihhLGIsYyxkKXtmb3IodmFyIGU9MDtlPGEubGVuZ3RoOysrZSl7dmFyIGY9YVtlXTtpZighZi5CYiYmZi5saXN0ZW5lcj09YiYmZi5jYXB0dXJlPT0hIWMmJmYudmM9PWQpcmV0dXJuIGV9cmV0dXJuLTF9O3ZhciBnYz1cImNsb3N1cmVfbG1fXCIrKDFFNipNYXRoLnJhbmRvbSgpfDApLGhjPXt9LGpjPTAsbGM9ZnVuY3Rpb24oYSxiLGMsZCxlKXtpZihkJiZkLm9uY2Upa2MoYSxiLGMsZCxlKTtlbHNlIGlmKGhhKGIpKWZvcih2YXIgZj0wO2Y8Yi5sZW5ndGg7ZisrKWxjKGEsYltmXSxjLGQsZSk7ZWxzZSBjPW1jKGMpLGEmJmFbJGJdP2EubGlzdGVuKGIsYyxxKGQpPyEhZC5jYXB0dXJlOiEhZCxlKTpuYyhhLGIsYywhMSxkLGUpfSxuYz1mdW5jdGlvbihhLGIsYyxkLGUsZil7aWYoIWIpdGhyb3cgRXJyb3IoXCJJbnZhbGlkIGV2ZW50IHR5cGVcIik7dmFyIGc9cShlKT8hIWUuY2FwdHVyZTohIWUsbD1vYyhhKTtsfHwoYVtnY109bD1uZXcgZGMoYSkpO2M9bC5hZGQoYixjLGQsZyxmKTtpZighYy5NYyl7ZD1wYygpO2MuTWM9ZDtkLnNyYz1hO2QubGlzdGVuZXI9YztpZihhLmFkZEV2ZW50TGlzdGVuZXIpWGJ8fChlPWcpLHZvaWQgMD09PWUmJihlPSExKSxhLmFkZEV2ZW50TGlzdGVuZXIoYi50b1N0cmluZygpLFxuZCxlKTtlbHNlIGlmKGEuYXR0YWNoRXZlbnQpYS5hdHRhY2hFdmVudChxYyhiLnRvU3RyaW5nKCkpLGQpO2Vsc2UgdGhyb3cgRXJyb3IoXCJhZGRFdmVudExpc3RlbmVyIGFuZCBhdHRhY2hFdmVudCBhcmUgdW5hdmFpbGFibGUuXCIpO2pjKyt9fSxwYz1mdW5jdGlvbigpe3ZhciBhPXJjLGI9VmI/ZnVuY3Rpb24oYyl7cmV0dXJuIGEuY2FsbChiLnNyYyxiLmxpc3RlbmVyLGMpfTpmdW5jdGlvbihjKXtjPWEuY2FsbChiLnNyYyxiLmxpc3RlbmVyLGMpO2lmKCFjKXJldHVybiBjfTtyZXR1cm4gYn0sa2M9ZnVuY3Rpb24oYSxiLGMsZCxlKXtpZihoYShiKSlmb3IodmFyIGY9MDtmPGIubGVuZ3RoO2YrKylrYyhhLGJbZl0sYyxkLGUpO2Vsc2UgYz1tYyhjKSxhJiZhWyRiXT9zYyhhLGIsYyxxKGQpPyEhZC5jYXB0dXJlOiEhZCxlKTpuYyhhLGIsYywhMCxkLGUpfSx0Yz1mdW5jdGlvbihhLGIsYyxkLGUpe2lmKGhhKGIpKWZvcih2YXIgZj0wO2Y8Yi5sZW5ndGg7ZisrKXRjKGEsYltmXSxjLGQsXG5lKTtlbHNlIGQ9cShkKT8hIWQuY2FwdHVyZTohIWQsYz1tYyhjKSxhJiZhWyRiXT9hLmdhLnJlbW92ZShTdHJpbmcoYiksYyxkLGUpOmEmJihhPW9jKGEpKSYmKGI9YS50ZChiLGMsZCxlKSkmJnVjKGIpfSx1Yz1mdW5jdGlvbihhKXtpZihcIm51bWJlclwiIT10eXBlb2YgYSYmYSYmIWEuQmIpe3ZhciBiPWEuc3JjO2lmKGImJmJbJGJdKWZjKGIuZ2EsYSk7ZWxzZXt2YXIgYz1hLnR5cGUsZD1hLk1jO2IucmVtb3ZlRXZlbnRMaXN0ZW5lcj9iLnJlbW92ZUV2ZW50TGlzdGVuZXIoYyxkLGEuY2FwdHVyZSk6Yi5kZXRhY2hFdmVudCYmYi5kZXRhY2hFdmVudChxYyhjKSxkKTtqYy0tOyhjPW9jKGIpKT8oZmMoYyxhKSwwPT1jLmpjJiYoYy5zcmM9bnVsbCxiW2djXT1udWxsKSk6Y2MoYSl9fX0scWM9ZnVuY3Rpb24oYSl7cmV0dXJuIGEgaW4gaGM/aGNbYV06aGNbYV09XCJvblwiK2F9LHdjPWZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPSEwO2lmKGE9b2MoYSkpaWYoYj1hLklbYi50b1N0cmluZygpXSlmb3IoYj1cbmIuY29uY2F0KCksYT0wO2E8Yi5sZW5ndGg7YSsrKXt2YXIgZj1iW2FdO2YmJmYuY2FwdHVyZT09YyYmIWYuQmImJihmPXZjKGYsZCksZT1lJiYhMSE9PWYpfXJldHVybiBlfSx2Yz1mdW5jdGlvbihhLGIpe3ZhciBjPWEubGlzdGVuZXIsZD1hLnZjfHxhLnNyYzthLnBjJiZ1YyhhKTtyZXR1cm4gYy5jYWxsKGQsYil9LHJjPWZ1bmN0aW9uKGEsYil7aWYoYS5CYilyZXR1cm4hMDtpZighVmIpe2lmKCFiKWE6e2I9W1wid2luZG93XCIsXCJldmVudFwiXTtmb3IodmFyIGM9ayxkPTA7ZDxiLmxlbmd0aDtkKyspaWYoYz1jW2JbZF1dLG51bGw9PWMpe2I9bnVsbDticmVhayBhfWI9Y31kPWI7Yj1uZXcgWWIoZCx0aGlzKTtjPSEwO2lmKCEoMD5kLmtleUNvZGV8fHZvaWQgMCE9ZC5yZXR1cm5WYWx1ZSkpe2E6e3ZhciBlPSExO2lmKDA9PWQua2V5Q29kZSl0cnl7ZC5rZXlDb2RlPS0xO2JyZWFrIGF9Y2F0Y2goZyl7ZT0hMH1pZihlfHx2b2lkIDA9PWQucmV0dXJuVmFsdWUpZC5yZXR1cm5WYWx1ZT1cbiEwfWQ9W107Zm9yKGU9Yi5jdXJyZW50VGFyZ2V0O2U7ZT1lLnBhcmVudE5vZGUpZC5wdXNoKGUpO2E9YS50eXBlO2ZvcihlPWQubGVuZ3RoLTE7IWIuV2EmJjA8PWU7ZS0tKXtiLmN1cnJlbnRUYXJnZXQ9ZFtlXTt2YXIgZj13YyhkW2VdLGEsITAsYik7Yz1jJiZmfWZvcihlPTA7IWIuV2EmJmU8ZC5sZW5ndGg7ZSsrKWIuY3VycmVudFRhcmdldD1kW2VdLGY9d2MoZFtlXSxhLCExLGIpLGM9YyYmZn1yZXR1cm4gY31yZXR1cm4gdmMoYSxuZXcgWWIoYix0aGlzKSl9LG9jPWZ1bmN0aW9uKGEpe2E9YVtnY107cmV0dXJuIGEgaW5zdGFuY2VvZiBkYz9hOm51bGx9LHhjPVwiX19jbG9zdXJlX2V2ZW50c19mbl9cIisoMUU5Kk1hdGgucmFuZG9tKCk+Pj4wKSxtYz1mdW5jdGlvbihhKXt3KGEsXCJMaXN0ZW5lciBjYW4gbm90IGJlIG51bGwuXCIpO2lmKHAoYSkpcmV0dXJuIGE7dyhhLmhhbmRsZUV2ZW50LFwiQW4gb2JqZWN0IGxpc3RlbmVyIG11c3QgaGF2ZSBoYW5kbGVFdmVudCBtZXRob2QuXCIpO1xuYVt4Y118fChhW3hjXT1mdW5jdGlvbihiKXtyZXR1cm4gYS5oYW5kbGVFdmVudChiKX0pO3JldHVybiBhW3hjXX07dmFyIHljPS9eWythLXpBLVowLTlfLiEjJCUmJypcXC89P15ge3x9fi1dK0AoW2EtekEtWjAtOS1dK1xcLikrW2EtekEtWjAtOV17Miw2M30kLzt2YXIgQWM9ZnVuY3Rpb24oKXt0aGlzLnhhPVwiXCI7dGhpcy5qZj16Y307QWMucHJvdG90eXBlLnFiPSEwO0FjLnByb3RvdHlwZS5vYj1mdW5jdGlvbigpe3JldHVybiB0aGlzLnhhfTtBYy5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm5cIlNhZmVVcmx7XCIrdGhpcy54YStcIn1cIn07XG52YXIgQmM9ZnVuY3Rpb24oYSl7aWYoYSBpbnN0YW5jZW9mIEFjJiZhLmNvbnN0cnVjdG9yPT09QWMmJmEuamY9PT16YylyZXR1cm4gYS54YTtBYShcImV4cGVjdGVkIG9iamVjdCBvZiB0eXBlIFNhZmVVcmwsIGdvdCAnXCIrYStcIicgb2YgdHlwZSBcIitlYShhKSk7cmV0dXJuXCJ0eXBlX2Vycm9yOlNhZmVVcmxcIn0sQ2M9L14oPzooPzpodHRwcz98bWFpbHRvfGZ0cCk6fFteOi8/I10qKD86Wy8/I118JCkpL2ksRWM9ZnVuY3Rpb24oYSl7aWYoYSBpbnN0YW5jZW9mIEFjKXJldHVybiBhO2E9YS5xYj9hLm9iKCk6U3RyaW5nKGEpO0NjLnRlc3QoYSl8fChhPVwiYWJvdXQ6aW52YWxpZCN6Q2xvc3VyZXpcIik7cmV0dXJuIERjKGEpfSx6Yz17fSxEYz1mdW5jdGlvbihhKXt2YXIgYj1uZXcgQWM7Yi54YT1hO3JldHVybiBifTtEYyhcImFib3V0OmJsYW5rXCIpO3ZhciBIYz1mdW5jdGlvbihhKXt2YXIgYj1bXTtGYyhuZXcgR2MsYSxiKTtyZXR1cm4gYi5qb2luKFwiXCIpfSxHYz1mdW5jdGlvbigpe3RoaXMuTmM9dm9pZCAwfSxGYz1mdW5jdGlvbihhLGIsYyl7aWYobnVsbD09YiljLnB1c2goXCJudWxsXCIpO2Vsc2V7aWYoXCJvYmplY3RcIj09dHlwZW9mIGIpe2lmKGhhKGIpKXt2YXIgZD1iO2I9ZC5sZW5ndGg7Yy5wdXNoKFwiW1wiKTtmb3IodmFyIGU9XCJcIixmPTA7ZjxiO2YrKyljLnB1c2goZSksZT1kW2ZdLEZjKGEsYS5OYz9hLk5jLmNhbGwoZCxTdHJpbmcoZiksZSk6ZSxjKSxlPVwiLFwiO2MucHVzaChcIl1cIik7cmV0dXJufWlmKGIgaW5zdGFuY2VvZiBTdHJpbmd8fGIgaW5zdGFuY2VvZiBOdW1iZXJ8fGIgaW5zdGFuY2VvZiBCb29sZWFuKWI9Yi52YWx1ZU9mKCk7ZWxzZXtjLnB1c2goXCJ7XCIpO2Y9XCJcIjtmb3IoZCBpbiBiKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLGQpJiYoZT1iW2RdLFwiZnVuY3Rpb25cIiE9dHlwZW9mIGUmJihjLnB1c2goZiksXG5JYyhkLGMpLGMucHVzaChcIjpcIiksRmMoYSxhLk5jP2EuTmMuY2FsbChiLGQsZSk6ZSxjKSxmPVwiLFwiKSk7Yy5wdXNoKFwifVwiKTtyZXR1cm59fXN3aXRjaCh0eXBlb2YgYil7Y2FzZSBcInN0cmluZ1wiOkljKGIsYyk7YnJlYWs7Y2FzZSBcIm51bWJlclwiOmMucHVzaChpc0Zpbml0ZShiKSYmIWlzTmFOKGIpP1N0cmluZyhiKTpcIm51bGxcIik7YnJlYWs7Y2FzZSBcImJvb2xlYW5cIjpjLnB1c2goU3RyaW5nKGIpKTticmVhaztjYXNlIFwiZnVuY3Rpb25cIjpjLnB1c2goXCJudWxsXCIpO2JyZWFrO2RlZmF1bHQ6dGhyb3cgRXJyb3IoXCJVbmtub3duIHR5cGU6IFwiK3R5cGVvZiBiKTt9fX0sSmM9eydcIic6J1xcXFxcIicsXCJcXFxcXCI6XCJcXFxcXFxcXFwiLFwiL1wiOlwiXFxcXC9cIixcIlxcYlwiOlwiXFxcXGJcIixcIlxcZlwiOlwiXFxcXGZcIixcIlxcblwiOlwiXFxcXG5cIixcIlxcclwiOlwiXFxcXHJcIixcIlxcdFwiOlwiXFxcXHRcIixcIlxceDBCXCI6XCJcXFxcdTAwMGJcIn0sS2M9L1xcdWZmZmYvLnRlc3QoXCJcXHVmZmZmXCIpPy9bXFxcXFwiXFx4MDAtXFx4MWZcXHg3Zi1cXHVmZmZmXS9nOi9bXFxcXFwiXFx4MDAtXFx4MWZcXHg3Zi1cXHhmZl0vZyxcbkljPWZ1bmN0aW9uKGEsYil7Yi5wdXNoKCdcIicsYS5yZXBsYWNlKEtjLGZ1bmN0aW9uKGEpe3ZhciBiPUpjW2FdO2J8fChiPVwiXFxcXHVcIisoYS5jaGFyQ29kZUF0KDApfDY1NTM2KS50b1N0cmluZygxNikuc3Vic3RyKDEpLEpjW2FdPWIpO3JldHVybiBifSksJ1wiJyl9O3ZhciBMYz1mdW5jdGlvbigpe307TGMucHJvdG90eXBlLmplPW51bGw7dmFyIE1jPWZ1bmN0aW9uKGEpe3JldHVybiBhLmplfHwoYS5qZT1hLkNkKCkpfTt2YXIgTmMsT2M9ZnVuY3Rpb24oKXt9O3QoT2MsTGMpO09jLnByb3RvdHlwZS5yYz1mdW5jdGlvbigpe3ZhciBhPVBjKHRoaXMpO3JldHVybiBhP25ldyBBY3RpdmVYT2JqZWN0KGEpOm5ldyBYTUxIdHRwUmVxdWVzdH07T2MucHJvdG90eXBlLkNkPWZ1bmN0aW9uKCl7dmFyIGE9e307UGModGhpcykmJihhWzBdPSEwLGFbMV09ITApO3JldHVybiBhfTtcbnZhciBQYz1mdW5jdGlvbihhKXtpZighYS5FZSYmXCJ1bmRlZmluZWRcIj09dHlwZW9mIFhNTEh0dHBSZXF1ZXN0JiZcInVuZGVmaW5lZFwiIT10eXBlb2YgQWN0aXZlWE9iamVjdCl7Zm9yKHZhciBiPVtcIk1TWE1MMi5YTUxIVFRQLjYuMFwiLFwiTVNYTUwyLlhNTEhUVFAuMy4wXCIsXCJNU1hNTDIuWE1MSFRUUFwiLFwiTWljcm9zb2Z0LlhNTEhUVFBcIl0sYz0wO2M8Yi5sZW5ndGg7YysrKXt2YXIgZD1iW2NdO3RyeXtyZXR1cm4gbmV3IEFjdGl2ZVhPYmplY3QoZCksYS5FZT1kfWNhdGNoKGUpe319dGhyb3cgRXJyb3IoXCJDb3VsZCBub3QgY3JlYXRlIEFjdGl2ZVhPYmplY3QuIEFjdGl2ZVggbWlnaHQgYmUgZGlzYWJsZWQsIG9yIE1TWE1MIG1pZ2h0IG5vdCBiZSBpbnN0YWxsZWRcIik7fXJldHVybiBhLkVlfTtOYz1uZXcgT2M7dmFyIFFjPWZ1bmN0aW9uKCl7fTt0KFFjLExjKTtRYy5wcm90b3R5cGUucmM9ZnVuY3Rpb24oKXt2YXIgYT1uZXcgWE1MSHR0cFJlcXVlc3Q7aWYoXCJ3aXRoQ3JlZGVudGlhbHNcImluIGEpcmV0dXJuIGE7aWYoXCJ1bmRlZmluZWRcIiE9dHlwZW9mIFhEb21haW5SZXF1ZXN0KXJldHVybiBuZXcgUmM7dGhyb3cgRXJyb3IoXCJVbnN1cHBvcnRlZCBicm93c2VyXCIpO307UWMucHJvdG90eXBlLkNkPWZ1bmN0aW9uKCl7cmV0dXJue319O1xudmFyIFJjPWZ1bmN0aW9uKCl7dGhpcy5vYT1uZXcgWERvbWFpblJlcXVlc3Q7dGhpcy5yZWFkeVN0YXRlPTA7dGhpcy5vbnJlYWR5c3RhdGVjaGFuZ2U9bnVsbDt0aGlzLnJlc3BvbnNlVGV4dD1cIlwiO3RoaXMuc3RhdHVzPS0xO3RoaXMuc3RhdHVzVGV4dD10aGlzLnJlc3BvbnNlWE1MPW51bGw7dGhpcy5vYS5vbmxvYWQ9cih0aGlzLkxmLHRoaXMpO3RoaXMub2Eub25lcnJvcj1yKHRoaXMuemUsdGhpcyk7dGhpcy5vYS5vbnByb2dyZXNzPXIodGhpcy5NZix0aGlzKTt0aGlzLm9hLm9udGltZW91dD1yKHRoaXMuTmYsdGhpcyl9O2g9UmMucHJvdG90eXBlO2gub3Blbj1mdW5jdGlvbihhLGIsYyl7aWYobnVsbCE9YyYmIWMpdGhyb3cgRXJyb3IoXCJPbmx5IGFzeW5jIHJlcXVlc3RzIGFyZSBzdXBwb3J0ZWQuXCIpO3RoaXMub2Eub3BlbihhLGIpfTtcbmguc2VuZD1mdW5jdGlvbihhKXtpZihhKWlmKFwic3RyaW5nXCI9PXR5cGVvZiBhKXRoaXMub2Euc2VuZChhKTtlbHNlIHRocm93IEVycm9yKFwiT25seSBzdHJpbmcgZGF0YSBpcyBzdXBwb3J0ZWRcIik7ZWxzZSB0aGlzLm9hLnNlbmQoKX07aC5hYm9ydD1mdW5jdGlvbigpe3RoaXMub2EuYWJvcnQoKX07aC5zZXRSZXF1ZXN0SGVhZGVyPWZ1bmN0aW9uKCl7fTtoLmdldFJlc3BvbnNlSGVhZGVyPWZ1bmN0aW9uKGEpe3JldHVyblwiY29udGVudC10eXBlXCI9PWEudG9Mb3dlckNhc2UoKT90aGlzLm9hLmNvbnRlbnRUeXBlOlwiXCJ9O2guTGY9ZnVuY3Rpb24oKXt0aGlzLnN0YXR1cz0yMDA7dGhpcy5yZXNwb25zZVRleHQ9dGhpcy5vYS5yZXNwb25zZVRleHQ7U2ModGhpcyw0KX07aC56ZT1mdW5jdGlvbigpe3RoaXMuc3RhdHVzPTUwMDt0aGlzLnJlc3BvbnNlVGV4dD1cIlwiO1NjKHRoaXMsNCl9O2guTmY9ZnVuY3Rpb24oKXt0aGlzLnplKCl9O1xuaC5NZj1mdW5jdGlvbigpe3RoaXMuc3RhdHVzPTIwMDtTYyh0aGlzLDEpfTt2YXIgU2M9ZnVuY3Rpb24oYSxiKXthLnJlYWR5U3RhdGU9YjtpZihhLm9ucmVhZHlzdGF0ZWNoYW5nZSlhLm9ucmVhZHlzdGF0ZWNoYW5nZSgpfTtSYy5wcm90b3R5cGUuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzPWZ1bmN0aW9uKCl7cmV0dXJuXCJjb250ZW50LXR5cGU6IFwiK3RoaXMub2EuY29udGVudFR5cGV9O3ZhciBUYz1mdW5jdGlvbihhLGIsYyl7dGhpcy5ZZj1jO3RoaXMud2Y9YTt0aGlzLmxnPWI7dGhpcy5IYz0wO3RoaXMud2M9bnVsbH07VGMucHJvdG90eXBlLmdldD1mdW5jdGlvbigpe2lmKDA8dGhpcy5IYyl7dGhpcy5IYy0tO3ZhciBhPXRoaXMud2M7dGhpcy53Yz1hLm5leHQ7YS5uZXh0PW51bGx9ZWxzZSBhPXRoaXMud2YoKTtyZXR1cm4gYX07VGMucHJvdG90eXBlLnB1dD1mdW5jdGlvbihhKXt0aGlzLmxnKGEpO3RoaXMuSGM8dGhpcy5ZZiYmKHRoaXMuSGMrKyxhLm5leHQ9dGhpcy53Yyx0aGlzLndjPWEpfTt2YXIgVWM9ZnVuY3Rpb24oYSl7ay5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dGhyb3cgYTt9LDApfSxWYyxXYz1mdW5jdGlvbigpe3ZhciBhPWsuTWVzc2FnZUNoYW5uZWw7XCJ1bmRlZmluZWRcIj09PXR5cGVvZiBhJiZcInVuZGVmaW5lZFwiIT09dHlwZW9mIHdpbmRvdyYmd2luZG93LnBvc3RNZXNzYWdlJiZ3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciYmIXkoXCJQcmVzdG9cIikmJihhPWZ1bmN0aW9uKCl7dmFyIGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIklGUkFNRVwiKTthLnN0eWxlLmRpc3BsYXk9XCJub25lXCI7YS5zcmM9XCJcIjtkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuYXBwZW5kQ2hpbGQoYSk7dmFyIGI9YS5jb250ZW50V2luZG93O2E9Yi5kb2N1bWVudDthLm9wZW4oKTthLndyaXRlKFwiXCIpO2EuY2xvc2UoKTt2YXIgYz1cImNhbGxJbW1lZGlhdGVcIitNYXRoLnJhbmRvbSgpLGQ9XCJmaWxlOlwiPT1iLmxvY2F0aW9uLnByb3RvY29sP1wiKlwiOmIubG9jYXRpb24ucHJvdG9jb2wrXCIvL1wiK2IubG9jYXRpb24uaG9zdDtcbmE9cihmdW5jdGlvbihhKXtpZigoXCIqXCI9PWR8fGEub3JpZ2luPT1kKSYmYS5kYXRhPT1jKXRoaXMucG9ydDEub25tZXNzYWdlKCl9LHRoaXMpO2IuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIixhLCExKTt0aGlzLnBvcnQxPXt9O3RoaXMucG9ydDI9e3Bvc3RNZXNzYWdlOmZ1bmN0aW9uKCl7Yi5wb3N0TWVzc2FnZShjLGQpfX19KTtpZihcInVuZGVmaW5lZFwiIT09dHlwZW9mIGEmJiF5KFwiVHJpZGVudFwiKSYmIXkoXCJNU0lFXCIpKXt2YXIgYj1uZXcgYSxjPXt9LGQ9YztiLnBvcnQxLm9ubWVzc2FnZT1mdW5jdGlvbigpe2lmKGJhKGMubmV4dCkpe2M9Yy5uZXh0O3ZhciBhPWMubWU7Yy5tZT1udWxsO2EoKX19O3JldHVybiBmdW5jdGlvbihhKXtkLm5leHQ9e21lOmF9O2Q9ZC5uZXh0O2IucG9ydDIucG9zdE1lc3NhZ2UoMCl9fXJldHVyblwidW5kZWZpbmVkXCIhPT10eXBlb2YgZG9jdW1lbnQmJlwib25yZWFkeXN0YXRlY2hhbmdlXCJpbiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiU0NSSVBUXCIpP1xuZnVuY3Rpb24oYSl7dmFyIGI9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIlNDUklQVFwiKTtiLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpe2Iub25yZWFkeXN0YXRlY2hhbmdlPW51bGw7Yi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGIpO2I9bnVsbDthKCk7YT1udWxsfTtkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuYXBwZW5kQ2hpbGQoYil9OmZ1bmN0aW9uKGEpe2suc2V0VGltZW91dChhLDApfX07dmFyIFhjPWZ1bmN0aW9uKCl7dGhpcy5iZD10aGlzLmhiPW51bGx9LFpjPW5ldyBUYyhmdW5jdGlvbigpe3JldHVybiBuZXcgWWN9LGZ1bmN0aW9uKGEpe2EucmVzZXQoKX0sMTAwKTtYYy5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGEsYil7dmFyIGM9WmMuZ2V0KCk7Yy5zZXQoYSxiKTt0aGlzLmJkP3RoaXMuYmQubmV4dD1jOih3KCF0aGlzLmhiKSx0aGlzLmhiPWMpO3RoaXMuYmQ9Y307WGMucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbigpe3ZhciBhPW51bGw7dGhpcy5oYiYmKGE9dGhpcy5oYix0aGlzLmhiPXRoaXMuaGIubmV4dCx0aGlzLmhifHwodGhpcy5iZD1udWxsKSxhLm5leHQ9bnVsbCk7cmV0dXJuIGF9O3ZhciBZYz1mdW5jdGlvbigpe3RoaXMubmV4dD10aGlzLnNjb3BlPXRoaXMucmQ9bnVsbH07WWMucHJvdG90eXBlLnNldD1mdW5jdGlvbihhLGIpe3RoaXMucmQ9YTt0aGlzLnNjb3BlPWI7dGhpcy5uZXh0PW51bGx9O1xuWWMucHJvdG90eXBlLnJlc2V0PWZ1bmN0aW9uKCl7dGhpcy5uZXh0PXRoaXMuc2NvcGU9dGhpcy5yZD1udWxsfTt2YXIgZGQ9ZnVuY3Rpb24oYSxiKXskY3x8YWQoKTtiZHx8KCRjKCksYmQ9ITApO2NkLmFkZChhLGIpfSwkYyxhZD1mdW5jdGlvbigpe2lmKC0xIT1TdHJpbmcoay5Qcm9taXNlKS5pbmRleE9mKFwiW25hdGl2ZSBjb2RlXVwiKSl7dmFyIGE9ay5Qcm9taXNlLnJlc29sdmUodm9pZCAwKTskYz1mdW5jdGlvbigpe2EudGhlbihlZCl9fWVsc2UgJGM9ZnVuY3Rpb24oKXt2YXIgYT1lZDshcChrLnNldEltbWVkaWF0ZSl8fGsuV2luZG93JiZrLldpbmRvdy5wcm90b3R5cGUmJiF5KFwiRWRnZVwiKSYmay5XaW5kb3cucHJvdG90eXBlLnNldEltbWVkaWF0ZT09ay5zZXRJbW1lZGlhdGU/KFZjfHwoVmM9V2MoKSksVmMoYSkpOmsuc2V0SW1tZWRpYXRlKGEpfX0sYmQ9ITEsY2Q9bmV3IFhjLGVkPWZ1bmN0aW9uKCl7Zm9yKHZhciBhO2E9Y2QucmVtb3ZlKCk7KXt0cnl7YS5yZC5jYWxsKGEuc2NvcGUpfWNhdGNoKGIpe1VjKGIpfVpjLnB1dChhKX1iZD0hMX07dmFyIGZkPWZ1bmN0aW9uKGEsYil7dmFyIGM9KGM9YSYmYS5vd25lckRvY3VtZW50KSYmKGMuZGVmYXVsdFZpZXd8fGMucGFyZW50V2luZG93KXx8aztcInVuZGVmaW5lZFwiIT10eXBlb2YgY1tiXSYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGMuTG9jYXRpb24mJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBjLkVsZW1lbnQmJihjPWEmJihhIGluc3RhbmNlb2YgY1tiXXx8IShhIGluc3RhbmNlb2YgYy5Mb2NhdGlvbnx8YSBpbnN0YW5jZW9mIGMuRWxlbWVudCkpLGE9cShhKT9hLmNvbnN0cnVjdG9yLmRpc3BsYXlOYW1lfHxhLmNvbnN0cnVjdG9yLm5hbWV8fE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChhKTp2b2lkIDA9PT1hP1widW5kZWZpbmVkXCI6bnVsbD09PWE/XCJudWxsXCI6dHlwZW9mIGEsdyhjLFwiQXJndW1lbnQgaXMgbm90IGEgJXMgKG9yIGEgbm9uLUVsZW1lbnQsIG5vbi1Mb2NhdGlvbiBtb2NrKTsgZ290OiAlc1wiLGIsYSkpfTt2YXIgZ2Q9IXp8fDk8PU51bWJlcihDYik7IXRiJiYhenx8eiYmOTw9TnVtYmVyKENiKXx8dGImJkEoXCIxLjkuMVwiKTt6JiZBKFwiOVwiKTt2YXIgaWQ9ZnVuY3Rpb24oKXt0aGlzLnhhPVwiXCI7dGhpcy5oZj1oZH07aWQucHJvdG90eXBlLnFiPSEwO2lkLnByb3RvdHlwZS5vYj1mdW5jdGlvbigpe3JldHVybiB0aGlzLnhhfTtpZC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm5cIlNhZmVIdG1se1wiK3RoaXMueGErXCJ9XCJ9O3ZhciBqZD1mdW5jdGlvbihhKXtpZihhIGluc3RhbmNlb2YgaWQmJmEuY29uc3RydWN0b3I9PT1pZCYmYS5oZj09PWhkKXJldHVybiBhLnhhO0FhKFwiZXhwZWN0ZWQgb2JqZWN0IG9mIHR5cGUgU2FmZUh0bWwsIGdvdCAnXCIrYStcIicgb2YgdHlwZSBcIitlYShhKSk7cmV0dXJuXCJ0eXBlX2Vycm9yOlNhZmVIdG1sXCJ9LGhkPXt9O2lkLnByb3RvdHlwZS5UZj1mdW5jdGlvbihhKXt0aGlzLnhhPWE7cmV0dXJuIHRoaXN9O3ZhciBrZD1mdW5jdGlvbihhLGIpe2ZkKGEsXCJIVE1MU2NyaXB0RWxlbWVudFwiKTthLnNyYz1LYShiKX07dmFyIGxkPWZ1bmN0aW9uKGEpe3ZhciBiPWRvY3VtZW50O3JldHVybiBtKGEpP2IuZ2V0RWxlbWVudEJ5SWQoYSk6YX0sbmQ9ZnVuY3Rpb24oYSxiKXtlYihiLGZ1bmN0aW9uKGIsZCl7YiYmYi5xYiYmKGI9Yi5vYigpKTtcInN0eWxlXCI9PWQ/YS5zdHlsZS5jc3NUZXh0PWI6XCJjbGFzc1wiPT1kP2EuY2xhc3NOYW1lPWI6XCJmb3JcIj09ZD9hLmh0bWxGb3I9YjptZC5oYXNPd25Qcm9wZXJ0eShkKT9hLnNldEF0dHJpYnV0ZShtZFtkXSxiKTowPT1kLmxhc3RJbmRleE9mKFwiYXJpYS1cIiwwKXx8MD09ZC5sYXN0SW5kZXhPZihcImRhdGEtXCIsMCk/YS5zZXRBdHRyaWJ1dGUoZCxiKTphW2RdPWJ9KX0sbWQ9e2NlbGxwYWRkaW5nOlwiY2VsbFBhZGRpbmdcIixjZWxsc3BhY2luZzpcImNlbGxTcGFjaW5nXCIsY29sc3BhbjpcImNvbFNwYW5cIixmcmFtZWJvcmRlcjpcImZyYW1lQm9yZGVyXCIsaGVpZ2h0OlwiaGVpZ2h0XCIsbWF4bGVuZ3RoOlwibWF4TGVuZ3RoXCIsbm9uY2U6XCJub25jZVwiLHJvbGU6XCJyb2xlXCIscm93c3BhbjpcInJvd1NwYW5cIixcbnR5cGU6XCJ0eXBlXCIsdXNlbWFwOlwidXNlTWFwXCIsdmFsaWduOlwidkFsaWduXCIsd2lkdGg6XCJ3aWR0aFwifSxwZD1mdW5jdGlvbihhLGIsYyl7dmFyIGQ9YXJndW1lbnRzLGU9ZG9jdW1lbnQsZj1TdHJpbmcoZFswXSksZz1kWzFdO2lmKCFnZCYmZyYmKGcubmFtZXx8Zy50eXBlKSl7Zj1bXCI8XCIsZl07Zy5uYW1lJiZmLnB1c2goJyBuYW1lPVwiJyx3YShnLm5hbWUpLCdcIicpO2lmKGcudHlwZSl7Zi5wdXNoKCcgdHlwZT1cIicsd2EoZy50eXBlKSwnXCInKTt2YXIgbD17fTttYihsLGcpO2RlbGV0ZSBsLnR5cGU7Zz1sfWYucHVzaChcIj5cIik7Zj1mLmpvaW4oXCJcIil9Zj1lLmNyZWF0ZUVsZW1lbnQoZik7ZyYmKG0oZyk/Zi5jbGFzc05hbWU9ZzpoYShnKT9mLmNsYXNzTmFtZT1nLmpvaW4oXCIgXCIpOm5kKGYsZykpOzI8ZC5sZW5ndGgmJm9kKGUsZixkKTtyZXR1cm4gZn0sb2Q9ZnVuY3Rpb24oYSxiLGMpe2Z1bmN0aW9uIGQoYyl7YyYmYi5hcHBlbmRDaGlsZChtKGMpP2EuY3JlYXRlVGV4dE5vZGUoYyk6XG5jKX1mb3IodmFyIGU9MjtlPGMubGVuZ3RoO2UrKyl7dmFyIGY9Y1tlXTshaWEoZil8fHEoZikmJjA8Zi5ub2RlVHlwZT9kKGYpOngocWQoZik/JGEoZik6ZixkKX19LHFkPWZ1bmN0aW9uKGEpe2lmKGEmJlwibnVtYmVyXCI9PXR5cGVvZiBhLmxlbmd0aCl7aWYocShhKSlyZXR1cm5cImZ1bmN0aW9uXCI9PXR5cGVvZiBhLml0ZW18fFwic3RyaW5nXCI9PXR5cGVvZiBhLml0ZW07aWYocChhKSlyZXR1cm5cImZ1bmN0aW9uXCI9PXR5cGVvZiBhLml0ZW19cmV0dXJuITF9O3ZhciByZD1mdW5jdGlvbihhKXthLnByb3RvdHlwZS50aGVuPWEucHJvdG90eXBlLnRoZW47YS5wcm90b3R5cGUuJGdvb2dfVGhlbmFibGU9ITB9LHNkPWZ1bmN0aW9uKGEpe2lmKCFhKXJldHVybiExO3RyeXtyZXR1cm4hIWEuJGdvb2dfVGhlbmFibGV9Y2F0Y2goYil7cmV0dXJuITF9fTt2YXIgQz1mdW5jdGlvbihhLGIpe3RoaXMuYWE9MDt0aGlzLnphPXZvaWQgMDt0aGlzLmtiPXRoaXMudWE9dGhpcy53PW51bGw7dGhpcy51Yz10aGlzLnBkPSExO2lmKGEhPWRhKXRyeXt2YXIgYz10aGlzO2EuY2FsbChiLGZ1bmN0aW9uKGEpe3RkKGMsMixhKX0sZnVuY3Rpb24oYSl7aWYoIShhIGluc3RhbmNlb2YgdWQpKXRyeXtpZihhIGluc3RhbmNlb2YgRXJyb3IpdGhyb3cgYTt0aHJvdyBFcnJvcihcIlByb21pc2UgcmVqZWN0ZWQuXCIpO31jYXRjaChlKXt9dGQoYywzLGEpfSl9Y2F0Y2goZCl7dGQodGhpcywzLGQpfX0sdmQ9ZnVuY3Rpb24oKXt0aGlzLm5leHQ9dGhpcy5jb250ZXh0PXRoaXMudGI9dGhpcy5VYT10aGlzLmNoaWxkPW51bGw7dGhpcy5IYj0hMX07dmQucHJvdG90eXBlLnJlc2V0PWZ1bmN0aW9uKCl7dGhpcy5jb250ZXh0PXRoaXMudGI9dGhpcy5VYT10aGlzLmNoaWxkPW51bGw7dGhpcy5IYj0hMX07XG52YXIgd2Q9bmV3IFRjKGZ1bmN0aW9uKCl7cmV0dXJuIG5ldyB2ZH0sZnVuY3Rpb24oYSl7YS5yZXNldCgpfSwxMDApLHhkPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD13ZC5nZXQoKTtkLlVhPWE7ZC50Yj1iO2QuY29udGV4dD1jO3JldHVybiBkfSxEPWZ1bmN0aW9uKGEpe2lmKGEgaW5zdGFuY2VvZiBDKXJldHVybiBhO3ZhciBiPW5ldyBDKGRhKTt0ZChiLDIsYSk7cmV0dXJuIGJ9LEU9ZnVuY3Rpb24oYSl7cmV0dXJuIG5ldyBDKGZ1bmN0aW9uKGIsYyl7YyhhKX0pfSx6ZD1mdW5jdGlvbihhLGIsYyl7eWQoYSxiLGMsbnVsbCl8fGRkKGxhKGIsYSkpfSxBZD1mdW5jdGlvbihhKXtyZXR1cm4gbmV3IEMoZnVuY3Rpb24oYixjKXt2YXIgZD1hLmxlbmd0aCxlPVtdO2lmKGQpZm9yKHZhciBmPWZ1bmN0aW9uKGEsYyl7ZC0tO2VbYV09YzswPT1kJiZiKGUpfSxnPWZ1bmN0aW9uKGEpe2MoYSl9LGw9MCxuO2w8YS5sZW5ndGg7bCsrKW49YVtsXSx6ZChuLGxhKGYsbCksZyk7ZWxzZSBiKGUpfSl9LFxuQmQ9ZnVuY3Rpb24oYSl7cmV0dXJuIG5ldyBDKGZ1bmN0aW9uKGIpe3ZhciBjPWEubGVuZ3RoLGQ9W107aWYoYylmb3IodmFyIGU9ZnVuY3Rpb24oYSxlLGYpe2MtLTtkW2FdPWU/e0dmOiEwLHZhbHVlOmZ9OntHZjohMSxyZWFzb246Zn07MD09YyYmYihkKX0sZj0wLGc7ZjxhLmxlbmd0aDtmKyspZz1hW2ZdLHpkKGcsbGEoZSxmLCEwKSxsYShlLGYsITEpKTtlbHNlIGIoZCl9KX07Qy5wcm90b3R5cGUudGhlbj1mdW5jdGlvbihhLGIsYyl7bnVsbCE9YSYmRGEoYSxcIm9wdF9vbkZ1bGZpbGxlZCBzaG91bGQgYmUgYSBmdW5jdGlvbi5cIik7bnVsbCE9YiYmRGEoYixcIm9wdF9vblJlamVjdGVkIHNob3VsZCBiZSBhIGZ1bmN0aW9uLiBEaWQgeW91IHBhc3Mgb3B0X2NvbnRleHQgYXMgdGhlIHNlY29uZCBhcmd1bWVudCBpbnN0ZWFkIG9mIHRoZSB0aGlyZD9cIik7cmV0dXJuIENkKHRoaXMscChhKT9hOm51bGwscChiKT9iOm51bGwsYyl9O3JkKEMpO1xudmFyIEVkPWZ1bmN0aW9uKGEsYil7Yj14ZChiLGIsdm9pZCAwKTtiLkhiPSEwO0RkKGEsYik7cmV0dXJuIGF9O0MucHJvdG90eXBlLmc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gQ2QodGhpcyxudWxsLGEsYil9O0MucHJvdG90eXBlLmNhbmNlbD1mdW5jdGlvbihhKXswPT10aGlzLmFhJiZkZChmdW5jdGlvbigpe3ZhciBiPW5ldyB1ZChhKTtGZCh0aGlzLGIpfSx0aGlzKX07XG52YXIgRmQ9ZnVuY3Rpb24oYSxiKXtpZigwPT1hLmFhKWlmKGEudyl7dmFyIGM9YS53O2lmKGMudWEpe2Zvcih2YXIgZD0wLGU9bnVsbCxmPW51bGwsZz1jLnVhO2cmJihnLkhifHwoZCsrLGcuY2hpbGQ9PWEmJihlPWcpLCEoZSYmMTxkKSkpO2c9Zy5uZXh0KWV8fChmPWcpO2UmJigwPT1jLmFhJiYxPT1kP0ZkKGMsYik6KGY/KGQ9Zix3KGMudWEpLHcobnVsbCE9ZCksZC5uZXh0PT1jLmtiJiYoYy5rYj1kKSxkLm5leHQ9ZC5uZXh0Lm5leHQpOkdkKGMpLEhkKGMsZSwzLGIpKSl9YS53PW51bGx9ZWxzZSB0ZChhLDMsYil9LERkPWZ1bmN0aW9uKGEsYil7YS51YXx8MiE9YS5hYSYmMyE9YS5hYXx8SWQoYSk7dyhudWxsIT1iLlVhKTthLmtiP2Eua2IubmV4dD1iOmEudWE9YjthLmtiPWJ9LENkPWZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPXhkKG51bGwsbnVsbCxudWxsKTtlLmNoaWxkPW5ldyBDKGZ1bmN0aW9uKGEsZyl7ZS5VYT1iP2Z1bmN0aW9uKGMpe3RyeXt2YXIgZT1iLmNhbGwoZCxcbmMpO2EoZSl9Y2F0Y2goRil7ZyhGKX19OmE7ZS50Yj1jP2Z1bmN0aW9uKGIpe3RyeXt2YXIgZT1jLmNhbGwoZCxiKTshYmEoZSkmJmIgaW5zdGFuY2VvZiB1ZD9nKGIpOmEoZSl9Y2F0Y2goRil7ZyhGKX19Omd9KTtlLmNoaWxkLnc9YTtEZChhLGUpO3JldHVybiBlLmNoaWxkfTtDLnByb3RvdHlwZS56Zz1mdW5jdGlvbihhKXt3KDE9PXRoaXMuYWEpO3RoaXMuYWE9MDt0ZCh0aGlzLDIsYSl9O0MucHJvdG90eXBlLkFnPWZ1bmN0aW9uKGEpe3coMT09dGhpcy5hYSk7dGhpcy5hYT0wO3RkKHRoaXMsMyxhKX07XG52YXIgdGQ9ZnVuY3Rpb24oYSxiLGMpezA9PWEuYWEmJihhPT09YyYmKGI9MyxjPW5ldyBUeXBlRXJyb3IoXCJQcm9taXNlIGNhbm5vdCByZXNvbHZlIHRvIGl0c2VsZlwiKSksYS5hYT0xLHlkKGMsYS56ZyxhLkFnLGEpfHwoYS56YT1jLGEuYWE9YixhLnc9bnVsbCxJZChhKSwzIT1ifHxjIGluc3RhbmNlb2YgdWR8fEpkKGEsYykpKX0seWQ9ZnVuY3Rpb24oYSxiLGMsZCl7aWYoYSBpbnN0YW5jZW9mIEMpcmV0dXJuIG51bGwhPWImJkRhKGIsXCJvcHRfb25GdWxmaWxsZWQgc2hvdWxkIGJlIGEgZnVuY3Rpb24uXCIpLG51bGwhPWMmJkRhKGMsXCJvcHRfb25SZWplY3RlZCBzaG91bGQgYmUgYSBmdW5jdGlvbi4gRGlkIHlvdSBwYXNzIG9wdF9jb250ZXh0IGFzIHRoZSBzZWNvbmQgYXJndW1lbnQgaW5zdGVhZCBvZiB0aGUgdGhpcmQ/XCIpLERkKGEseGQoYnx8ZGEsY3x8bnVsbCxkKSksITA7aWYoc2QoYSkpcmV0dXJuIGEudGhlbihiLGMsZCksITA7aWYocShhKSl0cnl7dmFyIGU9YS50aGVuO2lmKHAoZSkpcmV0dXJuIEtkKGEsXG5lLGIsYyxkKSwhMH1jYXRjaChmKXtyZXR1cm4gYy5jYWxsKGQsZiksITB9cmV0dXJuITF9LEtkPWZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9ITEsZz1mdW5jdGlvbihhKXtmfHwoZj0hMCxjLmNhbGwoZSxhKSl9LGw9ZnVuY3Rpb24oYSl7Znx8KGY9ITAsZC5jYWxsKGUsYSkpfTt0cnl7Yi5jYWxsKGEsZyxsKX1jYXRjaChuKXtsKG4pfX0sSWQ9ZnVuY3Rpb24oYSl7YS5wZHx8KGEucGQ9ITAsZGQoYS5CZixhKSl9LEdkPWZ1bmN0aW9uKGEpe3ZhciBiPW51bGw7YS51YSYmKGI9YS51YSxhLnVhPWIubmV4dCxiLm5leHQ9bnVsbCk7YS51YXx8KGEua2I9bnVsbCk7bnVsbCE9YiYmdyhudWxsIT1iLlVhKTtyZXR1cm4gYn07Qy5wcm90b3R5cGUuQmY9ZnVuY3Rpb24oKXtmb3IodmFyIGE7YT1HZCh0aGlzKTspSGQodGhpcyxhLHRoaXMuYWEsdGhpcy56YSk7dGhpcy5wZD0hMX07XG52YXIgSGQ9ZnVuY3Rpb24oYSxiLGMsZCl7aWYoMz09YyYmYi50YiYmIWIuSGIpZm9yKDthJiZhLnVjO2E9YS53KWEudWM9ITE7aWYoYi5jaGlsZCliLmNoaWxkLnc9bnVsbCxMZChiLGMsZCk7ZWxzZSB0cnl7Yi5IYj9iLlVhLmNhbGwoYi5jb250ZXh0KTpMZChiLGMsZCl9Y2F0Y2goZSl7TWQuY2FsbChudWxsLGUpfXdkLnB1dChiKX0sTGQ9ZnVuY3Rpb24oYSxiLGMpezI9PWI/YS5VYS5jYWxsKGEuY29udGV4dCxjKTphLnRiJiZhLnRiLmNhbGwoYS5jb250ZXh0LGMpfSxKZD1mdW5jdGlvbihhLGIpe2EudWM9ITA7ZGQoZnVuY3Rpb24oKXthLnVjJiZNZC5jYWxsKG51bGwsYil9KX0sTWQ9VWMsdWQ9ZnVuY3Rpb24oYSl7dS5jYWxsKHRoaXMsYSl9O3QodWQsdSk7dWQucHJvdG90eXBlLm5hbWU9XCJjYW5jZWxcIjsvKlxuIFBvcnRpb25zIG9mIHRoaXMgY29kZSBhcmUgZnJvbSBNb2NoaUtpdCwgcmVjZWl2ZWQgYnlcbiBUaGUgQ2xvc3VyZSBBdXRob3JzIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4gQWxsIG90aGVyIGNvZGUgaXMgQ29weXJpZ2h0XG4gMjAwNS0yMDA5IFRoZSBDbG9zdXJlIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4qL1xudmFyIE5kPWZ1bmN0aW9uKGEsYil7dGhpcy5RYz1bXTt0aGlzLk5lPWE7dGhpcy5yZT1ifHxudWxsO3RoaXMuUGI9dGhpcy5uYj0hMTt0aGlzLnphPXZvaWQgMDt0aGlzLmJlPXRoaXMuaGU9dGhpcy5mZD0hMTt0aGlzLlljPTA7dGhpcy53PW51bGw7dGhpcy5nZD0wfTtOZC5wcm90b3R5cGUuY2FuY2VsPWZ1bmN0aW9uKGEpe2lmKHRoaXMubmIpdGhpcy56YSBpbnN0YW5jZW9mIE5kJiZ0aGlzLnphLmNhbmNlbCgpO2Vsc2V7aWYodGhpcy53KXt2YXIgYj10aGlzLnc7ZGVsZXRlIHRoaXMudzthP2IuY2FuY2VsKGEpOihiLmdkLS0sMD49Yi5nZCYmYi5jYW5jZWwoKSl9dGhpcy5OZT90aGlzLk5lLmNhbGwodGhpcy5yZSx0aGlzKTp0aGlzLmJlPSEwO3RoaXMubmJ8fE9kKHRoaXMsbmV3IFBkKX19O05kLnByb3RvdHlwZS5vZT1mdW5jdGlvbihhLGIpe3RoaXMuZmQ9ITE7UWQodGhpcyxhLGIpfTtcbnZhciBRZD1mdW5jdGlvbihhLGIsYyl7YS5uYj0hMDthLnphPWM7YS5QYj0hYjtSZChhKX0sVGQ9ZnVuY3Rpb24oYSl7aWYoYS5uYil7aWYoIWEuYmUpdGhyb3cgbmV3IFNkO2EuYmU9ITF9fTtOZC5wcm90b3R5cGUuY2FsbGJhY2s9ZnVuY3Rpb24oYSl7VGQodGhpcyk7VWQoYSk7UWQodGhpcywhMCxhKX07dmFyIE9kPWZ1bmN0aW9uKGEsYil7VGQoYSk7VWQoYik7UWQoYSwhMSxiKX0sVWQ9ZnVuY3Rpb24oYSl7dyghKGEgaW5zdGFuY2VvZiBOZCksXCJBbiBleGVjdXRpb24gc2VxdWVuY2UgbWF5IG5vdCBiZSBpbml0aWF0ZWQgd2l0aCBhIGJsb2NraW5nIERlZmVycmVkLlwiKX0sV2Q9ZnVuY3Rpb24oYSxiKXtWZChhLG51bGwsYix2b2lkIDApfSxWZD1mdW5jdGlvbihhLGIsYyxkKXt3KCFhLmhlLFwiQmxvY2tpbmcgRGVmZXJyZWRzIGNhbiBub3QgYmUgcmUtdXNlZFwiKTthLlFjLnB1c2goW2IsYyxkXSk7YS5uYiYmUmQoYSl9O1xuTmQucHJvdG90eXBlLnRoZW49ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGUsZj1uZXcgQyhmdW5jdGlvbihhLGIpe2Q9YTtlPWJ9KTtWZCh0aGlzLGQsZnVuY3Rpb24oYSl7YSBpbnN0YW5jZW9mIFBkP2YuY2FuY2VsKCk6ZShhKX0pO3JldHVybiBmLnRoZW4oYSxiLGMpfTtyZChOZCk7XG52YXIgWGQ9ZnVuY3Rpb24oYSl7cmV0dXJuIFNhKGEuUWMsZnVuY3Rpb24oYSl7cmV0dXJuIHAoYVsxXSl9KX0sUmQ9ZnVuY3Rpb24oYSl7aWYoYS5ZYyYmYS5uYiYmWGQoYSkpe3ZhciBiPWEuWWMsYz1ZZFtiXTtjJiYoay5jbGVhclRpbWVvdXQoYy5RYiksZGVsZXRlIFlkW2JdKTthLlljPTB9YS53JiYoYS53LmdkLS0sZGVsZXRlIGEudyk7Yj1hLnphO2Zvcih2YXIgZD1jPSExO2EuUWMubGVuZ3RoJiYhYS5mZDspe3ZhciBlPWEuUWMuc2hpZnQoKSxmPWVbMF0sZz1lWzFdO2U9ZVsyXTtpZihmPWEuUGI/ZzpmKXRyeXt2YXIgbD1mLmNhbGwoZXx8YS5yZSxiKTtiYShsKSYmKGEuUGI9YS5QYiYmKGw9PWJ8fGwgaW5zdGFuY2VvZiBFcnJvciksYS56YT1iPWwpO2lmKHNkKGIpfHxcImZ1bmN0aW9uXCI9PT10eXBlb2Ygay5Qcm9taXNlJiZiIGluc3RhbmNlb2Ygay5Qcm9taXNlKWQ9ITAsYS5mZD0hMH1jYXRjaChuKXtiPW4sYS5QYj0hMCxYZChhKXx8KGM9ITApfX1hLnphPWI7ZCYmKGw9cihhLm9lLFxuYSwhMCksZD1yKGEub2UsYSwhMSksYiBpbnN0YW5jZW9mIE5kPyhWZChiLGwsZCksYi5oZT0hMCk6Yi50aGVuKGwsZCkpO2MmJihiPW5ldyBaZChiKSxZZFtiLlFiXT1iLGEuWWM9Yi5RYil9LFNkPWZ1bmN0aW9uKCl7dS5jYWxsKHRoaXMpfTt0KFNkLHUpO1NkLnByb3RvdHlwZS5tZXNzYWdlPVwiRGVmZXJyZWQgaGFzIGFscmVhZHkgZmlyZWRcIjtTZC5wcm90b3R5cGUubmFtZT1cIkFscmVhZHlDYWxsZWRFcnJvclwiO3ZhciBQZD1mdW5jdGlvbigpe3UuY2FsbCh0aGlzKX07dChQZCx1KTtQZC5wcm90b3R5cGUubWVzc2FnZT1cIkRlZmVycmVkIHdhcyBjYW5jZWxlZFwiO1BkLnByb3RvdHlwZS5uYW1lPVwiQ2FuY2VsZWRFcnJvclwiO3ZhciBaZD1mdW5jdGlvbihhKXt0aGlzLlFiPWsuc2V0VGltZW91dChyKHRoaXMueWcsdGhpcyksMCk7dGhpcy5iYT1hfTtcblpkLnByb3RvdHlwZS55Zz1mdW5jdGlvbigpe3coWWRbdGhpcy5RYl0sXCJDYW5ub3QgdGhyb3cgYW4gZXJyb3IgdGhhdCBpcyBub3Qgc2NoZWR1bGVkLlwiKTtkZWxldGUgWWRbdGhpcy5RYl07dGhyb3cgdGhpcy5iYTt9O3ZhciBZZD17fTt2YXIgZGU9ZnVuY3Rpb24oYSl7dmFyIGI9e30sYz1iLmRvY3VtZW50fHxkb2N1bWVudCxkPUthKGEpLGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIlNDUklQVFwiKSxmPXtXZTplLGljOnZvaWQgMH0sZz1uZXcgTmQoJGQsZiksbD1udWxsLG49bnVsbCE9Yi50aW1lb3V0P2IudGltZW91dDo1RTM7MDxuJiYobD13aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpe2FlKGUsITApO09kKGcsbmV3IGJlKDEsXCJUaW1lb3V0IHJlYWNoZWQgZm9yIGxvYWRpbmcgc2NyaXB0IFwiK2QpKX0sbiksZi5pYz1sKTtlLm9ubG9hZD1lLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpe2UucmVhZHlTdGF0ZSYmXCJsb2FkZWRcIiE9ZS5yZWFkeVN0YXRlJiZcImNvbXBsZXRlXCIhPWUucmVhZHlTdGF0ZXx8KGFlKGUsYi5QZ3x8ITEsbCksZy5jYWxsYmFjayhudWxsKSl9O2Uub25lcnJvcj1mdW5jdGlvbigpe2FlKGUsITAsbCk7T2QoZyxuZXcgYmUoMCxcIkVycm9yIHdoaWxlIGxvYWRpbmcgc2NyaXB0IFwiK2QpKX07XG5mPWIuYXR0cmlidXRlc3x8e307bWIoZix7dHlwZTpcInRleHQvamF2YXNjcmlwdFwiLGNoYXJzZXQ6XCJVVEYtOFwifSk7bmQoZSxmKTtrZChlLGEpO2NlKGMpLmFwcGVuZENoaWxkKGUpO3JldHVybiBnfSxjZT1mdW5jdGlvbihhKXt2YXIgYjtyZXR1cm4oYj0oYXx8ZG9jdW1lbnQpLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiSEVBRFwiKSkmJjAhPWIubGVuZ3RoP2JbMF06YS5kb2N1bWVudEVsZW1lbnR9LCRkPWZ1bmN0aW9uKCl7aWYodGhpcyYmdGhpcy5XZSl7dmFyIGE9dGhpcy5XZTthJiZcIlNDUklQVFwiPT1hLnRhZ05hbWUmJmFlKGEsITAsdGhpcy5pYyl9fSxhZT1mdW5jdGlvbihhLGIsYyl7bnVsbCE9YyYmay5jbGVhclRpbWVvdXQoYyk7YS5vbmxvYWQ9ZGE7YS5vbmVycm9yPWRhO2Eub25yZWFkeXN0YXRlY2hhbmdlPWRhO2ImJndpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7YSYmYS5wYXJlbnROb2RlJiZhLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoYSl9LDApfSxiZT1mdW5jdGlvbihhLFxuYil7dmFyIGM9XCJKc2xvYWRlciBlcnJvciAoY29kZSAjXCIrYStcIilcIjtiJiYoYys9XCI6IFwiK2IpO3UuY2FsbCh0aGlzLGMpO3RoaXMuY29kZT1hfTt0KGJlLHUpO3ZhciBlZT1mdW5jdGlvbihhLGIsYyxkLGUpe3RoaXMucmVzZXQoYSxiLGMsZCxlKX07ZWUucHJvdG90eXBlLnRlPW51bGw7dmFyIGZlPTA7ZWUucHJvdG90eXBlLnJlc2V0PWZ1bmN0aW9uKGEsYixjLGQsZSl7XCJudW1iZXJcIj09dHlwZW9mIGV8fGZlKys7ZHx8bWEoKTt0aGlzLlZiPWE7ZGVsZXRlIHRoaXMudGV9O2VlLnByb3RvdHlwZS5YZT1mdW5jdGlvbihhKXt0aGlzLlZiPWF9O3ZhciBnZT1mdW5jdGlvbihhKXt0aGlzLkxlPWE7dGhpcy5BZT10aGlzLmtkPXRoaXMuVmI9dGhpcy53PW51bGx9LGhlPWZ1bmN0aW9uKGEsYil7dGhpcy5uYW1lPWE7dGhpcy52YWx1ZT1ifTtoZS5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5uYW1lfTt2YXIgaWU9bmV3IGhlKFwiU0VWRVJFXCIsMUUzKSxqZT1uZXcgaGUoXCJJTkZPXCIsODAwKSxrZT1uZXcgaGUoXCJDT05GSUdcIiw3MDApLGxlPW5ldyBoZShcIkZJTkVcIiw1MDApO2dlLnByb3RvdHlwZS5nZXROYW1lPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuTGV9O2dlLnByb3RvdHlwZS5nZXRQYXJlbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy53fTtnZS5wcm90b3R5cGUuWGU9ZnVuY3Rpb24oYSl7dGhpcy5WYj1hfTt2YXIgbWU9ZnVuY3Rpb24oYSl7aWYoYS5WYilyZXR1cm4gYS5WYjtpZihhLncpcmV0dXJuIG1lKGEudyk7QWEoXCJSb290IGxvZ2dlciBoYXMgbm8gbGV2ZWwgc2V0LlwiKTtyZXR1cm4gbnVsbH07XG5nZS5wcm90b3R5cGUubG9nPWZ1bmN0aW9uKGEsYixjKXtpZihhLnZhbHVlPj1tZSh0aGlzKS52YWx1ZSlmb3IocChiKSYmKGI9YigpKSxhPW5ldyBlZShhLFN0cmluZyhiKSx0aGlzLkxlKSxjJiYoYS50ZT1jKSxjPXRoaXM7Yzspe3ZhciBkPWMsZT1hO2lmKGQuQWUpZm9yKHZhciBmPTA7Yj1kLkFlW2ZdO2YrKyliKGUpO2M9Yy5nZXRQYXJlbnQoKX19O2dlLnByb3RvdHlwZS5pbmZvPWZ1bmN0aW9uKGEsYil7dGhpcy5sb2coamUsYSxiKX07Z2UucHJvdG90eXBlLmNvbmZpZz1mdW5jdGlvbihhLGIpe3RoaXMubG9nKGtlLGEsYil9O1xudmFyIG5lPXt9LG9lPW51bGwscGU9ZnVuY3Rpb24oYSl7b2V8fChvZT1uZXcgZ2UoXCJcIiksbmVbXCJcIl09b2Usb2UuWGUoa2UpKTt2YXIgYjtpZighKGI9bmVbYV0pKXtiPW5ldyBnZShhKTt2YXIgYz1hLmxhc3RJbmRleE9mKFwiLlwiKSxkPWEuc3Vic3RyKGMrMSk7Yz1wZShhLnN1YnN0cigwLGMpKTtjLmtkfHwoYy5rZD17fSk7Yy5rZFtkXT1iO2Iudz1jO25lW2FdPWJ9cmV0dXJuIGJ9O3ZhciBHPWZ1bmN0aW9uKCl7VWIuY2FsbCh0aGlzKTt0aGlzLmdhPW5ldyBkYyh0aGlzKTt0aGlzLm5mPXRoaXM7dGhpcy5LZD1udWxsfTt0KEcsVWIpO0cucHJvdG90eXBlWyRiXT0hMDtoPUcucHJvdG90eXBlO2guYWRkRXZlbnRMaXN0ZW5lcj1mdW5jdGlvbihhLGIsYyxkKXtsYyh0aGlzLGEsYixjLGQpfTtoLnJlbW92ZUV2ZW50TGlzdGVuZXI9ZnVuY3Rpb24oYSxiLGMsZCl7dGModGhpcyxhLGIsYyxkKX07XG5oLmRpc3BhdGNoRXZlbnQ9ZnVuY3Rpb24oYSl7cWUodGhpcyk7dmFyIGI9dGhpcy5LZDtpZihiKXt2YXIgYz1bXTtmb3IodmFyIGQ9MTtiO2I9Yi5LZCljLnB1c2goYiksdygxRTM+KytkLFwiaW5maW5pdGUgbG9vcFwiKX1iPXRoaXMubmY7ZD1hLnR5cGV8fGE7aWYobShhKSlhPW5ldyBCKGEsYik7ZWxzZSBpZihhIGluc3RhbmNlb2YgQilhLnRhcmdldD1hLnRhcmdldHx8YjtlbHNle3ZhciBlPWE7YT1uZXcgQihkLGIpO21iKGEsZSl9ZT0hMDtpZihjKWZvcih2YXIgZj1jLmxlbmd0aC0xOyFhLldhJiYwPD1mO2YtLSl7dmFyIGc9YS5jdXJyZW50VGFyZ2V0PWNbZl07ZT1yZShnLGQsITAsYSkmJmV9YS5XYXx8KGc9YS5jdXJyZW50VGFyZ2V0PWIsZT1yZShnLGQsITAsYSkmJmUsYS5XYXx8KGU9cmUoZyxkLCExLGEpJiZlKSk7aWYoYylmb3IoZj0wOyFhLldhJiZmPGMubGVuZ3RoO2YrKylnPWEuY3VycmVudFRhcmdldD1jW2ZdLGU9cmUoZyxkLCExLGEpJiZlO3JldHVybiBlfTtcbmgubGI9ZnVuY3Rpb24oKXtHLlVjLmxiLmNhbGwodGhpcyk7aWYodGhpcy5nYSl7dmFyIGE9dGhpcy5nYSxiPTAsYztmb3IoYyBpbiBhLkkpe2Zvcih2YXIgZD1hLklbY10sZT0wO2U8ZC5sZW5ndGg7ZSsrKSsrYixjYyhkW2VdKTtkZWxldGUgYS5JW2NdO2EuamMtLX19dGhpcy5LZD1udWxsfTtoLmxpc3Rlbj1mdW5jdGlvbihhLGIsYyxkKXtxZSh0aGlzKTtyZXR1cm4gdGhpcy5nYS5hZGQoU3RyaW5nKGEpLGIsITEsYyxkKX07XG52YXIgc2M9ZnVuY3Rpb24oYSxiLGMsZCxlKXthLmdhLmFkZChTdHJpbmcoYiksYywhMCxkLGUpfSxyZT1mdW5jdGlvbihhLGIsYyxkKXtiPWEuZ2EuSVtTdHJpbmcoYildO2lmKCFiKXJldHVybiEwO2I9Yi5jb25jYXQoKTtmb3IodmFyIGU9ITAsZj0wO2Y8Yi5sZW5ndGg7KytmKXt2YXIgZz1iW2ZdO2lmKGcmJiFnLkJiJiZnLmNhcHR1cmU9PWMpe3ZhciBsPWcubGlzdGVuZXIsbj1nLnZjfHxnLnNyYztnLnBjJiZmYyhhLmdhLGcpO2U9ITEhPT1sLmNhbGwobixkKSYmZX19cmV0dXJuIGUmJjAhPWQuVWV9O0cucHJvdG90eXBlLnRkPWZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiB0aGlzLmdhLnRkKFN0cmluZyhhKSxiLGMsZCl9O0cucHJvdG90eXBlLmhhc0xpc3RlbmVyPWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuZ2EuaGFzTGlzdGVuZXIoYmEoYSk/U3RyaW5nKGEpOnZvaWQgMCxiKX07dmFyIHFlPWZ1bmN0aW9uKGEpe3coYS5nYSxcIkV2ZW50IHRhcmdldCBpcyBub3QgaW5pdGlhbGl6ZWQuIERpZCB5b3UgY2FsbCB0aGUgc3VwZXJjbGFzcyAoZ29vZy5ldmVudHMuRXZlbnRUYXJnZXQpIGNvbnN0cnVjdG9yP1wiKX07dmFyIHNlPVwiU3RvcEl0ZXJhdGlvblwiaW4gaz9rLlN0b3BJdGVyYXRpb246e21lc3NhZ2U6XCJTdG9wSXRlcmF0aW9uXCIsc3RhY2s6XCJcIn0sdGU9ZnVuY3Rpb24oKXt9O3RlLnByb3RvdHlwZS5uZXh0PWZ1bmN0aW9uKCl7dGhyb3cgc2U7fTt0ZS5wcm90b3R5cGUubWY9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc307dmFyIEg9ZnVuY3Rpb24oYSxiKXthJiZhLmxvZyhsZSxiLHZvaWQgMCl9O3ZhciB1ZT1mdW5jdGlvbihhLGIpe3RoaXMuamE9e307dGhpcy5DPVtdO3RoaXMuZ2I9dGhpcy51PTA7dmFyIGM9YXJndW1lbnRzLmxlbmd0aDtpZigxPGMpe2lmKGMlMil0aHJvdyBFcnJvcihcIlVuZXZlbiBudW1iZXIgb2YgYXJndW1lbnRzXCIpO2Zvcih2YXIgZD0wO2Q8YztkKz0yKXRoaXMuc2V0KGFyZ3VtZW50c1tkXSxhcmd1bWVudHNbZCsxXSl9ZWxzZSBhJiZ0aGlzLmFkZEFsbChhKX07aD11ZS5wcm90b3R5cGU7aC5oYT1mdW5jdGlvbigpe3ZlKHRoaXMpO2Zvcih2YXIgYT1bXSxiPTA7Yjx0aGlzLkMubGVuZ3RoO2IrKylhLnB1c2godGhpcy5qYVt0aGlzLkNbYl1dKTtyZXR1cm4gYX07aC52YT1mdW5jdGlvbigpe3ZlKHRoaXMpO3JldHVybiB0aGlzLkMuY29uY2F0KCl9O2guSmI9ZnVuY3Rpb24oYSl7cmV0dXJuIHdlKHRoaXMuamEsYSl9O2guY2xlYXI9ZnVuY3Rpb24oKXt0aGlzLmphPXt9O3RoaXMuZ2I9dGhpcy51PXRoaXMuQy5sZW5ndGg9MH07XG5oLnJlbW92ZT1mdW5jdGlvbihhKXtyZXR1cm4gd2UodGhpcy5qYSxhKT8oZGVsZXRlIHRoaXMuamFbYV0sdGhpcy51LS0sdGhpcy5nYisrLHRoaXMuQy5sZW5ndGg+Mip0aGlzLnUmJnZlKHRoaXMpLCEwKTohMX07dmFyIHZlPWZ1bmN0aW9uKGEpe2lmKGEudSE9YS5DLmxlbmd0aCl7Zm9yKHZhciBiPTAsYz0wO2I8YS5DLmxlbmd0aDspe3ZhciBkPWEuQ1tiXTt3ZShhLmphLGQpJiYoYS5DW2MrK109ZCk7YisrfWEuQy5sZW5ndGg9Y31pZihhLnUhPWEuQy5sZW5ndGgpe3ZhciBlPXt9O2ZvcihjPWI9MDtiPGEuQy5sZW5ndGg7KWQ9YS5DW2JdLHdlKGUsZCl8fChhLkNbYysrXT1kLGVbZF09MSksYisrO2EuQy5sZW5ndGg9Y319O2g9dWUucHJvdG90eXBlO2guZ2V0PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHdlKHRoaXMuamEsYSk/dGhpcy5qYVthXTpifTtcbmguc2V0PWZ1bmN0aW9uKGEsYil7d2UodGhpcy5qYSxhKXx8KHRoaXMudSsrLHRoaXMuQy5wdXNoKGEpLHRoaXMuZ2IrKyk7dGhpcy5qYVthXT1ifTtoLmFkZEFsbD1mdW5jdGlvbihhKXtpZihhIGluc3RhbmNlb2YgdWUpe3ZhciBiPWEudmEoKTthPWEuaGEoKX1lbHNlIGI9aGIoYSksYT1nYihhKTtmb3IodmFyIGM9MDtjPGIubGVuZ3RoO2MrKyl0aGlzLnNldChiW2NdLGFbY10pfTtoLmZvckVhY2g9ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9dGhpcy52YSgpLGQ9MDtkPGMubGVuZ3RoO2QrKyl7dmFyIGU9Y1tkXSxmPXRoaXMuZ2V0KGUpO2EuY2FsbChiLGYsZSx0aGlzKX19O2guY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHVlKHRoaXMpfTtcbmgubWY9ZnVuY3Rpb24oYSl7dmUodGhpcyk7dmFyIGI9MCxjPXRoaXMuZ2IsZD10aGlzLGU9bmV3IHRlO2UubmV4dD1mdW5jdGlvbigpe2lmKGMhPWQuZ2IpdGhyb3cgRXJyb3IoXCJUaGUgbWFwIGhhcyBjaGFuZ2VkIHNpbmNlIHRoZSBpdGVyYXRvciB3YXMgY3JlYXRlZFwiKTtpZihiPj1kLkMubGVuZ3RoKXRocm93IHNlO3ZhciBlPWQuQ1tiKytdO3JldHVybiBhP2U6ZC5qYVtlXX07cmV0dXJuIGV9O3ZhciB3ZT1mdW5jdGlvbihhLGIpe3JldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYSxiKX07dmFyIHhlPWZ1bmN0aW9uKGEpe2lmKGEuaGEmJlwiZnVuY3Rpb25cIj09dHlwZW9mIGEuaGEpcmV0dXJuIGEuaGEoKTtpZihtKGEpKXJldHVybiBhLnNwbGl0KFwiXCIpO2lmKGlhKGEpKXtmb3IodmFyIGI9W10sYz1hLmxlbmd0aCxkPTA7ZDxjO2QrKyliLnB1c2goYVtkXSk7cmV0dXJuIGJ9cmV0dXJuIGdiKGEpfSx5ZT1mdW5jdGlvbihhKXtpZihhLnZhJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBhLnZhKXJldHVybiBhLnZhKCk7aWYoIWEuaGF8fFwiZnVuY3Rpb25cIiE9dHlwZW9mIGEuaGEpe2lmKGlhKGEpfHxtKGEpKXt2YXIgYj1bXTthPWEubGVuZ3RoO2Zvcih2YXIgYz0wO2M8YTtjKyspYi5wdXNoKGMpO3JldHVybiBifXJldHVybiBoYihhKX19LHplPWZ1bmN0aW9uKGEsYixjKXtpZihhLmZvckVhY2gmJlwiZnVuY3Rpb25cIj09dHlwZW9mIGEuZm9yRWFjaClhLmZvckVhY2goYixjKTtlbHNlIGlmKGlhKGEpfHxtKGEpKXgoYSxiLGMpO2Vsc2UgZm9yKHZhciBkPXllKGEpLGU9eGUoYSksZj1lLmxlbmd0aCxcbmc9MDtnPGY7ZysrKWIuY2FsbChjLGVbZ10sZCYmZFtnXSxhKX07dmFyIEFlPWZ1bmN0aW9uKGEsYixjKXtpZihwKGEpKWMmJihhPXIoYSxjKSk7ZWxzZSBpZihhJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBhLmhhbmRsZUV2ZW50KWE9cihhLmhhbmRsZUV2ZW50LGEpO2Vsc2UgdGhyb3cgRXJyb3IoXCJJbnZhbGlkIGxpc3RlbmVyIGFyZ3VtZW50XCIpO3JldHVybiAyMTQ3NDgzNjQ3PE51bWJlcihiKT8tMTprLnNldFRpbWVvdXQoYSxifHwwKX0sQmU9ZnVuY3Rpb24oYSl7dmFyIGI9bnVsbDtyZXR1cm4obmV3IEMoZnVuY3Rpb24oYyxkKXtiPUFlKGZ1bmN0aW9uKCl7Yyh2b2lkIDApfSxhKTstMT09YiYmZChFcnJvcihcIkZhaWxlZCB0byBzY2hlZHVsZSB0aW1lci5cIikpfSkpLmcoZnVuY3Rpb24oYSl7ay5jbGVhclRpbWVvdXQoYik7dGhyb3cgYTt9KX07dmFyIENlPS9eKD86KFteOi8/Iy5dKyk6KT8oPzpcXC9cXC8oPzooW14vPyNdKilAKT8oW14vIz9dKj8pKD86OihbMC05XSspKT8oPz1bLyM/XXwkKSk/KFtePyNdKyk/KD86XFw/KFteI10qKSk/KD86IyhbXFxzXFxTXSopKT8kLyxEZT1mdW5jdGlvbihhLGIpe2lmKGEpe2E9YS5zcGxpdChcIiZcIik7Zm9yKHZhciBjPTA7YzxhLmxlbmd0aDtjKyspe3ZhciBkPWFbY10uaW5kZXhPZihcIj1cIiksZT1udWxsO2lmKDA8PWQpe3ZhciBmPWFbY10uc3Vic3RyaW5nKDAsZCk7ZT1hW2NdLnN1YnN0cmluZyhkKzEpfWVsc2UgZj1hW2NdO2IoZixlP2RlY29kZVVSSUNvbXBvbmVudChlLnJlcGxhY2UoL1xcKy9nLFwiIFwiKSk6XCJcIil9fX07dmFyIEk9ZnVuY3Rpb24oYSl7Ry5jYWxsKHRoaXMpO3RoaXMuaGVhZGVycz1uZXcgdWU7dGhpcy5kZD1hfHxudWxsO3RoaXMuQ2E9ITE7dGhpcy5jZD10aGlzLmI9bnVsbDt0aGlzLlViPXRoaXMuS2U9dGhpcy5FYz1cIlwiO3RoaXMuUWE9dGhpcy56ZD10aGlzLnpjPXRoaXMub2Q9ITE7dGhpcy5EYj0wO3RoaXMuVmM9bnVsbDt0aGlzLk9jPVwiXCI7dGhpcy5aYz10aGlzLmhnPXRoaXMuZ2Y9ITF9O3QoSSxHKTt2YXIgRWU9SS5wcm90b3R5cGUsRmU9cGUoXCJnb29nLm5ldC5YaHJJb1wiKTtFZS5UPUZlO3ZhciBHZT0vXmh0dHBzPyQvaSxIZT1bXCJQT1NUXCIsXCJQVVRcIl07XG5JLnByb3RvdHlwZS5zZW5kPWZ1bmN0aW9uKGEsYixjLGQpe2lmKHRoaXMuYil0aHJvdyBFcnJvcihcIltnb29nLm5ldC5YaHJJb10gT2JqZWN0IGlzIGFjdGl2ZSB3aXRoIGFub3RoZXIgcmVxdWVzdD1cIit0aGlzLkVjK1wiOyBuZXdVcmk9XCIrYSk7Yj1iP2IudG9VcHBlckNhc2UoKTpcIkdFVFwiO3RoaXMuRWM9YTt0aGlzLlViPVwiXCI7dGhpcy5LZT1iO3RoaXMub2Q9ITE7dGhpcy5DYT0hMDt0aGlzLmI9dGhpcy5kZD90aGlzLmRkLnJjKCk6TmMucmMoKTt0aGlzLmNkPXRoaXMuZGQ/TWModGhpcy5kZCk6TWMoTmMpO3RoaXMuYi5vbnJlYWR5c3RhdGVjaGFuZ2U9cih0aGlzLlJlLHRoaXMpO3RoaXMuaGcmJlwib25wcm9ncmVzc1wiaW4gdGhpcy5iJiYodGhpcy5iLm9ucHJvZ3Jlc3M9cihmdW5jdGlvbihhKXt0aGlzLlFlKGEsITApfSx0aGlzKSx0aGlzLmIudXBsb2FkJiYodGhpcy5iLnVwbG9hZC5vbnByb2dyZXNzPXIodGhpcy5RZSx0aGlzKSkpO3RyeXtIKHRoaXMuVCxJZSh0aGlzLFwiT3BlbmluZyBYaHJcIikpLFxudGhpcy56ZD0hMCx0aGlzLmIub3BlbihiLFN0cmluZyhhKSwhMCksdGhpcy56ZD0hMX1jYXRjaChmKXtIKHRoaXMuVCxJZSh0aGlzLFwiRXJyb3Igb3BlbmluZyBYaHI6IFwiK2YubWVzc2FnZSkpO3RoaXMuYmEoNSxmKTtyZXR1cm59YT1jfHxcIlwiO3ZhciBlPXRoaXMuaGVhZGVycy5jbG9uZSgpO2QmJnplKGQsZnVuY3Rpb24oYSxiKXtlLnNldChiLGEpfSk7ZD1VYShlLnZhKCkpO2M9ay5Gb3JtRGF0YSYmYSBpbnN0YW5jZW9mIGsuRm9ybURhdGE7IVZhKEhlLGIpfHxkfHxjfHxlLnNldChcIkNvbnRlbnQtVHlwZVwiLFwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkO2NoYXJzZXQ9dXRmLThcIik7ZS5mb3JFYWNoKGZ1bmN0aW9uKGEsYil7dGhpcy5iLnNldFJlcXVlc3RIZWFkZXIoYixhKX0sdGhpcyk7dGhpcy5PYyYmKHRoaXMuYi5yZXNwb25zZVR5cGU9dGhpcy5PYyk7XCJ3aXRoQ3JlZGVudGlhbHNcImluIHRoaXMuYiYmdGhpcy5iLndpdGhDcmVkZW50aWFscyE9PXRoaXMuZ2YmJlxuKHRoaXMuYi53aXRoQ3JlZGVudGlhbHM9dGhpcy5nZik7dHJ5e0plKHRoaXMpLDA8dGhpcy5EYiYmKHRoaXMuWmM9S2UodGhpcy5iKSxIKHRoaXMuVCxJZSh0aGlzLFwiV2lsbCBhYm9ydCBhZnRlciBcIit0aGlzLkRiK1wibXMgaWYgaW5jb21wbGV0ZSwgeGhyMiBcIit0aGlzLlpjKSksdGhpcy5aYz8odGhpcy5iLnRpbWVvdXQ9dGhpcy5EYix0aGlzLmIub250aW1lb3V0PXIodGhpcy5pYyx0aGlzKSk6dGhpcy5WYz1BZSh0aGlzLmljLHRoaXMuRGIsdGhpcykpLEgodGhpcy5ULEllKHRoaXMsXCJTZW5kaW5nIHJlcXVlc3RcIikpLHRoaXMuemM9ITAsdGhpcy5iLnNlbmQoYSksdGhpcy56Yz0hMX1jYXRjaChmKXtIKHRoaXMuVCxJZSh0aGlzLFwiU2VuZCBlcnJvcjogXCIrZi5tZXNzYWdlKSksdGhpcy5iYSg1LGYpfX07XG52YXIgS2U9ZnVuY3Rpb24oYSl7cmV0dXJuIHomJkEoOSkmJlwibnVtYmVyXCI9PXR5cGVvZiBhLnRpbWVvdXQmJmJhKGEub250aW1lb3V0KX0sVGE9ZnVuY3Rpb24oYSl7cmV0dXJuXCJjb250ZW50LXR5cGVcIj09YS50b0xvd2VyQ2FzZSgpfTtJLnByb3RvdHlwZS5pYz1mdW5jdGlvbigpe1widW5kZWZpbmVkXCIhPXR5cGVvZiBhYSYmdGhpcy5iJiYodGhpcy5VYj1cIlRpbWVkIG91dCBhZnRlciBcIit0aGlzLkRiK1wibXMsIGFib3J0aW5nXCIsSCh0aGlzLlQsSWUodGhpcyx0aGlzLlViKSksdGhpcy5kaXNwYXRjaEV2ZW50KFwidGltZW91dFwiKSx0aGlzLmFib3J0KDgpKX07SS5wcm90b3R5cGUuYmE9ZnVuY3Rpb24oYSxiKXt0aGlzLkNhPSExO3RoaXMuYiYmKHRoaXMuUWE9ITAsdGhpcy5iLmFib3J0KCksdGhpcy5RYT0hMSk7dGhpcy5VYj1iO0xlKHRoaXMpO01lKHRoaXMpfTt2YXIgTGU9ZnVuY3Rpb24oYSl7YS5vZHx8KGEub2Q9ITAsYS5kaXNwYXRjaEV2ZW50KFwiY29tcGxldGVcIiksYS5kaXNwYXRjaEV2ZW50KFwiZXJyb3JcIikpfTtcbkkucHJvdG90eXBlLmFib3J0PWZ1bmN0aW9uKCl7dGhpcy5iJiZ0aGlzLkNhJiYoSCh0aGlzLlQsSWUodGhpcyxcIkFib3J0aW5nXCIpKSx0aGlzLkNhPSExLHRoaXMuUWE9ITAsdGhpcy5iLmFib3J0KCksdGhpcy5RYT0hMSx0aGlzLmRpc3BhdGNoRXZlbnQoXCJjb21wbGV0ZVwiKSx0aGlzLmRpc3BhdGNoRXZlbnQoXCJhYm9ydFwiKSxNZSh0aGlzKSl9O0kucHJvdG90eXBlLmxiPWZ1bmN0aW9uKCl7dGhpcy5iJiYodGhpcy5DYSYmKHRoaXMuQ2E9ITEsdGhpcy5RYT0hMCx0aGlzLmIuYWJvcnQoKSx0aGlzLlFhPSExKSxNZSh0aGlzLCEwKSk7SS5VYy5sYi5jYWxsKHRoaXMpfTtJLnByb3RvdHlwZS5SZT1mdW5jdGlvbigpe3RoaXMuaXNEaXNwb3NlZCgpfHwodGhpcy56ZHx8dGhpcy56Y3x8dGhpcy5RYT9OZSh0aGlzKTp0aGlzLmRnKCkpfTtJLnByb3RvdHlwZS5kZz1mdW5jdGlvbigpe05lKHRoaXMpfTtcbnZhciBOZT1mdW5jdGlvbihhKXtpZihhLkNhJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgYWEpaWYoYS5jZFsxXSYmND09T2UoYSkmJjI9PVBlKGEpKUgoYS5ULEllKGEsXCJMb2NhbCByZXF1ZXN0IGVycm9yIGRldGVjdGVkIGFuZCBpZ25vcmVkXCIpKTtlbHNlIGlmKGEuemMmJjQ9PU9lKGEpKUFlKGEuUmUsMCxhKTtlbHNlIGlmKGEuZGlzcGF0Y2hFdmVudChcInJlYWR5c3RhdGVjaGFuZ2VcIiksND09T2UoYSkpe0goYS5ULEllKGEsXCJSZXF1ZXN0IGNvbXBsZXRlXCIpKTthLkNhPSExO3RyeXt2YXIgYj1QZShhKTthOnN3aXRjaChiKXtjYXNlIDIwMDpjYXNlIDIwMTpjYXNlIDIwMjpjYXNlIDIwNDpjYXNlIDIwNjpjYXNlIDMwNDpjYXNlIDEyMjM6dmFyIGM9ITA7YnJlYWsgYTtkZWZhdWx0OmM9ITF9dmFyIGQ7aWYoIShkPWMpKXt2YXIgZTtpZihlPTA9PT1iKXt2YXIgZj1TdHJpbmcoYS5FYykubWF0Y2goQ2UpWzFdfHxudWxsO2lmKCFmJiZrLnNlbGYmJmsuc2VsZi5sb2NhdGlvbil7dmFyIGc9XG5rLnNlbGYubG9jYXRpb24ucHJvdG9jb2w7Zj1nLnN1YnN0cigwLGcubGVuZ3RoLTEpfWU9IUdlLnRlc3QoZj9mLnRvTG93ZXJDYXNlKCk6XCJcIil9ZD1lfWlmKGQpYS5kaXNwYXRjaEV2ZW50KFwiY29tcGxldGVcIiksYS5kaXNwYXRjaEV2ZW50KFwic3VjY2Vzc1wiKTtlbHNle3RyeXt2YXIgbD0yPE9lKGEpP2EuYi5zdGF0dXNUZXh0OlwiXCJ9Y2F0Y2gobil7SChhLlQsXCJDYW4gbm90IGdldCBzdGF0dXM6IFwiK24ubWVzc2FnZSksbD1cIlwifWEuVWI9bCtcIiBbXCIrUGUoYSkrXCJdXCI7TGUoYSl9fWZpbmFsbHl7TWUoYSl9fX07SS5wcm90b3R5cGUuUWU9ZnVuY3Rpb24oYSxiKXt3KFwicHJvZ3Jlc3NcIj09PWEudHlwZSxcImdvb2cubmV0LkV2ZW50VHlwZS5QUk9HUkVTUyBpcyBvZiB0aGUgc2FtZSB0eXBlIGFzIHJhdyBYSFIgcHJvZ3Jlc3MuXCIpO3RoaXMuZGlzcGF0Y2hFdmVudChRZShhLFwicHJvZ3Jlc3NcIikpO3RoaXMuZGlzcGF0Y2hFdmVudChRZShhLGI/XCJkb3dubG9hZHByb2dyZXNzXCI6XCJ1cGxvYWRwcm9ncmVzc1wiKSl9O1xudmFyIFFlPWZ1bmN0aW9uKGEsYil7cmV0dXJue3R5cGU6YixsZW5ndGhDb21wdXRhYmxlOmEubGVuZ3RoQ29tcHV0YWJsZSxsb2FkZWQ6YS5sb2FkZWQsdG90YWw6YS50b3RhbH19LE1lPWZ1bmN0aW9uKGEsYil7aWYoYS5iKXtKZShhKTt2YXIgYz1hLmIsZD1hLmNkWzBdP2RhOm51bGw7YS5iPW51bGw7YS5jZD1udWxsO2J8fGEuZGlzcGF0Y2hFdmVudChcInJlYWR5XCIpO3RyeXtjLm9ucmVhZHlzdGF0ZWNoYW5nZT1kfWNhdGNoKGUpeyhhPWEuVCkmJmEubG9nKGllLFwiUHJvYmxlbSBlbmNvdW50ZXJlZCByZXNldHRpbmcgb25yZWFkeXN0YXRlY2hhbmdlOiBcIitlLm1lc3NhZ2Usdm9pZCAwKX19fSxKZT1mdW5jdGlvbihhKXthLmImJmEuWmMmJihhLmIub250aW1lb3V0PW51bGwpO2EuVmMmJihrLmNsZWFyVGltZW91dChhLlZjKSxhLlZjPW51bGwpfSxPZT1mdW5jdGlvbihhKXtyZXR1cm4gYS5iP2EuYi5yZWFkeVN0YXRlOjB9LFBlPWZ1bmN0aW9uKGEpe3RyeXtyZXR1cm4gMjxPZShhKT9cbmEuYi5zdGF0dXM6LTF9Y2F0Y2goYil7cmV0dXJuLTF9fSxSZT1mdW5jdGlvbihhKXt0cnl7cmV0dXJuIGEuYj9hLmIucmVzcG9uc2VUZXh0OlwiXCJ9Y2F0Y2goYil7cmV0dXJuIEgoYS5ULFwiQ2FuIG5vdCBnZXQgcmVzcG9uc2VUZXh0OiBcIitiLm1lc3NhZ2UpLFwiXCJ9fTtcbkkucHJvdG90eXBlLmdldFJlc3BvbnNlPWZ1bmN0aW9uKCl7dHJ5e2lmKCF0aGlzLmIpcmV0dXJuIG51bGw7aWYoXCJyZXNwb25zZVwiaW4gdGhpcy5iKXJldHVybiB0aGlzLmIucmVzcG9uc2U7c3dpdGNoKHRoaXMuT2Mpe2Nhc2UgXCJcIjpjYXNlIFwidGV4dFwiOnJldHVybiB0aGlzLmIucmVzcG9uc2VUZXh0O2Nhc2UgXCJhcnJheWJ1ZmZlclwiOmlmKFwibW96UmVzcG9uc2VBcnJheUJ1ZmZlclwiaW4gdGhpcy5iKXJldHVybiB0aGlzLmIubW96UmVzcG9uc2VBcnJheUJ1ZmZlcn12YXIgYT10aGlzLlQ7YSYmYS5sb2coaWUsXCJSZXNwb25zZSB0eXBlIFwiK3RoaXMuT2MrXCIgaXMgbm90IHN1cHBvcnRlZCBvbiB0aGlzIGJyb3dzZXJcIix2b2lkIDApO3JldHVybiBudWxsfWNhdGNoKGIpe3JldHVybiBIKHRoaXMuVCxcIkNhbiBub3QgZ2V0IHJlc3BvbnNlOiBcIitiLm1lc3NhZ2UpLG51bGx9fTtcbkkucHJvdG90eXBlLmdldFJlc3BvbnNlSGVhZGVyPWZ1bmN0aW9uKGEpe2lmKHRoaXMuYiYmND09T2UodGhpcykpcmV0dXJuIGE9dGhpcy5iLmdldFJlc3BvbnNlSGVhZGVyKGEpLG51bGw9PT1hP3ZvaWQgMDphfTtJLnByb3RvdHlwZS5nZXRBbGxSZXNwb25zZUhlYWRlcnM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5iJiY0PT1PZSh0aGlzKT90aGlzLmIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCk6XCJcIn07dmFyIEllPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGIrXCIgW1wiK2EuS2UrXCIgXCIrYS5FYytcIiBcIitQZShhKStcIl1cIn07dmFyIFNlPWZ1bmN0aW9uKGEsYil7dGhpcy5wYT10aGlzLmViPXRoaXMucWE9XCJcIjt0aGlzLnZiPW51bGw7dGhpcy5QYT10aGlzLkdhPVwiXCI7dGhpcy5kYT10aGlzLlhmPSExO2lmKGEgaW5zdGFuY2VvZiBTZSl7dGhpcy5kYT1iYShiKT9iOmEuZGE7VGUodGhpcyxhLnFhKTt2YXIgYz1hLmViO0oodGhpcyk7dGhpcy5lYj1jO1VlKHRoaXMsYS5wYSk7VmUodGhpcyxhLnZiKTtXZSh0aGlzLGEuR2EpO1hlKHRoaXMsYS5lYS5jbG9uZSgpKTthPWEuUGE7Sih0aGlzKTt0aGlzLlBhPWF9ZWxzZSBhJiYoYz1TdHJpbmcoYSkubWF0Y2goQ2UpKT8odGhpcy5kYT0hIWIsVGUodGhpcyxjWzFdfHxcIlwiLCEwKSxhPWNbMl18fFwiXCIsSih0aGlzKSx0aGlzLmViPVllKGEpLFVlKHRoaXMsY1szXXx8XCJcIiwhMCksVmUodGhpcyxjWzRdKSxXZSh0aGlzLGNbNV18fFwiXCIsITApLFhlKHRoaXMsY1s2XXx8XCJcIiwhMCksYT1jWzddfHxcIlwiLEoodGhpcyksdGhpcy5QYT1ZZShhKSk6KHRoaXMuZGE9ISFiLHRoaXMuZWE9XG5uZXcgWmUobnVsbCwwLHRoaXMuZGEpKX07U2UucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7dmFyIGE9W10sYj10aGlzLnFhO2ImJmEucHVzaCgkZShiLGFmLCEwKSxcIjpcIik7dmFyIGM9dGhpcy5wYTtpZihjfHxcImZpbGVcIj09YilhLnB1c2goXCIvL1wiKSwoYj10aGlzLmViKSYmYS5wdXNoKCRlKGIsYWYsITApLFwiQFwiKSxhLnB1c2goZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyhjKSkucmVwbGFjZSgvJTI1KFswLTlhLWZBLUZdezJ9KS9nLFwiJSQxXCIpKSxjPXRoaXMudmIsbnVsbCE9YyYmYS5wdXNoKFwiOlwiLFN0cmluZyhjKSk7aWYoYz10aGlzLkdhKXRoaXMucGEmJlwiL1wiIT1jLmNoYXJBdCgwKSYmYS5wdXNoKFwiL1wiKSxhLnB1c2goJGUoYyxcIi9cIj09Yy5jaGFyQXQoMCk/YmY6Y2YsITApKTsoYz10aGlzLmVhLnRvU3RyaW5nKCkpJiZhLnB1c2goXCI/XCIsYyk7KGM9dGhpcy5QYSkmJmEucHVzaChcIiNcIiwkZShjLGRmKSk7cmV0dXJuIGEuam9pbihcIlwiKX07XG5TZS5wcm90b3R5cGUucmVzb2x2ZT1mdW5jdGlvbihhKXt2YXIgYj10aGlzLmNsb25lKCksYz0hIWEucWE7Yz9UZShiLGEucWEpOmM9ISFhLmViO2lmKGMpe3ZhciBkPWEuZWI7SihiKTtiLmViPWR9ZWxzZSBjPSEhYS5wYTtjP1VlKGIsYS5wYSk6Yz1udWxsIT1hLnZiO2Q9YS5HYTtpZihjKVZlKGIsYS52Yik7ZWxzZSBpZihjPSEhYS5HYSl7aWYoXCIvXCIhPWQuY2hhckF0KDApKWlmKHRoaXMucGEmJiF0aGlzLkdhKWQ9XCIvXCIrZDtlbHNle3ZhciBlPWIuR2EubGFzdEluZGV4T2YoXCIvXCIpOy0xIT1lJiYoZD1iLkdhLnN1YnN0cigwLGUrMSkrZCl9ZT1kO2lmKFwiLi5cIj09ZXx8XCIuXCI9PWUpZD1cIlwiO2Vsc2UgaWYodihlLFwiLi9cIil8fHYoZSxcIi8uXCIpKXtkPTA9PWUubGFzdEluZGV4T2YoXCIvXCIsMCk7ZT1lLnNwbGl0KFwiL1wiKTtmb3IodmFyIGY9W10sZz0wO2c8ZS5sZW5ndGg7KXt2YXIgbD1lW2crK107XCIuXCI9PWw/ZCYmZz09ZS5sZW5ndGgmJmYucHVzaChcIlwiKTpcIi4uXCI9PWw/KCgxPGYubGVuZ3RofHxcbjE9PWYubGVuZ3RoJiZcIlwiIT1mWzBdKSYmZi5wb3AoKSxkJiZnPT1lLmxlbmd0aCYmZi5wdXNoKFwiXCIpKTooZi5wdXNoKGwpLGQ9ITApfWQ9Zi5qb2luKFwiL1wiKX1lbHNlIGQ9ZX1jP1dlKGIsZCk6Yz1cIlwiIT09YS5lYS50b1N0cmluZygpO2M/WGUoYixhLmVhLmNsb25lKCkpOmM9ISFhLlBhO2MmJihhPWEuUGEsSihiKSxiLlBhPWEpO3JldHVybiBifTtTZS5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IFNlKHRoaXMpfTtcbnZhciBUZT1mdW5jdGlvbihhLGIsYyl7SihhKTthLnFhPWM/WWUoYiwhMCk6YjthLnFhJiYoYS5xYT1hLnFhLnJlcGxhY2UoLzokLyxcIlwiKSl9LFVlPWZ1bmN0aW9uKGEsYixjKXtKKGEpO2EucGE9Yz9ZZShiLCEwKTpifSxWZT1mdW5jdGlvbihhLGIpe0ooYSk7aWYoYil7Yj1OdW1iZXIoYik7aWYoaXNOYU4oYil8fDA+Yil0aHJvdyBFcnJvcihcIkJhZCBwb3J0IG51bWJlciBcIitiKTthLnZiPWJ9ZWxzZSBhLnZiPW51bGx9LFdlPWZ1bmN0aW9uKGEsYixjKXtKKGEpO2EuR2E9Yz9ZZShiLCEwKTpifSxYZT1mdW5jdGlvbihhLGIsYyl7SihhKTtiIGluc3RhbmNlb2YgWmU/KGEuZWE9YixhLmVhLiRkKGEuZGEpKTooY3x8KGI9JGUoYixlZikpLGEuZWE9bmV3IFplKGIsMCxhLmRhKSl9LEs9ZnVuY3Rpb24oYSxiLGMpe0ooYSk7YS5lYS5zZXQoYixjKX0sZmY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS5lYS5nZXQoYil9O1xuU2UucHJvdG90eXBlLnJlbW92ZVBhcmFtZXRlcj1mdW5jdGlvbihhKXtKKHRoaXMpO3RoaXMuZWEucmVtb3ZlKGEpO3JldHVybiB0aGlzfTt2YXIgSj1mdW5jdGlvbihhKXtpZihhLlhmKXRocm93IEVycm9yKFwiVHJpZWQgdG8gbW9kaWZ5IGEgcmVhZC1vbmx5IFVyaVwiKTt9O1NlLnByb3RvdHlwZS4kZD1mdW5jdGlvbihhKXt0aGlzLmRhPWE7dGhpcy5lYSYmdGhpcy5lYS4kZChhKTtyZXR1cm4gdGhpc307XG52YXIgZ2Y9ZnVuY3Rpb24oYSl7cmV0dXJuIGEgaW5zdGFuY2VvZiBTZT9hLmNsb25lKCk6bmV3IFNlKGEsdm9pZCAwKX0saGY9ZnVuY3Rpb24oYSxiKXt2YXIgYz1uZXcgU2UobnVsbCx2b2lkIDApO1RlKGMsXCJodHRwc1wiKTthJiZVZShjLGEpO2ImJldlKGMsYik7cmV0dXJuIGN9LFllPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGE/Yj9kZWNvZGVVUkkoYS5yZXBsYWNlKC8lMjUvZyxcIiUyNTI1XCIpKTpkZWNvZGVVUklDb21wb25lbnQoYSk6XCJcIn0sJGU9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBtKGEpPyhhPWVuY29kZVVSSShhKS5yZXBsYWNlKGIsamYpLGMmJihhPWEucmVwbGFjZSgvJTI1KFswLTlhLWZBLUZdezJ9KS9nLFwiJSQxXCIpKSxhKTpudWxsfSxqZj1mdW5jdGlvbihhKXthPWEuY2hhckNvZGVBdCgwKTtyZXR1cm5cIiVcIisoYT4+NCYxNSkudG9TdHJpbmcoMTYpKyhhJjE1KS50b1N0cmluZygxNil9LGFmPS9bI1xcL1xcP0BdL2csY2Y9L1sjXFw/Ol0vZyxiZj0vWyNcXD9dL2csZWY9L1sjXFw/QF0vZyxcbmRmPS8jL2csWmU9ZnVuY3Rpb24oYSxiLGMpe3RoaXMudT10aGlzLnM9bnVsbDt0aGlzLlg9YXx8bnVsbDt0aGlzLmRhPSEhY30sa2Y9ZnVuY3Rpb24oYSl7YS5zfHwoYS5zPW5ldyB1ZSxhLnU9MCxhLlgmJkRlKGEuWCxmdW5jdGlvbihiLGMpe2EuYWRkKGRlY29kZVVSSUNvbXBvbmVudChiLnJlcGxhY2UoL1xcKy9nLFwiIFwiKSksYyl9KSl9LG1mPWZ1bmN0aW9uKGEpe3ZhciBiPXllKGEpO2lmKFwidW5kZWZpbmVkXCI9PXR5cGVvZiBiKXRocm93IEVycm9yKFwiS2V5cyBhcmUgdW5kZWZpbmVkXCIpO3ZhciBjPW5ldyBaZShudWxsLDAsdm9pZCAwKTthPXhlKGEpO2Zvcih2YXIgZD0wO2Q8Yi5sZW5ndGg7ZCsrKXt2YXIgZT1iW2RdLGY9YVtkXTtoYShmKT9sZihjLGUsZik6Yy5hZGQoZSxmKX1yZXR1cm4gY307aD1aZS5wcm90b3R5cGU7XG5oLmFkZD1mdW5jdGlvbihhLGIpe2tmKHRoaXMpO3RoaXMuWD1udWxsO2E9dGhpcy5jYShhKTt2YXIgYz10aGlzLnMuZ2V0KGEpO2N8fHRoaXMucy5zZXQoYSxjPVtdKTtjLnB1c2goYik7dGhpcy51PUJhKHRoaXMudSkrMTtyZXR1cm4gdGhpc307aC5yZW1vdmU9ZnVuY3Rpb24oYSl7a2YodGhpcyk7YT10aGlzLmNhKGEpO3JldHVybiB0aGlzLnMuSmIoYSk/KHRoaXMuWD1udWxsLHRoaXMudT1CYSh0aGlzLnUpLXRoaXMucy5nZXQoYSkubGVuZ3RoLHRoaXMucy5yZW1vdmUoYSkpOiExfTtoLmNsZWFyPWZ1bmN0aW9uKCl7dGhpcy5zPXRoaXMuWD1udWxsO3RoaXMudT0wfTtoLkpiPWZ1bmN0aW9uKGEpe2tmKHRoaXMpO2E9dGhpcy5jYShhKTtyZXR1cm4gdGhpcy5zLkpiKGEpfTtoLmZvckVhY2g9ZnVuY3Rpb24oYSxiKXtrZih0aGlzKTt0aGlzLnMuZm9yRWFjaChmdW5jdGlvbihjLGQpe3goYyxmdW5jdGlvbihjKXthLmNhbGwoYixjLGQsdGhpcyl9LHRoaXMpfSx0aGlzKX07XG5oLnZhPWZ1bmN0aW9uKCl7a2YodGhpcyk7Zm9yKHZhciBhPXRoaXMucy5oYSgpLGI9dGhpcy5zLnZhKCksYz1bXSxkPTA7ZDxiLmxlbmd0aDtkKyspZm9yKHZhciBlPWFbZF0sZj0wO2Y8ZS5sZW5ndGg7ZisrKWMucHVzaChiW2RdKTtyZXR1cm4gY307aC5oYT1mdW5jdGlvbihhKXtrZih0aGlzKTt2YXIgYj1bXTtpZihtKGEpKXRoaXMuSmIoYSkmJihiPVphKGIsdGhpcy5zLmdldCh0aGlzLmNhKGEpKSkpO2Vsc2V7YT10aGlzLnMuaGEoKTtmb3IodmFyIGM9MDtjPGEubGVuZ3RoO2MrKyliPVphKGIsYVtjXSl9cmV0dXJuIGJ9O2guc2V0PWZ1bmN0aW9uKGEsYil7a2YodGhpcyk7dGhpcy5YPW51bGw7YT10aGlzLmNhKGEpO3RoaXMuSmIoYSkmJih0aGlzLnU9QmEodGhpcy51KS10aGlzLnMuZ2V0KGEpLmxlbmd0aCk7dGhpcy5zLnNldChhLFtiXSk7dGhpcy51PUJhKHRoaXMudSkrMTtyZXR1cm4gdGhpc307XG5oLmdldD1mdW5jdGlvbihhLGIpe2E9YT90aGlzLmhhKGEpOltdO3JldHVybiAwPGEubGVuZ3RoP1N0cmluZyhhWzBdKTpifTt2YXIgbGY9ZnVuY3Rpb24oYSxiLGMpe2EucmVtb3ZlKGIpOzA8Yy5sZW5ndGgmJihhLlg9bnVsbCxhLnMuc2V0KGEuY2EoYiksJGEoYykpLGEudT1CYShhLnUpK2MubGVuZ3RoKX07aD1aZS5wcm90b3R5cGU7aC50b1N0cmluZz1mdW5jdGlvbigpe2lmKHRoaXMuWClyZXR1cm4gdGhpcy5YO2lmKCF0aGlzLnMpcmV0dXJuXCJcIjtmb3IodmFyIGE9W10sYj10aGlzLnMudmEoKSxjPTA7YzxiLmxlbmd0aDtjKyspe3ZhciBkPWJbY10sZT1lbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKGQpKTtkPXRoaXMuaGEoZCk7Zm9yKHZhciBmPTA7ZjxkLmxlbmd0aDtmKyspe3ZhciBnPWU7XCJcIiE9PWRbZl0mJihnKz1cIj1cIitlbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKGRbZl0pKSk7YS5wdXNoKGcpfX1yZXR1cm4gdGhpcy5YPWEuam9pbihcIiZcIil9O1xuaC5jbG9uZT1mdW5jdGlvbigpe3ZhciBhPW5ldyBaZTthLlg9dGhpcy5YO3RoaXMucyYmKGEucz10aGlzLnMuY2xvbmUoKSxhLnU9dGhpcy51KTtyZXR1cm4gYX07aC5jYT1mdW5jdGlvbihhKXthPVN0cmluZyhhKTt0aGlzLmRhJiYoYT1hLnRvTG93ZXJDYXNlKCkpO3JldHVybiBhfTtoLiRkPWZ1bmN0aW9uKGEpe2EmJiF0aGlzLmRhJiYoa2YodGhpcyksdGhpcy5YPW51bGwsdGhpcy5zLmZvckVhY2goZnVuY3Rpb24oYSxjKXt2YXIgYj1jLnRvTG93ZXJDYXNlKCk7YyE9YiYmKHRoaXMucmVtb3ZlKGMpLGxmKHRoaXMsYixhKSl9LHRoaXMpKTt0aGlzLmRhPWF9O2guZXh0ZW5kPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj0wO2I8YXJndW1lbnRzLmxlbmd0aDtiKyspemUoYXJndW1lbnRzW2JdLGZ1bmN0aW9uKGEsYil7dGhpcy5hZGQoYixhKX0sdGhpcyl9O3ZhciBuZj17S2c6e3FkOlwiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vaWRlbnRpdHl0b29sa2l0L3YzL3JlbHlpbmdwYXJ0eS9cIixXZDpcImh0dHBzOi8vc2VjdXJldG9rZW4uZ29vZ2xlYXBpcy5jb20vdjEvdG9rZW5cIixpZDpcInBcIn0sTGc6e3FkOlwiaHR0cHM6Ly9zdGFnaW5nLXd3dy5zYW5kYm94Lmdvb2dsZWFwaXMuY29tL2lkZW50aXR5dG9vbGtpdC92My9yZWx5aW5ncGFydHkvXCIsV2Q6XCJodHRwczovL3N0YWdpbmctc2VjdXJldG9rZW4uc2FuZGJveC5nb29nbGVhcGlzLmNvbS92MS90b2tlblwiLGlkOlwic1wifSxNZzp7cWQ6XCJodHRwczovL3d3dy1nb29nbGVhcGlzLXRlc3Quc2FuZGJveC5nb29nbGUuY29tL2lkZW50aXR5dG9vbGtpdC92My9yZWx5aW5ncGFydHkvXCIsV2Q6XCJodHRwczovL3Rlc3Qtc2VjdXJldG9rZW4uc2FuZGJveC5nb29nbGVhcGlzLmNvbS92MS90b2tlblwiLGlkOlwidFwifX0sb2Y9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiIGluIG5mKWlmKG5mW2JdLmlkPT09YSlyZXR1cm4gYT1cbm5mW2JdLHtmaXJlYmFzZUVuZHBvaW50OmEucWQsc2VjdXJlVG9rZW5FbmRwb2ludDphLldkfTtyZXR1cm4gbnVsbH0scGY7cGY9b2YoXCJfX0VJRF9fXCIpP1wiX19FSURfX1wiOnZvaWQgMDt2YXIgcWY9ZnVuY3Rpb24oKXt2YXIgYT1MKCk7cmV0dXJuIHomJiEhQ2ImJjExPT1DYnx8L0VkZ2VcXC9cXGQrLy50ZXN0KGEpfSxyZj1mdW5jdGlvbigpe3JldHVybiBrLndpbmRvdyYmay53aW5kb3cubG9jYXRpb24uaHJlZnx8XCJcIn0sc2Y9ZnVuY3Rpb24oYSxiKXtiPWJ8fGsud2luZG93O3ZhciBjPVwiYWJvdXQ6YmxhbmtcIjthJiYoYz1CYyhFYyhhKSkpO2IubG9jYXRpb24uaHJlZj1jfSx0Zj1mdW5jdGlvbihhLGIpe3ZhciBjPVtdLGQ7Zm9yKGQgaW4gYSlkIGluIGI/dHlwZW9mIGFbZF0hPXR5cGVvZiBiW2RdP2MucHVzaChkKTpoYShhW2RdKT9qYihhW2RdLGJbZF0pfHxjLnB1c2goZCk6XCJvYmplY3RcIj09dHlwZW9mIGFbZF0mJm51bGwhPWFbZF0mJm51bGwhPWJbZF0/MDx0ZihhW2RdLGJbZF0pLmxlbmd0aCYmYy5wdXNoKGQpOmFbZF0hPT1iW2RdJiZjLnB1c2goZCk6Yy5wdXNoKGQpO2ZvcihkIGluIGIpZCBpbiBhfHxjLnB1c2goZCk7cmV0dXJuIGN9LHZmPWZ1bmN0aW9uKCl7dmFyIGE9XG5MKCk7YT1cIkNocm9tZVwiIT11ZihhKT9udWxsOihhPWEubWF0Y2goL1xcc0Nocm9tZVxcLyhcXGQrKS9pKSkmJjI9PWEubGVuZ3RoP3BhcnNlSW50KGFbMV0sMTApOm51bGw7cmV0dXJuIGEmJjMwPmE/ITE6IXp8fCFDYnx8OTxDYn0sd2Y9ZnVuY3Rpb24oYSl7YT0oYXx8TCgpKS50b0xvd2VyQ2FzZSgpO3JldHVybiBhLm1hdGNoKC9hbmRyb2lkLyl8fGEubWF0Y2goL3dlYm9zLyl8fGEubWF0Y2goL2lwaG9uZXxpcGFkfGlwb2QvKXx8YS5tYXRjaCgvYmxhY2tiZXJyeS8pfHxhLm1hdGNoKC93aW5kb3dzIHBob25lLyl8fGEubWF0Y2goL2llbW9iaWxlLyk/ITA6ITF9LHhmPWZ1bmN0aW9uKGEpe2E9YXx8ay53aW5kb3c7dHJ5e2EuY2xvc2UoKX1jYXRjaChiKXt9fSx5Zj1mdW5jdGlvbihhLGIsYyl7dmFyIGQ9TWF0aC5mbG9vcigxRTkqTWF0aC5yYW5kb20oKSkudG9TdHJpbmcoKTtiPWJ8fDUwMDtjPWN8fDYwMDt2YXIgZT0od2luZG93LnNjcmVlbi5hdmFpbEhlaWdodC1jKS8yLGY9KHdpbmRvdy5zY3JlZW4uYXZhaWxXaWR0aC1cbmIpLzI7Yj17d2lkdGg6YixoZWlnaHQ6Yyx0b3A6MDxlP2U6MCxsZWZ0OjA8Zj9mOjAsbG9jYXRpb246ITAscmVzaXphYmxlOiEwLHN0YXR1c2JhcjohMCx0b29sYmFyOiExfTtjPUwoKS50b0xvd2VyQ2FzZSgpO2QmJihiLnRhcmdldD1kLHYoYyxcImNyaW9zL1wiKSYmKGIudGFyZ2V0PVwiX2JsYW5rXCIpKTtcIkZpcmVmb3hcIj09dWYoTCgpKSYmKGE9YXx8XCJodHRwOi8vbG9jYWxob3N0XCIsYi5zY3JvbGxiYXJzPSEwKTtjPWF8fFwiXCI7KGE9Yil8fChhPXt9KTtkPXdpbmRvdztiPWMgaW5zdGFuY2VvZiBBYz9jOkVjKFwidW5kZWZpbmVkXCIhPXR5cGVvZiBjLmhyZWY/Yy5ocmVmOlN0cmluZyhjKSk7Yz1hLnRhcmdldHx8Yy50YXJnZXQ7ZT1bXTtmb3IoZyBpbiBhKXN3aXRjaChnKXtjYXNlIFwid2lkdGhcIjpjYXNlIFwiaGVpZ2h0XCI6Y2FzZSBcInRvcFwiOmNhc2UgXCJsZWZ0XCI6ZS5wdXNoKGcrXCI9XCIrYVtnXSk7YnJlYWs7Y2FzZSBcInRhcmdldFwiOmNhc2UgXCJub29wZW5lclwiOmNhc2UgXCJub3JlZmVycmVyXCI6YnJlYWs7XG5kZWZhdWx0OmUucHVzaChnK1wiPVwiKyhhW2ddPzE6MCkpfXZhciBnPWUuam9pbihcIixcIik7KHkoXCJpUGhvbmVcIikmJiF5KFwiaVBvZFwiKSYmIXkoXCJpUGFkXCIpfHx5KFwiaVBhZFwiKXx8eShcImlQb2RcIikpJiZkLm5hdmlnYXRvciYmZC5uYXZpZ2F0b3Iuc3RhbmRhbG9uZSYmYyYmXCJfc2VsZlwiIT1jPyhnPWQuZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIkFcIiksZmQoZyxcIkhUTUxBbmNob3JFbGVtZW50XCIpLGIgaW5zdGFuY2VvZiBBY3x8YiBpbnN0YW5jZW9mIEFjfHwoYj1iLnFiP2Iub2IoKTpTdHJpbmcoYiksdyhDYy50ZXN0KGIpKXx8KGI9XCJhYm91dDppbnZhbGlkI3pDbG9zdXJlelwiKSxiPURjKGIpKSxnLmhyZWY9QmMoYiksZy5zZXRBdHRyaWJ1dGUoXCJ0YXJnZXRcIixjKSxhLm5vcmVmZXJyZXImJmcuc2V0QXR0cmlidXRlKFwicmVsXCIsXCJub3JlZmVycmVyXCIpLGE9ZG9jdW1lbnQuY3JlYXRlRXZlbnQoXCJNb3VzZUV2ZW50XCIpLGEuaW5pdE1vdXNlRXZlbnQoXCJjbGlja1wiLCEwLCEwLGQsMSksZy5kaXNwYXRjaEV2ZW50KGEpLFxuZz17fSk6YS5ub3JlZmVycmVyPyhnPWQub3BlbihcIlwiLGMsZyksZD1CYyhiKSxnJiYoc2ImJnYoZCxcIjtcIikmJihkPVwiJ1wiK2QucmVwbGFjZSgvJy9nLFwiJTI3XCIpK1wiJ1wiKSxnLm9wZW5lcj1udWxsLGE9SGEoXCJiLzEyMDE0NDEyLCBtZXRhIHRhZyB3aXRoIHNhbml0aXplZCBVUkxcIiksZD0nPE1FVEEgSFRUUC1FUVVJVj1cInJlZnJlc2hcIiBjb250ZW50PVwiMDsgdXJsPScrd2EoZCkrJ1wiPicsQ2EoR2EoYSksXCJtdXN0IHByb3ZpZGUganVzdGlmaWNhdGlvblwiKSx3KCEvXltcXHNcXHhhMF0qJC8udGVzdChHYShhKSksXCJtdXN0IHByb3ZpZGUgbm9uLWVtcHR5IGp1c3RpZmljYXRpb25cIiksZy5kb2N1bWVudC53cml0ZShqZCgobmV3IGlkKS5UZihkKSkpLGcuZG9jdW1lbnQuY2xvc2UoKSkpOihnPWQub3BlbihCYyhiKSxjLGcpKSYmYS5ub29wZW5lciYmKGcub3BlbmVyPW51bGwpO2lmKGcpdHJ5e2cuZm9jdXMoKX1jYXRjaChsKXt9cmV0dXJuIGd9LHpmPWZ1bmN0aW9uKGEpe3JldHVybiBuZXcgQyhmdW5jdGlvbihiKXt2YXIgYz1cbmZ1bmN0aW9uKCl7QmUoMkUzKS50aGVuKGZ1bmN0aW9uKCl7aWYoIWF8fGEuY2xvc2VkKWIoKTtlbHNlIHJldHVybiBjKCl9KX07cmV0dXJuIGMoKX0pfSxBZj0vXlxcZHsxLDN9XFwuXFxkezEsM31cXC5cXGR7MSwzfVxcLlxcZHsxLDN9JC8sQmY9ZnVuY3Rpb24oKXt2YXIgYT1udWxsO3JldHVybihuZXcgQyhmdW5jdGlvbihiKXtcImNvbXBsZXRlXCI9PWsuZG9jdW1lbnQucmVhZHlTdGF0ZT9iKCk6KGE9ZnVuY3Rpb24oKXtiKCl9LGtjKHdpbmRvdyxcImxvYWRcIixhKSl9KSkuZyhmdW5jdGlvbihiKXt0Yyh3aW5kb3csXCJsb2FkXCIsYSk7dGhyb3cgYjt9KX0sRGY9ZnVuY3Rpb24oKXtyZXR1cm4gQ2Yodm9pZCAwKT9CZigpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gbmV3IEMoZnVuY3Rpb24oYSxiKXt2YXIgYz1rLmRvY3VtZW50LGQ9c2V0VGltZW91dChmdW5jdGlvbigpe2IoRXJyb3IoXCJDb3Jkb3ZhIGZyYW1ld29yayBpcyBub3QgcmVhZHkuXCIpKX0sMUUzKTtjLmFkZEV2ZW50TGlzdGVuZXIoXCJkZXZpY2VyZWFkeVwiLFxuZnVuY3Rpb24oKXtjbGVhclRpbWVvdXQoZCk7YSgpfSwhMSl9KX0pOkUoRXJyb3IoXCJDb3Jkb3ZhIG11c3QgcnVuIGluIGFuIEFuZHJvaWQgb3IgaU9TIGZpbGUgc2NoZW1lLlwiKSl9LENmPWZ1bmN0aW9uKGEpe2E9YXx8TCgpO3JldHVybiEoXCJmaWxlOlwiIT09RWYoKXx8IWEudG9Mb3dlckNhc2UoKS5tYXRjaCgvaXBob25lfGlwYWR8aXBvZHxhbmRyb2lkLykpfSxGZj1mdW5jdGlvbigpe3ZhciBhPWsud2luZG93O3RyeXtyZXR1cm4hKCFhfHxhPT1hLnRvcCl9Y2F0Y2goYil7cmV0dXJuITF9fSxHZj1mdW5jdGlvbigpe3JldHVybiBmaXJlYmFzZS5JTlRFUk5BTC5oYXNPd25Qcm9wZXJ0eShcInJlYWN0TmF0aXZlXCIpP1wiUmVhY3ROYXRpdmVcIjpmaXJlYmFzZS5JTlRFUk5BTC5oYXNPd25Qcm9wZXJ0eShcIm5vZGVcIik/XCJOb2RlXCI6XCJCcm93c2VyXCJ9LEhmPWZ1bmN0aW9uKCl7dmFyIGE9R2YoKTtyZXR1cm5cIlJlYWN0TmF0aXZlXCI9PT1hfHxcIk5vZGVcIj09PWF9LHVmPWZ1bmN0aW9uKGEpe3ZhciBiPVxuYS50b0xvd2VyQ2FzZSgpO2lmKHYoYixcIm9wZXJhL1wiKXx8dihiLFwib3ByL1wiKXx8dihiLFwib3Bpb3MvXCIpKXJldHVyblwiT3BlcmFcIjtpZih2KGIsXCJpZW1vYmlsZVwiKSlyZXR1cm5cIklFTW9iaWxlXCI7aWYodihiLFwibXNpZVwiKXx8dihiLFwidHJpZGVudC9cIikpcmV0dXJuXCJJRVwiO2lmKHYoYixcImVkZ2UvXCIpKXJldHVyblwiRWRnZVwiO2lmKHYoYixcImZpcmVmb3gvXCIpKXJldHVyblwiRmlyZWZveFwiO2lmKHYoYixcInNpbGsvXCIpKXJldHVyblwiU2lsa1wiO2lmKHYoYixcImJsYWNrYmVycnlcIikpcmV0dXJuXCJCbGFja2JlcnJ5XCI7aWYodihiLFwid2Vib3NcIikpcmV0dXJuXCJXZWJvc1wiO2lmKCF2KGIsXCJzYWZhcmkvXCIpfHx2KGIsXCJjaHJvbWUvXCIpfHx2KGIsXCJjcmlvcy9cIil8fHYoYixcImFuZHJvaWRcIikpaWYoIXYoYixcImNocm9tZS9cIikmJiF2KGIsXCJjcmlvcy9cIil8fHYoYixcImVkZ2UvXCIpKXtpZih2KGIsXCJhbmRyb2lkXCIpKXJldHVyblwiQW5kcm9pZFwiO2lmKChhPWEubWF0Y2goLyhbYS16QS1aXFxkXFwuXSspXFwvW2EtekEtWlxcZFxcLl0qJC8pKSYmXG4yPT1hLmxlbmd0aClyZXR1cm4gYVsxXX1lbHNlIHJldHVyblwiQ2hyb21lXCI7ZWxzZSByZXR1cm5cIlNhZmFyaVwiO3JldHVyblwiT3RoZXJcIn0sSWY9e0ZnOlwiRmlyZWJhc2VDb3JlLXdlYlwiLEhnOlwiRmlyZWJhc2VVSS13ZWJcIn0sSmY9ZnVuY3Rpb24oYSxiKXtiPWJ8fFtdO3ZhciBjPVtdLGQ9e30sZTtmb3IoZSBpbiBJZilkW0lmW2VdXT0hMDtmb3IoZT0wO2U8Yi5sZW5ndGg7ZSsrKVwidW5kZWZpbmVkXCIhPT10eXBlb2YgZFtiW2VdXSYmKGRlbGV0ZSBkW2JbZV1dLGMucHVzaChiW2VdKSk7Yy5zb3J0KCk7Yj1jO2IubGVuZ3RofHwoYj1bXCJGaXJlYmFzZUNvcmUtd2ViXCJdKTtjPUdmKCk7cmV0dXJuKFwiQnJvd3NlclwiPT09Yz91ZihMKCkpOmMpK1wiL0pzQ29yZS9cIithK1wiL1wiK2Iuam9pbihcIixcIil9LEw9ZnVuY3Rpb24oKXtyZXR1cm4gay5uYXZpZ2F0b3ImJmsubmF2aWdhdG9yLnVzZXJBZ2VudHx8XCJcIn0sTT1mdW5jdGlvbihhLGIpe2E9YS5zcGxpdChcIi5cIik7Yj1ifHxrO2Zvcih2YXIgYz0wO2M8XG5hLmxlbmd0aCYmXCJvYmplY3RcIj09dHlwZW9mIGImJm51bGwhPWI7YysrKWI9YlthW2NdXTtjIT1hLmxlbmd0aCYmKGI9dm9pZCAwKTtyZXR1cm4gYn0sTGY9ZnVuY3Rpb24oKXt0cnl7dmFyIGE9ay5sb2NhbFN0b3JhZ2UsYj1LZigpO2lmKGEpcmV0dXJuIGEuc2V0SXRlbShiLFwiMVwiKSxhLnJlbW92ZUl0ZW0oYikscWYoKT8hIWsuaW5kZXhlZERCOiEwfWNhdGNoKGMpe31yZXR1cm4hMX0sTmY9ZnVuY3Rpb24oKXtyZXR1cm4oTWYoKXx8XCJjaHJvbWUtZXh0ZW5zaW9uOlwiPT09RWYoKXx8Q2YoKSkmJiFIZigpJiZMZigpfSxNZj1mdW5jdGlvbigpe3JldHVyblwiaHR0cDpcIj09PUVmKCl8fFwiaHR0cHM6XCI9PT1FZigpfSxFZj1mdW5jdGlvbigpe3JldHVybiBrLmxvY2F0aW9uJiZrLmxvY2F0aW9uLnByb3RvY29sfHxudWxsfSxPZj1mdW5jdGlvbihhKXthPWF8fEwoKTtyZXR1cm4gd2YoYSl8fFwiRmlyZWZveFwiPT11ZihhKT8hMTohMH0sUGY9ZnVuY3Rpb24oYSl7cmV0dXJuXCJ1bmRlZmluZWRcIj09PVxudHlwZW9mIGE/bnVsbDpIYyhhKX0sUWY9ZnVuY3Rpb24oYSl7dmFyIGI9e30sYztmb3IoYyBpbiBhKWEuaGFzT3duUHJvcGVydHkoYykmJm51bGwhPT1hW2NdJiZ2b2lkIDAhPT1hW2NdJiYoYltjXT1hW2NdKTtyZXR1cm4gYn0sUmY9ZnVuY3Rpb24oYSl7aWYobnVsbCE9PWEpcmV0dXJuIEpTT04ucGFyc2UoYSl9LEtmPWZ1bmN0aW9uKGEpe3JldHVybiBhP2E6XCJcIitNYXRoLmZsb29yKDFFOSpNYXRoLnJhbmRvbSgpKS50b1N0cmluZygpfSxTZj1mdW5jdGlvbihhKXthPWF8fEwoKTtyZXR1cm5cIlNhZmFyaVwiPT11ZihhKXx8YS50b0xvd2VyQ2FzZSgpLm1hdGNoKC9pcGhvbmV8aXBhZHxpcG9kLyk/ITE6ITB9LFRmPWZ1bmN0aW9uKCl7dmFyIGE9ay5fX19qc2w7aWYoYSYmYS5IKWZvcih2YXIgYiBpbiBhLkgpaWYoYS5IW2JdLnI9YS5IW2JdLnJ8fFtdLGEuSFtiXS5MPWEuSFtiXS5MfHxbXSxhLkhbYl0ucj1hLkhbYl0uTC5jb25jYXQoKSxhLkNQKWZvcih2YXIgYz0wO2M8YS5DUC5sZW5ndGg7YysrKWEuQ1BbY109XG5udWxsfSxVZj1mdW5jdGlvbigpe3ZhciBhPWsubmF2aWdhdG9yO3JldHVybiBhJiZcImJvb2xlYW5cIj09PXR5cGVvZiBhLm9uTGluZSYmKE1mKCl8fFwiY2hyb21lLWV4dGVuc2lvbjpcIj09PUVmKCl8fFwidW5kZWZpbmVkXCIhPT10eXBlb2YgYS5jb25uZWN0aW9uKT9hLm9uTGluZTohMH0sVmY9ZnVuY3Rpb24oYSxiLGMsZCl7aWYoYT5iKXRocm93IEVycm9yKFwiU2hvcnQgZGVsYXkgc2hvdWxkIGJlIGxlc3MgdGhhbiBsb25nIGRlbGF5IVwiKTt0aGlzLnVnPWE7dGhpcy5hZz1iO2E9Y3x8TCgpO2Q9ZHx8R2YoKTt0aGlzLldmPXdmKGEpfHxcIlJlYWN0TmF0aXZlXCI9PT1kfTtWZi5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuV2Y/dGhpcy5hZzp0aGlzLnVnfTtcbnZhciBXZj1mdW5jdGlvbigpe3ZhciBhPWsuZG9jdW1lbnQ7cmV0dXJuIGEmJlwidW5kZWZpbmVkXCIhPT10eXBlb2YgYS52aXNpYmlsaXR5U3RhdGU/XCJ2aXNpYmxlXCI9PWEudmlzaWJpbGl0eVN0YXRlOiEwfSxYZj1mdW5jdGlvbigpe3ZhciBhPWsuZG9jdW1lbnQsYj1udWxsO3JldHVybiBXZigpfHwhYT9EKCk6KG5ldyBDKGZ1bmN0aW9uKGMpe2I9ZnVuY3Rpb24oKXtXZigpJiYoYS5yZW1vdmVFdmVudExpc3RlbmVyKFwidmlzaWJpbGl0eWNoYW5nZVwiLGIsITEpLGMoKSl9O2EuYWRkRXZlbnRMaXN0ZW5lcihcInZpc2liaWxpdHljaGFuZ2VcIixiLCExKX0pKS5nKGZ1bmN0aW9uKGMpe2EucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInZpc2liaWxpdHljaGFuZ2VcIixiLCExKTt0aHJvdyBjO30pfSxZZj1mdW5jdGlvbihhKXt0cnl7dmFyIGI9bmV3IERhdGUocGFyc2VJbnQoYSwxMCkpO2lmKCFpc05hTihiLmdldFRpbWUoKSkmJiEvW14wLTldLy50ZXN0KGEpKXJldHVybiBiLnRvVVRDU3RyaW5nKCl9Y2F0Y2goYyl7fXJldHVybiBudWxsfTt2YXIgWmY9e307dmFyICRmO3RyeXt2YXIgYWc9e307T2JqZWN0LmRlZmluZVByb3BlcnR5KGFnLFwiYWJjZFwiLHtjb25maWd1cmFibGU6ITAsZW51bWVyYWJsZTohMCx2YWx1ZToxfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGFnLFwiYWJjZFwiLHtjb25maWd1cmFibGU6ITAsZW51bWVyYWJsZTohMCx2YWx1ZToyfSk7JGY9Mj09YWcuYWJjZH1jYXRjaChhKXskZj0hMX1cbnZhciBOPWZ1bmN0aW9uKGEsYixjKXskZj9PYmplY3QuZGVmaW5lUHJvcGVydHkoYSxiLHtjb25maWd1cmFibGU6ITAsZW51bWVyYWJsZTohMCx2YWx1ZTpjfSk6YVtiXT1jfSxiZz1mdW5jdGlvbihhLGIpe2lmKGIpZm9yKHZhciBjIGluIGIpYi5oYXNPd25Qcm9wZXJ0eShjKSYmTihhLGMsYltjXSl9LGNnPWZ1bmN0aW9uKGEpe3ZhciBiPXt9O2JnKGIsYSk7cmV0dXJuIGJ9LGRnPWZ1bmN0aW9uKGEpe3ZhciBiPXt9LGM7Zm9yKGMgaW4gYSlhLmhhc093blByb3BlcnR5KGMpJiYoYltjXT1hW2NdKTtyZXR1cm4gYn0sZWc9ZnVuY3Rpb24oYSxiKXtpZighYnx8IWIubGVuZ3RoKXJldHVybiEwO2lmKCFhKXJldHVybiExO2Zvcih2YXIgYz0wO2M8Yi5sZW5ndGg7YysrKXt2YXIgZD1hW2JbY11dO2lmKHZvaWQgMD09PWR8fG51bGw9PT1kfHxcIlwiPT09ZClyZXR1cm4hMX1yZXR1cm4hMH0sZmc9ZnVuY3Rpb24oYSl7dmFyIGI9YTtpZihcIm9iamVjdFwiPT10eXBlb2YgYSYmbnVsbCE9YSl7Yj1cblwibGVuZ3RoXCJpbiBhP1tdOnt9O2Zvcih2YXIgYyBpbiBhKU4oYixjLGZnKGFbY10pKX1yZXR1cm4gYn07dmFyIGdnPVwib2F1dGhfY29uc3VtZXJfa2V5IG9hdXRoX25vbmNlIG9hdXRoX3NpZ25hdHVyZSBvYXV0aF9zaWduYXR1cmVfbWV0aG9kIG9hdXRoX3RpbWVzdGFtcCBvYXV0aF90b2tlbiBvYXV0aF92ZXJzaW9uXCIuc3BsaXQoXCIgXCIpLGhnPVtcImNsaWVudF9pZFwiLFwicmVzcG9uc2VfdHlwZVwiLFwic2NvcGVcIixcInJlZGlyZWN0X3VyaVwiLFwic3RhdGVcIl0saWc9e0dnOntEYzpcImxvY2FsZVwiLFpiOjUwMCxZYjo2MDAscHJvdmlkZXJJZDpcImZhY2Vib29rLmNvbVwiLFVkOmhnfSxJZzp7RGM6bnVsbCxaYjo1MDAsWWI6NjIwLHByb3ZpZGVySWQ6XCJnaXRodWIuY29tXCIsVWQ6aGd9LEpnOntEYzpcImhsXCIsWmI6NTE1LFliOjY4MCxwcm92aWRlcklkOlwiZ29vZ2xlLmNvbVwiLFVkOmhnfSxOZzp7RGM6XCJsYW5nXCIsWmI6NDg1LFliOjcwNSxwcm92aWRlcklkOlwidHdpdHRlci5jb21cIixVZDpnZ319LGpnPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYiBpbiBpZylpZihpZ1tiXS5wcm92aWRlcklkPT1hKXJldHVybiBpZ1tiXTtcbnJldHVybiBudWxsfTt2YXIgTz1mdW5jdGlvbihhLGIpe3RoaXMuY29kZT1cImF1dGgvXCIrYTt0aGlzLm1lc3NhZ2U9Ynx8a2dbYV18fFwiXCJ9O3QoTyxFcnJvcik7Ty5wcm90b3R5cGUuQT1mdW5jdGlvbigpe3JldHVybntjb2RlOnRoaXMuY29kZSxtZXNzYWdlOnRoaXMubWVzc2FnZX19O08ucHJvdG90eXBlLnRvSlNPTj1mdW5jdGlvbigpe3JldHVybiB0aGlzLkEoKX07XG52YXIgbGc9ZnVuY3Rpb24oYSl7dmFyIGI9YSYmYS5jb2RlO3JldHVybiBiP25ldyBPKGIuc3Vic3RyaW5nKDUpLGEubWVzc2FnZSk6bnVsbH0sa2c9e1wiYXJndW1lbnQtZXJyb3JcIjpcIlwiLFwiYXBwLW5vdC1hdXRob3JpemVkXCI6XCJUaGlzIGFwcCwgaWRlbnRpZmllZCBieSB0aGUgZG9tYWluIHdoZXJlIGl0J3MgaG9zdGVkLCBpcyBub3QgYXV0aG9yaXplZCB0byB1c2UgRmlyZWJhc2UgQXV0aGVudGljYXRpb24gd2l0aCB0aGUgcHJvdmlkZWQgQVBJIGtleS4gUmV2aWV3IHlvdXIga2V5IGNvbmZpZ3VyYXRpb24gaW4gdGhlIEdvb2dsZSBBUEkgY29uc29sZS5cIixcImFwcC1ub3QtaW5zdGFsbGVkXCI6XCJUaGUgcmVxdWVzdGVkIG1vYmlsZSBhcHBsaWNhdGlvbiBjb3JyZXNwb25kaW5nIHRvIHRoZSBpZGVudGlmaWVyIChBbmRyb2lkIHBhY2thZ2UgbmFtZSBvciBpT1MgYnVuZGxlIElEKSBwcm92aWRlZCBpcyBub3QgaW5zdGFsbGVkIG9uIHRoaXMgZGV2aWNlLlwiLFwiY2FwdGNoYS1jaGVjay1mYWlsZWRcIjpcIlRoZSByZUNBUFRDSEEgcmVzcG9uc2UgdG9rZW4gcHJvdmlkZWQgaXMgZWl0aGVyIGludmFsaWQsIGV4cGlyZWQsIGFscmVhZHkgdXNlZCBvciB0aGUgZG9tYWluIGFzc29jaWF0ZWQgd2l0aCBpdCBkb2VzIG5vdCBtYXRjaCB0aGUgbGlzdCBvZiB3aGl0ZWxpc3RlZCBkb21haW5zLlwiLFxuXCJjb2RlLWV4cGlyZWRcIjpcIlRoZSBTTVMgY29kZSBoYXMgZXhwaXJlZC4gUGxlYXNlIHJlLXNlbmQgdGhlIHZlcmlmaWNhdGlvbiBjb2RlIHRvIHRyeSBhZ2Fpbi5cIixcImNvcmRvdmEtbm90LXJlYWR5XCI6XCJDb3Jkb3ZhIGZyYW1ld29yayBpcyBub3QgcmVhZHkuXCIsXCJjb3JzLXVuc3VwcG9ydGVkXCI6XCJUaGlzIGJyb3dzZXIgaXMgbm90IHN1cHBvcnRlZC5cIixcImNyZWRlbnRpYWwtYWxyZWFkeS1pbi11c2VcIjpcIlRoaXMgY3JlZGVudGlhbCBpcyBhbHJlYWR5IGFzc29jaWF0ZWQgd2l0aCBhIGRpZmZlcmVudCB1c2VyIGFjY291bnQuXCIsXCJjdXN0b20tdG9rZW4tbWlzbWF0Y2hcIjpcIlRoZSBjdXN0b20gdG9rZW4gY29ycmVzcG9uZHMgdG8gYSBkaWZmZXJlbnQgYXVkaWVuY2UuXCIsXCJyZXF1aXJlcy1yZWNlbnQtbG9naW5cIjpcIlRoaXMgb3BlcmF0aW9uIGlzIHNlbnNpdGl2ZSBhbmQgcmVxdWlyZXMgcmVjZW50IGF1dGhlbnRpY2F0aW9uLiBMb2cgaW4gYWdhaW4gYmVmb3JlIHJldHJ5aW5nIHRoaXMgcmVxdWVzdC5cIixcblwiZHluYW1pYy1saW5rLW5vdC1hY3RpdmF0ZWRcIjpcIlBsZWFzZSBhY3RpdmF0ZSBEeW5hbWljIExpbmtzIGluIHRoZSBGaXJlYmFzZSBDb25zb2xlIGFuZCBhZ3JlZSB0byB0aGUgdGVybXMgYW5kIGNvbmRpdGlvbnMuXCIsXCJlbWFpbC1hbHJlYWR5LWluLXVzZVwiOlwiVGhlIGVtYWlsIGFkZHJlc3MgaXMgYWxyZWFkeSBpbiB1c2UgYnkgYW5vdGhlciBhY2NvdW50LlwiLFwiZXhwaXJlZC1hY3Rpb24tY29kZVwiOlwiVGhlIGFjdGlvbiBjb2RlIGhhcyBleHBpcmVkLiBcIixcImNhbmNlbGxlZC1wb3B1cC1yZXF1ZXN0XCI6XCJUaGlzIG9wZXJhdGlvbiBoYXMgYmVlbiBjYW5jZWxsZWQgZHVlIHRvIGFub3RoZXIgY29uZmxpY3RpbmcgcG9wdXAgYmVpbmcgb3BlbmVkLlwiLFwiaW50ZXJuYWwtZXJyb3JcIjpcIkFuIGludGVybmFsIGVycm9yIGhhcyBvY2N1cnJlZC5cIixcImludmFsaWQtYXBwLWNyZWRlbnRpYWxcIjpcIlRoZSBwaG9uZSB2ZXJpZmljYXRpb24gcmVxdWVzdCBjb250YWlucyBhbiBpbnZhbGlkIGFwcGxpY2F0aW9uIHZlcmlmaWVyLiBUaGUgcmVDQVBUQ0hBIHRva2VuIHJlc3BvbnNlIGlzIGVpdGhlciBpbnZhbGlkIG9yIGV4cGlyZWQuXCIsXG5cImludmFsaWQtYXBwLWlkXCI6XCJUaGUgbW9iaWxlIGFwcCBpZGVudGlmaWVyIGlzIG5vdCByZWdpc3RlZCBmb3IgdGhlIGN1cnJlbnQgcHJvamVjdC5cIixcImludmFsaWQtdXNlci10b2tlblwiOlwiVGhlIHVzZXIncyBjcmVkZW50aWFsIGlzIG5vIGxvbmdlciB2YWxpZC4gVGhlIHVzZXIgbXVzdCBzaWduIGluIGFnYWluLlwiLFwiaW52YWxpZC1hdXRoLWV2ZW50XCI6XCJBbiBpbnRlcm5hbCBlcnJvciBoYXMgb2NjdXJyZWQuXCIsXCJpbnZhbGlkLXZlcmlmaWNhdGlvbi1jb2RlXCI6XCJUaGUgU01TIHZlcmlmaWNhdGlvbiBjb2RlIHVzZWQgdG8gY3JlYXRlIHRoZSBwaG9uZSBhdXRoIGNyZWRlbnRpYWwgaXMgaW52YWxpZC4gUGxlYXNlIHJlc2VuZCB0aGUgdmVyaWZpY2F0aW9uIGNvZGUgc21zIGFuZCBiZSBzdXJlIHVzZSB0aGUgdmVyaWZpY2F0aW9uIGNvZGUgcHJvdmlkZWQgYnkgdGhlIHVzZXIuXCIsXCJpbnZhbGlkLWNvbnRpbnVlLXVyaVwiOlwiVGhlIGNvbnRpbnVlIFVSTCBwcm92aWRlZCBpbiB0aGUgcmVxdWVzdCBpcyBpbnZhbGlkLlwiLFxuXCJpbnZhbGlkLWNvcmRvdmEtY29uZmlndXJhdGlvblwiOlwiVGhlIGZvbGxvd2luZyBDb3Jkb3ZhIHBsdWdpbnMgbXVzdCBiZSBpbnN0YWxsZWQgdG8gZW5hYmxlIE9BdXRoIHNpZ24taW46IGNvcmRvdmEtcGx1Z2luLWJ1aWxkaW5mbywgY29yZG92YS11bml2ZXJzYWwtbGlua3MtcGx1Z2luLCBjb3Jkb3ZhLXBsdWdpbi1icm93c2VydGFiLCBjb3Jkb3ZhLXBsdWdpbi1pbmFwcGJyb3dzZXIgYW5kIGNvcmRvdmEtcGx1Z2luLWN1c3RvbXVybHNjaGVtZS5cIixcImludmFsaWQtY3VzdG9tLXRva2VuXCI6XCJUaGUgY3VzdG9tIHRva2VuIGZvcm1hdCBpcyBpbmNvcnJlY3QuIFBsZWFzZSBjaGVjayB0aGUgZG9jdW1lbnRhdGlvbi5cIixcImludmFsaWQtZW1haWxcIjpcIlRoZSBlbWFpbCBhZGRyZXNzIGlzIGJhZGx5IGZvcm1hdHRlZC5cIixcImludmFsaWQtYXBpLWtleVwiOlwiWW91ciBBUEkga2V5IGlzIGludmFsaWQsIHBsZWFzZSBjaGVjayB5b3UgaGF2ZSBjb3BpZWQgaXQgY29ycmVjdGx5LlwiLFwiaW52YWxpZC1jcmVkZW50aWFsXCI6XCJUaGUgc3VwcGxpZWQgYXV0aCBjcmVkZW50aWFsIGlzIG1hbGZvcm1lZCBvciBoYXMgZXhwaXJlZC5cIixcblwiaW52YWxpZC1wZXJzaXN0ZW5jZS10eXBlXCI6XCJUaGUgc3BlY2lmaWVkIHBlcnNpc3RlbmNlIHR5cGUgaXMgaW52YWxpZC4gSXQgY2FuIG9ubHkgYmUgbG9jYWwsIHNlc3Npb24gb3Igbm9uZS5cIixcImludmFsaWQtbWVzc2FnZS1wYXlsb2FkXCI6XCJUaGUgZW1haWwgdGVtcGxhdGUgY29ycmVzcG9uZGluZyB0byB0aGlzIGFjdGlvbiBjb250YWlucyBpbnZhbGlkIGNoYXJhY3RlcnMgaW4gaXRzIG1lc3NhZ2UuIFBsZWFzZSBmaXggYnkgZ29pbmcgdG8gdGhlIEF1dGggZW1haWwgdGVtcGxhdGVzIHNlY3Rpb24gaW4gdGhlIEZpcmViYXNlIENvbnNvbGUuXCIsXCJpbnZhbGlkLW9hdXRoLXByb3ZpZGVyXCI6XCJFbWFpbEF1dGhQcm92aWRlciBpcyBub3Qgc3VwcG9ydGVkIGZvciB0aGlzIG9wZXJhdGlvbi4gVGhpcyBvcGVyYXRpb24gb25seSBzdXBwb3J0cyBPQXV0aCBwcm92aWRlcnMuXCIsXCJpbnZhbGlkLW9hdXRoLWNsaWVudC1pZFwiOlwiVGhlIE9BdXRoIGNsaWVudCBJRCBwcm92aWRlZCBpcyBlaXRoZXIgaW52YWxpZCBvciBkb2VzIG5vdCBtYXRjaCB0aGUgc3BlY2lmaWVkIEFQSSBrZXkuXCIsXG5cInVuYXV0aG9yaXplZC1kb21haW5cIjpcIlRoaXMgZG9tYWluIGlzIG5vdCBhdXRob3JpemVkIGZvciBPQXV0aCBvcGVyYXRpb25zIGZvciB5b3VyIEZpcmViYXNlIHByb2plY3QuIEVkaXQgdGhlIGxpc3Qgb2YgYXV0aG9yaXplZCBkb21haW5zIGZyb20gdGhlIEZpcmViYXNlIGNvbnNvbGUuXCIsXCJpbnZhbGlkLWFjdGlvbi1jb2RlXCI6XCJUaGUgYWN0aW9uIGNvZGUgaXMgaW52YWxpZC4gVGhpcyBjYW4gaGFwcGVuIGlmIHRoZSBjb2RlIGlzIG1hbGZvcm1lZCwgZXhwaXJlZCwgb3IgaGFzIGFscmVhZHkgYmVlbiB1c2VkLlwiLFwid3JvbmctcGFzc3dvcmRcIjpcIlRoZSBwYXNzd29yZCBpcyBpbnZhbGlkIG9yIHRoZSB1c2VyIGRvZXMgbm90IGhhdmUgYSBwYXNzd29yZC5cIixcImludmFsaWQtcGhvbmUtbnVtYmVyXCI6XCJUaGUgZm9ybWF0IG9mIHRoZSBwaG9uZSBudW1iZXIgcHJvdmlkZWQgaXMgaW5jb3JyZWN0LiBQbGVhc2UgZW50ZXIgdGhlIHBob25lIG51bWJlciBpbiBhIGZvcm1hdCB0aGF0IGNhbiBiZSBwYXJzZWQgaW50byBFLjE2NCBmb3JtYXQuIEUuMTY0IHBob25lIG51bWJlcnMgYXJlIHdyaXR0ZW4gaW4gdGhlIGZvcm1hdCBbK11bY291bnRyeSBjb2RlXVtzdWJzY3JpYmVyIG51bWJlciBpbmNsdWRpbmcgYXJlYSBjb2RlXS5cIixcblwiaW52YWxpZC1yZWNpcGllbnQtZW1haWxcIjpcIlRoZSBlbWFpbCBjb3JyZXNwb25kaW5nIHRvIHRoaXMgYWN0aW9uIGZhaWxlZCB0byBzZW5kIGFzIHRoZSBwcm92aWRlZCByZWNpcGllbnQgZW1haWwgYWRkcmVzcyBpcyBpbnZhbGlkLlwiLFwiaW52YWxpZC1zZW5kZXJcIjpcIlRoZSBlbWFpbCB0ZW1wbGF0ZSBjb3JyZXNwb25kaW5nIHRvIHRoaXMgYWN0aW9uIGNvbnRhaW5zIGFuIGludmFsaWQgc2VuZGVyIGVtYWlsIG9yIG5hbWUuIFBsZWFzZSBmaXggYnkgZ29pbmcgdG8gdGhlIEF1dGggZW1haWwgdGVtcGxhdGVzIHNlY3Rpb24gaW4gdGhlIEZpcmViYXNlIENvbnNvbGUuXCIsXCJpbnZhbGlkLXZlcmlmaWNhdGlvbi1pZFwiOlwiVGhlIHZlcmlmaWNhdGlvbiBJRCB1c2VkIHRvIGNyZWF0ZSB0aGUgcGhvbmUgYXV0aCBjcmVkZW50aWFsIGlzIGludmFsaWQuXCIsXCJtaXNzaW5nLWFuZHJvaWQtcGtnLW5hbWVcIjpcIkFuIEFuZHJvaWQgUGFja2FnZSBOYW1lIG11c3QgYmUgcHJvdmlkZWQgaWYgdGhlIEFuZHJvaWQgQXBwIGlzIHJlcXVpcmVkIHRvIGJlIGluc3RhbGxlZC5cIixcblwiYXV0aC1kb21haW4tY29uZmlnLXJlcXVpcmVkXCI6XCJCZSBzdXJlIHRvIGluY2x1ZGUgYXV0aERvbWFpbiB3aGVuIGNhbGxpbmcgZmlyZWJhc2UuaW5pdGlhbGl6ZUFwcCgpLCBieSBmb2xsb3dpbmcgdGhlIGluc3RydWN0aW9ucyBpbiB0aGUgRmlyZWJhc2UgY29uc29sZS5cIixcIm1pc3NpbmctYXBwLWNyZWRlbnRpYWxcIjpcIlRoZSBwaG9uZSB2ZXJpZmljYXRpb24gcmVxdWVzdCBpcyBtaXNzaW5nIGFuIGFwcGxpY2F0aW9uIHZlcmlmaWVyIGFzc2VydGlvbi4gQSByZUNBUFRDSEEgcmVzcG9uc2UgdG9rZW4gbmVlZHMgdG8gYmUgcHJvdmlkZWQuXCIsXCJtaXNzaW5nLXZlcmlmaWNhdGlvbi1jb2RlXCI6XCJUaGUgcGhvbmUgYXV0aCBjcmVkZW50aWFsIHdhcyBjcmVhdGVkIHdpdGggYW4gZW1wdHkgU01TIHZlcmlmaWNhdGlvbiBjb2RlLlwiLFwibWlzc2luZy1jb250aW51ZS11cmlcIjpcIkEgY29udGludWUgVVJMIG11c3QgYmUgcHJvdmlkZWQgaW4gdGhlIHJlcXVlc3QuXCIsXCJtaXNzaW5nLWlmcmFtZS1zdGFydFwiOlwiQW4gaW50ZXJuYWwgZXJyb3IgaGFzIG9jY3VycmVkLlwiLFxuXCJtaXNzaW5nLWlvcy1idW5kbGUtaWRcIjpcIkFuIGlPUyBCdW5kbGUgSUQgbXVzdCBiZSBwcm92aWRlZCBpZiBhbiBBcHAgU3RvcmUgSUQgaXMgcHJvdmlkZWQuXCIsXCJtaXNzaW5nLXBob25lLW51bWJlclwiOlwiVG8gc2VuZCB2ZXJpZmljYXRpb24gY29kZXMsIHByb3ZpZGUgYSBwaG9uZSBudW1iZXIgZm9yIHRoZSByZWNpcGllbnQuXCIsXCJtaXNzaW5nLXZlcmlmaWNhdGlvbi1pZFwiOlwiVGhlIHBob25lIGF1dGggY3JlZGVudGlhbCB3YXMgY3JlYXRlZCB3aXRoIGFuIGVtcHR5IHZlcmlmaWNhdGlvbiBJRC5cIixcImFwcC1kZWxldGVkXCI6XCJUaGlzIGluc3RhbmNlIG9mIEZpcmViYXNlQXBwIGhhcyBiZWVuIGRlbGV0ZWQuXCIsXCJhY2NvdW50LWV4aXN0cy13aXRoLWRpZmZlcmVudC1jcmVkZW50aWFsXCI6XCJBbiBhY2NvdW50IGFscmVhZHkgZXhpc3RzIHdpdGggdGhlIHNhbWUgZW1haWwgYWRkcmVzcyBidXQgZGlmZmVyZW50IHNpZ24taW4gY3JlZGVudGlhbHMuIFNpZ24gaW4gdXNpbmcgYSBwcm92aWRlciBhc3NvY2lhdGVkIHdpdGggdGhpcyBlbWFpbCBhZGRyZXNzLlwiLFxuXCJuZXR3b3JrLXJlcXVlc3QtZmFpbGVkXCI6XCJBIG5ldHdvcmsgZXJyb3IgKHN1Y2ggYXMgdGltZW91dCwgaW50ZXJydXB0ZWQgY29ubmVjdGlvbiBvciB1bnJlYWNoYWJsZSBob3N0KSBoYXMgb2NjdXJyZWQuXCIsXCJuby1hdXRoLWV2ZW50XCI6XCJBbiBpbnRlcm5hbCBlcnJvciBoYXMgb2NjdXJyZWQuXCIsXCJuby1zdWNoLXByb3ZpZGVyXCI6XCJVc2VyIHdhcyBub3QgbGlua2VkIHRvIGFuIGFjY291bnQgd2l0aCB0aGUgZ2l2ZW4gcHJvdmlkZXIuXCIsXCJvcGVyYXRpb24tbm90LWFsbG93ZWRcIjpcIlRoZSBnaXZlbiBzaWduLWluIHByb3ZpZGVyIGlzIGRpc2FibGVkIGZvciB0aGlzIEZpcmViYXNlIHByb2plY3QuIEVuYWJsZSBpdCBpbiB0aGUgRmlyZWJhc2UgY29uc29sZSwgdW5kZXIgdGhlIHNpZ24taW4gbWV0aG9kIHRhYiBvZiB0aGUgQXV0aCBzZWN0aW9uLlwiLFwib3BlcmF0aW9uLW5vdC1zdXBwb3J0ZWQtaW4tdGhpcy1lbnZpcm9ubWVudFwiOidUaGlzIG9wZXJhdGlvbiBpcyBub3Qgc3VwcG9ydGVkIGluIHRoZSBlbnZpcm9ubWVudCB0aGlzIGFwcGxpY2F0aW9uIGlzIHJ1bm5pbmcgb24uIFwibG9jYXRpb24ucHJvdG9jb2xcIiBtdXN0IGJlIGh0dHAsIGh0dHBzIG9yIGNocm9tZS1leHRlbnNpb24gYW5kIHdlYiBzdG9yYWdlIG11c3QgYmUgZW5hYmxlZC4nLFxuXCJwb3B1cC1ibG9ja2VkXCI6XCJVbmFibGUgdG8gZXN0YWJsaXNoIGEgY29ubmVjdGlvbiB3aXRoIHRoZSBwb3B1cC4gSXQgbWF5IGhhdmUgYmVlbiBibG9ja2VkIGJ5IHRoZSBicm93c2VyLlwiLFwicG9wdXAtY2xvc2VkLWJ5LXVzZXJcIjpcIlRoZSBwb3B1cCBoYXMgYmVlbiBjbG9zZWQgYnkgdGhlIHVzZXIgYmVmb3JlIGZpbmFsaXppbmcgdGhlIG9wZXJhdGlvbi5cIixcInByb3ZpZGVyLWFscmVhZHktbGlua2VkXCI6XCJVc2VyIGNhbiBvbmx5IGJlIGxpbmtlZCB0byBvbmUgaWRlbnRpdHkgZm9yIHRoZSBnaXZlbiBwcm92aWRlci5cIixcInF1b3RhLWV4Y2VlZGVkXCI6XCJUaGUgcHJvamVjdCdzIHF1b3RhIGZvciB0aGlzIG9wZXJhdGlvbiBoYXMgYmVlbiBleGNlZWRlZC5cIixcInJlZGlyZWN0LWNhbmNlbGxlZC1ieS11c2VyXCI6XCJUaGUgcmVkaXJlY3Qgb3BlcmF0aW9uIGhhcyBiZWVuIGNhbmNlbGxlZCBieSB0aGUgdXNlciBiZWZvcmUgZmluYWxpemluZy5cIixcInJlZGlyZWN0LW9wZXJhdGlvbi1wZW5kaW5nXCI6XCJBIHJlZGlyZWN0IHNpZ24taW4gb3BlcmF0aW9uIGlzIGFscmVhZHkgcGVuZGluZy5cIixcbnRpbWVvdXQ6XCJUaGUgb3BlcmF0aW9uIGhhcyB0aW1lZCBvdXQuXCIsXCJ1c2VyLXRva2VuLWV4cGlyZWRcIjpcIlRoZSB1c2VyJ3MgY3JlZGVudGlhbCBpcyBubyBsb25nZXIgdmFsaWQuIFRoZSB1c2VyIG11c3Qgc2lnbiBpbiBhZ2Fpbi5cIixcInRvby1tYW55LXJlcXVlc3RzXCI6XCJXZSBoYXZlIGJsb2NrZWQgYWxsIHJlcXVlc3RzIGZyb20gdGhpcyBkZXZpY2UgZHVlIHRvIHVudXN1YWwgYWN0aXZpdHkuIFRyeSBhZ2FpbiBsYXRlci5cIixcInVuYXV0aG9yaXplZC1jb250aW51ZS11cmlcIjpcIlRoZSBkb21haW4gb2YgdGhlIGNvbnRpbnVlIFVSTCBpcyBub3Qgd2hpdGVsaXN0ZWQuICBQbGVhc2Ugd2hpdGVsaXN0IHRoZSBkb21haW4gaW4gdGhlIEZpcmViYXNlIGNvbnNvbGUuXCIsXCJ1bnN1cHBvcnRlZC1wZXJzaXN0ZW5jZS10eXBlXCI6XCJUaGUgY3VycmVudCBlbnZpcm9ubWVudCBkb2VzIG5vdCBzdXBwb3J0IHRoZSBzcGVjaWZpZWQgcGVyc2lzdGVuY2UgdHlwZS5cIixcInVzZXItY2FuY2VsbGVkXCI6XCJVc2VyIGRpZCBub3QgZ3JhbnQgeW91ciBhcHBsaWNhdGlvbiB0aGUgcGVybWlzc2lvbnMgaXQgcmVxdWVzdGVkLlwiLFxuXCJ1c2VyLW5vdC1mb3VuZFwiOlwiVGhlcmUgaXMgbm8gdXNlciByZWNvcmQgY29ycmVzcG9uZGluZyB0byB0aGlzIGlkZW50aWZpZXIuIFRoZSB1c2VyIG1heSBoYXZlIGJlZW4gZGVsZXRlZC5cIixcInVzZXItZGlzYWJsZWRcIjpcIlRoZSB1c2VyIGFjY291bnQgaGFzIGJlZW4gZGlzYWJsZWQgYnkgYW4gYWRtaW5pc3RyYXRvci5cIixcInVzZXItbWlzbWF0Y2hcIjpcIlRoZSBzdXBwbGllZCBjcmVkZW50aWFscyBkbyBub3QgY29ycmVzcG9uZCB0byB0aGUgcHJldmlvdXNseSBzaWduZWQgaW4gdXNlci5cIixcInVzZXItc2lnbmVkLW91dFwiOlwiXCIsXCJ3ZWFrLXBhc3N3b3JkXCI6XCJUaGUgcGFzc3dvcmQgbXVzdCBiZSA2IGNoYXJhY3RlcnMgbG9uZyBvciBtb3JlLlwiLFwid2ViLXN0b3JhZ2UtdW5zdXBwb3J0ZWRcIjpcIlRoaXMgYnJvd3NlciBpcyBub3Qgc3VwcG9ydGVkIG9yIDNyZCBwYXJ0eSBjb29raWVzIGFuZCBkYXRhIG1heSBiZSBkaXNhYmxlZC5cIn07dmFyIG1nPWZ1bmN0aW9uKGEsYixjLGQsZSl7dGhpcy5tYT1hO3RoaXMuWT1ifHxudWxsO3RoaXMuRWI9Y3x8bnVsbDt0aGlzLllkPWR8fG51bGw7dGhpcy5iYT1lfHxudWxsO2lmKHRoaXMuRWJ8fHRoaXMuYmEpe2lmKHRoaXMuRWImJnRoaXMuYmEpdGhyb3cgbmV3IE8oXCJpbnZhbGlkLWF1dGgtZXZlbnRcIik7aWYodGhpcy5FYiYmIXRoaXMuWWQpdGhyb3cgbmV3IE8oXCJpbnZhbGlkLWF1dGgtZXZlbnRcIik7fWVsc2UgdGhyb3cgbmV3IE8oXCJpbnZhbGlkLWF1dGgtZXZlbnRcIik7fTttZy5wcm90b3R5cGUudGM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ZZH07bWcucHJvdG90eXBlLmdldEVycm9yPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYmF9O21nLnByb3RvdHlwZS5BPWZ1bmN0aW9uKCl7cmV0dXJue3R5cGU6dGhpcy5tYSxldmVudElkOnRoaXMuWSx1cmxSZXNwb25zZTp0aGlzLkViLHNlc3Npb25JZDp0aGlzLllkLGVycm9yOnRoaXMuYmEmJnRoaXMuYmEuQSgpfX07XG52YXIgbmc9ZnVuY3Rpb24oYSl7YT1hfHx7fTtyZXR1cm4gYS50eXBlP25ldyBtZyhhLnR5cGUsYS5ldmVudElkLGEudXJsUmVzcG9uc2UsYS5zZXNzaW9uSWQsYS5lcnJvciYmbGcoYS5lcnJvcikpOm51bGx9O3ZhciBvZz1mdW5jdGlvbihhKXt2YXIgYj1cInVuYXV0aG9yaXplZC1kb21haW5cIixjPXZvaWQgMCxkPWdmKGEpO2E9ZC5wYTtkPWQucWE7XCJjaHJvbWUtZXh0ZW5zaW9uXCI9PWQ/Yz1uYShcIlRoaXMgY2hyb21lIGV4dGVuc2lvbiBJRCAoY2hyb21lLWV4dGVuc2lvbjovLyVzKSBpcyBub3QgYXV0aG9yaXplZCB0byBydW4gdGhpcyBvcGVyYXRpb24uIEFkZCBpdCB0byB0aGUgT0F1dGggcmVkaXJlY3QgZG9tYWlucyBsaXN0IGluIHRoZSBGaXJlYmFzZSBjb25zb2xlIC0+IEF1dGggc2VjdGlvbiAtPiBTaWduIGluIG1ldGhvZCB0YWIuXCIsYSk6XCJodHRwXCI9PWR8fFwiaHR0cHNcIj09ZD9jPW5hKFwiVGhpcyBkb21haW4gKCVzKSBpcyBub3QgYXV0aG9yaXplZCB0byBydW4gdGhpcyBvcGVyYXRpb24uIEFkZCBpdCB0byB0aGUgT0F1dGggcmVkaXJlY3QgZG9tYWlucyBsaXN0IGluIHRoZSBGaXJlYmFzZSBjb25zb2xlIC0+IEF1dGggc2VjdGlvbiAtPiBTaWduIGluIG1ldGhvZCB0YWIuXCIsYSk6Yj1cblwib3BlcmF0aW9uLW5vdC1zdXBwb3J0ZWQtaW4tdGhpcy1lbnZpcm9ubWVudFwiO08uY2FsbCh0aGlzLGIsYyl9O3Qob2csTyk7dmFyIHBnPWZ1bmN0aW9uKGEpe3RoaXMuWmY9YS5zdWI7bWEoKTt0aGlzLk1iPWEuZW1haWx8fG51bGw7dGhpcy5SZD1hLnByb3ZpZGVyX2lkfHxhLmZpcmViYXNlJiZhLmZpcmViYXNlLnNpZ25faW5fcHJvdmlkZXJ8fG51bGw7dGhpcy5xZj0hIWEuaXNfYW5vbnltb3VzfHxcImFub255bW91c1wiPT10aGlzLlJkfTtwZy5wcm90b3R5cGUuZ2V0RW1haWw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5NYn07cGcucHJvdG90eXBlLmlzQW5vbnltb3VzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucWZ9O3ZhciBxZz1mdW5jdGlvbihhKXthPWEuc3BsaXQoXCIuXCIpO2lmKDMhPWEubGVuZ3RoKXJldHVybiBudWxsO2E9YVsxXTtmb3IodmFyIGI9KDQtYS5sZW5ndGglNCklNCxjPTA7YzxiO2MrKylhKz1cIi5cIjt0cnl7dmFyIGQ9SlNPTi5wYXJzZShIYihhKSk7aWYoZC5zdWImJmQuaXNzJiZkLmF1ZCYmZC5leHApcmV0dXJuIG5ldyBwZyhkKX1jYXRjaChlKXt9cmV0dXJuIG51bGx9O3ZhciByZz1mdW5jdGlvbihhLGIpe3JldHVybiBhLnRoZW4oZnVuY3Rpb24oYSl7aWYoYS5pZFRva2VuKXt2YXIgYz1xZyhhLmlkVG9rZW4pO2lmKCFjfHxiIT1jLlpmKXRocm93IG5ldyBPKFwidXNlci1taXNtYXRjaFwiKTtyZXR1cm4gYX10aHJvdyBuZXcgTyhcInVzZXItbWlzbWF0Y2hcIik7fSkuZyhmdW5jdGlvbihhKXt0aHJvdyBhJiZhLmNvZGUmJlwiYXV0aC91c2VyLW5vdC1mb3VuZFwiPT1hLmNvZGU/bmV3IE8oXCJ1c2VyLW1pc21hdGNoXCIpOmE7fSl9LHNnPWZ1bmN0aW9uKGEsYil7aWYoYi5pZFRva2VufHxiLmFjY2Vzc1Rva2VuKWIuaWRUb2tlbiYmTih0aGlzLFwiaWRUb2tlblwiLGIuaWRUb2tlbiksYi5hY2Nlc3NUb2tlbiYmTih0aGlzLFwiYWNjZXNzVG9rZW5cIixiLmFjY2Vzc1Rva2VuKTtlbHNlIGlmKGIub2F1dGhUb2tlbiYmYi5vYXV0aFRva2VuU2VjcmV0KU4odGhpcyxcImFjY2Vzc1Rva2VuXCIsYi5vYXV0aFRva2VuKSxOKHRoaXMsXCJzZWNyZXRcIixiLm9hdXRoVG9rZW5TZWNyZXQpO1xuZWxzZSB0aHJvdyBuZXcgTyhcImludGVybmFsLWVycm9yXCIsXCJmYWlsZWQgdG8gY29uc3RydWN0IGEgY3JlZGVudGlhbFwiKTtOKHRoaXMsXCJwcm92aWRlcklkXCIsYSl9O3NnLnByb3RvdHlwZS5PYj1mdW5jdGlvbihhKXtyZXR1cm4gdGcoYSx1Zyh0aGlzKSl9O3NnLnByb3RvdHlwZS5GYz1mdW5jdGlvbihhLGIpe3ZhciBjPXVnKHRoaXMpO2MuaWRUb2tlbj1iO3JldHVybiB2ZyhhLGMpfTtzZy5wcm90b3R5cGUuR2Q9ZnVuY3Rpb24oYSxiKXt2YXIgYz11Zyh0aGlzKTtyZXR1cm4gcmcod2coYSxjKSxiKX07dmFyIHVnPWZ1bmN0aW9uKGEpe3ZhciBiPXt9O2EuaWRUb2tlbiYmKGIuaWRfdG9rZW49YS5pZFRva2VuKTthLmFjY2Vzc1Rva2VuJiYoYi5hY2Nlc3NfdG9rZW49YS5hY2Nlc3NUb2tlbik7YS5zZWNyZXQmJihiLm9hdXRoX3Rva2VuX3NlY3JldD1hLnNlY3JldCk7Yi5wcm92aWRlcklkPWEucHJvdmlkZXJJZDtyZXR1cm57cG9zdEJvZHk6bWYoYikudG9TdHJpbmcoKSxyZXF1ZXN0VXJpOlwiaHR0cDovL2xvY2FsaG9zdFwifX07XG5zZy5wcm90b3R5cGUuQT1mdW5jdGlvbigpe3ZhciBhPXtwcm92aWRlcklkOnRoaXMucHJvdmlkZXJJZH07dGhpcy5pZFRva2VuJiYoYS5vYXV0aElkVG9rZW49dGhpcy5pZFRva2VuKTt0aGlzLmFjY2Vzc1Rva2VuJiYoYS5vYXV0aEFjY2Vzc1Rva2VuPXRoaXMuYWNjZXNzVG9rZW4pO3RoaXMuc2VjcmV0JiYoYS5vYXV0aFRva2VuU2VjcmV0PXRoaXMuc2VjcmV0KTtyZXR1cm4gYX07dmFyIHhnPWZ1bmN0aW9uKGEsYil7dGhpcy5rZz1ifHxbXTtiZyh0aGlzLHtwcm92aWRlcklkOmEsaXNPQXV0aFByb3ZpZGVyOiEwfSk7dGhpcy5xZT17fTt0aGlzLkVkPShqZyhhKXx8e30pLkRjfHxudWxsO3RoaXMubmQ9bnVsbH07eGcucHJvdG90eXBlLnNldEN1c3RvbVBhcmFtZXRlcnM9ZnVuY3Rpb24oYSl7dGhpcy5xZT1rYihhKTtyZXR1cm4gdGhpc307dmFyIFA9ZnVuY3Rpb24oYSl7eGcuY2FsbCh0aGlzLGEsaGcpO3RoaXMuVmQ9W119O3QoUCx4Zyk7XG5QLnByb3RvdHlwZS5hZGRTY29wZT1mdW5jdGlvbihhKXtWYSh0aGlzLlZkLGEpfHx0aGlzLlZkLnB1c2goYSk7cmV0dXJuIHRoaXN9O1AucHJvdG90eXBlLnllPWZ1bmN0aW9uKCl7cmV0dXJuICRhKHRoaXMuVmQpfTtQLnByb3RvdHlwZS5jcmVkZW50aWFsPWZ1bmN0aW9uKGEsYil7aWYoIWEmJiFiKXRocm93IG5ldyBPKFwiYXJndW1lbnQtZXJyb3JcIixcImNyZWRlbnRpYWwgZmFpbGVkOiBtdXN0IHByb3ZpZGUgdGhlIElEIHRva2VuIGFuZC9vciB0aGUgYWNjZXNzIHRva2VuLlwiKTtyZXR1cm4gbmV3IHNnKHRoaXMucHJvdmlkZXJJZCx7aWRUb2tlbjphfHxudWxsLGFjY2Vzc1Rva2VuOmJ8fG51bGx9KX07dmFyIHlnPWZ1bmN0aW9uKCl7UC5jYWxsKHRoaXMsXCJmYWNlYm9vay5jb21cIil9O3QoeWcsUCk7Tih5ZyxcIlBST1ZJREVSX0lEXCIsXCJmYWNlYm9vay5jb21cIik7XG52YXIgemc9ZnVuY3Rpb24oYSl7aWYoIWEpdGhyb3cgbmV3IE8oXCJhcmd1bWVudC1lcnJvclwiLFwiY3JlZGVudGlhbCBmYWlsZWQ6IGV4cGVjdGVkIDEgYXJndW1lbnQgKHRoZSBPQXV0aCBhY2Nlc3MgdG9rZW4pLlwiKTt2YXIgYj1hO3EoYSkmJihiPWEuYWNjZXNzVG9rZW4pO3JldHVybihuZXcgeWcpLmNyZWRlbnRpYWwobnVsbCxiKX0sQWc9ZnVuY3Rpb24oKXtQLmNhbGwodGhpcyxcImdpdGh1Yi5jb21cIil9O3QoQWcsUCk7TihBZyxcIlBST1ZJREVSX0lEXCIsXCJnaXRodWIuY29tXCIpO3ZhciBCZz1mdW5jdGlvbihhKXtpZighYSl0aHJvdyBuZXcgTyhcImFyZ3VtZW50LWVycm9yXCIsXCJjcmVkZW50aWFsIGZhaWxlZDogZXhwZWN0ZWQgMSBhcmd1bWVudCAodGhlIE9BdXRoIGFjY2VzcyB0b2tlbikuXCIpO3ZhciBiPWE7cShhKSYmKGI9YS5hY2Nlc3NUb2tlbik7cmV0dXJuKG5ldyBBZykuY3JlZGVudGlhbChudWxsLGIpfSxDZz1mdW5jdGlvbigpe1AuY2FsbCh0aGlzLFwiZ29vZ2xlLmNvbVwiKTt0aGlzLmFkZFNjb3BlKFwicHJvZmlsZVwiKX07XG50KENnLFApO04oQ2csXCJQUk9WSURFUl9JRFwiLFwiZ29vZ2xlLmNvbVwiKTt2YXIgRGc9ZnVuY3Rpb24oYSxiKXt2YXIgYz1hO3EoYSkmJihjPWEuaWRUb2tlbixiPWEuYWNjZXNzVG9rZW4pO3JldHVybihuZXcgQ2cpLmNyZWRlbnRpYWwoYyxiKX0sRWc9ZnVuY3Rpb24oKXt4Zy5jYWxsKHRoaXMsXCJ0d2l0dGVyLmNvbVwiLGdnKX07dChFZyx4Zyk7TihFZyxcIlBST1ZJREVSX0lEXCIsXCJ0d2l0dGVyLmNvbVwiKTtcbnZhciBGZz1mdW5jdGlvbihhLGIpe3ZhciBjPWE7cShjKXx8KGM9e29hdXRoVG9rZW46YSxvYXV0aFRva2VuU2VjcmV0OmJ9KTtpZighYy5vYXV0aFRva2VufHwhYy5vYXV0aFRva2VuU2VjcmV0KXRocm93IG5ldyBPKFwiYXJndW1lbnQtZXJyb3JcIixcImNyZWRlbnRpYWwgZmFpbGVkOiBleHBlY3RlZCAyIGFyZ3VtZW50cyAodGhlIE9BdXRoIGFjY2VzcyB0b2tlbiBhbmQgc2VjcmV0KS5cIik7cmV0dXJuIG5ldyBzZyhcInR3aXR0ZXIuY29tXCIsYyl9LEdnPWZ1bmN0aW9uKGEsYil7dGhpcy5NYj1hO3RoaXMuTGQ9YjtOKHRoaXMsXCJwcm92aWRlcklkXCIsXCJwYXNzd29yZFwiKX07R2cucHJvdG90eXBlLk9iPWZ1bmN0aW9uKGEpe3JldHVybiBRKGEsSGcse2VtYWlsOnRoaXMuTWIscGFzc3dvcmQ6dGhpcy5MZH0pfTtHZy5wcm90b3R5cGUuRmM9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gUShhLElnLHtpZFRva2VuOmIsZW1haWw6dGhpcy5NYixwYXNzd29yZDp0aGlzLkxkfSl9O1xuR2cucHJvdG90eXBlLkdkPWZ1bmN0aW9uKGEsYil7cmV0dXJuIHJnKHRoaXMuT2IoYSksYil9O0dnLnByb3RvdHlwZS5BPWZ1bmN0aW9uKCl7cmV0dXJue2VtYWlsOnRoaXMuTWIscGFzc3dvcmQ6dGhpcy5MZH19O3ZhciBKZz1mdW5jdGlvbigpe2JnKHRoaXMse3Byb3ZpZGVySWQ6XCJwYXNzd29yZFwiLGlzT0F1dGhQcm92aWRlcjohMX0pfTtiZyhKZyx7UFJPVklERVJfSUQ6XCJwYXNzd29yZFwifSk7dmFyIEtnPWZ1bmN0aW9uKGEpe2lmKCEoYS52ZXJpZmljYXRpb25JZCYmYS4kY3x8YS5oYyYmYS5waG9uZU51bWJlcikpdGhyb3cgbmV3IE8oXCJpbnRlcm5hbC1lcnJvclwiKTt0aGlzLlU9YTtOKHRoaXMsXCJwcm92aWRlcklkXCIsXCJwaG9uZVwiKX07S2cucHJvdG90eXBlLk9iPWZ1bmN0aW9uKGEpe3JldHVybiBhLnZlcmlmeVBob25lTnVtYmVyKExnKHRoaXMpKX07S2cucHJvdG90eXBlLkZjPWZ1bmN0aW9uKGEsYil7dmFyIGM9TGcodGhpcyk7Yy5pZFRva2VuPWI7cmV0dXJuIFEoYSxNZyxjKX07XG5LZy5wcm90b3R5cGUuR2Q9ZnVuY3Rpb24oYSxiKXt2YXIgYz1MZyh0aGlzKTtjLm9wZXJhdGlvbj1cIlJFQVVUSFwiO2E9UShhLE5nLGMpO3JldHVybiByZyhhLGIpfTtLZy5wcm90b3R5cGUuQT1mdW5jdGlvbigpe3ZhciBhPXtwcm92aWRlcklkOlwicGhvbmVcIn07dGhpcy5VLnZlcmlmaWNhdGlvbklkJiYoYS52ZXJpZmljYXRpb25JZD10aGlzLlUudmVyaWZpY2F0aW9uSWQpO3RoaXMuVS4kYyYmKGEudmVyaWZpY2F0aW9uQ29kZT10aGlzLlUuJGMpO3RoaXMuVS5oYyYmKGEudGVtcG9yYXJ5UHJvb2Y9dGhpcy5VLmhjKTt0aGlzLlUucGhvbmVOdW1iZXImJihhLnBob25lTnVtYmVyPXRoaXMuVS5waG9uZU51bWJlcik7cmV0dXJuIGF9O1xudmFyIExnPWZ1bmN0aW9uKGEpe3JldHVybiBhLlUuaGMmJmEuVS5waG9uZU51bWJlcj97dGVtcG9yYXJ5UHJvb2Y6YS5VLmhjLHBob25lTnVtYmVyOmEuVS5waG9uZU51bWJlcn06e3Nlc3Npb25JbmZvOmEuVS52ZXJpZmljYXRpb25JZCxjb2RlOmEuVS4kY319LE9nPWZ1bmN0aW9uKGEpe3RyeXt0aGlzLnRmPWF8fGZpcmViYXNlLmF1dGgoKX1jYXRjaChiKXt0aHJvdyBuZXcgTyhcImFyZ3VtZW50LWVycm9yXCIsXCJFaXRoZXIgYW4gaW5zdGFuY2Ugb2YgZmlyZWJhc2UuYXV0aC5BdXRoIG11c3QgYmUgcGFzc2VkIGFzIGFuIGFyZ3VtZW50IHRvIHRoZSBmaXJlYmFzZS5hdXRoLlBob25lQXV0aFByb3ZpZGVyIGNvbnN0cnVjdG9yLCBvciB0aGUgZGVmYXVsdCBmaXJlYmFzZSBBcHAgaW5zdGFuY2UgbXVzdCBiZSBpbml0aWFsaXplZCB2aWEgZmlyZWJhc2UuaW5pdGlhbGl6ZUFwcCgpLlwiKTt9YmcodGhpcyx7cHJvdmlkZXJJZDpcInBob25lXCIsaXNPQXV0aFByb3ZpZGVyOiExfSl9O1xuT2cucHJvdG90eXBlLnZlcmlmeVBob25lTnVtYmVyPWZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy50Zi5mO3JldHVybiBEKGIudmVyaWZ5KCkpLnRoZW4oZnVuY3Rpb24oZCl7aWYoIW0oZCkpdGhyb3cgbmV3IE8oXCJhcmd1bWVudC1lcnJvclwiLFwiQW4gaW1wbGVtZW50YXRpb24gb2YgZmlyZWJhc2UuYXV0aC5BcHBsaWNhdGlvblZlcmlmaWVyLnByb3RvdHlwZS52ZXJpZnkoKSBtdXN0IHJldHVybiBhIGZpcmViYXNlLlByb21pc2UgdGhhdCByZXNvbHZlcyB3aXRoIGEgc3RyaW5nLlwiKTtzd2l0Y2goYi50eXBlKXtjYXNlIFwicmVjYXB0Y2hhXCI6cmV0dXJuIFEoYyxQZyx7cGhvbmVOdW1iZXI6YSxyZWNhcHRjaGFUb2tlbjpkfSk7ZGVmYXVsdDp0aHJvdyBuZXcgTyhcImFyZ3VtZW50LWVycm9yXCIsJ09ubHkgZmlyZWJhc2UuYXV0aC5BcHBsaWNhdGlvblZlcmlmaWVycyB3aXRoIHR5cGU9XCJyZWNhcHRjaGFcIiBhcmUgY3VycmVudGx5IHN1cHBvcnRlZC4nKTt9fSl9O1xudmFyIFFnPWZ1bmN0aW9uKGEsYil7aWYoIWEpdGhyb3cgbmV3IE8oXCJtaXNzaW5nLXZlcmlmaWNhdGlvbi1pZFwiKTtpZighYil0aHJvdyBuZXcgTyhcIm1pc3NpbmctdmVyaWZpY2F0aW9uLWNvZGVcIik7cmV0dXJuIG5ldyBLZyh7dmVyaWZpY2F0aW9uSWQ6YSwkYzpifSl9O2JnKE9nLHtQUk9WSURFUl9JRDpcInBob25lXCJ9KTtcbnZhciBSZz1mdW5jdGlvbihhKXtpZihhLnRlbXBvcmFyeVByb29mJiZhLnBob25lTnVtYmVyKXJldHVybiBuZXcgS2coe2hjOmEudGVtcG9yYXJ5UHJvb2YscGhvbmVOdW1iZXI6YS5waG9uZU51bWJlcn0pO3ZhciBiPWEmJmEucHJvdmlkZXJJZDtpZighYnx8XCJwYXNzd29yZFwiPT09YilyZXR1cm4gbnVsbDt2YXIgYz1hJiZhLm9hdXRoQWNjZXNzVG9rZW4sZD1hJiZhLm9hdXRoVG9rZW5TZWNyZXQ7YT1hJiZhLm9hdXRoSWRUb2tlbjt0cnl7c3dpdGNoKGIpe2Nhc2UgXCJnb29nbGUuY29tXCI6cmV0dXJuIERnKGEsYyk7Y2FzZSBcImZhY2Vib29rLmNvbVwiOnJldHVybiB6ZyhjKTtjYXNlIFwiZ2l0aHViLmNvbVwiOnJldHVybiBCZyhjKTtjYXNlIFwidHdpdHRlci5jb21cIjpyZXR1cm4gRmcoYyxkKTtkZWZhdWx0OnJldHVybihuZXcgUChiKSkuY3JlZGVudGlhbChhLGMpfX1jYXRjaChlKXtyZXR1cm4gbnVsbH19LFNnPWZ1bmN0aW9uKGEpe2lmKCFhLmlzT0F1dGhQcm92aWRlcil0aHJvdyBuZXcgTyhcImludmFsaWQtb2F1dGgtcHJvdmlkZXJcIik7XG59O3ZhciBUZz1mdW5jdGlvbihhLGIsYyl7Ty5jYWxsKHRoaXMsYSxjKTthPWJ8fHt9O2EuZW1haWwmJk4odGhpcyxcImVtYWlsXCIsYS5lbWFpbCk7YS5waG9uZU51bWJlciYmTih0aGlzLFwicGhvbmVOdW1iZXJcIixhLnBob25lTnVtYmVyKTthLmNyZWRlbnRpYWwmJk4odGhpcyxcImNyZWRlbnRpYWxcIixhLmNyZWRlbnRpYWwpfTt0KFRnLE8pO1RnLnByb3RvdHlwZS5BPWZ1bmN0aW9uKCl7dmFyIGE9e2NvZGU6dGhpcy5jb2RlLG1lc3NhZ2U6dGhpcy5tZXNzYWdlfTt0aGlzLmVtYWlsJiYoYS5lbWFpbD10aGlzLmVtYWlsKTt0aGlzLnBob25lTnVtYmVyJiYoYS5waG9uZU51bWJlcj10aGlzLnBob25lTnVtYmVyKTt2YXIgYj10aGlzLmNyZWRlbnRpYWwmJnRoaXMuY3JlZGVudGlhbC5BKCk7YiYmbWIoYSxiKTtyZXR1cm4gYX07VGcucHJvdG90eXBlLnRvSlNPTj1mdW5jdGlvbigpe3JldHVybiB0aGlzLkEoKX07XG52YXIgVWc9ZnVuY3Rpb24oYSl7aWYoYS5jb2RlKXt2YXIgYj1hLmNvZGV8fFwiXCI7MD09Yi5pbmRleE9mKFwiYXV0aC9cIikmJihiPWIuc3Vic3RyaW5nKDUpKTt2YXIgYz17Y3JlZGVudGlhbDpSZyhhKX07aWYoYS5lbWFpbCljLmVtYWlsPWEuZW1haWw7ZWxzZSBpZihhLnBob25lTnVtYmVyKWMucGhvbmVOdW1iZXI9YS5waG9uZU51bWJlcjtlbHNlIHJldHVybiBuZXcgTyhiLGEubWVzc2FnZXx8dm9pZCAwKTtyZXR1cm4gbmV3IFRnKGIsYyxhLm1lc3NhZ2UpfXJldHVybiBudWxsfTt2YXIgVmc9ZnVuY3Rpb24oYSl7dGhpcy5FZz1hfTt0KFZnLExjKTtWZy5wcm90b3R5cGUucmM9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHRoaXMuRWd9O1ZnLnByb3RvdHlwZS5DZD1mdW5jdGlvbigpe3JldHVybnt9fTtcbnZhciBSPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD1cIk5vZGVcIj09R2YoKTtkPWsuWE1MSHR0cFJlcXVlc3R8fGQmJmZpcmViYXNlLklOVEVSTkFMLm5vZGUmJmZpcmViYXNlLklOVEVSTkFMLm5vZGUuWE1MSHR0cFJlcXVlc3Q7aWYoIWQpdGhyb3cgbmV3IE8oXCJpbnRlcm5hbC1lcnJvclwiLFwiVGhlIFhNTEh0dHBSZXF1ZXN0IGNvbXBhdGliaWxpdHkgbGlicmFyeSB3YXMgbm90IGZvdW5kLlwiKTt0aGlzLm09YTthPWJ8fHt9O3RoaXMucWc9YS5zZWN1cmVUb2tlbkVuZHBvaW50fHxcImh0dHBzOi8vc2VjdXJldG9rZW4uZ29vZ2xlYXBpcy5jb20vdjEvdG9rZW5cIjt0aGlzLnJnPWEuc2VjdXJlVG9rZW5UaW1lb3V0fHxXZzt0aGlzLlBjPWtiKGEuc2VjdXJlVG9rZW5IZWFkZXJzfHxYZyk7dGhpcy5EZj1hLmZpcmViYXNlRW5kcG9pbnR8fFwiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vaWRlbnRpdHl0b29sa2l0L3YzL3JlbHlpbmdwYXJ0eS9cIjt0aGlzLkVmPWEuZmlyZWJhc2VUaW1lb3V0fHxcbllnO3RoaXMubWI9a2IoYS5maXJlYmFzZUhlYWRlcnN8fFpnKTtjJiYodGhpcy5tYltcIlgtQ2xpZW50LVZlcnNpb25cIl09Yyx0aGlzLlBjW1wiWC1DbGllbnQtVmVyc2lvblwiXT1jKTt0aGlzLnZmPW5ldyBRYzt0aGlzLkRnPW5ldyBWZyhkKX0sJGcsV2c9bmV3IFZmKDNFNCw2RTQpLFhnPXtcIkNvbnRlbnQtVHlwZVwiOlwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXCJ9LFlnPW5ldyBWZigzRTQsNkU0KSxaZz17XCJDb250ZW50LVR5cGVcIjpcImFwcGxpY2F0aW9uL2pzb25cIn0sYWg9ZnVuY3Rpb24oYSxiKXtiP2EubWJbXCJYLUZpcmViYXNlLUxvY2FsZVwiXT1iOmRlbGV0ZSBhLm1iW1wiWC1GaXJlYmFzZS1Mb2NhbGVcIl19LGJoPWZ1bmN0aW9uKGEsYil7Yj8oYS5tYltcIlgtQ2xpZW50LVZlcnNpb25cIl09YixhLlBjW1wiWC1DbGllbnQtVmVyc2lvblwiXT1iKTooZGVsZXRlIGEubWJbXCJYLUNsaWVudC1WZXJzaW9uXCJdLGRlbGV0ZSBhLlBjW1wiWC1DbGllbnQtVmVyc2lvblwiXSl9LGRoPWZ1bmN0aW9uKGEsXG5iLGMsZCxlLGYsZyl7VWYoKT8odmYoKT9hPXIoYS50ZyxhKTooJGd8fCgkZz1uZXcgQyhmdW5jdGlvbihhLGIpe2NoKGEsYil9KSksYT1yKGEuc2csYSkpLGEoYixjLGQsZSxmLGcpKTpjJiZjKG51bGwpfTtcblIucHJvdG90eXBlLnRnPWZ1bmN0aW9uKGEsYixjLGQsZSxmKXt2YXIgZz1cIk5vZGVcIj09R2YoKSxsPUhmKCk/Zz9uZXcgSSh0aGlzLkRnKTpuZXcgSTpuZXcgSSh0aGlzLnZmKTtpZihmKXtsLkRiPU1hdGgubWF4KDAsZik7dmFyIG49c2V0VGltZW91dChmdW5jdGlvbigpe2wuZGlzcGF0Y2hFdmVudChcInRpbWVvdXRcIil9LGYpfWwubGlzdGVuKFwiY29tcGxldGVcIixmdW5jdGlvbigpe24mJmNsZWFyVGltZW91dChuKTt2YXIgYT1udWxsO3RyeXthPUpTT04ucGFyc2UoUmUodGhpcykpfHxudWxsfWNhdGNoKHpiKXthPW51bGx9YiYmYihhKX0pO3NjKGwsXCJyZWFkeVwiLGZ1bmN0aW9uKCl7biYmY2xlYXJUaW1lb3V0KG4pO3RoaXMuTWF8fCh0aGlzLk1hPSEwLHRoaXMubGIoKSl9KTtzYyhsLFwidGltZW91dFwiLGZ1bmN0aW9uKCl7biYmY2xlYXJUaW1lb3V0KG4pO3RoaXMuTWF8fCh0aGlzLk1hPSEwLHRoaXMubGIoKSk7YiYmYihudWxsKX0pO2wuc2VuZChhLGMsZCxlKX07XG52YXIgZWg9SGEoXCJodHRwczovL2FwaXMuZ29vZ2xlLmNvbS9qcy9jbGllbnQuanM/b25sb2FkPSV7b25sb2FkfVwiKSxmaD1cIl9fZmNiXCIrTWF0aC5mbG9vcigxRTYqTWF0aC5yYW5kb20oKSkudG9TdHJpbmcoKSxjaD1mdW5jdGlvbihhLGIpe2lmKCgod2luZG93LmdhcGl8fHt9KS5jbGllbnR8fHt9KS5yZXF1ZXN0KWEoKTtlbHNle2tbZmhdPWZ1bmN0aW9uKCl7KCh3aW5kb3cuZ2FwaXx8e30pLmNsaWVudHx8e30pLnJlcXVlc3Q/YSgpOmIoRXJyb3IoXCJDT1JTX1VOU1VQUE9SVEVEXCIpKX07dmFyIGM9T2EoZWgse29ubG9hZDpmaH0pO1dkKGRlKGMpLGZ1bmN0aW9uKCl7YihFcnJvcihcIkNPUlNfVU5TVVBQT1JURURcIikpfSl9fTtcblIucHJvdG90eXBlLnNnPWZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9dGhpczskZy50aGVuKGZ1bmN0aW9uKCl7d2luZG93LmdhcGkuY2xpZW50LnNldEFwaUtleShmLm0pO3ZhciBnPXdpbmRvdy5nYXBpLmF1dGguZ2V0VG9rZW4oKTt3aW5kb3cuZ2FwaS5hdXRoLnNldFRva2VuKG51bGwpO3dpbmRvdy5nYXBpLmNsaWVudC5yZXF1ZXN0KHtwYXRoOmEsbWV0aG9kOmMsYm9keTpkLGhlYWRlcnM6ZSxhdXRoVHlwZTpcIm5vbmVcIixjYWxsYmFjazpmdW5jdGlvbihhKXt3aW5kb3cuZ2FwaS5hdXRoLnNldFRva2VuKGcpO2ImJmIoYSl9fSl9KS5nKGZ1bmN0aW9uKGEpe2ImJmIoe2Vycm9yOnttZXNzYWdlOmEmJmEubWVzc2FnZXx8XCJDT1JTX1VOU1VQUE9SVEVEXCJ9fSl9KX07XG52YXIgaGg9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IEMoZnVuY3Rpb24oYyxkKXtcInJlZnJlc2hfdG9rZW5cIj09Yi5ncmFudF90eXBlJiZiLnJlZnJlc2hfdG9rZW58fFwiYXV0aG9yaXphdGlvbl9jb2RlXCI9PWIuZ3JhbnRfdHlwZSYmYi5jb2RlP2RoKGEsYS5xZytcIj9rZXk9XCIrZW5jb2RlVVJJQ29tcG9uZW50KGEubSksZnVuY3Rpb24oYSl7YT9hLmVycm9yP2QoZ2goYSkpOmEuYWNjZXNzX3Rva2VuJiZhLnJlZnJlc2hfdG9rZW4/YyhhKTpkKG5ldyBPKFwiaW50ZXJuYWwtZXJyb3JcIikpOmQobmV3IE8oXCJuZXR3b3JrLXJlcXVlc3QtZmFpbGVkXCIpKX0sXCJQT1NUXCIsbWYoYikudG9TdHJpbmcoKSxhLlBjLGEucmcuZ2V0KCkpOmQobmV3IE8oXCJpbnRlcm5hbC1lcnJvclwiKSl9KX0saWg9ZnVuY3Rpb24oYSxiLGMsZCxlLGYpe3ZhciBnPWdmKGEuRGYrYik7SyhnLFwia2V5XCIsYS5tKTtmJiZLKGcsXCJjYlwiLG1hKCkudG9TdHJpbmcoKSk7dmFyIGw9XCJHRVRcIj09YztpZihsKWZvcih2YXIgbiBpbiBkKWQuaGFzT3duUHJvcGVydHkobikmJlxuSyhnLG4sZFtuXSk7cmV0dXJuIG5ldyBDKGZ1bmN0aW9uKGIsZil7ZGgoYSxnLnRvU3RyaW5nKCksZnVuY3Rpb24oYSl7YT9hLmVycm9yP2YoZ2goYSxlfHx7fSkpOmIoYSk6ZihuZXcgTyhcIm5ldHdvcmstcmVxdWVzdC1mYWlsZWRcIikpfSxjLGw/dm9pZCAwOkhjKFFmKGQpKSxhLm1iLGEuRWYuZ2V0KCkpfSl9LGpoPWZ1bmN0aW9uKGEpe2lmKCF5Yy50ZXN0KGEuZW1haWwpKXRocm93IG5ldyBPKFwiaW52YWxpZC1lbWFpbFwiKTt9LGtoPWZ1bmN0aW9uKGEpe1wiZW1haWxcImluIGEmJmpoKGEpfSxtaD1mdW5jdGlvbihhLGIpe3JldHVybiBRKGEsbGgse2lkZW50aWZpZXI6Yixjb250aW51ZVVyaTpNZigpP3JmKCk6XCJodHRwOi8vbG9jYWxob3N0XCJ9KS50aGVuKGZ1bmN0aW9uKGEpe3JldHVybiBhLmFsbFByb3ZpZGVyc3x8W119KX0sb2g9ZnVuY3Rpb24oYSl7cmV0dXJuIFEoYSxuaCx7fSkudGhlbihmdW5jdGlvbihhKXtyZXR1cm4gYS5hdXRob3JpemVkRG9tYWluc3x8W119KX0scGg9ZnVuY3Rpb24oYSl7aWYoIWEuaWRUb2tlbil0aHJvdyBuZXcgTyhcImludGVybmFsLWVycm9yXCIpO1xufSxxaD1mdW5jdGlvbihhKXtpZihhLnBob25lTnVtYmVyfHxhLnRlbXBvcmFyeVByb29mKXtpZighYS5waG9uZU51bWJlcnx8IWEudGVtcG9yYXJ5UHJvb2YpdGhyb3cgbmV3IE8oXCJpbnRlcm5hbC1lcnJvclwiKTt9ZWxzZXtpZighYS5zZXNzaW9uSW5mbyl0aHJvdyBuZXcgTyhcIm1pc3NpbmctdmVyaWZpY2F0aW9uLWlkXCIpO2lmKCFhLmNvZGUpdGhyb3cgbmV3IE8oXCJtaXNzaW5nLXZlcmlmaWNhdGlvbi1jb2RlXCIpO319O1IucHJvdG90eXBlLnNpZ25JbkFub255bW91c2x5PWZ1bmN0aW9uKCl7cmV0dXJuIFEodGhpcyxyaCx7fSl9O1IucHJvdG90eXBlLnVwZGF0ZUVtYWlsPWZ1bmN0aW9uKGEsYil7cmV0dXJuIFEodGhpcyxzaCx7aWRUb2tlbjphLGVtYWlsOmJ9KX07Ui5wcm90b3R5cGUudXBkYXRlUGFzc3dvcmQ9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gUSh0aGlzLElnLHtpZFRva2VuOmEscGFzc3dvcmQ6Yn0pfTt2YXIgdGg9e2Rpc3BsYXlOYW1lOlwiRElTUExBWV9OQU1FXCIscGhvdG9Vcmw6XCJQSE9UT19VUkxcIn07XG5SLnByb3RvdHlwZS51cGRhdGVQcm9maWxlPWZ1bmN0aW9uKGEsYil7dmFyIGM9e2lkVG9rZW46YX0sZD1bXTtlYih0aCxmdW5jdGlvbihhLGYpe3ZhciBlPWJbZl07bnVsbD09PWU/ZC5wdXNoKGEpOmYgaW4gYiYmKGNbZl09ZSl9KTtkLmxlbmd0aCYmKGMuZGVsZXRlQXR0cmlidXRlPWQpO3JldHVybiBRKHRoaXMsc2gsYyl9O1IucHJvdG90eXBlLnNlbmRQYXNzd29yZFJlc2V0RW1haWw9ZnVuY3Rpb24oYSxiKXthPXtyZXF1ZXN0VHlwZTpcIlBBU1NXT1JEX1JFU0VUXCIsZW1haWw6YX07bWIoYSxiKTtyZXR1cm4gUSh0aGlzLHVoLGEpfTtSLnByb3RvdHlwZS5zZW5kRW1haWxWZXJpZmljYXRpb249ZnVuY3Rpb24oYSxiKXthPXtyZXF1ZXN0VHlwZTpcIlZFUklGWV9FTUFJTFwiLGlkVG9rZW46YX07bWIoYSxiKTtyZXR1cm4gUSh0aGlzLHZoLGEpfTtSLnByb3RvdHlwZS52ZXJpZnlQaG9uZU51bWJlcj1mdW5jdGlvbihhKXtyZXR1cm4gUSh0aGlzLHdoLGEpfTtcbnZhciB5aD1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIFEoYSx4aCx7aWRUb2tlbjpiLGRlbGV0ZVByb3ZpZGVyOmN9KX0semg9ZnVuY3Rpb24oYSl7aWYoIWEucmVxdWVzdFVyaXx8IWEuc2Vzc2lvbklkJiYhYS5wb3N0Qm9keSl0aHJvdyBuZXcgTyhcImludGVybmFsLWVycm9yXCIpO30sQWg9ZnVuY3Rpb24oYSl7dmFyIGI9bnVsbDthLm5lZWRDb25maXJtYXRpb24/KGEuY29kZT1cImFjY291bnQtZXhpc3RzLXdpdGgtZGlmZmVyZW50LWNyZWRlbnRpYWxcIixiPVVnKGEpKTpcIkZFREVSQVRFRF9VU0VSX0lEX0FMUkVBRFlfTElOS0VEXCI9PWEuZXJyb3JNZXNzYWdlPyhhLmNvZGU9XCJjcmVkZW50aWFsLWFscmVhZHktaW4tdXNlXCIsYj1VZyhhKSk6XCJFTUFJTF9FWElTVFNcIj09YS5lcnJvck1lc3NhZ2UmJihhLmNvZGU9XCJlbWFpbC1hbHJlYWR5LWluLXVzZVwiLGI9VWcoYSkpO2lmKGIpdGhyb3cgYjtpZighYS5pZFRva2VuKXRocm93IG5ldyBPKFwiaW50ZXJuYWwtZXJyb3JcIik7fSx0Zz1mdW5jdGlvbihhLFxuYil7Yi5yZXR1cm5JZHBDcmVkZW50aWFsPSEwO3JldHVybiBRKGEsQmgsYil9LHZnPWZ1bmN0aW9uKGEsYil7Yi5yZXR1cm5JZHBDcmVkZW50aWFsPSEwO3JldHVybiBRKGEsQ2gsYil9LHdnPWZ1bmN0aW9uKGEsYil7Yi5yZXR1cm5JZHBDcmVkZW50aWFsPSEwO2IuYXV0b0NyZWF0ZT0hMTtyZXR1cm4gUShhLERoLGIpfSxFaD1mdW5jdGlvbihhKXtpZighYS5vb2JDb2RlKXRocm93IG5ldyBPKFwiaW52YWxpZC1hY3Rpb24tY29kZVwiKTt9O1IucHJvdG90eXBlLmNvbmZpcm1QYXNzd29yZFJlc2V0PWZ1bmN0aW9uKGEsYil7cmV0dXJuIFEodGhpcyxGaCx7b29iQ29kZTphLG5ld1Bhc3N3b3JkOmJ9KX07Ui5wcm90b3R5cGUuY2hlY2tBY3Rpb25Db2RlPWZ1bmN0aW9uKGEpe3JldHVybiBRKHRoaXMsR2gse29vYkNvZGU6YX0pfTtSLnByb3RvdHlwZS5hcHBseUFjdGlvbkNvZGU9ZnVuY3Rpb24oYSl7cmV0dXJuIFEodGhpcyxIaCx7b29iQ29kZTphfSl9O1xudmFyIEhoPXtlbmRwb2ludDpcInNldEFjY291bnRJbmZvXCIsRjpFaCxjYjpcImVtYWlsXCJ9LEdoPXtlbmRwb2ludDpcInJlc2V0UGFzc3dvcmRcIixGOkVoLCQ6ZnVuY3Rpb24oYSl7aWYoIWEuZW1haWx8fCFhLnJlcXVlc3RUeXBlKXRocm93IG5ldyBPKFwiaW50ZXJuYWwtZXJyb3JcIik7fX0sSWg9e2VuZHBvaW50Olwic2lnbnVwTmV3VXNlclwiLEY6ZnVuY3Rpb24oYSl7amgoYSk7aWYoIWEucGFzc3dvcmQpdGhyb3cgbmV3IE8oXCJ3ZWFrLXBhc3N3b3JkXCIpO30sJDpwaCxBYTohMH0sbGg9e2VuZHBvaW50OlwiY3JlYXRlQXV0aFVyaVwifSxKaD17ZW5kcG9pbnQ6XCJkZWxldGVBY2NvdW50XCIsYWI6W1wiaWRUb2tlblwiXX0seGg9e2VuZHBvaW50Olwic2V0QWNjb3VudEluZm9cIixhYjpbXCJpZFRva2VuXCIsXCJkZWxldGVQcm92aWRlclwiXSxGOmZ1bmN0aW9uKGEpe2lmKCFoYShhLmRlbGV0ZVByb3ZpZGVyKSl0aHJvdyBuZXcgTyhcImludGVybmFsLWVycm9yXCIpO319LEtoPXtlbmRwb2ludDpcImdldEFjY291bnRJbmZvXCJ9LFxudmg9e2VuZHBvaW50OlwiZ2V0T29iQ29uZmlybWF0aW9uQ29kZVwiLGFiOltcImlkVG9rZW5cIixcInJlcXVlc3RUeXBlXCJdLEY6ZnVuY3Rpb24oYSl7aWYoXCJWRVJJRllfRU1BSUxcIiE9YS5yZXF1ZXN0VHlwZSl0aHJvdyBuZXcgTyhcImludGVybmFsLWVycm9yXCIpO30sY2I6XCJlbWFpbFwifSx1aD17ZW5kcG9pbnQ6XCJnZXRPb2JDb25maXJtYXRpb25Db2RlXCIsYWI6W1wicmVxdWVzdFR5cGVcIl0sRjpmdW5jdGlvbihhKXtpZihcIlBBU1NXT1JEX1JFU0VUXCIhPWEucmVxdWVzdFR5cGUpdGhyb3cgbmV3IE8oXCJpbnRlcm5hbC1lcnJvclwiKTtqaChhKX0sY2I6XCJlbWFpbFwifSxuaD17aWU6ITAsZW5kcG9pbnQ6XCJnZXRQcm9qZWN0Q29uZmlnXCIsRGU6XCJHRVRcIn0sTGg9e2llOiEwLGVuZHBvaW50OlwiZ2V0UmVjYXB0Y2hhUGFyYW1cIixEZTpcIkdFVFwiLCQ6ZnVuY3Rpb24oYSl7aWYoIWEucmVjYXB0Y2hhU2l0ZUtleSl0aHJvdyBuZXcgTyhcImludGVybmFsLWVycm9yXCIpO319LEZoPXtlbmRwb2ludDpcInJlc2V0UGFzc3dvcmRcIixcbkY6RWgsY2I6XCJlbWFpbFwifSxQZz17ZW5kcG9pbnQ6XCJzZW5kVmVyaWZpY2F0aW9uQ29kZVwiLGFiOltcInBob25lTnVtYmVyXCIsXCJyZWNhcHRjaGFUb2tlblwiXSxjYjpcInNlc3Npb25JbmZvXCJ9LHNoPXtlbmRwb2ludDpcInNldEFjY291bnRJbmZvXCIsYWI6W1wiaWRUb2tlblwiXSxGOmtoLEFhOiEwfSxJZz17ZW5kcG9pbnQ6XCJzZXRBY2NvdW50SW5mb1wiLGFiOltcImlkVG9rZW5cIl0sRjpmdW5jdGlvbihhKXtraChhKTtpZighYS5wYXNzd29yZCl0aHJvdyBuZXcgTyhcIndlYWstcGFzc3dvcmRcIik7fSwkOnBoLEFhOiEwfSxyaD17ZW5kcG9pbnQ6XCJzaWdudXBOZXdVc2VyXCIsJDpwaCxBYTohMH0sQmg9e2VuZHBvaW50OlwidmVyaWZ5QXNzZXJ0aW9uXCIsRjp6aCwkOkFoLEFhOiEwfSxEaD17ZW5kcG9pbnQ6XCJ2ZXJpZnlBc3NlcnRpb25cIixGOnpoLCQ6ZnVuY3Rpb24oYSl7aWYoYS5lcnJvck1lc3NhZ2UmJlwiVVNFUl9OT1RfRk9VTkRcIj09YS5lcnJvck1lc3NhZ2UpdGhyb3cgbmV3IE8oXCJ1c2VyLW5vdC1mb3VuZFwiKTtcbmlmKCFhLmlkVG9rZW4pdGhyb3cgbmV3IE8oXCJpbnRlcm5hbC1lcnJvclwiKTt9LEFhOiEwfSxDaD17ZW5kcG9pbnQ6XCJ2ZXJpZnlBc3NlcnRpb25cIixGOmZ1bmN0aW9uKGEpe3poKGEpO2lmKCFhLmlkVG9rZW4pdGhyb3cgbmV3IE8oXCJpbnRlcm5hbC1lcnJvclwiKTt9LCQ6QWgsQWE6ITB9LE1oPXtlbmRwb2ludDpcInZlcmlmeUN1c3RvbVRva2VuXCIsRjpmdW5jdGlvbihhKXtpZighYS50b2tlbil0aHJvdyBuZXcgTyhcImludmFsaWQtY3VzdG9tLXRva2VuXCIpO30sJDpwaCxBYTohMH0sSGc9e2VuZHBvaW50OlwidmVyaWZ5UGFzc3dvcmRcIixGOmZ1bmN0aW9uKGEpe2poKGEpO2lmKCFhLnBhc3N3b3JkKXRocm93IG5ldyBPKFwid3JvbmctcGFzc3dvcmRcIik7fSwkOnBoLEFhOiEwfSx3aD17ZW5kcG9pbnQ6XCJ2ZXJpZnlQaG9uZU51bWJlclwiLEY6cWgsJDpwaH0sTWc9e2VuZHBvaW50OlwidmVyaWZ5UGhvbmVOdW1iZXJcIixGOmZ1bmN0aW9uKGEpe2lmKCFhLmlkVG9rZW4pdGhyb3cgbmV3IE8oXCJpbnRlcm5hbC1lcnJvclwiKTtcbnFoKGEpfSwkOmZ1bmN0aW9uKGEpe2lmKGEudGVtcG9yYXJ5UHJvb2YpdGhyb3cgYS5jb2RlPVwiY3JlZGVudGlhbC1hbHJlYWR5LWluLXVzZVwiLFVnKGEpO3BoKGEpfX0sTmc9e3lmOntVU0VSX05PVF9GT1VORDpcInVzZXItbm90LWZvdW5kXCJ9LGVuZHBvaW50OlwidmVyaWZ5UGhvbmVOdW1iZXJcIixGOnFoLCQ6cGh9LFE9ZnVuY3Rpb24oYSxiLGMpe2lmKCFlZyhjLGIuYWIpKXJldHVybiBFKG5ldyBPKFwiaW50ZXJuYWwtZXJyb3JcIikpO3ZhciBkPWIuRGV8fFwiUE9TVFwiLGU7cmV0dXJuIEQoYykudGhlbihiLkYpLnRoZW4oZnVuY3Rpb24oKXtiLkFhJiYoYy5yZXR1cm5TZWN1cmVUb2tlbj0hMCk7cmV0dXJuIGloKGEsYi5lbmRwb2ludCxkLGMsYi55ZixiLmllfHwhMSl9KS50aGVuKGZ1bmN0aW9uKGEpe3JldHVybiBlPWF9KS50aGVuKGIuJCkudGhlbihmdW5jdGlvbigpe2lmKCFiLmNiKXJldHVybiBlO2lmKCEoYi5jYiBpbiBlKSl0aHJvdyBuZXcgTyhcImludGVybmFsLWVycm9yXCIpO3JldHVybiBlW2IuY2JdfSl9LFxuZ2g9ZnVuY3Rpb24oYSxiKXt2YXIgYz0oYS5lcnJvciYmYS5lcnJvci5lcnJvcnMmJmEuZXJyb3IuZXJyb3JzWzBdfHx7fSkucmVhc29ufHxcIlwiO3ZhciBkPXtrZXlJbnZhbGlkOlwiaW52YWxpZC1hcGkta2V5XCIsaXBSZWZlcmVyQmxvY2tlZDpcImFwcC1ub3QtYXV0aG9yaXplZFwifTtpZihjPWRbY10/bmV3IE8oZFtjXSk6bnVsbClyZXR1cm4gYztjPWEuZXJyb3ImJmEuZXJyb3IubWVzc2FnZXx8XCJcIjtkPXtJTlZBTElEX0NVU1RPTV9UT0tFTjpcImludmFsaWQtY3VzdG9tLXRva2VuXCIsQ1JFREVOVElBTF9NSVNNQVRDSDpcImN1c3RvbS10b2tlbi1taXNtYXRjaFwiLE1JU1NJTkdfQ1VTVE9NX1RPS0VOOlwiaW50ZXJuYWwtZXJyb3JcIixJTlZBTElEX0lERU5USUZJRVI6XCJpbnZhbGlkLWVtYWlsXCIsTUlTU0lOR19DT05USU5VRV9VUkk6XCJpbnRlcm5hbC1lcnJvclwiLElOVkFMSURfRU1BSUw6XCJpbnZhbGlkLWVtYWlsXCIsSU5WQUxJRF9QQVNTV09SRDpcIndyb25nLXBhc3N3b3JkXCIsVVNFUl9ESVNBQkxFRDpcInVzZXItZGlzYWJsZWRcIixcbk1JU1NJTkdfUEFTU1dPUkQ6XCJpbnRlcm5hbC1lcnJvclwiLEVNQUlMX0VYSVNUUzpcImVtYWlsLWFscmVhZHktaW4tdXNlXCIsUEFTU1dPUkRfTE9HSU5fRElTQUJMRUQ6XCJvcGVyYXRpb24tbm90LWFsbG93ZWRcIixJTlZBTElEX0lEUF9SRVNQT05TRTpcImludmFsaWQtY3JlZGVudGlhbFwiLEZFREVSQVRFRF9VU0VSX0lEX0FMUkVBRFlfTElOS0VEOlwiY3JlZGVudGlhbC1hbHJlYWR5LWluLXVzZVwiLElOVkFMSURfTUVTU0FHRV9QQVlMT0FEOlwiaW52YWxpZC1tZXNzYWdlLXBheWxvYWRcIixJTlZBTElEX1JFQ0lQSUVOVF9FTUFJTDpcImludmFsaWQtcmVjaXBpZW50LWVtYWlsXCIsSU5WQUxJRF9TRU5ERVI6XCJpbnZhbGlkLXNlbmRlclwiLEVNQUlMX05PVF9GT1VORDpcInVzZXItbm90LWZvdW5kXCIsRVhQSVJFRF9PT0JfQ09ERTpcImV4cGlyZWQtYWN0aW9uLWNvZGVcIixJTlZBTElEX09PQl9DT0RFOlwiaW52YWxpZC1hY3Rpb24tY29kZVwiLE1JU1NJTkdfT09CX0NPREU6XCJpbnRlcm5hbC1lcnJvclwiLENSRURFTlRJQUxfVE9PX09MRF9MT0dJTl9BR0FJTjpcInJlcXVpcmVzLXJlY2VudC1sb2dpblwiLFxuSU5WQUxJRF9JRF9UT0tFTjpcImludmFsaWQtdXNlci10b2tlblwiLFRPS0VOX0VYUElSRUQ6XCJ1c2VyLXRva2VuLWV4cGlyZWRcIixVU0VSX05PVF9GT1VORDpcInVzZXItdG9rZW4tZXhwaXJlZFwiLENPUlNfVU5TVVBQT1JURUQ6XCJjb3JzLXVuc3VwcG9ydGVkXCIsRFlOQU1JQ19MSU5LX05PVF9BQ1RJVkFURUQ6XCJkeW5hbWljLWxpbmstbm90LWFjdGl2YXRlZFwiLElOVkFMSURfQVBQX0lEOlwiaW52YWxpZC1hcHAtaWRcIixUT09fTUFOWV9BVFRFTVBUU19UUllfTEFURVI6XCJ0b28tbWFueS1yZXF1ZXN0c1wiLFdFQUtfUEFTU1dPUkQ6XCJ3ZWFrLXBhc3N3b3JkXCIsT1BFUkFUSU9OX05PVF9BTExPV0VEOlwib3BlcmF0aW9uLW5vdC1hbGxvd2VkXCIsVVNFUl9DQU5DRUxMRUQ6XCJ1c2VyLWNhbmNlbGxlZFwiLENBUFRDSEFfQ0hFQ0tfRkFJTEVEOlwiY2FwdGNoYS1jaGVjay1mYWlsZWRcIixJTlZBTElEX0FQUF9DUkVERU5USUFMOlwiaW52YWxpZC1hcHAtY3JlZGVudGlhbFwiLElOVkFMSURfQ09ERTpcImludmFsaWQtdmVyaWZpY2F0aW9uLWNvZGVcIixcbklOVkFMSURfUEhPTkVfTlVNQkVSOlwiaW52YWxpZC1waG9uZS1udW1iZXJcIixJTlZBTElEX1NFU1NJT05fSU5GTzpcImludmFsaWQtdmVyaWZpY2F0aW9uLWlkXCIsSU5WQUxJRF9URU1QT1JBUllfUFJPT0Y6XCJpbnZhbGlkLWNyZWRlbnRpYWxcIixNSVNTSU5HX0FQUF9DUkVERU5USUFMOlwibWlzc2luZy1hcHAtY3JlZGVudGlhbFwiLE1JU1NJTkdfQ09ERTpcIm1pc3NpbmctdmVyaWZpY2F0aW9uLWNvZGVcIixNSVNTSU5HX1BIT05FX05VTUJFUjpcIm1pc3NpbmctcGhvbmUtbnVtYmVyXCIsTUlTU0lOR19TRVNTSU9OX0lORk86XCJtaXNzaW5nLXZlcmlmaWNhdGlvbi1pZFwiLFFVT1RBX0VYQ0VFREVEOlwicXVvdGEtZXhjZWVkZWRcIixTRVNTSU9OX0VYUElSRUQ6XCJjb2RlLWV4cGlyZWRcIixJTlZBTElEX0NPTlRJTlVFX1VSSTpcImludmFsaWQtY29udGludWUtdXJpXCIsTUlTU0lOR19BTkRST0lEX1BBQ0tBR0VfTkFNRTpcIm1pc3NpbmctYW5kcm9pZC1wa2ctbmFtZVwiLE1JU1NJTkdfSU9TX0JVTkRMRV9JRDpcIm1pc3NpbmctaW9zLWJ1bmRsZS1pZFwiLFxuVU5BVVRIT1JJWkVEX0RPTUFJTjpcInVuYXV0aG9yaXplZC1jb250aW51ZS11cmlcIixJTlZBTElEX09BVVRIX0NMSUVOVF9JRDpcImludmFsaWQtb2F1dGgtY2xpZW50LWlkXCJ9O21iKGQsYnx8e30pO2I9KGI9Yy5tYXRjaCgvXlteXFxzXStcXHMqOlxccyooLiopJC8pKSYmMTxiLmxlbmd0aD9iWzFdOnZvaWQgMDtmb3IodmFyIGUgaW4gZClpZigwPT09Yy5pbmRleE9mKGUpKXJldHVybiBuZXcgTyhkW2VdLGIpOyFiJiZhJiYoYj1QZihhKSk7cmV0dXJuIG5ldyBPKFwiaW50ZXJuYWwtZXJyb3JcIixiKX07dmFyIE9oPWZ1bmN0aW9uKGEpe3RoaXMuQmc9YTt0aGlzLnljPW51bGw7dGhpcy5JZD1OaCh0aGlzKX0sTmg9ZnVuY3Rpb24oYSl7cmV0dXJuIFBoKCkudGhlbihmdW5jdGlvbigpe3JldHVybiBuZXcgQyhmdW5jdGlvbihiLGMpe00oXCJnYXBpLmlmcmFtZXMuZ2V0Q29udGV4dFwiKSgpLm9wZW4oe3doZXJlOmRvY3VtZW50LmJvZHksdXJsOmEuQmcsbWVzc2FnZUhhbmRsZXJzRmlsdGVyOk0oXCJnYXBpLmlmcmFtZXMuQ1JPU1NfT1JJR0lOX0lGUkFNRVNfRklMVEVSXCIpLGF0dHJpYnV0ZXM6e3N0eWxlOntwb3NpdGlvbjpcImFic29sdXRlXCIsdG9wOlwiLTEwMHB4XCIsd2lkdGg6XCIxcHhcIixoZWlnaHQ6XCIxcHhcIn19LGRvbnRjbGVhcjohMH0sZnVuY3Rpb24oZCl7YS55Yz1kO2EueWMucmVzdHlsZSh7c2V0SGlkZU9uTGVhdmU6ITF9KTt2YXIgZT1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7YyhFcnJvcihcIk5ldHdvcmsgRXJyb3JcIikpfSxRaC5nZXQoKSksZj1mdW5jdGlvbigpe2NsZWFyVGltZW91dChlKTtcbmIoKX07ZC5waW5nKGYpLnRoZW4oZixmdW5jdGlvbigpe2MoRXJyb3IoXCJOZXR3b3JrIEVycm9yXCIpKX0pfSl9KX0pfTtPaC5wcm90b3R5cGUuc2VuZE1lc3NhZ2U9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztyZXR1cm4gdGhpcy5JZC50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBDKGZ1bmN0aW9uKGMpe2IueWMuc2VuZChhLnR5cGUsYSxjLE0oXCJnYXBpLmlmcmFtZXMuQ1JPU1NfT1JJR0lOX0lGUkFNRVNfRklMVEVSXCIpKX0pfSl9O1xudmFyIFJoPWZ1bmN0aW9uKGEsYil7YS5JZC50aGVuKGZ1bmN0aW9uKCl7YS55Yy5yZWdpc3RlcihcImF1dGhFdmVudFwiLGIsTShcImdhcGkuaWZyYW1lcy5DUk9TU19PUklHSU5fSUZSQU1FU19GSUxURVJcIikpfSl9LFNoPUhhKFwiaHR0cHM6Ly9hcGlzLmdvb2dsZS5jb20vanMvYXBpLmpzP29ubG9hZD0le29ubG9hZH1cIiksVGg9bmV3IFZmKDNFNCw2RTQpLFFoPW5ldyBWZig1RTMsMTVFMyksVWg9bnVsbCxQaD1mdW5jdGlvbigpe3JldHVybiBVaD9VaDpVaD0obmV3IEMoZnVuY3Rpb24oYSxiKXtpZihVZigpKXt2YXIgYz1mdW5jdGlvbigpe1RmKCk7TShcImdhcGkubG9hZFwiKShcImdhcGkuaWZyYW1lc1wiLHtjYWxsYmFjazphLG9udGltZW91dDpmdW5jdGlvbigpe1RmKCk7YihFcnJvcihcIk5ldHdvcmsgRXJyb3JcIikpfSx0aW1lb3V0OlRoLmdldCgpfSl9O2lmKE0oXCJnYXBpLmlmcmFtZXMuSWZyYW1lXCIpKWEoKTtlbHNlIGlmKE0oXCJnYXBpLmxvYWRcIikpYygpO2Vsc2V7dmFyIGQ9XCJfX2lmcmFtZWZjYlwiK1xuTWF0aC5mbG9vcigxRTYqTWF0aC5yYW5kb20oKSkudG9TdHJpbmcoKTtrW2RdPWZ1bmN0aW9uKCl7TShcImdhcGkubG9hZFwiKT9jKCk6YihFcnJvcihcIk5ldHdvcmsgRXJyb3JcIikpfTtkPU9hKFNoLHtvbmxvYWQ6ZH0pO0QoZGUoZCkpLmcoZnVuY3Rpb24oKXtiKEVycm9yKFwiTmV0d29yayBFcnJvclwiKSl9KX19ZWxzZSBiKEVycm9yKFwiTmV0d29yayBFcnJvclwiKSl9KSkuZyhmdW5jdGlvbihhKXtVaD1udWxsO3Rocm93IGE7fSl9O3ZhciBWaD1mdW5jdGlvbihhLGIsYyl7dGhpcy5CPWE7dGhpcy5tPWI7dGhpcy5vPWM7dGhpcy5mYj1udWxsO3RoaXMuQmE9aGYodGhpcy5CLFwiL19fL2F1dGgvaWZyYW1lXCIpO0sodGhpcy5CYSxcImFwaUtleVwiLHRoaXMubSk7Syh0aGlzLkJhLFwiYXBwTmFtZVwiLHRoaXMubyk7dGhpcy5QPW51bGw7dGhpcy5NPVtdfTtWaC5wcm90b3R5cGUuYWU9ZnVuY3Rpb24oYSl7dGhpcy5mYj1hO3JldHVybiB0aGlzfTtWaC5wcm90b3R5cGUuWmQ9ZnVuY3Rpb24oYSl7dGhpcy5QPWE7cmV0dXJuIHRoaXN9O1xuVmgucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7dGhpcy5mYj9LKHRoaXMuQmEsXCJ2XCIsdGhpcy5mYik6dGhpcy5CYS5yZW1vdmVQYXJhbWV0ZXIoXCJ2XCIpO3RoaXMuUD9LKHRoaXMuQmEsXCJlaWRcIix0aGlzLlApOnRoaXMuQmEucmVtb3ZlUGFyYW1ldGVyKFwiZWlkXCIpO3RoaXMuTS5sZW5ndGg/Syh0aGlzLkJhLFwiZndcIix0aGlzLk0uam9pbihcIixcIikpOnRoaXMuQmEucmVtb3ZlUGFyYW1ldGVyKFwiZndcIik7cmV0dXJuIHRoaXMuQmEudG9TdHJpbmcoKX07dmFyIFdoPWZ1bmN0aW9uKGEsYixjLGQsZSl7dGhpcy5CPWE7dGhpcy5tPWI7dGhpcy5vPWM7dGhpcy5zZj1kO3RoaXMuZmI9dGhpcy5ZPXRoaXMuVGQ9bnVsbDt0aGlzLnhiPWU7dGhpcy5QPW51bGx9O1doLnByb3RvdHlwZS5hZT1mdW5jdGlvbihhKXt0aGlzLmZiPWE7cmV0dXJuIHRoaXN9O1doLnByb3RvdHlwZS5aZD1mdW5jdGlvbihhKXt0aGlzLlA9YTtyZXR1cm4gdGhpc307XG5XaC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXt2YXIgYT1oZih0aGlzLkIsXCIvX18vYXV0aC9oYW5kbGVyXCIpO0soYSxcImFwaUtleVwiLHRoaXMubSk7SyhhLFwiYXBwTmFtZVwiLHRoaXMubyk7SyhhLFwiYXV0aFR5cGVcIix0aGlzLnNmKTtpZih0aGlzLnhiLmlzT0F1dGhQcm92aWRlcil7dmFyIGI9dGhpcy54Yjt0cnl7dmFyIGM9ZmlyZWJhc2UuYXBwKHRoaXMubykuYXV0aCgpLmlhfWNhdGNoKGwpe2M9bnVsbH1iLm5kPWM7SyhhLFwicHJvdmlkZXJJZFwiLHRoaXMueGIucHJvdmlkZXJJZCk7Yj10aGlzLnhiO2M9UWYoYi5xZSk7Zm9yKHZhciBkIGluIGMpY1tkXT1jW2RdLnRvU3RyaW5nKCk7ZD1iLmtnO2M9a2IoYyk7Zm9yKHZhciBlPTA7ZTxkLmxlbmd0aDtlKyspe3ZhciBmPWRbZV07ZiBpbiBjJiZkZWxldGUgY1tmXX1iLkVkJiZiLm5kJiYhY1tiLkVkXSYmKGNbYi5FZF09Yi5uZCk7aWIoYyl8fEsoYSxcImN1c3RvbVBhcmFtZXRlcnNcIixQZihjKSl9XCJmdW5jdGlvblwiPT09dHlwZW9mIHRoaXMueGIueWUmJlxuKGI9dGhpcy54Yi55ZSgpLGIubGVuZ3RoJiZLKGEsXCJzY29wZXNcIixiLmpvaW4oXCIsXCIpKSk7dGhpcy5UZD9LKGEsXCJyZWRpcmVjdFVybFwiLHRoaXMuVGQpOmEucmVtb3ZlUGFyYW1ldGVyKFwicmVkaXJlY3RVcmxcIik7dGhpcy5ZP0soYSxcImV2ZW50SWRcIix0aGlzLlkpOmEucmVtb3ZlUGFyYW1ldGVyKFwiZXZlbnRJZFwiKTt0aGlzLmZiP0soYSxcInZcIix0aGlzLmZiKTphLnJlbW92ZVBhcmFtZXRlcihcInZcIik7aWYodGhpcy5tYylmb3IodmFyIGcgaW4gdGhpcy5tYyl0aGlzLm1jLmhhc093blByb3BlcnR5KGcpJiYhZmYoYSxnKSYmSyhhLGcsdGhpcy5tY1tnXSk7dGhpcy5QP0soYSxcImVpZFwiLHRoaXMuUCk6YS5yZW1vdmVQYXJhbWV0ZXIoXCJlaWRcIik7Zz1YaCh0aGlzLm8pO2cubGVuZ3RoJiZLKGEsXCJmd1wiLGcuam9pbihcIixcIikpO3JldHVybiBhLnRvU3RyaW5nKCl9O1xudmFyIFhoPWZ1bmN0aW9uKGEpe3RyeXtyZXR1cm4gJGEoZmlyZWJhc2UuYXBwKGEpLmF1dGgoKS5NKX1jYXRjaChiKXtyZXR1cm5bXX19LFloPWZ1bmN0aW9uKGEsYixjLGQsZSl7dGhpcy5CPWE7dGhpcy5tPWI7dGhpcy5vPWM7dGhpcy5MYT1kfHxudWxsO3RoaXMuUD1lfHxudWxsO3RoaXMuZj10aGlzLnlkPXRoaXMud2U9bnVsbDt0aGlzLnRhPVtdO3RoaXMuQWM9dGhpcy53YT1udWxsfSxaaD1mdW5jdGlvbihhKXt2YXIgYj1yZigpO3JldHVybiBvaChhKS50aGVuKGZ1bmN0aW9uKGEpe2E6e3ZhciBjPWdmKGIpLGU9Yy5xYTtjPWMucGE7Zm9yKHZhciBmPTA7ZjxhLmxlbmd0aDtmKyspe3ZhciBnPWFbZl07dmFyIGw9Yzt2YXIgbj1lOzA9PWcuaW5kZXhPZihcImNocm9tZS1leHRlbnNpb246Ly9cIik/bD1nZihnKS5wYT09bCYmXCJjaHJvbWUtZXh0ZW5zaW9uXCI9PW46XCJodHRwXCIhPW4mJlwiaHR0cHNcIiE9bj9sPSExOkFmLnRlc3QoZyk/bD1sPT1nOihnPWcuc3BsaXQoXCIuXCIpLmpvaW4oXCJcXFxcLlwiKSxcbmw9KG5ldyBSZWdFeHAoXCJeKC4rXFxcXC5cIitnK1wifFwiK2crXCIpJFwiLFwiaVwiKSkudGVzdChsKSk7aWYobCl7YT0hMDticmVhayBhfX1hPSExfWlmKCFhKXRocm93IG5ldyBvZyhyZigpKTt9KX07aD1ZaC5wcm90b3R5cGU7aC5TYj1mdW5jdGlvbigpe2lmKHRoaXMuQWMpcmV0dXJuIHRoaXMuQWM7dmFyIGE9dGhpcztyZXR1cm4gdGhpcy5BYz1CZigpLnRoZW4oZnVuY3Rpb24oKXtpZighYS55ZCl7dmFyIGI9YS5MYSxjPWEuUCxkPVhoKGEubyk7Yj0obmV3IFZoKGEuQixhLm0sYS5vKSkuYWUoYikuWmQoYyk7Yi5NPSRhKGR8fFtdKTthLnlkPWIudG9TdHJpbmcoKX1hLnhjPW5ldyBPaChhLnlkKTskaChhKX0pfTtcbmguZWM9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPW5ldyBPKFwicG9wdXAtY2xvc2VkLWJ5LXVzZXJcIiksZT1uZXcgTyhcIndlYi1zdG9yYWdlLXVuc3VwcG9ydGVkXCIpLGY9dGhpcyxnPSExO3JldHVybiB0aGlzLlJhKCkudGhlbihmdW5jdGlvbigpe2FpKGYpLnRoZW4oZnVuY3Rpb24oYyl7Y3x8KGEmJnhmKGEpLGIoZSksZz0hMCl9KX0pLmcoZnVuY3Rpb24oKXt9KS50aGVuKGZ1bmN0aW9uKCl7aWYoIWcpcmV0dXJuIHpmKGEpfSkudGhlbihmdW5jdGlvbigpe2lmKCFnKXJldHVybiBCZShjKS50aGVuKGZ1bmN0aW9uKCl7YihkKX0pfSl9O2guWWU9ZnVuY3Rpb24oKXt2YXIgYT1MKCk7cmV0dXJuIU9mKGEpJiYhU2YoYSl9O2guQmU9ZnVuY3Rpb24oKXtyZXR1cm4hMX07XG5oLiRiPWZ1bmN0aW9uKGEsYixjLGQsZSxmLGcpe2lmKCFhKXJldHVybiBFKG5ldyBPKFwicG9wdXAtYmxvY2tlZFwiKSk7aWYoZyYmIU9mKCkpcmV0dXJuIHRoaXMuUmEoKS5nKGZ1bmN0aW9uKGIpe3hmKGEpO2UoYil9KSxkKCksRCgpO3RoaXMud2F8fCh0aGlzLndhPVpoKGJpKHRoaXMpKSk7dmFyIGw9dGhpcztyZXR1cm4gdGhpcy53YS50aGVuKGZ1bmN0aW9uKCl7dmFyIGI9bC5SYSgpLmcoZnVuY3Rpb24oYil7eGYoYSk7ZShiKTt0aHJvdyBiO30pO2QoKTtyZXR1cm4gYn0pLnRoZW4oZnVuY3Rpb24oKXtTZyhjKTtpZighZyl7dmFyIGQ9Y2kobC5CLGwubSxsLm8sYixjLG51bGwsZixsLkxhLHZvaWQgMCxsLlApO3NmKGQsYSl9fSkuZyhmdW5jdGlvbihhKXtcImF1dGgvbmV0d29yay1yZXF1ZXN0LWZhaWxlZFwiPT1hLmNvZGUmJihsLndhPW51bGwpO3Rocm93IGE7fSl9O1xudmFyIGJpPWZ1bmN0aW9uKGEpe2EuZnx8KGEud2U9YS5MYT9KZihhLkxhLFhoKGEubykpOm51bGwsYS5mPW5ldyBSKGEubSxvZihhLlApLGEud2UpKTtyZXR1cm4gYS5mfTtZaC5wcm90b3R5cGUuYWM9ZnVuY3Rpb24oYSxiLGMpe3RoaXMud2F8fCh0aGlzLndhPVpoKGJpKHRoaXMpKSk7dmFyIGQ9dGhpcztyZXR1cm4gdGhpcy53YS50aGVuKGZ1bmN0aW9uKCl7U2coYik7dmFyIGU9Y2koZC5CLGQubSxkLm8sYSxiLHJmKCksYyxkLkxhLHZvaWQgMCxkLlApO3NmKGUpfSkuZyhmdW5jdGlvbihhKXtcImF1dGgvbmV0d29yay1yZXF1ZXN0LWZhaWxlZFwiPT1hLmNvZGUmJihkLndhPW51bGwpO3Rocm93IGE7fSl9O1loLnByb3RvdHlwZS5SYT1mdW5jdGlvbigpe3ZhciBhPXRoaXM7cmV0dXJuIHRoaXMuU2IoKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGEueGMuSWR9KS5nKGZ1bmN0aW9uKCl7YS53YT1udWxsO3Rocm93IG5ldyBPKFwibmV0d29yay1yZXF1ZXN0LWZhaWxlZFwiKTt9KX07XG5ZaC5wcm90b3R5cGUuYmY9ZnVuY3Rpb24oKXtyZXR1cm4hMH07XG52YXIgY2k9ZnVuY3Rpb24oYSxiLGMsZCxlLGYsZyxsLG4sRil7YT1uZXcgV2goYSxiLGMsZCxlKTthLlRkPWY7YS5ZPWc7Zj1hLmFlKGwpO2YubWM9a2Iobnx8bnVsbCk7cmV0dXJuIGYuWmQoRikudG9TdHJpbmcoKX0sJGg9ZnVuY3Rpb24oYSl7aWYoIWEueGMpdGhyb3cgRXJyb3IoXCJJZmNIYW5kbGVyIG11c3QgYmUgaW5pdGlhbGl6ZWQhXCIpO1JoKGEueGMsZnVuY3Rpb24oYil7dmFyIGM9e307aWYoYiYmYi5hdXRoRXZlbnQpe3ZhciBkPSExO2I9bmcoYi5hdXRoRXZlbnQpO2ZvcihjPTA7YzxhLnRhLmxlbmd0aDtjKyspZD1hLnRhW2NdKGIpfHxkO2M9e307Yy5zdGF0dXM9ZD9cIkFDS1wiOlwiRVJST1JcIjtyZXR1cm4gRChjKX1jLnN0YXR1cz1cIkVSUk9SXCI7cmV0dXJuIEQoYyl9KX0sYWk9ZnVuY3Rpb24oYSl7dmFyIGI9e3R5cGU6XCJ3ZWJTdG9yYWdlU3VwcG9ydFwifTtyZXR1cm4gYS5TYigpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gYS54Yy5zZW5kTWVzc2FnZShiKX0pLnRoZW4oZnVuY3Rpb24oYSl7aWYoYSYmYS5sZW5ndGgmJlxuXCJ1bmRlZmluZWRcIiE9PXR5cGVvZiBhWzBdLndlYlN0b3JhZ2VTdXBwb3J0KXJldHVybiBhWzBdLndlYlN0b3JhZ2VTdXBwb3J0O3Rocm93IEVycm9yKCk7fSl9O1loLnByb3RvdHlwZS5pYj1mdW5jdGlvbihhKXt0aGlzLnRhLnB1c2goYSl9O1loLnByb3RvdHlwZS5kYz1mdW5jdGlvbihhKXtZYSh0aGlzLnRhLGZ1bmN0aW9uKGIpe3JldHVybiBiPT1hfSl9O3ZhciBkaT1mdW5jdGlvbihhLGIsYyxkLGUsZil7Tih0aGlzLFwidHlwZVwiLFwicmVjYXB0Y2hhXCIpO3RoaXMuYWQ9dGhpcy5JYj1udWxsO3RoaXMuS2I9ITE7dGhpcy5uZT1iO3RoaXMuRmE9Y3x8e3RoZW1lOlwibGlnaHRcIix0eXBlOlwiaW1hZ2VcIn07dGhpcy5KPVtdO2lmKHRoaXMuRmEuc2l0ZWtleSl0aHJvdyBuZXcgTyhcImFyZ3VtZW50LWVycm9yXCIsXCJzaXRla2V5IHNob3VsZCBub3QgYmUgcHJvdmlkZWQgZm9yIHJlQ0FQVENIQSBhcyBvbmUgaXMgYXV0b21hdGljYWxseSBwcm92aXNpb25lZCBmb3IgdGhlIGN1cnJlbnQgcHJvamVjdC5cIik7dGhpcy5CYz1cImludmlzaWJsZVwiPT09dGhpcy5GYS5zaXplO2lmKCFsZChiKXx8IXRoaXMuQmMmJmxkKGIpLmhhc0NoaWxkTm9kZXMoKSl0aHJvdyBuZXcgTyhcImFyZ3VtZW50LWVycm9yXCIsXCJyZUNBUFRDSEEgY29udGFpbmVyIGlzIGVpdGhlciBub3QgZm91bmQgb3IgYWxyZWFkeSBjb250YWlucyBpbm5lciBlbGVtZW50cyFcIik7dGhpcy5mPW5ldyBSKGEsXG5mfHxudWxsLGV8fG51bGwpO3RoaXMuSmY9ZHx8ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH07dmFyIGc9dGhpczt0aGlzLldjPVtdO3ZhciBsPXRoaXMuRmEuY2FsbGJhY2s7dGhpcy5GYS5jYWxsYmFjaz1mdW5jdGlvbihhKXtnLkxiKGEpO2lmKFwiZnVuY3Rpb25cIj09PXR5cGVvZiBsKWwoYSk7ZWxzZSBpZihcInN0cmluZ1wiPT09dHlwZW9mIGwpe3ZhciBiPU0obCxrKTtcImZ1bmN0aW9uXCI9PT10eXBlb2YgYiYmYihhKX19O3ZhciBuPXRoaXMuRmFbXCJleHBpcmVkLWNhbGxiYWNrXCJdO3RoaXMuRmFbXCJleHBpcmVkLWNhbGxiYWNrXCJdPWZ1bmN0aW9uKCl7Zy5MYihudWxsKTtpZihcImZ1bmN0aW9uXCI9PT10eXBlb2YgbiluKCk7ZWxzZSBpZihcInN0cmluZ1wiPT09dHlwZW9mIG4pe3ZhciBhPU0obixrKTtcImZ1bmN0aW9uXCI9PT10eXBlb2YgYSYmYSgpfX19O2RpLnByb3RvdHlwZS5MYj1mdW5jdGlvbihhKXtmb3IodmFyIGI9MDtiPHRoaXMuV2MubGVuZ3RoO2IrKyl0cnl7dGhpcy5XY1tiXShhKX1jYXRjaChjKXt9fTtcbnZhciBlaT1mdW5jdGlvbihhLGIpe1lhKGEuV2MsZnVuY3Rpb24oYSl7cmV0dXJuIGE9PWJ9KX07ZGkucHJvdG90eXBlLmM9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpczt0aGlzLkoucHVzaChhKTtFZChhLGZ1bmN0aW9uKCl7WGEoYi5KLGEpfSk7cmV0dXJuIGF9O1xuZGkucHJvdG90eXBlLlRiPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcztyZXR1cm4gdGhpcy5JYj90aGlzLkliOnRoaXMuSWI9dGhpcy5jKEQoKS50aGVuKGZ1bmN0aW9uKCl7aWYoTWYoKSlyZXR1cm4gQmYoKTt0aHJvdyBuZXcgTyhcIm9wZXJhdGlvbi1ub3Qtc3VwcG9ydGVkLWluLXRoaXMtZW52aXJvbm1lbnRcIixcIlJlY2FwdGNoYVZlcmlmaWVyIGlzIG9ubHkgc3VwcG9ydGVkIGluIGEgYnJvd3NlciBIVFRQL0hUVFBTIGVudmlyb25tZW50LlwiKTt9KS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGZpKGdpKCksYS5KZigpKX0pLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gUShhLmYsTGgse30pfSkudGhlbihmdW5jdGlvbihiKXthLkZhLnNpdGVrZXk9Yi5yZWNhcHRjaGFTaXRlS2V5fSkuZyhmdW5jdGlvbihiKXthLkliPW51bGw7dGhyb3cgYjt9KSl9O1xuZGkucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbigpe2hpKHRoaXMpO3ZhciBhPXRoaXM7cmV0dXJuIHRoaXMuYyh0aGlzLlRiKCkudGhlbihmdW5jdGlvbigpe2lmKG51bGw9PT1hLmFkKXt2YXIgYj1hLm5lO2lmKCFhLkJjKXt2YXIgYz1sZChiKTtiPXBkKFwiRElWXCIpO2MuYXBwZW5kQ2hpbGQoYil9YS5hZD1ncmVjYXB0Y2hhLnJlbmRlcihiLGEuRmEpfXJldHVybiBhLmFkfSkpfTtkaS5wcm90b3R5cGUudmVyaWZ5PWZ1bmN0aW9uKCl7aGkodGhpcyk7dmFyIGE9dGhpcztyZXR1cm4gdGhpcy5jKHRoaXMucmVuZGVyKCkudGhlbihmdW5jdGlvbihiKXtyZXR1cm4gbmV3IEMoZnVuY3Rpb24oYyl7dmFyIGQ9Z3JlY2FwdGNoYS5nZXRSZXNwb25zZShiKTtpZihkKWMoZCk7ZWxzZXt2YXIgZT1mdW5jdGlvbihiKXtiJiYoZWkoYSxlKSxjKGIpKX07YS5XYy5wdXNoKGUpO2EuQmMmJmdyZWNhcHRjaGEuZXhlY3V0ZShhLmFkKX19KX0pKX07XG52YXIgaGk9ZnVuY3Rpb24oYSl7aWYoYS5LYil0aHJvdyBuZXcgTyhcImludGVybmFsLWVycm9yXCIsXCJSZWNhcHRjaGFWZXJpZmllciBpbnN0YW5jZSBoYXMgYmVlbiBkZXN0cm95ZWQuXCIpO307ZGkucHJvdG90eXBlLmNsZWFyPWZ1bmN0aW9uKCl7aGkodGhpcyk7dGhpcy5LYj0hMDtnaSgpLmxkLS07Zm9yKHZhciBhPTA7YTx0aGlzLkoubGVuZ3RoO2ErKyl0aGlzLkpbYV0uY2FuY2VsKFwiUmVjYXB0Y2hhVmVyaWZpZXIgaW5zdGFuY2UgaGFzIGJlZW4gZGVzdHJveWVkLlwiKTtpZighdGhpcy5CYyl7YT1sZCh0aGlzLm5lKTtmb3IodmFyIGI7Yj1hLmZpcnN0Q2hpbGQ7KWEucmVtb3ZlQ2hpbGQoYil9fTtcbnZhciBpaT1IYShcImh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vcmVjYXB0Y2hhL2FwaS5qcz9vbmxvYWQ9JXtvbmxvYWR9JnJlbmRlcj1leHBsaWNpdCZobD0le2hsfVwiKSxqaT1mdW5jdGlvbigpe3RoaXMubGQ9ay5ncmVjYXB0Y2hhP0luZmluaXR5OjA7dGhpcy5DZT1udWxsO3RoaXMuamQ9XCJfX3JjYlwiK01hdGguZmxvb3IoMUU2Kk1hdGgucmFuZG9tKCkpLnRvU3RyaW5nKCl9LGZpPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBDKGZ1bmN0aW9uKGMsZCl7aWYoVWYoKSlpZighay5ncmVjYXB0Y2hhfHxiIT09YS5DZSYmIWEubGQpe2tbYS5qZF09ZnVuY3Rpb24oKXtpZihrLmdyZWNhcHRjaGEpe2EuQ2U9Yjt2YXIgZT1rLmdyZWNhcHRjaGEucmVuZGVyO2suZ3JlY2FwdGNoYS5yZW5kZXI9ZnVuY3Rpb24oYixjKXtiPWUoYixjKTthLmxkKys7cmV0dXJuIGJ9O2MoKX1lbHNlIGQobmV3IE8oXCJpbnRlcm5hbC1lcnJvclwiKSk7ZGVsZXRlIGtbYS5qZF19O3ZhciBlPU9hKGlpLHtvbmxvYWQ6YS5qZCxcbmhsOmJ8fFwiXCJ9KTtEKGRlKGUpKS5nKGZ1bmN0aW9uKCl7ZChuZXcgTyhcImludGVybmFsLWVycm9yXCIsXCJVbmFibGUgdG8gbG9hZCBleHRlcm5hbCByZUNBUFRDSEEgZGVwZW5kZW5jaWVzIVwiKSl9KX1lbHNlIGMoKTtlbHNlIGQobmV3IE8oXCJuZXR3b3JrLXJlcXVlc3QtZmFpbGVkXCIpKX0pfSxraT1udWxsLGdpPWZ1bmN0aW9uKCl7a2l8fChraT1uZXcgamkpO3JldHVybiBraX0sbGk9ZnVuY3Rpb24oYSxiLGMpe3RyeXt0aGlzLmk9Y3x8ZmlyZWJhc2UuYXBwKCl9Y2F0Y2goZil7dGhyb3cgbmV3IE8oXCJhcmd1bWVudC1lcnJvclwiLFwiTm8gZmlyZWJhc2UuYXBwLkFwcCBpbnN0YW5jZSBpcyBjdXJyZW50bHkgaW5pdGlhbGl6ZWQuXCIpO31pZih0aGlzLmkub3B0aW9ucyYmdGhpcy5pLm9wdGlvbnMuYXBpS2V5KWM9dGhpcy5pLm9wdGlvbnMuYXBpS2V5O2Vsc2UgdGhyb3cgbmV3IE8oXCJpbnZhbGlkLWFwaS1rZXlcIik7dmFyIGQ9dGhpcyxlPW51bGw7dHJ5e2U9JGEodGhpcy5pLmF1dGgoKS5NKX1jYXRjaChmKXt9ZT1cbmZpcmViYXNlLlNES19WRVJTSU9OP0pmKGZpcmViYXNlLlNES19WRVJTSU9OLGUpOm51bGw7ZGkuY2FsbCh0aGlzLGMsYSxiLGZ1bmN0aW9uKCl7dHJ5e3ZhciBhPWQuaS5hdXRoKCkuaWF9Y2F0Y2goZyl7YT1udWxsfXJldHVybiBhfSxlLG9mKHBmKSl9O3QobGksZGkpO3ZhciBtaT1mdW5jdGlvbihhKXt0aGlzLkc9YXx8ZmlyZWJhc2UuSU5URVJOQUwucmVhY3ROYXRpdmUmJmZpcmViYXNlLklOVEVSTkFMLnJlYWN0TmF0aXZlLkFzeW5jU3RvcmFnZTtpZighdGhpcy5HKXRocm93IG5ldyBPKFwiaW50ZXJuYWwtZXJyb3JcIixcIlRoZSBSZWFjdCBOYXRpdmUgY29tcGF0aWJpbGl0eSBsaWJyYXJ5IHdhcyBub3QgZm91bmQuXCIpO307aD1taS5wcm90b3R5cGU7aC5nZXQ9ZnVuY3Rpb24oYSl7cmV0dXJuIEQodGhpcy5HLmdldEl0ZW0oYSkpLnRoZW4oZnVuY3Rpb24oYSl7cmV0dXJuIGEmJlJmKGEpfSl9O2guc2V0PWZ1bmN0aW9uKGEsYil7cmV0dXJuIEQodGhpcy5HLnNldEl0ZW0oYSxQZihiKSkpfTtoLnJlbW92ZT1mdW5jdGlvbihhKXtyZXR1cm4gRCh0aGlzLkcucmVtb3ZlSXRlbShhKSl9O2guamI9ZnVuY3Rpb24oKXt9O2guJGE9ZnVuY3Rpb24oKXt9O3ZhciBuaT1mdW5jdGlvbigpe3RoaXMuRz17fX07aD1uaS5wcm90b3R5cGU7aC5nZXQ9ZnVuY3Rpb24oYSl7cmV0dXJuIEQodGhpcy5HW2FdKX07aC5zZXQ9ZnVuY3Rpb24oYSxiKXt0aGlzLkdbYV09YjtyZXR1cm4gRCgpfTtoLnJlbW92ZT1mdW5jdGlvbihhKXtkZWxldGUgdGhpcy5HW2FdO3JldHVybiBEKCl9O2guamI9ZnVuY3Rpb24oKXt9O2guJGE9ZnVuY3Rpb24oKXt9O3ZhciBwaT1mdW5jdGlvbigpe2lmKCFvaSgpKXtpZihcIk5vZGVcIj09R2YoKSl0aHJvdyBuZXcgTyhcImludGVybmFsLWVycm9yXCIsXCJUaGUgTG9jYWxTdG9yYWdlIGNvbXBhdGliaWxpdHkgbGlicmFyeSB3YXMgbm90IGZvdW5kLlwiKTt0aHJvdyBuZXcgTyhcIndlYi1zdG9yYWdlLXVuc3VwcG9ydGVkXCIpO310aGlzLkc9ay5sb2NhbFN0b3JhZ2V8fGZpcmViYXNlLklOVEVSTkFMLm5vZGUubG9jYWxTdG9yYWdlfSxvaT1mdW5jdGlvbigpe3ZhciBhPVwiTm9kZVwiPT1HZigpO2E9ay5sb2NhbFN0b3JhZ2V8fGEmJmZpcmViYXNlLklOVEVSTkFMLm5vZGUmJmZpcmViYXNlLklOVEVSTkFMLm5vZGUubG9jYWxTdG9yYWdlO2lmKCFhKXJldHVybiExO3RyeXtyZXR1cm4gYS5zZXRJdGVtKFwiX19zYWtcIixcIjFcIiksYS5yZW1vdmVJdGVtKFwiX19zYWtcIiksITB9Y2F0Y2goYil7cmV0dXJuITF9fTtoPXBpLnByb3RvdHlwZTtcbmguZ2V0PWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7cmV0dXJuIEQoKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGM9Yi5HLmdldEl0ZW0oYSk7cmV0dXJuIFJmKGMpfSl9O2guc2V0PWZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcztyZXR1cm4gRCgpLnRoZW4oZnVuY3Rpb24oKXt2YXIgZD1QZihiKTtudWxsPT09ZD9jLnJlbW92ZShhKTpjLkcuc2V0SXRlbShhLGQpfSl9O2gucmVtb3ZlPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7cmV0dXJuIEQoKS50aGVuKGZ1bmN0aW9uKCl7Yi5HLnJlbW92ZUl0ZW0oYSl9KX07aC5qYj1mdW5jdGlvbihhKXtrLndpbmRvdyYmbGMoay53aW5kb3csXCJzdG9yYWdlXCIsYSl9O2guJGE9ZnVuY3Rpb24oYSl7ay53aW5kb3cmJnRjKGsud2luZG93LFwic3RvcmFnZVwiLGEpfTt2YXIgcWk9ZnVuY3Rpb24oKXt0aGlzLkc9e319O2g9cWkucHJvdG90eXBlO2guZ2V0PWZ1bmN0aW9uKCl7cmV0dXJuIEQobnVsbCl9O2guc2V0PWZ1bmN0aW9uKCl7cmV0dXJuIEQoKX07aC5yZW1vdmU9ZnVuY3Rpb24oKXtyZXR1cm4gRCgpfTtoLmpiPWZ1bmN0aW9uKCl7fTtoLiRhPWZ1bmN0aW9uKCl7fTt2YXIgc2k9ZnVuY3Rpb24oKXtpZighcmkoKSl7aWYoXCJOb2RlXCI9PUdmKCkpdGhyb3cgbmV3IE8oXCJpbnRlcm5hbC1lcnJvclwiLFwiVGhlIFNlc3Npb25TdG9yYWdlIGNvbXBhdGliaWxpdHkgbGlicmFyeSB3YXMgbm90IGZvdW5kLlwiKTt0aHJvdyBuZXcgTyhcIndlYi1zdG9yYWdlLXVuc3VwcG9ydGVkXCIpO310aGlzLkc9ay5zZXNzaW9uU3RvcmFnZXx8ZmlyZWJhc2UuSU5URVJOQUwubm9kZS5zZXNzaW9uU3RvcmFnZX0scmk9ZnVuY3Rpb24oKXt2YXIgYT1cIk5vZGVcIj09R2YoKTthPWsuc2Vzc2lvblN0b3JhZ2V8fGEmJmZpcmViYXNlLklOVEVSTkFMLm5vZGUmJmZpcmViYXNlLklOVEVSTkFMLm5vZGUuc2Vzc2lvblN0b3JhZ2U7aWYoIWEpcmV0dXJuITE7dHJ5e3JldHVybiBhLnNldEl0ZW0oXCJfX3Nha1wiLFwiMVwiKSxhLnJlbW92ZUl0ZW0oXCJfX3Nha1wiKSwhMH1jYXRjaChiKXtyZXR1cm4hMX19O2g9c2kucHJvdG90eXBlO1xuaC5nZXQ9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztyZXR1cm4gRCgpLnRoZW4oZnVuY3Rpb24oKXt2YXIgYz1iLkcuZ2V0SXRlbShhKTtyZXR1cm4gUmYoYyl9KX07aC5zZXQ9ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzO3JldHVybiBEKCkudGhlbihmdW5jdGlvbigpe3ZhciBkPVBmKGIpO251bGw9PT1kP2MucmVtb3ZlKGEpOmMuRy5zZXRJdGVtKGEsZCl9KX07aC5yZW1vdmU9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztyZXR1cm4gRCgpLnRoZW4oZnVuY3Rpb24oKXtiLkcucmVtb3ZlSXRlbShhKX0pfTtoLmpiPWZ1bmN0aW9uKCl7fTtoLiRhPWZ1bmN0aW9uKCl7fTt2YXIgdGk9ZnVuY3Rpb24oYSxiLGMsZCxlLGYpe2lmKCF3aW5kb3cuaW5kZXhlZERCKXRocm93IG5ldyBPKFwid2ViLXN0b3JhZ2UtdW5zdXBwb3J0ZWRcIik7dGhpcy56Zj1hO3RoaXMuSGQ9Yjt0aGlzLm1kPWM7dGhpcy5mZj1kO3RoaXMuZ2I9ZTt0aGlzLk49e307dGhpcy5mYz1bXTt0aGlzLldiPTA7dGhpcy5SZj1mfHxrLmluZGV4ZWREQn0sdWksdmk9ZnVuY3Rpb24oYSl7cmV0dXJuIG5ldyBDKGZ1bmN0aW9uKGIsYyl7dmFyIGQ9YS5SZi5vcGVuKGEuemYsYS5nYik7ZC5vbmVycm9yPWZ1bmN0aW9uKGEpe2MoRXJyb3IoYS50YXJnZXQuZXJyb3JDb2RlKSl9O2Qub251cGdyYWRlbmVlZGVkPWZ1bmN0aW9uKGIpe2I9Yi50YXJnZXQucmVzdWx0O3RyeXtiLmNyZWF0ZU9iamVjdFN0b3JlKGEuSGQse2tleVBhdGg6YS5tZH0pfWNhdGNoKGYpe2MoZil9fTtkLm9uc3VjY2Vzcz1mdW5jdGlvbihhKXtiKGEudGFyZ2V0LnJlc3VsdCl9fSl9LHdpPWZ1bmN0aW9uKGEpe2EuR2V8fChhLkdlPVxudmkoYSkpO3JldHVybiBhLkdlfSx4aT1mdW5jdGlvbihhLGIpe3JldHVybiBiLm9iamVjdFN0b3JlKGEuSGQpfSx6aT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIGIudHJhbnNhY3Rpb24oW2EuSGRdLGM/XCJyZWFkd3JpdGVcIjpcInJlYWRvbmx5XCIpfSxBaT1mdW5jdGlvbihhKXtyZXR1cm4gbmV3IEMoZnVuY3Rpb24oYixjKXthLm9uc3VjY2Vzcz1mdW5jdGlvbihhKXthJiZhLnRhcmdldD9iKGEudGFyZ2V0LnJlc3VsdCk6YigpfTthLm9uZXJyb3I9ZnVuY3Rpb24oYSl7YyhFcnJvcihhLnRhcmdldC5lcnJvckNvZGUpKX19KX07aD10aS5wcm90b3R5cGU7XG5oLnNldD1mdW5jdGlvbihhLGIpe3ZhciBjPSExLGQsZT10aGlzO3JldHVybiBFZCh3aSh0aGlzKS50aGVuKGZ1bmN0aW9uKGIpe2Q9YjtiPXhpKGUsemkoZSxkLCEwKSk7cmV0dXJuIEFpKGIuZ2V0KGEpKX0pLnRoZW4oZnVuY3Rpb24oZil7dmFyIGc9eGkoZSx6aShlLGQsITApKTtpZihmKXJldHVybiBmLnZhbHVlPWIsQWkoZy5wdXQoZikpO2UuV2IrKztjPSEwO2Y9e307ZltlLm1kXT1hO2ZbZS5mZl09YjtyZXR1cm4gQWkoZy5hZGQoZikpfSkudGhlbihmdW5jdGlvbigpe2UuTlthXT1ifSksZnVuY3Rpb24oKXtjJiZlLldiLS19KX07aC5nZXQ9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztyZXR1cm4gd2kodGhpcykudGhlbihmdW5jdGlvbihjKXtyZXR1cm4gQWkoeGkoYix6aShiLGMsITEpKS5nZXQoYSkpfSkudGhlbihmdW5jdGlvbihhKXtyZXR1cm4gYSYmYS52YWx1ZX0pfTtcbmgucmVtb3ZlPWZ1bmN0aW9uKGEpe3ZhciBiPSExLGM9dGhpcztyZXR1cm4gRWQod2kodGhpcykudGhlbihmdW5jdGlvbihkKXtiPSEwO2MuV2IrKztyZXR1cm4gQWkoeGkoYyx6aShjLGQsITApKVtcImRlbGV0ZVwiXShhKSl9KS50aGVuKGZ1bmN0aW9uKCl7ZGVsZXRlIGMuTlthXX0pLGZ1bmN0aW9uKCl7YiYmYy5XYi0tfSl9O1xuaC54Zz1mdW5jdGlvbigpe3ZhciBhPXRoaXM7cmV0dXJuIHdpKHRoaXMpLnRoZW4oZnVuY3Rpb24oYil7dmFyIGM9eGkoYSx6aShhLGIsITEpKTtyZXR1cm4gYy5nZXRBbGw/QWkoYy5nZXRBbGwoKSk6bmV3IEMoZnVuY3Rpb24oYSxiKXt2YXIgZD1bXSxlPWMub3BlbkN1cnNvcigpO2Uub25zdWNjZXNzPWZ1bmN0aW9uKGIpeyhiPWIudGFyZ2V0LnJlc3VsdCk/KGQucHVzaChiLnZhbHVlKSxiW1wiY29udGludWVcIl0oKSk6YShkKX07ZS5vbmVycm9yPWZ1bmN0aW9uKGEpe2IoRXJyb3IoYS50YXJnZXQuZXJyb3JDb2RlKSl9fSl9KS50aGVuKGZ1bmN0aW9uKGIpe3ZhciBjPXt9LGQ9W107aWYoMD09YS5XYil7Zm9yKGQ9MDtkPGIubGVuZ3RoO2QrKyljW2JbZF1bYS5tZF1dPWJbZF1bYS5mZl07ZD10ZihhLk4sYyk7YS5OPWN9cmV0dXJuIGR9KX07aC5qYj1mdW5jdGlvbihhKXswPT10aGlzLmZjLmxlbmd0aCYmdGhpcy5jZSgpO3RoaXMuZmMucHVzaChhKX07XG5oLiRhPWZ1bmN0aW9uKGEpe1lhKHRoaXMuZmMsZnVuY3Rpb24oYil7cmV0dXJuIGI9PWF9KTswPT10aGlzLmZjLmxlbmd0aCYmdGhpcy5TYygpfTtoLmNlPWZ1bmN0aW9uKCl7dmFyIGE9dGhpczt0aGlzLlNjKCk7dmFyIGI9ZnVuY3Rpb24oKXthLk5kPUJlKDgwMCkudGhlbihyKGEueGcsYSkpLnRoZW4oZnVuY3Rpb24oYil7MDxiLmxlbmd0aCYmeChhLmZjLGZ1bmN0aW9uKGEpe2EoYil9KX0pLnRoZW4oYikuZyhmdW5jdGlvbihhKXtcIlNUT1BfRVZFTlRcIiE9YS5tZXNzYWdlJiZiKCl9KTtyZXR1cm4gYS5OZH07YigpfTtoLlNjPWZ1bmN0aW9uKCl7dGhpcy5OZCYmdGhpcy5OZC5jYW5jZWwoXCJTVE9QX0VWRU5UXCIpfTt2YXIgRWk9ZnVuY3Rpb24oKXt0aGlzLnNlPXtCcm93c2VyOkJpLE5vZGU6Q2ksUmVhY3ROYXRpdmU6RGl9W0dmKCldfSxGaSxCaT17RDpwaSxlZTpzaX0sQ2k9e0Q6cGksZWU6c2l9LERpPXtEOm1pLGVlOnFpfTt2YXIgR2k9ZnVuY3Rpb24oYSl7dGhpcy5CZChhKX07XG5HaS5wcm90b3R5cGUuQmQ9ZnVuY3Rpb24oYSl7dmFyIGI9YS51cmw7aWYoXCJ1bmRlZmluZWRcIj09PXR5cGVvZiBiKXRocm93IG5ldyBPKFwibWlzc2luZy1jb250aW51ZS11cmlcIik7aWYoXCJzdHJpbmdcIiE9PXR5cGVvZiBifHxcInN0cmluZ1wiPT09dHlwZW9mIGImJiFiLmxlbmd0aCl0aHJvdyBuZXcgTyhcImludmFsaWQtY29udGludWUtdXJpXCIpO3RoaXMudWY9Yjt0aGlzLmdlPXRoaXMubmM9bnVsbDt0aGlzLkhlPSExO3ZhciBjPWEuYW5kcm9pZDtpZihjJiZcIm9iamVjdFwiPT09dHlwZW9mIGMpe2I9Yy5wYWNrYWdlTmFtZTt2YXIgZD1jLmluc3RhbGxBcHA7Yz1jLm1pbmltdW1WZXJzaW9uO2lmKFwic3RyaW5nXCI9PT10eXBlb2YgYiYmYi5sZW5ndGgpe3RoaXMubmM9YjtpZihcInVuZGVmaW5lZFwiIT09dHlwZW9mIGQmJlwiYm9vbGVhblwiIT09dHlwZW9mIGQpdGhyb3cgbmV3IE8oXCJhcmd1bWVudC1lcnJvclwiLFwiaW5zdGFsbEFwcCBwcm9wZXJ0eSBtdXN0IGJlIGEgYm9vbGVhbiB3aGVuIHNwZWNpZmllZC5cIik7dGhpcy5IZT1cbiEhZDtpZihcInVuZGVmaW5lZFwiIT09dHlwZW9mIGMmJihcInN0cmluZ1wiIT09dHlwZW9mIGN8fFwic3RyaW5nXCI9PT10eXBlb2YgYyYmIWMubGVuZ3RoKSl0aHJvdyBuZXcgTyhcImFyZ3VtZW50LWVycm9yXCIsXCJtaW5pbXVtVmVyc2lvbiBwcm9wZXJ0eSBtdXN0IGJlIGEgbm9uIGVtcHR5IHN0cmluZyB3aGVuIHNwZWNpZmllZC5cIik7dGhpcy5nZT1jfHxudWxsfWVsc2V7aWYoXCJ1bmRlZmluZWRcIiE9PXR5cGVvZiBiKXRocm93IG5ldyBPKFwiYXJndW1lbnQtZXJyb3JcIixcInBhY2thZ2VOYW1lIHByb3BlcnR5IG11c3QgYmUgYSBub24gZW1wdHkgc3RyaW5nIHdoZW4gc3BlY2lmaWVkLlwiKTtpZihcInVuZGVmaW5lZFwiIT09dHlwZW9mIGR8fFwidW5kZWZpbmVkXCIhPT10eXBlb2YgYyl0aHJvdyBuZXcgTyhcIm1pc3NpbmctYW5kcm9pZC1wa2ctbmFtZVwiKTt9fWVsc2UgaWYoXCJ1bmRlZmluZWRcIiE9PXR5cGVvZiBjKXRocm93IG5ldyBPKFwiYXJndW1lbnQtZXJyb3JcIixcImFuZHJvaWQgcHJvcGVydHkgbXVzdCBiZSBhIG5vbiBudWxsIG9iamVjdCB3aGVuIHNwZWNpZmllZC5cIik7XG50aGlzLnhkPW51bGw7aWYoKGI9YS5pT1MpJiZcIm9iamVjdFwiPT09dHlwZW9mIGIpaWYoYj1iLmJ1bmRsZUlkLFwic3RyaW5nXCI9PT10eXBlb2YgYiYmYi5sZW5ndGgpdGhpcy54ZD1iO2Vsc2V7aWYoXCJ1bmRlZmluZWRcIiE9PXR5cGVvZiBiKXRocm93IG5ldyBPKFwiYXJndW1lbnQtZXJyb3JcIixcImJ1bmRsZUlkIHByb3BlcnR5IG11c3QgYmUgYSBub24gZW1wdHkgc3RyaW5nIHdoZW4gc3BlY2lmaWVkLlwiKTt9ZWxzZSBpZihcInVuZGVmaW5lZFwiIT09dHlwZW9mIGIpdGhyb3cgbmV3IE8oXCJhcmd1bWVudC1lcnJvclwiLFwiaU9TIHByb3BlcnR5IG11c3QgYmUgYSBub24gbnVsbCBvYmplY3Qgd2hlbiBzcGVjaWZpZWQuXCIpO2E9YS5oYW5kbGVDb2RlSW5BcHA7aWYoXCJ1bmRlZmluZWRcIiE9PXR5cGVvZiBhJiZcImJvb2xlYW5cIiE9PXR5cGVvZiBhKXRocm93IG5ldyBPKFwiYXJndW1lbnQtZXJyb3JcIixcImhhbmRsZUNvZGVJbkFwcCBwcm9wZXJ0eSBtdXN0IGJlIGEgYm9vbGVhbiB3aGVuIHNwZWNpZmllZC5cIik7XG5pZigodGhpcy5sZT0hIWEpJiYhdGhpcy54ZCYmIXRoaXMubmMpdGhyb3cgbmV3IE8oXCJhcmd1bWVudC1lcnJvclwiLFwiaGFuZGxlQ29kZUluQXBwIHByb3BlcnR5IGNhbid0IGJlIHRydWUgd2hlbiBubyBtb2JpbGUgYXBwbGljYXRpb24gaXMgcHJvdmlkZWQuXCIpO307dmFyIEhpPWZ1bmN0aW9uKGEpe3ZhciBiPXt9O2IuY29udGludWVVcmw9YS51ZjtiLmNhbkhhbmRsZUNvZGVJbkFwcD1hLmxlO2lmKGIuYW5kcm9pZFBhY2thZ2VOYW1lPWEubmMpYi5hbmRyb2lkTWluaW11bVZlcnNpb249YS5nZSxiLmFuZHJvaWRJbnN0YWxsQXBwPWEuSGU7Yi5pT1NCdW5kbGVJZD1hLnhkO2Zvcih2YXIgYyBpbiBiKW51bGw9PT1iW2NdJiZkZWxldGUgYltjXTtyZXR1cm4gYn07dmFyIElpPWZ1bmN0aW9uKGEsYil7dGhpcy54Zj1iO04odGhpcyxcInZlcmlmaWNhdGlvbklkXCIsYSl9O0lpLnByb3RvdHlwZS5jb25maXJtPWZ1bmN0aW9uKGEpe2E9UWcodGhpcy52ZXJpZmljYXRpb25JZCxhKTtyZXR1cm4gdGhpcy54ZihhKX07dmFyIEppPWZ1bmN0aW9uKGEsYixjLGQpe3JldHVybihuZXcgT2coYSkpLnZlcmlmeVBob25lTnVtYmVyKGIsYykudGhlbihmdW5jdGlvbihhKXtyZXR1cm4gbmV3IElpKGEsZCl9KX07dmFyIEtpPWZ1bmN0aW9uKGEpe3ZhciBiPXt9LGM9YS5lbWFpbCxkPWEubmV3RW1haWw7YT1hLnJlcXVlc3RUeXBlO2lmKCFjfHwhYSl0aHJvdyBFcnJvcihcIkludmFsaWQgcHJvdmlkZXIgdXNlciBpbmZvIVwiKTtiLmZyb21FbWFpbD1kfHxudWxsO2IuZW1haWw9YztOKHRoaXMsXCJvcGVyYXRpb25cIixhKTtOKHRoaXMsXCJkYXRhXCIsZmcoYikpfTt2YXIgTGk9ZnVuY3Rpb24oYSxiLGMsZCxlLGYpe3RoaXMuZmc9YTt0aGlzLm1nPWI7dGhpcy5LZj1jO3RoaXMuR2M9ZDt0aGlzLmZlPWU7dGhpcy5uZz0hIWY7dGhpcy51Yj1udWxsO3RoaXMuU2E9dGhpcy5HYztpZih0aGlzLmZlPHRoaXMuR2MpdGhyb3cgRXJyb3IoXCJQcm9hY3RpdmUgcmVmcmVzaCBsb3dlciBib3VuZCBncmVhdGVyIHRoYW4gdXBwZXIgYm91bmQhXCIpO307TGkucHJvdG90eXBlLnN0YXJ0PWZ1bmN0aW9uKCl7dGhpcy5TYT10aGlzLkdjO01pKHRoaXMsITApfTtcbnZhciBOaT1mdW5jdGlvbihhLGIpe2lmKGIpcmV0dXJuIGEuU2E9YS5HYyxhLktmKCk7Yj1hLlNhO2EuU2EqPTI7YS5TYT5hLmZlJiYoYS5TYT1hLmZlKTtyZXR1cm4gYn0sTWk9ZnVuY3Rpb24oYSxiKXthLnN0b3AoKTthLnViPUJlKE5pKGEsYikpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gYS5uZz9EKCk6WGYoKX0pLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gYS5mZygpfSkudGhlbihmdW5jdGlvbigpe01pKGEsITApfSkuZyhmdW5jdGlvbihiKXthLm1nKGIpJiZNaShhLCExKX0pfTtMaS5wcm90b3R5cGUuc3RvcD1mdW5jdGlvbigpe3RoaXMudWImJih0aGlzLnViLmNhbmNlbCgpLHRoaXMudWI9bnVsbCl9O3ZhciBVaT1mdW5jdGlvbihhKXt2YXIgYj17fTtiW1wiZmFjZWJvb2suY29tXCJdPU9pO2JbXCJnb29nbGUuY29tXCJdPVBpO2JbXCJnaXRodWIuY29tXCJdPVFpO2JbXCJ0d2l0dGVyLmNvbVwiXT1SaTt2YXIgYz1hJiZhLnByb3ZpZGVySWQ7dHJ5e2lmKGMpcmV0dXJuIGJbY10/bmV3IGJbY10oYSk6bmV3IFNpKGEpO2lmKFwidW5kZWZpbmVkXCIhPT10eXBlb2YgYS5pZFRva2VuKXJldHVybiBuZXcgVGkoYSl9Y2F0Y2goZCl7fXJldHVybiBudWxsfSxUaT1mdW5jdGlvbihhKXt2YXIgYj1hLnByb3ZpZGVySWQ7aWYoIWImJmEuaWRUb2tlbil7dmFyIGM9cWcoYS5pZFRva2VuKTtjJiZjLlJkJiYoYj1jLlJkKX1pZighYil0aHJvdyBFcnJvcihcIkludmFsaWQgYWRkaXRpb25hbCB1c2VyIGluZm8hXCIpO2E9ISFhLmlzTmV3VXNlcjtOKHRoaXMsXCJwcm92aWRlcklkXCIsYik7Tih0aGlzLFwiaXNOZXdVc2VyXCIsYSl9LFNpPWZ1bmN0aW9uKGEpe1RpLmNhbGwodGhpcyxhKTthPVJmKGEucmF3VXNlckluZm98fFwie31cIik7XG5OKHRoaXMsXCJwcm9maWxlXCIsZmcoYXx8e30pKX07dChTaSxUaSk7dmFyIE9pPWZ1bmN0aW9uKGEpe1NpLmNhbGwodGhpcyxhKTtpZihcImZhY2Vib29rLmNvbVwiIT10aGlzLnByb3ZpZGVySWQpdGhyb3cgRXJyb3IoXCJJbnZhbGlkIHByb3ZpZGVyIGlkIVwiKTt9O3QoT2ksU2kpO3ZhciBRaT1mdW5jdGlvbihhKXtTaS5jYWxsKHRoaXMsYSk7aWYoXCJnaXRodWIuY29tXCIhPXRoaXMucHJvdmlkZXJJZCl0aHJvdyBFcnJvcihcIkludmFsaWQgcHJvdmlkZXIgaWQhXCIpO04odGhpcyxcInVzZXJuYW1lXCIsdGhpcy5wcm9maWxlJiZ0aGlzLnByb2ZpbGUubG9naW58fG51bGwpfTt0KFFpLFNpKTt2YXIgUGk9ZnVuY3Rpb24oYSl7U2kuY2FsbCh0aGlzLGEpO2lmKFwiZ29vZ2xlLmNvbVwiIT10aGlzLnByb3ZpZGVySWQpdGhyb3cgRXJyb3IoXCJJbnZhbGlkIHByb3ZpZGVyIGlkIVwiKTt9O3QoUGksU2kpO1xudmFyIFJpPWZ1bmN0aW9uKGEpe1NpLmNhbGwodGhpcyxhKTtpZihcInR3aXR0ZXIuY29tXCIhPXRoaXMucHJvdmlkZXJJZCl0aHJvdyBFcnJvcihcIkludmFsaWQgcHJvdmlkZXIgaWQhXCIpO04odGhpcyxcInVzZXJuYW1lXCIsYS5zY3JlZW5OYW1lfHxudWxsKX07dChSaSxTaSk7dmFyIFZpPXtMT0NBTDpcImxvY2FsXCIsTk9ORTpcIm5vbmVcIixTRVNTSU9OOlwic2Vzc2lvblwifSxXaT1mdW5jdGlvbihhKXt2YXIgYj1uZXcgTyhcImludmFsaWQtcGVyc2lzdGVuY2UtdHlwZVwiKSxjPW5ldyBPKFwidW5zdXBwb3J0ZWQtcGVyc2lzdGVuY2UtdHlwZVwiKTthOntmb3IoZCBpbiBWaSlpZihWaVtkXT09YSl7dmFyIGQ9ITA7YnJlYWsgYX1kPSExfWlmKCFkfHxcInN0cmluZ1wiIT09dHlwZW9mIGEpdGhyb3cgYjtzd2l0Y2goR2YoKSl7Y2FzZSBcIlJlYWN0TmF0aXZlXCI6aWYoXCJzZXNzaW9uXCI9PT1hKXRocm93IGM7YnJlYWs7Y2FzZSBcIk5vZGVcIjppZihcIm5vbmVcIiE9PWEpdGhyb3cgYzticmVhaztkZWZhdWx0OmlmKCFMZigpJiZcIm5vbmVcIiE9PWEpdGhyb3cgYzt9fSxYaT1mdW5jdGlvbihhLGIsYyxkKXt0aGlzLk1lPWE7dGhpcy5YZD1iO3RoaXMub2c9Yzt0aGlzLlZlPWQ7dGhpcy5TPXt9O0ZpfHwoRmk9bmV3IEVpKTthPUZpO3RyeXtpZihxZigpKXt1aXx8KHVpPW5ldyB0aShcImZpcmViYXNlTG9jYWxTdG9yYWdlRGJcIixcblwiZmlyZWJhc2VMb2NhbFN0b3JhZ2VcIixcImZiYXNlX2tleVwiLFwidmFsdWVcIiwxKSk7dmFyIGU9dWl9ZWxzZSBlPW5ldyBhLnNlLkQ7dGhpcy5TZT1lfWNhdGNoKGYpe3RoaXMuU2U9bmV3IG5pLHRoaXMuVmU9ITB9dHJ5e3RoaXMuYWY9bmV3IGEuc2UuZWV9Y2F0Y2goZil7dGhpcy5hZj1uZXcgbml9dGhpcy5RZj1uZXcgbmk7dGhpcy5kZT1yKHRoaXMuWmUsdGhpcyk7dGhpcy5OPXt9fSxZaSxaaT1mdW5jdGlvbigpe1lpfHwoWWk9bmV3IFhpKFwiZmlyZWJhc2VcIixcIjpcIiwhU2YoTCgpKSYmRmYoKT8hMDohMSxPZigpKSk7cmV0dXJuIFlpfSwkaT1mdW5jdGlvbihhLGIpe3N3aXRjaChiKXtjYXNlIFwic2Vzc2lvblwiOnJldHVybiBhLmFmO2Nhc2UgXCJub25lXCI6cmV0dXJuIGEuUWY7ZGVmYXVsdDpyZXR1cm4gYS5TZX19O2g9WGkucHJvdG90eXBlO2guY2E9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5NZSt0aGlzLlhkK2EubmFtZSsoYj90aGlzLlhkK2I6XCJcIil9O1xuaC5nZXQ9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gJGkodGhpcyxhLkQpLmdldCh0aGlzLmNhKGEsYikpfTtoLnJlbW92ZT1mdW5jdGlvbihhLGIpe2I9dGhpcy5jYShhLGIpO1wibG9jYWxcIj09YS5EJiYodGhpcy5OW2JdPW51bGwpO3JldHVybiAkaSh0aGlzLGEuRCkucmVtb3ZlKGIpfTtoLnNldD1mdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcy5jYShhLGMpLGU9dGhpcyxmPSRpKHRoaXMsYS5EKTtyZXR1cm4gZi5zZXQoZCxiKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGYuZ2V0KGQpfSkudGhlbihmdW5jdGlvbihiKXtcImxvY2FsXCI9PWEuRCYmKGUuTltkXT1iKX0pfTtcbmguYWRkTGlzdGVuZXI9ZnVuY3Rpb24oYSxiLGMpe2E9dGhpcy5jYShhLGIpO1widW5kZWZpbmVkXCIhPT10eXBlb2Ygay5sb2NhbFN0b3JhZ2UmJlwiZnVuY3Rpb25cIj09PXR5cGVvZiBrLmxvY2FsU3RvcmFnZS5nZXRJdGVtJiYodGhpcy5OW2FdPWsubG9jYWxTdG9yYWdlLmdldEl0ZW0oYSkpO2liKHRoaXMuUykmJnRoaXMuY2UoKTt0aGlzLlNbYV18fCh0aGlzLlNbYV09W10pO3RoaXMuU1thXS5wdXNoKGMpfTtoLnJlbW92ZUxpc3RlbmVyPWZ1bmN0aW9uKGEsYixjKXthPXRoaXMuY2EoYSxiKTt0aGlzLlNbYV0mJihZYSh0aGlzLlNbYV0sZnVuY3Rpb24oYSl7cmV0dXJuIGE9PWN9KSwwPT10aGlzLlNbYV0ubGVuZ3RoJiZkZWxldGUgdGhpcy5TW2FdKTtpYih0aGlzLlMpJiZ0aGlzLlNjKCl9O2guY2U9ZnVuY3Rpb24oKXskaSh0aGlzLFwibG9jYWxcIikuamIodGhpcy5kZSk7dGhpcy5WZXx8cWYoKXx8YWoodGhpcyl9O1xudmFyIGFqPWZ1bmN0aW9uKGEpe2JqKGEpO2EuRmQ9c2V0SW50ZXJ2YWwoZnVuY3Rpb24oKXtmb3IodmFyIGIgaW4gYS5TKXt2YXIgYz1rLmxvY2FsU3RvcmFnZS5nZXRJdGVtKGIpLGQ9YS5OW2JdO2MhPWQmJihhLk5bYl09YyxjPW5ldyBZYih7dHlwZTpcInN0b3JhZ2VcIixrZXk6Yix0YXJnZXQ6d2luZG93LG9sZFZhbHVlOmQsbmV3VmFsdWU6YyxNZDohMH0pLGEuWmUoYykpfX0sMUUzKX0sYmo9ZnVuY3Rpb24oYSl7YS5GZCYmKGNsZWFySW50ZXJ2YWwoYS5GZCksYS5GZD1udWxsKX07WGkucHJvdG90eXBlLlNjPWZ1bmN0aW9uKCl7JGkodGhpcyxcImxvY2FsXCIpLiRhKHRoaXMuZGUpO2JqKHRoaXMpfTtcblhpLnByb3RvdHlwZS5aZT1mdW5jdGlvbihhKXtpZihhJiZhLkhmKXt2YXIgYj1hLlIua2V5O2lmKG51bGw9PWIpZm9yKHZhciBjIGluIHRoaXMuUyl7dmFyIGQ9dGhpcy5OW2NdO1widW5kZWZpbmVkXCI9PT10eXBlb2YgZCYmKGQ9bnVsbCk7dmFyIGU9ay5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShjKTtlIT09ZCYmKHRoaXMuTltjXT1lLHRoaXMuaGQoYykpfWVsc2UgaWYoMD09Yi5pbmRleE9mKHRoaXMuTWUrdGhpcy5YZCkmJnRoaXMuU1tiXSl7XCJ1bmRlZmluZWRcIiE9PXR5cGVvZiBhLlIuTWQ/JGkodGhpcyxcImxvY2FsXCIpLiRhKHRoaXMuZGUpOmJqKHRoaXMpO2lmKHRoaXMub2cpaWYoYz1rLmxvY2FsU3RvcmFnZS5nZXRJdGVtKGIpLGQ9YS5SLm5ld1ZhbHVlLGQhPT1jKW51bGwhPT1kP2subG9jYWxTdG9yYWdlLnNldEl0ZW0oYixkKTprLmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKGIpO2Vsc2UgaWYodGhpcy5OW2JdPT09ZCYmXCJ1bmRlZmluZWRcIj09PXR5cGVvZiBhLlIuTWQpcmV0dXJuO1xudmFyIGY9dGhpcztjPWZ1bmN0aW9uKCl7aWYoXCJ1bmRlZmluZWRcIiE9PXR5cGVvZiBhLlIuTWR8fGYuTltiXSE9PWsubG9jYWxTdG9yYWdlLmdldEl0ZW0oYikpZi5OW2JdPWsubG9jYWxTdG9yYWdlLmdldEl0ZW0oYiksZi5oZChiKX07eiYmQ2ImJjEwPT1DYiYmay5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShiKSE9PWEuUi5uZXdWYWx1ZSYmYS5SLm5ld1ZhbHVlIT09YS5SLm9sZFZhbHVlP3NldFRpbWVvdXQoYywxMCk6YygpfX1lbHNlIHgoYSxyKHRoaXMuaGQsdGhpcykpfTtYaS5wcm90b3R5cGUuaGQ9ZnVuY3Rpb24oYSl7dGhpcy5TW2FdJiZ4KHRoaXMuU1thXSxmdW5jdGlvbihhKXthKCl9KX07dmFyIGNqPWZ1bmN0aW9uKGEsYil7dGhpcy5qPWE7dGhpcy5oPWJ8fFppKCl9LGRqPXtuYW1lOlwiYXV0aEV2ZW50XCIsRDpcImxvY2FsXCJ9LGVqPWZ1bmN0aW9uKGEpe3JldHVybiBhLmguZ2V0KGRqLGEuaikudGhlbihmdW5jdGlvbihhKXtyZXR1cm4gbmcoYSl9KX07Y2oucHJvdG90eXBlLmliPWZ1bmN0aW9uKGEpe3RoaXMuaC5hZGRMaXN0ZW5lcihkaix0aGlzLmosYSl9O2NqLnByb3RvdHlwZS5kYz1mdW5jdGlvbihhKXt0aGlzLmgucmVtb3ZlTGlzdGVuZXIoZGosdGhpcy5qLGEpfTt2YXIgZmo9ZnVuY3Rpb24oYSl7dGhpcy5oPWF8fFppKCl9LGdqPXtuYW1lOlwic2Vzc2lvbklkXCIsRDpcInNlc3Npb25cIn07ZmoucHJvdG90eXBlLnRjPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmguZ2V0KGdqLGEpfTt2YXIgaGo9ZnVuY3Rpb24oYSxiLGMsZCxlLGYsZyl7dGhpcy5CPWE7dGhpcy5tPWI7dGhpcy5vPWM7dGhpcy5MYT1kfHxudWxsO3RoaXMuUD1nfHxudWxsO3RoaXMuJGU9YitcIjpcIitjO3RoaXMucGc9bmV3IGZqO3RoaXMueGU9bmV3IGNqKHRoaXMuJGUpO3RoaXMuQWQ9bnVsbDt0aGlzLnRhPVtdO3RoaXMuVmY9ZXx8NTAwO3RoaXMuaWc9Znx8MkUzO3RoaXMuUmI9dGhpcy5KYz1udWxsfSxpaj1mdW5jdGlvbihhKXtyZXR1cm4gbmV3IE8oXCJpbnZhbGlkLWNvcmRvdmEtY29uZmlndXJhdGlvblwiLGEpfTtcbmhqLnByb3RvdHlwZS5SYT1mdW5jdGlvbigpe3JldHVybiB0aGlzLlRiP3RoaXMuVGI6dGhpcy5UYj1EZigpLnRoZW4oZnVuY3Rpb24oKXtpZihcImZ1bmN0aW9uXCIhPT10eXBlb2YgTShcInVuaXZlcnNhbExpbmtzLnN1YnNjcmliZVwiLGspKXRocm93IGlqKFwiY29yZG92YS11bml2ZXJzYWwtbGlua3MtcGx1Z2luIGlzIG5vdCBpbnN0YWxsZWRcIik7aWYoXCJ1bmRlZmluZWRcIj09PXR5cGVvZiBNKFwiQnVpbGRJbmZvLnBhY2thZ2VOYW1lXCIsaykpdGhyb3cgaWooXCJjb3Jkb3ZhLXBsdWdpbi1idWlsZGluZm8gaXMgbm90IGluc3RhbGxlZFwiKTtpZihcImZ1bmN0aW9uXCIhPT10eXBlb2YgTShcImNvcmRvdmEucGx1Z2lucy5icm93c2VydGFiLm9wZW5VcmxcIixrKSl0aHJvdyBpaihcImNvcmRvdmEtcGx1Z2luLWJyb3dzZXJ0YWIgaXMgbm90IGluc3RhbGxlZFwiKTtpZihcImZ1bmN0aW9uXCIhPT10eXBlb2YgTShcImNvcmRvdmEuSW5BcHBCcm93c2VyLm9wZW5cIixrKSl0aHJvdyBpaihcImNvcmRvdmEtcGx1Z2luLWluYXBwYnJvd3NlciBpcyBub3QgaW5zdGFsbGVkXCIpO1xufSxmdW5jdGlvbigpe3Rocm93IG5ldyBPKFwiY29yZG92YS1ub3QtcmVhZHlcIik7fSl9O3ZhciBqaj1mdW5jdGlvbigpe2Zvcih2YXIgYT0yMCxiPVtdOzA8YTspYi5wdXNoKFwiMTIzNDU2Nzg5MGFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVpcIi5jaGFyQXQoTWF0aC5mbG9vcig2MipNYXRoLnJhbmRvbSgpKSkpLGEtLTtyZXR1cm4gYi5qb2luKFwiXCIpfSxraj1mdW5jdGlvbihhKXt2YXIgYj1uZXcgU2I7Yi51cGRhdGUoYSk7cmV0dXJuIGFiKGIuZGlnZXN0KCkpfTtoPWhqLnByb3RvdHlwZTtoLmVjPWZ1bmN0aW9uKGEsYil7YihuZXcgTyhcIm9wZXJhdGlvbi1ub3Qtc3VwcG9ydGVkLWluLXRoaXMtZW52aXJvbm1lbnRcIikpO3JldHVybiBEKCl9O2guJGI9ZnVuY3Rpb24oKXtyZXR1cm4gRShuZXcgTyhcIm9wZXJhdGlvbi1ub3Qtc3VwcG9ydGVkLWluLXRoaXMtZW52aXJvbm1lbnRcIikpfTtoLmJmPWZ1bmN0aW9uKCl7cmV0dXJuITF9O2guWWU9ZnVuY3Rpb24oKXtyZXR1cm4hMH07XG5oLkJlPWZ1bmN0aW9uKCl7cmV0dXJuITB9O1xuaC5hYz1mdW5jdGlvbihhLGIsYyl7aWYodGhpcy5KYylyZXR1cm4gRShuZXcgTyhcInJlZGlyZWN0LW9wZXJhdGlvbi1wZW5kaW5nXCIpKTt2YXIgZD10aGlzLGU9ay5kb2N1bWVudCxmPW51bGwsZz1udWxsLGw9bnVsbCxuPW51bGw7cmV0dXJuIHRoaXMuSmM9RWQoRCgpLnRoZW4oZnVuY3Rpb24oKXtTZyhiKTtyZXR1cm4gbGooZCl9KS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIG1qKGQsYSxiLGMpfSkudGhlbihmdW5jdGlvbigpe3JldHVybihuZXcgQyhmdW5jdGlvbihhLGIpe2c9ZnVuY3Rpb24oKXt2YXIgYj1NKFwiY29yZG92YS5wbHVnaW5zLmJyb3dzZXJ0YWIuY2xvc2VcIixrKTthKCk7XCJmdW5jdGlvblwiPT09dHlwZW9mIGImJmIoKTtkLlJiJiZcImZ1bmN0aW9uXCI9PT10eXBlb2YgZC5SYi5jbG9zZSYmKGQuUmIuY2xvc2UoKSxkLlJiPW51bGwpO3JldHVybiExfTtkLmliKGcpO2w9ZnVuY3Rpb24oKXtmfHwoZj1CZShkLmlnKS50aGVuKGZ1bmN0aW9uKCl7YihuZXcgTyhcInJlZGlyZWN0LWNhbmNlbGxlZC1ieS11c2VyXCIpKX0pKX07bj1cbmZ1bmN0aW9uKCl7V2YoKSYmbCgpfTtlLmFkZEV2ZW50TGlzdGVuZXIoXCJyZXN1bWVcIixsLCExKTtMKCkudG9Mb3dlckNhc2UoKS5tYXRjaCgvYW5kcm9pZC8pfHxlLmFkZEV2ZW50TGlzdGVuZXIoXCJ2aXNpYmlsaXR5Y2hhbmdlXCIsbiwhMSl9KSkuZyhmdW5jdGlvbihhKXtyZXR1cm4gbmooZCkudGhlbihmdW5jdGlvbigpe3Rocm93IGE7fSl9KX0pLGZ1bmN0aW9uKCl7bCYmZS5yZW1vdmVFdmVudExpc3RlbmVyKFwicmVzdW1lXCIsbCwhMSk7biYmZS5yZW1vdmVFdmVudExpc3RlbmVyKFwidmlzaWJpbGl0eWNoYW5nZVwiLG4sITEpO2YmJmYuY2FuY2VsKCk7ZyYmZC5kYyhnKTtkLkpjPW51bGx9KX07XG52YXIgbWo9ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9amooKSxmPW5ldyBtZyhiLGQsbnVsbCxlLG5ldyBPKFwibm8tYXV0aC1ldmVudFwiKSksZz1NKFwiQnVpbGRJbmZvLnBhY2thZ2VOYW1lXCIsayk7aWYoXCJzdHJpbmdcIiE9PXR5cGVvZiBnKXRocm93IG5ldyBPKFwiaW52YWxpZC1jb3Jkb3ZhLWNvbmZpZ3VyYXRpb25cIik7dmFyIGw9TShcIkJ1aWxkSW5mby5kaXNwbGF5TmFtZVwiLGspLG49e307aWYoTCgpLnRvTG93ZXJDYXNlKCkubWF0Y2goL2lwaG9uZXxpcGFkfGlwb2QvKSluLmliaT1nO2Vsc2UgaWYoTCgpLnRvTG93ZXJDYXNlKCkubWF0Y2goL2FuZHJvaWQvKSluLmFwbj1nO2Vsc2UgcmV0dXJuIEUobmV3IE8oXCJvcGVyYXRpb24tbm90LXN1cHBvcnRlZC1pbi10aGlzLWVudmlyb25tZW50XCIpKTtsJiYobi5hcHBEaXNwbGF5TmFtZT1sKTtlPWtqKGUpO24uc2Vzc2lvbklkPWU7dmFyIEY9Y2koYS5CLGEubSxhLm8sYixjLG51bGwsZCxhLkxhLG4sYS5QKTtyZXR1cm4gYS5SYSgpLnRoZW4oZnVuY3Rpb24oKXt2YXIgYj1cbmEuJGU7cmV0dXJuIGEucGcuaC5zZXQoZGosZi5BKCksYil9KS50aGVuKGZ1bmN0aW9uKCl7dmFyIGI9TShcImNvcmRvdmEucGx1Z2lucy5icm93c2VydGFiLmlzQXZhaWxhYmxlXCIsayk7aWYoXCJmdW5jdGlvblwiIT09dHlwZW9mIGIpdGhyb3cgbmV3IE8oXCJpbnZhbGlkLWNvcmRvdmEtY29uZmlndXJhdGlvblwiKTt2YXIgYz1udWxsO2IoZnVuY3Rpb24oYil7aWYoYil7Yz1NKFwiY29yZG92YS5wbHVnaW5zLmJyb3dzZXJ0YWIub3BlblVybFwiLGspO2lmKFwiZnVuY3Rpb25cIiE9PXR5cGVvZiBjKXRocm93IG5ldyBPKFwiaW52YWxpZC1jb3Jkb3ZhLWNvbmZpZ3VyYXRpb25cIik7YyhGKX1lbHNle2M9TShcImNvcmRvdmEuSW5BcHBCcm93c2VyLm9wZW5cIixrKTtpZihcImZ1bmN0aW9uXCIhPT10eXBlb2YgYyl0aHJvdyBuZXcgTyhcImludmFsaWQtY29yZG92YS1jb25maWd1cmF0aW9uXCIpO2I9Yzt2YXIgZD1MKCk7ZD0hKCFkLm1hdGNoKC8oaVBhZHxpUGhvbmV8aVBvZCkuKk9TIDdfXFxkL2kpJiYhZC5tYXRjaCgvKGlQYWR8aVBob25lfGlQb2QpLipPUyA4X1xcZC9pKSk7XG5hLlJiPWIoRixkP1wiX2JsYW5rXCI6XCJfc3lzdGVtXCIsXCJsb2NhdGlvbj15ZXNcIil9fSl9KX07aGoucHJvdG90eXBlLkxiPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj0wO2I8dGhpcy50YS5sZW5ndGg7YisrKXRyeXt0aGlzLnRhW2JdKGEpfWNhdGNoKGMpe319O1xudmFyIGxqPWZ1bmN0aW9uKGEpe2EuQWR8fChhLkFkPWEuUmEoKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBDKGZ1bmN0aW9uKGIpe3ZhciBjPWZ1bmN0aW9uKGQpe2IoZCk7YS5kYyhjKTtyZXR1cm4hMX07YS5pYihjKTtvaihhKX0pfSkpO3JldHVybiBhLkFkfSxuaj1mdW5jdGlvbihhKXt2YXIgYj1udWxsO3JldHVybiBlaihhLnhlKS50aGVuKGZ1bmN0aW9uKGMpe2I9YztjPWEueGU7cmV0dXJuIGMuaC5yZW1vdmUoZGosYy5qKX0pLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gYn0pfSxvaj1mdW5jdGlvbihhKXt2YXIgYj1NKFwidW5pdmVyc2FsTGlua3Muc3Vic2NyaWJlXCIsayk7aWYoXCJmdW5jdGlvblwiIT09dHlwZW9mIGIpdGhyb3cgbmV3IE8oXCJpbnZhbGlkLWNvcmRvdmEtY29uZmlndXJhdGlvblwiKTt2YXIgYz1uZXcgbWcoXCJ1bmtub3duXCIsbnVsbCxudWxsLG51bGwsbmV3IE8oXCJuby1hdXRoLWV2ZW50XCIpKSxkPSExLGU9QmUoYS5WZikudGhlbihmdW5jdGlvbigpe3JldHVybiBuaihhKS50aGVuKGZ1bmN0aW9uKCl7ZHx8XG5hLkxiKGMpfSl9KSxmPWZ1bmN0aW9uKGIpe2Q9ITA7ZSYmZS5jYW5jZWwoKTtuaihhKS50aGVuKGZ1bmN0aW9uKGQpe3ZhciBlPWM7aWYoZCYmYiYmYi51cmwpe2U9bnVsbDt2YXIgZj1iLnVybDt2YXIgZz1nZihmKSxsPWZmKGcsXCJsaW5rXCIpLG49ZmYoZ2YobCksXCJsaW5rXCIpO2c9ZmYoZyxcImRlZXBfbGlua19pZFwiKTtmPWZmKGdmKGcpLFwibGlua1wiKXx8Z3x8bnx8bHx8ZjstMSE9Zi5pbmRleE9mKFwiL19fL2F1dGgvY2FsbGJhY2tcIikmJihlPWdmKGYpLGU9UmYoZmYoZSxcImZpcmViYXNlRXJyb3JcIil8fG51bGwpLGU9KGU9XCJvYmplY3RcIj09PXR5cGVvZiBlP2xnKGUpOm51bGwpP25ldyBtZyhkLm1hLGQuWSxudWxsLG51bGwsZSk6bmV3IG1nKGQubWEsZC5ZLGYsZC50YygpKSk7ZT1lfHxjfWEuTGIoZSl9KX0sZz1rLmhhbmRsZU9wZW5VUkw7ay5oYW5kbGVPcGVuVVJMPWZ1bmN0aW9uKGEpezA9PWEudG9Mb3dlckNhc2UoKS5pbmRleE9mKE0oXCJCdWlsZEluZm8ucGFja2FnZU5hbWVcIixrKS50b0xvd2VyQ2FzZSgpK1xuXCI6Ly9cIikmJmYoe3VybDphfSk7aWYoXCJmdW5jdGlvblwiPT09dHlwZW9mIGcpdHJ5e2coYSl9Y2F0Y2gobil7Y29uc29sZS5lcnJvcihuKX19O2IobnVsbCxmKX07aGoucHJvdG90eXBlLmliPWZ1bmN0aW9uKGEpe3RoaXMudGEucHVzaChhKTtsaih0aGlzKS5nKGZ1bmN0aW9uKGIpe1wiYXV0aC9pbnZhbGlkLWNvcmRvdmEtY29uZmlndXJhdGlvblwiPT09Yi5jb2RlJiYoYj1uZXcgbWcoXCJ1bmtub3duXCIsbnVsbCxudWxsLG51bGwsbmV3IE8oXCJuby1hdXRoLWV2ZW50XCIpKSxhKGIpKX0pfTtoai5wcm90b3R5cGUuZGM9ZnVuY3Rpb24oYSl7WWEodGhpcy50YSxmdW5jdGlvbihiKXtyZXR1cm4gYj09YX0pfTt2YXIgcGo9ZnVuY3Rpb24oYSl7dGhpcy5qPWE7dGhpcy5oPVppKCl9LHFqPXtuYW1lOlwicGVuZGluZ1JlZGlyZWN0XCIsRDpcInNlc3Npb25cIn0scmo9ZnVuY3Rpb24oYSl7cmV0dXJuIGEuaC5zZXQocWosXCJwZW5kaW5nXCIsYS5qKX0sc2o9ZnVuY3Rpb24oYSl7cmV0dXJuIGEuaC5yZW1vdmUocWosYS5qKX0sdGo9ZnVuY3Rpb24oYSl7cmV0dXJuIGEuaC5nZXQocWosYS5qKS50aGVuKGZ1bmN0aW9uKGEpe3JldHVyblwicGVuZGluZ1wiPT1hfSl9O3ZhciB4aj1mdW5jdGlvbihhLGIsYyl7dGhpcy5CPWE7dGhpcy5tPWI7dGhpcy5vPWM7dGhpcy5nYz1bXTt0aGlzLnNiPSExO3RoaXMuZWQ9cih0aGlzLnZkLHRoaXMpO3RoaXMuWGE9bmV3IHVqKHRoaXMpO3RoaXMuT2Q9bmV3IHZqKHRoaXMpO3RoaXMuWGI9bmV3IHBqKHRoaXMubStcIjpcIit0aGlzLm8pO3RoaXMuSWE9e307dGhpcy5JYS51bmtub3duPXRoaXMuWGE7dGhpcy5JYS5zaWduSW5WaWFSZWRpcmVjdD10aGlzLlhhO3RoaXMuSWEubGlua1ZpYVJlZGlyZWN0PXRoaXMuWGE7dGhpcy5JYS5yZWF1dGhWaWFSZWRpcmVjdD10aGlzLlhhO3RoaXMuSWEuc2lnbkluVmlhUG9wdXA9dGhpcy5PZDt0aGlzLklhLmxpbmtWaWFQb3B1cD10aGlzLk9kO3RoaXMuSWEucmVhdXRoVmlhUG9wdXA9dGhpcy5PZDt0aGlzLlo9d2oodGhpcy5CLHRoaXMubSx0aGlzLm8scGYpfSx3aj1mdW5jdGlvbihhLGIsYyxkKXt2YXIgZT1maXJlYmFzZS5TREtfVkVSU0lPTnx8bnVsbDtyZXR1cm4gQ2YoKT9uZXcgaGooYSxcbmIsYyxlLHZvaWQgMCx2b2lkIDAsZCk6bmV3IFloKGEsYixjLGUsZCl9O3hqLnByb3RvdHlwZS5yZXNldD1mdW5jdGlvbigpe3RoaXMuc2I9ITE7dGhpcy5aLmRjKHRoaXMuZWQpO3RoaXMuWj13aih0aGlzLkIsdGhpcy5tLHRoaXMubyl9O3hqLnByb3RvdHlwZS5TYj1mdW5jdGlvbigpe3ZhciBhPXRoaXM7dGhpcy5zYnx8KHRoaXMuc2I9ITAsdGhpcy5aLmliKHRoaXMuZWQpKTt2YXIgYj10aGlzLlo7cmV0dXJuIHRoaXMuWi5SYSgpLmcoZnVuY3Rpb24oYyl7YS5aPT1iJiZhLnJlc2V0KCk7dGhyb3cgYzt9KX07dmFyIEFqPWZ1bmN0aW9uKGEpe2EuWi5ZZSgpJiZhLlNiKCkuZyhmdW5jdGlvbihiKXt2YXIgYz1uZXcgbWcoXCJ1bmtub3duXCIsbnVsbCxudWxsLG51bGwsbmV3IE8oXCJvcGVyYXRpb24tbm90LXN1cHBvcnRlZC1pbi10aGlzLWVudmlyb25tZW50XCIpKTt5aihiKSYmYS52ZChjKX0pO2EuWi5CZSgpfHx6aihhLlhhKX07XG54ai5wcm90b3R5cGUuc3Vic2NyaWJlPWZ1bmN0aW9uKGEpe1ZhKHRoaXMuZ2MsYSl8fHRoaXMuZ2MucHVzaChhKTtpZighdGhpcy5zYil7dmFyIGI9dGhpczt0aih0aGlzLlhiKS50aGVuKGZ1bmN0aW9uKGEpe2E/c2ooYi5YYikudGhlbihmdW5jdGlvbigpe2IuU2IoKS5nKGZ1bmN0aW9uKGEpe3ZhciBjPW5ldyBtZyhcInVua25vd25cIixudWxsLG51bGwsbnVsbCxuZXcgTyhcIm9wZXJhdGlvbi1ub3Qtc3VwcG9ydGVkLWluLXRoaXMtZW52aXJvbm1lbnRcIikpO3lqKGEpJiZiLnZkKGMpfSl9KTpBaihiKX0pLmcoZnVuY3Rpb24oKXtBaihiKX0pfX07eGoucHJvdG90eXBlLnVuc3Vic2NyaWJlPWZ1bmN0aW9uKGEpe1lhKHRoaXMuZ2MsZnVuY3Rpb24oYil7cmV0dXJuIGI9PWF9KX07XG54ai5wcm90b3R5cGUudmQ9ZnVuY3Rpb24oYSl7aWYoIWEpdGhyb3cgbmV3IE8oXCJpbnZhbGlkLWF1dGgtZXZlbnRcIik7Zm9yKHZhciBiPSExLGM9MDtjPHRoaXMuZ2MubGVuZ3RoO2MrKyl7dmFyIGQ9dGhpcy5nY1tjXTtpZihkLmtlKGEubWEsYS5ZKSl7KGI9dGhpcy5JYVthLm1hXSkmJmIuVGUoYSxkKTtiPSEwO2JyZWFrfX16aih0aGlzLlhhKTtyZXR1cm4gYn07dmFyIEJqPW5ldyBWZigyRTMsMUU0KSxDaj1uZXcgVmYoM0U0LDZFNCk7eGoucHJvdG90eXBlLmdldFJlZGlyZWN0UmVzdWx0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuWGEuZ2V0UmVkaXJlY3RSZXN1bHQoKX07eGoucHJvdG90eXBlLiRiPWZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9dGhpcztyZXR1cm4gdGhpcy5aLiRiKGEsYixjLGZ1bmN0aW9uKCl7Zi5zYnx8KGYuc2I9ITAsZi5aLmliKGYuZWQpKX0sZnVuY3Rpb24oKXtmLnJlc2V0KCl9LGQsZSl9O1xudmFyIHlqPWZ1bmN0aW9uKGEpe3JldHVybiBhJiZcImF1dGgvY29yZG92YS1ub3QtcmVhZHlcIj09YS5jb2RlPyEwOiExfTt4ai5wcm90b3R5cGUuYWM9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXMsZTtyZXR1cm4gcmoodGhpcy5YYikudGhlbihmdW5jdGlvbigpe3JldHVybiBkLlouYWMoYSxiLGMpLmcoZnVuY3Rpb24oYSl7aWYoeWooYSkpdGhyb3cgbmV3IE8oXCJvcGVyYXRpb24tbm90LXN1cHBvcnRlZC1pbi10aGlzLWVudmlyb25tZW50XCIpO2U9YTtyZXR1cm4gc2ooZC5YYikudGhlbihmdW5jdGlvbigpe3Rocm93IGU7fSl9KS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGQuWi5iZigpP25ldyBDKGZ1bmN0aW9uKCl7fSk6c2ooZC5YYikudGhlbihmdW5jdGlvbigpe3JldHVybiBkLmdldFJlZGlyZWN0UmVzdWx0KCl9KS50aGVuKGZ1bmN0aW9uKCl7fSkuZyhmdW5jdGlvbigpe30pfSl9KX07XG54ai5wcm90b3R5cGUuZWM9ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIHRoaXMuWi5lYyhjLGZ1bmN0aW9uKGMpe2EuYmIoYixudWxsLGMsZCl9LEJqLmdldCgpKX07dmFyIERqPXt9LEVqPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD1iK1wiOlwiK2M7RGpbZF18fChEaltkXT1uZXcgeGooYSxiLGMpKTtyZXR1cm4gRGpbZF19LHVqPWZ1bmN0aW9uKGEpe3RoaXMuaD1hO3RoaXMuQWI9bnVsbDt0aGlzLmNjPVtdO3RoaXMuYmM9W107dGhpcy55Yj1udWxsO3RoaXMuU2Q9ITF9O3VqLnByb3RvdHlwZS5yZXNldD1mdW5jdGlvbigpe3RoaXMuQWI9bnVsbDt0aGlzLnliJiYodGhpcy55Yi5jYW5jZWwoKSx0aGlzLnliPW51bGwpfTtcbnVqLnByb3RvdHlwZS5UZT1mdW5jdGlvbihhLGIpe2lmKCFhKXJldHVybiBFKG5ldyBPKFwiaW52YWxpZC1hdXRoLWV2ZW50XCIpKTt0aGlzLnJlc2V0KCk7dGhpcy5TZD0hMDt2YXIgYz1hLm1hLGQ9YS5ZLGU9YS5nZXRFcnJvcigpJiZcImF1dGgvd2ViLXN0b3JhZ2UtdW5zdXBwb3J0ZWRcIj09YS5nZXRFcnJvcigpLmNvZGUsZj1hLmdldEVycm9yKCkmJlwiYXV0aC9vcGVyYXRpb24tbm90LXN1cHBvcnRlZC1pbi10aGlzLWVudmlyb25tZW50XCI9PWEuZ2V0RXJyb3IoKS5jb2RlO1widW5rbm93blwiIT1jfHxlfHxmP2E9YS5iYT90aGlzLlBkKGEsYik6Yi5OYihjLGQpP3RoaXMuUWQoYSxiKTpFKG5ldyBPKFwiaW52YWxpZC1hdXRoLWV2ZW50XCIpKTooRmoodGhpcywhMSxudWxsLG51bGwpLGE9RCgpKTtyZXR1cm4gYX07dmFyIHpqPWZ1bmN0aW9uKGEpe2EuU2R8fChhLlNkPSEwLEZqKGEsITEsbnVsbCxudWxsKSl9O1xudWoucHJvdG90eXBlLlBkPWZ1bmN0aW9uKGEpe0ZqKHRoaXMsITAsbnVsbCxhLmdldEVycm9yKCkpO3JldHVybiBEKCl9O3VqLnByb3RvdHlwZS5RZD1mdW5jdGlvbihhLGIpe3ZhciBjPXRoaXM7Yj1iLk5iKGEubWEsYS5ZKTt2YXIgZD1hLkViLGU9YS50YygpLGY9ISFhLm1hLm1hdGNoKC9SZWRpcmVjdCQvKTtyZXR1cm4gYihkLGUpLnRoZW4oZnVuY3Rpb24oYSl7RmooYyxmLGEsbnVsbCl9KS5nKGZ1bmN0aW9uKGEpe0ZqKGMsZixudWxsLGEpfSl9O1xudmFyIEdqPWZ1bmN0aW9uKGEsYil7YS5BYj1mdW5jdGlvbigpe3JldHVybiBFKGIpfTtpZihhLmJjLmxlbmd0aClmb3IodmFyIGM9MDtjPGEuYmMubGVuZ3RoO2MrKylhLmJjW2NdKGIpfSxIaj1mdW5jdGlvbihhLGIpe2EuQWI9ZnVuY3Rpb24oKXtyZXR1cm4gRChiKX07aWYoYS5jYy5sZW5ndGgpZm9yKHZhciBjPTA7YzxhLmNjLmxlbmd0aDtjKyspYS5jY1tjXShiKX0sRmo9ZnVuY3Rpb24oYSxiLGMsZCl7Yj9kP0dqKGEsZCk6SGooYSxjKTpIaihhLHt1c2VyOm51bGx9KTthLmNjPVtdO2EuYmM9W119O3VqLnByb3RvdHlwZS5nZXRSZWRpcmVjdFJlc3VsdD1mdW5jdGlvbigpe3ZhciBhPXRoaXM7cmV0dXJuIG5ldyBDKGZ1bmN0aW9uKGIsYyl7YS5BYj9hLkFiKCkudGhlbihiLGMpOihhLmNjLnB1c2goYiksYS5iYy5wdXNoKGMpLElqKGEpKX0pfTtcbnZhciBJaj1mdW5jdGlvbihhKXt2YXIgYj1uZXcgTyhcInRpbWVvdXRcIik7YS55YiYmYS55Yi5jYW5jZWwoKTthLnliPUJlKENqLmdldCgpKS50aGVuKGZ1bmN0aW9uKCl7YS5BYnx8RmooYSwhMCxudWxsLGIpfSl9LHZqPWZ1bmN0aW9uKGEpe3RoaXMuaD1hfTt2ai5wcm90b3R5cGUuVGU9ZnVuY3Rpb24oYSxiKXtpZighYSlyZXR1cm4gRShuZXcgTyhcImludmFsaWQtYXV0aC1ldmVudFwiKSk7dmFyIGM9YS5tYSxkPWEuWTtyZXR1cm4gYS5iYT90aGlzLlBkKGEsYik6Yi5OYihjLGQpP3RoaXMuUWQoYSxiKTpFKG5ldyBPKFwiaW52YWxpZC1hdXRoLWV2ZW50XCIpKX07dmoucHJvdG90eXBlLlBkPWZ1bmN0aW9uKGEsYil7Yi5iYihhLm1hLG51bGwsYS5nZXRFcnJvcigpLGEuWSk7cmV0dXJuIEQoKX07XG52ai5wcm90b3R5cGUuUWQ9ZnVuY3Rpb24oYSxiKXt2YXIgYz1hLlksZD1hLm1hLGU9Yi5OYihkLGMpLGY9YS5FYjthPWEudGMoKTtyZXR1cm4gZShmLGEpLnRoZW4oZnVuY3Rpb24oYSl7Yi5iYihkLGEsbnVsbCxjKX0pLmcoZnVuY3Rpb24oYSl7Yi5iYihkLG51bGwsYSxjKX0pfTt2YXIgSmo9ZnVuY3Rpb24oYSl7dGhpcy5mPWE7dGhpcy5KYT10aGlzLmZhPW51bGw7dGhpcy5OYT0wfTtKai5wcm90b3R5cGUuQT1mdW5jdGlvbigpe3JldHVybnthcGlLZXk6dGhpcy5mLm0scmVmcmVzaFRva2VuOnRoaXMuZmEsYWNjZXNzVG9rZW46dGhpcy5KYSxleHBpcmF0aW9uVGltZTp0aGlzLk5hfX07XG52YXIgTGo9ZnVuY3Rpb24oYSxiKXt2YXIgYz1iLmlkVG9rZW4sZD1iLnJlZnJlc2hUb2tlbjtiPUtqKGIuZXhwaXJlc0luKTthLkphPWM7YS5OYT1iO2EuZmE9ZH0sS2o9ZnVuY3Rpb24oYSl7cmV0dXJuIG1hKCkrMUUzKnBhcnNlSW50KGEsMTApfSxNaj1mdW5jdGlvbihhLGIpe3JldHVybiBoaChhLmYsYikudGhlbihmdW5jdGlvbihiKXthLkphPWIuYWNjZXNzX3Rva2VuO2EuTmE9S2ooYi5leHBpcmVzX2luKTthLmZhPWIucmVmcmVzaF90b2tlbjtyZXR1cm57YWNjZXNzVG9rZW46YS5KYSxleHBpcmF0aW9uVGltZTphLk5hLHJlZnJlc2hUb2tlbjphLmZhfX0pLmcoZnVuY3Rpb24oYil7XCJhdXRoL3VzZXItdG9rZW4tZXhwaXJlZFwiPT1iLmNvZGUmJihhLmZhPW51bGwpO3Rocm93IGI7fSl9O1xuSmoucHJvdG90eXBlLmdldFRva2VuPWZ1bmN0aW9uKGEpe2E9ISFhO3JldHVybiB0aGlzLkphJiYhdGhpcy5mYT9FKG5ldyBPKFwidXNlci10b2tlbi1leHBpcmVkXCIpKTphfHwhdGhpcy5KYXx8bWEoKT50aGlzLk5hLTNFND90aGlzLmZhP01qKHRoaXMse2dyYW50X3R5cGU6XCJyZWZyZXNoX3Rva2VuXCIscmVmcmVzaF90b2tlbjp0aGlzLmZhfSk6RChudWxsKTpEKHthY2Nlc3NUb2tlbjp0aGlzLkphLGV4cGlyYXRpb25UaW1lOnRoaXMuTmEscmVmcmVzaFRva2VuOnRoaXMuZmF9KX07dmFyIE5qPWZ1bmN0aW9uKGEsYil7dGhpcy5wZT1hfHxudWxsO3RoaXMuSmU9Ynx8bnVsbDtiZyh0aGlzLHtsYXN0U2lnbkluVGltZTpZZihifHxudWxsKSxjcmVhdGlvblRpbWU6WWYoYXx8bnVsbCl9KX07TmoucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBOaih0aGlzLnBlLHRoaXMuSmUpfTtOai5wcm90b3R5cGUuQT1mdW5jdGlvbigpe3JldHVybntsYXN0TG9naW5BdDp0aGlzLkplLGNyZWF0ZWRBdDp0aGlzLnBlfX07dmFyIE9qPWZ1bmN0aW9uKGEsYixjLGQsZSxmKXtiZyh0aGlzLHt1aWQ6YSxkaXNwbGF5TmFtZTpkfHxudWxsLHBob3RvVVJMOmV8fG51bGwsZW1haWw6Y3x8bnVsbCxwaG9uZU51bWJlcjpmfHxudWxsLHByb3ZpZGVySWQ6Yn0pfSxQaj1mdW5jdGlvbihhLGIpe0IuY2FsbCh0aGlzLGEpO2Zvcih2YXIgYyBpbiBiKXRoaXNbY109YltjXX07dChQaixCKTtcbnZhciBTPWZ1bmN0aW9uKGEsYixjKXt0aGlzLko9W107dGhpcy5tPWEuYXBpS2V5O3RoaXMubz1hLmFwcE5hbWU7dGhpcy5CPWEuYXV0aERvbWFpbnx8bnVsbDthPWZpcmViYXNlLlNES19WRVJTSU9OP0pmKGZpcmViYXNlLlNES19WRVJTSU9OKTpudWxsO3RoaXMuZj1uZXcgUih0aGlzLm0sb2YocGYpLGEpO3RoaXMucmE9bmV3IEpqKHRoaXMuZik7UWoodGhpcyxiLmlkVG9rZW4pO0xqKHRoaXMucmEsYik7Tih0aGlzLFwicmVmcmVzaFRva2VuXCIsdGhpcy5yYS5mYSk7UmoodGhpcyxjfHx7fSk7Ry5jYWxsKHRoaXMpO3RoaXMuS2M9ITE7dGhpcy5CJiZOZigpJiYodGhpcy52PUVqKHRoaXMuQix0aGlzLm0sdGhpcy5vKSk7dGhpcy5SYz1bXTt0aGlzLnNhPW51bGw7dGhpcy53Yj1Taih0aGlzKTt0aGlzLkdiPXIodGhpcy53ZCx0aGlzKTt2YXIgZD10aGlzO3RoaXMuaWE9bnVsbDt0aGlzLlBlPWZ1bmN0aW9uKGEpe2QuQ2IoYS5sYW5ndWFnZUNvZGUpfTt0aGlzLkRkPW51bGw7dGhpcy5NPVxuW107dGhpcy5PZT1mdW5jdGlvbihhKXtUaihkLGEuRmYpfTt0aGlzLnNkPW51bGx9O3QoUyxHKTtTLnByb3RvdHlwZS5DYj1mdW5jdGlvbihhKXt0aGlzLmlhPWE7YWgodGhpcy5mLGEpfTt2YXIgVWo9ZnVuY3Rpb24oYSxiKXthLkRkJiZ0YyhhLkRkLFwibGFuZ3VhZ2VDb2RlQ2hhbmdlZFwiLGEuUGUpOyhhLkRkPWIpJiZsYyhiLFwibGFuZ3VhZ2VDb2RlQ2hhbmdlZFwiLGEuUGUpfSxUaj1mdW5jdGlvbihhLGIpe2EuTT1iO2JoKGEuZixmaXJlYmFzZS5TREtfVkVSU0lPTj9KZihmaXJlYmFzZS5TREtfVkVSU0lPTixhLk0pOm51bGwpfSxWaj1mdW5jdGlvbihhLGIpe2Euc2QmJnRjKGEuc2QsXCJmcmFtZXdvcmtDaGFuZ2VkXCIsYS5PZSk7KGEuc2Q9YikmJmxjKGIsXCJmcmFtZXdvcmtDaGFuZ2VkXCIsYS5PZSl9O1MucHJvdG90eXBlLndkPWZ1bmN0aW9uKCl7dGhpcy53Yi51YiYmKHRoaXMud2Iuc3RvcCgpLHRoaXMud2Iuc3RhcnQoKSl9O1xudmFyIFdqPWZ1bmN0aW9uKGEpe3RyeXtyZXR1cm4gZmlyZWJhc2UuYXBwKGEubykuYXV0aCgpfWNhdGNoKGIpe3Rocm93IG5ldyBPKFwiaW50ZXJuYWwtZXJyb3JcIixcIk5vIGZpcmViYXNlLmF1dGguQXV0aCBpbnN0YW5jZSBpcyBhdmFpbGFibGUgZm9yIHRoZSBGaXJlYmFzZSBBcHAgJ1wiK2EubytcIichXCIpO319LFNqPWZ1bmN0aW9uKGEpe3JldHVybiBuZXcgTGkoZnVuY3Rpb24oKXtyZXR1cm4gYS5nZXRJZFRva2VuKCEwKX0sZnVuY3Rpb24oYSl7cmV0dXJuIGEmJlwiYXV0aC9uZXR3b3JrLXJlcXVlc3QtZmFpbGVkXCI9PWEuY29kZT8hMDohMX0sZnVuY3Rpb24oKXt2YXIgYj1hLnJhLk5hLW1hKCktM0U1O3JldHVybiAwPGI/YjowfSwzRTQsOTZFNCwhMSl9LFhqPWZ1bmN0aW9uKGEpe2EuS2J8fGEud2IudWJ8fChhLndiLnN0YXJ0KCksdGMoYSxcInRva2VuQ2hhbmdlZFwiLGEuR2IpLGxjKGEsXCJ0b2tlbkNoYW5nZWRcIixhLkdiKSl9LFlqPWZ1bmN0aW9uKGEpe3RjKGEsXCJ0b2tlbkNoYW5nZWRcIixcbmEuR2IpO2Eud2Iuc3RvcCgpfSxRaj1mdW5jdGlvbihhLGIpe2EuSWU9YjtOKGEsXCJfbGF0XCIsYil9LFpqPWZ1bmN0aW9uKGEsYil7WWEoYS5SYyxmdW5jdGlvbihhKXtyZXR1cm4gYT09Yn0pfSxhaz1mdW5jdGlvbihhKXtmb3IodmFyIGI9W10sYz0wO2M8YS5SYy5sZW5ndGg7YysrKWIucHVzaChhLlJjW2NdKGEpKTtyZXR1cm4gQmQoYikudGhlbihmdW5jdGlvbigpe3JldHVybiBhfSl9LGJrPWZ1bmN0aW9uKGEpe2EudiYmIWEuS2MmJihhLktjPSEwLGEudi5zdWJzY3JpYmUoYSkpfSxSaj1mdW5jdGlvbihhLGIpe2JnKGEse3VpZDpiLnVpZCxkaXNwbGF5TmFtZTpiLmRpc3BsYXlOYW1lfHxudWxsLHBob3RvVVJMOmIucGhvdG9VUkx8fG51bGwsZW1haWw6Yi5lbWFpbHx8bnVsbCxlbWFpbFZlcmlmaWVkOmIuZW1haWxWZXJpZmllZHx8ITEscGhvbmVOdW1iZXI6Yi5waG9uZU51bWJlcnx8bnVsbCxpc0Fub255bW91czpiLmlzQW5vbnltb3VzfHwhMSxtZXRhZGF0YTpuZXcgTmooYi5jcmVhdGVkQXQsXG5iLmxhc3RMb2dpbkF0KSxwcm92aWRlckRhdGE6W119KX07TihTLnByb3RvdHlwZSxcInByb3ZpZGVySWRcIixcImZpcmViYXNlXCIpO3ZhciBjaz1mdW5jdGlvbigpe30sZGs9ZnVuY3Rpb24oYSl7cmV0dXJuIEQoKS50aGVuKGZ1bmN0aW9uKCl7aWYoYS5LYil0aHJvdyBuZXcgTyhcImFwcC1kZWxldGVkXCIpO30pfSxlaz1mdW5jdGlvbihhKXtyZXR1cm4gUmEoYS5wcm92aWRlckRhdGEsZnVuY3Rpb24oYSl7cmV0dXJuIGEucHJvdmlkZXJJZH0pfSxnaz1mdW5jdGlvbihhLGIpe2ImJihmayhhLGIucHJvdmlkZXJJZCksYS5wcm92aWRlckRhdGEucHVzaChiKSl9LGZrPWZ1bmN0aW9uKGEsYil7WWEoYS5wcm92aWRlckRhdGEsZnVuY3Rpb24oYSl7cmV0dXJuIGEucHJvdmlkZXJJZD09Yn0pfSxoaz1mdW5jdGlvbihhLGIsYyl7KFwidWlkXCIhPWJ8fGMpJiZhLmhhc093blByb3BlcnR5KGIpJiZOKGEsYixjKX07XG5TLnByb3RvdHlwZS5jb3B5PWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7YiE9YSYmKGJnKHRoaXMse3VpZDphLnVpZCxkaXNwbGF5TmFtZTphLmRpc3BsYXlOYW1lLHBob3RvVVJMOmEucGhvdG9VUkwsZW1haWw6YS5lbWFpbCxlbWFpbFZlcmlmaWVkOmEuZW1haWxWZXJpZmllZCxwaG9uZU51bWJlcjphLnBob25lTnVtYmVyLGlzQW5vbnltb3VzOmEuaXNBbm9ueW1vdXMscHJvdmlkZXJEYXRhOltdfSksYS5tZXRhZGF0YT9OKHRoaXMsXCJtZXRhZGF0YVwiLGEubWV0YWRhdGEuY2xvbmUoKSk6Tih0aGlzLFwibWV0YWRhdGFcIixuZXcgTmopLHgoYS5wcm92aWRlckRhdGEsZnVuY3Rpb24oYSl7Z2soYixhKX0pLHRoaXMucmE9YS5yYSxOKHRoaXMsXCJyZWZyZXNoVG9rZW5cIix0aGlzLnJhLmZhKSl9O1MucHJvdG90eXBlLnJlbG9hZD1mdW5jdGlvbigpe3ZhciBhPXRoaXM7cmV0dXJuIHRoaXMuYyhkayh0aGlzKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGlrKGEpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gYWsoYSl9KS50aGVuKGNrKX0pKX07XG52YXIgaWs9ZnVuY3Rpb24oYSl7cmV0dXJuIGEuZ2V0SWRUb2tlbigpLnRoZW4oZnVuY3Rpb24oYil7dmFyIGM9YS5pc0Fub255bW91cztyZXR1cm4gamsoYSxiKS50aGVuKGZ1bmN0aW9uKCl7Y3x8aGsoYSxcImlzQW5vbnltb3VzXCIsITEpO3JldHVybiBifSl9KX07Uy5wcm90b3R5cGUuZ2V0SWRUb2tlbj1mdW5jdGlvbihhKXt2YXIgYj10aGlzO3JldHVybiB0aGlzLmMoZGsodGhpcykudGhlbihmdW5jdGlvbigpe3JldHVybiBiLnJhLmdldFRva2VuKGEpfSkudGhlbihmdW5jdGlvbihhKXtpZighYSl0aHJvdyBuZXcgTyhcImludGVybmFsLWVycm9yXCIpO2EuYWNjZXNzVG9rZW4hPWIuSWUmJihRaihiLGEuYWNjZXNzVG9rZW4pLGIuVGEoKSk7aGsoYixcInJlZnJlc2hUb2tlblwiLGEucmVmcmVzaFRva2VuKTtyZXR1cm4gYS5hY2Nlc3NUb2tlbn0pKX07XG5TLnByb3RvdHlwZS5nZXRUb2tlbj1mdW5jdGlvbihhKXtaZltcImZpcmViYXNlLlVzZXIucHJvdG90eXBlLmdldFRva2VuIGlzIGRlcHJlY2F0ZWQuIFBsZWFzZSB1c2UgZmlyZWJhc2UuVXNlci5wcm90b3R5cGUuZ2V0SWRUb2tlbiBpbnN0ZWFkLlwiXXx8KFpmW1wiZmlyZWJhc2UuVXNlci5wcm90b3R5cGUuZ2V0VG9rZW4gaXMgZGVwcmVjYXRlZC4gUGxlYXNlIHVzZSBmaXJlYmFzZS5Vc2VyLnByb3RvdHlwZS5nZXRJZFRva2VuIGluc3RlYWQuXCJdPSEwLFwidW5kZWZpbmVkXCIhPT10eXBlb2YgY29uc29sZSYmXCJmdW5jdGlvblwiPT09dHlwZW9mIGNvbnNvbGUud2FybiYmY29uc29sZS53YXJuKFwiZmlyZWJhc2UuVXNlci5wcm90b3R5cGUuZ2V0VG9rZW4gaXMgZGVwcmVjYXRlZC4gUGxlYXNlIHVzZSBmaXJlYmFzZS5Vc2VyLnByb3RvdHlwZS5nZXRJZFRva2VuIGluc3RlYWQuXCIpKTtyZXR1cm4gdGhpcy5nZXRJZFRva2VuKGEpfTtcbnZhciBraz1mdW5jdGlvbihhLGIpe2IuaWRUb2tlbiYmYS5JZSE9Yi5pZFRva2VuJiYoTGooYS5yYSxiKSxhLlRhKCksUWooYSxiLmlkVG9rZW4pLGhrKGEsXCJyZWZyZXNoVG9rZW5cIixhLnJhLmZhKSl9O1MucHJvdG90eXBlLlRhPWZ1bmN0aW9uKCl7dGhpcy5kaXNwYXRjaEV2ZW50KG5ldyBQaihcInRva2VuQ2hhbmdlZFwiKSl9O3ZhciBqaz1mdW5jdGlvbihhLGIpe3JldHVybiBRKGEuZixLaCx7aWRUb2tlbjpifSkudGhlbihyKGEuZ2csYSkpfTtcblMucHJvdG90eXBlLmdnPWZ1bmN0aW9uKGEpe2E9YS51c2VycztpZighYXx8IWEubGVuZ3RoKXRocm93IG5ldyBPKFwiaW50ZXJuYWwtZXJyb3JcIik7YT1hWzBdO1JqKHRoaXMse3VpZDphLmxvY2FsSWQsZGlzcGxheU5hbWU6YS5kaXNwbGF5TmFtZSxwaG90b1VSTDphLnBob3RvVXJsLGVtYWlsOmEuZW1haWwsZW1haWxWZXJpZmllZDohIWEuZW1haWxWZXJpZmllZCxwaG9uZU51bWJlcjphLnBob25lTnVtYmVyLGxhc3RMb2dpbkF0OmEubGFzdExvZ2luQXQsY3JlYXRlZEF0OmEuY3JlYXRlZEF0fSk7Zm9yKHZhciBiPWxrKGEpLGM9MDtjPGIubGVuZ3RoO2MrKylnayh0aGlzLGJbY10pO2hrKHRoaXMsXCJpc0Fub255bW91c1wiLCEodGhpcy5lbWFpbCYmYS5wYXNzd29yZEhhc2gpJiYhKHRoaXMucHJvdmlkZXJEYXRhJiZ0aGlzLnByb3ZpZGVyRGF0YS5sZW5ndGgpKX07XG52YXIgbGs9ZnVuY3Rpb24oYSl7cmV0dXJuKGE9YS5wcm92aWRlclVzZXJJbmZvKSYmYS5sZW5ndGg/UmEoYSxmdW5jdGlvbihhKXtyZXR1cm4gbmV3IE9qKGEucmF3SWQsYS5wcm92aWRlcklkLGEuZW1haWwsYS5kaXNwbGF5TmFtZSxhLnBob3RvVXJsLGEucGhvbmVOdW1iZXIpfSk6W119O1MucHJvdG90eXBlLnJlYXV0aGVudGljYXRlQW5kUmV0cmlldmVEYXRhV2l0aENyZWRlbnRpYWw9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcyxjPW51bGw7cmV0dXJuIHRoaXMuYyhhLkdkKHRoaXMuZix0aGlzLnVpZCkudGhlbihmdW5jdGlvbihhKXtrayhiLGEpO2M9bWsoYixhLFwicmVhdXRoZW50aWNhdGVcIik7Yi5zYT1udWxsO3JldHVybiBiLnJlbG9hZCgpfSkudGhlbihmdW5jdGlvbigpe3JldHVybiBjfSksITApfTtTLnByb3RvdHlwZS5yZWF1dGhlbnRpY2F0ZVdpdGhDcmVkZW50aWFsPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnJlYXV0aGVudGljYXRlQW5kUmV0cmlldmVEYXRhV2l0aENyZWRlbnRpYWwoYSkudGhlbihmdW5jdGlvbigpe30pfTtcbnZhciBuaz1mdW5jdGlvbihhLGIpe3JldHVybiBpayhhKS50aGVuKGZ1bmN0aW9uKCl7aWYoVmEoZWsoYSksYikpcmV0dXJuIGFrKGEpLnRoZW4oZnVuY3Rpb24oKXt0aHJvdyBuZXcgTyhcInByb3ZpZGVyLWFscmVhZHktbGlua2VkXCIpO30pfSl9O1MucHJvdG90eXBlLmxpbmtBbmRSZXRyaWV2ZURhdGFXaXRoQ3JlZGVudGlhbD1mdW5jdGlvbihhKXt2YXIgYj10aGlzLGM9bnVsbDtyZXR1cm4gdGhpcy5jKG5rKHRoaXMsYS5wcm92aWRlcklkKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGIuZ2V0SWRUb2tlbigpfSkudGhlbihmdW5jdGlvbihjKXtyZXR1cm4gYS5GYyhiLmYsYyl9KS50aGVuKGZ1bmN0aW9uKGEpe2M9bWsoYixhLFwibGlua1wiKTtyZXR1cm4gb2soYixhKX0pLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gY30pKX07Uy5wcm90b3R5cGUubGlua1dpdGhDcmVkZW50aWFsPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmxpbmtBbmRSZXRyaWV2ZURhdGFXaXRoQ3JlZGVudGlhbChhKS50aGVuKGZ1bmN0aW9uKGEpe3JldHVybiBhLnVzZXJ9KX07XG5TLnByb3RvdHlwZS5saW5rV2l0aFBob25lTnVtYmVyPWZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcztyZXR1cm4gdGhpcy5jKG5rKHRoaXMsXCJwaG9uZVwiKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIEppKFdqKGMpLGEsYixyKGMubGlua0FuZFJldHJpZXZlRGF0YVdpdGhDcmVkZW50aWFsLGMpKX0pKX07Uy5wcm90b3R5cGUucmVhdXRoZW50aWNhdGVXaXRoUGhvbmVOdW1iZXI9ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzO3JldHVybiB0aGlzLmMoRCgpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gSmkoV2ooYyksYSxiLHIoYy5yZWF1dGhlbnRpY2F0ZUFuZFJldHJpZXZlRGF0YVdpdGhDcmVkZW50aWFsLGMpKX0pLCEwKX07dmFyIG1rPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD1SZyhiKTtiPVVpKGIpO3JldHVybiBjZyh7dXNlcjphLGNyZWRlbnRpYWw6ZCxhZGRpdGlvbmFsVXNlckluZm86YixvcGVyYXRpb25UeXBlOmN9KX0sb2s9ZnVuY3Rpb24oYSxiKXtrayhhLGIpO3JldHVybiBhLnJlbG9hZCgpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gYX0pfTtcbmg9Uy5wcm90b3R5cGU7aC51cGRhdGVFbWFpbD1mdW5jdGlvbihhKXt2YXIgYj10aGlzO3JldHVybiB0aGlzLmModGhpcy5nZXRJZFRva2VuKCkudGhlbihmdW5jdGlvbihjKXtyZXR1cm4gYi5mLnVwZGF0ZUVtYWlsKGMsYSl9KS50aGVuKGZ1bmN0aW9uKGEpe2trKGIsYSk7cmV0dXJuIGIucmVsb2FkKCl9KSl9O2gudXBkYXRlUGhvbmVOdW1iZXI9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztyZXR1cm4gdGhpcy5jKHRoaXMuZ2V0SWRUb2tlbigpLnRoZW4oZnVuY3Rpb24oYyl7cmV0dXJuIGEuRmMoYi5mLGMpfSkudGhlbihmdW5jdGlvbihhKXtrayhiLGEpO3JldHVybiBiLnJlbG9hZCgpfSkpfTtoLnVwZGF0ZVBhc3N3b3JkPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7cmV0dXJuIHRoaXMuYyh0aGlzLmdldElkVG9rZW4oKS50aGVuKGZ1bmN0aW9uKGMpe3JldHVybiBiLmYudXBkYXRlUGFzc3dvcmQoYyxhKX0pLnRoZW4oZnVuY3Rpb24oYSl7a2soYixhKTtyZXR1cm4gYi5yZWxvYWQoKX0pKX07XG5oLnVwZGF0ZVByb2ZpbGU9ZnVuY3Rpb24oYSl7aWYodm9pZCAwPT09YS5kaXNwbGF5TmFtZSYmdm9pZCAwPT09YS5waG90b1VSTClyZXR1cm4gZGsodGhpcyk7dmFyIGI9dGhpcztyZXR1cm4gdGhpcy5jKHRoaXMuZ2V0SWRUb2tlbigpLnRoZW4oZnVuY3Rpb24oYyl7cmV0dXJuIGIuZi51cGRhdGVQcm9maWxlKGMse2Rpc3BsYXlOYW1lOmEuZGlzcGxheU5hbWUscGhvdG9Vcmw6YS5waG90b1VSTH0pfSkudGhlbihmdW5jdGlvbihhKXtrayhiLGEpO2hrKGIsXCJkaXNwbGF5TmFtZVwiLGEuZGlzcGxheU5hbWV8fG51bGwpO2hrKGIsXCJwaG90b1VSTFwiLGEucGhvdG9Vcmx8fG51bGwpO3goYi5wcm92aWRlckRhdGEsZnVuY3Rpb24oYSl7XCJwYXNzd29yZFwiPT09YS5wcm92aWRlcklkJiYoTihhLFwiZGlzcGxheU5hbWVcIixiLmRpc3BsYXlOYW1lKSxOKGEsXCJwaG90b1VSTFwiLGIucGhvdG9VUkwpKX0pO3JldHVybiBhayhiKX0pLnRoZW4oY2spKX07XG5oLnVubGluaz1mdW5jdGlvbihhKXt2YXIgYj10aGlzO3JldHVybiB0aGlzLmMoaWsodGhpcykudGhlbihmdW5jdGlvbihjKXtyZXR1cm4gVmEoZWsoYiksYSk/eWgoYi5mLGMsW2FdKS50aGVuKGZ1bmN0aW9uKGEpe3ZhciBjPXt9O3goYS5wcm92aWRlclVzZXJJbmZvfHxbXSxmdW5jdGlvbihhKXtjW2EucHJvdmlkZXJJZF09ITB9KTt4KGVrKGIpLGZ1bmN0aW9uKGEpe2NbYV18fGZrKGIsYSl9KTtjW09nLlBST1ZJREVSX0lEXXx8TihiLFwicGhvbmVOdW1iZXJcIixudWxsKTtyZXR1cm4gYWsoYil9KTphayhiKS50aGVuKGZ1bmN0aW9uKCl7dGhyb3cgbmV3IE8oXCJuby1zdWNoLXByb3ZpZGVyXCIpO30pfSkpfTtcbmhbXCJkZWxldGVcIl09ZnVuY3Rpb24oKXt2YXIgYT10aGlzO3JldHVybiB0aGlzLmModGhpcy5nZXRJZFRva2VuKCkudGhlbihmdW5jdGlvbihiKXtyZXR1cm4gUShhLmYsSmgse2lkVG9rZW46Yn0pfSkudGhlbihmdW5jdGlvbigpe2EuZGlzcGF0Y2hFdmVudChuZXcgUGooXCJ1c2VyRGVsZXRlZFwiKSl9KSkudGhlbihmdW5jdGlvbigpe2Zvcih2YXIgYj0wO2I8YS5KLmxlbmd0aDtiKyspYS5KW2JdLmNhbmNlbChcImFwcC1kZWxldGVkXCIpO1VqKGEsbnVsbCk7VmooYSxudWxsKTthLko9W107YS5LYj0hMDtZaihhKTtOKGEsXCJyZWZyZXNoVG9rZW5cIixudWxsKTthLnYmJmEudi51bnN1YnNjcmliZShhKX0pfTtcbmgua2U9ZnVuY3Rpb24oYSxiKXtyZXR1cm5cImxpbmtWaWFQb3B1cFwiPT1hJiYodGhpcy5sYXx8bnVsbCk9PWImJnRoaXMua2F8fFwicmVhdXRoVmlhUG9wdXBcIj09YSYmKHRoaXMubGF8fG51bGwpPT1iJiZ0aGlzLmthfHxcImxpbmtWaWFSZWRpcmVjdFwiPT1hJiYodGhpcy5IYXx8bnVsbCk9PWJ8fFwicmVhdXRoVmlhUmVkaXJlY3RcIj09YSYmKHRoaXMuSGF8fG51bGwpPT1iPyEwOiExfTtoLmJiPWZ1bmN0aW9uKGEsYixjLGQpe1wibGlua1ZpYVBvcHVwXCIhPWEmJlwicmVhdXRoVmlhUG9wdXBcIiE9YXx8ZCE9KHRoaXMubGF8fG51bGwpfHwoYyYmdGhpcy5WYT90aGlzLlZhKGMpOmImJiFjJiZ0aGlzLmthJiZ0aGlzLmthKGIpLHRoaXMuSyYmKHRoaXMuSy5jYW5jZWwoKSx0aGlzLks9bnVsbCksZGVsZXRlIHRoaXMua2EsZGVsZXRlIHRoaXMuVmEpfTtcbmguTmI9ZnVuY3Rpb24oYSxiKXtyZXR1cm5cImxpbmtWaWFQb3B1cFwiPT1hJiZiPT0odGhpcy5sYXx8bnVsbCk/cih0aGlzLnVlLHRoaXMpOlwicmVhdXRoVmlhUG9wdXBcIj09YSYmYj09KHRoaXMubGF8fG51bGwpP3IodGhpcy52ZSx0aGlzKTpcImxpbmtWaWFSZWRpcmVjdFwiPT1hJiYodGhpcy5IYXx8bnVsbCk9PWI/cih0aGlzLnVlLHRoaXMpOlwicmVhdXRoVmlhUmVkaXJlY3RcIj09YSYmKHRoaXMuSGF8fG51bGwpPT1iP3IodGhpcy52ZSx0aGlzKTpudWxsfTtoLnNjPWZ1bmN0aW9uKCl7cmV0dXJuIEtmKHRoaXMudWlkK1wiOjo6XCIpfTtoLmxpbmtXaXRoUG9wdXA9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztyZXR1cm4gcGsodGhpcyxcImxpbmtWaWFQb3B1cFwiLGEsZnVuY3Rpb24oKXtyZXR1cm4gbmsoYixhLnByb3ZpZGVySWQpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gYWsoYil9KX0sITEpfTtcbmgucmVhdXRoZW50aWNhdGVXaXRoUG9wdXA9ZnVuY3Rpb24oYSl7cmV0dXJuIHBrKHRoaXMsXCJyZWF1dGhWaWFQb3B1cFwiLGEsZnVuY3Rpb24oKXtyZXR1cm4gRCgpfSwhMCl9O1xudmFyIHBrPWZ1bmN0aW9uKGEsYixjLGQsZSl7aWYoIU5mKCkpcmV0dXJuIEUobmV3IE8oXCJvcGVyYXRpb24tbm90LXN1cHBvcnRlZC1pbi10aGlzLWVudmlyb25tZW50XCIpKTtpZihhLnNhJiYhZSlyZXR1cm4gRShhLnNhKTt2YXIgZj1qZyhjLnByb3ZpZGVySWQpLGc9YS5zYygpLGw9bnVsbDsoIU9mKCl8fEZmKCkpJiZhLkImJmMuaXNPQXV0aFByb3ZpZGVyJiYobD1jaShhLkIsYS5tLGEubyxiLGMsbnVsbCxnLGZpcmViYXNlLlNES19WRVJTSU9OfHxudWxsKSk7dmFyIG49eWYobCxmJiZmLlpiLGYmJmYuWWIpO2Q9ZCgpLnRoZW4oZnVuY3Rpb24oKXtxayhhKTtpZighZSlyZXR1cm4gYS5nZXRJZFRva2VuKCkudGhlbihmdW5jdGlvbigpe30pfSkudGhlbihmdW5jdGlvbigpe3JldHVybiBhLnYuJGIobixiLGMsZywhIWwpfSkudGhlbihmdW5jdGlvbigpe3JldHVybiBuZXcgQyhmdW5jdGlvbihjLGQpe2EuYmIoYixudWxsLG5ldyBPKFwiY2FuY2VsbGVkLXBvcHVwLXJlcXVlc3RcIiksYS5sYXx8XG5udWxsKTthLmthPWM7YS5WYT1kO2EubGE9ZzthLks9YS52LmVjKGEsYixuLGcpfSl9KS50aGVuKGZ1bmN0aW9uKGEpe24mJnhmKG4pO3JldHVybiBhP2NnKGEpOm51bGx9KS5nKGZ1bmN0aW9uKGEpe24mJnhmKG4pO3Rocm93IGE7fSk7cmV0dXJuIGEuYyhkLGUpfTtTLnByb3RvdHlwZS5saW5rV2l0aFJlZGlyZWN0PWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7cmV0dXJuIHJrKHRoaXMsXCJsaW5rVmlhUmVkaXJlY3RcIixhLGZ1bmN0aW9uKCl7cmV0dXJuIG5rKGIsYS5wcm92aWRlcklkKX0sITEpfTtTLnByb3RvdHlwZS5yZWF1dGhlbnRpY2F0ZVdpdGhSZWRpcmVjdD1mdW5jdGlvbihhKXtyZXR1cm4gcmsodGhpcyxcInJlYXV0aFZpYVJlZGlyZWN0XCIsYSxmdW5jdGlvbigpe3JldHVybiBEKCl9LCEwKX07XG52YXIgcms9ZnVuY3Rpb24oYSxiLGMsZCxlKXtpZighTmYoKSlyZXR1cm4gRShuZXcgTyhcIm9wZXJhdGlvbi1ub3Qtc3VwcG9ydGVkLWluLXRoaXMtZW52aXJvbm1lbnRcIikpO2lmKGEuc2EmJiFlKXJldHVybiBFKGEuc2EpO3ZhciBmPW51bGwsZz1hLnNjKCk7ZD1kKCkudGhlbihmdW5jdGlvbigpe3FrKGEpO2lmKCFlKXJldHVybiBhLmdldElkVG9rZW4oKS50aGVuKGZ1bmN0aW9uKCl7fSl9KS50aGVuKGZ1bmN0aW9uKCl7YS5IYT1nO3JldHVybiBhayhhKX0pLnRoZW4oZnVuY3Rpb24oYil7YS5ZYSYmKGI9YS5ZYSxiPWIuaC5zZXQoc2ssYS5BKCksYi5qKSk7cmV0dXJuIGJ9KS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGEudi5hYyhiLGMsZyl9KS5nKGZ1bmN0aW9uKGIpe2Y9YjtpZihhLllhKXJldHVybiB0ayhhLllhKTt0aHJvdyBmO30pLnRoZW4oZnVuY3Rpb24oKXtpZihmKXRocm93IGY7fSk7cmV0dXJuIGEuYyhkLGUpfSxxaz1mdW5jdGlvbihhKXtpZighYS52fHwhYS5LYyl7aWYoYS52JiZcbiFhLktjKXRocm93IG5ldyBPKFwiaW50ZXJuYWwtZXJyb3JcIik7dGhyb3cgbmV3IE8oXCJhdXRoLWRvbWFpbi1jb25maWctcmVxdWlyZWRcIik7fX07Uy5wcm90b3R5cGUudWU9ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzO3RoaXMuSyYmKHRoaXMuSy5jYW5jZWwoKSx0aGlzLks9bnVsbCk7dmFyIGQ9bnVsbCxlPXRoaXMuZ2V0SWRUb2tlbigpLnRoZW4oZnVuY3Rpb24oZCl7cmV0dXJuIHZnKGMuZix7cmVxdWVzdFVyaTphLHNlc3Npb25JZDpiLGlkVG9rZW46ZH0pfSkudGhlbihmdW5jdGlvbihhKXtkPW1rKGMsYSxcImxpbmtcIik7cmV0dXJuIG9rKGMsYSl9KS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGR9KTtyZXR1cm4gdGhpcy5jKGUpfTtcblMucHJvdG90eXBlLnZlPWZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpczt0aGlzLksmJih0aGlzLksuY2FuY2VsKCksdGhpcy5LPW51bGwpO3ZhciBkPW51bGwsZT1EKCkudGhlbihmdW5jdGlvbigpe3JldHVybiByZyh3ZyhjLmYse3JlcXVlc3RVcmk6YSxzZXNzaW9uSWQ6Yn0pLGMudWlkKX0pLnRoZW4oZnVuY3Rpb24oYSl7ZD1tayhjLGEsXCJyZWF1dGhlbnRpY2F0ZVwiKTtrayhjLGEpO2Muc2E9bnVsbDtyZXR1cm4gYy5yZWxvYWQoKX0pLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gZH0pO3JldHVybiB0aGlzLmMoZSwhMCl9O1xuUy5wcm90b3R5cGUuc2VuZEVtYWlsVmVyaWZpY2F0aW9uPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMsYz1udWxsO3JldHVybiB0aGlzLmModGhpcy5nZXRJZFRva2VuKCkudGhlbihmdW5jdGlvbihiKXtjPWI7cmV0dXJuXCJ1bmRlZmluZWRcIj09PXR5cGVvZiBhfHxpYihhKT97fTpIaShuZXcgR2koYSkpfSkudGhlbihmdW5jdGlvbihhKXtyZXR1cm4gYi5mLnNlbmRFbWFpbFZlcmlmaWNhdGlvbihjLGEpfSkudGhlbihmdW5jdGlvbihhKXtpZihiLmVtYWlsIT1hKXJldHVybiBiLnJlbG9hZCgpfSkudGhlbihmdW5jdGlvbigpe30pKX07Uy5wcm90b3R5cGUuYz1mdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMsZD11ayh0aGlzLGEsYik7dGhpcy5KLnB1c2goZCk7RWQoZCxmdW5jdGlvbigpe1hhKGMuSixkKX0pO3JldHVybiBkfTtcbnZhciB1az1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIGEuc2EmJiFjPyhiLmNhbmNlbCgpLEUoYS5zYSkpOmIuZyhmdW5jdGlvbihiKXshYnx8XCJhdXRoL3VzZXItZGlzYWJsZWRcIiE9Yi5jb2RlJiZcImF1dGgvdXNlci10b2tlbi1leHBpcmVkXCIhPWIuY29kZXx8KGEuc2F8fGEuZGlzcGF0Y2hFdmVudChuZXcgUGooXCJ1c2VySW52YWxpZGF0ZWRcIikpLGEuc2E9Yik7dGhyb3cgYjt9KX07Uy5wcm90b3R5cGUudG9KU09OPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuQSgpfTtcblMucHJvdG90eXBlLkE9ZnVuY3Rpb24oKXt2YXIgYT17dWlkOnRoaXMudWlkLGRpc3BsYXlOYW1lOnRoaXMuZGlzcGxheU5hbWUscGhvdG9VUkw6dGhpcy5waG90b1VSTCxlbWFpbDp0aGlzLmVtYWlsLGVtYWlsVmVyaWZpZWQ6dGhpcy5lbWFpbFZlcmlmaWVkLHBob25lTnVtYmVyOnRoaXMucGhvbmVOdW1iZXIsaXNBbm9ueW1vdXM6dGhpcy5pc0Fub255bW91cyxwcm92aWRlckRhdGE6W10sYXBpS2V5OnRoaXMubSxhcHBOYW1lOnRoaXMubyxhdXRoRG9tYWluOnRoaXMuQixzdHNUb2tlbk1hbmFnZXI6dGhpcy5yYS5BKCkscmVkaXJlY3RFdmVudElkOnRoaXMuSGF8fG51bGx9O3RoaXMubWV0YWRhdGEmJm1iKGEsdGhpcy5tZXRhZGF0YS5BKCkpO3godGhpcy5wcm92aWRlckRhdGEsZnVuY3Rpb24oYil7YS5wcm92aWRlckRhdGEucHVzaChkZyhiKSl9KTtyZXR1cm4gYX07XG52YXIgdms9ZnVuY3Rpb24oYSl7aWYoIWEuYXBpS2V5KXJldHVybiBudWxsO3ZhciBiPXthcGlLZXk6YS5hcGlLZXksYXV0aERvbWFpbjphLmF1dGhEb21haW4sYXBwTmFtZTphLmFwcE5hbWV9LGM9e307aWYoYS5zdHNUb2tlbk1hbmFnZXImJmEuc3RzVG9rZW5NYW5hZ2VyLmFjY2Vzc1Rva2VuJiZhLnN0c1Rva2VuTWFuYWdlci5leHBpcmF0aW9uVGltZSljLmlkVG9rZW49YS5zdHNUb2tlbk1hbmFnZXIuYWNjZXNzVG9rZW4sYy5yZWZyZXNoVG9rZW49YS5zdHNUb2tlbk1hbmFnZXIucmVmcmVzaFRva2VufHxudWxsLGMuZXhwaXJlc0luPShhLnN0c1Rva2VuTWFuYWdlci5leHBpcmF0aW9uVGltZS1tYSgpKS8xRTM7ZWxzZSByZXR1cm4gbnVsbDt2YXIgZD1uZXcgUyhiLGMsYSk7YS5wcm92aWRlckRhdGEmJngoYS5wcm92aWRlckRhdGEsZnVuY3Rpb24oYSl7YSYmZ2soZCxjZyhhKSl9KTthLnJlZGlyZWN0RXZlbnRJZCYmKGQuSGE9YS5yZWRpcmVjdEV2ZW50SWQpO3JldHVybiBkfSxcbndrPWZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPW5ldyBTKGEsYik7YyYmKGUuWWE9Yyk7ZCYmVGooZSxkKTtyZXR1cm4gZS5yZWxvYWQoKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGV9KX07dmFyIHhrPWZ1bmN0aW9uKGEpe3RoaXMuaj1hO3RoaXMuaD1aaSgpfSxzaz17bmFtZTpcInJlZGlyZWN0VXNlclwiLEQ6XCJzZXNzaW9uXCJ9LHRrPWZ1bmN0aW9uKGEpe3JldHVybiBhLmgucmVtb3ZlKHNrLGEuail9LHlrPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuaC5nZXQoc2ssYS5qKS50aGVuKGZ1bmN0aW9uKGEpe2EmJmImJihhLmF1dGhEb21haW49Yik7cmV0dXJuIHZrKGF8fHt9KX0pfTt2YXIgQWs9ZnVuY3Rpb24oYSxiKXt0aGlzLmo9YTt0aGlzLmg9Ynx8WmkoKTt0aGlzLk89bnVsbDt0aGlzLkpkPXRoaXMuQmQoKTt0aGlzLmguYWRkTGlzdGVuZXIoemsoXCJsb2NhbFwiKSx0aGlzLmoscih0aGlzLnZnLHRoaXMpKX07QWsucHJvdG90eXBlLnZnPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPXprKFwibG9jYWxcIik7QmsodGhpcyxmdW5jdGlvbigpe3JldHVybiBEKCkudGhlbihmdW5jdGlvbigpe3JldHVybiBhLk8mJlwibG9jYWxcIiE9YS5PLkQ/YS5oLmdldChiLGEuaik6bnVsbH0pLnRoZW4oZnVuY3Rpb24oYyl7aWYoYylyZXR1cm4gQ2soYSxcImxvY2FsXCIpLnRoZW4oZnVuY3Rpb24oKXthLk89Yn0pfSl9KX07dmFyIENrPWZ1bmN0aW9uKGEsYil7dmFyIGM9W10sZDtmb3IoZCBpbiBWaSlWaVtkXSE9PWImJmMucHVzaChhLmgucmVtb3ZlKHprKFZpW2RdKSxhLmopKTtjLnB1c2goYS5oLnJlbW92ZShEayxhLmopKTtyZXR1cm4gQWQoYyl9O1xuQWsucHJvdG90eXBlLkJkPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPXprKFwibG9jYWxcIiksYz16ayhcInNlc3Npb25cIiksZD16ayhcIm5vbmVcIik7cmV0dXJuIHRoaXMuaC5nZXQoYyx0aGlzLmopLnRoZW4oZnVuY3Rpb24oZSl7cmV0dXJuIGU/YzphLmguZ2V0KGQsYS5qKS50aGVuKGZ1bmN0aW9uKGMpe3JldHVybiBjP2Q6YS5oLmdldChiLGEuaikudGhlbihmdW5jdGlvbihjKXtyZXR1cm4gYz9iOmEuaC5nZXQoRGssYS5qKS50aGVuKGZ1bmN0aW9uKGEpe3JldHVybiBhP3prKGEpOmJ9KX0pfSl9KS50aGVuKGZ1bmN0aW9uKGIpe2EuTz1iO3JldHVybiBDayhhLGIuRCl9KS5nKGZ1bmN0aW9uKCl7YS5PfHwoYS5PPWIpfSl9O3ZhciBEaz17bmFtZTpcInBlcnNpc3RlbmNlXCIsRDpcInNlc3Npb25cIn0sems9ZnVuY3Rpb24oYSl7cmV0dXJue25hbWU6XCJhdXRoVXNlclwiLEQ6YX19O1xuQWsucHJvdG90eXBlLnNldFBlcnNpc3RlbmNlPWZ1bmN0aW9uKGEpe3ZhciBiPW51bGwsYz10aGlzO1dpKGEpO3JldHVybiBCayh0aGlzLGZ1bmN0aW9uKCl7cmV0dXJuIGEhPWMuTy5EP2MuaC5nZXQoYy5PLGMuaikudGhlbihmdW5jdGlvbihkKXtiPWQ7cmV0dXJuIENrKGMsYSl9KS50aGVuKGZ1bmN0aW9uKCl7Yy5PPXprKGEpO2lmKGIpcmV0dXJuIGMuaC5zZXQoYy5PLGIsYy5qKX0pOkQoKX0pfTtcbnZhciBFaz1mdW5jdGlvbihhKXtyZXR1cm4gQmsoYSxmdW5jdGlvbigpe3JldHVybiBhLmguc2V0KERrLGEuTy5ELGEuail9KX0sRms9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gQmsoYSxmdW5jdGlvbigpe3JldHVybiBhLmguc2V0KGEuTyxiLkEoKSxhLmopfSl9LEdrPWZ1bmN0aW9uKGEpe3JldHVybiBCayhhLGZ1bmN0aW9uKCl7cmV0dXJuIGEuaC5yZW1vdmUoYS5PLGEuail9KX0sSGs9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gQmsoYSxmdW5jdGlvbigpe3JldHVybiBhLmguZ2V0KGEuTyxhLmopLnRoZW4oZnVuY3Rpb24oYSl7YSYmYiYmKGEuYXV0aERvbWFpbj1iKTtyZXR1cm4gdmsoYXx8e30pfSl9KX0sQms9ZnVuY3Rpb24oYSxiKXthLkpkPWEuSmQudGhlbihiLGIpO3JldHVybiBhLkpkfTt2YXIgVD1mdW5jdGlvbihhKXt0aGlzLkVhPSExO04odGhpcyxcImFwcFwiLGEpO2lmKHRoaXMuaSgpLm9wdGlvbnMmJnRoaXMuaSgpLm9wdGlvbnMuYXBpS2V5KWE9ZmlyZWJhc2UuU0RLX1ZFUlNJT04/SmYoZmlyZWJhc2UuU0RLX1ZFUlNJT04pOm51bGwsdGhpcy5mPW5ldyBSKHRoaXMuaSgpLm9wdGlvbnMmJnRoaXMuaSgpLm9wdGlvbnMuYXBpS2V5LG9mKHBmKSxhKTtlbHNlIHRocm93IG5ldyBPKFwiaW52YWxpZC1hcGkta2V5XCIpO3RoaXMuSj1bXTt0aGlzLkthPVtdO3RoaXMuRmI9W107dGhpcy5jZz1maXJlYmFzZS5JTlRFUk5BTC5jcmVhdGVTdWJzY3JpYmUocih0aGlzLlNmLHRoaXMpKTt0aGlzLmtjPXZvaWQgMDt0aGlzLmVnPWZpcmViYXNlLklOVEVSTkFMLmNyZWF0ZVN1YnNjcmliZShyKHRoaXMuVWYsdGhpcykpO0lrKHRoaXMsbnVsbCk7YT10aGlzLmkoKS5vcHRpb25zLmFwaUtleTt2YXIgYj10aGlzLmkoKS5uYW1lO3RoaXMubmE9bmV3IEFrKGErXCI6XCIrYik7YT10aGlzLmkoKS5vcHRpb25zLmFwaUtleTtcbmI9dGhpcy5pKCkubmFtZTt0aGlzLnpiPW5ldyB4ayhhK1wiOlwiK2IpO3RoaXMub2M9dGhpcy5jKEprKHRoaXMpKTt0aGlzLnlhPXRoaXMuYyhLayh0aGlzKSk7dGhpcy5DYz0hMTt0aGlzLnVkPXIodGhpcy53Zyx0aGlzKTt0aGlzLmVmPXIodGhpcy5wYix0aGlzKTt0aGlzLkdiPXIodGhpcy53ZCx0aGlzKTt0aGlzLmNmPXIodGhpcy5PZix0aGlzKTt0aGlzLmRmPXIodGhpcy5QZix0aGlzKTtMayh0aGlzKTt0aGlzLklOVEVSTkFMPXt9O3RoaXMuSU5URVJOQUxbXCJkZWxldGVcIl09cih0aGlzW1wiZGVsZXRlXCJdLHRoaXMpO3RoaXMuSU5URVJOQUwubG9nRnJhbWV3b3JrPXIodGhpcy4kZix0aGlzKTt0aGlzLk9hPTA7Ry5jYWxsKHRoaXMpO01rKHRoaXMpO3RoaXMuTT1bXX07dChULEcpO3ZhciBOaz1mdW5jdGlvbihhKXtCLmNhbGwodGhpcyxcImxhbmd1YWdlQ29kZUNoYW5nZWRcIik7dGhpcy5sYW5ndWFnZUNvZGU9YX07dChOayxCKTtcbnZhciBPaz1mdW5jdGlvbihhKXtCLmNhbGwodGhpcyxcImZyYW1ld29ya0NoYW5nZWRcIik7dGhpcy5GZj1hfTt0KE9rLEIpO1QucHJvdG90eXBlLnNldFBlcnNpc3RlbmNlPWZ1bmN0aW9uKGEpe2E9dGhpcy5uYS5zZXRQZXJzaXN0ZW5jZShhKTtyZXR1cm4gdGhpcy5jKGEpfTtULnByb3RvdHlwZS5DYj1mdW5jdGlvbihhKXt0aGlzLmlhPT09YXx8dGhpcy5FYXx8KHRoaXMuaWE9YSxhaCh0aGlzLmYsdGhpcy5pYSksdGhpcy5kaXNwYXRjaEV2ZW50KG5ldyBOayh0aGlzLmlhKSkpfTtULnByb3RvdHlwZS51c2VEZXZpY2VMYW5ndWFnZT1mdW5jdGlvbigpe3ZhciBhPWsubmF2aWdhdG9yO3RoaXMuQ2IoYT9hLmxhbmd1YWdlcyYmYS5sYW5ndWFnZXNbMF18fGEubGFuZ3VhZ2V8fGEudXNlckxhbmd1YWdlfHxudWxsOm51bGwpfTtcblQucHJvdG90eXBlLiRmPWZ1bmN0aW9uKGEpe3RoaXMuTS5wdXNoKGEpO2JoKHRoaXMuZixmaXJlYmFzZS5TREtfVkVSU0lPTj9KZihmaXJlYmFzZS5TREtfVkVSU0lPTix0aGlzLk0pOm51bGwpO3RoaXMuZGlzcGF0Y2hFdmVudChuZXcgT2sodGhpcy5NKSl9O3ZhciBNaz1mdW5jdGlvbihhKXtPYmplY3QuZGVmaW5lUHJvcGVydHkoYSxcImxjXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmlhfSxzZXQ6ZnVuY3Rpb24oYSl7dGhpcy5DYihhKX0sZW51bWVyYWJsZTohMX0pO2EuaWE9bnVsbH07VC5wcm90b3R5cGUudG9KU09OPWZ1bmN0aW9uKCl7cmV0dXJue2FwaUtleTp0aGlzLmkoKS5vcHRpb25zLmFwaUtleSxhdXRoRG9tYWluOnRoaXMuaSgpLm9wdGlvbnMuYXV0aERvbWFpbixhcHBOYW1lOnRoaXMuaSgpLm5hbWUsY3VycmVudFVzZXI6VSh0aGlzKSYmVSh0aGlzKS5BKCl9fTtcbnZhciBQaz1mdW5jdGlvbihhKXtyZXR1cm4gYS5BZnx8RShuZXcgTyhcImF1dGgtZG9tYWluLWNvbmZpZy1yZXF1aXJlZFwiKSl9LExrPWZ1bmN0aW9uKGEpe3ZhciBiPWEuaSgpLm9wdGlvbnMuYXV0aERvbWFpbixjPWEuaSgpLm9wdGlvbnMuYXBpS2V5O2ImJk5mKCkmJihhLkFmPWEub2MudGhlbihmdW5jdGlvbigpe2lmKCFhLkVhKXthLnY9RWooYixjLGEuaSgpLm5hbWUpO2Eudi5zdWJzY3JpYmUoYSk7VShhKSYmYmsoVShhKSk7aWYoYS5aYSl7YmsoYS5aYSk7dmFyIGQ9YS5aYTtkLkNiKGEuaWEpO1VqKGQsYSk7ZD1hLlphO1RqKGQsYS5NKTtWaihkLGEpO2EuWmE9bnVsbH1yZXR1cm4gYS52fX0pKX07aD1ULnByb3RvdHlwZTtoLmtlPWZ1bmN0aW9uKGEsYil7c3dpdGNoKGEpe2Nhc2UgXCJ1bmtub3duXCI6Y2FzZSBcInNpZ25JblZpYVJlZGlyZWN0XCI6cmV0dXJuITA7Y2FzZSBcInNpZ25JblZpYVBvcHVwXCI6cmV0dXJuIHRoaXMubGE9PWImJiEhdGhpcy5rYTtkZWZhdWx0OnJldHVybiExfX07XG5oLmJiPWZ1bmN0aW9uKGEsYixjLGQpe1wic2lnbkluVmlhUG9wdXBcIj09YSYmdGhpcy5sYT09ZCYmKGMmJnRoaXMuVmE/dGhpcy5WYShjKTpiJiYhYyYmdGhpcy5rYSYmdGhpcy5rYShiKSx0aGlzLksmJih0aGlzLksuY2FuY2VsKCksdGhpcy5LPW51bGwpLGRlbGV0ZSB0aGlzLmthLGRlbGV0ZSB0aGlzLlZhKX07aC5OYj1mdW5jdGlvbihhLGIpe3JldHVyblwic2lnbkluVmlhUmVkaXJlY3RcIj09YXx8XCJzaWduSW5WaWFQb3B1cFwiPT1hJiZ0aGlzLmxhPT1iJiZ0aGlzLmthP3IodGhpcy5DZix0aGlzKTpudWxsfTtcbmguQ2Y9ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzO2E9e3JlcXVlc3RVcmk6YSxzZXNzaW9uSWQ6Yn07dGhpcy5LJiYodGhpcy5LLmNhbmNlbCgpLHRoaXMuSz1udWxsKTt2YXIgZD1udWxsLGU9bnVsbCxmPXRnKGMuZixhKS50aGVuKGZ1bmN0aW9uKGEpe2Q9UmcoYSk7ZT1VaShhKTtyZXR1cm4gYX0pO2E9Yy5vYy50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGZ9KS50aGVuKGZ1bmN0aW9uKGEpe3JldHVybiBRayhjLGEpfSkudGhlbihmdW5jdGlvbigpe3JldHVybiBjZyh7dXNlcjpVKGMpLGNyZWRlbnRpYWw6ZCxhZGRpdGlvbmFsVXNlckluZm86ZSxvcGVyYXRpb25UeXBlOlwic2lnbkluXCJ9KX0pO3JldHVybiB0aGlzLmMoYSl9O2guc2M9ZnVuY3Rpb24oKXtyZXR1cm4gS2YoKX07XG5oLnNpZ25JbldpdGhQb3B1cD1mdW5jdGlvbihhKXtpZighTmYoKSlyZXR1cm4gRShuZXcgTyhcIm9wZXJhdGlvbi1ub3Qtc3VwcG9ydGVkLWluLXRoaXMtZW52aXJvbm1lbnRcIikpO3ZhciBiPXRoaXMsYz1qZyhhLnByb3ZpZGVySWQpLGQ9dGhpcy5zYygpLGU9bnVsbDsoIU9mKCl8fEZmKCkpJiZ0aGlzLmkoKS5vcHRpb25zLmF1dGhEb21haW4mJmEuaXNPQXV0aFByb3ZpZGVyJiYoZT1jaSh0aGlzLmkoKS5vcHRpb25zLmF1dGhEb21haW4sdGhpcy5pKCkub3B0aW9ucy5hcGlLZXksdGhpcy5pKCkubmFtZSxcInNpZ25JblZpYVBvcHVwXCIsYSxudWxsLGQsZmlyZWJhc2UuU0RLX1ZFUlNJT058fG51bGwpKTt2YXIgZj15ZihlLGMmJmMuWmIsYyYmYy5ZYik7Yz1Qayh0aGlzKS50aGVuKGZ1bmN0aW9uKGIpe3JldHVybiBiLiRiKGYsXCJzaWduSW5WaWFQb3B1cFwiLGEsZCwhIWUpfSkudGhlbihmdW5jdGlvbigpe3JldHVybiBuZXcgQyhmdW5jdGlvbihhLGMpe2IuYmIoXCJzaWduSW5WaWFQb3B1cFwiLFxubnVsbCxuZXcgTyhcImNhbmNlbGxlZC1wb3B1cC1yZXF1ZXN0XCIpLGIubGEpO2Iua2E9YTtiLlZhPWM7Yi5sYT1kO2IuSz1iLnYuZWMoYixcInNpZ25JblZpYVBvcHVwXCIsZixkKX0pfSkudGhlbihmdW5jdGlvbihhKXtmJiZ4ZihmKTtyZXR1cm4gYT9jZyhhKTpudWxsfSkuZyhmdW5jdGlvbihhKXtmJiZ4ZihmKTt0aHJvdyBhO30pO3JldHVybiB0aGlzLmMoYyl9O2guc2lnbkluV2l0aFJlZGlyZWN0PWZ1bmN0aW9uKGEpe2lmKCFOZigpKXJldHVybiBFKG5ldyBPKFwib3BlcmF0aW9uLW5vdC1zdXBwb3J0ZWQtaW4tdGhpcy1lbnZpcm9ubWVudFwiKSk7dmFyIGI9dGhpcyxjPVBrKHRoaXMpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gRWsoYi5uYSl9KS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGIudi5hYyhcInNpZ25JblZpYVJlZGlyZWN0XCIsYSl9KTtyZXR1cm4gdGhpcy5jKGMpfTtcbmguZ2V0UmVkaXJlY3RSZXN1bHQ9ZnVuY3Rpb24oKXtpZighTmYoKSlyZXR1cm4gRShuZXcgTyhcIm9wZXJhdGlvbi1ub3Qtc3VwcG9ydGVkLWluLXRoaXMtZW52aXJvbm1lbnRcIikpO3ZhciBhPXRoaXMsYj1Qayh0aGlzKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGEudi5nZXRSZWRpcmVjdFJlc3VsdCgpfSkudGhlbihmdW5jdGlvbihhKXtyZXR1cm4gYT9jZyhhKTpudWxsfSk7cmV0dXJuIHRoaXMuYyhiKX07XG52YXIgUWs9ZnVuY3Rpb24oYSxiKXt2YXIgYz17fTtjLmFwaUtleT1hLmkoKS5vcHRpb25zLmFwaUtleTtjLmF1dGhEb21haW49YS5pKCkub3B0aW9ucy5hdXRoRG9tYWluO2MuYXBwTmFtZT1hLmkoKS5uYW1lO3JldHVybiBhLm9jLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gd2soYyxiLGEuemIsJGEoYS5NKSl9KS50aGVuKGZ1bmN0aW9uKGIpe2lmKFUoYSkmJmIudWlkPT1VKGEpLnVpZClyZXR1cm4gVShhKS5jb3B5KGIpLGEucGIoYik7SWsoYSxiKTtiayhiKTtyZXR1cm4gYS5wYihiKX0pLnRoZW4oZnVuY3Rpb24oKXthLlRhKCl9KX0sSWs9ZnVuY3Rpb24oYSxiKXtVKGEpJiYoWmooVShhKSxhLmVmKSx0YyhVKGEpLFwidG9rZW5DaGFuZ2VkXCIsYS5HYiksdGMoVShhKSxcInVzZXJEZWxldGVkXCIsYS5jZiksdGMoVShhKSxcInVzZXJJbnZhbGlkYXRlZFwiLGEuZGYpLFlqKFUoYSkpKTtiJiYoYi5SYy5wdXNoKGEuZWYpLGxjKGIsXCJ0b2tlbkNoYW5nZWRcIixhLkdiKSxsYyhiLFwidXNlckRlbGV0ZWRcIixcbmEuY2YpLGxjKGIsXCJ1c2VySW52YWxpZGF0ZWRcIixhLmRmKSwwPGEuT2EmJlhqKGIpKTtOKGEsXCJjdXJyZW50VXNlclwiLGIpO2ImJihiLkNiKGEuaWEpLFVqKGIsYSksVGooYixhLk0pLFZqKGIsYSkpfTtULnByb3RvdHlwZS5zaWduT3V0PWZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPXRoaXMueWEudGhlbihmdW5jdGlvbigpe2lmKCFVKGEpKXJldHVybiBEKCk7SWsoYSxudWxsKTtyZXR1cm4gR2soYS5uYSkudGhlbihmdW5jdGlvbigpe2EuVGEoKX0pfSk7cmV0dXJuIHRoaXMuYyhiKX07XG52YXIgUms9ZnVuY3Rpb24oYSl7dmFyIGI9YS5pKCkub3B0aW9ucy5hdXRoRG9tYWluO2I9eWsoYS56YixiKS50aGVuKGZ1bmN0aW9uKGIpe2lmKGEuWmE9YiliLllhPWEuemI7cmV0dXJuIHRrKGEuemIpfSk7cmV0dXJuIGEuYyhiKX0sSms9ZnVuY3Rpb24oYSl7dmFyIGI9YS5pKCkub3B0aW9ucy5hdXRoRG9tYWluLGM9UmsoYSkudGhlbihmdW5jdGlvbigpe3JldHVybiBIayhhLm5hLGIpfSkudGhlbihmdW5jdGlvbihiKXtyZXR1cm4gYj8oYi5ZYT1hLnpiLGEuWmEmJihhLlphLkhhfHxudWxsKT09KGIuSGF8fG51bGwpP2I6Yi5yZWxvYWQoKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIEZrKGEubmEsYikudGhlbihmdW5jdGlvbigpe3JldHVybiBifSl9KS5nKGZ1bmN0aW9uKGMpe3JldHVyblwiYXV0aC9uZXR3b3JrLXJlcXVlc3QtZmFpbGVkXCI9PWMuY29kZT9iOkdrKGEubmEpfSkpOm51bGx9KS50aGVuKGZ1bmN0aW9uKGIpe0lrKGEsYnx8bnVsbCl9KTtyZXR1cm4gYS5jKGMpfSxLaz1cbmZ1bmN0aW9uKGEpe3JldHVybiBhLm9jLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gYS5nZXRSZWRpcmVjdFJlc3VsdCgpfSkuZyhmdW5jdGlvbigpe30pLnRoZW4oZnVuY3Rpb24oKXtpZighYS5FYSlyZXR1cm4gYS51ZCgpfSkuZyhmdW5jdGlvbigpe30pLnRoZW4oZnVuY3Rpb24oKXtpZighYS5FYSl7YS5DYz0hMDt2YXIgYj1hLm5hO2IuaC5hZGRMaXN0ZW5lcih6ayhcImxvY2FsXCIpLGIuaixhLnVkKX19KX07aD1ULnByb3RvdHlwZTtcbmgud2c9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9dGhpcy5pKCkub3B0aW9ucy5hdXRoRG9tYWluO3JldHVybiBIayh0aGlzLm5hLGIpLnRoZW4oZnVuY3Rpb24oYil7aWYoIWEuRWEpe3ZhciBjO2lmKGM9VShhKSYmYil7Yz1VKGEpLnVpZDt2YXIgZT1iLnVpZDtjPXZvaWQgMD09PWN8fG51bGw9PT1jfHxcIlwiPT09Y3x8dm9pZCAwPT09ZXx8bnVsbD09PWV8fFwiXCI9PT1lPyExOmM9PWV9aWYoYylyZXR1cm4gVShhKS5jb3B5KGIpLFUoYSkuZ2V0SWRUb2tlbigpO2lmKFUoYSl8fGIpSWsoYSxiKSxiJiYoYmsoYiksYi5ZYT1hLnpiKSxhLnYmJmEudi5zdWJzY3JpYmUoYSksYS5UYSgpfX0pfTtoLnBiPWZ1bmN0aW9uKGEpe3JldHVybiBGayh0aGlzLm5hLGEpfTtoLndkPWZ1bmN0aW9uKCl7dGhpcy5UYSgpO3RoaXMucGIoVSh0aGlzKSl9O2guT2Y9ZnVuY3Rpb24oKXt0aGlzLnNpZ25PdXQoKX07aC5QZj1mdW5jdGlvbigpe3RoaXMuc2lnbk91dCgpfTtcbnZhciBTaz1mdW5jdGlvbihhLGIpe3ZhciBjPW51bGwsZD1udWxsO3JldHVybiBhLmMoYi50aGVuKGZ1bmN0aW9uKGIpe2M9UmcoYik7ZD1VaShiKTtyZXR1cm4gUWsoYSxiKX0pLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gY2coe3VzZXI6VShhKSxjcmVkZW50aWFsOmMsYWRkaXRpb25hbFVzZXJJbmZvOmQsb3BlcmF0aW9uVHlwZTpcInNpZ25JblwifSl9KSl9O2g9VC5wcm90b3R5cGU7aC5TZj1mdW5jdGlvbihhKXt2YXIgYj10aGlzO3RoaXMuYWRkQXV0aFRva2VuTGlzdGVuZXIoZnVuY3Rpb24oKXthLm5leHQoVShiKSl9KX07aC5VZj1mdW5jdGlvbihhKXt2YXIgYj10aGlzO1RrKHRoaXMsZnVuY3Rpb24oKXthLm5leHQoVShiKSl9KX07XG5oLm9uSWRUb2tlbkNoYW5nZWQ9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXM7dGhpcy5DYyYmZmlyZWJhc2UuUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbigpe3AoYSk/YShVKGQpKTpwKGEubmV4dCkmJmEubmV4dChVKGQpKX0pO3JldHVybiB0aGlzLmNnKGEsYixjKX07aC5vbkF1dGhTdGF0ZUNoYW5nZWQ9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXM7dGhpcy5DYyYmZmlyZWJhc2UuUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbigpe2Qua2M9ZC5nZXRVaWQoKTtwKGEpP2EoVShkKSk6cChhLm5leHQpJiZhLm5leHQoVShkKSl9KTtyZXR1cm4gdGhpcy5lZyhhLGIsYyl9O2guSWY9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcyxjPXRoaXMueWEudGhlbihmdW5jdGlvbigpe3JldHVybiBVKGIpP1UoYikuZ2V0SWRUb2tlbihhKS50aGVuKGZ1bmN0aW9uKGEpe3JldHVybnthY2Nlc3NUb2tlbjphfX0pOm51bGx9KTtyZXR1cm4gdGhpcy5jKGMpfTtcbmguc2lnbkluV2l0aEN1c3RvbVRva2VuPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7cmV0dXJuIHRoaXMueWEudGhlbihmdW5jdGlvbigpe3JldHVybiBTayhiLFEoYi5mLE1oLHt0b2tlbjphfSkpfSkudGhlbihmdW5jdGlvbihhKXthPWEudXNlcjtoayhhLFwiaXNBbm9ueW1vdXNcIiwhMSk7cmV0dXJuIGIucGIoYSl9KS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIFUoYil9KX07aC5zaWduSW5XaXRoRW1haWxBbmRQYXNzd29yZD1mdW5jdGlvbihhLGIpe3ZhciBjPXRoaXM7cmV0dXJuIHRoaXMueWEudGhlbihmdW5jdGlvbigpe3JldHVybiBTayhjLFEoYy5mLEhnLHtlbWFpbDphLHBhc3N3b3JkOmJ9KSl9KS50aGVuKGZ1bmN0aW9uKGEpe3JldHVybiBhLnVzZXJ9KX07aC5jcmVhdGVVc2VyV2l0aEVtYWlsQW5kUGFzc3dvcmQ9ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzO3JldHVybiB0aGlzLnlhLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gU2soYyxRKGMuZixJaCx7ZW1haWw6YSxwYXNzd29yZDpifSkpfSkudGhlbihmdW5jdGlvbihhKXtyZXR1cm4gYS51c2VyfSl9O1xuaC5zaWduSW5XaXRoQ3JlZGVudGlhbD1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5zaWduSW5BbmRSZXRyaWV2ZURhdGFXaXRoQ3JlZGVudGlhbChhKS50aGVuKGZ1bmN0aW9uKGEpe3JldHVybiBhLnVzZXJ9KX07aC5zaWduSW5BbmRSZXRyaWV2ZURhdGFXaXRoQ3JlZGVudGlhbD1mdW5jdGlvbihhKXt2YXIgYj10aGlzO3JldHVybiB0aGlzLnlhLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gU2soYixhLk9iKGIuZikpfSl9O2guc2lnbkluQW5vbnltb3VzbHk9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO3JldHVybiB0aGlzLnlhLnRoZW4oZnVuY3Rpb24oKXt2YXIgYj1VKGEpO3JldHVybiBiJiZiLmlzQW5vbnltb3VzP2I6U2soYSxhLmYuc2lnbkluQW5vbnltb3VzbHkoKSkudGhlbihmdW5jdGlvbihiKXtiPWIudXNlcjtoayhiLFwiaXNBbm9ueW1vdXNcIiwhMCk7cmV0dXJuIGEucGIoYil9KS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIFUoYSl9KX0pfTtoLmk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hcHB9O1xudmFyIFU9ZnVuY3Rpb24oYSl7cmV0dXJuIGEuY3VycmVudFVzZXJ9O1QucHJvdG90eXBlLmdldFVpZD1mdW5jdGlvbigpe3JldHVybiBVKHRoaXMpJiZVKHRoaXMpLnVpZHx8bnVsbH07dmFyIFVrPWZ1bmN0aW9uKGEpe3JldHVybiBVKGEpJiZVKGEpLl9sYXR8fG51bGx9O2g9VC5wcm90b3R5cGU7aC5UYT1mdW5jdGlvbigpe2lmKHRoaXMuQ2Mpe2Zvcih2YXIgYT0wO2E8dGhpcy5LYS5sZW5ndGg7YSsrKWlmKHRoaXMuS2FbYV0pdGhpcy5LYVthXShVayh0aGlzKSk7aWYodGhpcy5rYyE9PXRoaXMuZ2V0VWlkKCkmJnRoaXMuRmIubGVuZ3RoKWZvcih0aGlzLmtjPXRoaXMuZ2V0VWlkKCksYT0wO2E8dGhpcy5GYi5sZW5ndGg7YSsrKWlmKHRoaXMuRmJbYV0pdGhpcy5GYlthXShVayh0aGlzKSl9fTtoLnBmPWZ1bmN0aW9uKGEpe3RoaXMuYWRkQXV0aFRva2VuTGlzdGVuZXIoYSk7dGhpcy5PYSsrOzA8dGhpcy5PYSYmVSh0aGlzKSYmWGooVSh0aGlzKSl9O1xuaC5qZz1mdW5jdGlvbihhKXt2YXIgYj10aGlzO3godGhpcy5LYSxmdW5jdGlvbihjKXtjPT1hJiZiLk9hLS19KTswPnRoaXMuT2EmJih0aGlzLk9hPTApOzA9PXRoaXMuT2EmJlUodGhpcykmJllqKFUodGhpcykpO3RoaXMucmVtb3ZlQXV0aFRva2VuTGlzdGVuZXIoYSl9O2guYWRkQXV0aFRva2VuTGlzdGVuZXI9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpczt0aGlzLkthLnB1c2goYSk7dGhpcy5jKHRoaXMueWEudGhlbihmdW5jdGlvbigpe2IuRWF8fFZhKGIuS2EsYSkmJmEoVWsoYikpfSkpfTtoLnJlbW92ZUF1dGhUb2tlbkxpc3RlbmVyPWZ1bmN0aW9uKGEpe1lhKHRoaXMuS2EsZnVuY3Rpb24oYil7cmV0dXJuIGI9PWF9KX07dmFyIFRrPWZ1bmN0aW9uKGEsYil7YS5GYi5wdXNoKGIpO2EuYyhhLnlhLnRoZW4oZnVuY3Rpb24oKXshYS5FYSYmVmEoYS5GYixiKSYmYS5rYyE9PWEuZ2V0VWlkKCkmJihhLmtjPWEuZ2V0VWlkKCksYihVayhhKSkpfSkpfTtoPVQucHJvdG90eXBlO1xuaFtcImRlbGV0ZVwiXT1mdW5jdGlvbigpe3RoaXMuRWE9ITA7Zm9yKHZhciBhPTA7YTx0aGlzLkoubGVuZ3RoO2ErKyl0aGlzLkpbYV0uY2FuY2VsKFwiYXBwLWRlbGV0ZWRcIik7dGhpcy5KPVtdO3RoaXMubmEmJihhPXRoaXMubmEsYS5oLnJlbW92ZUxpc3RlbmVyKHprKFwibG9jYWxcIiksYS5qLHRoaXMudWQpKTt0aGlzLnYmJnRoaXMudi51bnN1YnNjcmliZSh0aGlzKTtyZXR1cm4gZmlyZWJhc2UuUHJvbWlzZS5yZXNvbHZlKCl9O2guYz1mdW5jdGlvbihhKXt2YXIgYj10aGlzO3RoaXMuSi5wdXNoKGEpO0VkKGEsZnVuY3Rpb24oKXtYYShiLkosYSl9KTtyZXR1cm4gYX07aC5mZXRjaFByb3ZpZGVyc0ZvckVtYWlsPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmMobWgodGhpcy5mLGEpKX07aC52ZXJpZnlQYXNzd29yZFJlc2V0Q29kZT1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jaGVja0FjdGlvbkNvZGUoYSkudGhlbihmdW5jdGlvbihhKXtyZXR1cm4gYS5kYXRhLmVtYWlsfSl9O1xuaC5jb25maXJtUGFzc3dvcmRSZXNldD1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmModGhpcy5mLmNvbmZpcm1QYXNzd29yZFJlc2V0KGEsYikudGhlbihmdW5jdGlvbigpe30pKX07aC5jaGVja0FjdGlvbkNvZGU9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuYyh0aGlzLmYuY2hlY2tBY3Rpb25Db2RlKGEpLnRoZW4oZnVuY3Rpb24oYSl7cmV0dXJuIG5ldyBLaShhKX0pKX07aC5hcHBseUFjdGlvbkNvZGU9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuYyh0aGlzLmYuYXBwbHlBY3Rpb25Db2RlKGEpLnRoZW4oZnVuY3Rpb24oKXt9KSl9O2guc2VuZFBhc3N3b3JkUmVzZXRFbWFpbD1mdW5jdGlvbihhLGIpe3ZhciBjPXRoaXM7cmV0dXJuIHRoaXMuYyhEKCkudGhlbihmdW5jdGlvbigpe3JldHVyblwidW5kZWZpbmVkXCI9PT10eXBlb2YgYnx8aWIoYik/e306SGkobmV3IEdpKGIpKX0pLnRoZW4oZnVuY3Rpb24oYil7cmV0dXJuIGMuZi5zZW5kUGFzc3dvcmRSZXNldEVtYWlsKGEsYil9KS50aGVuKGZ1bmN0aW9uKCl7fSkpfTtcbmguc2lnbkluV2l0aFBob25lTnVtYmVyPWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuYyhKaSh0aGlzLGEsYixyKHRoaXMuc2lnbkluQW5kUmV0cmlldmVEYXRhV2l0aENyZWRlbnRpYWwsdGhpcykpKX07dmFyIFdrPWZ1bmN0aW9uKGEsYixjLGQpe2E6e2M9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYyk7dmFyIGU9MDtmb3IodmFyIGY9ITEsZz0wO2c8Yi5sZW5ndGg7ZysrKWlmKGJbZ10ub3B0aW9uYWwpZj0hMDtlbHNle2lmKGYpdGhyb3cgbmV3IE8oXCJpbnRlcm5hbC1lcnJvclwiLFwiQXJndW1lbnQgdmFsaWRhdG9yIGVuY291bnRlcmVkIGEgcmVxdWlyZWQgYXJndW1lbnQgYWZ0ZXIgYW4gb3B0aW9uYWwgYXJndW1lbnQuXCIpO2UrK31mPWIubGVuZ3RoO2lmKGMubGVuZ3RoPGV8fGY8Yy5sZW5ndGgpZD1cIkV4cGVjdGVkIFwiKyhlPT1mPzE9PWU/XCIxIGFyZ3VtZW50XCI6ZStcIiBhcmd1bWVudHNcIjplK1wiLVwiK2YrXCIgYXJndW1lbnRzXCIpK1wiIGJ1dCBnb3QgXCIrYy5sZW5ndGgrXCIuXCI7ZWxzZXtmb3IoZT0wO2U8Yy5sZW5ndGg7ZSsrKWlmKGY9YltlXS5vcHRpb25hbCYmdm9pZCAwPT09Y1tlXSwhYltlXS5XKGNbZV0pJiYhZil7Yj1iW2VdO2lmKDA+ZXx8ZT49VmsubGVuZ3RoKXRocm93IG5ldyBPKFwiaW50ZXJuYWwtZXJyb3JcIixcblwiQXJndW1lbnQgdmFsaWRhdG9yIHJlY2VpdmVkIGFuIHVuc3VwcG9ydGVkIG51bWJlciBvZiBhcmd1bWVudHMuXCIpO2M9VmtbZV07ZD0oZD9cIlwiOmMrXCIgYXJndW1lbnQgXCIpKyhiLm5hbWU/J1wiJytiLm5hbWUrJ1wiICc6XCJcIikrXCJtdXN0IGJlIFwiK2IuVitcIi5cIjticmVhayBhfWQ9bnVsbH19aWYoZCl0aHJvdyBuZXcgTyhcImFyZ3VtZW50LWVycm9yXCIsYStcIiBmYWlsZWQ6IFwiK2QpO30sVms9XCJGaXJzdCBTZWNvbmQgVGhpcmQgRm91cnRoIEZpZnRoIFNpeHRoIFNldmVudGggRWlnaHRoIE5pbnRoXCIuc3BsaXQoXCIgXCIpLFY9ZnVuY3Rpb24oYSxiKXtyZXR1cm57bmFtZTphfHxcIlwiLFY6XCJhIHZhbGlkIHN0cmluZ1wiLG9wdGlvbmFsOiEhYixXOm19fSxYaz1mdW5jdGlvbigpe3JldHVybntuYW1lOlwib3B0X2ZvcmNlUmVmcmVzaFwiLFY6XCJhIGJvb2xlYW5cIixvcHRpb25hbDohMCxXOmNhfX0sVz1mdW5jdGlvbihhLGIpe3JldHVybntuYW1lOmF8fFwiXCIsVjpcImEgdmFsaWQgb2JqZWN0XCIsb3B0aW9uYWw6ISFiLFxuVzpxfX0sWWs9ZnVuY3Rpb24oYSxiKXtyZXR1cm57bmFtZTphfHxcIlwiLFY6XCJhIGZ1bmN0aW9uXCIsb3B0aW9uYWw6ISFiLFc6cH19LFprPWZ1bmN0aW9uKGEsYil7cmV0dXJue25hbWU6YXx8XCJcIixWOlwibnVsbFwiLG9wdGlvbmFsOiEhYixXOmZhfX0sJGs9ZnVuY3Rpb24oKXtyZXR1cm57bmFtZTpcIlwiLFY6XCJhbiBIVE1MIGVsZW1lbnRcIixvcHRpb25hbDohMSxXOmZ1bmN0aW9uKGEpe3JldHVybiEhKGEmJmEgaW5zdGFuY2VvZiBFbGVtZW50KX19fSxhbD1mdW5jdGlvbigpe3JldHVybntuYW1lOlwiYXV0aFwiLFY6XCJhbiBpbnN0YW5jZSBvZiBGaXJlYmFzZSBBdXRoXCIsb3B0aW9uYWw6ITAsVzpmdW5jdGlvbihhKXtyZXR1cm4hIShhJiZhIGluc3RhbmNlb2YgVCl9fX0sYmw9ZnVuY3Rpb24oKXtyZXR1cm57bmFtZTpcImFwcFwiLFY6XCJhbiBpbnN0YW5jZSBvZiBGaXJlYmFzZSBBcHBcIixvcHRpb25hbDohMCxXOmZ1bmN0aW9uKGEpe3JldHVybiEhKGEmJmEgaW5zdGFuY2VvZiBmaXJlYmFzZS5hcHAuQXBwKX19fSxcbmNsPWZ1bmN0aW9uKGEpe3JldHVybntuYW1lOmE/YStcIkNyZWRlbnRpYWxcIjpcImNyZWRlbnRpYWxcIixWOmE/XCJhIHZhbGlkIFwiK2ErXCIgY3JlZGVudGlhbFwiOlwiYSB2YWxpZCBjcmVkZW50aWFsXCIsb3B0aW9uYWw6ITEsVzpmdW5jdGlvbihiKXtpZighYilyZXR1cm4hMTt2YXIgYz0hYXx8Yi5wcm92aWRlcklkPT09YTtyZXR1cm4hKCFiLk9ifHwhYyl9fX0sZGw9ZnVuY3Rpb24oKXtyZXR1cm57bmFtZTpcImF1dGhQcm92aWRlclwiLFY6XCJhIHZhbGlkIEF1dGggcHJvdmlkZXJcIixvcHRpb25hbDohMSxXOmZ1bmN0aW9uKGEpe3JldHVybiEhKGEmJmEucHJvdmlkZXJJZCYmYS5oYXNPd25Qcm9wZXJ0eSYmYS5oYXNPd25Qcm9wZXJ0eShcImlzT0F1dGhQcm92aWRlclwiKSl9fX0sZWw9ZnVuY3Rpb24oKXtyZXR1cm57bmFtZTpcImFwcGxpY2F0aW9uVmVyaWZpZXJcIixWOlwiYW4gaW1wbGVtZW50YXRpb24gb2YgZmlyZWJhc2UuYXV0aC5BcHBsaWNhdGlvblZlcmlmaWVyXCIsb3B0aW9uYWw6ITEsVzpmdW5jdGlvbihhKXtyZXR1cm4hIShhJiZcbm0oYS50eXBlKSYmcChhLnZlcmlmeSkpfX19LFg9ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJue25hbWU6Y3x8XCJcIixWOmEuVitcIiBvciBcIitiLlYsb3B0aW9uYWw6ISFkLFc6ZnVuY3Rpb24oYyl7cmV0dXJuIGEuVyhjKXx8Yi5XKGMpfX19O3ZhciBZPWZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjIGluIGIpe3ZhciBkPWJbY10ubmFtZTthW2RdPWZsKGQsYVtjXSxiW2NdLmEpfX0sWj1mdW5jdGlvbihhLGIsYyxkKXthW2JdPWZsKGIsYyxkKX0sZmw9ZnVuY3Rpb24oYSxiLGMpe2lmKCFjKXJldHVybiBiO3ZhciBkPWdsKGEpO2E9ZnVuY3Rpb24oKXt2YXIgYT1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpO1drKGQsYyxhKTtyZXR1cm4gYi5hcHBseSh0aGlzLGEpfTtmb3IodmFyIGUgaW4gYilhW2VdPWJbZV07Zm9yKGUgaW4gYi5wcm90b3R5cGUpYS5wcm90b3R5cGVbZV09Yi5wcm90b3R5cGVbZV07cmV0dXJuIGF9LGdsPWZ1bmN0aW9uKGEpe2E9YS5zcGxpdChcIi5cIik7cmV0dXJuIGFbYS5sZW5ndGgtMV19O1koVC5wcm90b3R5cGUse2FwcGx5QWN0aW9uQ29kZTp7bmFtZTpcImFwcGx5QWN0aW9uQ29kZVwiLGE6W1YoXCJjb2RlXCIpXX0sY2hlY2tBY3Rpb25Db2RlOntuYW1lOlwiY2hlY2tBY3Rpb25Db2RlXCIsYTpbVihcImNvZGVcIildfSxjb25maXJtUGFzc3dvcmRSZXNldDp7bmFtZTpcImNvbmZpcm1QYXNzd29yZFJlc2V0XCIsYTpbVihcImNvZGVcIiksVihcIm5ld1Bhc3N3b3JkXCIpXX0sY3JlYXRlVXNlcldpdGhFbWFpbEFuZFBhc3N3b3JkOntuYW1lOlwiY3JlYXRlVXNlcldpdGhFbWFpbEFuZFBhc3N3b3JkXCIsYTpbVihcImVtYWlsXCIpLFYoXCJwYXNzd29yZFwiKV19LGZldGNoUHJvdmlkZXJzRm9yRW1haWw6e25hbWU6XCJmZXRjaFByb3ZpZGVyc0ZvckVtYWlsXCIsYTpbVihcImVtYWlsXCIpXX0sZ2V0UmVkaXJlY3RSZXN1bHQ6e25hbWU6XCJnZXRSZWRpcmVjdFJlc3VsdFwiLGE6W119LG9uQXV0aFN0YXRlQ2hhbmdlZDp7bmFtZTpcIm9uQXV0aFN0YXRlQ2hhbmdlZFwiLGE6W1goVygpLFlrKCksXCJuZXh0T3JPYnNlcnZlclwiKSxcbllrKFwib3B0X2Vycm9yXCIsITApLFlrKFwib3B0X2NvbXBsZXRlZFwiLCEwKV19LG9uSWRUb2tlbkNoYW5nZWQ6e25hbWU6XCJvbklkVG9rZW5DaGFuZ2VkXCIsYTpbWChXKCksWWsoKSxcIm5leHRPck9ic2VydmVyXCIpLFlrKFwib3B0X2Vycm9yXCIsITApLFlrKFwib3B0X2NvbXBsZXRlZFwiLCEwKV19LHNlbmRQYXNzd29yZFJlc2V0RW1haWw6e25hbWU6XCJzZW5kUGFzc3dvcmRSZXNldEVtYWlsXCIsYTpbVihcImVtYWlsXCIpLFgoVyhcIm9wdF9hY3Rpb25Db2RlU2V0dGluZ3NcIiwhMCksWmsobnVsbCwhMCksXCJvcHRfYWN0aW9uQ29kZVNldHRpbmdzXCIsITApXX0sc2V0UGVyc2lzdGVuY2U6e25hbWU6XCJzZXRQZXJzaXN0ZW5jZVwiLGE6W1YoXCJwZXJzaXN0ZW5jZVwiKV19LHNpZ25JbkFuZFJldHJpZXZlRGF0YVdpdGhDcmVkZW50aWFsOntuYW1lOlwic2lnbkluQW5kUmV0cmlldmVEYXRhV2l0aENyZWRlbnRpYWxcIixhOltjbCgpXX0sc2lnbkluQW5vbnltb3VzbHk6e25hbWU6XCJzaWduSW5Bbm9ueW1vdXNseVwiLGE6W119LFxuc2lnbkluV2l0aENyZWRlbnRpYWw6e25hbWU6XCJzaWduSW5XaXRoQ3JlZGVudGlhbFwiLGE6W2NsKCldfSxzaWduSW5XaXRoQ3VzdG9tVG9rZW46e25hbWU6XCJzaWduSW5XaXRoQ3VzdG9tVG9rZW5cIixhOltWKFwidG9rZW5cIildfSxzaWduSW5XaXRoRW1haWxBbmRQYXNzd29yZDp7bmFtZTpcInNpZ25JbldpdGhFbWFpbEFuZFBhc3N3b3JkXCIsYTpbVihcImVtYWlsXCIpLFYoXCJwYXNzd29yZFwiKV19LHNpZ25JbldpdGhQaG9uZU51bWJlcjp7bmFtZTpcInNpZ25JbldpdGhQaG9uZU51bWJlclwiLGE6W1YoXCJwaG9uZU51bWJlclwiKSxlbCgpXX0sc2lnbkluV2l0aFBvcHVwOntuYW1lOlwic2lnbkluV2l0aFBvcHVwXCIsYTpbZGwoKV19LHNpZ25JbldpdGhSZWRpcmVjdDp7bmFtZTpcInNpZ25JbldpdGhSZWRpcmVjdFwiLGE6W2RsKCldfSxzaWduT3V0OntuYW1lOlwic2lnbk91dFwiLGE6W119LHRvSlNPTjp7bmFtZTpcInRvSlNPTlwiLGE6W1YobnVsbCwhMCldfSx1c2VEZXZpY2VMYW5ndWFnZTp7bmFtZTpcInVzZURldmljZUxhbmd1YWdlXCIsXG5hOltdfSx2ZXJpZnlQYXNzd29yZFJlc2V0Q29kZTp7bmFtZTpcInZlcmlmeVBhc3N3b3JkUmVzZXRDb2RlXCIsYTpbVihcImNvZGVcIildfX0pOyhmdW5jdGlvbihhLGIpe2Zvcih2YXIgYyBpbiBiKXt2YXIgZD1iW2NdLm5hbWU7aWYoZCE9PWMpe3ZhciBlPWJbY10ucmY7T2JqZWN0LmRlZmluZVByb3BlcnR5KGEsZCx7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXNbY119LHNldDpmdW5jdGlvbihhKXtXayhkLFtlXSxbYV0sITApO3RoaXNbY109YX0sZW51bWVyYWJsZTohMH0pfX19KShULnByb3RvdHlwZSx7bGM6e25hbWU6XCJsYW5ndWFnZUNvZGVcIixyZjpYKFYoKSxaaygpLFwibGFuZ3VhZ2VDb2RlXCIpfX0pO1QuUGVyc2lzdGVuY2U9Vmk7VC5QZXJzaXN0ZW5jZS5MT0NBTD1cImxvY2FsXCI7VC5QZXJzaXN0ZW5jZS5TRVNTSU9OPVwic2Vzc2lvblwiO1QuUGVyc2lzdGVuY2UuTk9ORT1cIm5vbmVcIjtcblkoUy5wcm90b3R5cGUse1wiZGVsZXRlXCI6e25hbWU6XCJkZWxldGVcIixhOltdfSxnZXRJZFRva2VuOntuYW1lOlwiZ2V0SWRUb2tlblwiLGE6W1hrKCldfSxnZXRUb2tlbjp7bmFtZTpcImdldFRva2VuXCIsYTpbWGsoKV19LGxpbmtBbmRSZXRyaWV2ZURhdGFXaXRoQ3JlZGVudGlhbDp7bmFtZTpcImxpbmtBbmRSZXRyaWV2ZURhdGFXaXRoQ3JlZGVudGlhbFwiLGE6W2NsKCldfSxsaW5rV2l0aENyZWRlbnRpYWw6e25hbWU6XCJsaW5rV2l0aENyZWRlbnRpYWxcIixhOltjbCgpXX0sbGlua1dpdGhQaG9uZU51bWJlcjp7bmFtZTpcImxpbmtXaXRoUGhvbmVOdW1iZXJcIixhOltWKFwicGhvbmVOdW1iZXJcIiksZWwoKV19LGxpbmtXaXRoUG9wdXA6e25hbWU6XCJsaW5rV2l0aFBvcHVwXCIsYTpbZGwoKV19LGxpbmtXaXRoUmVkaXJlY3Q6e25hbWU6XCJsaW5rV2l0aFJlZGlyZWN0XCIsYTpbZGwoKV19LHJlYXV0aGVudGljYXRlQW5kUmV0cmlldmVEYXRhV2l0aENyZWRlbnRpYWw6e25hbWU6XCJyZWF1dGhlbnRpY2F0ZUFuZFJldHJpZXZlRGF0YVdpdGhDcmVkZW50aWFsXCIsXG5hOltjbCgpXX0scmVhdXRoZW50aWNhdGVXaXRoQ3JlZGVudGlhbDp7bmFtZTpcInJlYXV0aGVudGljYXRlV2l0aENyZWRlbnRpYWxcIixhOltjbCgpXX0scmVhdXRoZW50aWNhdGVXaXRoUGhvbmVOdW1iZXI6e25hbWU6XCJyZWF1dGhlbnRpY2F0ZVdpdGhQaG9uZU51bWJlclwiLGE6W1YoXCJwaG9uZU51bWJlclwiKSxlbCgpXX0scmVhdXRoZW50aWNhdGVXaXRoUG9wdXA6e25hbWU6XCJyZWF1dGhlbnRpY2F0ZVdpdGhQb3B1cFwiLGE6W2RsKCldfSxyZWF1dGhlbnRpY2F0ZVdpdGhSZWRpcmVjdDp7bmFtZTpcInJlYXV0aGVudGljYXRlV2l0aFJlZGlyZWN0XCIsYTpbZGwoKV19LHJlbG9hZDp7bmFtZTpcInJlbG9hZFwiLGE6W119LHNlbmRFbWFpbFZlcmlmaWNhdGlvbjp7bmFtZTpcInNlbmRFbWFpbFZlcmlmaWNhdGlvblwiLGE6W1goVyhcIm9wdF9hY3Rpb25Db2RlU2V0dGluZ3NcIiwhMCksWmsobnVsbCwhMCksXCJvcHRfYWN0aW9uQ29kZVNldHRpbmdzXCIsITApXX0sdG9KU09OOntuYW1lOlwidG9KU09OXCIsYTpbVihudWxsLFxuITApXX0sdW5saW5rOntuYW1lOlwidW5saW5rXCIsYTpbVihcInByb3ZpZGVyXCIpXX0sdXBkYXRlRW1haWw6e25hbWU6XCJ1cGRhdGVFbWFpbFwiLGE6W1YoXCJlbWFpbFwiKV19LHVwZGF0ZVBhc3N3b3JkOntuYW1lOlwidXBkYXRlUGFzc3dvcmRcIixhOltWKFwicGFzc3dvcmRcIildfSx1cGRhdGVQaG9uZU51bWJlcjp7bmFtZTpcInVwZGF0ZVBob25lTnVtYmVyXCIsYTpbY2woXCJwaG9uZVwiKV19LHVwZGF0ZVByb2ZpbGU6e25hbWU6XCJ1cGRhdGVQcm9maWxlXCIsYTpbVyhcInByb2ZpbGVcIildfX0pO1koQy5wcm90b3R5cGUse2c6e25hbWU6XCJjYXRjaFwifSx0aGVuOntuYW1lOlwidGhlblwifX0pO1koSWkucHJvdG90eXBlLHtjb25maXJtOntuYW1lOlwiY29uZmlybVwiLGE6W1YoXCJ2ZXJpZmljYXRpb25Db2RlXCIpXX19KTtaKEpnLFwiY3JlZGVudGlhbFwiLGZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBHZyhhLGIpfSxbVihcImVtYWlsXCIpLFYoXCJwYXNzd29yZFwiKV0pO1xuWSh5Zy5wcm90b3R5cGUse2FkZFNjb3BlOntuYW1lOlwiYWRkU2NvcGVcIixhOltWKFwic2NvcGVcIildfSxzZXRDdXN0b21QYXJhbWV0ZXJzOntuYW1lOlwic2V0Q3VzdG9tUGFyYW1ldGVyc1wiLGE6W1coXCJjdXN0b21PQXV0aFBhcmFtZXRlcnNcIildfX0pO1ooeWcsXCJjcmVkZW50aWFsXCIsemcsW1goVigpLFcoKSxcInRva2VuXCIpXSk7WShBZy5wcm90b3R5cGUse2FkZFNjb3BlOntuYW1lOlwiYWRkU2NvcGVcIixhOltWKFwic2NvcGVcIildfSxzZXRDdXN0b21QYXJhbWV0ZXJzOntuYW1lOlwic2V0Q3VzdG9tUGFyYW1ldGVyc1wiLGE6W1coXCJjdXN0b21PQXV0aFBhcmFtZXRlcnNcIildfX0pO1ooQWcsXCJjcmVkZW50aWFsXCIsQmcsW1goVigpLFcoKSxcInRva2VuXCIpXSk7WShDZy5wcm90b3R5cGUse2FkZFNjb3BlOntuYW1lOlwiYWRkU2NvcGVcIixhOltWKFwic2NvcGVcIildfSxzZXRDdXN0b21QYXJhbWV0ZXJzOntuYW1lOlwic2V0Q3VzdG9tUGFyYW1ldGVyc1wiLGE6W1coXCJjdXN0b21PQXV0aFBhcmFtZXRlcnNcIildfX0pO1xuWihDZyxcImNyZWRlbnRpYWxcIixEZyxbWChWKCksWChXKCksWmsoKSksXCJpZFRva2VuXCIpLFgoVigpLFprKCksXCJhY2Nlc3NUb2tlblwiLCEwKV0pO1koRWcucHJvdG90eXBlLHtzZXRDdXN0b21QYXJhbWV0ZXJzOntuYW1lOlwic2V0Q3VzdG9tUGFyYW1ldGVyc1wiLGE6W1coXCJjdXN0b21PQXV0aFBhcmFtZXRlcnNcIildfX0pO1ooRWcsXCJjcmVkZW50aWFsXCIsRmcsW1goVigpLFcoKSxcInRva2VuXCIpLFYoXCJzZWNyZXRcIiwhMCldKTtZKFAucHJvdG90eXBlLHthZGRTY29wZTp7bmFtZTpcImFkZFNjb3BlXCIsYTpbVihcInNjb3BlXCIpXX0sY3JlZGVudGlhbDp7bmFtZTpcImNyZWRlbnRpYWxcIixhOltYKFYoKSxaaygpLFwiaWRUb2tlblwiLCEwKSxYKFYoKSxaaygpLFwiYWNjZXNzVG9rZW5cIiwhMCldfSxzZXRDdXN0b21QYXJhbWV0ZXJzOntuYW1lOlwic2V0Q3VzdG9tUGFyYW1ldGVyc1wiLGE6W1coXCJjdXN0b21PQXV0aFBhcmFtZXRlcnNcIildfX0pO1xuWihPZyxcImNyZWRlbnRpYWxcIixRZyxbVihcInZlcmlmaWNhdGlvbklkXCIpLFYoXCJ2ZXJpZmljYXRpb25Db2RlXCIpXSk7WShPZy5wcm90b3R5cGUse3ZlcmlmeVBob25lTnVtYmVyOntuYW1lOlwidmVyaWZ5UGhvbmVOdW1iZXJcIixhOltWKFwicGhvbmVOdW1iZXJcIiksZWwoKV19fSk7WShPLnByb3RvdHlwZSx7dG9KU09OOntuYW1lOlwidG9KU09OXCIsYTpbVihudWxsLCEwKV19fSk7WShUZy5wcm90b3R5cGUse3RvSlNPTjp7bmFtZTpcInRvSlNPTlwiLGE6W1YobnVsbCwhMCldfX0pO1kob2cucHJvdG90eXBlLHt0b0pTT046e25hbWU6XCJ0b0pTT05cIixhOltWKG51bGwsITApXX19KTtZKGxpLnByb3RvdHlwZSx7Y2xlYXI6e25hbWU6XCJjbGVhclwiLGE6W119LHJlbmRlcjp7bmFtZTpcInJlbmRlclwiLGE6W119LHZlcmlmeTp7bmFtZTpcInZlcmlmeVwiLGE6W119fSk7XG4oZnVuY3Rpb24oKXtpZihcInVuZGVmaW5lZFwiIT09dHlwZW9mIGZpcmViYXNlJiZmaXJlYmFzZS5JTlRFUk5BTCYmZmlyZWJhc2UuSU5URVJOQUwucmVnaXN0ZXJTZXJ2aWNlKXt2YXIgYT17QXV0aDpULEVycm9yOk99O1ooYSxcIkVtYWlsQXV0aFByb3ZpZGVyXCIsSmcsW10pO1ooYSxcIkZhY2Vib29rQXV0aFByb3ZpZGVyXCIseWcsW10pO1ooYSxcIkdpdGh1YkF1dGhQcm92aWRlclwiLEFnLFtdKTtaKGEsXCJHb29nbGVBdXRoUHJvdmlkZXJcIixDZyxbXSk7WihhLFwiVHdpdHRlckF1dGhQcm92aWRlclwiLEVnLFtdKTtaKGEsXCJPQXV0aFByb3ZpZGVyXCIsUCxbVihcInByb3ZpZGVySWRcIildKTtaKGEsXCJQaG9uZUF1dGhQcm92aWRlclwiLE9nLFthbCgpXSk7WihhLFwiUmVjYXB0Y2hhVmVyaWZpZXJcIixsaSxbWChWKCksJGsoKSxcInJlY2FwdGNoYUNvbnRhaW5lclwiKSxXKFwicmVjYXB0Y2hhUGFyYW1ldGVyc1wiLCEwKSxibCgpXSk7ZmlyZWJhc2UuSU5URVJOQUwucmVnaXN0ZXJTZXJ2aWNlKFwiYXV0aFwiLGZ1bmN0aW9uKGEsXG5jKXthPW5ldyBUKGEpO2Moe0lOVEVSTkFMOntnZXRVaWQ6cihhLmdldFVpZCxhKSxnZXRUb2tlbjpyKGEuSWYsYSksYWRkQXV0aFRva2VuTGlzdGVuZXI6cihhLnBmLGEpLHJlbW92ZUF1dGhUb2tlbkxpc3RlbmVyOnIoYS5qZyxhKX19KTtyZXR1cm4gYX0sYSxmdW5jdGlvbihhLGMpe2lmKFwiY3JlYXRlXCI9PT1hKXRyeXtjLmF1dGgoKX1jYXRjaChkKXt9fSk7ZmlyZWJhc2UuSU5URVJOQUwuZXh0ZW5kTmFtZXNwYWNlKHtVc2VyOlN9KX1lbHNlIHRocm93IEVycm9yKFwiQ2Fubm90IGZpbmQgdGhlIGZpcmViYXNlIG5hbWVzcGFjZTsgYmUgc3VyZSB0byBpbmNsdWRlIGZpcmViYXNlLWFwcC5qcyBiZWZvcmUgdGhpcyBsaWJyYXJ5LlwiKTt9KSgpO30pLmNhbGwodGhpcyk7XG59KS5jYWxsKHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gd2luZG93IDoge30pOyIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBhcHBfMSA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvYXBwXCIpO1xudmFyIERhdGFiYXNlXzEgPSByZXF1aXJlKFwiLi9zcmMvYXBpL0RhdGFiYXNlXCIpO1xudmFyIFF1ZXJ5XzEgPSByZXF1aXJlKFwiLi9zcmMvYXBpL1F1ZXJ5XCIpO1xudmFyIFJlZmVyZW5jZV8xID0gcmVxdWlyZShcIi4vc3JjL2FwaS9SZWZlcmVuY2VcIik7XG52YXIgdXRpbF8xID0gcmVxdWlyZShcIi4vc3JjL2NvcmUvdXRpbC91dGlsXCIpO1xudmFyIFJlcG9NYW5hZ2VyXzEgPSByZXF1aXJlKFwiLi9zcmMvY29yZS9SZXBvTWFuYWdlclwiKTtcbnZhciBJTlRFUk5BTCA9IHJlcXVpcmUoXCIuL3NyYy9hcGkvaW50ZXJuYWxcIik7XG52YXIgVEVTVF9BQ0NFU1MgPSByZXF1aXJlKFwiLi9zcmMvYXBpL3Rlc3RfYWNjZXNzXCIpO1xudmFyIHV0aWxfMiA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvdXRpbFwiKTtcbmZ1bmN0aW9uIHJlZ2lzdGVyRGF0YWJhc2UoaW5zdGFuY2UpIHtcbiAgICAvLyBSZWdpc3RlciB0aGUgRGF0YWJhc2UgU2VydmljZSB3aXRoIHRoZSAnZmlyZWJhc2UnIG5hbWVzcGFjZS5cbiAgICB2YXIgbmFtZXNwYWNlID0gaW5zdGFuY2UuSU5URVJOQUwucmVnaXN0ZXJTZXJ2aWNlKCdkYXRhYmFzZScsIGZ1bmN0aW9uIChhcHAsIHVudXNlZCwgdXJsKSB7IHJldHVybiBSZXBvTWFuYWdlcl8xLlJlcG9NYW5hZ2VyLmdldEluc3RhbmNlKCkuZGF0YWJhc2VGcm9tQXBwKGFwcCwgdXJsKTsgfSwgXG4gICAgLy8gZmlyZWJhc2UuZGF0YWJhc2UgbmFtZXNwYWNlIHByb3BlcnRpZXNcbiAgICB7XG4gICAgICAgIFJlZmVyZW5jZTogUmVmZXJlbmNlXzEuUmVmZXJlbmNlLFxuICAgICAgICBRdWVyeTogUXVlcnlfMS5RdWVyeSxcbiAgICAgICAgRGF0YWJhc2U6IERhdGFiYXNlXzEuRGF0YWJhc2UsXG4gICAgICAgIGVuYWJsZUxvZ2dpbmc6IHV0aWxfMS5lbmFibGVMb2dnaW5nLFxuICAgICAgICBJTlRFUk5BTDogSU5URVJOQUwsXG4gICAgICAgIFNlcnZlclZhbHVlOiBEYXRhYmFzZV8xLkRhdGFiYXNlLlNlcnZlclZhbHVlLFxuICAgICAgICBURVNUX0FDQ0VTUzogVEVTVF9BQ0NFU1NcbiAgICB9LCBudWxsLCB0cnVlKTtcbiAgICBpZiAodXRpbF8yLmlzTm9kZVNkaygpKSB7XG4gICAgICAgIG1vZHVsZS5leHBvcnRzID0gbmFtZXNwYWNlO1xuICAgIH1cbn1cbmV4cG9ydHMucmVnaXN0ZXJEYXRhYmFzZSA9IHJlZ2lzdGVyRGF0YWJhc2U7XG5yZWdpc3RlckRhdGFiYXNlKGFwcF8xLmRlZmF1bHQpO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB1dGlsXzEgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG52YXIgdmFsaWRhdGlvbl8xID0gcmVxdWlyZShcIi4uL2NvcmUvdXRpbC92YWxpZGF0aW9uXCIpO1xudmFyIFBhdGhfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3V0aWwvUGF0aFwiKTtcbnZhciBQcmlvcml0eUluZGV4XzEgPSByZXF1aXJlKFwiLi4vY29yZS9zbmFwL2luZGV4ZXMvUHJpb3JpdHlJbmRleFwiKTtcbi8qKlxuICogQ2xhc3MgcmVwcmVzZW50aW5nIGEgZmlyZWJhc2UgZGF0YSBzbmFwc2hvdC4gIEl0IHdyYXBzIGEgU25hcHNob3ROb2RlIGFuZFxuICogc3VyZmFjZXMgdGhlIHB1YmxpYyBtZXRob2RzICh2YWwsIGZvckVhY2gsIGV0Yy4pIHdlIHdhbnQgdG8gZXhwb3NlLlxuICovXG52YXIgRGF0YVNuYXBzaG90ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7IU5vZGV9IG5vZGVfIEEgU25hcHNob3ROb2RlIHRvIHdyYXAuXG4gICAgICogQHBhcmFtIHshUmVmZXJlbmNlfSByZWZfIFRoZSByZWYgb2YgdGhlIGxvY2F0aW9uIHRoaXMgc25hcHNob3QgY2FtZSBmcm9tLlxuICAgICAqIEBwYXJhbSB7IUluZGV4fSBpbmRleF8gVGhlIGl0ZXJhdGlvbiBvcmRlciBmb3IgdGhpcyBzbmFwc2hvdFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIERhdGFTbmFwc2hvdChub2RlXywgcmVmXywgaW5kZXhfKSB7XG4gICAgICAgIHRoaXMubm9kZV8gPSBub2RlXztcbiAgICAgICAgdGhpcy5yZWZfID0gcmVmXztcbiAgICAgICAgdGhpcy5pbmRleF8gPSBpbmRleF87XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHJpZXZlcyB0aGUgc25hcHNob3QgY29udGVudHMgYXMgSlNPTi4gIFJldHVybnMgbnVsbCBpZiB0aGUgc25hcHNob3QgaXNcbiAgICAgKiBlbXB0eS5cbiAgICAgKlxuICAgICAqIEByZXR1cm4geyp9IEpTT04gcmVwcmVzZW50YXRpb24gb2YgdGhlIERhdGFTbmFwc2hvdCBjb250ZW50cywgb3IgbnVsbCBpZiBlbXB0eS5cbiAgICAgKi9cbiAgICBEYXRhU25hcHNob3QucHJvdG90eXBlLnZhbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdXRpbF8xLnZhbGlkYXRlQXJnQ291bnQoJ0RhdGFTbmFwc2hvdC52YWwnLCAwLCAwLCBhcmd1bWVudHMubGVuZ3RoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMubm9kZV8udmFsKCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBzbmFwc2hvdCBjb250ZW50cyBhcyBKU09OLCBpbmNsdWRpbmcgcHJpb3JpdGllcyBvZiBub2RlLiAgU3VpdGFibGUgZm9yIGV4cG9ydGluZ1xuICAgICAqIHRoZSBlbnRpcmUgbm9kZSBjb250ZW50cy5cbiAgICAgKiBAcmV0dXJuIHsqfSBKU09OIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBEYXRhU25hcHNob3QgY29udGVudHMsIG9yIG51bGwgaWYgZW1wdHkuXG4gICAgICovXG4gICAgRGF0YVNuYXBzaG90LnByb3RvdHlwZS5leHBvcnRWYWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHV0aWxfMS52YWxpZGF0ZUFyZ0NvdW50KCdEYXRhU25hcHNob3QuZXhwb3J0VmFsJywgMCwgMCwgYXJndW1lbnRzLmxlbmd0aCk7XG4gICAgICAgIHJldHVybiB0aGlzLm5vZGVfLnZhbCh0cnVlKTtcbiAgICB9O1xuICAgIC8vIERvIG5vdCBjcmVhdGUgcHVibGljIGRvY3VtZW50YXRpb24uIFRoaXMgaXMgaW50ZW5kZWQgdG8gbWFrZSBKU09OIHNlcmlhbGl6YXRpb24gd29yayBidXQgaXMgb3RoZXJ3aXNlIHVubmVjZXNzYXJ5XG4gICAgLy8gZm9yIGVuZC11c2Vyc1xuICAgIERhdGFTbmFwc2hvdC5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBPcHRpb25hbCBzcGFjZXIgYXJndW1lbnQgaXMgdW5uZWNlc3NhcnkgYmVjYXVzZSB3ZSdyZSBkZXBlbmRpbmcgb24gcmVjdXJzaW9uIHJhdGhlciB0aGFuIHN0cmluZ2lmeWluZyB0aGUgY29udGVudFxuICAgICAgICB1dGlsXzEudmFsaWRhdGVBcmdDb3VudCgnRGF0YVNuYXBzaG90LnRvSlNPTicsIDAsIDEsIGFyZ3VtZW50cy5sZW5ndGgpO1xuICAgICAgICByZXR1cm4gdGhpcy5leHBvcnRWYWwoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJldHVybnMgd2hldGhlciB0aGUgc25hcHNob3QgY29udGFpbnMgYSBub24tbnVsbCB2YWx1ZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IFdoZXRoZXIgdGhlIHNuYXBzaG90IGNvbnRhaW5zIGEgbm9uLW51bGwgdmFsdWUsIG9yIGlzIGVtcHR5LlxuICAgICAqL1xuICAgIERhdGFTbmFwc2hvdC5wcm90b3R5cGUuZXhpc3RzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB1dGlsXzEudmFsaWRhdGVBcmdDb3VudCgnRGF0YVNuYXBzaG90LmV4aXN0cycsIDAsIDAsIGFyZ3VtZW50cy5sZW5ndGgpO1xuICAgICAgICByZXR1cm4gIXRoaXMubm9kZV8uaXNFbXB0eSgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIERhdGFTbmFwc2hvdCBvZiB0aGUgc3BlY2lmaWVkIGNoaWxkIG5vZGUncyBjb250ZW50cy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7IXN0cmluZ30gY2hpbGRQYXRoU3RyaW5nIFBhdGggdG8gYSBjaGlsZC5cbiAgICAgKiBAcmV0dXJuIHshRGF0YVNuYXBzaG90fSBEYXRhU25hcHNob3QgZm9yIGNoaWxkIG5vZGUuXG4gICAgICovXG4gICAgRGF0YVNuYXBzaG90LnByb3RvdHlwZS5jaGlsZCA9IGZ1bmN0aW9uIChjaGlsZFBhdGhTdHJpbmcpIHtcbiAgICAgICAgdXRpbF8xLnZhbGlkYXRlQXJnQ291bnQoJ0RhdGFTbmFwc2hvdC5jaGlsZCcsIDAsIDEsIGFyZ3VtZW50cy5sZW5ndGgpO1xuICAgICAgICAvLyBFbnN1cmUgdGhlIGNoaWxkUGF0aCBpcyBhIHN0cmluZyAoY2FuIGJlIGEgbnVtYmVyKVxuICAgICAgICBjaGlsZFBhdGhTdHJpbmcgPSBTdHJpbmcoY2hpbGRQYXRoU3RyaW5nKTtcbiAgICAgICAgdmFsaWRhdGlvbl8xLnZhbGlkYXRlUGF0aFN0cmluZygnRGF0YVNuYXBzaG90LmNoaWxkJywgMSwgY2hpbGRQYXRoU3RyaW5nLCBmYWxzZSk7XG4gICAgICAgIHZhciBjaGlsZFBhdGggPSBuZXcgUGF0aF8xLlBhdGgoY2hpbGRQYXRoU3RyaW5nKTtcbiAgICAgICAgdmFyIGNoaWxkUmVmID0gdGhpcy5yZWZfLmNoaWxkKGNoaWxkUGF0aCk7XG4gICAgICAgIHJldHVybiBuZXcgRGF0YVNuYXBzaG90KHRoaXMubm9kZV8uZ2V0Q2hpbGQoY2hpbGRQYXRoKSwgY2hpbGRSZWYsIFByaW9yaXR5SW5kZXhfMS5QUklPUklUWV9JTkRFWCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHdoZXRoZXIgdGhlIHNuYXBzaG90IGNvbnRhaW5zIGEgY2hpbGQgYXQgdGhlIHNwZWNpZmllZCBwYXRoLlxuICAgICAqXG4gICAgICogQHBhcmFtIHshc3RyaW5nfSBjaGlsZFBhdGhTdHJpbmcgUGF0aCB0byBhIGNoaWxkLlxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IFdoZXRoZXIgdGhlIGNoaWxkIGV4aXN0cy5cbiAgICAgKi9cbiAgICBEYXRhU25hcHNob3QucHJvdG90eXBlLmhhc0NoaWxkID0gZnVuY3Rpb24gKGNoaWxkUGF0aFN0cmluZykge1xuICAgICAgICB1dGlsXzEudmFsaWRhdGVBcmdDb3VudCgnRGF0YVNuYXBzaG90Lmhhc0NoaWxkJywgMSwgMSwgYXJndW1lbnRzLmxlbmd0aCk7XG4gICAgICAgIHZhbGlkYXRpb25fMS52YWxpZGF0ZVBhdGhTdHJpbmcoJ0RhdGFTbmFwc2hvdC5oYXNDaGlsZCcsIDEsIGNoaWxkUGF0aFN0cmluZywgZmFsc2UpO1xuICAgICAgICB2YXIgY2hpbGRQYXRoID0gbmV3IFBhdGhfMS5QYXRoKGNoaWxkUGF0aFN0cmluZyk7XG4gICAgICAgIHJldHVybiAhdGhpcy5ub2RlXy5nZXRDaGlsZChjaGlsZFBhdGgpLmlzRW1wdHkoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIHByaW9yaXR5IG9mIHRoZSBvYmplY3QsIG9yIG51bGwgaWYgbm8gcHJpb3JpdHkgd2FzIHNldC5cbiAgICAgKlxuICAgICAqIEByZXR1cm4ge3N0cmluZ3xudW1iZXJ8bnVsbH0gVGhlIHByaW9yaXR5LlxuICAgICAqL1xuICAgIERhdGFTbmFwc2hvdC5wcm90b3R5cGUuZ2V0UHJpb3JpdHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHV0aWxfMS52YWxpZGF0ZUFyZ0NvdW50KCdEYXRhU25hcHNob3QuZ2V0UHJpb3JpdHknLCAwLCAwLCBhcmd1bWVudHMubGVuZ3RoKTtcbiAgICAgICAgLy8gdHlwZWNhc3QgaGVyZSBiZWNhdXNlIHdlIG5ldmVyIHJldHVybiBkZWZlcnJlZCB2YWx1ZXMgb3IgaW50ZXJuYWwgcHJpb3JpdGllcyAoTUFYX1BSSU9SSVRZKVxuICAgICAgICByZXR1cm4gdGhpcy5ub2RlXy5nZXRQcmlvcml0eSgpLnZhbCgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogSXRlcmF0ZXMgdGhyb3VnaCBjaGlsZCBub2RlcyBhbmQgY2FsbHMgdGhlIHNwZWNpZmllZCBhY3Rpb24gZm9yIGVhY2ggb25lLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbighRGF0YVNuYXBzaG90KX0gYWN0aW9uIENhbGxiYWNrIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZFxuICAgICAqIGZvciBlYWNoIGNoaWxkLlxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IFRydWUgaWYgZm9yRWFjaCB3YXMgY2FuY2VsZWQgYnkgYWN0aW9uIHJldHVybmluZyB0cnVlIGZvclxuICAgICAqIG9uZSBvZiB0aGUgY2hpbGQgbm9kZXMuXG4gICAgICovXG4gICAgRGF0YVNuYXBzaG90LnByb3RvdHlwZS5mb3JFYWNoID0gZnVuY3Rpb24gKGFjdGlvbikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB1dGlsXzEudmFsaWRhdGVBcmdDb3VudCgnRGF0YVNuYXBzaG90LmZvckVhY2gnLCAxLCAxLCBhcmd1bWVudHMubGVuZ3RoKTtcbiAgICAgICAgdXRpbF8xLnZhbGlkYXRlQ2FsbGJhY2soJ0RhdGFTbmFwc2hvdC5mb3JFYWNoJywgMSwgYWN0aW9uLCBmYWxzZSk7XG4gICAgICAgIGlmICh0aGlzLm5vZGVfLmlzTGVhZk5vZGUoKSlcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgdmFyIGNoaWxkcmVuTm9kZSA9IHRoaXMubm9kZV87XG4gICAgICAgIC8vIFNhbml0aXplIHRoZSByZXR1cm4gdmFsdWUgdG8gYSBib29sZWFuLiBDaGlsZHJlbk5vZGUuZm9yRWFjaENoaWxkIGhhcyBhIHdlaXJkIHJldHVybiB0eXBlLi4uXG4gICAgICAgIHJldHVybiAhIWNoaWxkcmVuTm9kZS5mb3JFYWNoQ2hpbGQodGhpcy5pbmRleF8sIGZ1bmN0aW9uIChrZXksIG5vZGUpIHtcbiAgICAgICAgICAgIHJldHVybiBhY3Rpb24obmV3IERhdGFTbmFwc2hvdChub2RlLCBfdGhpcy5yZWZfLmNoaWxkKGtleSksIFByaW9yaXR5SW5kZXhfMS5QUklPUklUWV9JTkRFWCkpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJldHVybnMgd2hldGhlciB0aGlzIERhdGFTbmFwc2hvdCBoYXMgY2hpbGRyZW4uXG4gICAgICogQHJldHVybiB7Ym9vbGVhbn0gVHJ1ZSBpZiB0aGUgRGF0YVNuYXBzaG90IGNvbnRhaW5zIDEgb3IgbW9yZSBjaGlsZCBub2Rlcy5cbiAgICAgKi9cbiAgICBEYXRhU25hcHNob3QucHJvdG90eXBlLmhhc0NoaWxkcmVuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB1dGlsXzEudmFsaWRhdGVBcmdDb3VudCgnRGF0YVNuYXBzaG90Lmhhc0NoaWxkcmVuJywgMCwgMCwgYXJndW1lbnRzLmxlbmd0aCk7XG4gICAgICAgIGlmICh0aGlzLm5vZGVfLmlzTGVhZk5vZGUoKSlcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgcmV0dXJuICF0aGlzLm5vZGVfLmlzRW1wdHkoKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShEYXRhU25hcHNob3QucHJvdG90eXBlLCBcImtleVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVmXy5nZXRLZXkoKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgbnVtYmVyIG9mIGNoaWxkcmVuIGZvciB0aGlzIERhdGFTbmFwc2hvdC5cbiAgICAgKiBAcmV0dXJuIHtudW1iZXJ9IFRoZSBudW1iZXIgb2YgY2hpbGRyZW4gdGhhdCB0aGlzIERhdGFTbmFwc2hvdCBjb250YWlucy5cbiAgICAgKi9cbiAgICBEYXRhU25hcHNob3QucHJvdG90eXBlLm51bUNoaWxkcmVuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB1dGlsXzEudmFsaWRhdGVBcmdDb3VudCgnRGF0YVNuYXBzaG90Lm51bUNoaWxkcmVuJywgMCwgMCwgYXJndW1lbnRzLmxlbmd0aCk7XG4gICAgICAgIHJldHVybiB0aGlzLm5vZGVfLm51bUNoaWxkcmVuKCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHtSZWZlcmVuY2V9IFRoZSBGaXJlYmFzZSByZWZlcmVuY2UgZm9yIHRoZSBsb2NhdGlvbiB0aGlzIHNuYXBzaG90J3MgZGF0YSBjYW1lIGZyb20uXG4gICAgICovXG4gICAgRGF0YVNuYXBzaG90LnByb3RvdHlwZS5nZXRSZWYgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHV0aWxfMS52YWxpZGF0ZUFyZ0NvdW50KCdEYXRhU25hcHNob3QucmVmJywgMCwgMCwgYXJndW1lbnRzLmxlbmd0aCk7XG4gICAgICAgIHJldHVybiB0aGlzLnJlZl87XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRGF0YVNuYXBzaG90LnByb3RvdHlwZSwgXCJyZWZcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFJlZigpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICByZXR1cm4gRGF0YVNuYXBzaG90O1xufSgpKTtcbmV4cG9ydHMuRGF0YVNuYXBzaG90ID0gRGF0YVNuYXBzaG90O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1EYXRhU25hcHNob3QuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdXRpbF8xID0gcmVxdWlyZShcIi4uL2NvcmUvdXRpbC91dGlsXCIpO1xudmFyIHBhcnNlcl8xID0gcmVxdWlyZShcIi4uL2NvcmUvdXRpbC9saWJzL3BhcnNlclwiKTtcbnZhciBQYXRoXzEgPSByZXF1aXJlKFwiLi4vY29yZS91dGlsL1BhdGhcIik7XG52YXIgUmVmZXJlbmNlXzEgPSByZXF1aXJlKFwiLi9SZWZlcmVuY2VcIik7XG52YXIgUmVwb18xID0gcmVxdWlyZShcIi4uL2NvcmUvUmVwb1wiKTtcbnZhciBSZXBvTWFuYWdlcl8xID0gcmVxdWlyZShcIi4uL2NvcmUvUmVwb01hbmFnZXJcIik7XG52YXIgdXRpbF8yID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xudmFyIHZhbGlkYXRpb25fMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3V0aWwvdmFsaWRhdGlvblwiKTtcbi8qKlxuICogQ2xhc3MgcmVwcmVzZW50aW5nIGEgZmlyZWJhc2UgZGF0YWJhc2UuXG4gKiBAaW1wbGVtZW50cyB7RmlyZWJhc2VTZXJ2aWNlfVxuICovXG52YXIgRGF0YWJhc2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogVGhlIGNvbnN0cnVjdG9yIHNob3VsZCBub3QgYmUgY2FsbGVkIGJ5IHVzZXJzIG9mIG91ciBwdWJsaWMgQVBJLlxuICAgICAqIEBwYXJhbSB7IVJlcG99IHJlcG9fXG4gICAgICovXG4gICAgZnVuY3Rpb24gRGF0YWJhc2UocmVwb18pIHtcbiAgICAgICAgdGhpcy5yZXBvXyA9IHJlcG9fO1xuICAgICAgICBpZiAoIShyZXBvXyBpbnN0YW5jZW9mIFJlcG9fMS5SZXBvKSkge1xuICAgICAgICAgICAgdXRpbF8xLmZhdGFsKFwiRG9uJ3QgY2FsbCBuZXcgRGF0YWJhc2UoKSBkaXJlY3RseSAtIHBsZWFzZSB1c2UgZmlyZWJhc2UuZGF0YWJhc2UoKS5cIik7XG4gICAgICAgIH1cbiAgICAgICAgLyoqIEB0eXBlIHtSZWZlcmVuY2V9ICovXG4gICAgICAgIHRoaXMucm9vdF8gPSBuZXcgUmVmZXJlbmNlXzEuUmVmZXJlbmNlKHJlcG9fLCBQYXRoXzEuUGF0aC5FbXB0eSk7XG4gICAgICAgIHRoaXMuSU5URVJOQUwgPSBuZXcgRGF0YWJhc2VJbnRlcm5hbHModGhpcyk7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShEYXRhYmFzZS5wcm90b3R5cGUsIFwiYXBwXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZXBvXy5hcHA7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSByZWZlcmVuY2UgdG8gdGhlIHJvb3Qgb3IgdGhlIHBhdGggc3BlY2lmaWVkIGluIG9wdF9wYXRoU3RyaW5nLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nPX0gcGF0aFN0cmluZ1xuICAgICAqIEByZXR1cm4geyFSZWZlcmVuY2V9IEZpcmViYXNlIHJlZmVyZW5jZS5cbiAgICAgKi9cbiAgICBEYXRhYmFzZS5wcm90b3R5cGUucmVmID0gZnVuY3Rpb24gKHBhdGhTdHJpbmcpIHtcbiAgICAgICAgdGhpcy5jaGVja0RlbGV0ZWRfKCdyZWYnKTtcbiAgICAgICAgdXRpbF8yLnZhbGlkYXRlQXJnQ291bnQoJ2RhdGFiYXNlLnJlZicsIDAsIDEsIGFyZ3VtZW50cy5sZW5ndGgpO1xuICAgICAgICByZXR1cm4gcGF0aFN0cmluZyAhPT0gdW5kZWZpbmVkID8gdGhpcy5yb290Xy5jaGlsZChwYXRoU3RyaW5nKSA6IHRoaXMucm9vdF87XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgcmVmZXJlbmNlIHRvIHRoZSByb290IG9yIHRoZSBwYXRoIHNwZWNpZmllZCBpbiB1cmwuXG4gICAgICogV2UgdGhyb3cgYSBleGNlcHRpb24gaWYgdGhlIHVybCBpcyBub3QgaW4gdGhlIHNhbWUgZG9tYWluIGFzIHRoZVxuICAgICAqIGN1cnJlbnQgcmVwby5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gICAgICogQHJldHVybiB7IVJlZmVyZW5jZX0gRmlyZWJhc2UgcmVmZXJlbmNlLlxuICAgICAqL1xuICAgIERhdGFiYXNlLnByb3RvdHlwZS5yZWZGcm9tVVJMID0gZnVuY3Rpb24gKHVybCkge1xuICAgICAgICAvKiogQGNvbnN0IHtzdHJpbmd9ICovXG4gICAgICAgIHZhciBhcGlOYW1lID0gJ2RhdGFiYXNlLnJlZkZyb21VUkwnO1xuICAgICAgICB0aGlzLmNoZWNrRGVsZXRlZF8oYXBpTmFtZSk7XG4gICAgICAgIHV0aWxfMi52YWxpZGF0ZUFyZ0NvdW50KGFwaU5hbWUsIDEsIDEsIGFyZ3VtZW50cy5sZW5ndGgpO1xuICAgICAgICB2YXIgcGFyc2VkVVJMID0gcGFyc2VyXzEucGFyc2VSZXBvSW5mbyh1cmwpO1xuICAgICAgICB2YWxpZGF0aW9uXzEudmFsaWRhdGVVcmwoYXBpTmFtZSwgMSwgcGFyc2VkVVJMKTtcbiAgICAgICAgdmFyIHJlcG9JbmZvID0gcGFyc2VkVVJMLnJlcG9JbmZvO1xuICAgICAgICBpZiAocmVwb0luZm8uaG9zdCAhPT0gdGhpcy5yZXBvXy5yZXBvSW5mb18uaG9zdCkge1xuICAgICAgICAgICAgdXRpbF8xLmZhdGFsKGFwaU5hbWUgK1xuICAgICAgICAgICAgICAgICc6IEhvc3QgbmFtZSBkb2VzIG5vdCBtYXRjaCB0aGUgY3VycmVudCBkYXRhYmFzZTogJyArXG4gICAgICAgICAgICAgICAgJyhmb3VuZCAnICtcbiAgICAgICAgICAgICAgICByZXBvSW5mby5ob3N0ICtcbiAgICAgICAgICAgICAgICAnIGJ1dCBleHBlY3RlZCAnICtcbiAgICAgICAgICAgICAgICB0aGlzLnJlcG9fLnJlcG9JbmZvXy5ob3N0ICtcbiAgICAgICAgICAgICAgICAnKScpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlZihwYXJzZWRVUkwucGF0aC50b1N0cmluZygpKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhcGlOYW1lXG4gICAgICovXG4gICAgRGF0YWJhc2UucHJvdG90eXBlLmNoZWNrRGVsZXRlZF8gPSBmdW5jdGlvbiAoYXBpTmFtZSkge1xuICAgICAgICBpZiAodGhpcy5yZXBvXyA9PT0gbnVsbCkge1xuICAgICAgICAgICAgdXRpbF8xLmZhdGFsKCdDYW5ub3QgY2FsbCAnICsgYXBpTmFtZSArICcgb24gYSBkZWxldGVkIGRhdGFiYXNlLicpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvLyBNYWtlIGluZGl2aWR1YWwgcmVwbyBnbyBvZmZsaW5lLlxuICAgIERhdGFiYXNlLnByb3RvdHlwZS5nb09mZmxpbmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHV0aWxfMi52YWxpZGF0ZUFyZ0NvdW50KCdkYXRhYmFzZS5nb09mZmxpbmUnLCAwLCAwLCBhcmd1bWVudHMubGVuZ3RoKTtcbiAgICAgICAgdGhpcy5jaGVja0RlbGV0ZWRfKCdnb09mZmxpbmUnKTtcbiAgICAgICAgdGhpcy5yZXBvXy5pbnRlcnJ1cHQoKTtcbiAgICB9O1xuICAgIERhdGFiYXNlLnByb3RvdHlwZS5nb09ubGluZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdXRpbF8yLnZhbGlkYXRlQXJnQ291bnQoJ2RhdGFiYXNlLmdvT25saW5lJywgMCwgMCwgYXJndW1lbnRzLmxlbmd0aCk7XG4gICAgICAgIHRoaXMuY2hlY2tEZWxldGVkXygnZ29PbmxpbmUnKTtcbiAgICAgICAgdGhpcy5yZXBvXy5yZXN1bWUoKTtcbiAgICB9O1xuICAgIERhdGFiYXNlLlNlcnZlclZhbHVlID0ge1xuICAgICAgICBUSU1FU1RBTVA6IHtcbiAgICAgICAgICAgICcuc3YnOiAndGltZXN0YW1wJ1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gRGF0YWJhc2U7XG59KCkpO1xuZXhwb3J0cy5EYXRhYmFzZSA9IERhdGFiYXNlO1xudmFyIERhdGFiYXNlSW50ZXJuYWxzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIC8qKiBAcGFyYW0geyFEYXRhYmFzZX0gZGF0YWJhc2UgKi9cbiAgICBmdW5jdGlvbiBEYXRhYmFzZUludGVybmFscyhkYXRhYmFzZSkge1xuICAgICAgICB0aGlzLmRhdGFiYXNlID0gZGF0YWJhc2U7XG4gICAgfVxuICAgIC8qKiBAcmV0dXJuIHtQcm9taXNlPHZvaWQ+fSAqL1xuICAgIERhdGFiYXNlSW50ZXJuYWxzLnByb3RvdHlwZS5kZWxldGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuZGF0YWJhc2UuY2hlY2tEZWxldGVkXygnZGVsZXRlJyk7XG4gICAgICAgIFJlcG9NYW5hZ2VyXzEuUmVwb01hbmFnZXIuZ2V0SW5zdGFuY2UoKS5kZWxldGVSZXBvKHRoaXMuZGF0YWJhc2UucmVwb18pO1xuICAgICAgICB0aGlzLmRhdGFiYXNlLnJlcG9fID0gbnVsbDtcbiAgICAgICAgdGhpcy5kYXRhYmFzZS5yb290XyA9IG51bGw7XG4gICAgICAgIHRoaXMuZGF0YWJhc2UuSU5URVJOQUwgPSBudWxsO1xuICAgICAgICB0aGlzLmRhdGFiYXNlID0gbnVsbDtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH07XG4gICAgcmV0dXJuIERhdGFiYXNlSW50ZXJuYWxzO1xufSgpKTtcbmV4cG9ydHMuRGF0YWJhc2VJbnRlcm5hbHMgPSBEYXRhYmFzZUludGVybmFscztcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9RGF0YWJhc2UuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdXRpbF8xID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xudmFyIEtleUluZGV4XzEgPSByZXF1aXJlKFwiLi4vY29yZS9zbmFwL2luZGV4ZXMvS2V5SW5kZXhcIik7XG52YXIgUHJpb3JpdHlJbmRleF8xID0gcmVxdWlyZShcIi4uL2NvcmUvc25hcC9pbmRleGVzL1ByaW9yaXR5SW5kZXhcIik7XG52YXIgVmFsdWVJbmRleF8xID0gcmVxdWlyZShcIi4uL2NvcmUvc25hcC9pbmRleGVzL1ZhbHVlSW5kZXhcIik7XG52YXIgUGF0aEluZGV4XzEgPSByZXF1aXJlKFwiLi4vY29yZS9zbmFwL2luZGV4ZXMvUGF0aEluZGV4XCIpO1xudmFyIHV0aWxfMiA9IHJlcXVpcmUoXCIuLi9jb3JlL3V0aWwvdXRpbFwiKTtcbnZhciBQYXRoXzEgPSByZXF1aXJlKFwiLi4vY29yZS91dGlsL1BhdGhcIik7XG52YXIgdmFsaWRhdGlvbl8xID0gcmVxdWlyZShcIi4uL2NvcmUvdXRpbC92YWxpZGF0aW9uXCIpO1xudmFyIHV0aWxfMyA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvdXRpbFwiKTtcbnZhciBFdmVudFJlZ2lzdHJhdGlvbl8xID0gcmVxdWlyZShcIi4uL2NvcmUvdmlldy9FdmVudFJlZ2lzdHJhdGlvblwiKTtcbnZhciB1dGlsXzQgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG52YXIgX19yZWZlcmVuY2VDb25zdHJ1Y3Rvcjtcbi8qKlxuICogQSBRdWVyeSByZXByZXNlbnRzIGEgZmlsdGVyIHRvIGJlIGFwcGxpZWQgdG8gYSBmaXJlYmFzZSBsb2NhdGlvbi4gIFRoaXMgb2JqZWN0IHB1cmVseSByZXByZXNlbnRzIHRoZVxuICogcXVlcnkgZXhwcmVzc2lvbiAoYW5kIGV4cG9zZXMgb3VyIHB1YmxpYyBBUEkgdG8gYnVpbGQgdGhlIHF1ZXJ5KS4gIFRoZSBhY3R1YWwgcXVlcnkgbG9naWMgaXMgaW4gVmlld0Jhc2UuanMuXG4gKlxuICogU2luY2UgZXZlcnkgRmlyZWJhc2UgcmVmZXJlbmNlIGlzIGEgcXVlcnksIEZpcmViYXNlIGluaGVyaXRzIGZyb20gdGhpcyBvYmplY3QuXG4gKi9cbnZhciBRdWVyeSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBRdWVyeShyZXBvLCBwYXRoLCBxdWVyeVBhcmFtc18sIG9yZGVyQnlDYWxsZWRfKSB7XG4gICAgICAgIHRoaXMucmVwbyA9IHJlcG87XG4gICAgICAgIHRoaXMucGF0aCA9IHBhdGg7XG4gICAgICAgIHRoaXMucXVlcnlQYXJhbXNfID0gcXVlcnlQYXJhbXNfO1xuICAgICAgICB0aGlzLm9yZGVyQnlDYWxsZWRfID0gb3JkZXJCeUNhbGxlZF87XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShRdWVyeSwgXCJfX3JlZmVyZW5jZUNvbnN0cnVjdG9yXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB1dGlsXzEuYXNzZXJ0KF9fcmVmZXJlbmNlQ29uc3RydWN0b3IsICdSZWZlcmVuY2UudHMgaGFzIG5vdCBiZWVuIGxvYWRlZCcpO1xuICAgICAgICAgICAgcmV0dXJuIF9fcmVmZXJlbmNlQ29uc3RydWN0b3I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICAgICAgX19yZWZlcmVuY2VDb25zdHJ1Y3RvciA9IHZhbDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgLyoqXG4gICAgICogVmFsaWRhdGVzIHN0YXJ0L2VuZCB2YWx1ZXMgZm9yIHF1ZXJpZXMuXG4gICAgICogQHBhcmFtIHshUXVlcnlQYXJhbXN9IHBhcmFtc1xuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgUXVlcnkudmFsaWRhdGVRdWVyeUVuZHBvaW50c18gPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgIHZhciBzdGFydE5vZGUgPSBudWxsO1xuICAgICAgICB2YXIgZW5kTm9kZSA9IG51bGw7XG4gICAgICAgIGlmIChwYXJhbXMuaGFzU3RhcnQoKSkge1xuICAgICAgICAgICAgc3RhcnROb2RlID0gcGFyYW1zLmdldEluZGV4U3RhcnRWYWx1ZSgpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbXMuaGFzRW5kKCkpIHtcbiAgICAgICAgICAgIGVuZE5vZGUgPSBwYXJhbXMuZ2V0SW5kZXhFbmRWYWx1ZSgpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbXMuZ2V0SW5kZXgoKSA9PT0gS2V5SW5kZXhfMS5LRVlfSU5ERVgpIHtcbiAgICAgICAgICAgIHZhciB0b29NYW55QXJnc0Vycm9yID0gJ1F1ZXJ5OiBXaGVuIG9yZGVyaW5nIGJ5IGtleSwgeW91IG1heSBvbmx5IHBhc3Mgb25lIGFyZ3VtZW50IHRvICcgK1xuICAgICAgICAgICAgICAgICdzdGFydEF0KCksIGVuZEF0KCksIG9yIGVxdWFsVG8oKS4nO1xuICAgICAgICAgICAgdmFyIHdyb25nQXJnVHlwZUVycm9yID0gJ1F1ZXJ5OiBXaGVuIG9yZGVyaW5nIGJ5IGtleSwgdGhlIGFyZ3VtZW50IHBhc3NlZCB0byBzdGFydEF0KCksIGVuZEF0KCksJyArXG4gICAgICAgICAgICAgICAgJ29yIGVxdWFsVG8oKSBtdXN0IGJlIGEgc3RyaW5nLic7XG4gICAgICAgICAgICBpZiAocGFyYW1zLmhhc1N0YXJ0KCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RhcnROYW1lID0gcGFyYW1zLmdldEluZGV4U3RhcnROYW1lKCk7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXJ0TmFtZSAhPSB1dGlsXzIuTUlOX05BTUUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKHRvb01hbnlBcmdzRXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0eXBlb2Ygc3RhcnROb2RlICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3Iod3JvbmdBcmdUeXBlRXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChwYXJhbXMuaGFzRW5kKCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZW5kTmFtZSA9IHBhcmFtcy5nZXRJbmRleEVuZE5hbWUoKTtcbiAgICAgICAgICAgICAgICBpZiAoZW5kTmFtZSAhPSB1dGlsXzIuTUFYX05BTUUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKHRvb01hbnlBcmdzRXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgZW5kTm9kZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKHdyb25nQXJnVHlwZUVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocGFyYW1zLmdldEluZGV4KCkgPT09IFByaW9yaXR5SW5kZXhfMS5QUklPUklUWV9JTkRFWCkge1xuICAgICAgICAgICAgaWYgKChzdGFydE5vZGUgIT0gbnVsbCAmJiAhdmFsaWRhdGlvbl8xLmlzVmFsaWRQcmlvcml0eShzdGFydE5vZGUpKSB8fFxuICAgICAgICAgICAgICAgIChlbmROb2RlICE9IG51bGwgJiYgIXZhbGlkYXRpb25fMS5pc1ZhbGlkUHJpb3JpdHkoZW5kTm9kZSkpKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdRdWVyeTogV2hlbiBvcmRlcmluZyBieSBwcmlvcml0eSwgdGhlIGZpcnN0IGFyZ3VtZW50IHBhc3NlZCB0byBzdGFydEF0KCksICcgK1xuICAgICAgICAgICAgICAgICAgICAnZW5kQXQoKSwgb3IgZXF1YWxUbygpIG11c3QgYmUgYSB2YWxpZCBwcmlvcml0eSB2YWx1ZSAobnVsbCwgYSBudW1iZXIsIG9yIGEgc3RyaW5nKS4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHV0aWxfMS5hc3NlcnQocGFyYW1zLmdldEluZGV4KCkgaW5zdGFuY2VvZiBQYXRoSW5kZXhfMS5QYXRoSW5kZXggfHxcbiAgICAgICAgICAgICAgICBwYXJhbXMuZ2V0SW5kZXgoKSA9PT0gVmFsdWVJbmRleF8xLlZBTFVFX0lOREVYLCAndW5rbm93biBpbmRleCB0eXBlLicpO1xuICAgICAgICAgICAgaWYgKChzdGFydE5vZGUgIT0gbnVsbCAmJiB0eXBlb2Ygc3RhcnROb2RlID09PSAnb2JqZWN0JykgfHxcbiAgICAgICAgICAgICAgICAoZW5kTm9kZSAhPSBudWxsICYmIHR5cGVvZiBlbmROb2RlID09PSAnb2JqZWN0JykpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1F1ZXJ5OiBGaXJzdCBhcmd1bWVudCBwYXNzZWQgdG8gc3RhcnRBdCgpLCBlbmRBdCgpLCBvciBlcXVhbFRvKCkgY2Fubm90IGJlICcgK1xuICAgICAgICAgICAgICAgICAgICAnYW4gb2JqZWN0LicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZXMgdGhhdCBsaW1pdCogaGFzIGJlZW4gY2FsbGVkIHdpdGggdGhlIGNvcnJlY3QgY29tYmluYXRpb24gb2YgcGFyYW1ldGVyc1xuICAgICAqIEBwYXJhbSB7IVF1ZXJ5UGFyYW1zfSBwYXJhbXNcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIFF1ZXJ5LnZhbGlkYXRlTGltaXRfID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICBpZiAocGFyYW1zLmhhc1N0YXJ0KCkgJiZcbiAgICAgICAgICAgIHBhcmFtcy5oYXNFbmQoKSAmJlxuICAgICAgICAgICAgcGFyYW1zLmhhc0xpbWl0KCkgJiZcbiAgICAgICAgICAgICFwYXJhbXMuaGFzQW5jaG9yZWRMaW1pdCgpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJRdWVyeTogQ2FuJ3QgY29tYmluZSBzdGFydEF0KCksIGVuZEF0KCksIGFuZCBsaW1pdCgpLiBVc2UgbGltaXRUb0ZpcnN0KCkgb3IgbGltaXRUb0xhc3QoKSBpbnN0ZWFkLlwiKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogVmFsaWRhdGVzIHRoYXQgbm8gb3RoZXIgb3JkZXIgYnkgY2FsbCBoYXMgYmVlbiBtYWRlXG4gICAgICogQHBhcmFtIHshc3RyaW5nfSBmbk5hbWVcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIFF1ZXJ5LnByb3RvdHlwZS52YWxpZGF0ZU5vUHJldmlvdXNPcmRlckJ5Q2FsbF8gPSBmdW5jdGlvbiAoZm5OYW1lKSB7XG4gICAgICAgIGlmICh0aGlzLm9yZGVyQnlDYWxsZWRfID09PSB0cnVlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZm5OYW1lICsgXCI6IFlvdSBjYW4ndCBjb21iaW5lIG11bHRpcGxlIG9yZGVyQnkgY2FsbHMuXCIpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHshUXVlcnlQYXJhbXN9XG4gICAgICovXG4gICAgUXVlcnkucHJvdG90eXBlLmdldFF1ZXJ5UGFyYW1zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5xdWVyeVBhcmFtc187XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHshUmVmZXJlbmNlfVxuICAgICAqL1xuICAgIFF1ZXJ5LnByb3RvdHlwZS5nZXRSZWYgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHV0aWxfMy52YWxpZGF0ZUFyZ0NvdW50KCdRdWVyeS5yZWYnLCAwLCAwLCBhcmd1bWVudHMubGVuZ3RoKTtcbiAgICAgICAgLy8gVGhpcyBpcyBhIHNsaWdodCBoYWNrLiBXZSBjYW5ub3QgZ29vZy5yZXF1aXJlKCdmYi5hcGkuRmlyZWJhc2UnKSwgc2luY2UgRmlyZWJhc2UgcmVxdWlyZXMgZmIuYXBpLlF1ZXJ5LlxuICAgICAgICAvLyBIb3dldmVyLCB3ZSB3aWxsIGFsd2F5cyBleHBvcnQgJ0ZpcmViYXNlJyB0byB0aGUgZ2xvYmFsIG5hbWVzcGFjZSwgc28gaXQncyBndWFyYW50ZWVkIHRvIGV4aXN0IGJ5IHRoZSB0aW1lIHRoaXNcbiAgICAgICAgLy8gbWV0aG9kIGdldHMgY2FsbGVkLlxuICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5Ll9fcmVmZXJlbmNlQ29uc3RydWN0b3IodGhpcy5yZXBvLCB0aGlzLnBhdGgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshc3RyaW5nfSBldmVudFR5cGVcbiAgICAgKiBAcGFyYW0geyFmdW5jdGlvbihEYXRhU25hcHNob3QsIHN0cmluZz0pfSBjYWxsYmFja1xuICAgICAqIEBwYXJhbSB7KGZ1bmN0aW9uKEVycm9yKXxPYmplY3QpPX0gY2FuY2VsQ2FsbGJhY2tPckNvbnRleHRcbiAgICAgKiBAcGFyYW0ge09iamVjdD19IGNvbnRleHRcbiAgICAgKiBAcmV0dXJuIHshZnVuY3Rpb24oRGF0YVNuYXBzaG90LCBzdHJpbmc9KX1cbiAgICAgKi9cbiAgICBRdWVyeS5wcm90b3R5cGUub24gPSBmdW5jdGlvbiAoZXZlbnRUeXBlLCBjYWxsYmFjaywgY2FuY2VsQ2FsbGJhY2tPckNvbnRleHQsIGNvbnRleHQpIHtcbiAgICAgICAgdXRpbF8zLnZhbGlkYXRlQXJnQ291bnQoJ1F1ZXJ5Lm9uJywgMiwgNCwgYXJndW1lbnRzLmxlbmd0aCk7XG4gICAgICAgIHZhbGlkYXRpb25fMS52YWxpZGF0ZUV2ZW50VHlwZSgnUXVlcnkub24nLCAxLCBldmVudFR5cGUsIGZhbHNlKTtcbiAgICAgICAgdXRpbF8zLnZhbGlkYXRlQ2FsbGJhY2soJ1F1ZXJ5Lm9uJywgMiwgY2FsbGJhY2ssIGZhbHNlKTtcbiAgICAgICAgdmFyIHJldCA9IFF1ZXJ5LmdldENhbmNlbEFuZENvbnRleHRBcmdzXygnUXVlcnkub24nLCBjYW5jZWxDYWxsYmFja09yQ29udGV4dCwgY29udGV4dCk7XG4gICAgICAgIGlmIChldmVudFR5cGUgPT09ICd2YWx1ZScpIHtcbiAgICAgICAgICAgIHRoaXMub25WYWx1ZUV2ZW50KGNhbGxiYWNrLCByZXQuY2FuY2VsLCByZXQuY29udGV4dCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgY2FsbGJhY2tzID0ge307XG4gICAgICAgICAgICBjYWxsYmFja3NbZXZlbnRUeXBlXSA9IGNhbGxiYWNrO1xuICAgICAgICAgICAgdGhpcy5vbkNoaWxkRXZlbnQoY2FsbGJhY2tzLCByZXQuY2FuY2VsLCByZXQuY29udGV4dCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNhbGxiYWNrO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshZnVuY3Rpb24oIURhdGFTbmFwc2hvdCl9IGNhbGxiYWNrXG4gICAgICogQHBhcmFtIHs/ZnVuY3Rpb24oRXJyb3IpfSBjYW5jZWxDYWxsYmFja1xuICAgICAqIEBwYXJhbSB7P09iamVjdH0gY29udGV4dFxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBRdWVyeS5wcm90b3R5cGUub25WYWx1ZUV2ZW50ID0gZnVuY3Rpb24gKGNhbGxiYWNrLCBjYW5jZWxDYWxsYmFjaywgY29udGV4dCkge1xuICAgICAgICB2YXIgY29udGFpbmVyID0gbmV3IEV2ZW50UmVnaXN0cmF0aW9uXzEuVmFsdWVFdmVudFJlZ2lzdHJhdGlvbihjYWxsYmFjaywgY2FuY2VsQ2FsbGJhY2sgfHwgbnVsbCwgY29udGV4dCB8fCBudWxsKTtcbiAgICAgICAgdGhpcy5yZXBvLmFkZEV2ZW50Q2FsbGJhY2tGb3JRdWVyeSh0aGlzLCBjb250YWluZXIpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshT2JqZWN0LjxzdHJpbmcsICFmdW5jdGlvbighRGF0YVNuYXBzaG90LCA/c3RyaW5nKT59IGNhbGxiYWNrc1xuICAgICAqIEBwYXJhbSB7P2Z1bmN0aW9uKEVycm9yKX0gY2FuY2VsQ2FsbGJhY2tcbiAgICAgKiBAcGFyYW0gez9PYmplY3R9IGNvbnRleHRcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgUXVlcnkucHJvdG90eXBlLm9uQ2hpbGRFdmVudCA9IGZ1bmN0aW9uIChjYWxsYmFja3MsIGNhbmNlbENhbGxiYWNrLCBjb250ZXh0KSB7XG4gICAgICAgIHZhciBjb250YWluZXIgPSBuZXcgRXZlbnRSZWdpc3RyYXRpb25fMS5DaGlsZEV2ZW50UmVnaXN0cmF0aW9uKGNhbGxiYWNrcywgY2FuY2VsQ2FsbGJhY2ssIGNvbnRleHQpO1xuICAgICAgICB0aGlzLnJlcG8uYWRkRXZlbnRDYWxsYmFja0ZvclF1ZXJ5KHRoaXMsIGNvbnRhaW5lcik7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge3N0cmluZz19IGV2ZW50VHlwZVxuICAgICAqIEBwYXJhbSB7KGZ1bmN0aW9uKCFEYXRhU25hcHNob3QsID9zdHJpbmc9KSk9fSBjYWxsYmFja1xuICAgICAqIEBwYXJhbSB7T2JqZWN0PX0gY29udGV4dFxuICAgICAqL1xuICAgIFF1ZXJ5LnByb3RvdHlwZS5vZmYgPSBmdW5jdGlvbiAoZXZlbnRUeXBlLCBjYWxsYmFjaywgY29udGV4dCkge1xuICAgICAgICB1dGlsXzMudmFsaWRhdGVBcmdDb3VudCgnUXVlcnkub2ZmJywgMCwgMywgYXJndW1lbnRzLmxlbmd0aCk7XG4gICAgICAgIHZhbGlkYXRpb25fMS52YWxpZGF0ZUV2ZW50VHlwZSgnUXVlcnkub2ZmJywgMSwgZXZlbnRUeXBlLCB0cnVlKTtcbiAgICAgICAgdXRpbF8zLnZhbGlkYXRlQ2FsbGJhY2soJ1F1ZXJ5Lm9mZicsIDIsIGNhbGxiYWNrLCB0cnVlKTtcbiAgICAgICAgdXRpbF8zLnZhbGlkYXRlQ29udGV4dE9iamVjdCgnUXVlcnkub2ZmJywgMywgY29udGV4dCwgdHJ1ZSk7XG4gICAgICAgIHZhciBjb250YWluZXIgPSBudWxsO1xuICAgICAgICB2YXIgY2FsbGJhY2tzID0gbnVsbDtcbiAgICAgICAgaWYgKGV2ZW50VHlwZSA9PT0gJ3ZhbHVlJykge1xuICAgICAgICAgICAgdmFyIHZhbHVlQ2FsbGJhY2sgPSBjYWxsYmFjayB8fCBudWxsO1xuICAgICAgICAgICAgY29udGFpbmVyID0gbmV3IEV2ZW50UmVnaXN0cmF0aW9uXzEuVmFsdWVFdmVudFJlZ2lzdHJhdGlvbih2YWx1ZUNhbGxiYWNrLCBudWxsLCBjb250ZXh0IHx8IG51bGwpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGV2ZW50VHlwZSkge1xuICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2tzID0ge307XG4gICAgICAgICAgICAgICAgY2FsbGJhY2tzW2V2ZW50VHlwZV0gPSBjYWxsYmFjaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnRhaW5lciA9IG5ldyBFdmVudFJlZ2lzdHJhdGlvbl8xLkNoaWxkRXZlbnRSZWdpc3RyYXRpb24oY2FsbGJhY2tzLCBudWxsLCBjb250ZXh0IHx8IG51bGwpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVwby5yZW1vdmVFdmVudENhbGxiYWNrRm9yUXVlcnkodGhpcywgY29udGFpbmVyKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEF0dGFjaGVzIGEgbGlzdGVuZXIsIHdhaXRzIGZvciB0aGUgZmlyc3QgZXZlbnQsIGFuZCB0aGVuIHJlbW92ZXMgdGhlIGxpc3RlbmVyXG4gICAgICogQHBhcmFtIHshc3RyaW5nfSBldmVudFR5cGVcbiAgICAgKiBAcGFyYW0geyFmdW5jdGlvbighRGF0YVNuYXBzaG90LCBzdHJpbmc9KX0gdXNlckNhbGxiYWNrXG4gICAgICogQHBhcmFtIGNhbmNlbE9yQ29udGV4dFxuICAgICAqIEBwYXJhbSBjb250ZXh0XG4gICAgICogQHJldHVybiB7IWZpcmViYXNlLlByb21pc2V9XG4gICAgICovXG4gICAgUXVlcnkucHJvdG90eXBlLm9uY2UgPSBmdW5jdGlvbiAoZXZlbnRUeXBlLCB1c2VyQ2FsbGJhY2ssIGNhbmNlbE9yQ29udGV4dCwgY29udGV4dCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB1dGlsXzMudmFsaWRhdGVBcmdDb3VudCgnUXVlcnkub25jZScsIDEsIDQsIGFyZ3VtZW50cy5sZW5ndGgpO1xuICAgICAgICB2YWxpZGF0aW9uXzEudmFsaWRhdGVFdmVudFR5cGUoJ1F1ZXJ5Lm9uY2UnLCAxLCBldmVudFR5cGUsIGZhbHNlKTtcbiAgICAgICAgdXRpbF8zLnZhbGlkYXRlQ2FsbGJhY2soJ1F1ZXJ5Lm9uY2UnLCAyLCB1c2VyQ2FsbGJhY2ssIHRydWUpO1xuICAgICAgICB2YXIgcmV0ID0gUXVlcnkuZ2V0Q2FuY2VsQW5kQ29udGV4dEFyZ3NfKCdRdWVyeS5vbmNlJywgY2FuY2VsT3JDb250ZXh0LCBjb250ZXh0KTtcbiAgICAgICAgLy8gVE9ETzogSW1wbGVtZW50IHRoaXMgbW9yZSBlZmZpY2llbnRseSAoaW4gcGFydGljdWxhciwgdXNlICdnZXQnIHdpcmUgcHJvdG9jb2wgZm9yICd2YWx1ZScgZXZlbnQpXG4gICAgICAgIC8vIFRPRE86IGNvbnNpZGVyIGFjdHVhbGx5IHdpcmluZyB0aGUgY2FsbGJhY2tzIGludG8gdGhlIHByb21pc2UuIFdlIGNhbm5vdCBkbyB0aGlzIHdpdGhvdXQgYSBicmVha2luZyBjaGFuZ2VcbiAgICAgICAgLy8gYmVjYXVzZSB0aGUgQVBJIGN1cnJlbnRseSBleHBlY3RzIGNhbGxiYWNrcyB3aWxsIGJlIGNhbGxlZCBzeW5jaHJvbm91c2x5IGlmIHRoZSBkYXRhIGlzIGNhY2hlZCwgYnV0IHRoaXMgaXNcbiAgICAgICAgLy8gYWdhaW5zdCB0aGUgUHJvbWlzZSBzcGVjaWZpY2F0aW9uLlxuICAgICAgICB2YXIgZmlyc3RDYWxsID0gdHJ1ZTtcbiAgICAgICAgdmFyIGRlZmVycmVkID0gbmV3IHV0aWxfNC5EZWZlcnJlZCgpO1xuICAgICAgICAvLyBBIGR1bW15IGVycm9yIGhhbmRsZXIgaW4gY2FzZSBhIHVzZXIgd2Fzbid0IGV4cGVjdGluZyBwcm9taXNlc1xuICAgICAgICBkZWZlcnJlZC5wcm9taXNlLmNhdGNoKGZ1bmN0aW9uICgpIHsgfSk7XG4gICAgICAgIHZhciBvbmNlQ2FsbGJhY2sgPSBmdW5jdGlvbiAoc25hcHNob3QpIHtcbiAgICAgICAgICAgIC8vIE5PVEU6IEV2ZW4gdGhvdWdoIHdlIHVuc3Vic2NyaWJlLCB3ZSBtYXkgZ2V0IGNhbGxlZCBtdWx0aXBsZSB0aW1lcyBpZiBhIHNpbmdsZSBhY3Rpb24gKGUuZy4gc2V0KCkgd2l0aCBKU09OKVxuICAgICAgICAgICAgLy8gdHJpZ2dlcnMgbXVsdGlwbGUgZXZlbnRzIChlLmcuIGNoaWxkX2FkZGVkIG9yIGNoaWxkX2NoYW5nZWQpLlxuICAgICAgICAgICAgaWYgKGZpcnN0Q2FsbCkge1xuICAgICAgICAgICAgICAgIGZpcnN0Q2FsbCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIF90aGlzLm9mZihldmVudFR5cGUsIG9uY2VDYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgaWYgKHVzZXJDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICB1c2VyQ2FsbGJhY2suYmluZChyZXQuY29udGV4dCkoc25hcHNob3QpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHNuYXBzaG90KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5vbihldmVudFR5cGUsIG9uY2VDYWxsYmFjaywgXG4gICAgICAgIC8qY2FuY2VsPSovIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgIF90aGlzLm9mZihldmVudFR5cGUsIG9uY2VDYWxsYmFjayk7XG4gICAgICAgICAgICBpZiAocmV0LmNhbmNlbClcbiAgICAgICAgICAgICAgICByZXQuY2FuY2VsLmJpbmQocmV0LmNvbnRleHQpKGVycik7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoZXJyKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogU2V0IGEgbGltaXQgYW5kIGFuY2hvciBpdCB0byB0aGUgc3RhcnQgb2YgdGhlIHdpbmRvdy5cbiAgICAgKiBAcGFyYW0geyFudW1iZXJ9IGxpbWl0XG4gICAgICogQHJldHVybiB7IVF1ZXJ5fVxuICAgICAqL1xuICAgIFF1ZXJ5LnByb3RvdHlwZS5saW1pdFRvRmlyc3QgPSBmdW5jdGlvbiAobGltaXQpIHtcbiAgICAgICAgdXRpbF8zLnZhbGlkYXRlQXJnQ291bnQoJ1F1ZXJ5LmxpbWl0VG9GaXJzdCcsIDEsIDEsIGFyZ3VtZW50cy5sZW5ndGgpO1xuICAgICAgICBpZiAodHlwZW9mIGxpbWl0ICE9PSAnbnVtYmVyJyB8fFxuICAgICAgICAgICAgTWF0aC5mbG9vcihsaW1pdCkgIT09IGxpbWl0IHx8XG4gICAgICAgICAgICBsaW1pdCA8PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1F1ZXJ5LmxpbWl0VG9GaXJzdDogRmlyc3QgYXJndW1lbnQgbXVzdCBiZSBhIHBvc2l0aXZlIGludGVnZXIuJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucXVlcnlQYXJhbXNfLmhhc0xpbWl0KCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUXVlcnkubGltaXRUb0ZpcnN0OiBMaW1pdCB3YXMgYWxyZWFkeSBzZXQgKGJ5IGFub3RoZXIgY2FsbCB0byBsaW1pdCwgJyArXG4gICAgICAgICAgICAgICAgJ2xpbWl0VG9GaXJzdCwgb3IgbGltaXRUb0xhc3QpLicpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgUXVlcnkodGhpcy5yZXBvLCB0aGlzLnBhdGgsIHRoaXMucXVlcnlQYXJhbXNfLmxpbWl0VG9GaXJzdChsaW1pdCksIHRoaXMub3JkZXJCeUNhbGxlZF8pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogU2V0IGEgbGltaXQgYW5kIGFuY2hvciBpdCB0byB0aGUgZW5kIG9mIHRoZSB3aW5kb3cuXG4gICAgICogQHBhcmFtIHshbnVtYmVyfSBsaW1pdFxuICAgICAqIEByZXR1cm4geyFRdWVyeX1cbiAgICAgKi9cbiAgICBRdWVyeS5wcm90b3R5cGUubGltaXRUb0xhc3QgPSBmdW5jdGlvbiAobGltaXQpIHtcbiAgICAgICAgdXRpbF8zLnZhbGlkYXRlQXJnQ291bnQoJ1F1ZXJ5LmxpbWl0VG9MYXN0JywgMSwgMSwgYXJndW1lbnRzLmxlbmd0aCk7XG4gICAgICAgIGlmICh0eXBlb2YgbGltaXQgIT09ICdudW1iZXInIHx8XG4gICAgICAgICAgICBNYXRoLmZsb29yKGxpbWl0KSAhPT0gbGltaXQgfHxcbiAgICAgICAgICAgIGxpbWl0IDw9IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUXVlcnkubGltaXRUb0xhc3Q6IEZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBwb3NpdGl2ZSBpbnRlZ2VyLicpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnF1ZXJ5UGFyYW1zXy5oYXNMaW1pdCgpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1F1ZXJ5LmxpbWl0VG9MYXN0OiBMaW1pdCB3YXMgYWxyZWFkeSBzZXQgKGJ5IGFub3RoZXIgY2FsbCB0byBsaW1pdCwgJyArXG4gICAgICAgICAgICAgICAgJ2xpbWl0VG9GaXJzdCwgb3IgbGltaXRUb0xhc3QpLicpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgUXVlcnkodGhpcy5yZXBvLCB0aGlzLnBhdGgsIHRoaXMucXVlcnlQYXJhbXNfLmxpbWl0VG9MYXN0KGxpbWl0KSwgdGhpcy5vcmRlckJ5Q2FsbGVkXyk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHaXZlbiBhIGNoaWxkIHBhdGgsIHJldHVybiBhIG5ldyBxdWVyeSBvcmRlcmVkIGJ5IHRoZSBzcGVjaWZpZWQgZ3JhbmRjaGlsZCBwYXRoLlxuICAgICAqIEBwYXJhbSB7IXN0cmluZ30gcGF0aFxuICAgICAqIEByZXR1cm4geyFRdWVyeX1cbiAgICAgKi9cbiAgICBRdWVyeS5wcm90b3R5cGUub3JkZXJCeUNoaWxkID0gZnVuY3Rpb24gKHBhdGgpIHtcbiAgICAgICAgdXRpbF8zLnZhbGlkYXRlQXJnQ291bnQoJ1F1ZXJ5Lm9yZGVyQnlDaGlsZCcsIDEsIDEsIGFyZ3VtZW50cy5sZW5ndGgpO1xuICAgICAgICBpZiAocGF0aCA9PT0gJyRrZXknKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1F1ZXJ5Lm9yZGVyQnlDaGlsZDogXCIka2V5XCIgaXMgaW52YWxpZC4gIFVzZSBRdWVyeS5vcmRlckJ5S2V5KCkgaW5zdGVhZC4nKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChwYXRoID09PSAnJHByaW9yaXR5Jykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdRdWVyeS5vcmRlckJ5Q2hpbGQ6IFwiJHByaW9yaXR5XCIgaXMgaW52YWxpZC4gIFVzZSBRdWVyeS5vcmRlckJ5UHJpb3JpdHkoKSBpbnN0ZWFkLicpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHBhdGggPT09ICckdmFsdWUnKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1F1ZXJ5Lm9yZGVyQnlDaGlsZDogXCIkdmFsdWVcIiBpcyBpbnZhbGlkLiAgVXNlIFF1ZXJ5Lm9yZGVyQnlWYWx1ZSgpIGluc3RlYWQuJyk7XG4gICAgICAgIH1cbiAgICAgICAgdmFsaWRhdGlvbl8xLnZhbGlkYXRlUGF0aFN0cmluZygnUXVlcnkub3JkZXJCeUNoaWxkJywgMSwgcGF0aCwgZmFsc2UpO1xuICAgICAgICB0aGlzLnZhbGlkYXRlTm9QcmV2aW91c09yZGVyQnlDYWxsXygnUXVlcnkub3JkZXJCeUNoaWxkJyk7XG4gICAgICAgIHZhciBwYXJzZWRQYXRoID0gbmV3IFBhdGhfMS5QYXRoKHBhdGgpO1xuICAgICAgICBpZiAocGFyc2VkUGF0aC5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUXVlcnkub3JkZXJCeUNoaWxkOiBjYW5ub3QgcGFzcyBpbiBlbXB0eSBwYXRoLiAgVXNlIFF1ZXJ5Lm9yZGVyQnlWYWx1ZSgpIGluc3RlYWQuJyk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGluZGV4ID0gbmV3IFBhdGhJbmRleF8xLlBhdGhJbmRleChwYXJzZWRQYXRoKTtcbiAgICAgICAgdmFyIG5ld1BhcmFtcyA9IHRoaXMucXVlcnlQYXJhbXNfLm9yZGVyQnkoaW5kZXgpO1xuICAgICAgICBRdWVyeS52YWxpZGF0ZVF1ZXJ5RW5kcG9pbnRzXyhuZXdQYXJhbXMpO1xuICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5KHRoaXMucmVwbywgdGhpcy5wYXRoLCBuZXdQYXJhbXMsIC8qb3JkZXJCeUNhbGxlZD0qLyB0cnVlKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJldHVybiBhIG5ldyBxdWVyeSBvcmRlcmVkIGJ5IHRoZSBLZXlJbmRleFxuICAgICAqIEByZXR1cm4geyFRdWVyeX1cbiAgICAgKi9cbiAgICBRdWVyeS5wcm90b3R5cGUub3JkZXJCeUtleSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdXRpbF8zLnZhbGlkYXRlQXJnQ291bnQoJ1F1ZXJ5Lm9yZGVyQnlLZXknLCAwLCAwLCBhcmd1bWVudHMubGVuZ3RoKTtcbiAgICAgICAgdGhpcy52YWxpZGF0ZU5vUHJldmlvdXNPcmRlckJ5Q2FsbF8oJ1F1ZXJ5Lm9yZGVyQnlLZXknKTtcbiAgICAgICAgdmFyIG5ld1BhcmFtcyA9IHRoaXMucXVlcnlQYXJhbXNfLm9yZGVyQnkoS2V5SW5kZXhfMS5LRVlfSU5ERVgpO1xuICAgICAgICBRdWVyeS52YWxpZGF0ZVF1ZXJ5RW5kcG9pbnRzXyhuZXdQYXJhbXMpO1xuICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5KHRoaXMucmVwbywgdGhpcy5wYXRoLCBuZXdQYXJhbXMsIC8qb3JkZXJCeUNhbGxlZD0qLyB0cnVlKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJldHVybiBhIG5ldyBxdWVyeSBvcmRlcmVkIGJ5IHRoZSBQcmlvcml0eUluZGV4XG4gICAgICogQHJldHVybiB7IVF1ZXJ5fVxuICAgICAqL1xuICAgIFF1ZXJ5LnByb3RvdHlwZS5vcmRlckJ5UHJpb3JpdHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHV0aWxfMy52YWxpZGF0ZUFyZ0NvdW50KCdRdWVyeS5vcmRlckJ5UHJpb3JpdHknLCAwLCAwLCBhcmd1bWVudHMubGVuZ3RoKTtcbiAgICAgICAgdGhpcy52YWxpZGF0ZU5vUHJldmlvdXNPcmRlckJ5Q2FsbF8oJ1F1ZXJ5Lm9yZGVyQnlQcmlvcml0eScpO1xuICAgICAgICB2YXIgbmV3UGFyYW1zID0gdGhpcy5xdWVyeVBhcmFtc18ub3JkZXJCeShQcmlvcml0eUluZGV4XzEuUFJJT1JJVFlfSU5ERVgpO1xuICAgICAgICBRdWVyeS52YWxpZGF0ZVF1ZXJ5RW5kcG9pbnRzXyhuZXdQYXJhbXMpO1xuICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5KHRoaXMucmVwbywgdGhpcy5wYXRoLCBuZXdQYXJhbXMsIC8qb3JkZXJCeUNhbGxlZD0qLyB0cnVlKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJldHVybiBhIG5ldyBxdWVyeSBvcmRlcmVkIGJ5IHRoZSBWYWx1ZUluZGV4XG4gICAgICogQHJldHVybiB7IVF1ZXJ5fVxuICAgICAqL1xuICAgIFF1ZXJ5LnByb3RvdHlwZS5vcmRlckJ5VmFsdWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHV0aWxfMy52YWxpZGF0ZUFyZ0NvdW50KCdRdWVyeS5vcmRlckJ5VmFsdWUnLCAwLCAwLCBhcmd1bWVudHMubGVuZ3RoKTtcbiAgICAgICAgdGhpcy52YWxpZGF0ZU5vUHJldmlvdXNPcmRlckJ5Q2FsbF8oJ1F1ZXJ5Lm9yZGVyQnlWYWx1ZScpO1xuICAgICAgICB2YXIgbmV3UGFyYW1zID0gdGhpcy5xdWVyeVBhcmFtc18ub3JkZXJCeShWYWx1ZUluZGV4XzEuVkFMVUVfSU5ERVgpO1xuICAgICAgICBRdWVyeS52YWxpZGF0ZVF1ZXJ5RW5kcG9pbnRzXyhuZXdQYXJhbXMpO1xuICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5KHRoaXMucmVwbywgdGhpcy5wYXRoLCBuZXdQYXJhbXMsIC8qb3JkZXJCeUNhbGxlZD0qLyB0cnVlKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfHN0cmluZ3xib29sZWFufG51bGx9IHZhbHVlXG4gICAgICogQHBhcmFtIHs/c3RyaW5nPX0gbmFtZVxuICAgICAqIEByZXR1cm4geyFRdWVyeX1cbiAgICAgKi9cbiAgICBRdWVyeS5wcm90b3R5cGUuc3RhcnRBdCA9IGZ1bmN0aW9uICh2YWx1ZSwgbmFtZSkge1xuICAgICAgICBpZiAodmFsdWUgPT09IHZvaWQgMCkgeyB2YWx1ZSA9IG51bGw7IH1cbiAgICAgICAgdXRpbF8zLnZhbGlkYXRlQXJnQ291bnQoJ1F1ZXJ5LnN0YXJ0QXQnLCAwLCAyLCBhcmd1bWVudHMubGVuZ3RoKTtcbiAgICAgICAgdmFsaWRhdGlvbl8xLnZhbGlkYXRlRmlyZWJhc2VEYXRhQXJnKCdRdWVyeS5zdGFydEF0JywgMSwgdmFsdWUsIHRoaXMucGF0aCwgdHJ1ZSk7XG4gICAgICAgIHZhbGlkYXRpb25fMS52YWxpZGF0ZUtleSgnUXVlcnkuc3RhcnRBdCcsIDIsIG5hbWUsIHRydWUpO1xuICAgICAgICB2YXIgbmV3UGFyYW1zID0gdGhpcy5xdWVyeVBhcmFtc18uc3RhcnRBdCh2YWx1ZSwgbmFtZSk7XG4gICAgICAgIFF1ZXJ5LnZhbGlkYXRlTGltaXRfKG5ld1BhcmFtcyk7XG4gICAgICAgIFF1ZXJ5LnZhbGlkYXRlUXVlcnlFbmRwb2ludHNfKG5ld1BhcmFtcyk7XG4gICAgICAgIGlmICh0aGlzLnF1ZXJ5UGFyYW1zXy5oYXNTdGFydCgpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1F1ZXJ5LnN0YXJ0QXQ6IFN0YXJ0aW5nIHBvaW50IHdhcyBhbHJlYWR5IHNldCAoYnkgYW5vdGhlciBjYWxsIHRvIHN0YXJ0QXQgJyArXG4gICAgICAgICAgICAgICAgJ29yIGVxdWFsVG8pLicpO1xuICAgICAgICB9XG4gICAgICAgIC8vIENhbGxpbmcgd2l0aCBubyBwYXJhbXMgdGVsbHMgdXMgdG8gc3RhcnQgYXQgdGhlIGJlZ2lubmluZy5cbiAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhbHVlID0gbnVsbDtcbiAgICAgICAgICAgIG5hbWUgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgUXVlcnkodGhpcy5yZXBvLCB0aGlzLnBhdGgsIG5ld1BhcmFtcywgdGhpcy5vcmRlckJ5Q2FsbGVkXyk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge251bWJlcnxzdHJpbmd8Ym9vbGVhbnxudWxsfSB2YWx1ZVxuICAgICAqIEBwYXJhbSB7P3N0cmluZz19IG5hbWVcbiAgICAgKiBAcmV0dXJuIHshUXVlcnl9XG4gICAgICovXG4gICAgUXVlcnkucHJvdG90eXBlLmVuZEF0ID0gZnVuY3Rpb24gKHZhbHVlLCBuYW1lKSB7XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gdm9pZCAwKSB7IHZhbHVlID0gbnVsbDsgfVxuICAgICAgICB1dGlsXzMudmFsaWRhdGVBcmdDb3VudCgnUXVlcnkuZW5kQXQnLCAwLCAyLCBhcmd1bWVudHMubGVuZ3RoKTtcbiAgICAgICAgdmFsaWRhdGlvbl8xLnZhbGlkYXRlRmlyZWJhc2VEYXRhQXJnKCdRdWVyeS5lbmRBdCcsIDEsIHZhbHVlLCB0aGlzLnBhdGgsIHRydWUpO1xuICAgICAgICB2YWxpZGF0aW9uXzEudmFsaWRhdGVLZXkoJ1F1ZXJ5LmVuZEF0JywgMiwgbmFtZSwgdHJ1ZSk7XG4gICAgICAgIHZhciBuZXdQYXJhbXMgPSB0aGlzLnF1ZXJ5UGFyYW1zXy5lbmRBdCh2YWx1ZSwgbmFtZSk7XG4gICAgICAgIFF1ZXJ5LnZhbGlkYXRlTGltaXRfKG5ld1BhcmFtcyk7XG4gICAgICAgIFF1ZXJ5LnZhbGlkYXRlUXVlcnlFbmRwb2ludHNfKG5ld1BhcmFtcyk7XG4gICAgICAgIGlmICh0aGlzLnF1ZXJ5UGFyYW1zXy5oYXNFbmQoKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdRdWVyeS5lbmRBdDogRW5kaW5nIHBvaW50IHdhcyBhbHJlYWR5IHNldCAoYnkgYW5vdGhlciBjYWxsIHRvIGVuZEF0IG9yICcgK1xuICAgICAgICAgICAgICAgICdlcXVhbFRvKS4nKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5KHRoaXMucmVwbywgdGhpcy5wYXRoLCBuZXdQYXJhbXMsIHRoaXMub3JkZXJCeUNhbGxlZF8pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogTG9hZCB0aGUgc2VsZWN0aW9uIG9mIGNoaWxkcmVuIHdpdGggZXhhY3RseSB0aGUgc3BlY2lmaWVkIHZhbHVlLCBhbmQsIG9wdGlvbmFsbHksXG4gICAgICogdGhlIHNwZWNpZmllZCBuYW1lLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfHN0cmluZ3xib29sZWFufG51bGx9IHZhbHVlXG4gICAgICogQHBhcmFtIHtzdHJpbmc9fSBuYW1lXG4gICAgICogQHJldHVybiB7IVF1ZXJ5fVxuICAgICAqL1xuICAgIFF1ZXJ5LnByb3RvdHlwZS5lcXVhbFRvID0gZnVuY3Rpb24gKHZhbHVlLCBuYW1lKSB7XG4gICAgICAgIHV0aWxfMy52YWxpZGF0ZUFyZ0NvdW50KCdRdWVyeS5lcXVhbFRvJywgMSwgMiwgYXJndW1lbnRzLmxlbmd0aCk7XG4gICAgICAgIHZhbGlkYXRpb25fMS52YWxpZGF0ZUZpcmViYXNlRGF0YUFyZygnUXVlcnkuZXF1YWxUbycsIDEsIHZhbHVlLCB0aGlzLnBhdGgsIGZhbHNlKTtcbiAgICAgICAgdmFsaWRhdGlvbl8xLnZhbGlkYXRlS2V5KCdRdWVyeS5lcXVhbFRvJywgMiwgbmFtZSwgdHJ1ZSk7XG4gICAgICAgIGlmICh0aGlzLnF1ZXJ5UGFyYW1zXy5oYXNTdGFydCgpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1F1ZXJ5LmVxdWFsVG86IFN0YXJ0aW5nIHBvaW50IHdhcyBhbHJlYWR5IHNldCAoYnkgYW5vdGhlciBjYWxsIHRvIHN0YXJ0QXQgb3IgJyArXG4gICAgICAgICAgICAgICAgJ2VxdWFsVG8pLicpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnF1ZXJ5UGFyYW1zXy5oYXNFbmQoKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdRdWVyeS5lcXVhbFRvOiBFbmRpbmcgcG9pbnQgd2FzIGFscmVhZHkgc2V0IChieSBhbm90aGVyIGNhbGwgdG8gZW5kQXQgb3IgJyArXG4gICAgICAgICAgICAgICAgJ2VxdWFsVG8pLicpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnN0YXJ0QXQodmFsdWUsIG5hbWUpLmVuZEF0KHZhbHVlLCBuYW1lKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4geyFzdHJpbmd9IFVSTCBmb3IgdGhpcyBsb2NhdGlvbi5cbiAgICAgKi9cbiAgICBRdWVyeS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHV0aWxfMy52YWxpZGF0ZUFyZ0NvdW50KCdRdWVyeS50b1N0cmluZycsIDAsIDAsIGFyZ3VtZW50cy5sZW5ndGgpO1xuICAgICAgICByZXR1cm4gdGhpcy5yZXBvLnRvU3RyaW5nKCkgKyB0aGlzLnBhdGgudG9VcmxFbmNvZGVkU3RyaW5nKCk7XG4gICAgfTtcbiAgICAvLyBEbyBub3QgY3JlYXRlIHB1YmxpYyBkb2N1bWVudGF0aW9uLiBUaGlzIGlzIGludGVuZGVkIHRvIG1ha2UgSlNPTiBzZXJpYWxpemF0aW9uIHdvcmsgYnV0IGlzIG90aGVyd2lzZSB1bm5lY2Vzc2FyeVxuICAgIC8vIGZvciBlbmQtdXNlcnMuXG4gICAgUXVlcnkucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gQW4gb3B0aW9uYWwgc3BhY2VyIGFyZ3VtZW50IGlzIHVubmVjZXNzYXJ5IGZvciBhIHN0cmluZy5cbiAgICAgICAgdXRpbF8zLnZhbGlkYXRlQXJnQ291bnQoJ1F1ZXJ5LnRvSlNPTicsIDAsIDEsIGFyZ3VtZW50cy5sZW5ndGgpO1xuICAgICAgICByZXR1cm4gdGhpcy50b1N0cmluZygpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQW4gb2JqZWN0IHJlcHJlc2VudGF0aW9uIG9mIHRoZSBxdWVyeSBwYXJhbWV0ZXJzIHVzZWQgYnkgdGhpcyBRdWVyeS5cbiAgICAgKiBAcmV0dXJuIHshT2JqZWN0fVxuICAgICAqL1xuICAgIFF1ZXJ5LnByb3RvdHlwZS5xdWVyeU9iamVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucXVlcnlQYXJhbXNfLmdldFF1ZXJ5T2JqZWN0KCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHshc3RyaW5nfVxuICAgICAqL1xuICAgIFF1ZXJ5LnByb3RvdHlwZS5xdWVyeUlkZW50aWZpZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBvYmogPSB0aGlzLnF1ZXJ5T2JqZWN0KCk7XG4gICAgICAgIHZhciBpZCA9IHV0aWxfMi5PYmplY3RUb1VuaXF1ZUtleShvYmopO1xuICAgICAgICByZXR1cm4gaWQgPT09ICd7fScgPyAnZGVmYXVsdCcgOiBpZDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJldHVybiB0cnVlIGlmIHRoaXMgcXVlcnkgYW5kIHRoZSBwcm92aWRlZCBxdWVyeSBhcmUgZXF1aXZhbGVudDsgb3RoZXJ3aXNlLCByZXR1cm4gZmFsc2UuXG4gICAgICogQHBhcmFtIHtRdWVyeX0gb3RoZXJcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgICAqL1xuICAgIFF1ZXJ5LnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgICAgIHV0aWxfMy52YWxpZGF0ZUFyZ0NvdW50KCdRdWVyeS5pc0VxdWFsJywgMSwgMSwgYXJndW1lbnRzLmxlbmd0aCk7XG4gICAgICAgIGlmICghKG90aGVyIGluc3RhbmNlb2YgUXVlcnkpKSB7XG4gICAgICAgICAgICB2YXIgZXJyb3IgPSAnUXVlcnkuaXNFcXVhbCBmYWlsZWQ6IEZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYW4gaW5zdGFuY2Ugb2YgZmlyZWJhc2UuZGF0YWJhc2UuUXVlcnkuJztcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvcik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNhbWVSZXBvID0gdGhpcy5yZXBvID09PSBvdGhlci5yZXBvO1xuICAgICAgICB2YXIgc2FtZVBhdGggPSB0aGlzLnBhdGguZXF1YWxzKG90aGVyLnBhdGgpO1xuICAgICAgICB2YXIgc2FtZVF1ZXJ5SWRlbnRpZmllciA9IHRoaXMucXVlcnlJZGVudGlmaWVyKCkgPT09IG90aGVyLnF1ZXJ5SWRlbnRpZmllcigpO1xuICAgICAgICByZXR1cm4gc2FtZVJlcG8gJiYgc2FtZVBhdGggJiYgc2FtZVF1ZXJ5SWRlbnRpZmllcjtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEhlbHBlciB1c2VkIGJ5IC5vbiBhbmQgLm9uY2UgdG8gZXh0cmFjdCB0aGUgY29udGV4dCBhbmQgb3IgY2FuY2VsIGFyZ3VtZW50cy5cbiAgICAgKiBAcGFyYW0geyFzdHJpbmd9IGZuTmFtZSBUaGUgZnVuY3Rpb24gbmFtZSAob24gb3Igb25jZSlcbiAgICAgKiBAcGFyYW0geyhmdW5jdGlvbihFcnJvcil8T2JqZWN0KT19IGNhbmNlbE9yQ29udGV4dFxuICAgICAqIEBwYXJhbSB7T2JqZWN0PX0gY29udGV4dFxuICAgICAqIEByZXR1cm4ge3tjYW5jZWw6ID9mdW5jdGlvbihFcnJvciksIGNvbnRleHQ6ID9PYmplY3R9fVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgUXVlcnkuZ2V0Q2FuY2VsQW5kQ29udGV4dEFyZ3NfID0gZnVuY3Rpb24gKGZuTmFtZSwgY2FuY2VsT3JDb250ZXh0LCBjb250ZXh0KSB7XG4gICAgICAgIHZhciByZXQgPSB7IGNhbmNlbDogbnVsbCwgY29udGV4dDogbnVsbCB9O1xuICAgICAgICBpZiAoY2FuY2VsT3JDb250ZXh0ICYmIGNvbnRleHQpIHtcbiAgICAgICAgICAgIHJldC5jYW5jZWwgPSBjYW5jZWxPckNvbnRleHQ7XG4gICAgICAgICAgICB1dGlsXzMudmFsaWRhdGVDYWxsYmFjayhmbk5hbWUsIDMsIHJldC5jYW5jZWwsIHRydWUpO1xuICAgICAgICAgICAgcmV0LmNvbnRleHQgPSBjb250ZXh0O1xuICAgICAgICAgICAgdXRpbF8zLnZhbGlkYXRlQ29udGV4dE9iamVjdChmbk5hbWUsIDQsIHJldC5jb250ZXh0LCB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjYW5jZWxPckNvbnRleHQpIHtcbiAgICAgICAgICAgIC8vIHdlIGhhdmUgZWl0aGVyIGEgY2FuY2VsIGNhbGxiYWNrIG9yIGEgY29udGV4dC5cbiAgICAgICAgICAgIGlmICh0eXBlb2YgY2FuY2VsT3JDb250ZXh0ID09PSAnb2JqZWN0JyAmJiBjYW5jZWxPckNvbnRleHQgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAvLyBpdCdzIGEgY29udGV4dCFcbiAgICAgICAgICAgICAgICByZXQuY29udGV4dCA9IGNhbmNlbE9yQ29udGV4dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBjYW5jZWxPckNvbnRleHQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICByZXQuY2FuY2VsID0gY2FuY2VsT3JDb250ZXh0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKHV0aWxfMy5lcnJvclByZWZpeChmbk5hbWUsIDMsIHRydWUpICtcbiAgICAgICAgICAgICAgICAgICAgJyBtdXN0IGVpdGhlciBiZSBhIGNhbmNlbCBjYWxsYmFjayBvciBhIGNvbnRleHQgb2JqZWN0LicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUXVlcnkucHJvdG90eXBlLCBcInJlZlwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UmVmKCk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiBRdWVyeTtcbn0oKSk7XG5leHBvcnRzLlF1ZXJ5ID0gUXVlcnk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVF1ZXJ5LmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xudmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgb25EaXNjb25uZWN0XzEgPSByZXF1aXJlKFwiLi9vbkRpc2Nvbm5lY3RcIik7XG52YXIgVHJhbnNhY3Rpb25SZXN1bHRfMSA9IHJlcXVpcmUoXCIuL1RyYW5zYWN0aW9uUmVzdWx0XCIpO1xudmFyIHV0aWxfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3V0aWwvdXRpbFwiKTtcbnZhciBOZXh0UHVzaElkXzEgPSByZXF1aXJlKFwiLi4vY29yZS91dGlsL05leHRQdXNoSWRcIik7XG52YXIgUXVlcnlfMSA9IHJlcXVpcmUoXCIuL1F1ZXJ5XCIpO1xudmFyIFJlcG9fMSA9IHJlcXVpcmUoXCIuLi9jb3JlL1JlcG9cIik7XG52YXIgUGF0aF8xID0gcmVxdWlyZShcIi4uL2NvcmUvdXRpbC9QYXRoXCIpO1xudmFyIFF1ZXJ5UGFyYW1zXzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3L1F1ZXJ5UGFyYW1zXCIpO1xudmFyIHZhbGlkYXRpb25fMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3V0aWwvdmFsaWRhdGlvblwiKTtcbnZhciB1dGlsXzIgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG52YXIgdXRpbF8zID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xudmFyIFN5bmNQb2ludF8xID0gcmVxdWlyZShcIi4uL2NvcmUvU3luY1BvaW50XCIpO1xudmFyIFJlZmVyZW5jZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoUmVmZXJlbmNlLCBfc3VwZXIpO1xuICAgIC8qKlxuICAgICAqIENhbGwgb3B0aW9uczpcbiAgICAgKiAgIG5ldyBSZWZlcmVuY2UoUmVwbywgUGF0aCkgb3JcbiAgICAgKiAgIG5ldyBSZWZlcmVuY2UodXJsOiBzdHJpbmcsIHN0cmluZ3xSZXBvTWFuYWdlcilcbiAgICAgKlxuICAgICAqIEV4dGVybmFsbHkgLSB0aGlzIGlzIHRoZSBmaXJlYmFzZS5kYXRhYmFzZS5SZWZlcmVuY2UgdHlwZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7IVJlcG99IHJlcG9cbiAgICAgKiBAcGFyYW0geyghUGF0aCl9IHBhdGhcbiAgICAgKiBAZXh0ZW5kcyB7UXVlcnl9XG4gICAgICovXG4gICAgZnVuY3Rpb24gUmVmZXJlbmNlKHJlcG8sIHBhdGgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCEocmVwbyBpbnN0YW5jZW9mIFJlcG9fMS5SZXBvKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCduZXcgUmVmZXJlbmNlKCkgbm8gbG9uZ2VyIHN1cHBvcnRlZCAtIHVzZSBhcHAuZGF0YWJhc2UoKS4nKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBjYWxsIFF1ZXJ5J3MgY29uc3RydWN0b3IsIHBhc3NpbmcgaW4gdGhlIHJlcG8gYW5kIHBhdGguXG4gICAgICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcmVwbywgcGF0aCwgUXVlcnlQYXJhbXNfMS5RdWVyeVBhcmFtcy5ERUZBVUxULCBmYWxzZSkgfHwgdGhpcztcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICAvKiogQHJldHVybiB7P3N0cmluZ30gKi9cbiAgICBSZWZlcmVuY2UucHJvdG90eXBlLmdldEtleSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdXRpbF8yLnZhbGlkYXRlQXJnQ291bnQoJ1JlZmVyZW5jZS5rZXknLCAwLCAwLCBhcmd1bWVudHMubGVuZ3RoKTtcbiAgICAgICAgaWYgKHRoaXMucGF0aC5pc0VtcHR5KCkpXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGF0aC5nZXRCYWNrKCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyEoc3RyaW5nfFBhdGgpfSBwYXRoU3RyaW5nXG4gICAgICogQHJldHVybiB7IVJlZmVyZW5jZX1cbiAgICAgKi9cbiAgICBSZWZlcmVuY2UucHJvdG90eXBlLmNoaWxkID0gZnVuY3Rpb24gKHBhdGhTdHJpbmcpIHtcbiAgICAgICAgdXRpbF8yLnZhbGlkYXRlQXJnQ291bnQoJ1JlZmVyZW5jZS5jaGlsZCcsIDEsIDEsIGFyZ3VtZW50cy5sZW5ndGgpO1xuICAgICAgICBpZiAodHlwZW9mIHBhdGhTdHJpbmcgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICBwYXRoU3RyaW5nID0gU3RyaW5nKHBhdGhTdHJpbmcpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCEocGF0aFN0cmluZyBpbnN0YW5jZW9mIFBhdGhfMS5QYXRoKSkge1xuICAgICAgICAgICAgaWYgKHRoaXMucGF0aC5nZXRGcm9udCgpID09PSBudWxsKVxuICAgICAgICAgICAgICAgIHZhbGlkYXRpb25fMS52YWxpZGF0ZVJvb3RQYXRoU3RyaW5nKCdSZWZlcmVuY2UuY2hpbGQnLCAxLCBwYXRoU3RyaW5nLCBmYWxzZSk7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgdmFsaWRhdGlvbl8xLnZhbGlkYXRlUGF0aFN0cmluZygnUmVmZXJlbmNlLmNoaWxkJywgMSwgcGF0aFN0cmluZywgZmFsc2UpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgUmVmZXJlbmNlKHRoaXMucmVwbywgdGhpcy5wYXRoLmNoaWxkKHBhdGhTdHJpbmcpKTtcbiAgICB9O1xuICAgIC8qKiBAcmV0dXJuIHs/UmVmZXJlbmNlfSAqL1xuICAgIFJlZmVyZW5jZS5wcm90b3R5cGUuZ2V0UGFyZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB1dGlsXzIudmFsaWRhdGVBcmdDb3VudCgnUmVmZXJlbmNlLnBhcmVudCcsIDAsIDAsIGFyZ3VtZW50cy5sZW5ndGgpO1xuICAgICAgICB2YXIgcGFyZW50UGF0aCA9IHRoaXMucGF0aC5wYXJlbnQoKTtcbiAgICAgICAgcmV0dXJuIHBhcmVudFBhdGggPT09IG51bGwgPyBudWxsIDogbmV3IFJlZmVyZW5jZSh0aGlzLnJlcG8sIHBhcmVudFBhdGgpO1xuICAgIH07XG4gICAgLyoqIEByZXR1cm4geyFSZWZlcmVuY2V9ICovXG4gICAgUmVmZXJlbmNlLnByb3RvdHlwZS5nZXRSb290ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB1dGlsXzIudmFsaWRhdGVBcmdDb3VudCgnUmVmZXJlbmNlLnJvb3QnLCAwLCAwLCBhcmd1bWVudHMubGVuZ3RoKTtcbiAgICAgICAgdmFyIHJlZiA9IHRoaXM7XG4gICAgICAgIHdoaWxlIChyZWYuZ2V0UGFyZW50KCkgIT09IG51bGwpIHtcbiAgICAgICAgICAgIHJlZiA9IHJlZi5nZXRQYXJlbnQoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVmO1xuICAgIH07XG4gICAgLyoqIEByZXR1cm4geyFEYXRhYmFzZX0gKi9cbiAgICBSZWZlcmVuY2UucHJvdG90eXBlLmRhdGFiYXNlUHJvcCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVwby5kYXRhYmFzZTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7Kn0gbmV3VmFsXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbig/RXJyb3IpPX0gb25Db21wbGV0ZVxuICAgICAqIEByZXR1cm4geyFQcm9taXNlfVxuICAgICAqL1xuICAgIFJlZmVyZW5jZS5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKG5ld1ZhbCwgb25Db21wbGV0ZSkge1xuICAgICAgICB1dGlsXzIudmFsaWRhdGVBcmdDb3VudCgnUmVmZXJlbmNlLnNldCcsIDEsIDIsIGFyZ3VtZW50cy5sZW5ndGgpO1xuICAgICAgICB2YWxpZGF0aW9uXzEudmFsaWRhdGVXcml0YWJsZVBhdGgoJ1JlZmVyZW5jZS5zZXQnLCB0aGlzLnBhdGgpO1xuICAgICAgICB2YWxpZGF0aW9uXzEudmFsaWRhdGVGaXJlYmFzZURhdGFBcmcoJ1JlZmVyZW5jZS5zZXQnLCAxLCBuZXdWYWwsIHRoaXMucGF0aCwgZmFsc2UpO1xuICAgICAgICB1dGlsXzIudmFsaWRhdGVDYWxsYmFjaygnUmVmZXJlbmNlLnNldCcsIDIsIG9uQ29tcGxldGUsIHRydWUpO1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSBuZXcgdXRpbF8zLkRlZmVycmVkKCk7XG4gICAgICAgIHRoaXMucmVwby5zZXRXaXRoUHJpb3JpdHkodGhpcy5wYXRoLCBuZXdWYWwsIFxuICAgICAgICAvKnByaW9yaXR5PSovIG51bGwsIGRlZmVycmVkLndyYXBDYWxsYmFjayhvbkNvbXBsZXRlKSk7XG4gICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshT2JqZWN0fSBvYmplY3RUb01lcmdlXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbig/RXJyb3IpPX0gb25Db21wbGV0ZVxuICAgICAqIEByZXR1cm4geyFQcm9taXNlfVxuICAgICAqL1xuICAgIFJlZmVyZW5jZS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKG9iamVjdFRvTWVyZ2UsIG9uQ29tcGxldGUpIHtcbiAgICAgICAgdXRpbF8yLnZhbGlkYXRlQXJnQ291bnQoJ1JlZmVyZW5jZS51cGRhdGUnLCAxLCAyLCBhcmd1bWVudHMubGVuZ3RoKTtcbiAgICAgICAgdmFsaWRhdGlvbl8xLnZhbGlkYXRlV3JpdGFibGVQYXRoKCdSZWZlcmVuY2UudXBkYXRlJywgdGhpcy5wYXRoKTtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkob2JqZWN0VG9NZXJnZSkpIHtcbiAgICAgICAgICAgIHZhciBuZXdPYmplY3RUb01lcmdlID0ge307XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9iamVjdFRvTWVyZ2UubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgICAgICBuZXdPYmplY3RUb01lcmdlWycnICsgaV0gPSBvYmplY3RUb01lcmdlW2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb2JqZWN0VG9NZXJnZSA9IG5ld09iamVjdFRvTWVyZ2U7XG4gICAgICAgICAgICB1dGlsXzEud2FybignUGFzc2luZyBhbiBBcnJheSB0byBGaXJlYmFzZS51cGRhdGUoKSBpcyBkZXByZWNhdGVkLiAnICtcbiAgICAgICAgICAgICAgICAnVXNlIHNldCgpIGlmIHlvdSB3YW50IHRvIG92ZXJ3cml0ZSB0aGUgZXhpc3RpbmcgZGF0YSwgb3IgJyArXG4gICAgICAgICAgICAgICAgJ2FuIE9iamVjdCB3aXRoIGludGVnZXIga2V5cyBpZiB5b3UgcmVhbGx5IGRvIHdhbnQgdG8gJyArXG4gICAgICAgICAgICAgICAgJ29ubHkgdXBkYXRlIHNvbWUgb2YgdGhlIGNoaWxkcmVuLicpO1xuICAgICAgICB9XG4gICAgICAgIHZhbGlkYXRpb25fMS52YWxpZGF0ZUZpcmViYXNlTWVyZ2VEYXRhQXJnKCdSZWZlcmVuY2UudXBkYXRlJywgMSwgb2JqZWN0VG9NZXJnZSwgdGhpcy5wYXRoLCBmYWxzZSk7XG4gICAgICAgIHV0aWxfMi52YWxpZGF0ZUNhbGxiYWNrKCdSZWZlcmVuY2UudXBkYXRlJywgMiwgb25Db21wbGV0ZSwgdHJ1ZSk7XG4gICAgICAgIHZhciBkZWZlcnJlZCA9IG5ldyB1dGlsXzMuRGVmZXJyZWQoKTtcbiAgICAgICAgdGhpcy5yZXBvLnVwZGF0ZSh0aGlzLnBhdGgsIG9iamVjdFRvTWVyZ2UsIGRlZmVycmVkLndyYXBDYWxsYmFjayhvbkNvbXBsZXRlKSk7XG4gICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHsqfSBuZXdWYWxcbiAgICAgKiBAcGFyYW0ge3N0cmluZ3xudW1iZXJ8bnVsbH0gbmV3UHJpb3JpdHlcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKD9FcnJvcik9fSBvbkNvbXBsZXRlXG4gICAgICogQHJldHVybiB7IVByb21pc2V9XG4gICAgICovXG4gICAgUmVmZXJlbmNlLnByb3RvdHlwZS5zZXRXaXRoUHJpb3JpdHkgPSBmdW5jdGlvbiAobmV3VmFsLCBuZXdQcmlvcml0eSwgb25Db21wbGV0ZSkge1xuICAgICAgICB1dGlsXzIudmFsaWRhdGVBcmdDb3VudCgnUmVmZXJlbmNlLnNldFdpdGhQcmlvcml0eScsIDIsIDMsIGFyZ3VtZW50cy5sZW5ndGgpO1xuICAgICAgICB2YWxpZGF0aW9uXzEudmFsaWRhdGVXcml0YWJsZVBhdGgoJ1JlZmVyZW5jZS5zZXRXaXRoUHJpb3JpdHknLCB0aGlzLnBhdGgpO1xuICAgICAgICB2YWxpZGF0aW9uXzEudmFsaWRhdGVGaXJlYmFzZURhdGFBcmcoJ1JlZmVyZW5jZS5zZXRXaXRoUHJpb3JpdHknLCAxLCBuZXdWYWwsIHRoaXMucGF0aCwgZmFsc2UpO1xuICAgICAgICB2YWxpZGF0aW9uXzEudmFsaWRhdGVQcmlvcml0eSgnUmVmZXJlbmNlLnNldFdpdGhQcmlvcml0eScsIDIsIG5ld1ByaW9yaXR5LCBmYWxzZSk7XG4gICAgICAgIHV0aWxfMi52YWxpZGF0ZUNhbGxiYWNrKCdSZWZlcmVuY2Uuc2V0V2l0aFByaW9yaXR5JywgMywgb25Db21wbGV0ZSwgdHJ1ZSk7XG4gICAgICAgIGlmICh0aGlzLmdldEtleSgpID09PSAnLmxlbmd0aCcgfHwgdGhpcy5nZXRLZXkoKSA9PT0gJy5rZXlzJylcbiAgICAgICAgICAgIHRocm93ICdSZWZlcmVuY2Uuc2V0V2l0aFByaW9yaXR5IGZhaWxlZDogJyArXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRLZXkoKSArXG4gICAgICAgICAgICAgICAgJyBpcyBhIHJlYWQtb25seSBvYmplY3QuJztcbiAgICAgICAgdmFyIGRlZmVycmVkID0gbmV3IHV0aWxfMy5EZWZlcnJlZCgpO1xuICAgICAgICB0aGlzLnJlcG8uc2V0V2l0aFByaW9yaXR5KHRoaXMucGF0aCwgbmV3VmFsLCBuZXdQcmlvcml0eSwgZGVmZXJyZWQud3JhcENhbGxiYWNrKG9uQ29tcGxldGUpKTtcbiAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKD9FcnJvcik9fSBvbkNvbXBsZXRlXG4gICAgICogQHJldHVybiB7IVByb21pc2V9XG4gICAgICovXG4gICAgUmVmZXJlbmNlLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAob25Db21wbGV0ZSkge1xuICAgICAgICB1dGlsXzIudmFsaWRhdGVBcmdDb3VudCgnUmVmZXJlbmNlLnJlbW92ZScsIDAsIDEsIGFyZ3VtZW50cy5sZW5ndGgpO1xuICAgICAgICB2YWxpZGF0aW9uXzEudmFsaWRhdGVXcml0YWJsZVBhdGgoJ1JlZmVyZW5jZS5yZW1vdmUnLCB0aGlzLnBhdGgpO1xuICAgICAgICB1dGlsXzIudmFsaWRhdGVDYWxsYmFjaygnUmVmZXJlbmNlLnJlbW92ZScsIDEsIG9uQ29tcGxldGUsIHRydWUpO1xuICAgICAgICByZXR1cm4gdGhpcy5zZXQobnVsbCwgb25Db21wbGV0ZSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKCopOip9IHRyYW5zYWN0aW9uVXBkYXRlXG4gICAgICogQHBhcmFtIHsoZnVuY3Rpb24oP0Vycm9yLCBib29sZWFuLCA/RGF0YVNuYXBzaG90KSk9fSBvbkNvbXBsZXRlXG4gICAgICogQHBhcmFtIHtib29sZWFuPX0gYXBwbHlMb2NhbGx5XG4gICAgICogQHJldHVybiB7IVByb21pc2V9XG4gICAgICovXG4gICAgUmVmZXJlbmNlLnByb3RvdHlwZS50cmFuc2FjdGlvbiA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvblVwZGF0ZSwgb25Db21wbGV0ZSwgYXBwbHlMb2NhbGx5KSB7XG4gICAgICAgIHV0aWxfMi52YWxpZGF0ZUFyZ0NvdW50KCdSZWZlcmVuY2UudHJhbnNhY3Rpb24nLCAxLCAzLCBhcmd1bWVudHMubGVuZ3RoKTtcbiAgICAgICAgdmFsaWRhdGlvbl8xLnZhbGlkYXRlV3JpdGFibGVQYXRoKCdSZWZlcmVuY2UudHJhbnNhY3Rpb24nLCB0aGlzLnBhdGgpO1xuICAgICAgICB1dGlsXzIudmFsaWRhdGVDYWxsYmFjaygnUmVmZXJlbmNlLnRyYW5zYWN0aW9uJywgMSwgdHJhbnNhY3Rpb25VcGRhdGUsIGZhbHNlKTtcbiAgICAgICAgdXRpbF8yLnZhbGlkYXRlQ2FsbGJhY2soJ1JlZmVyZW5jZS50cmFuc2FjdGlvbicsIDIsIG9uQ29tcGxldGUsIHRydWUpO1xuICAgICAgICAvLyBOT1RFOiBhcHBseUxvY2FsbHkgaXMgYW4gaW50ZXJuYWwtb25seSBvcHRpb24gZm9yIG5vdy4gIFdlIG5lZWQgdG8gZGVjaWRlIGlmIHdlIHdhbnQgdG8ga2VlcCBpdCBhbmQgaG93XG4gICAgICAgIC8vIHRvIGV4cG9zZSBpdC5cbiAgICAgICAgdmFsaWRhdGlvbl8xLnZhbGlkYXRlQm9vbGVhbignUmVmZXJlbmNlLnRyYW5zYWN0aW9uJywgMywgYXBwbHlMb2NhbGx5LCB0cnVlKTtcbiAgICAgICAgaWYgKHRoaXMuZ2V0S2V5KCkgPT09ICcubGVuZ3RoJyB8fCB0aGlzLmdldEtleSgpID09PSAnLmtleXMnKVxuICAgICAgICAgICAgdGhyb3cgJ1JlZmVyZW5jZS50cmFuc2FjdGlvbiBmYWlsZWQ6ICcgK1xuICAgICAgICAgICAgICAgIHRoaXMuZ2V0S2V5KCkgK1xuICAgICAgICAgICAgICAgICcgaXMgYSByZWFkLW9ubHkgb2JqZWN0Lic7XG4gICAgICAgIGlmIChhcHBseUxvY2FsbHkgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIGFwcGx5TG9jYWxseSA9IHRydWU7XG4gICAgICAgIHZhciBkZWZlcnJlZCA9IG5ldyB1dGlsXzMuRGVmZXJyZWQoKTtcbiAgICAgICAgaWYgKHR5cGVvZiBvbkNvbXBsZXRlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5wcm9taXNlLmNhdGNoKGZ1bmN0aW9uICgpIHsgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHByb21pc2VDb21wbGV0ZSA9IGZ1bmN0aW9uIChlcnJvciwgY29tbWl0dGVkLCBzbmFwc2hvdCkge1xuICAgICAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUobmV3IFRyYW5zYWN0aW9uUmVzdWx0XzEuVHJhbnNhY3Rpb25SZXN1bHQoY29tbWl0dGVkLCBzbmFwc2hvdCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGVvZiBvbkNvbXBsZXRlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgb25Db21wbGV0ZShlcnJvciwgY29tbWl0dGVkLCBzbmFwc2hvdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMucmVwby5zdGFydFRyYW5zYWN0aW9uKHRoaXMucGF0aCwgdHJhbnNhY3Rpb25VcGRhdGUsIHByb21pc2VDb21wbGV0ZSwgYXBwbHlMb2NhbGx5KTtcbiAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge3N0cmluZ3xudW1iZXJ8bnVsbH0gcHJpb3JpdHlcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKD9FcnJvcik9fSBvbkNvbXBsZXRlXG4gICAgICogQHJldHVybiB7IVByb21pc2V9XG4gICAgICovXG4gICAgUmVmZXJlbmNlLnByb3RvdHlwZS5zZXRQcmlvcml0eSA9IGZ1bmN0aW9uIChwcmlvcml0eSwgb25Db21wbGV0ZSkge1xuICAgICAgICB1dGlsXzIudmFsaWRhdGVBcmdDb3VudCgnUmVmZXJlbmNlLnNldFByaW9yaXR5JywgMSwgMiwgYXJndW1lbnRzLmxlbmd0aCk7XG4gICAgICAgIHZhbGlkYXRpb25fMS52YWxpZGF0ZVdyaXRhYmxlUGF0aCgnUmVmZXJlbmNlLnNldFByaW9yaXR5JywgdGhpcy5wYXRoKTtcbiAgICAgICAgdmFsaWRhdGlvbl8xLnZhbGlkYXRlUHJpb3JpdHkoJ1JlZmVyZW5jZS5zZXRQcmlvcml0eScsIDEsIHByaW9yaXR5LCBmYWxzZSk7XG4gICAgICAgIHV0aWxfMi52YWxpZGF0ZUNhbGxiYWNrKCdSZWZlcmVuY2Uuc2V0UHJpb3JpdHknLCAyLCBvbkNvbXBsZXRlLCB0cnVlKTtcbiAgICAgICAgdmFyIGRlZmVycmVkID0gbmV3IHV0aWxfMy5EZWZlcnJlZCgpO1xuICAgICAgICB0aGlzLnJlcG8uc2V0V2l0aFByaW9yaXR5KHRoaXMucGF0aC5jaGlsZCgnLnByaW9yaXR5JyksIHByaW9yaXR5LCBudWxsLCBkZWZlcnJlZC53cmFwQ2FsbGJhY2sob25Db21wbGV0ZSkpO1xuICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7Kj19IHZhbHVlXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbig/RXJyb3IpPX0gb25Db21wbGV0ZVxuICAgICAqIEByZXR1cm4geyFSZWZlcmVuY2V9XG4gICAgICovXG4gICAgUmVmZXJlbmNlLnByb3RvdHlwZS5wdXNoID0gZnVuY3Rpb24gKHZhbHVlLCBvbkNvbXBsZXRlKSB7XG4gICAgICAgIHV0aWxfMi52YWxpZGF0ZUFyZ0NvdW50KCdSZWZlcmVuY2UucHVzaCcsIDAsIDIsIGFyZ3VtZW50cy5sZW5ndGgpO1xuICAgICAgICB2YWxpZGF0aW9uXzEudmFsaWRhdGVXcml0YWJsZVBhdGgoJ1JlZmVyZW5jZS5wdXNoJywgdGhpcy5wYXRoKTtcbiAgICAgICAgdmFsaWRhdGlvbl8xLnZhbGlkYXRlRmlyZWJhc2VEYXRhQXJnKCdSZWZlcmVuY2UucHVzaCcsIDEsIHZhbHVlLCB0aGlzLnBhdGgsIHRydWUpO1xuICAgICAgICB1dGlsXzIudmFsaWRhdGVDYWxsYmFjaygnUmVmZXJlbmNlLnB1c2gnLCAyLCBvbkNvbXBsZXRlLCB0cnVlKTtcbiAgICAgICAgdmFyIG5vdyA9IHRoaXMucmVwby5zZXJ2ZXJUaW1lKCk7XG4gICAgICAgIHZhciBuYW1lID0gTmV4dFB1c2hJZF8xLm5leHRQdXNoSWQobm93KTtcbiAgICAgICAgLy8gcHVzaCgpIHJldHVybnMgYSBUaGVubmFibGVSZWZlcmVuY2Ugd2hvc2UgcHJvbWlzZSBpcyBmdWxmaWxsZWQgd2l0aCBhIHJlZ3VsYXIgUmVmZXJlbmNlLlxuICAgICAgICAvLyBXZSB1c2UgY2hpbGQoKSB0byBjcmVhdGUgaGFuZGxlcyB0byB0d28gZGlmZmVyZW50IHJlZmVyZW5jZXMuIFRoZSBmaXJzdCBpcyB0dXJuZWQgaW50byBhXG4gICAgICAgIC8vIFRoZW5uYWJsZVJlZmVyZW5jZSBiZWxvdyBieSBhZGRpbmcgdGhlbigpIGFuZCBjYXRjaCgpIG1ldGhvZHMgYW5kIGlzIHVzZWQgYXMgdGhlXG4gICAgICAgIC8vIHJldHVybiB2YWx1ZSBvZiBwdXNoKCkuIFRoZSBzZWNvbmQgcmVtYWlucyBhIHJlZ3VsYXIgUmVmZXJlbmNlIGFuZCBpcyB1c2VkIGFzIHRoZSBmdWxmaWxsZWRcbiAgICAgICAgLy8gdmFsdWUgb2YgdGhlIGZpcnN0IFRoZW5uYWJsZVJlZmVyZW5jZS5cbiAgICAgICAgdmFyIHRoZW5uYWJsZVB1c2hSZWYgPSB0aGlzLmNoaWxkKG5hbWUpO1xuICAgICAgICB2YXIgcHVzaFJlZiA9IHRoaXMuY2hpbGQobmFtZSk7XG4gICAgICAgIHZhciBwcm9taXNlO1xuICAgICAgICBpZiAodmFsdWUgIT0gbnVsbCkge1xuICAgICAgICAgICAgcHJvbWlzZSA9IHRoZW5uYWJsZVB1c2hSZWYuc2V0KHZhbHVlLCBvbkNvbXBsZXRlKS50aGVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIHB1c2hSZWY7IH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZShwdXNoUmVmKTtcbiAgICAgICAgfVxuICAgICAgICB0aGVubmFibGVQdXNoUmVmLnRoZW4gPSBwcm9taXNlLnRoZW4uYmluZChwcm9taXNlKTtcbiAgICAgICAgdGhlbm5hYmxlUHVzaFJlZi5jYXRjaCA9IHByb21pc2UudGhlbi5iaW5kKHByb21pc2UsIHVuZGVmaW5lZCk7XG4gICAgICAgIGlmICh0eXBlb2Ygb25Db21wbGV0ZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgcHJvbWlzZS5jYXRjaChmdW5jdGlvbiAoKSB7IH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGVubmFibGVQdXNoUmVmO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7IU9uRGlzY29ubmVjdH1cbiAgICAgKi9cbiAgICBSZWZlcmVuY2UucHJvdG90eXBlLm9uRGlzY29ubmVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFsaWRhdGlvbl8xLnZhbGlkYXRlV3JpdGFibGVQYXRoKCdSZWZlcmVuY2Uub25EaXNjb25uZWN0JywgdGhpcy5wYXRoKTtcbiAgICAgICAgcmV0dXJuIG5ldyBvbkRpc2Nvbm5lY3RfMS5PbkRpc2Nvbm5lY3QodGhpcy5yZXBvLCB0aGlzLnBhdGgpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFJlZmVyZW5jZS5wcm90b3R5cGUsIFwiZGF0YWJhc2VcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRhdGFiYXNlUHJvcCgpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVmZXJlbmNlLnByb3RvdHlwZSwgXCJrZXlcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldEtleSgpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVmZXJlbmNlLnByb3RvdHlwZSwgXCJwYXJlbnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFBhcmVudCgpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVmZXJlbmNlLnByb3RvdHlwZSwgXCJyb290XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRSb290KCk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiBSZWZlcmVuY2U7XG59KFF1ZXJ5XzEuUXVlcnkpKTtcbmV4cG9ydHMuUmVmZXJlbmNlID0gUmVmZXJlbmNlO1xuLyoqXG4gKiBEZWZpbmUgcmVmZXJlbmNlIGNvbnN0cnVjdG9yIGluIHZhcmlvdXMgbW9kdWxlc1xuICpcbiAqIFdlIGFyZSBkb2luZyB0aGlzIGhlcmUgdG8gYXZvaWQgc2V2ZXJhbCBjaXJjdWxhclxuICogZGVwZW5kZW5jeSBpc3N1ZXNcbiAqL1xuUXVlcnlfMS5RdWVyeS5fX3JlZmVyZW5jZUNvbnN0cnVjdG9yID0gUmVmZXJlbmNlO1xuU3luY1BvaW50XzEuU3luY1BvaW50Ll9fcmVmZXJlbmNlQ29uc3RydWN0b3IgPSBSZWZlcmVuY2U7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVJlZmVyZW5jZS5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB1dGlsXzEgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG52YXIgVHJhbnNhY3Rpb25SZXN1bHQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQSB0eXBlIGZvciB0aGUgcmVzb2x2ZSB2YWx1ZSBvZiBGaXJlYmFzZS50cmFuc2FjdGlvbi5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAZGljdFxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gY29tbWl0dGVkXG4gICAgICogQHBhcmFtIHtEYXRhU25hcHNob3R9IHNuYXBzaG90XG4gICAgICovXG4gICAgZnVuY3Rpb24gVHJhbnNhY3Rpb25SZXN1bHQoY29tbWl0dGVkLCBzbmFwc2hvdCkge1xuICAgICAgICB0aGlzLmNvbW1pdHRlZCA9IGNvbW1pdHRlZDtcbiAgICAgICAgdGhpcy5zbmFwc2hvdCA9IHNuYXBzaG90O1xuICAgIH1cbiAgICAvLyBEbyBub3QgY3JlYXRlIHB1YmxpYyBkb2N1bWVudGF0aW9uLiBUaGlzIGlzIGludGVuZGVkIHRvIG1ha2UgSlNPTiBzZXJpYWxpemF0aW9uIHdvcmsgYnV0IGlzIG90aGVyd2lzZSB1bm5lY2Vzc2FyeVxuICAgIC8vIGZvciBlbmQtdXNlcnNcbiAgICBUcmFuc2FjdGlvblJlc3VsdC5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB1dGlsXzEudmFsaWRhdGVBcmdDb3VudCgnVHJhbnNhY3Rpb25SZXN1bHQudG9KU09OJywgMCwgMSwgYXJndW1lbnRzLmxlbmd0aCk7XG4gICAgICAgIHJldHVybiB7IGNvbW1pdHRlZDogdGhpcy5jb21taXR0ZWQsIHNuYXBzaG90OiB0aGlzLnNuYXBzaG90LnRvSlNPTigpIH07XG4gICAgfTtcbiAgICByZXR1cm4gVHJhbnNhY3Rpb25SZXN1bHQ7XG59KCkpO1xuZXhwb3J0cy5UcmFuc2FjdGlvblJlc3VsdCA9IFRyYW5zYWN0aW9uUmVzdWx0O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1UcmFuc2FjdGlvblJlc3VsdC5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBXZWJTb2NrZXRDb25uZWN0aW9uXzEgPSByZXF1aXJlKFwiLi4vcmVhbHRpbWUvV2ViU29ja2V0Q29ubmVjdGlvblwiKTtcbnZhciBCcm93c2VyUG9sbENvbm5lY3Rpb25fMSA9IHJlcXVpcmUoXCIuLi9yZWFsdGltZS9Ccm93c2VyUG9sbENvbm5lY3Rpb25cIik7XG4vKipcbiAqIElOVEVSTkFMIG1ldGhvZHMgZm9yIGludGVybmFsLXVzZSBvbmx5ICh0ZXN0cywgZXRjLikuXG4gKlxuICogQ3VzdG9tZXJzIHNob3VsZG4ndCB1c2UgdGhlc2Ugb3IgZWxzZSBzaG91bGQgYmUgYXdhcmUgdGhhdCB0aGV5IGNvdWxkIGJyZWFrIGF0IGFueSB0aW1lLlxuICpcbiAqIEBjb25zdFxuICovXG5leHBvcnRzLmZvcmNlTG9uZ1BvbGxpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgV2ViU29ja2V0Q29ubmVjdGlvbl8xLldlYlNvY2tldENvbm5lY3Rpb24uZm9yY2VEaXNhbGxvdygpO1xuICAgIEJyb3dzZXJQb2xsQ29ubmVjdGlvbl8xLkJyb3dzZXJQb2xsQ29ubmVjdGlvbi5mb3JjZUFsbG93KCk7XG59O1xuZXhwb3J0cy5mb3JjZVdlYlNvY2tldHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgQnJvd3NlclBvbGxDb25uZWN0aW9uXzEuQnJvd3NlclBvbGxDb25uZWN0aW9uLmZvcmNlRGlzYWxsb3coKTtcbn07XG4vKiBVc2VkIGJ5IEFwcCBNYW5hZ2VyICovXG5leHBvcnRzLmlzV2ViU29ja2V0c0F2YWlsYWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gV2ViU29ja2V0Q29ubmVjdGlvbl8xLldlYlNvY2tldENvbm5lY3Rpb25bJ2lzQXZhaWxhYmxlJ10oKTtcbn07XG5leHBvcnRzLnNldFNlY3VyaXR5RGVidWdDYWxsYmFjayA9IGZ1bmN0aW9uIChyZWYsIGNhbGxiYWNrKSB7XG4gICAgcmVmLnJlcG8ucGVyc2lzdGVudENvbm5lY3Rpb25fLnNlY3VyaXR5RGVidWdDYWxsYmFja18gPSBjYWxsYmFjaztcbn07XG5leHBvcnRzLnN0YXRzID0gZnVuY3Rpb24gKHJlZiwgc2hvd0RlbHRhKSB7XG4gICAgcmVmLnJlcG8uc3RhdHMoc2hvd0RlbHRhKTtcbn07XG5leHBvcnRzLnN0YXRzSW5jcmVtZW50Q291bnRlciA9IGZ1bmN0aW9uIChyZWYsIG1ldHJpYykge1xuICAgIHJlZi5yZXBvLnN0YXRzSW5jcmVtZW50Q291bnRlcihtZXRyaWMpO1xufTtcbmV4cG9ydHMuZGF0YVVwZGF0ZUNvdW50ID0gZnVuY3Rpb24gKHJlZikge1xuICAgIHJldHVybiByZWYucmVwby5kYXRhVXBkYXRlQ291bnQ7XG59O1xuZXhwb3J0cy5pbnRlcmNlcHRTZXJ2ZXJEYXRhID0gZnVuY3Rpb24gKHJlZiwgY2FsbGJhY2spIHtcbiAgICByZXR1cm4gcmVmLnJlcG8uaW50ZXJjZXB0U2VydmVyRGF0YV8oY2FsbGJhY2spO1xufTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW50ZXJuYWwuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdXRpbF8xID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xudmFyIHZhbGlkYXRpb25fMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3V0aWwvdmFsaWRhdGlvblwiKTtcbnZhciB1dGlsXzIgPSByZXF1aXJlKFwiLi4vY29yZS91dGlsL3V0aWxcIik7XG52YXIgdXRpbF8zID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqL1xudmFyIE9uRGlzY29ubmVjdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFSZXBvfSByZXBvX1xuICAgICAqIEBwYXJhbSB7IVBhdGh9IHBhdGhfXG4gICAgICovXG4gICAgZnVuY3Rpb24gT25EaXNjb25uZWN0KHJlcG9fLCBwYXRoXykge1xuICAgICAgICB0aGlzLnJlcG9fID0gcmVwb187XG4gICAgICAgIHRoaXMucGF0aF8gPSBwYXRoXztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbig/RXJyb3IpPX0gb25Db21wbGV0ZVxuICAgICAqIEByZXR1cm4geyFmaXJlYmFzZS5Qcm9taXNlfVxuICAgICAqL1xuICAgIE9uRGlzY29ubmVjdC5wcm90b3R5cGUuY2FuY2VsID0gZnVuY3Rpb24gKG9uQ29tcGxldGUpIHtcbiAgICAgICAgdXRpbF8xLnZhbGlkYXRlQXJnQ291bnQoJ09uRGlzY29ubmVjdC5jYW5jZWwnLCAwLCAxLCBhcmd1bWVudHMubGVuZ3RoKTtcbiAgICAgICAgdXRpbF8xLnZhbGlkYXRlQ2FsbGJhY2soJ09uRGlzY29ubmVjdC5jYW5jZWwnLCAxLCBvbkNvbXBsZXRlLCB0cnVlKTtcbiAgICAgICAgdmFyIGRlZmVycmVkID0gbmV3IHV0aWxfMy5EZWZlcnJlZCgpO1xuICAgICAgICB0aGlzLnJlcG9fLm9uRGlzY29ubmVjdENhbmNlbCh0aGlzLnBhdGhfLCBkZWZlcnJlZC53cmFwQ2FsbGJhY2sob25Db21wbGV0ZSkpO1xuICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oP0Vycm9yKT19IG9uQ29tcGxldGVcbiAgICAgKiBAcmV0dXJuIHshZmlyZWJhc2UuUHJvbWlzZX1cbiAgICAgKi9cbiAgICBPbkRpc2Nvbm5lY3QucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uIChvbkNvbXBsZXRlKSB7XG4gICAgICAgIHV0aWxfMS52YWxpZGF0ZUFyZ0NvdW50KCdPbkRpc2Nvbm5lY3QucmVtb3ZlJywgMCwgMSwgYXJndW1lbnRzLmxlbmd0aCk7XG4gICAgICAgIHZhbGlkYXRpb25fMS52YWxpZGF0ZVdyaXRhYmxlUGF0aCgnT25EaXNjb25uZWN0LnJlbW92ZScsIHRoaXMucGF0aF8pO1xuICAgICAgICB1dGlsXzEudmFsaWRhdGVDYWxsYmFjaygnT25EaXNjb25uZWN0LnJlbW92ZScsIDEsIG9uQ29tcGxldGUsIHRydWUpO1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSBuZXcgdXRpbF8zLkRlZmVycmVkKCk7XG4gICAgICAgIHRoaXMucmVwb18ub25EaXNjb25uZWN0U2V0KHRoaXMucGF0aF8sIG51bGwsIGRlZmVycmVkLndyYXBDYWxsYmFjayhvbkNvbXBsZXRlKSk7XG4gICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZVxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oP0Vycm9yKT19IG9uQ29tcGxldGVcbiAgICAgKiBAcmV0dXJuIHshZmlyZWJhc2UuUHJvbWlzZX1cbiAgICAgKi9cbiAgICBPbkRpc2Nvbm5lY3QucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uICh2YWx1ZSwgb25Db21wbGV0ZSkge1xuICAgICAgICB1dGlsXzEudmFsaWRhdGVBcmdDb3VudCgnT25EaXNjb25uZWN0LnNldCcsIDEsIDIsIGFyZ3VtZW50cy5sZW5ndGgpO1xuICAgICAgICB2YWxpZGF0aW9uXzEudmFsaWRhdGVXcml0YWJsZVBhdGgoJ09uRGlzY29ubmVjdC5zZXQnLCB0aGlzLnBhdGhfKTtcbiAgICAgICAgdmFsaWRhdGlvbl8xLnZhbGlkYXRlRmlyZWJhc2VEYXRhQXJnKCdPbkRpc2Nvbm5lY3Quc2V0JywgMSwgdmFsdWUsIHRoaXMucGF0aF8sIGZhbHNlKTtcbiAgICAgICAgdXRpbF8xLnZhbGlkYXRlQ2FsbGJhY2soJ09uRGlzY29ubmVjdC5zZXQnLCAyLCBvbkNvbXBsZXRlLCB0cnVlKTtcbiAgICAgICAgdmFyIGRlZmVycmVkID0gbmV3IHV0aWxfMy5EZWZlcnJlZCgpO1xuICAgICAgICB0aGlzLnJlcG9fLm9uRGlzY29ubmVjdFNldCh0aGlzLnBhdGhfLCB2YWx1ZSwgZGVmZXJyZWQud3JhcENhbGxiYWNrKG9uQ29tcGxldGUpKTtcbiAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlXG4gICAgICogQHBhcmFtIHtudW1iZXJ8c3RyaW5nfG51bGx9IHByaW9yaXR5XG4gICAgICogQHBhcmFtIHtmdW5jdGlvbig/RXJyb3IpPX0gb25Db21wbGV0ZVxuICAgICAqIEByZXR1cm4geyFmaXJlYmFzZS5Qcm9taXNlfVxuICAgICAqL1xuICAgIE9uRGlzY29ubmVjdC5wcm90b3R5cGUuc2V0V2l0aFByaW9yaXR5ID0gZnVuY3Rpb24gKHZhbHVlLCBwcmlvcml0eSwgb25Db21wbGV0ZSkge1xuICAgICAgICB1dGlsXzEudmFsaWRhdGVBcmdDb3VudCgnT25EaXNjb25uZWN0LnNldFdpdGhQcmlvcml0eScsIDIsIDMsIGFyZ3VtZW50cy5sZW5ndGgpO1xuICAgICAgICB2YWxpZGF0aW9uXzEudmFsaWRhdGVXcml0YWJsZVBhdGgoJ09uRGlzY29ubmVjdC5zZXRXaXRoUHJpb3JpdHknLCB0aGlzLnBhdGhfKTtcbiAgICAgICAgdmFsaWRhdGlvbl8xLnZhbGlkYXRlRmlyZWJhc2VEYXRhQXJnKCdPbkRpc2Nvbm5lY3Quc2V0V2l0aFByaW9yaXR5JywgMSwgdmFsdWUsIHRoaXMucGF0aF8sIGZhbHNlKTtcbiAgICAgICAgdmFsaWRhdGlvbl8xLnZhbGlkYXRlUHJpb3JpdHkoJ09uRGlzY29ubmVjdC5zZXRXaXRoUHJpb3JpdHknLCAyLCBwcmlvcml0eSwgZmFsc2UpO1xuICAgICAgICB1dGlsXzEudmFsaWRhdGVDYWxsYmFjaygnT25EaXNjb25uZWN0LnNldFdpdGhQcmlvcml0eScsIDMsIG9uQ29tcGxldGUsIHRydWUpO1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSBuZXcgdXRpbF8zLkRlZmVycmVkKCk7XG4gICAgICAgIHRoaXMucmVwb18ub25EaXNjb25uZWN0U2V0V2l0aFByaW9yaXR5KHRoaXMucGF0aF8sIHZhbHVlLCBwcmlvcml0eSwgZGVmZXJyZWQud3JhcENhbGxiYWNrKG9uQ29tcGxldGUpKTtcbiAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFPYmplY3R9IG9iamVjdFRvTWVyZ2VcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKD9FcnJvcik9fSBvbkNvbXBsZXRlXG4gICAgICogQHJldHVybiB7IWZpcmViYXNlLlByb21pc2V9XG4gICAgICovXG4gICAgT25EaXNjb25uZWN0LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAob2JqZWN0VG9NZXJnZSwgb25Db21wbGV0ZSkge1xuICAgICAgICB1dGlsXzEudmFsaWRhdGVBcmdDb3VudCgnT25EaXNjb25uZWN0LnVwZGF0ZScsIDEsIDIsIGFyZ3VtZW50cy5sZW5ndGgpO1xuICAgICAgICB2YWxpZGF0aW9uXzEudmFsaWRhdGVXcml0YWJsZVBhdGgoJ09uRGlzY29ubmVjdC51cGRhdGUnLCB0aGlzLnBhdGhfKTtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkob2JqZWN0VG9NZXJnZSkpIHtcbiAgICAgICAgICAgIHZhciBuZXdPYmplY3RUb01lcmdlID0ge307XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9iamVjdFRvTWVyZ2UubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgICAgICBuZXdPYmplY3RUb01lcmdlWycnICsgaV0gPSBvYmplY3RUb01lcmdlW2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb2JqZWN0VG9NZXJnZSA9IG5ld09iamVjdFRvTWVyZ2U7XG4gICAgICAgICAgICB1dGlsXzIud2FybignUGFzc2luZyBhbiBBcnJheSB0byBmaXJlYmFzZS5kYXRhYmFzZS5vbkRpc2Nvbm5lY3QoKS51cGRhdGUoKSBpcyBkZXByZWNhdGVkLiBVc2Ugc2V0KCkgaWYgeW91IHdhbnQgdG8gb3ZlcndyaXRlIHRoZSAnICtcbiAgICAgICAgICAgICAgICAnZXhpc3RpbmcgZGF0YSwgb3IgYW4gT2JqZWN0IHdpdGggaW50ZWdlciBrZXlzIGlmIHlvdSByZWFsbHkgZG8gd2FudCB0byBvbmx5IHVwZGF0ZSBzb21lIG9mIHRoZSBjaGlsZHJlbi4nKTtcbiAgICAgICAgfVxuICAgICAgICB2YWxpZGF0aW9uXzEudmFsaWRhdGVGaXJlYmFzZU1lcmdlRGF0YUFyZygnT25EaXNjb25uZWN0LnVwZGF0ZScsIDEsIG9iamVjdFRvTWVyZ2UsIHRoaXMucGF0aF8sIGZhbHNlKTtcbiAgICAgICAgdXRpbF8xLnZhbGlkYXRlQ2FsbGJhY2soJ09uRGlzY29ubmVjdC51cGRhdGUnLCAyLCBvbkNvbXBsZXRlLCB0cnVlKTtcbiAgICAgICAgdmFyIGRlZmVycmVkID0gbmV3IHV0aWxfMy5EZWZlcnJlZCgpO1xuICAgICAgICB0aGlzLnJlcG9fLm9uRGlzY29ubmVjdFVwZGF0ZSh0aGlzLnBhdGhfLCBvYmplY3RUb01lcmdlLCBkZWZlcnJlZC53cmFwQ2FsbGJhY2sob25Db21wbGV0ZSkpO1xuICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICB9O1xuICAgIHJldHVybiBPbkRpc2Nvbm5lY3Q7XG59KCkpO1xuZXhwb3J0cy5PbkRpc2Nvbm5lY3QgPSBPbkRpc2Nvbm5lY3Q7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW9uRGlzY29ubmVjdC5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBSZXBvSW5mb18xID0gcmVxdWlyZShcIi4uL2NvcmUvUmVwb0luZm9cIik7XG52YXIgUGVyc2lzdGVudENvbm5lY3Rpb25fMSA9IHJlcXVpcmUoXCIuLi9jb3JlL1BlcnNpc3RlbnRDb25uZWN0aW9uXCIpO1xudmFyIFJlcG9NYW5hZ2VyXzEgPSByZXF1aXJlKFwiLi4vY29yZS9SZXBvTWFuYWdlclwiKTtcbnZhciBDb25uZWN0aW9uXzEgPSByZXF1aXJlKFwiLi4vcmVhbHRpbWUvQ29ubmVjdGlvblwiKTtcbmV4cG9ydHMuRGF0YUNvbm5lY3Rpb24gPSBQZXJzaXN0ZW50Q29ubmVjdGlvbl8xLlBlcnNpc3RlbnRDb25uZWN0aW9uO1xuLyoqXG4gKiBAcGFyYW0geyFzdHJpbmd9IHBhdGhTdHJpbmdcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKil9IG9uQ29tcGxldGVcbiAqL1xuUGVyc2lzdGVudENvbm5lY3Rpb25fMS5QZXJzaXN0ZW50Q29ubmVjdGlvbi5wcm90b3R5cGUuc2ltcGxlTGlzdGVuID0gZnVuY3Rpb24gKHBhdGhTdHJpbmcsIG9uQ29tcGxldGUpIHtcbiAgICB0aGlzLnNlbmRSZXF1ZXN0KCdxJywgeyBwOiBwYXRoU3RyaW5nIH0sIG9uQ29tcGxldGUpO1xufTtcbi8qKlxuICogQHBhcmFtIHsqfSBkYXRhXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCopfSBvbkVjaG9cbiAqL1xuUGVyc2lzdGVudENvbm5lY3Rpb25fMS5QZXJzaXN0ZW50Q29ubmVjdGlvbi5wcm90b3R5cGUuZWNobyA9IGZ1bmN0aW9uIChkYXRhLCBvbkVjaG8pIHtcbiAgICB0aGlzLnNlbmRSZXF1ZXN0KCdlY2hvJywgeyBkOiBkYXRhIH0sIG9uRWNobyk7XG59O1xuLy8gUmVhbFRpbWVDb25uZWN0aW9uIHByb3BlcnRpZXMgdGhhdCB3ZSB1c2UgaW4gdGVzdHMuXG5leHBvcnRzLlJlYWxUaW1lQ29ubmVjdGlvbiA9IENvbm5lY3Rpb25fMS5Db25uZWN0aW9uO1xuLyoqXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCk6IHN0cmluZ30gbmV3SGFzaFxuICogQHJldHVybiB7ZnVuY3Rpb24oKX1cbiAqL1xuZXhwb3J0cy5oaWphY2tIYXNoID0gZnVuY3Rpb24gKG5ld0hhc2gpIHtcbiAgICB2YXIgb2xkUHV0ID0gUGVyc2lzdGVudENvbm5lY3Rpb25fMS5QZXJzaXN0ZW50Q29ubmVjdGlvbi5wcm90b3R5cGUucHV0O1xuICAgIFBlcnNpc3RlbnRDb25uZWN0aW9uXzEuUGVyc2lzdGVudENvbm5lY3Rpb24ucHJvdG90eXBlLnB1dCA9IGZ1bmN0aW9uIChwYXRoU3RyaW5nLCBkYXRhLCBvcHRfb25Db21wbGV0ZSwgb3B0X2hhc2gpIHtcbiAgICAgICAgaWYgKG9wdF9oYXNoICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIG9wdF9oYXNoID0gbmV3SGFzaCgpO1xuICAgICAgICB9XG4gICAgICAgIG9sZFB1dC5jYWxsKHRoaXMsIHBhdGhTdHJpbmcsIGRhdGEsIG9wdF9vbkNvbXBsZXRlLCBvcHRfaGFzaCk7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICBQZXJzaXN0ZW50Q29ubmVjdGlvbl8xLlBlcnNpc3RlbnRDb25uZWN0aW9uLnByb3RvdHlwZS5wdXQgPSBvbGRQdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEB0eXBlIHtmdW5jdGlvbihuZXc6UmVwb0luZm8sICFzdHJpbmcsIGJvb2xlYW4sICFzdHJpbmcsIGJvb2xlYW4pOiB1bmRlZmluZWR9XG4gKi9cbmV4cG9ydHMuQ29ubmVjdGlvblRhcmdldCA9IFJlcG9JbmZvXzEuUmVwb0luZm87XG4vKipcbiAqIEBwYXJhbSB7IVF1ZXJ5fSBxdWVyeVxuICogQHJldHVybiB7IXN0cmluZ31cbiAqL1xuZXhwb3J0cy5xdWVyeUlkZW50aWZpZXIgPSBmdW5jdGlvbiAocXVlcnkpIHtcbiAgICByZXR1cm4gcXVlcnkucXVlcnlJZGVudGlmaWVyKCk7XG59O1xuLyoqXG4gKiBAcGFyYW0geyFRdWVyeX0gZmlyZWJhc2VSZWZcbiAqIEByZXR1cm4geyFPYmplY3R9XG4gKi9cbmV4cG9ydHMubGlzdGVucyA9IGZ1bmN0aW9uIChmaXJlYmFzZVJlZikge1xuICAgIHJldHVybiBmaXJlYmFzZVJlZi5yZXBvLnBlcnNpc3RlbnRDb25uZWN0aW9uXy5saXN0ZW5zXztcbn07XG4vKipcbiAqIEZvcmNlcyB0aGUgUmVwb01hbmFnZXIgdG8gY3JlYXRlIFJlcG9zIHRoYXQgdXNlIFJlYWRvbmx5UmVzdENsaWVudCBpbnN0ZWFkIG9mIFBlcnNpc3RlbnRDb25uZWN0aW9uLlxuICpcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gZm9yY2VSZXN0Q2xpZW50XG4gKi9cbmV4cG9ydHMuZm9yY2VSZXN0Q2xpZW50ID0gZnVuY3Rpb24gKGZvcmNlUmVzdENsaWVudCkge1xuICAgIFJlcG9NYW5hZ2VyXzEuUmVwb01hbmFnZXIuZ2V0SW5zdGFuY2UoKS5mb3JjZVJlc3RDbGllbnQoZm9yY2VSZXN0Q2xpZW50KTtcbn07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRlc3RfYWNjZXNzLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHV0aWxfMSA9IHJlcXVpcmUoXCIuL3V0aWwvdXRpbFwiKTtcbi8qKlxuICogQWJzdHJhY3Rpb24gYXJvdW5kIEZpcmViYXNlQXBwJ3MgdG9rZW4gZmV0Y2hpbmcgY2FwYWJpbGl0aWVzLlxuICovXG52YXIgQXV0aFRva2VuUHJvdmlkZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshRmlyZWJhc2VBcHB9IGFwcF9cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBBdXRoVG9rZW5Qcm92aWRlcihhcHBfKSB7XG4gICAgICAgIHRoaXMuYXBwXyA9IGFwcF87XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gZm9yY2VSZWZyZXNoXG4gICAgICogQHJldHVybiB7IVByb21pc2U8RmlyZWJhc2VBdXRoVG9rZW5EYXRhPn1cbiAgICAgKi9cbiAgICBBdXRoVG9rZW5Qcm92aWRlci5wcm90b3R5cGUuZ2V0VG9rZW4gPSBmdW5jdGlvbiAoZm9yY2VSZWZyZXNoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcF9bJ0lOVEVSTkFMJ11bJ2dldFRva2VuJ10oZm9yY2VSZWZyZXNoKS50aGVuKG51bGwsIFxuICAgICAgICAvLyAuY2F0Y2hcbiAgICAgICAgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAvLyBUT0RPOiBOZWVkIHRvIGZpZ3VyZSBvdXQgYWxsIHRoZSBjYXNlcyB0aGlzIGlzIHJhaXNlZCBhbmQgd2hldGhlclxuICAgICAgICAgICAgLy8gdGhpcyBtYWtlcyBzZW5zZS5cbiAgICAgICAgICAgIGlmIChlcnJvciAmJiBlcnJvci5jb2RlID09PSAnYXV0aC90b2tlbi1ub3QtaW5pdGlhbGl6ZWQnKSB7XG4gICAgICAgICAgICAgICAgdXRpbF8xLmxvZygnR290IGF1dGgvdG9rZW4tbm90LWluaXRpYWxpemVkIGVycm9yLiAgVHJlYXRpbmcgYXMgbnVsbCB0b2tlbi4nKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQXV0aFRva2VuUHJvdmlkZXIucHJvdG90eXBlLmFkZFRva2VuQ2hhbmdlTGlzdGVuZXIgPSBmdW5jdGlvbiAobGlzdGVuZXIpIHtcbiAgICAgICAgLy8gVE9ETzogV2UgbWlnaHQgd2FudCB0byB3cmFwIHRoZSBsaXN0ZW5lciBhbmQgY2FsbCBpdCB3aXRoIG5vIGFyZ3MgdG9cbiAgICAgICAgLy8gYXZvaWQgYSBsZWFreSBhYnN0cmFjdGlvbiwgYnV0IHRoYXQgbWFrZXMgcmVtb3ZpbmcgdGhlIGxpc3RlbmVyIGhhcmRlci5cbiAgICAgICAgdGhpcy5hcHBfWydJTlRFUk5BTCddWydhZGRBdXRoVG9rZW5MaXN0ZW5lciddKGxpc3RlbmVyKTtcbiAgICB9O1xuICAgIEF1dGhUb2tlblByb3ZpZGVyLnByb3RvdHlwZS5yZW1vdmVUb2tlbkNoYW5nZUxpc3RlbmVyID0gZnVuY3Rpb24gKGxpc3RlbmVyKSB7XG4gICAgICAgIHRoaXMuYXBwX1snSU5URVJOQUwnXVsncmVtb3ZlQXV0aFRva2VuTGlzdGVuZXInXShsaXN0ZW5lcik7XG4gICAgfTtcbiAgICBBdXRoVG9rZW5Qcm92aWRlci5wcm90b3R5cGUubm90aWZ5Rm9ySW52YWxpZFRva2VuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZXJyb3JNZXNzYWdlID0gJ1Byb3ZpZGVkIGF1dGhlbnRpY2F0aW9uIGNyZWRlbnRpYWxzIGZvciB0aGUgYXBwIG5hbWVkIFwiJyArXG4gICAgICAgICAgICB0aGlzLmFwcF8ubmFtZSArXG4gICAgICAgICAgICAnXCIgYXJlIGludmFsaWQuIFRoaXMgdXN1YWxseSBpbmRpY2F0ZXMgeW91ciBhcHAgd2FzIG5vdCAnICtcbiAgICAgICAgICAgICdpbml0aWFsaXplZCBjb3JyZWN0bHkuICc7XG4gICAgICAgIGlmICgnY3JlZGVudGlhbCcgaW4gdGhpcy5hcHBfLm9wdGlvbnMpIHtcbiAgICAgICAgICAgIGVycm9yTWVzc2FnZSArPVxuICAgICAgICAgICAgICAgICdNYWtlIHN1cmUgdGhlIFwiY3JlZGVudGlhbFwiIHByb3BlcnR5IHByb3ZpZGVkIHRvIGluaXRpYWxpemVBcHAoKSAnICtcbiAgICAgICAgICAgICAgICAgICAgJ2lzIGF1dGhvcml6ZWQgdG8gYWNjZXNzIHRoZSBzcGVjaWZpZWQgXCJkYXRhYmFzZVVSTFwiIGFuZCBpcyBmcm9tIHRoZSBjb3JyZWN0ICcgK1xuICAgICAgICAgICAgICAgICAgICAncHJvamVjdC4nO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCdzZXJ2aWNlQWNjb3VudCcgaW4gdGhpcy5hcHBfLm9wdGlvbnMpIHtcbiAgICAgICAgICAgIGVycm9yTWVzc2FnZSArPVxuICAgICAgICAgICAgICAgICdNYWtlIHN1cmUgdGhlIFwic2VydmljZUFjY291bnRcIiBwcm9wZXJ0eSBwcm92aWRlZCB0byBpbml0aWFsaXplQXBwKCkgJyArXG4gICAgICAgICAgICAgICAgICAgICdpcyBhdXRob3JpemVkIHRvIGFjY2VzcyB0aGUgc3BlY2lmaWVkIFwiZGF0YWJhc2VVUkxcIiBhbmQgaXMgZnJvbSB0aGUgY29ycmVjdCAnICtcbiAgICAgICAgICAgICAgICAgICAgJ3Byb2plY3QuJztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGVycm9yTWVzc2FnZSArPVxuICAgICAgICAgICAgICAgICdNYWtlIHN1cmUgdGhlIFwiYXBpS2V5XCIgYW5kIFwiZGF0YWJhc2VVUkxcIiBwcm9wZXJ0aWVzIHByb3ZpZGVkIHRvICcgK1xuICAgICAgICAgICAgICAgICAgICAnaW5pdGlhbGl6ZUFwcCgpIG1hdGNoIHRoZSB2YWx1ZXMgcHJvdmlkZWQgZm9yIHlvdXIgYXBwIGF0ICcgK1xuICAgICAgICAgICAgICAgICAgICAnaHR0cHM6Ly9jb25zb2xlLmZpcmViYXNlLmdvb2dsZS5jb20vLic7XG4gICAgICAgIH1cbiAgICAgICAgdXRpbF8xLndhcm4oZXJyb3JNZXNzYWdlKTtcbiAgICB9O1xuICAgIHJldHVybiBBdXRoVG9rZW5Qcm92aWRlcjtcbn0oKSk7XG5leHBvcnRzLkF1dGhUb2tlblByb3ZpZGVyID0gQXV0aFRva2VuUHJvdmlkZXI7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUF1dGhUb2tlblByb3ZpZGVyLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIEltbXV0YWJsZVRyZWVfMSA9IHJlcXVpcmUoXCIuL3V0aWwvSW1tdXRhYmxlVHJlZVwiKTtcbnZhciBQYXRoXzEgPSByZXF1aXJlKFwiLi91dGlsL1BhdGhcIik7XG52YXIgdXRpbF8xID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xudmFyIE5vZGVfMSA9IHJlcXVpcmUoXCIuL3NuYXAvTm9kZVwiKTtcbnZhciBQcmlvcml0eUluZGV4XzEgPSByZXF1aXJlKFwiLi9zbmFwL2luZGV4ZXMvUHJpb3JpdHlJbmRleFwiKTtcbnZhciB1dGlsXzIgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG4vKipcbiAqIFRoaXMgY2xhc3MgaG9sZHMgYSBjb2xsZWN0aW9uIG9mIHdyaXRlcyB0aGF0IGNhbiBiZSBhcHBsaWVkIHRvIG5vZGVzIGluIHVuaXNvbi4gSXQgYWJzdHJhY3RzIGF3YXkgdGhlIGxvZ2ljIHdpdGhcbiAqIGRlYWxpbmcgd2l0aCBwcmlvcml0eSB3cml0ZXMgYW5kIG11bHRpcGxlIG5lc3RlZCB3cml0ZXMuIEF0IGFueSBnaXZlbiBwYXRoIHRoZXJlIGlzIG9ubHkgYWxsb3dlZCB0byBiZSBvbmUgd3JpdGVcbiAqIG1vZGlmeWluZyB0aGF0IHBhdGguIEFueSB3cml0ZSB0byBhbiBleGlzdGluZyBwYXRoIG9yIHNoYWRvd2luZyBhbiBleGlzdGluZyBwYXRoIHdpbGwgbW9kaWZ5IHRoYXQgZXhpc3Rpbmcgd3JpdGVcbiAqIHRvIHJlZmxlY3QgdGhlIHdyaXRlIGFkZGVkLlxuICpcbiAqIEBjb25zdHJ1Y3RvclxuICogQHBhcmFtIHshSW1tdXRhYmxlVHJlZS48IU5vZGU+fSB3cml0ZVRyZWVcbiAqL1xudmFyIENvbXBvdW5kV3JpdGUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ29tcG91bmRXcml0ZSh3cml0ZVRyZWVfKSB7XG4gICAgICAgIHRoaXMud3JpdGVUcmVlXyA9IHdyaXRlVHJlZV87XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7IVBhdGh9IHBhdGhcbiAgICAgKiBAcGFyYW0geyFOb2RlfSBub2RlXG4gICAgICogQHJldHVybiB7IUNvbXBvdW5kV3JpdGV9XG4gICAgICovXG4gICAgQ29tcG91bmRXcml0ZS5wcm90b3R5cGUuYWRkV3JpdGUgPSBmdW5jdGlvbiAocGF0aCwgbm9kZSkge1xuICAgICAgICBpZiAocGF0aC5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgQ29tcG91bmRXcml0ZShuZXcgSW1tdXRhYmxlVHJlZV8xLkltbXV0YWJsZVRyZWUobm9kZSkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIHJvb3Rtb3N0ID0gdGhpcy53cml0ZVRyZWVfLmZpbmRSb290TW9zdFZhbHVlQW5kUGF0aChwYXRoKTtcbiAgICAgICAgICAgIGlmIChyb290bW9zdCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJvb3RNb3N0UGF0aCA9IHJvb3Rtb3N0LnBhdGg7XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gcm9vdG1vc3QudmFsdWU7XG4gICAgICAgICAgICAgICAgdmFyIHJlbGF0aXZlUGF0aCA9IFBhdGhfMS5QYXRoLnJlbGF0aXZlUGF0aChyb290TW9zdFBhdGgsIHBhdGgpO1xuICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUudXBkYXRlQ2hpbGQocmVsYXRpdmVQYXRoLCBub2RlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbXBvdW5kV3JpdGUodGhpcy53cml0ZVRyZWVfLnNldChyb290TW9zdFBhdGgsIHZhbHVlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgc3VidHJlZSA9IG5ldyBJbW11dGFibGVUcmVlXzEuSW1tdXRhYmxlVHJlZShub2RlKTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3V3JpdGVUcmVlID0gdGhpcy53cml0ZVRyZWVfLnNldFRyZWUocGF0aCwgc3VidHJlZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb21wb3VuZFdyaXRlKG5ld1dyaXRlVHJlZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7IVBhdGh9IHBhdGhcbiAgICAgKiBAcGFyYW0geyFPYmplY3QuPHN0cmluZywgIU5vZGU+fSB1cGRhdGVzXG4gICAgICogQHJldHVybiB7IUNvbXBvdW5kV3JpdGV9XG4gICAgICovXG4gICAgQ29tcG91bmRXcml0ZS5wcm90b3R5cGUuYWRkV3JpdGVzID0gZnVuY3Rpb24gKHBhdGgsIHVwZGF0ZXMpIHtcbiAgICAgICAgdmFyIG5ld1dyaXRlID0gdGhpcztcbiAgICAgICAgdXRpbF8xLmZvckVhY2godXBkYXRlcywgZnVuY3Rpb24gKGNoaWxkS2V5LCBub2RlKSB7XG4gICAgICAgICAgICBuZXdXcml0ZSA9IG5ld1dyaXRlLmFkZFdyaXRlKHBhdGguY2hpbGQoY2hpbGRLZXkpLCBub2RlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBuZXdXcml0ZTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFdpbGwgcmVtb3ZlIGEgd3JpdGUgYXQgdGhlIGdpdmVuIHBhdGggYW5kIGRlZXBlciBwYXRocy4gVGhpcyB3aWxsIDxlbT5ub3Q8L2VtPiBtb2RpZnkgYSB3cml0ZSBhdCBhIGhpZ2hlclxuICAgICAqIGxvY2F0aW9uLCB3aGljaCBtdXN0IGJlIHJlbW92ZWQgYnkgY2FsbGluZyB0aGlzIG1ldGhvZCB3aXRoIHRoYXQgcGF0aC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7IVBhdGh9IHBhdGggVGhlIHBhdGggYXQgd2hpY2ggYSB3cml0ZSBhbmQgYWxsIGRlZXBlciB3cml0ZXMgc2hvdWxkIGJlIHJlbW92ZWRcbiAgICAgKiBAcmV0dXJuIHshQ29tcG91bmRXcml0ZX0gVGhlIG5ldyBDb21wb3VuZFdyaXRlIHdpdGggdGhlIHJlbW92ZWQgcGF0aFxuICAgICAqL1xuICAgIENvbXBvdW5kV3JpdGUucHJvdG90eXBlLnJlbW92ZVdyaXRlID0gZnVuY3Rpb24gKHBhdGgpIHtcbiAgICAgICAgaWYgKHBhdGguaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICByZXR1cm4gQ29tcG91bmRXcml0ZS5FbXB0eTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBuZXdXcml0ZVRyZWUgPSB0aGlzLndyaXRlVHJlZV8uc2V0VHJlZShwYXRoLCBJbW11dGFibGVUcmVlXzEuSW1tdXRhYmxlVHJlZS5FbXB0eSk7XG4gICAgICAgICAgICByZXR1cm4gbmV3IENvbXBvdW5kV3JpdGUobmV3V3JpdGVUcmVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB3aGV0aGVyIHRoaXMgQ29tcG91bmRXcml0ZSB3aWxsIGZ1bGx5IG92ZXJ3cml0ZSBhIG5vZGUgYXQgYSBnaXZlbiBsb2NhdGlvbiBhbmQgY2FuIHRoZXJlZm9yZSBiZVxuICAgICAqIGNvbnNpZGVyZWQgXCJjb21wbGV0ZVwiLlxuICAgICAqXG4gICAgICogQHBhcmFtIHshUGF0aH0gcGF0aCBUaGUgcGF0aCB0byBjaGVjayBmb3JcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufSBXaGV0aGVyIHRoZXJlIGlzIGEgY29tcGxldGUgd3JpdGUgYXQgdGhhdCBwYXRoXG4gICAgICovXG4gICAgQ29tcG91bmRXcml0ZS5wcm90b3R5cGUuaGFzQ29tcGxldGVXcml0ZSA9IGZ1bmN0aW9uIChwYXRoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldENvbXBsZXRlTm9kZShwYXRoKSAhPSBudWxsO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIG5vZGUgZm9yIGEgcGF0aCBpZiBhbmQgb25seSBpZiB0aGUgbm9kZSBpcyBhIFwiY29tcGxldGVcIiBvdmVyd3JpdGUgYXQgdGhhdCBwYXRoLiBUaGlzIHdpbGwgbm90IGFnZ3JlZ2F0ZVxuICAgICAqIHdyaXRlcyBmcm9tIGRlZXBlciBwYXRocywgYnV0IHdpbGwgcmV0dXJuIGNoaWxkIG5vZGVzIGZyb20gYSBtb3JlIHNoYWxsb3cgcGF0aC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7IVBhdGh9IHBhdGggVGhlIHBhdGggdG8gZ2V0IGEgY29tcGxldGUgd3JpdGVcbiAgICAgKiBAcmV0dXJuIHs/Tm9kZX0gVGhlIG5vZGUgaWYgY29tcGxldGUgYXQgdGhhdCBwYXRoLCBvciBudWxsIG90aGVyd2lzZS5cbiAgICAgKi9cbiAgICBDb21wb3VuZFdyaXRlLnByb3RvdHlwZS5nZXRDb21wbGV0ZU5vZGUgPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICB2YXIgcm9vdG1vc3QgPSB0aGlzLndyaXRlVHJlZV8uZmluZFJvb3RNb3N0VmFsdWVBbmRQYXRoKHBhdGgpO1xuICAgICAgICBpZiAocm9vdG1vc3QgIT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMud3JpdGVUcmVlX1xuICAgICAgICAgICAgICAgIC5nZXQocm9vdG1vc3QucGF0aClcbiAgICAgICAgICAgICAgICAuZ2V0Q2hpbGQoUGF0aF8xLlBhdGgucmVsYXRpdmVQYXRoKHJvb3Rtb3N0LnBhdGgsIHBhdGgpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGFsbCBjaGlsZHJlbiB0aGF0IGFyZSBndWFyYW50ZWVkIHRvIGJlIGEgY29tcGxldGUgb3ZlcndyaXRlLlxuICAgICAqXG4gICAgICogQHJldHVybiB7IUFycmF5LjxOYW1lZE5vZGU+fSBBIGxpc3Qgb2YgYWxsIGNvbXBsZXRlIGNoaWxkcmVuLlxuICAgICAqL1xuICAgIENvbXBvdW5kV3JpdGUucHJvdG90eXBlLmdldENvbXBsZXRlQ2hpbGRyZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjaGlsZHJlbiA9IFtdO1xuICAgICAgICB2YXIgbm9kZSA9IHRoaXMud3JpdGVUcmVlXy52YWx1ZTtcbiAgICAgICAgaWYgKG5vZGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgLy8gSWYgaXQncyBhIGxlYWYgbm9kZSwgaXQgaGFzIG5vIGNoaWxkcmVuOyBzbyBub3RoaW5nIHRvIGRvLlxuICAgICAgICAgICAgaWYgKCFub2RlLmlzTGVhZk5vZGUoKSkge1xuICAgICAgICAgICAgICAgIG5vZGUuZm9yRWFjaENoaWxkKFByaW9yaXR5SW5kZXhfMS5QUklPUklUWV9JTkRFWCwgZnVuY3Rpb24gKGNoaWxkTmFtZSwgY2hpbGROb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuLnB1c2gobmV3IE5vZGVfMS5OYW1lZE5vZGUoY2hpbGROYW1lLCBjaGlsZE5vZGUpKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMud3JpdGVUcmVlXy5jaGlsZHJlbi5pbm9yZGVyVHJhdmVyc2FsKGZ1bmN0aW9uIChjaGlsZE5hbWUsIGNoaWxkVHJlZSkge1xuICAgICAgICAgICAgICAgIGlmIChjaGlsZFRyZWUudmFsdWUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbi5wdXNoKG5ldyBOb2RlXzEuTmFtZWROb2RlKGNoaWxkTmFtZSwgY2hpbGRUcmVlLnZhbHVlKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNoaWxkcmVuO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshUGF0aH0gcGF0aFxuICAgICAqIEByZXR1cm4geyFDb21wb3VuZFdyaXRlfVxuICAgICAqL1xuICAgIENvbXBvdW5kV3JpdGUucHJvdG90eXBlLmNoaWxkQ29tcG91bmRXcml0ZSA9IGZ1bmN0aW9uIChwYXRoKSB7XG4gICAgICAgIGlmIChwYXRoLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgc2hhZG93aW5nTm9kZSA9IHRoaXMuZ2V0Q29tcGxldGVOb2RlKHBhdGgpO1xuICAgICAgICAgICAgaWYgKHNoYWRvd2luZ05vZGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29tcG91bmRXcml0ZShuZXcgSW1tdXRhYmxlVHJlZV8xLkltbXV0YWJsZVRyZWUoc2hhZG93aW5nTm9kZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDb21wb3VuZFdyaXRlKHRoaXMud3JpdGVUcmVlXy5zdWJ0cmVlKHBhdGgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoaXMgQ29tcG91bmRXcml0ZSBpcyBlbXB0eSBhbmQgdGhlcmVmb3JlIGRvZXMgbm90IG1vZGlmeSBhbnkgbm9kZXMuXG4gICAgICogQHJldHVybiB7Ym9vbGVhbn0gV2hldGhlciB0aGlzIENvbXBvdW5kV3JpdGUgaXMgZW1wdHlcbiAgICAgKi9cbiAgICBDb21wb3VuZFdyaXRlLnByb3RvdHlwZS5pc0VtcHR5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy53cml0ZVRyZWVfLmlzRW1wdHkoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEFwcGxpZXMgdGhpcyBDb21wb3VuZFdyaXRlIHRvIGEgbm9kZS4gVGhlIG5vZGUgaXMgcmV0dXJuZWQgd2l0aCBhbGwgd3JpdGVzIGZyb20gdGhpcyBDb21wb3VuZFdyaXRlIGFwcGxpZWQgdG8gdGhlXG4gICAgICogbm9kZVxuICAgICAqIEBwYXJhbSB7IU5vZGV9IG5vZGUgVGhlIG5vZGUgdG8gYXBwbHkgdGhpcyBDb21wb3VuZFdyaXRlIHRvXG4gICAgICogQHJldHVybiB7IU5vZGV9IFRoZSBub2RlIHdpdGggYWxsIHdyaXRlcyBhcHBsaWVkXG4gICAgICovXG4gICAgQ29tcG91bmRXcml0ZS5wcm90b3R5cGUuYXBwbHkgPSBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICByZXR1cm4gQ29tcG91bmRXcml0ZS5hcHBseVN1YnRyZWVXcml0ZV8oUGF0aF8xLlBhdGguRW1wdHksIHRoaXMud3JpdGVUcmVlXywgbm9kZSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAdHlwZSB7IUNvbXBvdW5kV3JpdGV9XG4gICAgICovXG4gICAgQ29tcG91bmRXcml0ZS5FbXB0eSA9IG5ldyBDb21wb3VuZFdyaXRlKG5ldyBJbW11dGFibGVUcmVlXzEuSW1tdXRhYmxlVHJlZShudWxsKSk7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshUGF0aH0gcmVsYXRpdmVQYXRoXG4gICAgICogQHBhcmFtIHshSW1tdXRhYmxlVHJlZS48IU5vZGU+fSB3cml0ZVRyZWVcbiAgICAgKiBAcGFyYW0geyFOb2RlfSBub2RlXG4gICAgICogQHJldHVybiB7IU5vZGV9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBDb21wb3VuZFdyaXRlLmFwcGx5U3VidHJlZVdyaXRlXyA9IGZ1bmN0aW9uIChyZWxhdGl2ZVBhdGgsIHdyaXRlVHJlZSwgbm9kZSkge1xuICAgICAgICBpZiAod3JpdGVUcmVlLnZhbHVlICE9IG51bGwpIHtcbiAgICAgICAgICAgIC8vIFNpbmNlIHRoZXJlIGEgd3JpdGUgaXMgYWx3YXlzIGEgbGVhZiwgd2UncmUgZG9uZSBoZXJlXG4gICAgICAgICAgICByZXR1cm4gbm9kZS51cGRhdGVDaGlsZChyZWxhdGl2ZVBhdGgsIHdyaXRlVHJlZS52YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgcHJpb3JpdHlXcml0ZV8xID0gbnVsbDtcbiAgICAgICAgICAgIHdyaXRlVHJlZS5jaGlsZHJlbi5pbm9yZGVyVHJhdmVyc2FsKGZ1bmN0aW9uIChjaGlsZEtleSwgY2hpbGRUcmVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkS2V5ID09PSAnLnByaW9yaXR5Jykge1xuICAgICAgICAgICAgICAgICAgICAvLyBBcHBseSBwcmlvcml0aWVzIGF0IHRoZSBlbmQgc28gd2UgZG9uJ3QgdXBkYXRlIHByaW9yaXRpZXMgZm9yIGVpdGhlciBlbXB0eSBub2RlcyBvciBmb3JnZXRcbiAgICAgICAgICAgICAgICAgICAgLy8gdG8gYXBwbHkgcHJpb3JpdGllcyB0byBlbXB0eSBub2RlcyB0aGF0IGFyZSBsYXRlciBmaWxsZWRcbiAgICAgICAgICAgICAgICAgICAgdXRpbF8yLmFzc2VydChjaGlsZFRyZWUudmFsdWUgIT09IG51bGwsICdQcmlvcml0eSB3cml0ZXMgbXVzdCBhbHdheXMgYmUgbGVhZiBub2RlcycpO1xuICAgICAgICAgICAgICAgICAgICBwcmlvcml0eVdyaXRlXzEgPSBjaGlsZFRyZWUudmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBub2RlID0gQ29tcG91bmRXcml0ZS5hcHBseVN1YnRyZWVXcml0ZV8ocmVsYXRpdmVQYXRoLmNoaWxkKGNoaWxkS2V5KSwgY2hpbGRUcmVlLCBub2RlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIElmIHRoZXJlIHdhcyBhIHByaW9yaXR5IHdyaXRlLCB3ZSBvbmx5IGFwcGx5IGl0IGlmIHRoZSBub2RlIGlzIG5vdCBlbXB0eVxuICAgICAgICAgICAgaWYgKCFub2RlLmdldENoaWxkKHJlbGF0aXZlUGF0aCkuaXNFbXB0eSgpICYmIHByaW9yaXR5V3JpdGVfMSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIG5vZGUgPSBub2RlLnVwZGF0ZUNoaWxkKHJlbGF0aXZlUGF0aC5jaGlsZCgnLnByaW9yaXR5JyksIHByaW9yaXR5V3JpdGVfMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIENvbXBvdW5kV3JpdGU7XG59KCkpO1xuZXhwb3J0cy5Db21wb3VuZFdyaXRlID0gQ29tcG91bmRXcml0ZTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29tcG91bmRXcml0ZS5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGFwcF8xID0gcmVxdWlyZShcIkBmaXJlYmFzZS9hcHBcIik7XG52YXIgdXRpbF8xID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xudmFyIHV0aWxfMiA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvdXRpbFwiKTtcbnZhciB1dGlsXzMgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG52YXIgdXRpbF80ID0gcmVxdWlyZShcIi4vdXRpbC91dGlsXCIpO1xudmFyIFBhdGhfMSA9IHJlcXVpcmUoXCIuL3V0aWwvUGF0aFwiKTtcbnZhciBWaXNpYmlsaXR5TW9uaXRvcl8xID0gcmVxdWlyZShcIi4vdXRpbC9WaXNpYmlsaXR5TW9uaXRvclwiKTtcbnZhciBPbmxpbmVNb25pdG9yXzEgPSByZXF1aXJlKFwiLi91dGlsL09ubGluZU1vbml0b3JcIik7XG52YXIgdXRpbF81ID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xudmFyIENvbm5lY3Rpb25fMSA9IHJlcXVpcmUoXCIuLi9yZWFsdGltZS9Db25uZWN0aW9uXCIpO1xudmFyIHV0aWxfNiA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvdXRpbFwiKTtcbnZhciB1dGlsXzcgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG52YXIgU2VydmVyQWN0aW9uc18xID0gcmVxdWlyZShcIi4vU2VydmVyQWN0aW9uc1wiKTtcbnZhciBSRUNPTk5FQ1RfTUlOX0RFTEFZID0gMTAwMDtcbnZhciBSRUNPTk5FQ1RfTUFYX0RFTEFZX0RFRkFVTFQgPSA2MCAqIDUgKiAxMDAwOyAvLyA1IG1pbnV0ZXMgaW4gbWlsbGlzZWNvbmRzIChDYXNlOiAxODU4KVxudmFyIFJFQ09OTkVDVF9NQVhfREVMQVlfRk9SX0FETUlOUyA9IDMwICogMTAwMDsgLy8gMzAgc2Vjb25kcyBmb3IgYWRtaW4gY2xpZW50cyAobGlrZWx5IHRvIGJlIGEgYmFja2VuZCBzZXJ2ZXIpXG52YXIgUkVDT05ORUNUX0RFTEFZX01VTFRJUExJRVIgPSAxLjM7XG52YXIgUkVDT05ORUNUX0RFTEFZX1JFU0VUX1RJTUVPVVQgPSAzMDAwMDsgLy8gUmVzZXQgZGVsYXkgYmFjayB0byBNSU5fREVMQVkgYWZ0ZXIgYmVpbmcgY29ubmVjdGVkIGZvciAzMHNlYy5cbnZhciBTRVJWRVJfS0lMTF9JTlRFUlJVUFRfUkVBU09OID0gJ3NlcnZlcl9raWxsJztcbi8vIElmIGF1dGggZmFpbHMgcmVwZWF0ZWRseSwgd2UnbGwgYXNzdW1lIHNvbWV0aGluZyBpcyB3cm9uZyBhbmQgbG9nIGEgd2FybmluZyAvIGJhY2sgb2ZmLlxudmFyIElOVkFMSURfQVVUSF9UT0tFTl9USFJFU0hPTEQgPSAzO1xuLyoqXG4gKiBGaXJlYmFzZSBjb25uZWN0aW9uLiAgQWJzdHJhY3RzIHdpcmUgcHJvdG9jb2wgYW5kIGhhbmRsZXMgcmVjb25uZWN0aW5nLlxuICpcbiAqIE5PVEU6IEFsbCBKU09OIG9iamVjdHMgc2VudCB0byB0aGUgcmVhbHRpbWUgY29ubmVjdGlvbiBtdXN0IGhhdmUgcHJvcGVydHkgbmFtZXMgZW5jbG9zZWRcbiAqIGluIHF1b3RlcyB0byBtYWtlIHN1cmUgdGhlIGNsb3N1cmUgY29tcGlsZXIgZG9lcyBub3QgbWluaWZ5IHRoZW0uXG4gKi9cbnZhciBQZXJzaXN0ZW50Q29ubmVjdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoUGVyc2lzdGVudENvbm5lY3Rpb24sIF9zdXBlcik7XG4gICAgLyoqXG4gICAgICogQGltcGxlbWVudHMge1NlcnZlckFjdGlvbnN9XG4gICAgICogQHBhcmFtIHshUmVwb0luZm99IHJlcG9JbmZvXyBEYXRhIGFib3V0IHRoZSBuYW1lc3BhY2Ugd2UgYXJlIGNvbm5lY3RpbmcgdG9cbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKHN0cmluZywgKiwgYm9vbGVhbiwgP251bWJlcil9IG9uRGF0YVVwZGF0ZV8gQSBjYWxsYmFjayBmb3IgbmV3IGRhdGEgZnJvbSB0aGUgc2VydmVyXG4gICAgICogQHBhcmFtIG9uQ29ubmVjdFN0YXR1c19cbiAgICAgKiBAcGFyYW0gb25TZXJ2ZXJJbmZvVXBkYXRlX1xuICAgICAqIEBwYXJhbSBhdXRoVG9rZW5Qcm92aWRlcl9cbiAgICAgKiBAcGFyYW0gYXV0aE92ZXJyaWRlX1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIFBlcnNpc3RlbnRDb25uZWN0aW9uKHJlcG9JbmZvXywgb25EYXRhVXBkYXRlXywgb25Db25uZWN0U3RhdHVzXywgb25TZXJ2ZXJJbmZvVXBkYXRlXywgYXV0aFRva2VuUHJvdmlkZXJfLCBhdXRoT3ZlcnJpZGVfKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLnJlcG9JbmZvXyA9IHJlcG9JbmZvXztcbiAgICAgICAgX3RoaXMub25EYXRhVXBkYXRlXyA9IG9uRGF0YVVwZGF0ZV87XG4gICAgICAgIF90aGlzLm9uQ29ubmVjdFN0YXR1c18gPSBvbkNvbm5lY3RTdGF0dXNfO1xuICAgICAgICBfdGhpcy5vblNlcnZlckluZm9VcGRhdGVfID0gb25TZXJ2ZXJJbmZvVXBkYXRlXztcbiAgICAgICAgX3RoaXMuYXV0aFRva2VuUHJvdmlkZXJfID0gYXV0aFRva2VuUHJvdmlkZXJfO1xuICAgICAgICBfdGhpcy5hdXRoT3ZlcnJpZGVfID0gYXV0aE92ZXJyaWRlXztcbiAgICAgICAgLy8gVXNlZCBmb3IgZGlhZ25vc3RpYyBsb2dnaW5nLlxuICAgICAgICBfdGhpcy5pZCA9IFBlcnNpc3RlbnRDb25uZWN0aW9uLm5leHRQZXJzaXN0ZW50Q29ubmVjdGlvbklkXysrO1xuICAgICAgICBfdGhpcy5sb2dfID0gdXRpbF80LmxvZ1dyYXBwZXIoJ3A6JyArIF90aGlzLmlkICsgJzonKTtcbiAgICAgICAgLyoqIEBwcml2YXRlIHtPYmplY3R9ICovXG4gICAgICAgIF90aGlzLmludGVycnVwdFJlYXNvbnNfID0ge307XG4gICAgICAgIF90aGlzLmxpc3RlbnNfID0ge307XG4gICAgICAgIF90aGlzLm91dHN0YW5kaW5nUHV0c18gPSBbXTtcbiAgICAgICAgX3RoaXMub3V0c3RhbmRpbmdQdXRDb3VudF8gPSAwO1xuICAgICAgICBfdGhpcy5vbkRpc2Nvbm5lY3RSZXF1ZXN0UXVldWVfID0gW107XG4gICAgICAgIF90aGlzLmNvbm5lY3RlZF8gPSBmYWxzZTtcbiAgICAgICAgX3RoaXMucmVjb25uZWN0RGVsYXlfID0gUkVDT05ORUNUX01JTl9ERUxBWTtcbiAgICAgICAgX3RoaXMubWF4UmVjb25uZWN0RGVsYXlfID0gUkVDT05ORUNUX01BWF9ERUxBWV9ERUZBVUxUO1xuICAgICAgICBfdGhpcy5zZWN1cml0eURlYnVnQ2FsbGJhY2tfID0gbnVsbDtcbiAgICAgICAgX3RoaXMubGFzdFNlc3Npb25JZCA9IG51bGw7XG4gICAgICAgIC8qKiBAcHJpdmF0ZSB7bnVtYmVyfG51bGx9ICovXG4gICAgICAgIF90aGlzLmVzdGFibGlzaENvbm5lY3Rpb25UaW1lcl8gPSBudWxsO1xuICAgICAgICAvKiogQHByaXZhdGUge2Jvb2xlYW59ICovXG4gICAgICAgIF90aGlzLnZpc2libGVfID0gZmFsc2U7XG4gICAgICAgIC8vIEJlZm9yZSB3ZSBnZXQgY29ubmVjdGVkLCB3ZSBrZWVwIGEgcXVldWUgb2YgcGVuZGluZyBtZXNzYWdlcyB0byBzZW5kLlxuICAgICAgICBfdGhpcy5yZXF1ZXN0Q0JIYXNoXyA9IHt9O1xuICAgICAgICBfdGhpcy5yZXF1ZXN0TnVtYmVyXyA9IDA7XG4gICAgICAgIC8qKiBAcHJpdmF0ZSB7P3tcbiAgICAgICAgICogICBzZW5kUmVxdWVzdChPYmplY3QpLFxuICAgICAgICAgKiAgIGNsb3NlKClcbiAgICAgICAgICogfX0gKi9cbiAgICAgICAgX3RoaXMucmVhbHRpbWVfID0gbnVsbDtcbiAgICAgICAgLyoqIEBwcml2YXRlIHtzdHJpbmd8bnVsbH0gKi9cbiAgICAgICAgX3RoaXMuYXV0aFRva2VuXyA9IG51bGw7XG4gICAgICAgIF90aGlzLmZvcmNlVG9rZW5SZWZyZXNoXyA9IGZhbHNlO1xuICAgICAgICBfdGhpcy5pbnZhbGlkQXV0aFRva2VuQ291bnRfID0gMDtcbiAgICAgICAgX3RoaXMuZmlyc3RDb25uZWN0aW9uXyA9IHRydWU7XG4gICAgICAgIF90aGlzLmxhc3RDb25uZWN0aW9uQXR0ZW1wdFRpbWVfID0gbnVsbDtcbiAgICAgICAgX3RoaXMubGFzdENvbm5lY3Rpb25Fc3RhYmxpc2hlZFRpbWVfID0gbnVsbDtcbiAgICAgICAgaWYgKGF1dGhPdmVycmlkZV8gJiYgIXV0aWxfNy5pc05vZGVTZGsoKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBdXRoIG92ZXJyaWRlIHNwZWNpZmllZCBpbiBvcHRpb25zLCBidXQgbm90IHN1cHBvcnRlZCBvbiBub24gTm9kZS5qcyBwbGF0Zm9ybXMnKTtcbiAgICAgICAgfVxuICAgICAgICBfdGhpcy5zY2hlZHVsZUNvbm5lY3RfKDApO1xuICAgICAgICBWaXNpYmlsaXR5TW9uaXRvcl8xLlZpc2liaWxpdHlNb25pdG9yLmdldEluc3RhbmNlKCkub24oJ3Zpc2libGUnLCBfdGhpcy5vblZpc2libGVfLCBfdGhpcyk7XG4gICAgICAgIGlmIChyZXBvSW5mb18uaG9zdC5pbmRleE9mKCdmYmxvY2FsJykgPT09IC0xKSB7XG4gICAgICAgICAgICBPbmxpbmVNb25pdG9yXzEuT25saW5lTW9uaXRvci5nZXRJbnN0YW5jZSgpLm9uKCdvbmxpbmUnLCBfdGhpcy5vbk9ubGluZV8sIF90aGlzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7IXN0cmluZ30gYWN0aW9uXG4gICAgICogQHBhcmFtIHsqfSBib2R5XG4gICAgICogQHBhcmFtIHtmdW5jdGlvbigqKT19IG9uUmVzcG9uc2VcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgUGVyc2lzdGVudENvbm5lY3Rpb24ucHJvdG90eXBlLnNlbmRSZXF1ZXN0ID0gZnVuY3Rpb24gKGFjdGlvbiwgYm9keSwgb25SZXNwb25zZSkge1xuICAgICAgICB2YXIgY3VyUmVxTnVtID0gKyt0aGlzLnJlcXVlc3ROdW1iZXJfO1xuICAgICAgICB2YXIgbXNnID0geyByOiBjdXJSZXFOdW0sIGE6IGFjdGlvbiwgYjogYm9keSB9O1xuICAgICAgICB0aGlzLmxvZ18odXRpbF8yLnN0cmluZ2lmeShtc2cpKTtcbiAgICAgICAgdXRpbF8zLmFzc2VydCh0aGlzLmNvbm5lY3RlZF8sIFwic2VuZFJlcXVlc3QgY2FsbCB3aGVuIHdlJ3JlIG5vdCBjb25uZWN0ZWQgbm90IGFsbG93ZWQuXCIpO1xuICAgICAgICB0aGlzLnJlYWx0aW1lXy5zZW5kUmVxdWVzdChtc2cpO1xuICAgICAgICBpZiAob25SZXNwb25zZSkge1xuICAgICAgICAgICAgdGhpcy5yZXF1ZXN0Q0JIYXNoX1tjdXJSZXFOdW1dID0gb25SZXNwb25zZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBQZXJzaXN0ZW50Q29ubmVjdGlvbi5wcm90b3R5cGUubGlzdGVuID0gZnVuY3Rpb24gKHF1ZXJ5LCBjdXJyZW50SGFzaEZuLCB0YWcsIG9uQ29tcGxldGUpIHtcbiAgICAgICAgdmFyIHF1ZXJ5SWQgPSBxdWVyeS5xdWVyeUlkZW50aWZpZXIoKTtcbiAgICAgICAgdmFyIHBhdGhTdHJpbmcgPSBxdWVyeS5wYXRoLnRvU3RyaW5nKCk7XG4gICAgICAgIHRoaXMubG9nXygnTGlzdGVuIGNhbGxlZCBmb3IgJyArIHBhdGhTdHJpbmcgKyAnICcgKyBxdWVyeUlkKTtcbiAgICAgICAgdGhpcy5saXN0ZW5zX1twYXRoU3RyaW5nXSA9IHRoaXMubGlzdGVuc19bcGF0aFN0cmluZ10gfHwge307XG4gICAgICAgIHV0aWxfMy5hc3NlcnQocXVlcnkuZ2V0UXVlcnlQYXJhbXMoKS5pc0RlZmF1bHQoKSB8fFxuICAgICAgICAgICAgIXF1ZXJ5LmdldFF1ZXJ5UGFyYW1zKCkubG9hZHNBbGxEYXRhKCksICdsaXN0ZW4oKSBjYWxsZWQgZm9yIG5vbi1kZWZhdWx0IGJ1dCBjb21wbGV0ZSBxdWVyeScpO1xuICAgICAgICB1dGlsXzMuYXNzZXJ0KCF0aGlzLmxpc3RlbnNfW3BhdGhTdHJpbmddW3F1ZXJ5SWRdLCAnbGlzdGVuKCkgY2FsbGVkIHR3aWNlIGZvciBzYW1lIHBhdGgvcXVlcnlJZC4nKTtcbiAgICAgICAgdmFyIGxpc3RlblNwZWMgPSB7XG4gICAgICAgICAgICBvbkNvbXBsZXRlOiBvbkNvbXBsZXRlLFxuICAgICAgICAgICAgaGFzaEZuOiBjdXJyZW50SGFzaEZuLFxuICAgICAgICAgICAgcXVlcnk6IHF1ZXJ5LFxuICAgICAgICAgICAgdGFnOiB0YWdcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5saXN0ZW5zX1twYXRoU3RyaW5nXVtxdWVyeUlkXSA9IGxpc3RlblNwZWM7XG4gICAgICAgIGlmICh0aGlzLmNvbm5lY3RlZF8pIHtcbiAgICAgICAgICAgIHRoaXMuc2VuZExpc3Rlbl8obGlzdGVuU3BlYyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7IXtvbkNvbXBsZXRlKCksXG4gICAgICogICAgICAgICAgIGhhc2hGbigpOiFzdHJpbmcsXG4gICAgICogICAgICAgICAgIHF1ZXJ5OiAhUXVlcnksXG4gICAgICogICAgICAgICAgIHRhZzogP251bWJlcn19IGxpc3RlblNwZWNcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIFBlcnNpc3RlbnRDb25uZWN0aW9uLnByb3RvdHlwZS5zZW5kTGlzdGVuXyA9IGZ1bmN0aW9uIChsaXN0ZW5TcGVjKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBxdWVyeSA9IGxpc3RlblNwZWMucXVlcnk7XG4gICAgICAgIHZhciBwYXRoU3RyaW5nID0gcXVlcnkucGF0aC50b1N0cmluZygpO1xuICAgICAgICB2YXIgcXVlcnlJZCA9IHF1ZXJ5LnF1ZXJ5SWRlbnRpZmllcigpO1xuICAgICAgICB0aGlzLmxvZ18oJ0xpc3RlbiBvbiAnICsgcGF0aFN0cmluZyArICcgZm9yICcgKyBxdWVyeUlkKTtcbiAgICAgICAgdmFyIHJlcSA9IHsgLypwYXRoKi8gcDogcGF0aFN0cmluZyB9O1xuICAgICAgICB2YXIgYWN0aW9uID0gJ3EnO1xuICAgICAgICAvLyBPbmx5IGJvdGhlciB0byBzZW5kIHF1ZXJ5IGlmIGl0J3Mgbm9uLWRlZmF1bHQuXG4gICAgICAgIGlmIChsaXN0ZW5TcGVjLnRhZykge1xuICAgICAgICAgICAgcmVxWydxJ10gPSBxdWVyeS5xdWVyeU9iamVjdCgpO1xuICAgICAgICAgICAgcmVxWyd0J10gPSBsaXN0ZW5TcGVjLnRhZztcbiAgICAgICAgfVxuICAgICAgICByZXFbJ2gnXSA9IGxpc3RlblNwZWMuaGFzaEZuKCk7XG4gICAgICAgIHRoaXMuc2VuZFJlcXVlc3QoYWN0aW9uLCByZXEsIGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgICAgICB2YXIgcGF5bG9hZCA9IG1lc3NhZ2VbJ2QnXTtcbiAgICAgICAgICAgIHZhciBzdGF0dXMgPSBtZXNzYWdlWydzJ107XG4gICAgICAgICAgICAvLyBwcmludCB3YXJuaW5ncyBpbiBhbnkgY2FzZS4uLlxuICAgICAgICAgICAgUGVyc2lzdGVudENvbm5lY3Rpb24ud2Fybk9uTGlzdGVuV2FybmluZ3NfKHBheWxvYWQsIHF1ZXJ5KTtcbiAgICAgICAgICAgIHZhciBjdXJyZW50TGlzdGVuU3BlYyA9IF90aGlzLmxpc3RlbnNfW3BhdGhTdHJpbmddICYmIF90aGlzLmxpc3RlbnNfW3BhdGhTdHJpbmddW3F1ZXJ5SWRdO1xuICAgICAgICAgICAgLy8gb25seSB0cmlnZ2VyIGFjdGlvbnMgaWYgdGhlIGxpc3RlbiBoYXNuJ3QgYmVlbiByZW1vdmVkIGFuZCByZWFkZGVkXG4gICAgICAgICAgICBpZiAoY3VycmVudExpc3RlblNwZWMgPT09IGxpc3RlblNwZWMpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5sb2dfKCdsaXN0ZW4gcmVzcG9uc2UnLCBtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdHVzICE9PSAnb2snKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnJlbW92ZUxpc3Rlbl8ocGF0aFN0cmluZywgcXVlcnlJZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChsaXN0ZW5TcGVjLm9uQ29tcGxldGUpIHtcbiAgICAgICAgICAgICAgICAgICAgbGlzdGVuU3BlYy5vbkNvbXBsZXRlKHN0YXR1cywgcGF5bG9hZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7Kn0gcGF5bG9hZFxuICAgICAqIEBwYXJhbSB7IVF1ZXJ5fSBxdWVyeVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgUGVyc2lzdGVudENvbm5lY3Rpb24ud2Fybk9uTGlzdGVuV2FybmluZ3NfID0gZnVuY3Rpb24gKHBheWxvYWQsIHF1ZXJ5KSB7XG4gICAgICAgIGlmIChwYXlsb2FkICYmIHR5cGVvZiBwYXlsb2FkID09PSAnb2JqZWN0JyAmJiB1dGlsXzEuY29udGFpbnMocGF5bG9hZCwgJ3cnKSkge1xuICAgICAgICAgICAgdmFyIHdhcm5pbmdzID0gdXRpbF8xLnNhZmVHZXQocGF5bG9hZCwgJ3cnKTtcbiAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHdhcm5pbmdzKSAmJiB+d2FybmluZ3MuaW5kZXhPZignbm9faW5kZXgnKSkge1xuICAgICAgICAgICAgICAgIHZhciBpbmRleFNwZWMgPSAnXCIuaW5kZXhPblwiOiBcIicgK1xuICAgICAgICAgICAgICAgICAgICBxdWVyeVxuICAgICAgICAgICAgICAgICAgICAgICAgLmdldFF1ZXJ5UGFyYW1zKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5nZXRJbmRleCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAudG9TdHJpbmcoKSArXG4gICAgICAgICAgICAgICAgICAgICdcIic7XG4gICAgICAgICAgICAgICAgdmFyIGluZGV4UGF0aCA9IHF1ZXJ5LnBhdGgudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICB1dGlsXzQud2FybihcIlVzaW5nIGFuIHVuc3BlY2lmaWVkIGluZGV4LiBZb3VyIGRhdGEgd2lsbCBiZSBkb3dubG9hZGVkIGFuZCBcIiArXG4gICAgICAgICAgICAgICAgICAgIChcImZpbHRlcmVkIG9uIHRoZSBjbGllbnQuIENvbnNpZGVyIGFkZGluZyBcIiArIGluZGV4U3BlYyArIFwiIGF0IFwiKSArXG4gICAgICAgICAgICAgICAgICAgIChpbmRleFBhdGggKyBcIiB0byB5b3VyIHNlY3VyaXR5IHJ1bGVzIGZvciBiZXR0ZXIgcGVyZm9ybWFuY2UuXCIpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBQZXJzaXN0ZW50Q29ubmVjdGlvbi5wcm90b3R5cGUucmVmcmVzaEF1dGhUb2tlbiA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICB0aGlzLmF1dGhUb2tlbl8gPSB0b2tlbjtcbiAgICAgICAgdGhpcy5sb2dfKCdBdXRoIHRva2VuIHJlZnJlc2hlZCcpO1xuICAgICAgICBpZiAodGhpcy5hdXRoVG9rZW5fKSB7XG4gICAgICAgICAgICB0aGlzLnRyeUF1dGgoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vSWYgd2UncmUgY29ubmVjdGVkIHdlIHdhbnQgdG8gbGV0IHRoZSBzZXJ2ZXIga25vdyB0byB1bmF1dGhlbnRpY2F0ZSB1cy4gSWYgd2UncmUgbm90IGNvbm5lY3RlZCwgc2ltcGx5IGRlbGV0ZVxuICAgICAgICAgICAgLy90aGUgY3JlZGVudGlhbCBzbyB3ZSBkb250IGJlY29tZSBhdXRoZW50aWNhdGVkIG5leHQgdGltZSB3ZSBjb25uZWN0LlxuICAgICAgICAgICAgaWYgKHRoaXMuY29ubmVjdGVkXykge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VuZFJlcXVlc3QoJ3VuYXV0aCcsIHt9LCBmdW5jdGlvbiAoKSB7IH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVkdWNlUmVjb25uZWN0RGVsYXlJZkFkbWluQ3JlZGVudGlhbF8odG9rZW4pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshc3RyaW5nfSBjcmVkZW50aWFsXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBQZXJzaXN0ZW50Q29ubmVjdGlvbi5wcm90b3R5cGUucmVkdWNlUmVjb25uZWN0RGVsYXlJZkFkbWluQ3JlZGVudGlhbF8gPSBmdW5jdGlvbiAoY3JlZGVudGlhbCkge1xuICAgICAgICAvLyBOT1RFOiBUaGlzIGlzbid0IGludGVuZGVkIHRvIGJlIGJ1bGxldHByb29mIChhIG1hbGljaW91cyBkZXZlbG9wZXIgY2FuIGFsd2F5cyBqdXN0IG1vZGlmeSB0aGUgY2xpZW50KS5cbiAgICAgICAgLy8gQWRkaXRpb25hbGx5LCB3ZSBkb24ndCBib3RoZXIgcmVzZXR0aW5nIHRoZSBtYXggZGVsYXkgYmFjayB0byB0aGUgZGVmYXVsdCBpZiBhdXRoIGZhaWxzIC8gZXhwaXJlcy5cbiAgICAgICAgdmFyIGlzRmlyZWJhc2VTZWNyZXQgPSBjcmVkZW50aWFsICYmIGNyZWRlbnRpYWwubGVuZ3RoID09PSA0MDtcbiAgICAgICAgaWYgKGlzRmlyZWJhc2VTZWNyZXQgfHwgdXRpbF81LmlzQWRtaW4oY3JlZGVudGlhbCkpIHtcbiAgICAgICAgICAgIHRoaXMubG9nXygnQWRtaW4gYXV0aCBjcmVkZW50aWFsIGRldGVjdGVkLiAgUmVkdWNpbmcgbWF4IHJlY29ubmVjdCB0aW1lLicpO1xuICAgICAgICAgICAgdGhpcy5tYXhSZWNvbm5lY3REZWxheV8gPSBSRUNPTk5FQ1RfTUFYX0RFTEFZX0ZPUl9BRE1JTlM7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEF0dGVtcHRzIHRvIGF1dGhlbnRpY2F0ZSB3aXRoIHRoZSBnaXZlbiBjcmVkZW50aWFscy4gSWYgdGhlIGF1dGhlbnRpY2F0aW9uIGF0dGVtcHQgZmFpbHMsIGl0J3MgdHJpZ2dlcmVkIGxpa2VcbiAgICAgKiBhIGF1dGggcmV2b2tlZCAodGhlIGNvbm5lY3Rpb24gaXMgY2xvc2VkKS5cbiAgICAgKi9cbiAgICBQZXJzaXN0ZW50Q29ubmVjdGlvbi5wcm90b3R5cGUudHJ5QXV0aCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHRoaXMuY29ubmVjdGVkXyAmJiB0aGlzLmF1dGhUb2tlbl8pIHtcbiAgICAgICAgICAgIHZhciB0b2tlbl8xID0gdGhpcy5hdXRoVG9rZW5fO1xuICAgICAgICAgICAgdmFyIGF1dGhNZXRob2QgPSB1dGlsXzUuaXNWYWxpZEZvcm1hdCh0b2tlbl8xKSA/ICdhdXRoJyA6ICdnYXV0aCc7XG4gICAgICAgICAgICB2YXIgcmVxdWVzdERhdGEgPSB7IGNyZWQ6IHRva2VuXzEgfTtcbiAgICAgICAgICAgIGlmICh0aGlzLmF1dGhPdmVycmlkZV8gPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICByZXF1ZXN0RGF0YVsnbm9hdXRoJ10gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIHRoaXMuYXV0aE92ZXJyaWRlXyA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICByZXF1ZXN0RGF0YVsnYXV0aHZhciddID0gdGhpcy5hdXRoT3ZlcnJpZGVfO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zZW5kUmVxdWVzdChhdXRoTWV0aG9kLCByZXF1ZXN0RGF0YSwgZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgIHZhciBzdGF0dXMgPSByZXNbJ3MnXTtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHJlc1snZCddIHx8ICdlcnJvcic7XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLmF1dGhUb2tlbl8gPT09IHRva2VuXzEpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXR1cyA9PT0gJ29rJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuaW52YWxpZEF1dGhUb2tlbkNvdW50XyA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUcmlnZ2VycyByZWNvbm5lY3QgYW5kIGZvcmNlIHJlZnJlc2ggZm9yIGF1dGggdG9rZW5cbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLm9uQXV0aFJldm9rZWRfKHN0YXR1cywgZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBQZXJzaXN0ZW50Q29ubmVjdGlvbi5wcm90b3R5cGUudW5saXN0ZW4gPSBmdW5jdGlvbiAocXVlcnksIHRhZykge1xuICAgICAgICB2YXIgcGF0aFN0cmluZyA9IHF1ZXJ5LnBhdGgudG9TdHJpbmcoKTtcbiAgICAgICAgdmFyIHF1ZXJ5SWQgPSBxdWVyeS5xdWVyeUlkZW50aWZpZXIoKTtcbiAgICAgICAgdGhpcy5sb2dfKCdVbmxpc3RlbiBjYWxsZWQgZm9yICcgKyBwYXRoU3RyaW5nICsgJyAnICsgcXVlcnlJZCk7XG4gICAgICAgIHV0aWxfMy5hc3NlcnQocXVlcnkuZ2V0UXVlcnlQYXJhbXMoKS5pc0RlZmF1bHQoKSB8fFxuICAgICAgICAgICAgIXF1ZXJ5LmdldFF1ZXJ5UGFyYW1zKCkubG9hZHNBbGxEYXRhKCksICd1bmxpc3RlbigpIGNhbGxlZCBmb3Igbm9uLWRlZmF1bHQgYnV0IGNvbXBsZXRlIHF1ZXJ5Jyk7XG4gICAgICAgIHZhciBsaXN0ZW4gPSB0aGlzLnJlbW92ZUxpc3Rlbl8ocGF0aFN0cmluZywgcXVlcnlJZCk7XG4gICAgICAgIGlmIChsaXN0ZW4gJiYgdGhpcy5jb25uZWN0ZWRfKSB7XG4gICAgICAgICAgICB0aGlzLnNlbmRVbmxpc3Rlbl8ocGF0aFN0cmluZywgcXVlcnlJZCwgcXVlcnkucXVlcnlPYmplY3QoKSwgdGFnKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgUGVyc2lzdGVudENvbm5lY3Rpb24ucHJvdG90eXBlLnNlbmRVbmxpc3Rlbl8gPSBmdW5jdGlvbiAocGF0aFN0cmluZywgcXVlcnlJZCwgcXVlcnlPYmosIHRhZykge1xuICAgICAgICB0aGlzLmxvZ18oJ1VubGlzdGVuIG9uICcgKyBwYXRoU3RyaW5nICsgJyBmb3IgJyArIHF1ZXJ5SWQpO1xuICAgICAgICB2YXIgcmVxID0geyAvKnBhdGgqLyBwOiBwYXRoU3RyaW5nIH07XG4gICAgICAgIHZhciBhY3Rpb24gPSAnbic7XG4gICAgICAgIC8vIE9ubHkgYm90aGVyIHNlbmRpbmcgcXVlcnlJZCBpZiBpdCdzIG5vbi1kZWZhdWx0LlxuICAgICAgICBpZiAodGFnKSB7XG4gICAgICAgICAgICByZXFbJ3EnXSA9IHF1ZXJ5T2JqO1xuICAgICAgICAgICAgcmVxWyd0J10gPSB0YWc7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZW5kUmVxdWVzdChhY3Rpb24sIHJlcSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIFBlcnNpc3RlbnRDb25uZWN0aW9uLnByb3RvdHlwZS5vbkRpc2Nvbm5lY3RQdXQgPSBmdW5jdGlvbiAocGF0aFN0cmluZywgZGF0YSwgb25Db21wbGV0ZSkge1xuICAgICAgICBpZiAodGhpcy5jb25uZWN0ZWRfKSB7XG4gICAgICAgICAgICB0aGlzLnNlbmRPbkRpc2Nvbm5lY3RfKCdvJywgcGF0aFN0cmluZywgZGF0YSwgb25Db21wbGV0ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm9uRGlzY29ubmVjdFJlcXVlc3RRdWV1ZV8ucHVzaCh7XG4gICAgICAgICAgICAgICAgcGF0aFN0cmluZzogcGF0aFN0cmluZyxcbiAgICAgICAgICAgICAgICBhY3Rpb246ICdvJyxcbiAgICAgICAgICAgICAgICBkYXRhOiBkYXRhLFxuICAgICAgICAgICAgICAgIG9uQ29tcGxldGU6IG9uQ29tcGxldGVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIFBlcnNpc3RlbnRDb25uZWN0aW9uLnByb3RvdHlwZS5vbkRpc2Nvbm5lY3RNZXJnZSA9IGZ1bmN0aW9uIChwYXRoU3RyaW5nLCBkYXRhLCBvbkNvbXBsZXRlKSB7XG4gICAgICAgIGlmICh0aGlzLmNvbm5lY3RlZF8pIHtcbiAgICAgICAgICAgIHRoaXMuc2VuZE9uRGlzY29ubmVjdF8oJ29tJywgcGF0aFN0cmluZywgZGF0YSwgb25Db21wbGV0ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm9uRGlzY29ubmVjdFJlcXVlc3RRdWV1ZV8ucHVzaCh7XG4gICAgICAgICAgICAgICAgcGF0aFN0cmluZzogcGF0aFN0cmluZyxcbiAgICAgICAgICAgICAgICBhY3Rpb246ICdvbScsXG4gICAgICAgICAgICAgICAgZGF0YTogZGF0YSxcbiAgICAgICAgICAgICAgICBvbkNvbXBsZXRlOiBvbkNvbXBsZXRlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBQZXJzaXN0ZW50Q29ubmVjdGlvbi5wcm90b3R5cGUub25EaXNjb25uZWN0Q2FuY2VsID0gZnVuY3Rpb24gKHBhdGhTdHJpbmcsIG9uQ29tcGxldGUpIHtcbiAgICAgICAgaWYgKHRoaXMuY29ubmVjdGVkXykge1xuICAgICAgICAgICAgdGhpcy5zZW5kT25EaXNjb25uZWN0Xygnb2MnLCBwYXRoU3RyaW5nLCBudWxsLCBvbkNvbXBsZXRlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMub25EaXNjb25uZWN0UmVxdWVzdFF1ZXVlXy5wdXNoKHtcbiAgICAgICAgICAgICAgICBwYXRoU3RyaW5nOiBwYXRoU3RyaW5nLFxuICAgICAgICAgICAgICAgIGFjdGlvbjogJ29jJyxcbiAgICAgICAgICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICAgICAgICAgIG9uQ29tcGxldGU6IG9uQ29tcGxldGVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBQZXJzaXN0ZW50Q29ubmVjdGlvbi5wcm90b3R5cGUuc2VuZE9uRGlzY29ubmVjdF8gPSBmdW5jdGlvbiAoYWN0aW9uLCBwYXRoU3RyaW5nLCBkYXRhLCBvbkNvbXBsZXRlKSB7XG4gICAgICAgIHZhciByZXF1ZXN0ID0geyAvKnBhdGgqLyBwOiBwYXRoU3RyaW5nLCAvKmRhdGEqLyBkOiBkYXRhIH07XG4gICAgICAgIHRoaXMubG9nXygnb25EaXNjb25uZWN0ICcgKyBhY3Rpb24sIHJlcXVlc3QpO1xuICAgICAgICB0aGlzLnNlbmRSZXF1ZXN0KGFjdGlvbiwgcmVxdWVzdCwgZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBpZiAob25Db21wbGV0ZSkge1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBvbkNvbXBsZXRlKHJlc3BvbnNlWydzJ10sIHJlc3BvbnNlWydkJ10pO1xuICAgICAgICAgICAgICAgIH0sIE1hdGguZmxvb3IoMCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgUGVyc2lzdGVudENvbm5lY3Rpb24ucHJvdG90eXBlLnB1dCA9IGZ1bmN0aW9uIChwYXRoU3RyaW5nLCBkYXRhLCBvbkNvbXBsZXRlLCBoYXNoKSB7XG4gICAgICAgIHRoaXMucHV0SW50ZXJuYWwoJ3AnLCBwYXRoU3RyaW5nLCBkYXRhLCBvbkNvbXBsZXRlLCBoYXNoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgUGVyc2lzdGVudENvbm5lY3Rpb24ucHJvdG90eXBlLm1lcmdlID0gZnVuY3Rpb24gKHBhdGhTdHJpbmcsIGRhdGEsIG9uQ29tcGxldGUsIGhhc2gpIHtcbiAgICAgICAgdGhpcy5wdXRJbnRlcm5hbCgnbScsIHBhdGhTdHJpbmcsIGRhdGEsIG9uQ29tcGxldGUsIGhhc2gpO1xuICAgIH07XG4gICAgUGVyc2lzdGVudENvbm5lY3Rpb24ucHJvdG90eXBlLnB1dEludGVybmFsID0gZnVuY3Rpb24gKGFjdGlvbiwgcGF0aFN0cmluZywgZGF0YSwgb25Db21wbGV0ZSwgaGFzaCkge1xuICAgICAgICB2YXIgcmVxdWVzdCA9IHtcbiAgICAgICAgICAgIC8qcGF0aCovIHA6IHBhdGhTdHJpbmcsXG4gICAgICAgICAgICAvKmRhdGEqLyBkOiBkYXRhXG4gICAgICAgIH07XG4gICAgICAgIGlmIChoYXNoICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICByZXF1ZXN0WydoJ10gPSBoYXNoO1xuICAgICAgICAvLyBUT0RPOiBPbmx5IGtlZXAgdHJhY2sgb2YgdGhlIG1vc3QgcmVjZW50IHB1dCBmb3IgYSBnaXZlbiBwYXRoP1xuICAgICAgICB0aGlzLm91dHN0YW5kaW5nUHV0c18ucHVzaCh7XG4gICAgICAgICAgICBhY3Rpb246IGFjdGlvbixcbiAgICAgICAgICAgIHJlcXVlc3Q6IHJlcXVlc3QsXG4gICAgICAgICAgICBvbkNvbXBsZXRlOiBvbkNvbXBsZXRlXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLm91dHN0YW5kaW5nUHV0Q291bnRfKys7XG4gICAgICAgIHZhciBpbmRleCA9IHRoaXMub3V0c3RhbmRpbmdQdXRzXy5sZW5ndGggLSAxO1xuICAgICAgICBpZiAodGhpcy5jb25uZWN0ZWRfKSB7XG4gICAgICAgICAgICB0aGlzLnNlbmRQdXRfKGluZGV4KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubG9nXygnQnVmZmVyaW5nIHB1dDogJyArIHBhdGhTdHJpbmcpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBQZXJzaXN0ZW50Q29ubmVjdGlvbi5wcm90b3R5cGUuc2VuZFB1dF8gPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGFjdGlvbiA9IHRoaXMub3V0c3RhbmRpbmdQdXRzX1tpbmRleF0uYWN0aW9uO1xuICAgICAgICB2YXIgcmVxdWVzdCA9IHRoaXMub3V0c3RhbmRpbmdQdXRzX1tpbmRleF0ucmVxdWVzdDtcbiAgICAgICAgdmFyIG9uQ29tcGxldGUgPSB0aGlzLm91dHN0YW5kaW5nUHV0c19baW5kZXhdLm9uQ29tcGxldGU7XG4gICAgICAgIHRoaXMub3V0c3RhbmRpbmdQdXRzX1tpbmRleF0ucXVldWVkID0gdGhpcy5jb25uZWN0ZWRfO1xuICAgICAgICB0aGlzLnNlbmRSZXF1ZXN0KGFjdGlvbiwgcmVxdWVzdCwgZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgIF90aGlzLmxvZ18oYWN0aW9uICsgJyByZXNwb25zZScsIG1lc3NhZ2UpO1xuICAgICAgICAgICAgZGVsZXRlIF90aGlzLm91dHN0YW5kaW5nUHV0c19baW5kZXhdO1xuICAgICAgICAgICAgX3RoaXMub3V0c3RhbmRpbmdQdXRDb3VudF8tLTtcbiAgICAgICAgICAgIC8vIENsZWFuIHVwIGFycmF5IG9jY2FzaW9uYWxseS5cbiAgICAgICAgICAgIGlmIChfdGhpcy5vdXRzdGFuZGluZ1B1dENvdW50XyA9PT0gMCkge1xuICAgICAgICAgICAgICAgIF90aGlzLm91dHN0YW5kaW5nUHV0c18gPSBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvbkNvbXBsZXRlKVxuICAgICAgICAgICAgICAgIG9uQ29tcGxldGUobWVzc2FnZVsncyddLCBtZXNzYWdlWydkJ10pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgUGVyc2lzdGVudENvbm5lY3Rpb24ucHJvdG90eXBlLnJlcG9ydFN0YXRzID0gZnVuY3Rpb24gKHN0YXRzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIC8vIElmIHdlJ3JlIG5vdCBjb25uZWN0ZWQsIHdlIGp1c3QgZHJvcCB0aGUgc3RhdHMuXG4gICAgICAgIGlmICh0aGlzLmNvbm5lY3RlZF8pIHtcbiAgICAgICAgICAgIHZhciByZXF1ZXN0ID0geyAvKmNvdW50ZXJzKi8gYzogc3RhdHMgfTtcbiAgICAgICAgICAgIHRoaXMubG9nXygncmVwb3J0U3RhdHMnLCByZXF1ZXN0KTtcbiAgICAgICAgICAgIHRoaXMuc2VuZFJlcXVlc3QoLypzdGF0cyovICdzJywgcmVxdWVzdCwgZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHZhciBzdGF0dXMgPSByZXN1bHRbJ3MnXTtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdHVzICE9PSAnb2snKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlcnJvclJlYXNvbiA9IHJlc3VsdFsnZCddO1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5sb2dfKCdyZXBvcnRTdGF0cycsICdFcnJvciBzZW5kaW5nIHN0YXRzOiAnICsgZXJyb3JSZWFzb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyp9IG1lc3NhZ2VcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIFBlcnNpc3RlbnRDb25uZWN0aW9uLnByb3RvdHlwZS5vbkRhdGFNZXNzYWdlXyA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgIGlmICgncicgaW4gbWVzc2FnZSkge1xuICAgICAgICAgICAgLy8gdGhpcyBpcyBhIHJlc3BvbnNlXG4gICAgICAgICAgICB0aGlzLmxvZ18oJ2Zyb20gc2VydmVyOiAnICsgdXRpbF8yLnN0cmluZ2lmeShtZXNzYWdlKSk7XG4gICAgICAgICAgICB2YXIgcmVxTnVtID0gbWVzc2FnZVsnciddO1xuICAgICAgICAgICAgdmFyIG9uUmVzcG9uc2UgPSB0aGlzLnJlcXVlc3RDQkhhc2hfW3JlcU51bV07XG4gICAgICAgICAgICBpZiAob25SZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnJlcXVlc3RDQkhhc2hfW3JlcU51bV07XG4gICAgICAgICAgICAgICAgb25SZXNwb25zZShtZXNzYWdlWydiJ10pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCdlcnJvcicgaW4gbWVzc2FnZSkge1xuICAgICAgICAgICAgdGhyb3cgJ0Egc2VydmVyLXNpZGUgZXJyb3IgaGFzIG9jY3VycmVkOiAnICsgbWVzc2FnZVsnZXJyb3InXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICgnYScgaW4gbWVzc2FnZSkge1xuICAgICAgICAgICAgLy8gYSBhbmQgYiBhcmUgYWN0aW9uIGFuZCBib2R5LCByZXNwZWN0aXZlbHlcbiAgICAgICAgICAgIHRoaXMub25EYXRhUHVzaF8obWVzc2FnZVsnYSddLCBtZXNzYWdlWydiJ10pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBQZXJzaXN0ZW50Q29ubmVjdGlvbi5wcm90b3R5cGUub25EYXRhUHVzaF8gPSBmdW5jdGlvbiAoYWN0aW9uLCBib2R5KSB7XG4gICAgICAgIHRoaXMubG9nXygnaGFuZGxlU2VydmVyTWVzc2FnZScsIGFjdGlvbiwgYm9keSk7XG4gICAgICAgIGlmIChhY3Rpb24gPT09ICdkJylcbiAgICAgICAgICAgIHRoaXMub25EYXRhVXBkYXRlXyhib2R5WydwJ10sIGJvZHlbJ2QnXSwgXG4gICAgICAgICAgICAvKmlzTWVyZ2UqLyBmYWxzZSwgYm9keVsndCddKTtcbiAgICAgICAgZWxzZSBpZiAoYWN0aW9uID09PSAnbScpXG4gICAgICAgICAgICB0aGlzLm9uRGF0YVVwZGF0ZV8oYm9keVsncCddLCBib2R5WydkJ10sIFxuICAgICAgICAgICAgLyppc01lcmdlPSovIHRydWUsIGJvZHlbJ3QnXSk7XG4gICAgICAgIGVsc2UgaWYgKGFjdGlvbiA9PT0gJ2MnKVxuICAgICAgICAgICAgdGhpcy5vbkxpc3RlblJldm9rZWRfKGJvZHlbJ3AnXSwgYm9keVsncSddKTtcbiAgICAgICAgZWxzZSBpZiAoYWN0aW9uID09PSAnYWMnKVxuICAgICAgICAgICAgdGhpcy5vbkF1dGhSZXZva2VkXyhib2R5WydzJ10sIGJvZHlbJ2QnXSk7XG4gICAgICAgIGVsc2UgaWYgKGFjdGlvbiA9PT0gJ3NkJylcbiAgICAgICAgICAgIHRoaXMub25TZWN1cml0eURlYnVnUGFja2V0Xyhib2R5KTtcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgdXRpbF80LmVycm9yKCdVbnJlY29nbml6ZWQgYWN0aW9uIHJlY2VpdmVkIGZyb20gc2VydmVyOiAnICtcbiAgICAgICAgICAgICAgICB1dGlsXzIuc3RyaW5naWZ5KGFjdGlvbikgK1xuICAgICAgICAgICAgICAgICdcXG5BcmUgeW91IHVzaW5nIHRoZSBsYXRlc3QgY2xpZW50PycpO1xuICAgIH07XG4gICAgUGVyc2lzdGVudENvbm5lY3Rpb24ucHJvdG90eXBlLm9uUmVhZHlfID0gZnVuY3Rpb24gKHRpbWVzdGFtcCwgc2Vzc2lvbklkKSB7XG4gICAgICAgIHRoaXMubG9nXygnY29ubmVjdGlvbiByZWFkeScpO1xuICAgICAgICB0aGlzLmNvbm5lY3RlZF8gPSB0cnVlO1xuICAgICAgICB0aGlzLmxhc3RDb25uZWN0aW9uRXN0YWJsaXNoZWRUaW1lXyA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgICAgICB0aGlzLmhhbmRsZVRpbWVzdGFtcF8odGltZXN0YW1wKTtcbiAgICAgICAgdGhpcy5sYXN0U2Vzc2lvbklkID0gc2Vzc2lvbklkO1xuICAgICAgICBpZiAodGhpcy5maXJzdENvbm5lY3Rpb25fKSB7XG4gICAgICAgICAgICB0aGlzLnNlbmRDb25uZWN0U3RhdHNfKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZXN0b3JlU3RhdGVfKCk7XG4gICAgICAgIHRoaXMuZmlyc3RDb25uZWN0aW9uXyA9IGZhbHNlO1xuICAgICAgICB0aGlzLm9uQ29ubmVjdFN0YXR1c18odHJ1ZSk7XG4gICAgfTtcbiAgICBQZXJzaXN0ZW50Q29ubmVjdGlvbi5wcm90b3R5cGUuc2NoZWR1bGVDb25uZWN0XyA9IGZ1bmN0aW9uICh0aW1lb3V0KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHV0aWxfMy5hc3NlcnQoIXRoaXMucmVhbHRpbWVfLCBcIlNjaGVkdWxpbmcgYSBjb25uZWN0IHdoZW4gd2UncmUgYWxyZWFkeSBjb25uZWN0ZWQvaW5nP1wiKTtcbiAgICAgICAgaWYgKHRoaXMuZXN0YWJsaXNoQ29ubmVjdGlvblRpbWVyXykge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuZXN0YWJsaXNoQ29ubmVjdGlvblRpbWVyXyk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gTk9URTogRXZlbiB3aGVuIHRpbWVvdXQgaXMgMCwgaXQncyBpbXBvcnRhbnQgdG8gZG8gYSBzZXRUaW1lb3V0IHRvIHdvcmsgYXJvdW5kIGFuIGluZnVyaWF0aW5nIFwiU2VjdXJpdHkgRXJyb3JcIiBpblxuICAgICAgICAvLyBGaXJlZm94IHdoZW4gdHJ5aW5nIHRvIHdyaXRlIHRvIG91ciBsb25nLXBvbGxpbmcgaWZyYW1lIGluIHNvbWUgc2NlbmFyaW9zIChlLmcuIEZvcmdlIG9yIG91ciB1bml0IHRlc3RzKS5cbiAgICAgICAgdGhpcy5lc3RhYmxpc2hDb25uZWN0aW9uVGltZXJfID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfdGhpcy5lc3RhYmxpc2hDb25uZWN0aW9uVGltZXJfID0gbnVsbDtcbiAgICAgICAgICAgIF90aGlzLmVzdGFibGlzaENvbm5lY3Rpb25fKCk7XG4gICAgICAgIH0sIE1hdGguZmxvb3IodGltZW91dCkpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtib29sZWFufSB2aXNpYmxlXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBQZXJzaXN0ZW50Q29ubmVjdGlvbi5wcm90b3R5cGUub25WaXNpYmxlXyA9IGZ1bmN0aW9uICh2aXNpYmxlKSB7XG4gICAgICAgIC8vIE5PVEU6IFRhYmJpbmcgYXdheSBhbmQgYmFjayB0byBhIHdpbmRvdyB3aWxsIGRlZmVhdCBvdXIgcmVjb25uZWN0IGJhY2tvZmYsIGJ1dCBJIHRoaW5rIHRoYXQncyBmaW5lLlxuICAgICAgICBpZiAodmlzaWJsZSAmJlxuICAgICAgICAgICAgIXRoaXMudmlzaWJsZV8gJiZcbiAgICAgICAgICAgIHRoaXMucmVjb25uZWN0RGVsYXlfID09PSB0aGlzLm1heFJlY29ubmVjdERlbGF5Xykge1xuICAgICAgICAgICAgdGhpcy5sb2dfKCdXaW5kb3cgYmVjYW1lIHZpc2libGUuICBSZWR1Y2luZyBkZWxheS4nKTtcbiAgICAgICAgICAgIHRoaXMucmVjb25uZWN0RGVsYXlfID0gUkVDT05ORUNUX01JTl9ERUxBWTtcbiAgICAgICAgICAgIGlmICghdGhpcy5yZWFsdGltZV8pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNjaGVkdWxlQ29ubmVjdF8oMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy52aXNpYmxlXyA9IHZpc2libGU7XG4gICAgfTtcbiAgICBQZXJzaXN0ZW50Q29ubmVjdGlvbi5wcm90b3R5cGUub25PbmxpbmVfID0gZnVuY3Rpb24gKG9ubGluZSkge1xuICAgICAgICBpZiAob25saW5lKSB7XG4gICAgICAgICAgICB0aGlzLmxvZ18oJ0Jyb3dzZXIgd2VudCBvbmxpbmUuJyk7XG4gICAgICAgICAgICB0aGlzLnJlY29ubmVjdERlbGF5XyA9IFJFQ09OTkVDVF9NSU5fREVMQVk7XG4gICAgICAgICAgICBpZiAoIXRoaXMucmVhbHRpbWVfKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zY2hlZHVsZUNvbm5lY3RfKDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5sb2dfKCdCcm93c2VyIHdlbnQgb2ZmbGluZS4gIEtpbGxpbmcgY29ubmVjdGlvbi4nKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnJlYWx0aW1lXykge1xuICAgICAgICAgICAgICAgIHRoaXMucmVhbHRpbWVfLmNsb3NlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFBlcnNpc3RlbnRDb25uZWN0aW9uLnByb3RvdHlwZS5vblJlYWx0aW1lRGlzY29ubmVjdF8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMubG9nXygnZGF0YSBjbGllbnQgZGlzY29ubmVjdGVkJyk7XG4gICAgICAgIHRoaXMuY29ubmVjdGVkXyA9IGZhbHNlO1xuICAgICAgICB0aGlzLnJlYWx0aW1lXyA9IG51bGw7XG4gICAgICAgIC8vIFNpbmNlIHdlIGRvbid0IGtub3cgaWYgb3VyIHNlbnQgdHJhbnNhY3Rpb25zIHN1Y2NlZWRlZCBvciBub3QsIHdlIG5lZWQgdG8gY2FuY2VsIHRoZW0uXG4gICAgICAgIHRoaXMuY2FuY2VsU2VudFRyYW5zYWN0aW9uc18oKTtcbiAgICAgICAgLy8gQ2xlYXIgb3V0IHRoZSBwZW5kaW5nIHJlcXVlc3RzLlxuICAgICAgICB0aGlzLnJlcXVlc3RDQkhhc2hfID0ge307XG4gICAgICAgIGlmICh0aGlzLnNob3VsZFJlY29ubmVjdF8oKSkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnZpc2libGVfKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2dfKFwiV2luZG93IGlzbid0IHZpc2libGUuICBEZWxheWluZyByZWNvbm5lY3QuXCIpO1xuICAgICAgICAgICAgICAgIHRoaXMucmVjb25uZWN0RGVsYXlfID0gdGhpcy5tYXhSZWNvbm5lY3REZWxheV87XG4gICAgICAgICAgICAgICAgdGhpcy5sYXN0Q29ubmVjdGlvbkF0dGVtcHRUaW1lXyA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5sYXN0Q29ubmVjdGlvbkVzdGFibGlzaGVkVGltZV8pIHtcbiAgICAgICAgICAgICAgICAvLyBJZiB3ZSd2ZSBiZWVuIGNvbm5lY3RlZCBsb25nIGVub3VnaCwgcmVzZXQgcmVjb25uZWN0IGRlbGF5IHRvIG1pbmltdW0uXG4gICAgICAgICAgICAgICAgdmFyIHRpbWVTaW5jZUxhc3RDb25uZWN0U3VjY2VlZGVkID0gbmV3IERhdGUoKS5nZXRUaW1lKCkgLSB0aGlzLmxhc3RDb25uZWN0aW9uRXN0YWJsaXNoZWRUaW1lXztcbiAgICAgICAgICAgICAgICBpZiAodGltZVNpbmNlTGFzdENvbm5lY3RTdWNjZWVkZWQgPiBSRUNPTk5FQ1RfREVMQVlfUkVTRVRfVElNRU9VVClcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWNvbm5lY3REZWxheV8gPSBSRUNPTk5FQ1RfTUlOX0RFTEFZO1xuICAgICAgICAgICAgICAgIHRoaXMubGFzdENvbm5lY3Rpb25Fc3RhYmxpc2hlZFRpbWVfID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB0aW1lU2luY2VMYXN0Q29ubmVjdEF0dGVtcHQgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKSAtIHRoaXMubGFzdENvbm5lY3Rpb25BdHRlbXB0VGltZV87XG4gICAgICAgICAgICB2YXIgcmVjb25uZWN0RGVsYXkgPSBNYXRoLm1heCgwLCB0aGlzLnJlY29ubmVjdERlbGF5XyAtIHRpbWVTaW5jZUxhc3RDb25uZWN0QXR0ZW1wdCk7XG4gICAgICAgICAgICByZWNvbm5lY3REZWxheSA9IE1hdGgucmFuZG9tKCkgKiByZWNvbm5lY3REZWxheTtcbiAgICAgICAgICAgIHRoaXMubG9nXygnVHJ5aW5nIHRvIHJlY29ubmVjdCBpbiAnICsgcmVjb25uZWN0RGVsYXkgKyAnbXMnKTtcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVDb25uZWN0XyhyZWNvbm5lY3REZWxheSk7XG4gICAgICAgICAgICAvLyBBZGp1c3QgcmVjb25uZWN0IGRlbGF5IGZvciBuZXh0IHRpbWUuXG4gICAgICAgICAgICB0aGlzLnJlY29ubmVjdERlbGF5XyA9IE1hdGgubWluKHRoaXMubWF4UmVjb25uZWN0RGVsYXlfLCB0aGlzLnJlY29ubmVjdERlbGF5XyAqIFJFQ09OTkVDVF9ERUxBWV9NVUxUSVBMSUVSKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm9uQ29ubmVjdFN0YXR1c18oZmFsc2UpO1xuICAgIH07XG4gICAgUGVyc2lzdGVudENvbm5lY3Rpb24ucHJvdG90eXBlLmVzdGFibGlzaENvbm5lY3Rpb25fID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5zaG91bGRSZWNvbm5lY3RfKCkpIHtcbiAgICAgICAgICAgIHRoaXMubG9nXygnTWFraW5nIGEgY29ubmVjdGlvbiBhdHRlbXB0Jyk7XG4gICAgICAgICAgICB0aGlzLmxhc3RDb25uZWN0aW9uQXR0ZW1wdFRpbWVfID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gICAgICAgICAgICB0aGlzLmxhc3RDb25uZWN0aW9uRXN0YWJsaXNoZWRUaW1lXyA9IG51bGw7XG4gICAgICAgICAgICB2YXIgb25EYXRhTWVzc2FnZV8xID0gdGhpcy5vbkRhdGFNZXNzYWdlXy5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgdmFyIG9uUmVhZHlfMSA9IHRoaXMub25SZWFkeV8uYmluZCh0aGlzKTtcbiAgICAgICAgICAgIHZhciBvbkRpc2Nvbm5lY3RfMSA9IHRoaXMub25SZWFsdGltZURpc2Nvbm5lY3RfLmJpbmQodGhpcyk7XG4gICAgICAgICAgICB2YXIgY29ubklkXzEgPSB0aGlzLmlkICsgJzonICsgUGVyc2lzdGVudENvbm5lY3Rpb24ubmV4dENvbm5lY3Rpb25JZF8rKztcbiAgICAgICAgICAgIHZhciBzZWxmXzEgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIGxhc3RTZXNzaW9uSWRfMSA9IHRoaXMubGFzdFNlc3Npb25JZDtcbiAgICAgICAgICAgIHZhciBjYW5jZWxlZF8xID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgY29ubmVjdGlvbl8xID0gbnVsbDtcbiAgICAgICAgICAgIHZhciBjbG9zZUZuXzEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbm5lY3Rpb25fMSkge1xuICAgICAgICAgICAgICAgICAgICBjb25uZWN0aW9uXzEuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbmNlbGVkXzEgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBvbkRpc2Nvbm5lY3RfMSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgc2VuZFJlcXVlc3RGbiA9IGZ1bmN0aW9uIChtc2cpIHtcbiAgICAgICAgICAgICAgICB1dGlsXzMuYXNzZXJ0KGNvbm5lY3Rpb25fMSwgXCJzZW5kUmVxdWVzdCBjYWxsIHdoZW4gd2UncmUgbm90IGNvbm5lY3RlZCBub3QgYWxsb3dlZC5cIik7XG4gICAgICAgICAgICAgICAgY29ubmVjdGlvbl8xLnNlbmRSZXF1ZXN0KG1zZyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5yZWFsdGltZV8gPSB7XG4gICAgICAgICAgICAgICAgY2xvc2U6IGNsb3NlRm5fMSxcbiAgICAgICAgICAgICAgICBzZW5kUmVxdWVzdDogc2VuZFJlcXVlc3RGblxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBmb3JjZVJlZnJlc2ggPSB0aGlzLmZvcmNlVG9rZW5SZWZyZXNoXztcbiAgICAgICAgICAgIHRoaXMuZm9yY2VUb2tlblJlZnJlc2hfID0gZmFsc2U7XG4gICAgICAgICAgICAvLyBGaXJzdCBmZXRjaCBhdXRoIHRva2VuLCBhbmQgZXN0YWJsaXNoIGNvbm5lY3Rpb24gYWZ0ZXIgZmV0Y2hpbmcgdGhlIHRva2VuIHdhcyBzdWNjZXNzZnVsXG4gICAgICAgICAgICB0aGlzLmF1dGhUb2tlblByb3ZpZGVyX1xuICAgICAgICAgICAgICAgIC5nZXRUb2tlbihmb3JjZVJlZnJlc2gpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGlmICghY2FuY2VsZWRfMSkge1xuICAgICAgICAgICAgICAgICAgICB1dGlsXzQubG9nKCdnZXRUb2tlbigpIGNvbXBsZXRlZC4gQ3JlYXRpbmcgY29ubmVjdGlvbi4nKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZl8xLmF1dGhUb2tlbl8gPSByZXN1bHQgJiYgcmVzdWx0LmFjY2Vzc1Rva2VuO1xuICAgICAgICAgICAgICAgICAgICBjb25uZWN0aW9uXzEgPSBuZXcgQ29ubmVjdGlvbl8xLkNvbm5lY3Rpb24oY29ubklkXzEsIHNlbGZfMS5yZXBvSW5mb18sIG9uRGF0YU1lc3NhZ2VfMSwgb25SZWFkeV8xLCBvbkRpc2Nvbm5lY3RfMSwgXG4gICAgICAgICAgICAgICAgICAgIC8qIG9uS2lsbD0gKi8gZnVuY3Rpb24gKHJlYXNvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXRpbF80Lndhcm4ocmVhc29uICsgJyAoJyArIHNlbGZfMS5yZXBvSW5mb18udG9TdHJpbmcoKSArICcpJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmXzEuaW50ZXJydXB0KFNFUlZFUl9LSUxMX0lOVEVSUlVQVF9SRUFTT04pO1xuICAgICAgICAgICAgICAgICAgICB9LCBsYXN0U2Vzc2lvbklkXzEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdXRpbF80LmxvZygnZ2V0VG9rZW4oKSBjb21wbGV0ZWQgYnV0IHdhcyBjYW5jZWxlZCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLnRoZW4obnVsbCwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgc2VsZl8xLmxvZ18oJ0ZhaWxlZCB0byBnZXQgdG9rZW46ICcgKyBlcnJvcik7XG4gICAgICAgICAgICAgICAgaWYgKCFjYW5jZWxlZF8xKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh1dGlsXzYuQ09OU1RBTlRTLk5PREVfQURNSU4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgbWF5IGJlIGEgY3JpdGljYWwgZXJyb3IgZm9yIHRoZSBBZG1pbiBOb2RlLmpzIFNESywgc28gbG9nIGEgd2FybmluZy5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEJ1dCBnZXRUb2tlbigpIG1heSBhbHNvIGp1c3QgaGF2ZSB0ZW1wb3JhcmlseSBmYWlsZWQsIHNvIHdlIHN0aWxsIHdhbnQgdG9cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnRpbnVlIHJldHJ5aW5nLlxuICAgICAgICAgICAgICAgICAgICAgICAgdXRpbF80Lndhcm4oZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNsb3NlRm5fMSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcmVhc29uXG4gICAgICovXG4gICAgUGVyc2lzdGVudENvbm5lY3Rpb24ucHJvdG90eXBlLmludGVycnVwdCA9IGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgICAgdXRpbF80LmxvZygnSW50ZXJydXB0aW5nIGNvbm5lY3Rpb24gZm9yIHJlYXNvbjogJyArIHJlYXNvbik7XG4gICAgICAgIHRoaXMuaW50ZXJydXB0UmVhc29uc19bcmVhc29uXSA9IHRydWU7XG4gICAgICAgIGlmICh0aGlzLnJlYWx0aW1lXykge1xuICAgICAgICAgICAgdGhpcy5yZWFsdGltZV8uY2xvc2UoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmVzdGFibGlzaENvbm5lY3Rpb25UaW1lcl8pIHtcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5lc3RhYmxpc2hDb25uZWN0aW9uVGltZXJfKTtcbiAgICAgICAgICAgICAgICB0aGlzLmVzdGFibGlzaENvbm5lY3Rpb25UaW1lcl8gPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuY29ubmVjdGVkXykge1xuICAgICAgICAgICAgICAgIHRoaXMub25SZWFsdGltZURpc2Nvbm5lY3RfKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSByZWFzb25cbiAgICAgKi9cbiAgICBQZXJzaXN0ZW50Q29ubmVjdGlvbi5wcm90b3R5cGUucmVzdW1lID0gZnVuY3Rpb24gKHJlYXNvbikge1xuICAgICAgICB1dGlsXzQubG9nKCdSZXN1bWluZyBjb25uZWN0aW9uIGZvciByZWFzb246ICcgKyByZWFzb24pO1xuICAgICAgICBkZWxldGUgdGhpcy5pbnRlcnJ1cHRSZWFzb25zX1tyZWFzb25dO1xuICAgICAgICBpZiAodXRpbF8xLmlzRW1wdHkodGhpcy5pbnRlcnJ1cHRSZWFzb25zXykpIHtcbiAgICAgICAgICAgIHRoaXMucmVjb25uZWN0RGVsYXlfID0gUkVDT05ORUNUX01JTl9ERUxBWTtcbiAgICAgICAgICAgIGlmICghdGhpcy5yZWFsdGltZV8pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNjaGVkdWxlQ29ubmVjdF8oMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFBlcnNpc3RlbnRDb25uZWN0aW9uLnByb3RvdHlwZS5oYW5kbGVUaW1lc3RhbXBfID0gZnVuY3Rpb24gKHRpbWVzdGFtcCkge1xuICAgICAgICB2YXIgZGVsdGEgPSB0aW1lc3RhbXAgLSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgICAgICAgdGhpcy5vblNlcnZlckluZm9VcGRhdGVfKHsgc2VydmVyVGltZU9mZnNldDogZGVsdGEgfSk7XG4gICAgfTtcbiAgICBQZXJzaXN0ZW50Q29ubmVjdGlvbi5wcm90b3R5cGUuY2FuY2VsU2VudFRyYW5zYWN0aW9uc18gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5vdXRzdGFuZGluZ1B1dHNfLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgcHV0ID0gdGhpcy5vdXRzdGFuZGluZ1B1dHNfW2ldO1xuICAgICAgICAgICAgaWYgKHB1dCAmJiAvKmhhc2gqLyAnaCcgaW4gcHV0LnJlcXVlc3QgJiYgcHV0LnF1ZXVlZCkge1xuICAgICAgICAgICAgICAgIGlmIChwdXQub25Db21wbGV0ZSlcbiAgICAgICAgICAgICAgICAgICAgcHV0Lm9uQ29tcGxldGUoJ2Rpc2Nvbm5lY3QnKTtcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5vdXRzdGFuZGluZ1B1dHNfW2ldO1xuICAgICAgICAgICAgICAgIHRoaXMub3V0c3RhbmRpbmdQdXRDb3VudF8tLTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBDbGVhbiB1cCBhcnJheSBvY2Nhc2lvbmFsbHkuXG4gICAgICAgIGlmICh0aGlzLm91dHN0YW5kaW5nUHV0Q291bnRfID09PSAwKVxuICAgICAgICAgICAgdGhpcy5vdXRzdGFuZGluZ1B1dHNfID0gW107XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFzdHJpbmd9IHBhdGhTdHJpbmdcbiAgICAgKiBAcGFyYW0ge0FycmF5LjwqPj19IHF1ZXJ5XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBQZXJzaXN0ZW50Q29ubmVjdGlvbi5wcm90b3R5cGUub25MaXN0ZW5SZXZva2VkXyA9IGZ1bmN0aW9uIChwYXRoU3RyaW5nLCBxdWVyeSkge1xuICAgICAgICAvLyBSZW1vdmUgdGhlIGxpc3RlbiBhbmQgbWFudWZhY3R1cmUgYSBcInBlcm1pc3Npb25fZGVuaWVkXCIgZXJyb3IgZm9yIHRoZSBmYWlsZWQgbGlzdGVuLlxuICAgICAgICB2YXIgcXVlcnlJZDtcbiAgICAgICAgaWYgKCFxdWVyeSkge1xuICAgICAgICAgICAgcXVlcnlJZCA9ICdkZWZhdWx0JztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHF1ZXJ5SWQgPSBxdWVyeS5tYXAoZnVuY3Rpb24gKHEpIHsgcmV0dXJuIHV0aWxfNC5PYmplY3RUb1VuaXF1ZUtleShxKTsgfSkuam9pbignJCcpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBsaXN0ZW4gPSB0aGlzLnJlbW92ZUxpc3Rlbl8ocGF0aFN0cmluZywgcXVlcnlJZCk7XG4gICAgICAgIGlmIChsaXN0ZW4gJiYgbGlzdGVuLm9uQ29tcGxldGUpXG4gICAgICAgICAgICBsaXN0ZW4ub25Db21wbGV0ZSgncGVybWlzc2lvbl9kZW5pZWQnKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7IXN0cmluZ30gcGF0aFN0cmluZ1xuICAgICAqIEBwYXJhbSB7IXN0cmluZ30gcXVlcnlJZFxuICAgICAqIEByZXR1cm4ge3txdWVyaWVzOkFycmF5LjxRdWVyeT4sIG9uQ29tcGxldGU6ZnVuY3Rpb24oc3RyaW5nKX19XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBQZXJzaXN0ZW50Q29ubmVjdGlvbi5wcm90b3R5cGUucmVtb3ZlTGlzdGVuXyA9IGZ1bmN0aW9uIChwYXRoU3RyaW5nLCBxdWVyeUlkKSB7XG4gICAgICAgIHZhciBub3JtYWxpemVkUGF0aFN0cmluZyA9IG5ldyBQYXRoXzEuUGF0aChwYXRoU3RyaW5nKS50b1N0cmluZygpOyAvLyBub3JtYWxpemUgcGF0aC5cbiAgICAgICAgdmFyIGxpc3RlbjtcbiAgICAgICAgaWYgKHRoaXMubGlzdGVuc19bbm9ybWFsaXplZFBhdGhTdHJpbmddICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGxpc3RlbiA9IHRoaXMubGlzdGVuc19bbm9ybWFsaXplZFBhdGhTdHJpbmddW3F1ZXJ5SWRdO1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMubGlzdGVuc19bbm9ybWFsaXplZFBhdGhTdHJpbmddW3F1ZXJ5SWRdO1xuICAgICAgICAgICAgaWYgKHV0aWxfMS5nZXRDb3VudCh0aGlzLmxpc3RlbnNfW25vcm1hbGl6ZWRQYXRoU3RyaW5nXSkgPT09IDApIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5saXN0ZW5zX1tub3JtYWxpemVkUGF0aFN0cmluZ107XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBhbGwgbGlzdGVucyBmb3IgdGhpcyBwYXRoIGhhcyBhbHJlYWR5IGJlZW4gcmVtb3ZlZFxuICAgICAgICAgICAgbGlzdGVuID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsaXN0ZW47XG4gICAgfTtcbiAgICBQZXJzaXN0ZW50Q29ubmVjdGlvbi5wcm90b3R5cGUub25BdXRoUmV2b2tlZF8gPSBmdW5jdGlvbiAoc3RhdHVzQ29kZSwgZXhwbGFuYXRpb24pIHtcbiAgICAgICAgdXRpbF80LmxvZygnQXV0aCB0b2tlbiByZXZva2VkOiAnICsgc3RhdHVzQ29kZSArICcvJyArIGV4cGxhbmF0aW9uKTtcbiAgICAgICAgdGhpcy5hdXRoVG9rZW5fID0gbnVsbDtcbiAgICAgICAgdGhpcy5mb3JjZVRva2VuUmVmcmVzaF8gPSB0cnVlO1xuICAgICAgICB0aGlzLnJlYWx0aW1lXy5jbG9zZSgpO1xuICAgICAgICBpZiAoc3RhdHVzQ29kZSA9PT0gJ2ludmFsaWRfdG9rZW4nIHx8IHN0YXR1c0NvZGUgPT09ICdwZXJtaXNzaW9uX2RlbmllZCcpIHtcbiAgICAgICAgICAgIC8vIFdlJ2xsIHdhaXQgYSBjb3VwbGUgdGltZXMgYmVmb3JlIGxvZ2dpbmcgdGhlIHdhcm5pbmcgLyBpbmNyZWFzaW5nIHRoZVxuICAgICAgICAgICAgLy8gcmV0cnkgcGVyaW9kIHNpbmNlIG9hdXRoIHRva2VucyB3aWxsIHJlcG9ydCBhcyBcImludmFsaWRcIiBpZiB0aGV5J3JlXG4gICAgICAgICAgICAvLyBqdXN0IGV4cGlyZWQuIFBsdXMgdGhlcmUgbWF5IGJlIHRyYW5zaWVudCBpc3N1ZXMgdGhhdCByZXNvbHZlIHRoZW1zZWx2ZXMuXG4gICAgICAgICAgICB0aGlzLmludmFsaWRBdXRoVG9rZW5Db3VudF8rKztcbiAgICAgICAgICAgIGlmICh0aGlzLmludmFsaWRBdXRoVG9rZW5Db3VudF8gPj0gSU5WQUxJRF9BVVRIX1RPS0VOX1RIUkVTSE9MRCkge1xuICAgICAgICAgICAgICAgIC8vIFNldCBhIGxvbmcgcmVjb25uZWN0IGRlbGF5IGJlY2F1c2UgcmVjb3ZlcnkgaXMgdW5saWtlbHlcbiAgICAgICAgICAgICAgICB0aGlzLnJlY29ubmVjdERlbGF5XyA9IFJFQ09OTkVDVF9NQVhfREVMQVlfRk9SX0FETUlOUztcbiAgICAgICAgICAgICAgICAvLyBOb3RpZnkgdGhlIGF1dGggdG9rZW4gcHJvdmlkZXIgdGhhdCB0aGUgdG9rZW4gaXMgaW52YWxpZCwgd2hpY2ggd2lsbCBsb2dcbiAgICAgICAgICAgICAgICAvLyBhIHdhcm5pbmdcbiAgICAgICAgICAgICAgICB0aGlzLmF1dGhUb2tlblByb3ZpZGVyXy5ub3RpZnlGb3JJbnZhbGlkVG9rZW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgUGVyc2lzdGVudENvbm5lY3Rpb24ucHJvdG90eXBlLm9uU2VjdXJpdHlEZWJ1Z1BhY2tldF8gPSBmdW5jdGlvbiAoYm9keSkge1xuICAgICAgICBpZiAodGhpcy5zZWN1cml0eURlYnVnQ2FsbGJhY2tfKSB7XG4gICAgICAgICAgICB0aGlzLnNlY3VyaXR5RGVidWdDYWxsYmFja18oYm9keSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoJ21zZycgaW4gYm9keSAmJiB0eXBlb2YgY29uc29sZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRklSRUJBU0U6ICcgKyBib2R5Wydtc2cnXS5yZXBsYWNlKCdcXG4nLCAnXFxuRklSRUJBU0U6ICcpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgUGVyc2lzdGVudENvbm5lY3Rpb24ucHJvdG90eXBlLnJlc3RvcmVTdGF0ZV8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIC8vUmUtYXV0aGVudGljYXRlIG91cnNlbHZlcyBpZiB3ZSBoYXZlIGEgY3JlZGVudGlhbCBzdG9yZWQuXG4gICAgICAgIHRoaXMudHJ5QXV0aCgpO1xuICAgICAgICAvLyBQdXRzIGRlcGVuZCBvbiBoYXZpbmcgcmVjZWl2ZWQgdGhlIGNvcnJlc3BvbmRpbmcgZGF0YSB1cGRhdGUgZnJvbSB0aGUgc2VydmVyIGJlZm9yZSB0aGV5IGNvbXBsZXRlLCBzbyB3ZSBtdXN0XG4gICAgICAgIC8vIG1ha2Ugc3VyZSB0byBzZW5kIGxpc3RlbnMgYmVmb3JlIHB1dHMuXG4gICAgICAgIHV0aWxfMS5mb3JFYWNoKHRoaXMubGlzdGVuc18sIGZ1bmN0aW9uIChwYXRoU3RyaW5nLCBxdWVyaWVzKSB7XG4gICAgICAgICAgICB1dGlsXzEuZm9yRWFjaChxdWVyaWVzLCBmdW5jdGlvbiAoa2V5LCBsaXN0ZW5TcGVjKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuc2VuZExpc3Rlbl8obGlzdGVuU3BlYyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5vdXRzdGFuZGluZ1B1dHNfLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5vdXRzdGFuZGluZ1B1dHNfW2ldKVxuICAgICAgICAgICAgICAgIHRoaXMuc2VuZFB1dF8oaSk7XG4gICAgICAgIH1cbiAgICAgICAgd2hpbGUgKHRoaXMub25EaXNjb25uZWN0UmVxdWVzdFF1ZXVlXy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHZhciByZXF1ZXN0ID0gdGhpcy5vbkRpc2Nvbm5lY3RSZXF1ZXN0UXVldWVfLnNoaWZ0KCk7XG4gICAgICAgICAgICB0aGlzLnNlbmRPbkRpc2Nvbm5lY3RfKHJlcXVlc3QuYWN0aW9uLCByZXF1ZXN0LnBhdGhTdHJpbmcsIHJlcXVlc3QuZGF0YSwgcmVxdWVzdC5vbkNvbXBsZXRlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogU2VuZHMgY2xpZW50IHN0YXRzIGZvciBmaXJzdCBjb25uZWN0aW9uXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBQZXJzaXN0ZW50Q29ubmVjdGlvbi5wcm90b3R5cGUuc2VuZENvbm5lY3RTdGF0c18gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzdGF0cyA9IHt9O1xuICAgICAgICB2YXIgY2xpZW50TmFtZSA9ICdqcyc7XG4gICAgICAgIGlmICh1dGlsXzYuQ09OU1RBTlRTLk5PREVfQURNSU4pIHtcbiAgICAgICAgICAgIGNsaWVudE5hbWUgPSAnYWRtaW5fbm9kZSc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodXRpbF82LkNPTlNUQU5UUy5OT0RFX0NMSUVOVCkge1xuICAgICAgICAgICAgY2xpZW50TmFtZSA9ICdub2RlJztcbiAgICAgICAgfVxuICAgICAgICBzdGF0c1snc2RrLicgKyBjbGllbnROYW1lICsgJy4nICsgYXBwXzEuZGVmYXVsdC5TREtfVkVSU0lPTi5yZXBsYWNlKC9cXC4vZywgJy0nKV0gPSAxO1xuICAgICAgICBpZiAodXRpbF83LmlzTW9iaWxlQ29yZG92YSgpKSB7XG4gICAgICAgICAgICBzdGF0c1snZnJhbWV3b3JrLmNvcmRvdmEnXSA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodXRpbF83LmlzUmVhY3ROYXRpdmUoKSkge1xuICAgICAgICAgICAgc3RhdHNbJ2ZyYW1ld29yay5yZWFjdG5hdGl2ZSddID0gMTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlcG9ydFN0YXRzKHN0YXRzKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBQZXJzaXN0ZW50Q29ubmVjdGlvbi5wcm90b3R5cGUuc2hvdWxkUmVjb25uZWN0XyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG9ubGluZSA9IE9ubGluZU1vbml0b3JfMS5PbmxpbmVNb25pdG9yLmdldEluc3RhbmNlKCkuY3VycmVudGx5T25saW5lKCk7XG4gICAgICAgIHJldHVybiB1dGlsXzEuaXNFbXB0eSh0aGlzLmludGVycnVwdFJlYXNvbnNfKSAmJiBvbmxpbmU7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIFBlcnNpc3RlbnRDb25uZWN0aW9uLm5leHRQZXJzaXN0ZW50Q29ubmVjdGlvbklkXyA9IDA7XG4gICAgLyoqXG4gICAgICogQ291bnRlciBmb3IgbnVtYmVyIG9mIGNvbm5lY3Rpb25zIGNyZWF0ZWQuIE1haW5seSB1c2VkIGZvciB0YWdnaW5nIGluIHRoZSBsb2dzXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIFBlcnNpc3RlbnRDb25uZWN0aW9uLm5leHRDb25uZWN0aW9uSWRfID0gMDtcbiAgICByZXR1cm4gUGVyc2lzdGVudENvbm5lY3Rpb247XG59KFNlcnZlckFjdGlvbnNfMS5TZXJ2ZXJBY3Rpb25zKSk7XG5leHBvcnRzLlBlcnNpc3RlbnRDb25uZWN0aW9uID0gUGVyc2lzdGVudENvbm5lY3Rpb247XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVBlcnNpc3RlbnRDb25uZWN0aW9uLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xudmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdXRpbF8xID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xudmFyIHV0aWxfMiA9IHJlcXVpcmUoXCIuL3V0aWwvdXRpbFwiKTtcbnZhciB1dGlsXzMgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG52YXIgdXRpbF80ID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xudmFyIHV0aWxfNSA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvdXRpbFwiKTtcbnZhciBTZXJ2ZXJBY3Rpb25zXzEgPSByZXF1aXJlKFwiLi9TZXJ2ZXJBY3Rpb25zXCIpO1xuLyoqXG4gKiBBbiBpbXBsZW1lbnRhdGlvbiBvZiBTZXJ2ZXJBY3Rpb25zIHRoYXQgY29tbXVuaWNhdGVzIHdpdGggdGhlIHNlcnZlciB2aWEgUkVTVCByZXF1ZXN0cy5cbiAqIFRoaXMgaXMgbW9zdGx5IHVzZWZ1bCBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIGNyYXdsZXJzLCB3aGVyZSB3ZSBkb24ndCB3YW50IHRvIHNwaW4gdXAgYSBmdWxsXG4gKiBwZXJzaXN0ZW50IGNvbm5lY3Rpb24gKHVzaW5nIFdlYlNvY2tldHMgb3IgbG9uZy1wb2xsaW5nKVxuICovXG52YXIgUmVhZG9ubHlSZXN0Q2xpZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhSZWFkb25seVJlc3RDbGllbnQsIF9zdXBlcik7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshUmVwb0luZm99IHJlcG9JbmZvXyBEYXRhIGFib3V0IHRoZSBuYW1lc3BhY2Ugd2UgYXJlIGNvbm5lY3RpbmcgdG9cbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKHN0cmluZywgKiwgYm9vbGVhbiwgP251bWJlcil9IG9uRGF0YVVwZGF0ZV8gQSBjYWxsYmFjayBmb3IgbmV3IGRhdGEgZnJvbSB0aGUgc2VydmVyXG4gICAgICogQHBhcmFtIHtBdXRoVG9rZW5Qcm92aWRlcn0gYXV0aFRva2VuUHJvdmlkZXJfXG4gICAgICogQGltcGxlbWVudHMge1NlcnZlckFjdGlvbnN9XG4gICAgICovXG4gICAgZnVuY3Rpb24gUmVhZG9ubHlSZXN0Q2xpZW50KHJlcG9JbmZvXywgb25EYXRhVXBkYXRlXywgYXV0aFRva2VuUHJvdmlkZXJfKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLnJlcG9JbmZvXyA9IHJlcG9JbmZvXztcbiAgICAgICAgX3RoaXMub25EYXRhVXBkYXRlXyA9IG9uRGF0YVVwZGF0ZV87XG4gICAgICAgIF90aGlzLmF1dGhUb2tlblByb3ZpZGVyXyA9IGF1dGhUb2tlblByb3ZpZGVyXztcbiAgICAgICAgLyoqIEBwcml2YXRlIHtmdW5jdGlvbiguLi5bKl0pfSAqL1xuICAgICAgICBfdGhpcy5sb2dfID0gdXRpbF8yLmxvZ1dyYXBwZXIoJ3A6cmVzdDonKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFdlIGRvbid0IGFjdHVhbGx5IG5lZWQgdG8gdHJhY2sgbGlzdGVucywgZXhjZXB0IHRvIHByZXZlbnQgdXMgY2FsbGluZyBhbiBvbkNvbXBsZXRlIGZvciBhIGxpc3RlblxuICAgICAgICAgKiB0aGF0J3MgYmVlbiByZW1vdmVkLiA6LS9cbiAgICAgICAgICpcbiAgICAgICAgICogQHByaXZhdGUgeyFPYmplY3QuPHN0cmluZywgIU9iamVjdD59XG4gICAgICAgICAqL1xuICAgICAgICBfdGhpcy5saXN0ZW5zXyA9IHt9O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFJlYWRvbmx5UmVzdENsaWVudC5wcm90b3R5cGUucmVwb3J0U3RhdHMgPSBmdW5jdGlvbiAoc3RhdHMpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNZXRob2Qgbm90IGltcGxlbWVudGVkLicpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshUXVlcnl9IHF1ZXJ5XG4gICAgICogQHBhcmFtIHs/bnVtYmVyPX0gdGFnXG4gICAgICogQHJldHVybiB7c3RyaW5nfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgUmVhZG9ubHlSZXN0Q2xpZW50LmdldExpc3RlbklkXyA9IGZ1bmN0aW9uIChxdWVyeSwgdGFnKSB7XG4gICAgICAgIGlmICh0YWcgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuICd0YWckJyArIHRhZztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHV0aWxfMS5hc3NlcnQocXVlcnkuZ2V0UXVlcnlQYXJhbXMoKS5pc0RlZmF1bHQoKSwgXCJzaG91bGQgaGF2ZSBhIHRhZyBpZiBpdCdzIG5vdCBhIGRlZmF1bHQgcXVlcnkuXCIpO1xuICAgICAgICAgICAgcmV0dXJuIHF1ZXJ5LnBhdGgudG9TdHJpbmcoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqIEBpbmhlcml0RG9jICovXG4gICAgUmVhZG9ubHlSZXN0Q2xpZW50LnByb3RvdHlwZS5saXN0ZW4gPSBmdW5jdGlvbiAocXVlcnksIGN1cnJlbnRIYXNoRm4sIHRhZywgb25Db21wbGV0ZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgcGF0aFN0cmluZyA9IHF1ZXJ5LnBhdGgudG9TdHJpbmcoKTtcbiAgICAgICAgdGhpcy5sb2dfKCdMaXN0ZW4gY2FsbGVkIGZvciAnICsgcGF0aFN0cmluZyArICcgJyArIHF1ZXJ5LnF1ZXJ5SWRlbnRpZmllcigpKTtcbiAgICAgICAgLy8gTWFyayB0aGlzIGxpc3RlbmVyIHNvIHdlIGNhbiB0ZWxsIGlmIGl0J3MgcmVtb3ZlZC5cbiAgICAgICAgdmFyIGxpc3RlbklkID0gUmVhZG9ubHlSZXN0Q2xpZW50LmdldExpc3RlbklkXyhxdWVyeSwgdGFnKTtcbiAgICAgICAgdmFyIHRoaXNMaXN0ZW4gPSB7fTtcbiAgICAgICAgdGhpcy5saXN0ZW5zX1tsaXN0ZW5JZF0gPSB0aGlzTGlzdGVuO1xuICAgICAgICB2YXIgcXVlcnlTdHJpbmdQYXJhbWF0ZXJzID0gcXVlcnlcbiAgICAgICAgICAgIC5nZXRRdWVyeVBhcmFtcygpXG4gICAgICAgICAgICAudG9SZXN0UXVlcnlTdHJpbmdQYXJhbWV0ZXJzKCk7XG4gICAgICAgIHRoaXMucmVzdFJlcXVlc3RfKHBhdGhTdHJpbmcgKyAnLmpzb24nLCBxdWVyeVN0cmluZ1BhcmFtYXRlcnMsIGZ1bmN0aW9uIChlcnJvciwgcmVzdWx0KSB7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IHJlc3VsdDtcbiAgICAgICAgICAgIGlmIChlcnJvciA9PT0gNDA0KSB7XG4gICAgICAgICAgICAgICAgZGF0YSA9IG51bGw7XG4gICAgICAgICAgICAgICAgZXJyb3IgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGVycm9yID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMub25EYXRhVXBkYXRlXyhwYXRoU3RyaW5nLCBkYXRhLCAvKmlzTWVyZ2U9Ki8gZmFsc2UsIHRhZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodXRpbF80LnNhZmVHZXQoX3RoaXMubGlzdGVuc18sIGxpc3RlbklkKSA9PT0gdGhpc0xpc3Rlbikge1xuICAgICAgICAgICAgICAgIHZhciBzdGF0dXNfMTtcbiAgICAgICAgICAgICAgICBpZiAoIWVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1c18xID0gJ29rJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoZXJyb3IgPT0gNDAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1c18xID0gJ3Blcm1pc3Npb25fZGVuaWVkJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1c18xID0gJ3Jlc3RfZXJyb3I6JyArIGVycm9yO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBvbkNvbXBsZXRlKHN0YXR1c18xLCBudWxsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvKiogQGluaGVyaXREb2MgKi9cbiAgICBSZWFkb25seVJlc3RDbGllbnQucHJvdG90eXBlLnVubGlzdGVuID0gZnVuY3Rpb24gKHF1ZXJ5LCB0YWcpIHtcbiAgICAgICAgdmFyIGxpc3RlbklkID0gUmVhZG9ubHlSZXN0Q2xpZW50LmdldExpc3RlbklkXyhxdWVyeSwgdGFnKTtcbiAgICAgICAgZGVsZXRlIHRoaXMubGlzdGVuc19bbGlzdGVuSWRdO1xuICAgIH07XG4gICAgLyoqIEBpbmhlcml0RG9jICovXG4gICAgUmVhZG9ubHlSZXN0Q2xpZW50LnByb3RvdHlwZS5yZWZyZXNoQXV0aFRva2VuID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgIC8vIG5vLW9wIHNpbmNlIHdlIGp1c3QgYWx3YXlzIGNhbGwgZ2V0VG9rZW4uXG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBQZXJmb3JtcyBhIFJFU1QgcmVxdWVzdCB0byB0aGUgZ2l2ZW4gcGF0aCwgd2l0aCB0aGUgcHJvdmlkZWQgcXVlcnkgc3RyaW5nIHBhcmFtZXRlcnMsXG4gICAgICogYW5kIGFueSBhdXRoIGNyZWRlbnRpYWxzIHdlIGhhdmUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyFzdHJpbmd9IHBhdGhTdHJpbmdcbiAgICAgKiBAcGFyYW0geyFPYmplY3QuPHN0cmluZywgKj59IHF1ZXJ5U3RyaW5nUGFyYW1ldGVyc1xuICAgICAqIEBwYXJhbSB7P2Z1bmN0aW9uKD9udW1iZXIsICo9KX0gY2FsbGJhY2tcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIFJlYWRvbmx5UmVzdENsaWVudC5wcm90b3R5cGUucmVzdFJlcXVlc3RfID0gZnVuY3Rpb24gKHBhdGhTdHJpbmcsIHF1ZXJ5U3RyaW5nUGFyYW1ldGVycywgY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHF1ZXJ5U3RyaW5nUGFyYW1ldGVycyA9PT0gdm9pZCAwKSB7IHF1ZXJ5U3RyaW5nUGFyYW1ldGVycyA9IHt9OyB9XG4gICAgICAgIHF1ZXJ5U3RyaW5nUGFyYW1ldGVyc1snZm9ybWF0J10gPSAnZXhwb3J0JztcbiAgICAgICAgdGhpcy5hdXRoVG9rZW5Qcm92aWRlcl9cbiAgICAgICAgICAgIC5nZXRUb2tlbigvKmZvcmNlUmVmcmVzaD0qLyBmYWxzZSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChhdXRoVG9rZW5EYXRhKSB7XG4gICAgICAgICAgICB2YXIgYXV0aFRva2VuID0gYXV0aFRva2VuRGF0YSAmJiBhdXRoVG9rZW5EYXRhLmFjY2Vzc1Rva2VuO1xuICAgICAgICAgICAgaWYgKGF1dGhUb2tlbikge1xuICAgICAgICAgICAgICAgIHF1ZXJ5U3RyaW5nUGFyYW1ldGVyc1snYXV0aCddID0gYXV0aFRva2VuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHVybCA9IChfdGhpcy5yZXBvSW5mb18uc2VjdXJlID8gJ2h0dHBzOi8vJyA6ICdodHRwOi8vJykgK1xuICAgICAgICAgICAgICAgIF90aGlzLnJlcG9JbmZvXy5ob3N0ICtcbiAgICAgICAgICAgICAgICBwYXRoU3RyaW5nICtcbiAgICAgICAgICAgICAgICAnPycgK1xuICAgICAgICAgICAgICAgIHV0aWxfNS5xdWVyeXN0cmluZyhxdWVyeVN0cmluZ1BhcmFtZXRlcnMpO1xuICAgICAgICAgICAgX3RoaXMubG9nXygnU2VuZGluZyBSRVNUIHJlcXVlc3QgZm9yICcgKyB1cmwpO1xuICAgICAgICAgICAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgJiYgeGhyLnJlYWR5U3RhdGUgPT09IDQpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMubG9nXygnUkVTVCBSZXNwb25zZSBmb3IgJyArIHVybCArICcgcmVjZWl2ZWQuIHN0YXR1czonLCB4aHIuc3RhdHVzLCAncmVzcG9uc2U6JywgeGhyLnJlc3BvbnNlVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICBpZiAoeGhyLnN0YXR1cyA+PSAyMDAgJiYgeGhyLnN0YXR1cyA8IDMwMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXMgPSB1dGlsXzMuanNvbkV2YWwoeGhyLnJlc3BvbnNlVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0aWxfMi53YXJuKCdGYWlsZWQgdG8gcGFyc2UgSlNPTiByZXNwb25zZSBmb3IgJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybCArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc6ICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4aHIucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIHJlcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyA0MDEgYW5kIDQwNCBhcmUgZXhwZWN0ZWQuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoeGhyLnN0YXR1cyAhPT0gNDAxICYmIHhoci5zdGF0dXMgIT09IDQwNCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0aWxfMi53YXJuKCdHb3QgdW5zdWNjZXNzZnVsIFJFU1QgcmVzcG9uc2UgZm9yICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmwgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnIFN0YXR1czogJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhoci5zdGF0dXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soeGhyLnN0YXR1cyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sgPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB4aHIub3BlbignR0VUJywgdXJsLCAvKmFzeW5jaHJvbm91cz0qLyB0cnVlKTtcbiAgICAgICAgICAgIHhoci5zZW5kKCk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIFJlYWRvbmx5UmVzdENsaWVudDtcbn0oU2VydmVyQWN0aW9uc18xLlNlcnZlckFjdGlvbnMpKTtcbmV4cG9ydHMuUmVhZG9ubHlSZXN0Q2xpZW50ID0gUmVhZG9ubHlSZXN0Q2xpZW50O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1SZWFkb25seVJlc3RDbGllbnQuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgU2VydmVyVmFsdWVzXzEgPSByZXF1aXJlKFwiLi91dGlsL1NlcnZlclZhbHVlc1wiKTtcbnZhciBub2RlRnJvbUpTT05fMSA9IHJlcXVpcmUoXCIuL3NuYXAvbm9kZUZyb21KU09OXCIpO1xudmFyIFBhdGhfMSA9IHJlcXVpcmUoXCIuL3V0aWwvUGF0aFwiKTtcbnZhciBTcGFyc2VTbmFwc2hvdFRyZWVfMSA9IHJlcXVpcmUoXCIuL1NwYXJzZVNuYXBzaG90VHJlZVwiKTtcbnZhciBTeW5jVHJlZV8xID0gcmVxdWlyZShcIi4vU3luY1RyZWVcIik7XG52YXIgU25hcHNob3RIb2xkZXJfMSA9IHJlcXVpcmUoXCIuL1NuYXBzaG90SG9sZGVyXCIpO1xudmFyIHV0aWxfMSA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvdXRpbFwiKTtcbnZhciB1dGlsXzIgPSByZXF1aXJlKFwiLi91dGlsL3V0aWxcIik7XG52YXIgdXRpbF8zID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xudmFyIEF1dGhUb2tlblByb3ZpZGVyXzEgPSByZXF1aXJlKFwiLi9BdXRoVG9rZW5Qcm92aWRlclwiKTtcbnZhciBTdGF0c01hbmFnZXJfMSA9IHJlcXVpcmUoXCIuL3N0YXRzL1N0YXRzTWFuYWdlclwiKTtcbnZhciBTdGF0c1JlcG9ydGVyXzEgPSByZXF1aXJlKFwiLi9zdGF0cy9TdGF0c1JlcG9ydGVyXCIpO1xudmFyIFN0YXRzTGlzdGVuZXJfMSA9IHJlcXVpcmUoXCIuL3N0YXRzL1N0YXRzTGlzdGVuZXJcIik7XG52YXIgRXZlbnRRdWV1ZV8xID0gcmVxdWlyZShcIi4vdmlldy9FdmVudFF1ZXVlXCIpO1xudmFyIFBlcnNpc3RlbnRDb25uZWN0aW9uXzEgPSByZXF1aXJlKFwiLi9QZXJzaXN0ZW50Q29ubmVjdGlvblwiKTtcbnZhciBSZWFkb25seVJlc3RDbGllbnRfMSA9IHJlcXVpcmUoXCIuL1JlYWRvbmx5UmVzdENsaWVudFwiKTtcbnZhciBEYXRhYmFzZV8xID0gcmVxdWlyZShcIi4uL2FwaS9EYXRhYmFzZVwiKTtcbnZhciBJTlRFUlJVUFRfUkVBU09OID0gJ3JlcG9faW50ZXJydXB0Jztcbi8qKlxuICogQSBjb25uZWN0aW9uIHRvIGEgc2luZ2xlIGRhdGEgcmVwb3NpdG9yeS5cbiAqL1xudmFyIFJlcG8gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshUmVwb0luZm99IHJlcG9JbmZvX1xuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gZm9yY2VSZXN0Q2xpZW50XG4gICAgICogQHBhcmFtIHshRmlyZWJhc2VBcHB9IGFwcFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFJlcG8ocmVwb0luZm9fLCBmb3JjZVJlc3RDbGllbnQsIGFwcCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnJlcG9JbmZvXyA9IHJlcG9JbmZvXztcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgICAgIHRoaXMuZGF0YVVwZGF0ZUNvdW50ID0gMDtcbiAgICAgICAgdGhpcy5zdGF0c0xpc3RlbmVyXyA9IG51bGw7XG4gICAgICAgIHRoaXMuZXZlbnRRdWV1ZV8gPSBuZXcgRXZlbnRRdWV1ZV8xLkV2ZW50UXVldWUoKTtcbiAgICAgICAgdGhpcy5uZXh0V3JpdGVJZF8gPSAxO1xuICAgICAgICB0aGlzLmludGVyY2VwdFNlcnZlckRhdGFDYWxsYmFja18gPSBudWxsO1xuICAgICAgICAvLyBBIGxpc3Qgb2YgZGF0YSBwaWVjZXMgYW5kIHBhdGhzIHRvIGJlIHNldCB3aGVuIHRoaXMgY2xpZW50IGRpc2Nvbm5lY3RzLlxuICAgICAgICB0aGlzLm9uRGlzY29ubmVjdF8gPSBuZXcgU3BhcnNlU25hcHNob3RUcmVlXzEuU3BhcnNlU25hcHNob3RUcmVlKCk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUT0RPOiBUaGlzIHNob3VsZCBiZSBAcHJpdmF0ZSBidXQgaXQncyB1c2VkIGJ5IHRlc3RfYWNjZXNzLmpzIGFuZCBpbnRlcm5hbC5qc1xuICAgICAgICAgKiBAdHlwZSB7P1BlcnNpc3RlbnRDb25uZWN0aW9ufVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5wZXJzaXN0ZW50Q29ubmVjdGlvbl8gPSBudWxsO1xuICAgICAgICAvKiogQHR5cGUgeyFBdXRoVG9rZW5Qcm92aWRlcn0gKi9cbiAgICAgICAgdmFyIGF1dGhUb2tlblByb3ZpZGVyID0gbmV3IEF1dGhUb2tlblByb3ZpZGVyXzEuQXV0aFRva2VuUHJvdmlkZXIoYXBwKTtcbiAgICAgICAgdGhpcy5zdGF0c18gPSBTdGF0c01hbmFnZXJfMS5TdGF0c01hbmFnZXIuZ2V0Q29sbGVjdGlvbihyZXBvSW5mb18pO1xuICAgICAgICBpZiAoZm9yY2VSZXN0Q2xpZW50IHx8IHV0aWxfMi5iZWluZ0NyYXdsZWQoKSkge1xuICAgICAgICAgICAgdGhpcy5zZXJ2ZXJfID0gbmV3IFJlYWRvbmx5UmVzdENsaWVudF8xLlJlYWRvbmx5UmVzdENsaWVudCh0aGlzLnJlcG9JbmZvXywgdGhpcy5vbkRhdGFVcGRhdGVfLmJpbmQodGhpcyksIGF1dGhUb2tlblByb3ZpZGVyKTtcbiAgICAgICAgICAgIC8vIE1pbm9yIGhhY2s6IEZpcmUgb25Db25uZWN0IGltbWVkaWF0ZWx5LCBzaW5jZSB0aGVyZSdzIG5vIGFjdHVhbCBjb25uZWN0aW9uLlxuICAgICAgICAgICAgc2V0VGltZW91dCh0aGlzLm9uQ29ubmVjdFN0YXR1c18uYmluZCh0aGlzLCB0cnVlKSwgMCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgYXV0aE92ZXJyaWRlID0gYXBwLm9wdGlvbnNbJ2RhdGFiYXNlQXV0aFZhcmlhYmxlT3ZlcnJpZGUnXTtcbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIGF1dGhPdmVycmlkZVxuICAgICAgICAgICAgaWYgKHR5cGVvZiBhdXRoT3ZlcnJpZGUgIT09ICd1bmRlZmluZWQnICYmIGF1dGhPdmVycmlkZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgYXV0aE92ZXJyaWRlICE9PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ09ubHkgb2JqZWN0cyBhcmUgc3VwcG9ydGVkIGZvciBvcHRpb24gZGF0YWJhc2VBdXRoVmFyaWFibGVPdmVycmlkZScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICB1dGlsXzEuc3RyaW5naWZ5KGF1dGhPdmVycmlkZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBhdXRoT3ZlcnJpZGUgcHJvdmlkZWQ6ICcgKyBlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnBlcnNpc3RlbnRDb25uZWN0aW9uXyA9IG5ldyBQZXJzaXN0ZW50Q29ubmVjdGlvbl8xLlBlcnNpc3RlbnRDb25uZWN0aW9uKHRoaXMucmVwb0luZm9fLCB0aGlzLm9uRGF0YVVwZGF0ZV8uYmluZCh0aGlzKSwgdGhpcy5vbkNvbm5lY3RTdGF0dXNfLmJpbmQodGhpcyksIHRoaXMub25TZXJ2ZXJJbmZvVXBkYXRlXy5iaW5kKHRoaXMpLCBhdXRoVG9rZW5Qcm92aWRlciwgYXV0aE92ZXJyaWRlKTtcbiAgICAgICAgICAgIHRoaXMuc2VydmVyXyA9IHRoaXMucGVyc2lzdGVudENvbm5lY3Rpb25fO1xuICAgICAgICB9XG4gICAgICAgIGF1dGhUb2tlblByb3ZpZGVyLmFkZFRva2VuQ2hhbmdlTGlzdGVuZXIoZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgICAgICBfdGhpcy5zZXJ2ZXJfLnJlZnJlc2hBdXRoVG9rZW4odG9rZW4pO1xuICAgICAgICB9KTtcbiAgICAgICAgLy8gSW4gdGhlIGNhc2Ugb2YgbXVsdGlwbGUgUmVwb3MgZm9yIHRoZSBzYW1lIHJlcG9JbmZvIChpLmUuIHRoZXJlIGFyZSBtdWx0aXBsZSBGaXJlYmFzZS5Db250ZXh0cyBiZWluZyB1c2VkKSxcbiAgICAgICAgLy8gd2Ugb25seSB3YW50IHRvIGNyZWF0ZSBvbmUgU3RhdHNSZXBvcnRlci4gIEFzIHN1Y2gsIHdlJ2xsIHJlcG9ydCBzdGF0cyBvdmVyIHRoZSBmaXJzdCBSZXBvIGNyZWF0ZWQuXG4gICAgICAgIHRoaXMuc3RhdHNSZXBvcnRlcl8gPSBTdGF0c01hbmFnZXJfMS5TdGF0c01hbmFnZXIuZ2V0T3JDcmVhdGVSZXBvcnRlcihyZXBvSW5mb18sIGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5ldyBTdGF0c1JlcG9ydGVyXzEuU3RhdHNSZXBvcnRlcihfdGhpcy5zdGF0c18sIF90aGlzLnNlcnZlcl8pOyB9KTtcbiAgICAgICAgdGhpcy50cmFuc2FjdGlvbnNfaW5pdF8oKTtcbiAgICAgICAgLy8gVXNlZCBmb3IgLmluZm8uXG4gICAgICAgIHRoaXMuaW5mb0RhdGFfID0gbmV3IFNuYXBzaG90SG9sZGVyXzEuU25hcHNob3RIb2xkZXIoKTtcbiAgICAgICAgdGhpcy5pbmZvU3luY1RyZWVfID0gbmV3IFN5bmNUcmVlXzEuU3luY1RyZWUoe1xuICAgICAgICAgICAgc3RhcnRMaXN0ZW5pbmc6IGZ1bmN0aW9uIChxdWVyeSwgdGFnLCBjdXJyZW50SGFzaEZuLCBvbkNvbXBsZXRlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGluZm9FdmVudHMgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZSA9IF90aGlzLmluZm9EYXRhXy5nZXROb2RlKHF1ZXJ5LnBhdGgpO1xuICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgcG9zc2libHkgYSBoYWNrLCBidXQgd2UgaGF2ZSBkaWZmZXJlbnQgc2VtYW50aWNzIGZvciAuaW5mbyBlbmRwb2ludHMuIFdlIGRvbid0IHJhaXNlIG51bGwgZXZlbnRzXG4gICAgICAgICAgICAgICAgLy8gb24gaW5pdGlhbCBkYXRhLi4uXG4gICAgICAgICAgICAgICAgaWYgKCFub2RlLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgICAgICAgICBpbmZvRXZlbnRzID0gX3RoaXMuaW5mb1N5bmNUcmVlXy5hcHBseVNlcnZlck92ZXJ3cml0ZShxdWVyeS5wYXRoLCBub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNvbXBsZXRlKCdvaycpO1xuICAgICAgICAgICAgICAgICAgICB9LCAwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGluZm9FdmVudHM7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc3RvcExpc3RlbmluZzogZnVuY3Rpb24gKCkgeyB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnVwZGF0ZUluZm9fKCdjb25uZWN0ZWQnLCBmYWxzZSk7XG4gICAgICAgIHRoaXMuc2VydmVyU3luY1RyZWVfID0gbmV3IFN5bmNUcmVlXzEuU3luY1RyZWUoe1xuICAgICAgICAgICAgc3RhcnRMaXN0ZW5pbmc6IGZ1bmN0aW9uIChxdWVyeSwgdGFnLCBjdXJyZW50SGFzaEZuLCBvbkNvbXBsZXRlKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuc2VydmVyXy5saXN0ZW4ocXVlcnksIGN1cnJlbnRIYXNoRm4sIHRhZywgZnVuY3Rpb24gKHN0YXR1cywgZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXZlbnRzID0gb25Db21wbGV0ZShzdGF0dXMsIGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5ldmVudFF1ZXVlXy5yYWlzZUV2ZW50c0ZvckNoYW5nZWRQYXRoKHF1ZXJ5LnBhdGgsIGV2ZW50cyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgLy8gTm8gc3luY2hyb25vdXMgZXZlbnRzIGZvciBuZXR3b3JrLWJhY2tlZCBzeW5jIHRyZWVzXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHN0b3BMaXN0ZW5pbmc6IGZ1bmN0aW9uIChxdWVyeSwgdGFnKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuc2VydmVyXy51bmxpc3RlbihxdWVyeSwgdGFnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEByZXR1cm4ge3N0cmluZ30gIFRoZSBVUkwgY29ycmVzcG9uZGluZyB0byB0aGUgcm9vdCBvZiB0aGlzIEZpcmViYXNlLlxuICAgICAqL1xuICAgIFJlcG8ucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKCh0aGlzLnJlcG9JbmZvXy5zZWN1cmUgPyAnaHR0cHM6Ly8nIDogJ2h0dHA6Ly8nKSArIHRoaXMucmVwb0luZm9fLmhvc3QpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7IXN0cmluZ30gVGhlIG5hbWVzcGFjZSByZXByZXNlbnRlZCBieSB0aGUgcmVwby5cbiAgICAgKi9cbiAgICBSZXBvLnByb3RvdHlwZS5uYW1lID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZXBvSW5mb18ubmFtZXNwYWNlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7IW51bWJlcn0gVGhlIHRpbWUgaW4gbWlsbGlzZWNvbmRzLCB0YWtpbmcgdGhlIHNlcnZlciBvZmZzZXQgaW50byBhY2NvdW50IGlmIHdlIGhhdmUgb25lLlxuICAgICAqL1xuICAgIFJlcG8ucHJvdG90eXBlLnNlcnZlclRpbWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBvZmZzZXROb2RlID0gdGhpcy5pbmZvRGF0YV8uZ2V0Tm9kZShuZXcgUGF0aF8xLlBhdGgoJy5pbmZvL3NlcnZlclRpbWVPZmZzZXQnKSk7XG4gICAgICAgIHZhciBvZmZzZXQgPSBvZmZzZXROb2RlLnZhbCgpIHx8IDA7XG4gICAgICAgIHJldHVybiBuZXcgRGF0ZSgpLmdldFRpbWUoKSArIG9mZnNldDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdlbmVyYXRlIFNlcnZlclZhbHVlcyB1c2luZyBzb21lIHZhcmlhYmxlcyBmcm9tIHRoZSByZXBvIG9iamVjdC5cbiAgICAgKiBAcmV0dXJuIHshT2JqZWN0fVxuICAgICAqL1xuICAgIFJlcG8ucHJvdG90eXBlLmdlbmVyYXRlU2VydmVyVmFsdWVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gU2VydmVyVmFsdWVzXzEuZ2VuZXJhdGVXaXRoVmFsdWVzKHtcbiAgICAgICAgICAgIHRpbWVzdGFtcDogdGhpcy5zZXJ2ZXJUaW1lKClcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBDYWxsZWQgYnkgcmVhbHRpbWUgd2hlbiB3ZSBnZXQgbmV3IG1lc3NhZ2VzIGZyb20gdGhlIHNlcnZlci5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHBhdGhTdHJpbmdcbiAgICAgKiBAcGFyYW0geyp9IGRhdGFcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGlzTWVyZ2VcbiAgICAgKiBAcGFyYW0gez9udW1iZXJ9IHRhZ1xuICAgICAqL1xuICAgIFJlcG8ucHJvdG90eXBlLm9uRGF0YVVwZGF0ZV8gPSBmdW5jdGlvbiAocGF0aFN0cmluZywgZGF0YSwgaXNNZXJnZSwgdGFnKSB7XG4gICAgICAgIC8vIEZvciB0ZXN0aW5nLlxuICAgICAgICB0aGlzLmRhdGFVcGRhdGVDb3VudCsrO1xuICAgICAgICB2YXIgcGF0aCA9IG5ldyBQYXRoXzEuUGF0aChwYXRoU3RyaW5nKTtcbiAgICAgICAgZGF0YSA9IHRoaXMuaW50ZXJjZXB0U2VydmVyRGF0YUNhbGxiYWNrX1xuICAgICAgICAgICAgPyB0aGlzLmludGVyY2VwdFNlcnZlckRhdGFDYWxsYmFja18ocGF0aFN0cmluZywgZGF0YSlcbiAgICAgICAgICAgIDogZGF0YTtcbiAgICAgICAgdmFyIGV2ZW50cyA9IFtdO1xuICAgICAgICBpZiAodGFnKSB7XG4gICAgICAgICAgICBpZiAoaXNNZXJnZSkge1xuICAgICAgICAgICAgICAgIHZhciB0YWdnZWRDaGlsZHJlbiA9IHV0aWxfMy5tYXAoZGF0YSwgZnVuY3Rpb24gKHJhdykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbm9kZUZyb21KU09OXzEubm9kZUZyb21KU09OKHJhdyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgZXZlbnRzID0gdGhpcy5zZXJ2ZXJTeW5jVHJlZV8uYXBwbHlUYWdnZWRRdWVyeU1lcmdlKHBhdGgsIHRhZ2dlZENoaWxkcmVuLCB0YWcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIHRhZ2dlZFNuYXAgPSBub2RlRnJvbUpTT05fMS5ub2RlRnJvbUpTT04oZGF0YSk7XG4gICAgICAgICAgICAgICAgZXZlbnRzID0gdGhpcy5zZXJ2ZXJTeW5jVHJlZV8uYXBwbHlUYWdnZWRRdWVyeU92ZXJ3cml0ZShwYXRoLCB0YWdnZWRTbmFwLCB0YWcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGlzTWVyZ2UpIHtcbiAgICAgICAgICAgIHZhciBjaGFuZ2VkQ2hpbGRyZW4gPSB1dGlsXzMubWFwKGRhdGEsIGZ1bmN0aW9uIChyYXcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbm9kZUZyb21KU09OXzEubm9kZUZyb21KU09OKHJhdyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGV2ZW50cyA9IHRoaXMuc2VydmVyU3luY1RyZWVfLmFwcGx5U2VydmVyTWVyZ2UocGF0aCwgY2hhbmdlZENoaWxkcmVuKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBzbmFwID0gbm9kZUZyb21KU09OXzEubm9kZUZyb21KU09OKGRhdGEpO1xuICAgICAgICAgICAgZXZlbnRzID0gdGhpcy5zZXJ2ZXJTeW5jVHJlZV8uYXBwbHlTZXJ2ZXJPdmVyd3JpdGUocGF0aCwgc25hcCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGFmZmVjdGVkUGF0aCA9IHBhdGg7XG4gICAgICAgIGlmIChldmVudHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgLy8gU2luY2Ugd2UgaGF2ZSBhIGxpc3RlbmVyIG91dHN0YW5kaW5nIGZvciBlYWNoIHRyYW5zYWN0aW9uLCByZWNlaXZpbmcgYW55IGV2ZW50c1xuICAgICAgICAgICAgLy8gaXMgYSBwcm94eSBmb3Igc29tZSBjaGFuZ2UgaGF2aW5nIG9jY3VycmVkLlxuICAgICAgICAgICAgYWZmZWN0ZWRQYXRoID0gdGhpcy5yZXJ1blRyYW5zYWN0aW9uc18ocGF0aCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5ldmVudFF1ZXVlXy5yYWlzZUV2ZW50c0ZvckNoYW5nZWRQYXRoKGFmZmVjdGVkUGF0aCwgZXZlbnRzKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFRPRE86IFRoaXMgc2hvdWxkIGJlIEBwcml2YXRlIGJ1dCBpdCdzIHVzZWQgYnkgdGVzdF9hY2Nlc3MuanMgYW5kIGludGVybmFsLmpzXG4gICAgICogQHBhcmFtIHs/ZnVuY3Rpb24oIXN0cmluZywgKik6Kn0gY2FsbGJhY2tcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIFJlcG8ucHJvdG90eXBlLmludGVyY2VwdFNlcnZlckRhdGFfID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMuaW50ZXJjZXB0U2VydmVyRGF0YUNhbGxiYWNrXyA9IGNhbGxiYWNrO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshYm9vbGVhbn0gY29ubmVjdFN0YXR1c1xuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgUmVwby5wcm90b3R5cGUub25Db25uZWN0U3RhdHVzXyA9IGZ1bmN0aW9uIChjb25uZWN0U3RhdHVzKSB7XG4gICAgICAgIHRoaXMudXBkYXRlSW5mb18oJ2Nvbm5lY3RlZCcsIGNvbm5lY3RTdGF0dXMpO1xuICAgICAgICBpZiAoY29ubmVjdFN0YXR1cyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIHRoaXMucnVuT25EaXNjb25uZWN0RXZlbnRzXygpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFPYmplY3R9IHVwZGF0ZXNcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIFJlcG8ucHJvdG90eXBlLm9uU2VydmVySW5mb1VwZGF0ZV8gPSBmdW5jdGlvbiAodXBkYXRlcykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB1dGlsXzIuZWFjaCh1cGRhdGVzLCBmdW5jdGlvbiAodmFsdWUsIGtleSkge1xuICAgICAgICAgICAgX3RoaXMudXBkYXRlSW5mb18oa2V5LCB2YWx1ZSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyFzdHJpbmd9IHBhdGhTdHJpbmdcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBSZXBvLnByb3RvdHlwZS51cGRhdGVJbmZvXyA9IGZ1bmN0aW9uIChwYXRoU3RyaW5nLCB2YWx1ZSkge1xuICAgICAgICB2YXIgcGF0aCA9IG5ldyBQYXRoXzEuUGF0aCgnLy5pbmZvLycgKyBwYXRoU3RyaW5nKTtcbiAgICAgICAgdmFyIG5ld05vZGUgPSBub2RlRnJvbUpTT05fMS5ub2RlRnJvbUpTT04odmFsdWUpO1xuICAgICAgICB0aGlzLmluZm9EYXRhXy51cGRhdGVTbmFwc2hvdChwYXRoLCBuZXdOb2RlKTtcbiAgICAgICAgdmFyIGV2ZW50cyA9IHRoaXMuaW5mb1N5bmNUcmVlXy5hcHBseVNlcnZlck92ZXJ3cml0ZShwYXRoLCBuZXdOb2RlKTtcbiAgICAgICAgdGhpcy5ldmVudFF1ZXVlXy5yYWlzZUV2ZW50c0ZvckNoYW5nZWRQYXRoKHBhdGgsIGV2ZW50cyk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHshbnVtYmVyfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgUmVwby5wcm90b3R5cGUuZ2V0TmV4dFdyaXRlSWRfID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uZXh0V3JpdGVJZF8rKztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7IVBhdGh9IHBhdGhcbiAgICAgKiBAcGFyYW0geyp9IG5ld1ZhbFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfHN0cmluZ3xudWxsfSBuZXdQcmlvcml0eVxuICAgICAqIEBwYXJhbSB7P2Z1bmN0aW9uKD9FcnJvciwgKj0pfSBvbkNvbXBsZXRlXG4gICAgICovXG4gICAgUmVwby5wcm90b3R5cGUuc2V0V2l0aFByaW9yaXR5ID0gZnVuY3Rpb24gKHBhdGgsIG5ld1ZhbCwgbmV3UHJpb3JpdHksIG9uQ29tcGxldGUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5sb2dfKCdzZXQnLCB7XG4gICAgICAgICAgICBwYXRoOiBwYXRoLnRvU3RyaW5nKCksXG4gICAgICAgICAgICB2YWx1ZTogbmV3VmFsLFxuICAgICAgICAgICAgcHJpb3JpdHk6IG5ld1ByaW9yaXR5XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBUT0RPOiBPcHRpbWl6ZSB0aGlzIGJlaGF2aW9yIHRvIGVpdGhlciAoYSkgc3RvcmUgZmxhZyB0byBza2lwIHJlc29sdmluZyB3aGVyZSBwb3NzaWJsZSBhbmQgLyBvclxuICAgICAgICAvLyAoYikgc3RvcmUgdW5yZXNvbHZlZCBwYXRocyBvbiBKU09OIHBhcnNlXG4gICAgICAgIHZhciBzZXJ2ZXJWYWx1ZXMgPSB0aGlzLmdlbmVyYXRlU2VydmVyVmFsdWVzKCk7XG4gICAgICAgIHZhciBuZXdOb2RlVW5yZXNvbHZlZCA9IG5vZGVGcm9tSlNPTl8xLm5vZGVGcm9tSlNPTihuZXdWYWwsIG5ld1ByaW9yaXR5KTtcbiAgICAgICAgdmFyIG5ld05vZGUgPSBTZXJ2ZXJWYWx1ZXNfMS5yZXNvbHZlRGVmZXJyZWRWYWx1ZVNuYXBzaG90KG5ld05vZGVVbnJlc29sdmVkLCBzZXJ2ZXJWYWx1ZXMpO1xuICAgICAgICB2YXIgd3JpdGVJZCA9IHRoaXMuZ2V0TmV4dFdyaXRlSWRfKCk7XG4gICAgICAgIHZhciBldmVudHMgPSB0aGlzLnNlcnZlclN5bmNUcmVlXy5hcHBseVVzZXJPdmVyd3JpdGUocGF0aCwgbmV3Tm9kZSwgd3JpdGVJZCwgdHJ1ZSk7XG4gICAgICAgIHRoaXMuZXZlbnRRdWV1ZV8ucXVldWVFdmVudHMoZXZlbnRzKTtcbiAgICAgICAgdGhpcy5zZXJ2ZXJfLnB1dChwYXRoLnRvU3RyaW5nKCksIG5ld05vZGVVbnJlc29sdmVkLnZhbCgvKmV4cG9ydD0qLyB0cnVlKSwgZnVuY3Rpb24gKHN0YXR1cywgZXJyb3JSZWFzb24pIHtcbiAgICAgICAgICAgIHZhciBzdWNjZXNzID0gc3RhdHVzID09PSAnb2snO1xuICAgICAgICAgICAgaWYgKCFzdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgdXRpbF8yLndhcm4oJ3NldCBhdCAnICsgcGF0aCArICcgZmFpbGVkOiAnICsgc3RhdHVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjbGVhckV2ZW50cyA9IF90aGlzLnNlcnZlclN5bmNUcmVlXy5hY2tVc2VyV3JpdGUod3JpdGVJZCwgIXN1Y2Nlc3MpO1xuICAgICAgICAgICAgX3RoaXMuZXZlbnRRdWV1ZV8ucmFpc2VFdmVudHNGb3JDaGFuZ2VkUGF0aChwYXRoLCBjbGVhckV2ZW50cyk7XG4gICAgICAgICAgICBfdGhpcy5jYWxsT25Db21wbGV0ZUNhbGxiYWNrKG9uQ29tcGxldGUsIHN0YXR1cywgZXJyb3JSZWFzb24pO1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIGFmZmVjdGVkUGF0aCA9IHRoaXMuYWJvcnRUcmFuc2FjdGlvbnNfKHBhdGgpO1xuICAgICAgICB0aGlzLnJlcnVuVHJhbnNhY3Rpb25zXyhhZmZlY3RlZFBhdGgpO1xuICAgICAgICAvLyBXZSBxdWV1ZWQgdGhlIGV2ZW50cyBhYm92ZSwgc28ganVzdCBmbHVzaCB0aGUgcXVldWUgaGVyZVxuICAgICAgICB0aGlzLmV2ZW50UXVldWVfLnJhaXNlRXZlbnRzRm9yQ2hhbmdlZFBhdGgoYWZmZWN0ZWRQYXRoLCBbXSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFQYXRofSBwYXRoXG4gICAgICogQHBhcmFtIHshT2JqZWN0fSBjaGlsZHJlblRvTWVyZ2VcbiAgICAgKiBAcGFyYW0gez9mdW5jdGlvbig/RXJyb3IsICo9KX0gb25Db21wbGV0ZVxuICAgICAqL1xuICAgIFJlcG8ucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChwYXRoLCBjaGlsZHJlblRvTWVyZ2UsIG9uQ29tcGxldGUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5sb2dfKCd1cGRhdGUnLCB7IHBhdGg6IHBhdGgudG9TdHJpbmcoKSwgdmFsdWU6IGNoaWxkcmVuVG9NZXJnZSB9KTtcbiAgICAgICAgLy8gU3RhcnQgd2l0aCBvdXIgZXhpc3RpbmcgZGF0YSBhbmQgbWVyZ2UgZWFjaCBjaGlsZCBpbnRvIGl0LlxuICAgICAgICB2YXIgZW1wdHkgPSB0cnVlO1xuICAgICAgICB2YXIgc2VydmVyVmFsdWVzID0gdGhpcy5nZW5lcmF0ZVNlcnZlclZhbHVlcygpO1xuICAgICAgICB2YXIgY2hhbmdlZENoaWxkcmVuID0ge307XG4gICAgICAgIHV0aWxfMy5mb3JFYWNoKGNoaWxkcmVuVG9NZXJnZSwgZnVuY3Rpb24gKGNoYW5nZWRLZXksIGNoYW5nZWRWYWx1ZSkge1xuICAgICAgICAgICAgZW1wdHkgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBuZXdOb2RlVW5yZXNvbHZlZCA9IG5vZGVGcm9tSlNPTl8xLm5vZGVGcm9tSlNPTihjaGFuZ2VkVmFsdWUpO1xuICAgICAgICAgICAgY2hhbmdlZENoaWxkcmVuW2NoYW5nZWRLZXldID0gU2VydmVyVmFsdWVzXzEucmVzb2x2ZURlZmVycmVkVmFsdWVTbmFwc2hvdChuZXdOb2RlVW5yZXNvbHZlZCwgc2VydmVyVmFsdWVzKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICghZW1wdHkpIHtcbiAgICAgICAgICAgIHZhciB3cml0ZUlkXzEgPSB0aGlzLmdldE5leHRXcml0ZUlkXygpO1xuICAgICAgICAgICAgdmFyIGV2ZW50cyA9IHRoaXMuc2VydmVyU3luY1RyZWVfLmFwcGx5VXNlck1lcmdlKHBhdGgsIGNoYW5nZWRDaGlsZHJlbiwgd3JpdGVJZF8xKTtcbiAgICAgICAgICAgIHRoaXMuZXZlbnRRdWV1ZV8ucXVldWVFdmVudHMoZXZlbnRzKTtcbiAgICAgICAgICAgIHRoaXMuc2VydmVyXy5tZXJnZShwYXRoLnRvU3RyaW5nKCksIGNoaWxkcmVuVG9NZXJnZSwgZnVuY3Rpb24gKHN0YXR1cywgZXJyb3JSZWFzb24pIHtcbiAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHN0YXR1cyA9PT0gJ29rJztcbiAgICAgICAgICAgICAgICBpZiAoIXN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgdXRpbF8yLndhcm4oJ3VwZGF0ZSBhdCAnICsgcGF0aCArICcgZmFpbGVkOiAnICsgc3RhdHVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGNsZWFyRXZlbnRzID0gX3RoaXMuc2VydmVyU3luY1RyZWVfLmFja1VzZXJXcml0ZSh3cml0ZUlkXzEsICFzdWNjZXNzKTtcbiAgICAgICAgICAgICAgICB2YXIgYWZmZWN0ZWRQYXRoID0gY2xlYXJFdmVudHMubGVuZ3RoID4gMCA/IF90aGlzLnJlcnVuVHJhbnNhY3Rpb25zXyhwYXRoKSA6IHBhdGg7XG4gICAgICAgICAgICAgICAgX3RoaXMuZXZlbnRRdWV1ZV8ucmFpc2VFdmVudHNGb3JDaGFuZ2VkUGF0aChhZmZlY3RlZFBhdGgsIGNsZWFyRXZlbnRzKTtcbiAgICAgICAgICAgICAgICBfdGhpcy5jYWxsT25Db21wbGV0ZUNhbGxiYWNrKG9uQ29tcGxldGUsIHN0YXR1cywgZXJyb3JSZWFzb24pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB1dGlsXzMuZm9yRWFjaChjaGlsZHJlblRvTWVyZ2UsIGZ1bmN0aW9uIChjaGFuZ2VkUGF0aCkge1xuICAgICAgICAgICAgICAgIHZhciBhZmZlY3RlZFBhdGggPSBfdGhpcy5hYm9ydFRyYW5zYWN0aW9uc18ocGF0aC5jaGlsZChjaGFuZ2VkUGF0aCkpO1xuICAgICAgICAgICAgICAgIF90aGlzLnJlcnVuVHJhbnNhY3Rpb25zXyhhZmZlY3RlZFBhdGgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyBXZSBxdWV1ZWQgdGhlIGV2ZW50cyBhYm92ZSwgc28ganVzdCBmbHVzaCB0aGUgcXVldWUgaGVyZVxuICAgICAgICAgICAgdGhpcy5ldmVudFF1ZXVlXy5yYWlzZUV2ZW50c0ZvckNoYW5nZWRQYXRoKHBhdGgsIFtdKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHV0aWxfMi5sb2coXCJ1cGRhdGUoKSBjYWxsZWQgd2l0aCBlbXB0eSBkYXRhLiAgRG9uJ3QgZG8gYW55dGhpbmcuXCIpO1xuICAgICAgICAgICAgdGhpcy5jYWxsT25Db21wbGV0ZUNhbGxiYWNrKG9uQ29tcGxldGUsICdvaycpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBBcHBsaWVzIGFsbCBvZiB0aGUgY2hhbmdlcyBzdG9yZWQgdXAgaW4gdGhlIG9uRGlzY29ubmVjdF8gdHJlZS5cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIFJlcG8ucHJvdG90eXBlLnJ1bk9uRGlzY29ubmVjdEV2ZW50c18gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMubG9nXygnb25EaXNjb25uZWN0RXZlbnRzJyk7XG4gICAgICAgIHZhciBzZXJ2ZXJWYWx1ZXMgPSB0aGlzLmdlbmVyYXRlU2VydmVyVmFsdWVzKCk7XG4gICAgICAgIHZhciByZXNvbHZlZE9uRGlzY29ubmVjdFRyZWUgPSBTZXJ2ZXJWYWx1ZXNfMS5yZXNvbHZlRGVmZXJyZWRWYWx1ZVRyZWUodGhpcy5vbkRpc2Nvbm5lY3RfLCBzZXJ2ZXJWYWx1ZXMpO1xuICAgICAgICB2YXIgZXZlbnRzID0gW107XG4gICAgICAgIHJlc29sdmVkT25EaXNjb25uZWN0VHJlZS5mb3JFYWNoVHJlZShQYXRoXzEuUGF0aC5FbXB0eSwgZnVuY3Rpb24gKHBhdGgsIHNuYXApIHtcbiAgICAgICAgICAgIGV2ZW50cyA9IGV2ZW50cy5jb25jYXQoX3RoaXMuc2VydmVyU3luY1RyZWVfLmFwcGx5U2VydmVyT3ZlcndyaXRlKHBhdGgsIHNuYXApKTtcbiAgICAgICAgICAgIHZhciBhZmZlY3RlZFBhdGggPSBfdGhpcy5hYm9ydFRyYW5zYWN0aW9uc18ocGF0aCk7XG4gICAgICAgICAgICBfdGhpcy5yZXJ1blRyYW5zYWN0aW9uc18oYWZmZWN0ZWRQYXRoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMub25EaXNjb25uZWN0XyA9IG5ldyBTcGFyc2VTbmFwc2hvdFRyZWVfMS5TcGFyc2VTbmFwc2hvdFRyZWUoKTtcbiAgICAgICAgdGhpcy5ldmVudFF1ZXVlXy5yYWlzZUV2ZW50c0ZvckNoYW5nZWRQYXRoKFBhdGhfMS5QYXRoLkVtcHR5LCBldmVudHMpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshUGF0aH0gcGF0aFxuICAgICAqIEBwYXJhbSB7P2Z1bmN0aW9uKD9FcnJvciwgKj0pfSBvbkNvbXBsZXRlXG4gICAgICovXG4gICAgUmVwby5wcm90b3R5cGUub25EaXNjb25uZWN0Q2FuY2VsID0gZnVuY3Rpb24gKHBhdGgsIG9uQ29tcGxldGUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5zZXJ2ZXJfLm9uRGlzY29ubmVjdENhbmNlbChwYXRoLnRvU3RyaW5nKCksIGZ1bmN0aW9uIChzdGF0dXMsIGVycm9yUmVhc29uKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzID09PSAnb2snKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMub25EaXNjb25uZWN0Xy5mb3JnZXQocGF0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfdGhpcy5jYWxsT25Db21wbGV0ZUNhbGxiYWNrKG9uQ29tcGxldGUsIHN0YXR1cywgZXJyb3JSZWFzb24pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7IVBhdGh9IHBhdGhcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlXG4gICAgICogQHBhcmFtIHs/ZnVuY3Rpb24oP0Vycm9yLCAqPSl9IG9uQ29tcGxldGVcbiAgICAgKi9cbiAgICBSZXBvLnByb3RvdHlwZS5vbkRpc2Nvbm5lY3RTZXQgPSBmdW5jdGlvbiAocGF0aCwgdmFsdWUsIG9uQ29tcGxldGUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIG5ld05vZGUgPSBub2RlRnJvbUpTT05fMS5ub2RlRnJvbUpTT04odmFsdWUpO1xuICAgICAgICB0aGlzLnNlcnZlcl8ub25EaXNjb25uZWN0UHV0KHBhdGgudG9TdHJpbmcoKSwgbmV3Tm9kZS52YWwoLypleHBvcnQ9Ki8gdHJ1ZSksIGZ1bmN0aW9uIChzdGF0dXMsIGVycm9yUmVhc29uKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzID09PSAnb2snKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMub25EaXNjb25uZWN0Xy5yZW1lbWJlcihwYXRoLCBuZXdOb2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF90aGlzLmNhbGxPbkNvbXBsZXRlQ2FsbGJhY2sob25Db21wbGV0ZSwgc3RhdHVzLCBlcnJvclJlYXNvbik7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshUGF0aH0gcGF0aFxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWVcbiAgICAgKiBAcGFyYW0geyp9IHByaW9yaXR5XG4gICAgICogQHBhcmFtIHs/ZnVuY3Rpb24oP0Vycm9yLCAqPSl9IG9uQ29tcGxldGVcbiAgICAgKi9cbiAgICBSZXBvLnByb3RvdHlwZS5vbkRpc2Nvbm5lY3RTZXRXaXRoUHJpb3JpdHkgPSBmdW5jdGlvbiAocGF0aCwgdmFsdWUsIHByaW9yaXR5LCBvbkNvbXBsZXRlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBuZXdOb2RlID0gbm9kZUZyb21KU09OXzEubm9kZUZyb21KU09OKHZhbHVlLCBwcmlvcml0eSk7XG4gICAgICAgIHRoaXMuc2VydmVyXy5vbkRpc2Nvbm5lY3RQdXQocGF0aC50b1N0cmluZygpLCBuZXdOb2RlLnZhbCgvKmV4cG9ydD0qLyB0cnVlKSwgZnVuY3Rpb24gKHN0YXR1cywgZXJyb3JSZWFzb24pIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgPT09ICdvaycpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5vbkRpc2Nvbm5lY3RfLnJlbWVtYmVyKHBhdGgsIG5ld05vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX3RoaXMuY2FsbE9uQ29tcGxldGVDYWxsYmFjayhvbkNvbXBsZXRlLCBzdGF0dXMsIGVycm9yUmVhc29uKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFQYXRofSBwYXRoXG4gICAgICogQHBhcmFtIHsqfSBjaGlsZHJlblRvTWVyZ2VcbiAgICAgKiBAcGFyYW0gez9mdW5jdGlvbig/RXJyb3IsICo9KX0gb25Db21wbGV0ZVxuICAgICAqL1xuICAgIFJlcG8ucHJvdG90eXBlLm9uRGlzY29ubmVjdFVwZGF0ZSA9IGZ1bmN0aW9uIChwYXRoLCBjaGlsZHJlblRvTWVyZ2UsIG9uQ29tcGxldGUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHV0aWxfMy5pc0VtcHR5KGNoaWxkcmVuVG9NZXJnZSkpIHtcbiAgICAgICAgICAgIHV0aWxfMi5sb2coXCJvbkRpc2Nvbm5lY3QoKS51cGRhdGUoKSBjYWxsZWQgd2l0aCBlbXB0eSBkYXRhLiAgRG9uJ3QgZG8gYW55dGhpbmcuXCIpO1xuICAgICAgICAgICAgdGhpcy5jYWxsT25Db21wbGV0ZUNhbGxiYWNrKG9uQ29tcGxldGUsICdvaycpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2VydmVyXy5vbkRpc2Nvbm5lY3RNZXJnZShwYXRoLnRvU3RyaW5nKCksIGNoaWxkcmVuVG9NZXJnZSwgZnVuY3Rpb24gKHN0YXR1cywgZXJyb3JSZWFzb24pIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgPT09ICdvaycpIHtcbiAgICAgICAgICAgICAgICB1dGlsXzMuZm9yRWFjaChjaGlsZHJlblRvTWVyZ2UsIGZ1bmN0aW9uIChjaGlsZE5hbWUsIGNoaWxkTm9kZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3Q2hpbGROb2RlID0gbm9kZUZyb21KU09OXzEubm9kZUZyb21KU09OKGNoaWxkTm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLm9uRGlzY29ubmVjdF8ucmVtZW1iZXIocGF0aC5jaGlsZChjaGlsZE5hbWUpLCBuZXdDaGlsZE5vZGUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX3RoaXMuY2FsbE9uQ29tcGxldGVDYWxsYmFjayhvbkNvbXBsZXRlLCBzdGF0dXMsIGVycm9yUmVhc29uKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFRdWVyeX0gcXVlcnlcbiAgICAgKiBAcGFyYW0geyFFdmVudFJlZ2lzdHJhdGlvbn0gZXZlbnRSZWdpc3RyYXRpb25cbiAgICAgKi9cbiAgICBSZXBvLnByb3RvdHlwZS5hZGRFdmVudENhbGxiYWNrRm9yUXVlcnkgPSBmdW5jdGlvbiAocXVlcnksIGV2ZW50UmVnaXN0cmF0aW9uKSB7XG4gICAgICAgIHZhciBldmVudHM7XG4gICAgICAgIGlmIChxdWVyeS5wYXRoLmdldEZyb250KCkgPT09ICcuaW5mbycpIHtcbiAgICAgICAgICAgIGV2ZW50cyA9IHRoaXMuaW5mb1N5bmNUcmVlXy5hZGRFdmVudFJlZ2lzdHJhdGlvbihxdWVyeSwgZXZlbnRSZWdpc3RyYXRpb24pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZXZlbnRzID0gdGhpcy5zZXJ2ZXJTeW5jVHJlZV8uYWRkRXZlbnRSZWdpc3RyYXRpb24ocXVlcnksIGV2ZW50UmVnaXN0cmF0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmV2ZW50UXVldWVfLnJhaXNlRXZlbnRzQXRQYXRoKHF1ZXJ5LnBhdGgsIGV2ZW50cyk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFRdWVyeX0gcXVlcnlcbiAgICAgKiBAcGFyYW0gez9FdmVudFJlZ2lzdHJhdGlvbn0gZXZlbnRSZWdpc3RyYXRpb25cbiAgICAgKi9cbiAgICBSZXBvLnByb3RvdHlwZS5yZW1vdmVFdmVudENhbGxiYWNrRm9yUXVlcnkgPSBmdW5jdGlvbiAocXVlcnksIGV2ZW50UmVnaXN0cmF0aW9uKSB7XG4gICAgICAgIC8vIFRoZXNlIGFyZSBndWFyYW50ZWVkIG5vdCB0byByYWlzZSBldmVudHMsIHNpbmNlIHdlJ3JlIG5vdCBwYXNzaW5nIGluIGEgY2FuY2VsRXJyb3IuIEhvd2V2ZXIsIHdlIGNhbiBmdXR1cmUtcHJvb2ZcbiAgICAgICAgLy8gYSBsaXR0bGUgYml0IGJ5IGhhbmRsaW5nIHRoZSByZXR1cm4gdmFsdWVzIGFueXdheXMuXG4gICAgICAgIHZhciBldmVudHM7XG4gICAgICAgIGlmIChxdWVyeS5wYXRoLmdldEZyb250KCkgPT09ICcuaW5mbycpIHtcbiAgICAgICAgICAgIGV2ZW50cyA9IHRoaXMuaW5mb1N5bmNUcmVlXy5yZW1vdmVFdmVudFJlZ2lzdHJhdGlvbihxdWVyeSwgZXZlbnRSZWdpc3RyYXRpb24pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZXZlbnRzID0gdGhpcy5zZXJ2ZXJTeW5jVHJlZV8ucmVtb3ZlRXZlbnRSZWdpc3RyYXRpb24ocXVlcnksIGV2ZW50UmVnaXN0cmF0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmV2ZW50UXVldWVfLnJhaXNlRXZlbnRzQXRQYXRoKHF1ZXJ5LnBhdGgsIGV2ZW50cyk7XG4gICAgfTtcbiAgICBSZXBvLnByb3RvdHlwZS5pbnRlcnJ1cHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnBlcnNpc3RlbnRDb25uZWN0aW9uXykge1xuICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZW50Q29ubmVjdGlvbl8uaW50ZXJydXB0KElOVEVSUlVQVF9SRUFTT04pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBSZXBvLnByb3RvdHlwZS5yZXN1bWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnBlcnNpc3RlbnRDb25uZWN0aW9uXykge1xuICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZW50Q29ubmVjdGlvbl8ucmVzdW1lKElOVEVSUlVQVF9SRUFTT04pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBSZXBvLnByb3RvdHlwZS5zdGF0cyA9IGZ1bmN0aW9uIChzaG93RGVsdGEpIHtcbiAgICAgICAgaWYgKHNob3dEZWx0YSA9PT0gdm9pZCAwKSB7IHNob3dEZWx0YSA9IGZhbHNlOyB9XG4gICAgICAgIGlmICh0eXBlb2YgY29uc29sZSA9PT0gJ3VuZGVmaW5lZCcpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciBzdGF0cztcbiAgICAgICAgaWYgKHNob3dEZWx0YSkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnN0YXRzTGlzdGVuZXJfKVxuICAgICAgICAgICAgICAgIHRoaXMuc3RhdHNMaXN0ZW5lcl8gPSBuZXcgU3RhdHNMaXN0ZW5lcl8xLlN0YXRzTGlzdGVuZXIodGhpcy5zdGF0c18pO1xuICAgICAgICAgICAgc3RhdHMgPSB0aGlzLnN0YXRzTGlzdGVuZXJfLmdldCgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc3RhdHMgPSB0aGlzLnN0YXRzXy5nZXQoKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbG9uZ2VzdE5hbWUgPSBPYmplY3Qua2V5cyhzdGF0cykucmVkdWNlKGZ1bmN0aW9uIChwcmV2aW91c1ZhbHVlLCBjdXJyZW50VmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybiBNYXRoLm1heChjdXJyZW50VmFsdWUubGVuZ3RoLCBwcmV2aW91c1ZhbHVlKTtcbiAgICAgICAgfSwgMCk7XG4gICAgICAgIHV0aWxfMy5mb3JFYWNoKHN0YXRzLCBmdW5jdGlvbiAoc3RhdCwgdmFsdWUpIHtcbiAgICAgICAgICAgIC8vIHBhZCBzdGF0IG5hbWVzIHRvIGJlIHRoZSBzYW1lIGxlbmd0aCAocGx1cyAyIGV4dHJhIHNwYWNlcykuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gc3RhdC5sZW5ndGg7IGkgPCBsb25nZXN0TmFtZSArIDI7IGkrKylcbiAgICAgICAgICAgICAgICBzdGF0ICs9ICcgJztcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHN0YXQgKyB2YWx1ZSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgUmVwby5wcm90b3R5cGUuc3RhdHNJbmNyZW1lbnRDb3VudGVyID0gZnVuY3Rpb24gKG1ldHJpYykge1xuICAgICAgICB0aGlzLnN0YXRzXy5pbmNyZW1lbnRDb3VudGVyKG1ldHJpYyk7XG4gICAgICAgIHRoaXMuc3RhdHNSZXBvcnRlcl8uaW5jbHVkZVN0YXQobWV0cmljKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3NcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIFJlcG8ucHJvdG90eXBlLmxvZ18gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB2YXJfYXJncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyX2FyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcHJlZml4ID0gJyc7XG4gICAgICAgIGlmICh0aGlzLnBlcnNpc3RlbnRDb25uZWN0aW9uXykge1xuICAgICAgICAgICAgcHJlZml4ID0gdGhpcy5wZXJzaXN0ZW50Q29ubmVjdGlvbl8uaWQgKyAnOic7XG4gICAgICAgIH1cbiAgICAgICAgdXRpbF8yLmxvZy5hcHBseSh2b2lkIDAsIFtwcmVmaXhdLmNvbmNhdCh2YXJfYXJncykpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHs/ZnVuY3Rpb24oP0Vycm9yLCAqPSl9IGNhbGxiYWNrXG4gICAgICogQHBhcmFtIHshc3RyaW5nfSBzdGF0dXNcbiAgICAgKiBAcGFyYW0gez9zdHJpbmc9fSBlcnJvclJlYXNvblxuICAgICAqL1xuICAgIFJlcG8ucHJvdG90eXBlLmNhbGxPbkNvbXBsZXRlQ2FsbGJhY2sgPSBmdW5jdGlvbiAoY2FsbGJhY2ssIHN0YXR1cywgZXJyb3JSZWFzb24pIHtcbiAgICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB1dGlsXzIuZXhjZXB0aW9uR3VhcmQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmIChzdGF0dXMgPT0gJ29rJykge1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhudWxsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb2RlID0gKHN0YXR1cyB8fCAnZXJyb3InKS50b1VwcGVyQ2FzZSgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZSA9IGNvZGU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlcnJvclJlYXNvbilcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgKz0gJzogJyArIGVycm9yUmVhc29uO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXJyb3IgPSBuZXcgRXJyb3IobWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgIGVycm9yLmNvZGUgPSBjb2RlO1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXBvLnByb3RvdHlwZSwgXCJkYXRhYmFzZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX19kYXRhYmFzZSB8fCAodGhpcy5fX2RhdGFiYXNlID0gbmV3IERhdGFiYXNlXzEuRGF0YWJhc2UodGhpcykpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICByZXR1cm4gUmVwbztcbn0oKSk7XG5leHBvcnRzLlJlcG8gPSBSZXBvO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1SZXBvLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHV0aWxfMSA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvdXRpbFwiKTtcbnZhciB1dGlsXzIgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG52YXIgc3RvcmFnZV8xID0gcmVxdWlyZShcIi4vc3RvcmFnZS9zdG9yYWdlXCIpO1xudmFyIENvbnN0YW50c18xID0gcmVxdWlyZShcIi4uL3JlYWx0aW1lL0NvbnN0YW50c1wiKTtcbi8qKlxuICogQSBjbGFzcyB0aGF0IGhvbGRzIG1ldGFkYXRhIGFib3V0IGEgUmVwbyBvYmplY3RcbiAqXG4gKiBAY29uc3RydWN0b3JcbiAqL1xudmFyIFJlcG9JbmZvID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBob3N0IEhvc3RuYW1lIHBvcnRpb24gb2YgdGhlIHVybCBmb3IgdGhlIHJlcG9cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IHNlY3VyZSBXaGV0aGVyIG9yIG5vdCB0aGlzIHJlcG8gaXMgYWNjZXNzZWQgb3ZlciBzc2xcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZXNwYWNlIFRoZSBuYW1lc3BhY2UgcmVwcmVzZW50ZWQgYnkgdGhlIHJlcG9cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IHdlYlNvY2tldE9ubHkgV2hldGhlciB0byBwcmVmZXIgd2Vic29ja2V0cyBvdmVyIGFsbCBvdGhlciB0cmFuc3BvcnRzICh1c2VkIGJ5IE5lc3QpLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nPX0gcGVyc2lzdGVuY2VLZXkgT3ZlcnJpZGUgdGhlIGRlZmF1bHQgc2Vzc2lvbiBwZXJzaXN0ZW5jZSBzdG9yYWdlIGtleVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFJlcG9JbmZvKGhvc3QsIHNlY3VyZSwgbmFtZXNwYWNlLCB3ZWJTb2NrZXRPbmx5LCBwZXJzaXN0ZW5jZUtleSkge1xuICAgICAgICBpZiAocGVyc2lzdGVuY2VLZXkgPT09IHZvaWQgMCkgeyBwZXJzaXN0ZW5jZUtleSA9ICcnOyB9XG4gICAgICAgIHRoaXMuc2VjdXJlID0gc2VjdXJlO1xuICAgICAgICB0aGlzLm5hbWVzcGFjZSA9IG5hbWVzcGFjZTtcbiAgICAgICAgdGhpcy53ZWJTb2NrZXRPbmx5ID0gd2ViU29ja2V0T25seTtcbiAgICAgICAgdGhpcy5wZXJzaXN0ZW5jZUtleSA9IHBlcnNpc3RlbmNlS2V5O1xuICAgICAgICB0aGlzLmhvc3QgPSBob3N0LnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIHRoaXMuZG9tYWluID0gdGhpcy5ob3N0LnN1YnN0cih0aGlzLmhvc3QuaW5kZXhPZignLicpICsgMSk7XG4gICAgICAgIHRoaXMuaW50ZXJuYWxIb3N0ID0gc3RvcmFnZV8xLlBlcnNpc3RlbnRTdG9yYWdlLmdldCgnaG9zdDonICsgaG9zdCkgfHwgdGhpcy5ob3N0O1xuICAgIH1cbiAgICBSZXBvSW5mby5wcm90b3R5cGUubmVlZHNRdWVyeVBhcmFtID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ob3N0ICE9PSB0aGlzLmludGVybmFsSG9zdDtcbiAgICB9O1xuICAgIFJlcG9JbmZvLnByb3RvdHlwZS5pc0NhY2hlYWJsZUhvc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmludGVybmFsSG9zdC5zdWJzdHIoMCwgMikgPT09ICdzLSc7XG4gICAgfTtcbiAgICBSZXBvSW5mby5wcm90b3R5cGUuaXNEZW1vSG9zdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZG9tYWluID09PSAnZmlyZWJhc2Vpby1kZW1vLmNvbSc7XG4gICAgfTtcbiAgICBSZXBvSW5mby5wcm90b3R5cGUuaXNDdXN0b21Ib3N0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKHRoaXMuZG9tYWluICE9PSAnZmlyZWJhc2Vpby5jb20nICYmIHRoaXMuZG9tYWluICE9PSAnZmlyZWJhc2Vpby1kZW1vLmNvbScpO1xuICAgIH07XG4gICAgUmVwb0luZm8ucHJvdG90eXBlLnVwZGF0ZUhvc3QgPSBmdW5jdGlvbiAobmV3SG9zdCkge1xuICAgICAgICBpZiAobmV3SG9zdCAhPT0gdGhpcy5pbnRlcm5hbEhvc3QpIHtcbiAgICAgICAgICAgIHRoaXMuaW50ZXJuYWxIb3N0ID0gbmV3SG9zdDtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzQ2FjaGVhYmxlSG9zdCgpKSB7XG4gICAgICAgICAgICAgICAgc3RvcmFnZV8xLlBlcnNpc3RlbnRTdG9yYWdlLnNldCgnaG9zdDonICsgdGhpcy5ob3N0LCB0aGlzLmludGVybmFsSG9zdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIHdlYnNvY2tldCBVUkwgZm9yIHRoaXMgcmVwb1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIG9mIGNvbm5lY3Rpb25cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gcGFyYW1zIGxpc3RcbiAgICAgKiBAcmV0dXJuIHtzdHJpbmd9IFRoZSBVUkwgZm9yIHRoaXMgcmVwb1xuICAgICAqL1xuICAgIFJlcG9JbmZvLnByb3RvdHlwZS5jb25uZWN0aW9uVVJMID0gZnVuY3Rpb24gKHR5cGUsIHBhcmFtcykge1xuICAgICAgICB1dGlsXzEuYXNzZXJ0KHR5cGVvZiB0eXBlID09PSAnc3RyaW5nJywgJ3R5cGVvZiB0eXBlIG11c3QgPT0gc3RyaW5nJyk7XG4gICAgICAgIHV0aWxfMS5hc3NlcnQodHlwZW9mIHBhcmFtcyA9PT0gJ29iamVjdCcsICd0eXBlb2YgcGFyYW1zIG11c3QgPT0gb2JqZWN0Jyk7XG4gICAgICAgIHZhciBjb25uVVJMO1xuICAgICAgICBpZiAodHlwZSA9PT0gQ29uc3RhbnRzXzEuV0VCU09DS0VUKSB7XG4gICAgICAgICAgICBjb25uVVJMID1cbiAgICAgICAgICAgICAgICAodGhpcy5zZWN1cmUgPyAnd3NzOi8vJyA6ICd3czovLycpICsgdGhpcy5pbnRlcm5hbEhvc3QgKyAnLy53cz8nO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHR5cGUgPT09IENvbnN0YW50c18xLkxPTkdfUE9MTElORykge1xuICAgICAgICAgICAgY29ublVSTCA9XG4gICAgICAgICAgICAgICAgKHRoaXMuc2VjdXJlID8gJ2h0dHBzOi8vJyA6ICdodHRwOi8vJykgKyB0aGlzLmludGVybmFsSG9zdCArICcvLmxwPyc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Vua25vd24gY29ubmVjdGlvbiB0eXBlOiAnICsgdHlwZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubmVlZHNRdWVyeVBhcmFtKCkpIHtcbiAgICAgICAgICAgIHBhcmFtc1snbnMnXSA9IHRoaXMubmFtZXNwYWNlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwYWlycyA9IFtdO1xuICAgICAgICB1dGlsXzIuZm9yRWFjaChwYXJhbXMsIGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XG4gICAgICAgICAgICBwYWlycy5wdXNoKGtleSArICc9JyArIHZhbHVlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBjb25uVVJMICsgcGFpcnMuam9pbignJicpO1xuICAgIH07XG4gICAgLyoqIEByZXR1cm4ge3N0cmluZ30gKi9cbiAgICBSZXBvSW5mby5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzdHIgPSB0aGlzLnRvVVJMU3RyaW5nKCk7XG4gICAgICAgIGlmICh0aGlzLnBlcnNpc3RlbmNlS2V5KSB7XG4gICAgICAgICAgICBzdHIgKz0gJzwnICsgdGhpcy5wZXJzaXN0ZW5jZUtleSArICc+JztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3RyO1xuICAgIH07XG4gICAgLyoqIEByZXR1cm4ge3N0cmluZ30gKi9cbiAgICBSZXBvSW5mby5wcm90b3R5cGUudG9VUkxTdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAodGhpcy5zZWN1cmUgPyAnaHR0cHM6Ly8nIDogJ2h0dHA6Ly8nKSArIHRoaXMuaG9zdDtcbiAgICB9O1xuICAgIHJldHVybiBSZXBvSW5mbztcbn0oKSk7XG5leHBvcnRzLlJlcG9JbmZvID0gUmVwb0luZm87XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVJlcG9JbmZvLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHV0aWxfMSA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvdXRpbFwiKTtcbnZhciBSZXBvXzEgPSByZXF1aXJlKFwiLi9SZXBvXCIpO1xudmFyIHV0aWxfMiA9IHJlcXVpcmUoXCIuL3V0aWwvdXRpbFwiKTtcbnZhciBwYXJzZXJfMSA9IHJlcXVpcmUoXCIuL3V0aWwvbGlicy9wYXJzZXJcIik7XG52YXIgdmFsaWRhdGlvbl8xID0gcmVxdWlyZShcIi4vdXRpbC92YWxpZGF0aW9uXCIpO1xucmVxdWlyZShcIi4vUmVwb190cmFuc2FjdGlvblwiKTtcbi8qKiBAY29uc3Qge3N0cmluZ30gKi9cbnZhciBEQVRBQkFTRV9VUkxfT1BUSU9OID0gJ2RhdGFiYXNlVVJMJztcbnZhciBfc3RhdGljSW5zdGFuY2U7XG4vKipcbiAqIENyZWF0ZXMgYW5kIGNhY2hlcyBSZXBvIGluc3RhbmNlcy5cbiAqL1xudmFyIFJlcG9NYW5hZ2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFJlcG9NYW5hZ2VyKCkge1xuICAgICAgICAvKipcbiAgICAgICAgICogQHByaXZhdGUgeyFPYmplY3QuPHN0cmluZywgT2JqZWN0PHN0cmluZywgIWZiLmNvcmUuUmVwbz4+fVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5yZXBvc18gPSB7fTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIElmIHRydWUsIG5ldyBSZXBvcyB3aWxsIGJlIGNyZWF0ZWQgdG8gdXNlIFJlYWRvbmx5UmVzdENsaWVudCAoZm9yIHRlc3RpbmcgcHVycG9zZXMpLlxuICAgICAgICAgKiBAcHJpdmF0ZSB7Ym9vbGVhbn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudXNlUmVzdENsaWVudF8gPSBmYWxzZTtcbiAgICB9XG4gICAgUmVwb01hbmFnZXIuZ2V0SW5zdGFuY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghX3N0YXRpY0luc3RhbmNlKSB7XG4gICAgICAgICAgICBfc3RhdGljSW5zdGFuY2UgPSBuZXcgUmVwb01hbmFnZXIoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX3N0YXRpY0luc3RhbmNlO1xuICAgIH07XG4gICAgLy8gVE9ETyhrb3NzKTogUmVtb3ZlIHRoZXNlIGZ1bmN0aW9ucyB1bmxlc3MgdXNlZCBpbiB0ZXN0cz9cbiAgICBSZXBvTWFuYWdlci5wcm90b3R5cGUuaW50ZXJydXB0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmb3IgKHZhciBhcHBOYW1lIGluIHRoaXMucmVwb3NfKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBkYlVybCBpbiB0aGlzLnJlcG9zX1thcHBOYW1lXSkge1xuICAgICAgICAgICAgICAgIHRoaXMucmVwb3NfW2FwcE5hbWVdW2RiVXJsXS5pbnRlcnJ1cHQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgUmVwb01hbmFnZXIucHJvdG90eXBlLnJlc3VtZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZm9yICh2YXIgYXBwTmFtZSBpbiB0aGlzLnJlcG9zXykge1xuICAgICAgICAgICAgZm9yICh2YXIgZGJVcmwgaW4gdGhpcy5yZXBvc19bYXBwTmFtZV0pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlcG9zX1thcHBOYW1lXVtkYlVybF0ucmVzdW1lKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFRoaXMgZnVuY3Rpb24gc2hvdWxkIG9ubHkgZXZlciBiZSBjYWxsZWQgdG8gQ1JFQVRFIGEgbmV3IGRhdGFiYXNlIGluc3RhbmNlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHshRmlyZWJhc2VBcHB9IGFwcFxuICAgICAqIEByZXR1cm4geyFEYXRhYmFzZX1cbiAgICAgKi9cbiAgICBSZXBvTWFuYWdlci5wcm90b3R5cGUuZGF0YWJhc2VGcm9tQXBwID0gZnVuY3Rpb24gKGFwcCwgdXJsKSB7XG4gICAgICAgIHZhciBkYlVybCA9IHVybCB8fCBhcHAub3B0aW9uc1tEQVRBQkFTRV9VUkxfT1BUSU9OXTtcbiAgICAgICAgaWYgKGRiVXJsID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHV0aWxfMi5mYXRhbChcIkNhbid0IGRldGVybWluZSBGaXJlYmFzZSBEYXRhYmFzZSBVUkwuICBCZSBzdXJlIHRvIGluY2x1ZGUgXCIgK1xuICAgICAgICAgICAgICAgIERBVEFCQVNFX1VSTF9PUFRJT04gK1xuICAgICAgICAgICAgICAgICcgb3B0aW9uIHdoZW4gY2FsbGluZyBmaXJlYmFzZS5pbnRpYWxpemVBcHAoKS4nKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcGFyc2VkVXJsID0gcGFyc2VyXzEucGFyc2VSZXBvSW5mbyhkYlVybCk7XG4gICAgICAgIHZhciByZXBvSW5mbyA9IHBhcnNlZFVybC5yZXBvSW5mbztcbiAgICAgICAgdmFsaWRhdGlvbl8xLnZhbGlkYXRlVXJsKCdJbnZhbGlkIEZpcmViYXNlIERhdGFiYXNlIFVSTCcsIDEsIHBhcnNlZFVybCk7XG4gICAgICAgIGlmICghcGFyc2VkVXJsLnBhdGguaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICB1dGlsXzIuZmF0YWwoJ0RhdGFiYXNlIFVSTCBtdXN0IHBvaW50IHRvIHRoZSByb290IG9mIGEgRmlyZWJhc2UgRGF0YWJhc2UgJyArXG4gICAgICAgICAgICAgICAgJyhub3QgaW5jbHVkaW5nIGEgY2hpbGQgcGF0aCkuJyk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlcG8gPSB0aGlzLmNyZWF0ZVJlcG8ocmVwb0luZm8sIGFwcCk7XG4gICAgICAgIHJldHVybiByZXBvLmRhdGFiYXNlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUmVtb3ZlIHRoZSByZXBvIGFuZCBtYWtlIHN1cmUgaXQgaXMgZGlzY29ubmVjdGVkLlxuICAgICAqXG4gICAgICogQHBhcmFtIHshUmVwb30gcmVwb1xuICAgICAqL1xuICAgIFJlcG9NYW5hZ2VyLnByb3RvdHlwZS5kZWxldGVSZXBvID0gZnVuY3Rpb24gKHJlcG8pIHtcbiAgICAgICAgdmFyIGFwcFJlcG9zID0gdXRpbF8xLnNhZmVHZXQodGhpcy5yZXBvc18sIHJlcG8uYXBwLm5hbWUpO1xuICAgICAgICAvLyBUaGlzIHNob3VsZCBuZXZlciBoYXBwZW4uLi5cbiAgICAgICAgaWYgKCFhcHBSZXBvcyB8fCB1dGlsXzEuc2FmZUdldChhcHBSZXBvcywgcmVwby5yZXBvSW5mb18udG9VUkxTdHJpbmcoKSkgIT09IHJlcG8pIHtcbiAgICAgICAgICAgIHV0aWxfMi5mYXRhbChcIkRhdGFiYXNlIFwiICsgcmVwby5hcHAubmFtZSArIFwiKFwiICsgcmVwby5yZXBvSW5mb18gKyBcIikgaGFzIGFscmVhZHkgYmVlbiBkZWxldGVkLlwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXBvLmludGVycnVwdCgpO1xuICAgICAgICBkZWxldGUgYXBwUmVwb3NbcmVwby5yZXBvSW5mb18udG9VUkxTdHJpbmcoKV07XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBFbnN1cmVzIGEgcmVwbyBkb2Vzbid0IGFscmVhZHkgZXhpc3QgYW5kIHRoZW4gY3JlYXRlcyBvbmUgdXNpbmcgdGhlXG4gICAgICogcHJvdmlkZWQgYXBwLlxuICAgICAqXG4gICAgICogQHBhcmFtIHshUmVwb0luZm99IHJlcG9JbmZvIFRoZSBtZXRhZGF0YSBhYm91dCB0aGUgUmVwb1xuICAgICAqIEBwYXJhbSB7IUZpcmViYXNlQXBwfSBhcHBcbiAgICAgKiBAcmV0dXJuIHshUmVwb30gVGhlIFJlcG8gb2JqZWN0IGZvciB0aGUgc3BlY2lmaWVkIHNlcnZlciAvIHJlcG9OYW1lLlxuICAgICAqL1xuICAgIFJlcG9NYW5hZ2VyLnByb3RvdHlwZS5jcmVhdGVSZXBvID0gZnVuY3Rpb24gKHJlcG9JbmZvLCBhcHApIHtcbiAgICAgICAgdmFyIGFwcFJlcG9zID0gdXRpbF8xLnNhZmVHZXQodGhpcy5yZXBvc18sIGFwcC5uYW1lKTtcbiAgICAgICAgaWYgKCFhcHBSZXBvcykge1xuICAgICAgICAgICAgYXBwUmVwb3MgPSB7fTtcbiAgICAgICAgICAgIHRoaXMucmVwb3NfW2FwcC5uYW1lXSA9IGFwcFJlcG9zO1xuICAgICAgICB9XG4gICAgICAgIHZhciByZXBvID0gdXRpbF8xLnNhZmVHZXQoYXBwUmVwb3MsIHJlcG9JbmZvLnRvVVJMU3RyaW5nKCkpO1xuICAgICAgICBpZiAocmVwbykge1xuICAgICAgICAgICAgdXRpbF8yLmZhdGFsKCdEYXRhYmFzZSBpbml0aWFsaXplZCBtdWx0aXBsZSB0aW1lcy4gUGxlYXNlIG1ha2Ugc3VyZSB0aGUgZm9ybWF0IG9mIHRoZSBkYXRhYmFzZSBVUkwgbWF0Y2hlcyB3aXRoIGVhY2ggZGF0YWJhc2UoKSBjYWxsLicpO1xuICAgICAgICB9XG4gICAgICAgIHJlcG8gPSBuZXcgUmVwb18xLlJlcG8ocmVwb0luZm8sIHRoaXMudXNlUmVzdENsaWVudF8sIGFwcCk7XG4gICAgICAgIGFwcFJlcG9zW3JlcG9JbmZvLnRvVVJMU3RyaW5nKCldID0gcmVwbztcbiAgICAgICAgcmV0dXJuIHJlcG87XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBGb3JjZXMgdXMgdG8gdXNlIFJlYWRvbmx5UmVzdENsaWVudCBpbnN0ZWFkIG9mIFBlcnNpc3RlbnRDb25uZWN0aW9uIGZvciBuZXcgUmVwb3MuXG4gICAgICogQHBhcmFtIHtib29sZWFufSBmb3JjZVJlc3RDbGllbnRcbiAgICAgKi9cbiAgICBSZXBvTWFuYWdlci5wcm90b3R5cGUuZm9yY2VSZXN0Q2xpZW50ID0gZnVuY3Rpb24gKGZvcmNlUmVzdENsaWVudCkge1xuICAgICAgICB0aGlzLnVzZVJlc3RDbGllbnRfID0gZm9yY2VSZXN0Q2xpZW50O1xuICAgIH07XG4gICAgcmV0dXJuIFJlcG9NYW5hZ2VyO1xufSgpKTtcbmV4cG9ydHMuUmVwb01hbmFnZXIgPSBSZXBvTWFuYWdlcjtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UmVwb01hbmFnZXIuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdXRpbF8xID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xudmFyIFJlZmVyZW5jZV8xID0gcmVxdWlyZShcIi4uL2FwaS9SZWZlcmVuY2VcIik7XG52YXIgRGF0YVNuYXBzaG90XzEgPSByZXF1aXJlKFwiLi4vYXBpL0RhdGFTbmFwc2hvdFwiKTtcbnZhciBQYXRoXzEgPSByZXF1aXJlKFwiLi91dGlsL1BhdGhcIik7XG52YXIgVHJlZV8xID0gcmVxdWlyZShcIi4vdXRpbC9UcmVlXCIpO1xudmFyIFByaW9yaXR5SW5kZXhfMSA9IHJlcXVpcmUoXCIuL3NuYXAvaW5kZXhlcy9Qcmlvcml0eUluZGV4XCIpO1xudmFyIHV0aWxfMiA9IHJlcXVpcmUoXCIuL3V0aWwvdXRpbFwiKTtcbnZhciBTZXJ2ZXJWYWx1ZXNfMSA9IHJlcXVpcmUoXCIuL3V0aWwvU2VydmVyVmFsdWVzXCIpO1xudmFyIHZhbGlkYXRpb25fMSA9IHJlcXVpcmUoXCIuL3V0aWwvdmFsaWRhdGlvblwiKTtcbnZhciB1dGlsXzMgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG52YXIgbm9kZUZyb21KU09OXzEgPSByZXF1aXJlKFwiLi9zbmFwL25vZGVGcm9tSlNPTlwiKTtcbnZhciBDaGlsZHJlbk5vZGVfMSA9IHJlcXVpcmUoXCIuL3NuYXAvQ2hpbGRyZW5Ob2RlXCIpO1xudmFyIFJlcG9fMSA9IHJlcXVpcmUoXCIuL1JlcG9cIik7XG4vLyBUT0RPOiBUaGlzIGlzIHByZXR0eSBtZXNzeS4gIElkZWFsbHksIGEgbG90IG9mIHRoaXMgd291bGQgbW92ZSBpbnRvIEZpcmViYXNlRGF0YSwgb3IgYSB0cmFuc2FjdGlvbi1zcGVjaWZpY1xuLy8gY29tcG9uZW50IHVzZWQgYnkgRmlyZWJhc2VEYXRhLCBidXQgaXQgaGFzIHRpZXMgdG8gdXNlciBjYWxsYmFja3MgKHRyYW5zYWN0aW9uIHVwZGF0ZSBhbmQgb25Db21wbGV0ZSkgYXMgd2VsbFxuLy8gYXMgdGhlIHJlYWx0aW1lIGNvbm5lY3Rpb24gKHRvIHNlbmQgdHJhbnNhY3Rpb25zIHRvIHRoZSBzZXJ2ZXIpLiAgU28gdGhhdCBhbGwgbmVlZHMgdG8gYmUgZGVjb3VwbGVkIGZpcnN0LlxuLy8gRm9yIG5vdyBpdCdzIHBhcnQgb2YgUmVwbywgYnV0IGluIGl0cyBvd24gZmlsZS5cbi8qKlxuICogQGVudW0ge251bWJlcn1cbiAqL1xudmFyIFRyYW5zYWN0aW9uU3RhdHVzO1xuKGZ1bmN0aW9uIChUcmFuc2FjdGlvblN0YXR1cykge1xuICAgIC8vIFdlJ3ZlIHJ1biB0aGUgdHJhbnNhY3Rpb24gYW5kIHVwZGF0ZWQgdHJhbnNhY3Rpb25SZXN1bHREYXRhXyB3aXRoIHRoZSByZXN1bHQsIGJ1dCBpdCBpc24ndCBjdXJyZW50bHkgc2VudCB0byB0aGVcbiAgICAvLyBzZXJ2ZXIuIEEgdHJhbnNhY3Rpb24gd2lsbCBnbyBmcm9tIFJVTiAtPiBTRU5UIC0+IFJVTiBpZiBpdCBjb21lcyBiYWNrIGZyb20gdGhlIHNlcnZlciBhcyByZWplY3RlZCBkdWUgdG9cbiAgICAvLyBtaXNtYXRjaGVkIGhhc2guXG4gICAgVHJhbnNhY3Rpb25TdGF0dXNbVHJhbnNhY3Rpb25TdGF0dXNbXCJSVU5cIl0gPSAwXSA9IFwiUlVOXCI7XG4gICAgLy8gV2UndmUgcnVuIHRoZSB0cmFuc2FjdGlvbiBhbmQgc2VudCBpdCB0byB0aGUgc2VydmVyIGFuZCBpdCdzIGN1cnJlbnRseSBvdXRzdGFuZGluZyAoaGFzbid0IGNvbWUgYmFjayBhcyBhY2NlcHRlZFxuICAgIC8vIG9yIHJlamVjdGVkIHlldCkuXG4gICAgVHJhbnNhY3Rpb25TdGF0dXNbVHJhbnNhY3Rpb25TdGF0dXNbXCJTRU5UXCJdID0gMV0gPSBcIlNFTlRcIjtcbiAgICAvLyBUZW1wb3Jhcnkgc3RhdGUgdXNlZCB0byBtYXJrIGNvbXBsZXRlZCB0cmFuc2FjdGlvbnMgKHdoZXRoZXIgc3VjY2Vzc2Z1bCBvciBhYm9ydGVkKS4gIFRoZSB0cmFuc2FjdGlvbiB3aWxsIGJlXG4gICAgLy8gcmVtb3ZlZCB3aGVuIHdlIGdldCBhIGNoYW5jZSB0byBwcnVuZSBjb21wbGV0ZWQgb25lcy5cbiAgICBUcmFuc2FjdGlvblN0YXR1c1tUcmFuc2FjdGlvblN0YXR1c1tcIkNPTVBMRVRFRFwiXSA9IDJdID0gXCJDT01QTEVURURcIjtcbiAgICAvLyBVc2VkIHdoZW4gYW4gYWxyZWFkeS1zZW50IHRyYW5zYWN0aW9uIG5lZWRzIHRvIGJlIGFib3J0ZWQgKGUuZy4gZHVlIHRvIGEgY29uZmxpY3Rpbmcgc2V0KCkgY2FsbCB0aGF0IHdhcyBtYWRlKS5cbiAgICAvLyBJZiBpdCBjb21lcyBiYWNrIGFzIHVuc3VjY2Vzc2Z1bCwgd2UnbGwgYWJvcnQgaXQuXG4gICAgVHJhbnNhY3Rpb25TdGF0dXNbVHJhbnNhY3Rpb25TdGF0dXNbXCJTRU5UX05FRURTX0FCT1JUXCJdID0gM10gPSBcIlNFTlRfTkVFRFNfQUJPUlRcIjtcbiAgICAvLyBUZW1wb3Jhcnkgc3RhdGUgdXNlZCB0byBtYXJrIHRyYW5zYWN0aW9ucyB0aGF0IG5lZWQgdG8gYmUgYWJvcnRlZC5cbiAgICBUcmFuc2FjdGlvblN0YXR1c1tUcmFuc2FjdGlvblN0YXR1c1tcIk5FRURTX0FCT1JUXCJdID0gNF0gPSBcIk5FRURTX0FCT1JUXCI7XG59KShUcmFuc2FjdGlvblN0YXR1cyA9IGV4cG9ydHMuVHJhbnNhY3Rpb25TdGF0dXMgfHwgKGV4cG9ydHMuVHJhbnNhY3Rpb25TdGF0dXMgPSB7fSkpO1xuLyoqXG4gKiBJZiBhIHRyYW5zYWN0aW9uIGRvZXMgbm90IHN1Y2NlZWQgYWZ0ZXIgMjUgcmV0cmllcywgd2UgYWJvcnQgaXQuICBBbW9uZyBvdGhlciB0aGluZ3MgdGhpcyBlbnN1cmUgdGhhdCBpZiB0aGVyZSdzXG4gKiBldmVyIGEgYnVnIGNhdXNpbmcgYSBtaXNtYXRjaCBiZXR3ZWVuIGNsaWVudCAvIHNlcnZlciBoYXNoZXMgZm9yIHNvbWUgZGF0YSwgd2Ugd29uJ3QgcmV0cnkgaW5kZWZpbml0ZWx5LlxuICogQHR5cGUge251bWJlcn1cbiAqIEBjb25zdFxuICogQHByaXZhdGVcbiAqL1xuUmVwb18xLlJlcG8uTUFYX1RSQU5TQUNUSU9OX1JFVFJJRVNfID0gMjU7XG4vKipcbiAqIFNldHVwIHRoZSB0cmFuc2FjdGlvbiBkYXRhIHN0cnVjdHVyZXNcbiAqIEBwcml2YXRlXG4gKi9cblJlcG9fMS5SZXBvLnByb3RvdHlwZS50cmFuc2FjdGlvbnNfaW5pdF8gPSBmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogU3RvcmVzIHF1ZXVlcyBvZiBvdXRzdGFuZGluZyB0cmFuc2FjdGlvbnMgZm9yIEZpcmViYXNlIGxvY2F0aW9ucy5cbiAgICAgKlxuICAgICAqIEB0eXBlIHshVHJlZS48QXJyYXkuPCFUcmFuc2FjdGlvbj4+fVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgdGhpcy50cmFuc2FjdGlvblF1ZXVlVHJlZV8gPSBuZXcgVHJlZV8xLlRyZWUoKTtcbn07XG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgdHJhbnNhY3Rpb24sIGFkZHMgaXQgdG8gdGhlIHRyYW5zYWN0aW9ucyB3ZSdyZSB0cmFja2luZywgYW5kIHNlbmRzIGl0IHRvIHRoZSBzZXJ2ZXIgaWYgcG9zc2libGUuXG4gKlxuICogQHBhcmFtIHshUGF0aH0gcGF0aCBQYXRoIGF0IHdoaWNoIHRvIGRvIHRyYW5zYWN0aW9uLlxuICogQHBhcmFtIHtmdW5jdGlvbigqKToqfSB0cmFuc2FjdGlvblVwZGF0ZSBVcGRhdGUgY2FsbGJhY2suXG4gKiBAcGFyYW0gez9mdW5jdGlvbig/RXJyb3IsIGJvb2xlYW4sID9EYXRhU25hcHNob3QpfSBvbkNvbXBsZXRlIENvbXBsZXRpb24gY2FsbGJhY2suXG4gKiBAcGFyYW0ge2Jvb2xlYW59IGFwcGx5TG9jYWxseSBXaGV0aGVyIG9yIG5vdCB0byBtYWtlIGludGVybWVkaWF0ZSByZXN1bHRzIHZpc2libGVcbiAqL1xuUmVwb18xLlJlcG8ucHJvdG90eXBlLnN0YXJ0VHJhbnNhY3Rpb24gPSBmdW5jdGlvbiAocGF0aCwgdHJhbnNhY3Rpb25VcGRhdGUsIG9uQ29tcGxldGUsIGFwcGx5TG9jYWxseSkge1xuICAgIHRoaXMubG9nXygndHJhbnNhY3Rpb24gb24gJyArIHBhdGgpO1xuICAgIC8vIEFkZCBhIHdhdGNoIHRvIG1ha2Ugc3VyZSB3ZSBnZXQgc2VydmVyIHVwZGF0ZXMuXG4gICAgdmFyIHZhbHVlQ2FsbGJhY2sgPSBmdW5jdGlvbiAoKSB7IH07XG4gICAgdmFyIHdhdGNoUmVmID0gbmV3IFJlZmVyZW5jZV8xLlJlZmVyZW5jZSh0aGlzLCBwYXRoKTtcbiAgICB3YXRjaFJlZi5vbigndmFsdWUnLCB2YWx1ZUNhbGxiYWNrKTtcbiAgICB2YXIgdW53YXRjaGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB3YXRjaFJlZi5vZmYoJ3ZhbHVlJywgdmFsdWVDYWxsYmFjayk7XG4gICAgfTtcbiAgICAvLyBJbml0aWFsaXplIHRyYW5zYWN0aW9uLlxuICAgIHZhciB0cmFuc2FjdGlvbiA9IHtcbiAgICAgICAgcGF0aDogcGF0aCxcbiAgICAgICAgdXBkYXRlOiB0cmFuc2FjdGlvblVwZGF0ZSxcbiAgICAgICAgb25Db21wbGV0ZTogb25Db21wbGV0ZSxcbiAgICAgICAgLy8gT25lIG9mIFRyYW5zYWN0aW9uU3RhdHVzIGVudW1zLlxuICAgICAgICBzdGF0dXM6IG51bGwsXG4gICAgICAgIC8vIFVzZWQgd2hlbiBjb21iaW5pbmcgdHJhbnNhY3Rpb25zIGF0IGRpZmZlcmVudCBsb2NhdGlvbnMgdG8gZmlndXJlIG91dCB3aGljaCBvbmUgZ29lcyBmaXJzdC5cbiAgICAgICAgb3JkZXI6IHV0aWxfMi5MVUlER2VuZXJhdG9yKCksXG4gICAgICAgIC8vIFdoZXRoZXIgdG8gcmFpc2UgbG9jYWwgZXZlbnRzIGZvciB0aGlzIHRyYW5zYWN0aW9uLlxuICAgICAgICBhcHBseUxvY2FsbHk6IGFwcGx5TG9jYWxseSxcbiAgICAgICAgLy8gQ291bnQgb2YgaG93IG1hbnkgdGltZXMgd2UndmUgcmV0cmllZCB0aGUgdHJhbnNhY3Rpb24uXG4gICAgICAgIHJldHJ5Q291bnQ6IDAsXG4gICAgICAgIC8vIEZ1bmN0aW9uIHRvIGNhbGwgdG8gY2xlYW4gdXAgb3VyIC5vbigpIGxpc3RlbmVyLlxuICAgICAgICB1bndhdGNoZXI6IHVud2F0Y2hlcixcbiAgICAgICAgLy8gU3RvcmVzIHdoeSBhIHRyYW5zYWN0aW9uIHdhcyBhYm9ydGVkLlxuICAgICAgICBhYm9ydFJlYXNvbjogbnVsbCxcbiAgICAgICAgY3VycmVudFdyaXRlSWQ6IG51bGwsXG4gICAgICAgIGN1cnJlbnRJbnB1dFNuYXBzaG90OiBudWxsLFxuICAgICAgICBjdXJyZW50T3V0cHV0U25hcHNob3RSYXc6IG51bGwsXG4gICAgICAgIGN1cnJlbnRPdXRwdXRTbmFwc2hvdFJlc29sdmVkOiBudWxsXG4gICAgfTtcbiAgICAvLyBSdW4gdHJhbnNhY3Rpb24gaW5pdGlhbGx5LlxuICAgIHZhciBjdXJyZW50U3RhdGUgPSB0aGlzLmdldExhdGVzdFN0YXRlXyhwYXRoKTtcbiAgICB0cmFuc2FjdGlvbi5jdXJyZW50SW5wdXRTbmFwc2hvdCA9IGN1cnJlbnRTdGF0ZTtcbiAgICB2YXIgbmV3VmFsID0gdHJhbnNhY3Rpb24udXBkYXRlKGN1cnJlbnRTdGF0ZS52YWwoKSk7XG4gICAgaWYgKG5ld1ZhbCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIC8vIEFib3J0IHRyYW5zYWN0aW9uLlxuICAgICAgICB0cmFuc2FjdGlvbi51bndhdGNoZXIoKTtcbiAgICAgICAgdHJhbnNhY3Rpb24uY3VycmVudE91dHB1dFNuYXBzaG90UmF3ID0gbnVsbDtcbiAgICAgICAgdHJhbnNhY3Rpb24uY3VycmVudE91dHB1dFNuYXBzaG90UmVzb2x2ZWQgPSBudWxsO1xuICAgICAgICBpZiAodHJhbnNhY3Rpb24ub25Db21wbGV0ZSkge1xuICAgICAgICAgICAgLy8gV2UganVzdCBzZXQgdGhlIGlucHV0IHNuYXBzaG90LCBzbyB0aGlzIGNhc3Qgc2hvdWxkIGJlIHNhZmVcbiAgICAgICAgICAgIHZhciBzbmFwc2hvdCA9IG5ldyBEYXRhU25hcHNob3RfMS5EYXRhU25hcHNob3QodHJhbnNhY3Rpb24uY3VycmVudElucHV0U25hcHNob3QsIG5ldyBSZWZlcmVuY2VfMS5SZWZlcmVuY2UodGhpcywgdHJhbnNhY3Rpb24ucGF0aCksIFByaW9yaXR5SW5kZXhfMS5QUklPUklUWV9JTkRFWCk7XG4gICAgICAgICAgICB0cmFuc2FjdGlvbi5vbkNvbXBsZXRlKG51bGwsIGZhbHNlLCBzbmFwc2hvdCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHZhbGlkYXRpb25fMS52YWxpZGF0ZUZpcmViYXNlRGF0YSgndHJhbnNhY3Rpb24gZmFpbGVkOiBEYXRhIHJldHVybmVkICcsIG5ld1ZhbCwgdHJhbnNhY3Rpb24ucGF0aCk7XG4gICAgICAgIC8vIE1hcmsgYXMgcnVuIGFuZCBhZGQgdG8gb3VyIHF1ZXVlLlxuICAgICAgICB0cmFuc2FjdGlvbi5zdGF0dXMgPSBUcmFuc2FjdGlvblN0YXR1cy5SVU47XG4gICAgICAgIHZhciBxdWV1ZU5vZGUgPSB0aGlzLnRyYW5zYWN0aW9uUXVldWVUcmVlXy5zdWJUcmVlKHBhdGgpO1xuICAgICAgICB2YXIgbm9kZVF1ZXVlID0gcXVldWVOb2RlLmdldFZhbHVlKCkgfHwgW107XG4gICAgICAgIG5vZGVRdWV1ZS5wdXNoKHRyYW5zYWN0aW9uKTtcbiAgICAgICAgcXVldWVOb2RlLnNldFZhbHVlKG5vZGVRdWV1ZSk7XG4gICAgICAgIC8vIFVwZGF0ZSB2aXNpYmxlRGF0YSBhbmQgcmFpc2UgZXZlbnRzXG4gICAgICAgIC8vIE5vdGU6IFdlIGludGVudGlvbmFsbHkgcmFpc2UgZXZlbnRzIGFmdGVyIHVwZGF0aW5nIGFsbCBvZiBvdXIgdHJhbnNhY3Rpb24gc3RhdGUsIHNpbmNlIHRoZSB1c2VyIGNvdWxkXG4gICAgICAgIC8vIHN0YXJ0IG5ldyB0cmFuc2FjdGlvbnMgZnJvbSB0aGUgZXZlbnQgY2FsbGJhY2tzLlxuICAgICAgICB2YXIgcHJpb3JpdHlGb3JOb2RlID0gdm9pZCAwO1xuICAgICAgICBpZiAodHlwZW9mIG5ld1ZhbCA9PT0gJ29iamVjdCcgJiZcbiAgICAgICAgICAgIG5ld1ZhbCAhPT0gbnVsbCAmJlxuICAgICAgICAgICAgdXRpbF8zLmNvbnRhaW5zKG5ld1ZhbCwgJy5wcmlvcml0eScpKSB7XG4gICAgICAgICAgICBwcmlvcml0eUZvck5vZGUgPSB1dGlsXzMuc2FmZUdldChuZXdWYWwsICcucHJpb3JpdHknKTtcbiAgICAgICAgICAgIHV0aWxfMS5hc3NlcnQodmFsaWRhdGlvbl8xLmlzVmFsaWRQcmlvcml0eShwcmlvcml0eUZvck5vZGUpLCAnSW52YWxpZCBwcmlvcml0eSByZXR1cm5lZCBieSB0cmFuc2FjdGlvbi4gJyArXG4gICAgICAgICAgICAgICAgJ1ByaW9yaXR5IG11c3QgYmUgYSB2YWxpZCBzdHJpbmcsIGZpbml0ZSBudW1iZXIsIHNlcnZlciB2YWx1ZSwgb3IgbnVsbC4nKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50Tm9kZSA9IHRoaXMuc2VydmVyU3luY1RyZWVfLmNhbGNDb21wbGV0ZUV2ZW50Q2FjaGUocGF0aCkgfHxcbiAgICAgICAgICAgICAgICBDaGlsZHJlbk5vZGVfMS5DaGlsZHJlbk5vZGUuRU1QVFlfTk9ERTtcbiAgICAgICAgICAgIHByaW9yaXR5Rm9yTm9kZSA9IGN1cnJlbnROb2RlLmdldFByaW9yaXR5KCkudmFsKCk7XG4gICAgICAgIH1cbiAgICAgICAgcHJpb3JpdHlGb3JOb2RlIC8qKiBAdHlwZSB7bnVsbHxudW1iZXJ8c3RyaW5nfSAqLyA9IHByaW9yaXR5Rm9yTm9kZTtcbiAgICAgICAgdmFyIHNlcnZlclZhbHVlcyA9IHRoaXMuZ2VuZXJhdGVTZXJ2ZXJWYWx1ZXMoKTtcbiAgICAgICAgdmFyIG5ld05vZGVVbnJlc29sdmVkID0gbm9kZUZyb21KU09OXzEubm9kZUZyb21KU09OKG5ld1ZhbCwgcHJpb3JpdHlGb3JOb2RlKTtcbiAgICAgICAgdmFyIG5ld05vZGUgPSBTZXJ2ZXJWYWx1ZXNfMS5yZXNvbHZlRGVmZXJyZWRWYWx1ZVNuYXBzaG90KG5ld05vZGVVbnJlc29sdmVkLCBzZXJ2ZXJWYWx1ZXMpO1xuICAgICAgICB0cmFuc2FjdGlvbi5jdXJyZW50T3V0cHV0U25hcHNob3RSYXcgPSBuZXdOb2RlVW5yZXNvbHZlZDtcbiAgICAgICAgdHJhbnNhY3Rpb24uY3VycmVudE91dHB1dFNuYXBzaG90UmVzb2x2ZWQgPSBuZXdOb2RlO1xuICAgICAgICB0cmFuc2FjdGlvbi5jdXJyZW50V3JpdGVJZCA9IHRoaXMuZ2V0TmV4dFdyaXRlSWRfKCk7XG4gICAgICAgIHZhciBldmVudHMgPSB0aGlzLnNlcnZlclN5bmNUcmVlXy5hcHBseVVzZXJPdmVyd3JpdGUocGF0aCwgbmV3Tm9kZSwgdHJhbnNhY3Rpb24uY3VycmVudFdyaXRlSWQsIHRyYW5zYWN0aW9uLmFwcGx5TG9jYWxseSk7XG4gICAgICAgIHRoaXMuZXZlbnRRdWV1ZV8ucmFpc2VFdmVudHNGb3JDaGFuZ2VkUGF0aChwYXRoLCBldmVudHMpO1xuICAgICAgICB0aGlzLnNlbmRSZWFkeVRyYW5zYWN0aW9uc18oKTtcbiAgICB9XG59O1xuLyoqXG4gKiBAcGFyYW0geyFQYXRofSBwYXRoXG4gKiBAcGFyYW0ge0FycmF5LjxudW1iZXI+PX0gZXhjbHVkZVNldHMgQSBzcGVjaWZpYyBzZXQgdG8gZXhjbHVkZVxuICogQHJldHVybiB7Tm9kZX1cbiAqIEBwcml2YXRlXG4gKi9cblJlcG9fMS5SZXBvLnByb3RvdHlwZS5nZXRMYXRlc3RTdGF0ZV8gPSBmdW5jdGlvbiAocGF0aCwgZXhjbHVkZVNldHMpIHtcbiAgICByZXR1cm4gKHRoaXMuc2VydmVyU3luY1RyZWVfLmNhbGNDb21wbGV0ZUV2ZW50Q2FjaGUocGF0aCwgZXhjbHVkZVNldHMpIHx8XG4gICAgICAgIENoaWxkcmVuTm9kZV8xLkNoaWxkcmVuTm9kZS5FTVBUWV9OT0RFKTtcbn07XG4vKipcbiAqIFNlbmRzIGFueSBhbHJlYWR5LXJ1biB0cmFuc2FjdGlvbnMgdGhhdCBhcmVuJ3Qgd2FpdGluZyBmb3Igb3V0c3RhbmRpbmcgdHJhbnNhY3Rpb25zIHRvXG4gKiBjb21wbGV0ZS5cbiAqXG4gKiBFeHRlcm5hbGx5IGl0J3MgY2FsbGVkIHdpdGggbm8gYXJndW1lbnRzLCBidXQgaXQgY2FsbHMgaXRzZWxmIHJlY3Vyc2l2ZWx5IHdpdGggYSBwYXJ0aWN1bGFyXG4gKiB0cmFuc2FjdGlvblF1ZXVlVHJlZSBub2RlIHRvIHJlY3Vyc2UgdGhyb3VnaCB0aGUgdHJlZS5cbiAqXG4gKiBAcGFyYW0ge1RyZWUuPEFycmF5LjxUcmFuc2FjdGlvbj4+PX0gbm9kZSAgdHJhbnNhY3Rpb25RdWV1ZVRyZWUgbm9kZSB0byBzdGFydCBhdC5cbiAqIEBwcml2YXRlXG4gKi9cblJlcG9fMS5SZXBvLnByb3RvdHlwZS5zZW5kUmVhZHlUcmFuc2FjdGlvbnNfID0gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgIGlmIChub2RlID09PSB2b2lkIDApIHsgbm9kZSA9IHRoaXMudHJhbnNhY3Rpb25RdWV1ZVRyZWVfOyB9XG4gICAgLy8gQmVmb3JlIHJlY3Vyc2luZywgbWFrZSBzdXJlIGFueSBjb21wbGV0ZWQgdHJhbnNhY3Rpb25zIGFyZSByZW1vdmVkLlxuICAgIGlmICghbm9kZSkge1xuICAgICAgICB0aGlzLnBydW5lQ29tcGxldGVkVHJhbnNhY3Rpb25zQmVsb3dOb2RlXyhub2RlKTtcbiAgICB9XG4gICAgaWYgKG5vZGUuZ2V0VmFsdWUoKSAhPT0gbnVsbCkge1xuICAgICAgICB2YXIgcXVldWUgPSB0aGlzLmJ1aWxkVHJhbnNhY3Rpb25RdWV1ZV8obm9kZSk7XG4gICAgICAgIHV0aWxfMS5hc3NlcnQocXVldWUubGVuZ3RoID4gMCwgJ1NlbmRpbmcgemVybyBsZW5ndGggdHJhbnNhY3Rpb24gcXVldWUnKTtcbiAgICAgICAgdmFyIGFsbFJ1biA9IHF1ZXVlLmV2ZXJ5KGZ1bmN0aW9uICh0cmFuc2FjdGlvbikgeyByZXR1cm4gdHJhbnNhY3Rpb24uc3RhdHVzID09PSBUcmFuc2FjdGlvblN0YXR1cy5SVU47IH0pO1xuICAgICAgICAvLyBJZiB0aGV5J3JlIGFsbCBydW4gKGFuZCBub3Qgc2VudCksIHdlIGNhbiBzZW5kIHRoZW0uICBFbHNlLCB3ZSBtdXN0IHdhaXQuXG4gICAgICAgIGlmIChhbGxSdW4pIHtcbiAgICAgICAgICAgIHRoaXMuc2VuZFRyYW5zYWN0aW9uUXVldWVfKG5vZGUucGF0aCgpLCBxdWV1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAobm9kZS5oYXNDaGlsZHJlbigpKSB7XG4gICAgICAgIG5vZGUuZm9yRWFjaENoaWxkKGZ1bmN0aW9uIChjaGlsZE5vZGUpIHtcbiAgICAgICAgICAgIF90aGlzLnNlbmRSZWFkeVRyYW5zYWN0aW9uc18oY2hpbGROb2RlKTtcbiAgICAgICAgfSk7XG4gICAgfVxufTtcbi8qKlxuICogR2l2ZW4gYSBsaXN0IG9mIHJ1biB0cmFuc2FjdGlvbnMsIHNlbmQgdGhlbSB0byB0aGUgc2VydmVyIGFuZCB0aGVuIGhhbmRsZSB0aGUgcmVzdWx0IChzdWNjZXNzIG9yIGZhaWx1cmUpLlxuICpcbiAqIEBwYXJhbSB7IVBhdGh9IHBhdGggVGhlIGxvY2F0aW9uIG9mIHRoZSBxdWV1ZS5cbiAqIEBwYXJhbSB7IUFycmF5LjxUcmFuc2FjdGlvbj59IHF1ZXVlIFF1ZXVlIG9mIHRyYW5zYWN0aW9ucyB1bmRlciB0aGUgc3BlY2lmaWVkIGxvY2F0aW9uLlxuICogQHByaXZhdGVcbiAqL1xuUmVwb18xLlJlcG8ucHJvdG90eXBlLnNlbmRUcmFuc2FjdGlvblF1ZXVlXyA9IGZ1bmN0aW9uIChwYXRoLCBxdWV1ZSkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgLy8gTWFyayB0cmFuc2FjdGlvbnMgYXMgc2VudCBhbmQgaW5jcmVtZW50IHJldHJ5IGNvdW50IVxuICAgIHZhciBzZXRzVG9JZ25vcmUgPSBxdWV1ZS5tYXAoZnVuY3Rpb24gKHR4bikge1xuICAgICAgICByZXR1cm4gdHhuLmN1cnJlbnRXcml0ZUlkO1xuICAgIH0pO1xuICAgIHZhciBsYXRlc3RTdGF0ZSA9IHRoaXMuZ2V0TGF0ZXN0U3RhdGVfKHBhdGgsIHNldHNUb0lnbm9yZSk7XG4gICAgdmFyIHNuYXBUb1NlbmQgPSBsYXRlc3RTdGF0ZTtcbiAgICB2YXIgbGF0ZXN0SGFzaCA9IGxhdGVzdFN0YXRlLmhhc2goKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHF1ZXVlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciB0eG4gPSBxdWV1ZVtpXTtcbiAgICAgICAgdXRpbF8xLmFzc2VydCh0eG4uc3RhdHVzID09PSBUcmFuc2FjdGlvblN0YXR1cy5SVU4sICd0cnlUb1NlbmRUcmFuc2FjdGlvblF1ZXVlXzogaXRlbXMgaW4gcXVldWUgc2hvdWxkIGFsbCBiZSBydW4uJyk7XG4gICAgICAgIHR4bi5zdGF0dXMgPSBUcmFuc2FjdGlvblN0YXR1cy5TRU5UO1xuICAgICAgICB0eG4ucmV0cnlDb3VudCsrO1xuICAgICAgICB2YXIgcmVsYXRpdmVQYXRoID0gUGF0aF8xLlBhdGgucmVsYXRpdmVQYXRoKHBhdGgsIHR4bi5wYXRoKTtcbiAgICAgICAgLy8gSWYgd2UndmUgZ290dGVuIHRvIHRoaXMgcG9pbnQsIHRoZSBvdXRwdXQgc25hcHNob3QgbXVzdCBiZSBkZWZpbmVkLlxuICAgICAgICBzbmFwVG9TZW5kID0gc25hcFRvU2VuZC51cGRhdGVDaGlsZChyZWxhdGl2ZVBhdGggLyoqQHR5cGUgeyFOb2RlfSAqLywgdHhuLmN1cnJlbnRPdXRwdXRTbmFwc2hvdFJhdyk7XG4gICAgfVxuICAgIHZhciBkYXRhVG9TZW5kID0gc25hcFRvU2VuZC52YWwodHJ1ZSk7XG4gICAgdmFyIHBhdGhUb1NlbmQgPSBwYXRoO1xuICAgIC8vIFNlbmQgdGhlIHB1dC5cbiAgICB0aGlzLnNlcnZlcl8ucHV0KHBhdGhUb1NlbmQudG9TdHJpbmcoKSwgZGF0YVRvU2VuZCwgZnVuY3Rpb24gKHN0YXR1cykge1xuICAgICAgICBfdGhpcy5sb2dfKCd0cmFuc2FjdGlvbiBwdXQgcmVzcG9uc2UnLCB7XG4gICAgICAgICAgICBwYXRoOiBwYXRoVG9TZW5kLnRvU3RyaW5nKCksXG4gICAgICAgICAgICBzdGF0dXM6IHN0YXR1c1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIGV2ZW50cyA9IFtdO1xuICAgICAgICBpZiAoc3RhdHVzID09PSAnb2snKSB7XG4gICAgICAgICAgICAvLyBRdWV1ZSB1cCB0aGUgY2FsbGJhY2tzIGFuZCBmaXJlIHRoZW0gYWZ0ZXIgY2xlYW5pbmcgdXAgYWxsIG9mIG91ciB0cmFuc2FjdGlvbiBzdGF0ZSwgc2luY2VcbiAgICAgICAgICAgIC8vIHRoZSBjYWxsYmFjayBjb3VsZCB0cmlnZ2VyIG1vcmUgdHJhbnNhY3Rpb25zIG9yIHNldHMuXG4gICAgICAgICAgICB2YXIgY2FsbGJhY2tzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHF1ZXVlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcXVldWVbaV0uc3RhdHVzID0gVHJhbnNhY3Rpb25TdGF0dXMuQ09NUExFVEVEO1xuICAgICAgICAgICAgICAgIGV2ZW50cyA9IGV2ZW50cy5jb25jYXQoX3RoaXMuc2VydmVyU3luY1RyZWVfLmFja1VzZXJXcml0ZShxdWV1ZVtpXS5jdXJyZW50V3JpdGVJZCkpO1xuICAgICAgICAgICAgICAgIGlmIChxdWV1ZVtpXS5vbkNvbXBsZXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFdlIG5ldmVyIHVuc2V0IHRoZSBvdXRwdXQgc25hcHNob3QsIGFuZCBnaXZlbiB0aGF0IHRoaXMgdHJhbnNhY3Rpb24gaXMgY29tcGxldGUsIGl0IHNob3VsZCBiZSBzZXRcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGUgPSBxdWV1ZVtpXS5jdXJyZW50T3V0cHV0U25hcHNob3RSZXNvbHZlZDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlZiA9IG5ldyBSZWZlcmVuY2VfMS5SZWZlcmVuY2UoX3RoaXMsIHF1ZXVlW2ldLnBhdGgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc25hcHNob3QgPSBuZXcgRGF0YVNuYXBzaG90XzEuRGF0YVNuYXBzaG90KG5vZGUsIHJlZiwgUHJpb3JpdHlJbmRleF8xLlBSSU9SSVRZX0lOREVYKTtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2tzLnB1c2gocXVldWVbaV0ub25Db21wbGV0ZS5iaW5kKG51bGwsIG51bGwsIHRydWUsIHNuYXBzaG90KSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHF1ZXVlW2ldLnVud2F0Y2hlcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gTm93IHJlbW92ZSB0aGUgY29tcGxldGVkIHRyYW5zYWN0aW9ucy5cbiAgICAgICAgICAgIF90aGlzLnBydW5lQ29tcGxldGVkVHJhbnNhY3Rpb25zQmVsb3dOb2RlXyhfdGhpcy50cmFuc2FjdGlvblF1ZXVlVHJlZV8uc3ViVHJlZShwYXRoKSk7XG4gICAgICAgICAgICAvLyBUaGVyZSBtYXkgYmUgcGVuZGluZyB0cmFuc2FjdGlvbnMgdGhhdCB3ZSBjYW4gbm93IHNlbmQuXG4gICAgICAgICAgICBfdGhpcy5zZW5kUmVhZHlUcmFuc2FjdGlvbnNfKCk7XG4gICAgICAgICAgICBfdGhpcy5ldmVudFF1ZXVlXy5yYWlzZUV2ZW50c0ZvckNoYW5nZWRQYXRoKHBhdGgsIGV2ZW50cyk7XG4gICAgICAgICAgICAvLyBGaW5hbGx5LCB0cmlnZ2VyIG9uQ29tcGxldGUgY2FsbGJhY2tzLlxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYWxsYmFja3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB1dGlsXzIuZXhjZXB0aW9uR3VhcmQoY2FsbGJhY2tzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIHRyYW5zYWN0aW9ucyBhcmUgbm8gbG9uZ2VyIHNlbnQuICBVcGRhdGUgdGhlaXIgc3RhdHVzIGFwcHJvcHJpYXRlbHkuXG4gICAgICAgICAgICBpZiAoc3RhdHVzID09PSAnZGF0YXN0YWxlJykge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcXVldWUubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHF1ZXVlW2ldLnN0YXR1cyA9PT0gVHJhbnNhY3Rpb25TdGF0dXMuU0VOVF9ORUVEU19BQk9SVClcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXVlW2ldLnN0YXR1cyA9IFRyYW5zYWN0aW9uU3RhdHVzLk5FRURTX0FCT1JUO1xuICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWV1ZVtpXS5zdGF0dXMgPSBUcmFuc2FjdGlvblN0YXR1cy5SVU47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdXRpbF8yLndhcm4oJ3RyYW5zYWN0aW9uIGF0ICcgKyBwYXRoVG9TZW5kLnRvU3RyaW5nKCkgKyAnIGZhaWxlZDogJyArIHN0YXR1cyk7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBxdWV1ZS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBxdWV1ZVtpXS5zdGF0dXMgPSBUcmFuc2FjdGlvblN0YXR1cy5ORUVEU19BQk9SVDtcbiAgICAgICAgICAgICAgICAgICAgcXVldWVbaV0uYWJvcnRSZWFzb24gPSBzdGF0dXM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX3RoaXMucmVydW5UcmFuc2FjdGlvbnNfKHBhdGgpO1xuICAgICAgICB9XG4gICAgfSwgbGF0ZXN0SGFzaCk7XG59O1xuLyoqXG4gKiBGaW5kcyBhbGwgdHJhbnNhY3Rpb25zIGRlcGVuZGVudCBvbiB0aGUgZGF0YSBhdCBjaGFuZ2VkUGF0aCBhbmQgcmVydW5zIHRoZW0uXG4gKlxuICogU2hvdWxkIGJlIGNhbGxlZCBhbnkgdGltZSBjYWNoZWQgZGF0YSBjaGFuZ2VzLlxuICpcbiAqIFJldHVybiB0aGUgaGlnaGVzdCBwYXRoIHRoYXQgd2FzIGFmZmVjdGVkIGJ5IHJlcnVubmluZyB0cmFuc2FjdGlvbnMuICBUaGlzIGlzIHRoZSBwYXRoIGF0IHdoaWNoIGV2ZW50cyBuZWVkIHRvXG4gKiBiZSByYWlzZWQgZm9yLlxuICpcbiAqIEBwYXJhbSB7IVBhdGh9IGNoYW5nZWRQYXRoIFRoZSBwYXRoIGluIG1lcmdlZERhdGEgdGhhdCBjaGFuZ2VkLlxuICogQHJldHVybiB7IVBhdGh9IFRoZSByb290bW9zdCBwYXRoIHRoYXQgd2FzIGFmZmVjdGVkIGJ5IHJlcnVubmluZyB0cmFuc2FjdGlvbnMuXG4gKiBAcHJpdmF0ZVxuICovXG5SZXBvXzEuUmVwby5wcm90b3R5cGUucmVydW5UcmFuc2FjdGlvbnNfID0gZnVuY3Rpb24gKGNoYW5nZWRQYXRoKSB7XG4gICAgdmFyIHJvb3RNb3N0VHJhbnNhY3Rpb25Ob2RlID0gdGhpcy5nZXRBbmNlc3RvclRyYW5zYWN0aW9uTm9kZV8oY2hhbmdlZFBhdGgpO1xuICAgIHZhciBwYXRoID0gcm9vdE1vc3RUcmFuc2FjdGlvbk5vZGUucGF0aCgpO1xuICAgIHZhciBxdWV1ZSA9IHRoaXMuYnVpbGRUcmFuc2FjdGlvblF1ZXVlXyhyb290TW9zdFRyYW5zYWN0aW9uTm9kZSk7XG4gICAgdGhpcy5yZXJ1blRyYW5zYWN0aW9uUXVldWVfKHF1ZXVlLCBwYXRoKTtcbiAgICByZXR1cm4gcGF0aDtcbn07XG4vKipcbiAqIERvZXMgYWxsIHRoZSB3b3JrIG9mIHJlcnVubmluZyB0cmFuc2FjdGlvbnMgKGFzIHdlbGwgYXMgY2xlYW5zIHVwIGFib3J0ZWQgdHJhbnNhY3Rpb25zIGFuZCB3aGF0bm90KS5cbiAqXG4gKiBAcGFyYW0ge0FycmF5LjxUcmFuc2FjdGlvbj59IHF1ZXVlIFRoZSBxdWV1ZSBvZiB0cmFuc2FjdGlvbnMgdG8gcnVuLlxuICogQHBhcmFtIHshUGF0aH0gcGF0aCBUaGUgcGF0aCB0aGUgcXVldWUgaXMgZm9yLlxuICogQHByaXZhdGVcbiAqL1xuUmVwb18xLlJlcG8ucHJvdG90eXBlLnJlcnVuVHJhbnNhY3Rpb25RdWV1ZV8gPSBmdW5jdGlvbiAocXVldWUsIHBhdGgpIHtcbiAgICBpZiAocXVldWUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybjsgLy8gTm90aGluZyB0byBkbyFcbiAgICB9XG4gICAgLy8gUXVldWUgdXAgdGhlIGNhbGxiYWNrcyBhbmQgZmlyZSB0aGVtIGFmdGVyIGNsZWFuaW5nIHVwIGFsbCBvZiBvdXIgdHJhbnNhY3Rpb24gc3RhdGUsIHNpbmNlXG4gICAgLy8gdGhlIGNhbGxiYWNrIGNvdWxkIHRyaWdnZXIgbW9yZSB0cmFuc2FjdGlvbnMgb3Igc2V0cy5cbiAgICB2YXIgY2FsbGJhY2tzID0gW107XG4gICAgdmFyIGV2ZW50cyA9IFtdO1xuICAgIC8vIElnbm9yZSBhbGwgb2YgdGhlIHNldHMgd2UncmUgZ29pbmcgdG8gcmUtcnVuLlxuICAgIHZhciB0eG5zVG9SZXJ1biA9IHF1ZXVlLmZpbHRlcihmdW5jdGlvbiAocSkge1xuICAgICAgICByZXR1cm4gcS5zdGF0dXMgPT09IFRyYW5zYWN0aW9uU3RhdHVzLlJVTjtcbiAgICB9KTtcbiAgICB2YXIgc2V0c1RvSWdub3JlID0gdHhuc1RvUmVydW4ubWFwKGZ1bmN0aW9uIChxKSB7XG4gICAgICAgIHJldHVybiBxLmN1cnJlbnRXcml0ZUlkO1xuICAgIH0pO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcXVldWUubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIHRyYW5zYWN0aW9uID0gcXVldWVbaV07XG4gICAgICAgIHZhciByZWxhdGl2ZVBhdGggPSBQYXRoXzEuUGF0aC5yZWxhdGl2ZVBhdGgocGF0aCwgdHJhbnNhY3Rpb24ucGF0aCk7XG4gICAgICAgIHZhciBhYm9ydFRyYW5zYWN0aW9uID0gZmFsc2UsIGFib3J0UmVhc29uID0gdm9pZCAwO1xuICAgICAgICB1dGlsXzEuYXNzZXJ0KHJlbGF0aXZlUGF0aCAhPT0gbnVsbCwgJ3JlcnVuVHJhbnNhY3Rpb25zVW5kZXJOb2RlXzogcmVsYXRpdmVQYXRoIHNob3VsZCBub3QgYmUgbnVsbC4nKTtcbiAgICAgICAgaWYgKHRyYW5zYWN0aW9uLnN0YXR1cyA9PT0gVHJhbnNhY3Rpb25TdGF0dXMuTkVFRFNfQUJPUlQpIHtcbiAgICAgICAgICAgIGFib3J0VHJhbnNhY3Rpb24gPSB0cnVlO1xuICAgICAgICAgICAgYWJvcnRSZWFzb24gPSB0cmFuc2FjdGlvbi5hYm9ydFJlYXNvbjtcbiAgICAgICAgICAgIGV2ZW50cyA9IGV2ZW50cy5jb25jYXQodGhpcy5zZXJ2ZXJTeW5jVHJlZV8uYWNrVXNlcldyaXRlKHRyYW5zYWN0aW9uLmN1cnJlbnRXcml0ZUlkLCB0cnVlKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodHJhbnNhY3Rpb24uc3RhdHVzID09PSBUcmFuc2FjdGlvblN0YXR1cy5SVU4pIHtcbiAgICAgICAgICAgIGlmICh0cmFuc2FjdGlvbi5yZXRyeUNvdW50ID49IFJlcG9fMS5SZXBvLk1BWF9UUkFOU0FDVElPTl9SRVRSSUVTXykge1xuICAgICAgICAgICAgICAgIGFib3J0VHJhbnNhY3Rpb24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIGFib3J0UmVhc29uID0gJ21heHJldHJ5JztcbiAgICAgICAgICAgICAgICBldmVudHMgPSBldmVudHMuY29uY2F0KHRoaXMuc2VydmVyU3luY1RyZWVfLmFja1VzZXJXcml0ZSh0cmFuc2FjdGlvbi5jdXJyZW50V3JpdGVJZCwgdHJ1ZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gVGhpcyBjb2RlIHJlcnVucyBhIHRyYW5zYWN0aW9uXG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnROb2RlID0gdGhpcy5nZXRMYXRlc3RTdGF0ZV8odHJhbnNhY3Rpb24ucGF0aCwgc2V0c1RvSWdub3JlKTtcbiAgICAgICAgICAgICAgICB0cmFuc2FjdGlvbi5jdXJyZW50SW5wdXRTbmFwc2hvdCA9IGN1cnJlbnROb2RlO1xuICAgICAgICAgICAgICAgIHZhciBuZXdEYXRhID0gcXVldWVbaV0udXBkYXRlKGN1cnJlbnROb2RlLnZhbCgpKTtcbiAgICAgICAgICAgICAgICBpZiAobmV3RGF0YSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbGlkYXRpb25fMS52YWxpZGF0ZUZpcmViYXNlRGF0YSgndHJhbnNhY3Rpb24gZmFpbGVkOiBEYXRhIHJldHVybmVkICcsIG5ld0RhdGEsIHRyYW5zYWN0aW9uLnBhdGgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3RGF0YU5vZGUgPSBub2RlRnJvbUpTT05fMS5ub2RlRnJvbUpTT04obmV3RGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBoYXNFeHBsaWNpdFByaW9yaXR5ID0gdHlwZW9mIG5ld0RhdGEgPT09ICdvYmplY3QnICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdEYXRhICE9IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIHV0aWxfMy5jb250YWlucyhuZXdEYXRhLCAnLnByaW9yaXR5Jyk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaGFzRXhwbGljaXRQcmlvcml0eSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gS2VlcCB0aGUgb2xkIHByaW9yaXR5IGlmIHRoZXJlIHdhc24ndCBhIHByaW9yaXR5IGV4cGxpY2l0bHkgc3BlY2lmaWVkLlxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3RGF0YU5vZGUgPSBuZXdEYXRhTm9kZS51cGRhdGVQcmlvcml0eShjdXJyZW50Tm9kZS5nZXRQcmlvcml0eSgpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgb2xkV3JpdGVJZCA9IHRyYW5zYWN0aW9uLmN1cnJlbnRXcml0ZUlkO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2VydmVyVmFsdWVzID0gdGhpcy5nZW5lcmF0ZVNlcnZlclZhbHVlcygpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3Tm9kZVJlc29sdmVkID0gU2VydmVyVmFsdWVzXzEucmVzb2x2ZURlZmVycmVkVmFsdWVTbmFwc2hvdChuZXdEYXRhTm9kZSwgc2VydmVyVmFsdWVzKTtcbiAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb24uY3VycmVudE91dHB1dFNuYXBzaG90UmF3ID0gbmV3RGF0YU5vZGU7XG4gICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uLmN1cnJlbnRPdXRwdXRTbmFwc2hvdFJlc29sdmVkID0gbmV3Tm9kZVJlc29sdmVkO1xuICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvbi5jdXJyZW50V3JpdGVJZCA9IHRoaXMuZ2V0TmV4dFdyaXRlSWRfKCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIE11dGF0ZXMgc2V0c1RvSWdub3JlIGluIHBsYWNlXG4gICAgICAgICAgICAgICAgICAgIHNldHNUb0lnbm9yZS5zcGxpY2Uoc2V0c1RvSWdub3JlLmluZGV4T2Yob2xkV3JpdGVJZCksIDEpO1xuICAgICAgICAgICAgICAgICAgICBldmVudHMgPSBldmVudHMuY29uY2F0KHRoaXMuc2VydmVyU3luY1RyZWVfLmFwcGx5VXNlck92ZXJ3cml0ZSh0cmFuc2FjdGlvbi5wYXRoLCBuZXdOb2RlUmVzb2x2ZWQsIHRyYW5zYWN0aW9uLmN1cnJlbnRXcml0ZUlkLCB0cmFuc2FjdGlvbi5hcHBseUxvY2FsbHkpKTtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnRzID0gZXZlbnRzLmNvbmNhdCh0aGlzLnNlcnZlclN5bmNUcmVlXy5hY2tVc2VyV3JpdGUob2xkV3JpdGVJZCwgdHJ1ZSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYWJvcnRUcmFuc2FjdGlvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGFib3J0UmVhc29uID0gJ25vZGF0YSc7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50cyA9IGV2ZW50cy5jb25jYXQodGhpcy5zZXJ2ZXJTeW5jVHJlZV8uYWNrVXNlcldyaXRlKHRyYW5zYWN0aW9uLmN1cnJlbnRXcml0ZUlkLCB0cnVlKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuZXZlbnRRdWV1ZV8ucmFpc2VFdmVudHNGb3JDaGFuZ2VkUGF0aChwYXRoLCBldmVudHMpO1xuICAgICAgICBldmVudHMgPSBbXTtcbiAgICAgICAgaWYgKGFib3J0VHJhbnNhY3Rpb24pIHtcbiAgICAgICAgICAgIC8vIEFib3J0LlxuICAgICAgICAgICAgcXVldWVbaV0uc3RhdHVzID0gVHJhbnNhY3Rpb25TdGF0dXMuQ09NUExFVEVEO1xuICAgICAgICAgICAgLy8gUmVtb3ZpbmcgYSBsaXN0ZW5lciBjYW4gdHJpZ2dlciBwcnVuaW5nIHdoaWNoIGNhbiBtdWNrIHdpdGggbWVyZ2VkRGF0YS92aXNpYmxlRGF0YSAoYXMgaXQgcHJ1bmVzIGRhdGEpLlxuICAgICAgICAgICAgLy8gU28gZGVmZXIgdGhlIHVud2F0Y2hlciB1bnRpbCB3ZSdyZSBkb25lLlxuICAgICAgICAgICAgKGZ1bmN0aW9uICh1bndhdGNoZXIpIHtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KHVud2F0Y2hlciwgTWF0aC5mbG9vcigwKSk7XG4gICAgICAgICAgICB9KShxdWV1ZVtpXS51bndhdGNoZXIpO1xuICAgICAgICAgICAgaWYgKHF1ZXVlW2ldLm9uQ29tcGxldGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoYWJvcnRSZWFzb24gPT09ICdub2RhdGEnKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZWYgPSBuZXcgUmVmZXJlbmNlXzEuUmVmZXJlbmNlKHRoaXMsIHF1ZXVlW2ldLnBhdGgpO1xuICAgICAgICAgICAgICAgICAgICAvLyBXZSBzZXQgdGhpcyBmaWVsZCBpbW1lZGlhdGVseSwgc28gaXQncyBzYWZlIHRvIGNhc3QgdG8gYW4gYWN0dWFsIHNuYXBzaG90XG4gICAgICAgICAgICAgICAgICAgIHZhciBsYXN0SW5wdXQgLyoqIEB0eXBlIHshTm9kZX0gKi8gPSBxdWV1ZVtpXS5jdXJyZW50SW5wdXRTbmFwc2hvdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNuYXBzaG90ID0gbmV3IERhdGFTbmFwc2hvdF8xLkRhdGFTbmFwc2hvdChsYXN0SW5wdXQsIHJlZiwgUHJpb3JpdHlJbmRleF8xLlBSSU9SSVRZX0lOREVYKTtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2tzLnB1c2gocXVldWVbaV0ub25Db21wbGV0ZS5iaW5kKG51bGwsIG51bGwsIGZhbHNlLCBzbmFwc2hvdCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2tzLnB1c2gocXVldWVbaV0ub25Db21wbGV0ZS5iaW5kKG51bGwsIG5ldyBFcnJvcihhYm9ydFJlYXNvbiksIGZhbHNlLCBudWxsKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8vIENsZWFuIHVwIGNvbXBsZXRlZCB0cmFuc2FjdGlvbnMuXG4gICAgdGhpcy5wcnVuZUNvbXBsZXRlZFRyYW5zYWN0aW9uc0JlbG93Tm9kZV8odGhpcy50cmFuc2FjdGlvblF1ZXVlVHJlZV8pO1xuICAgIC8vIE5vdyBmaXJlIGNhbGxiYWNrcywgbm93IHRoYXQgd2UncmUgaW4gYSBnb29kLCBrbm93biBzdGF0ZS5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNhbGxiYWNrcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB1dGlsXzIuZXhjZXB0aW9uR3VhcmQoY2FsbGJhY2tzW2ldKTtcbiAgICB9XG4gICAgLy8gVHJ5IHRvIHNlbmQgdGhlIHRyYW5zYWN0aW9uIHJlc3VsdCB0byB0aGUgc2VydmVyLlxuICAgIHRoaXMuc2VuZFJlYWR5VHJhbnNhY3Rpb25zXygpO1xufTtcbi8qKlxuICogUmV0dXJucyB0aGUgcm9vdG1vc3QgYW5jZXN0b3Igbm9kZSBvZiB0aGUgc3BlY2lmaWVkIHBhdGggdGhhdCBoYXMgYSBwZW5kaW5nIHRyYW5zYWN0aW9uIG9uIGl0LCBvciBqdXN0IHJldHVybnNcbiAqIHRoZSBub2RlIGZvciB0aGUgZ2l2ZW4gcGF0aCBpZiB0aGVyZSBhcmUgbm8gcGVuZGluZyB0cmFuc2FjdGlvbnMgb24gYW55IGFuY2VzdG9yLlxuICpcbiAqIEBwYXJhbSB7IVBhdGh9IHBhdGggVGhlIGxvY2F0aW9uIHRvIHN0YXJ0IGF0LlxuICogQHJldHVybiB7IVRyZWUuPEFycmF5LjwhVHJhbnNhY3Rpb24+Pn0gVGhlIHJvb3Rtb3N0IG5vZGUgd2l0aCBhIHRyYW5zYWN0aW9uLlxuICogQHByaXZhdGVcbiAqL1xuUmVwb18xLlJlcG8ucHJvdG90eXBlLmdldEFuY2VzdG9yVHJhbnNhY3Rpb25Ob2RlXyA9IGZ1bmN0aW9uIChwYXRoKSB7XG4gICAgdmFyIGZyb250O1xuICAgIC8vIFN0YXJ0IGF0IHRoZSByb290IGFuZCB3YWxrIGRlZXBlciBpbnRvIHRoZSB0cmVlIHRvd2FyZHMgcGF0aCB1bnRpbCB3ZSBmaW5kIGEgbm9kZSB3aXRoIHBlbmRpbmcgdHJhbnNhY3Rpb25zLlxuICAgIHZhciB0cmFuc2FjdGlvbk5vZGUgPSB0aGlzLnRyYW5zYWN0aW9uUXVldWVUcmVlXztcbiAgICB3aGlsZSAoKGZyb250ID0gcGF0aC5nZXRGcm9udCgpKSAhPT0gbnVsbCAmJlxuICAgICAgICB0cmFuc2FjdGlvbk5vZGUuZ2V0VmFsdWUoKSA9PT0gbnVsbCkge1xuICAgICAgICB0cmFuc2FjdGlvbk5vZGUgPSB0cmFuc2FjdGlvbk5vZGUuc3ViVHJlZShmcm9udCk7XG4gICAgICAgIHBhdGggPSBwYXRoLnBvcEZyb250KCk7XG4gICAgfVxuICAgIHJldHVybiB0cmFuc2FjdGlvbk5vZGU7XG59O1xuLyoqXG4gKiBCdWlsZHMgdGhlIHF1ZXVlIG9mIGFsbCB0cmFuc2FjdGlvbnMgYXQgb3IgYmVsb3cgdGhlIHNwZWNpZmllZCB0cmFuc2FjdGlvbk5vZGUuXG4gKlxuICogQHBhcmFtIHshVHJlZS48QXJyYXkuPFRyYW5zYWN0aW9uPj59IHRyYW5zYWN0aW9uTm9kZVxuICogQHJldHVybiB7QXJyYXkuPFRyYW5zYWN0aW9uPn0gVGhlIGdlbmVyYXRlZCBxdWV1ZS5cbiAqIEBwcml2YXRlXG4gKi9cblJlcG9fMS5SZXBvLnByb3RvdHlwZS5idWlsZFRyYW5zYWN0aW9uUXVldWVfID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uTm9kZSkge1xuICAgIC8vIFdhbGsgYW55IGNoaWxkIHRyYW5zYWN0aW9uIHF1ZXVlcyBhbmQgYWdncmVnYXRlIHRoZW0gaW50byBhIHNpbmdsZSBxdWV1ZS5cbiAgICB2YXIgdHJhbnNhY3Rpb25RdWV1ZSA9IFtdO1xuICAgIHRoaXMuYWdncmVnYXRlVHJhbnNhY3Rpb25RdWV1ZXNGb3JOb2RlXyh0cmFuc2FjdGlvbk5vZGUsIHRyYW5zYWN0aW9uUXVldWUpO1xuICAgIC8vIFNvcnQgdGhlbSBieSB0aGUgb3JkZXIgdGhlIHRyYW5zYWN0aW9ucyB3ZXJlIGNyZWF0ZWQuXG4gICAgdHJhbnNhY3Rpb25RdWV1ZS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgIHJldHVybiBhLm9yZGVyIC0gYi5vcmRlcjtcbiAgICB9KTtcbiAgICByZXR1cm4gdHJhbnNhY3Rpb25RdWV1ZTtcbn07XG4vKipcbiAqIEBwYXJhbSB7IVRyZWUuPEFycmF5LjxUcmFuc2FjdGlvbj4+fSBub2RlXG4gKiBAcGFyYW0ge0FycmF5LjxUcmFuc2FjdGlvbj59IHF1ZXVlXG4gKiBAcHJpdmF0ZVxuICovXG5SZXBvXzEuUmVwby5wcm90b3R5cGUuYWdncmVnYXRlVHJhbnNhY3Rpb25RdWV1ZXNGb3JOb2RlXyA9IGZ1bmN0aW9uIChub2RlLCBxdWV1ZSkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgdmFyIG5vZGVRdWV1ZSA9IG5vZGUuZ2V0VmFsdWUoKTtcbiAgICBpZiAobm9kZVF1ZXVlICE9PSBudWxsKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZVF1ZXVlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBxdWV1ZS5wdXNoKG5vZGVRdWV1ZVtpXSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgbm9kZS5mb3JFYWNoQ2hpbGQoZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgIF90aGlzLmFnZ3JlZ2F0ZVRyYW5zYWN0aW9uUXVldWVzRm9yTm9kZV8oY2hpbGQsIHF1ZXVlKTtcbiAgICB9KTtcbn07XG4vKipcbiAqIFJlbW92ZSBDT01QTEVURUQgdHJhbnNhY3Rpb25zIGF0IG9yIGJlbG93IHRoaXMgbm9kZSBpbiB0aGUgdHJhbnNhY3Rpb25RdWV1ZVRyZWVfLlxuICpcbiAqIEBwYXJhbSB7IVRyZWUuPEFycmF5LjwhVHJhbnNhY3Rpb24+Pn0gbm9kZVxuICogQHByaXZhdGVcbiAqL1xuUmVwb18xLlJlcG8ucHJvdG90eXBlLnBydW5lQ29tcGxldGVkVHJhbnNhY3Rpb25zQmVsb3dOb2RlXyA9IGZ1bmN0aW9uIChub2RlKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcbiAgICB2YXIgcXVldWUgPSBub2RlLmdldFZhbHVlKCk7XG4gICAgaWYgKHF1ZXVlKSB7XG4gICAgICAgIHZhciB0byA9IDA7XG4gICAgICAgIGZvciAodmFyIGZyb20gPSAwOyBmcm9tIDwgcXVldWUubGVuZ3RoOyBmcm9tKyspIHtcbiAgICAgICAgICAgIGlmIChxdWV1ZVtmcm9tXS5zdGF0dXMgIT09IFRyYW5zYWN0aW9uU3RhdHVzLkNPTVBMRVRFRCkge1xuICAgICAgICAgICAgICAgIHF1ZXVlW3RvXSA9IHF1ZXVlW2Zyb21dO1xuICAgICAgICAgICAgICAgIHRvKys7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcXVldWUubGVuZ3RoID0gdG87XG4gICAgICAgIG5vZGUuc2V0VmFsdWUocXVldWUubGVuZ3RoID4gMCA/IHF1ZXVlIDogbnVsbCk7XG4gICAgfVxuICAgIG5vZGUuZm9yRWFjaENoaWxkKGZ1bmN0aW9uIChjaGlsZE5vZGUpIHtcbiAgICAgICAgX3RoaXMucHJ1bmVDb21wbGV0ZWRUcmFuc2FjdGlvbnNCZWxvd05vZGVfKGNoaWxkTm9kZSk7XG4gICAgfSk7XG59O1xuLyoqXG4gKiBBYm9ydHMgYWxsIHRyYW5zYWN0aW9ucyBvbiBhbmNlc3RvcnMgb3IgZGVzY2VuZGFudHMgb2YgdGhlIHNwZWNpZmllZCBwYXRoLiAgQ2FsbGVkIHdoZW4gZG9pbmcgYSBzZXQoKSBvciB1cGRhdGUoKVxuICogc2luY2Ugd2UgY29uc2lkZXIgdGhlbSBpbmNvbXBhdGlibGUgd2l0aCB0cmFuc2FjdGlvbnMuXG4gKlxuICogQHBhcmFtIHshUGF0aH0gcGF0aCBQYXRoIGZvciB3aGljaCB3ZSB3YW50IHRvIGFib3J0IHJlbGF0ZWQgdHJhbnNhY3Rpb25zLlxuICogQHJldHVybiB7IVBhdGh9XG4gKiBAcHJpdmF0ZVxuICovXG5SZXBvXzEuUmVwby5wcm90b3R5cGUuYWJvcnRUcmFuc2FjdGlvbnNfID0gZnVuY3Rpb24gKHBhdGgpIHtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgIHZhciBhZmZlY3RlZFBhdGggPSB0aGlzLmdldEFuY2VzdG9yVHJhbnNhY3Rpb25Ob2RlXyhwYXRoKS5wYXRoKCk7XG4gICAgdmFyIHRyYW5zYWN0aW9uTm9kZSA9IHRoaXMudHJhbnNhY3Rpb25RdWV1ZVRyZWVfLnN1YlRyZWUocGF0aCk7XG4gICAgdHJhbnNhY3Rpb25Ob2RlLmZvckVhY2hBbmNlc3RvcihmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICBfdGhpcy5hYm9ydFRyYW5zYWN0aW9uc09uTm9kZV8obm9kZSk7XG4gICAgfSk7XG4gICAgdGhpcy5hYm9ydFRyYW5zYWN0aW9uc09uTm9kZV8odHJhbnNhY3Rpb25Ob2RlKTtcbiAgICB0cmFuc2FjdGlvbk5vZGUuZm9yRWFjaERlc2NlbmRhbnQoZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgX3RoaXMuYWJvcnRUcmFuc2FjdGlvbnNPbk5vZGVfKG5vZGUpO1xuICAgIH0pO1xuICAgIHJldHVybiBhZmZlY3RlZFBhdGg7XG59O1xuLyoqXG4gKiBBYm9ydCB0cmFuc2FjdGlvbnMgc3RvcmVkIGluIHRoaXMgdHJhbnNhY3Rpb24gcXVldWUgbm9kZS5cbiAqXG4gKiBAcGFyYW0geyFUcmVlLjxBcnJheS48VHJhbnNhY3Rpb24+Pn0gbm9kZSBOb2RlIHRvIGFib3J0IHRyYW5zYWN0aW9ucyBmb3IuXG4gKiBAcHJpdmF0ZVxuICovXG5SZXBvXzEuUmVwby5wcm90b3R5cGUuYWJvcnRUcmFuc2FjdGlvbnNPbk5vZGVfID0gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICB2YXIgcXVldWUgPSBub2RlLmdldFZhbHVlKCk7XG4gICAgaWYgKHF1ZXVlICE9PSBudWxsKSB7XG4gICAgICAgIC8vIFF1ZXVlIHVwIHRoZSBjYWxsYmFja3MgYW5kIGZpcmUgdGhlbSBhZnRlciBjbGVhbmluZyB1cCBhbGwgb2Ygb3VyIHRyYW5zYWN0aW9uIHN0YXRlLCBzaW5jZVxuICAgICAgICAvLyB0aGUgY2FsbGJhY2sgY291bGQgdHJpZ2dlciBtb3JlIHRyYW5zYWN0aW9ucyBvciBzZXRzLlxuICAgICAgICB2YXIgY2FsbGJhY2tzID0gW107XG4gICAgICAgIC8vIEdvIHRocm91Z2ggcXVldWUuICBBbnkgYWxyZWFkeS1zZW50IHRyYW5zYWN0aW9ucyBtdXN0IGJlIG1hcmtlZCBmb3IgYWJvcnQsIHdoaWxlIHRoZSB1bnNlbnQgb25lc1xuICAgICAgICAvLyBjYW4gYmUgaW1tZWRpYXRlbHkgYWJvcnRlZCBhbmQgcmVtb3ZlZC5cbiAgICAgICAgdmFyIGV2ZW50cyA9IFtdO1xuICAgICAgICB2YXIgbGFzdFNlbnQgPSAtMTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBxdWV1ZS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHF1ZXVlW2ldLnN0YXR1cyA9PT0gVHJhbnNhY3Rpb25TdGF0dXMuU0VOVF9ORUVEU19BQk9SVCkge1xuICAgICAgICAgICAgICAgIC8vIEFscmVhZHkgbWFya2VkLiAgTm8gYWN0aW9uIG5lZWRlZC5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHF1ZXVlW2ldLnN0YXR1cyA9PT0gVHJhbnNhY3Rpb25TdGF0dXMuU0VOVCkge1xuICAgICAgICAgICAgICAgIHV0aWxfMS5hc3NlcnQobGFzdFNlbnQgPT09IGkgLSAxLCAnQWxsIFNFTlQgaXRlbXMgc2hvdWxkIGJlIGF0IGJlZ2lubmluZyBvZiBxdWV1ZS4nKTtcbiAgICAgICAgICAgICAgICBsYXN0U2VudCA9IGk7XG4gICAgICAgICAgICAgICAgLy8gTWFyayB0cmFuc2FjdGlvbiBmb3IgYWJvcnQgd2hlbiBpdCBjb21lcyBiYWNrLlxuICAgICAgICAgICAgICAgIHF1ZXVlW2ldLnN0YXR1cyA9IFRyYW5zYWN0aW9uU3RhdHVzLlNFTlRfTkVFRFNfQUJPUlQ7XG4gICAgICAgICAgICAgICAgcXVldWVbaV0uYWJvcnRSZWFzb24gPSAnc2V0JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHV0aWxfMS5hc3NlcnQocXVldWVbaV0uc3RhdHVzID09PSBUcmFuc2FjdGlvblN0YXR1cy5SVU4sICdVbmV4cGVjdGVkIHRyYW5zYWN0aW9uIHN0YXR1cyBpbiBhYm9ydCcpO1xuICAgICAgICAgICAgICAgIC8vIFdlIGNhbiBhYm9ydCBpdCBpbW1lZGlhdGVseS5cbiAgICAgICAgICAgICAgICBxdWV1ZVtpXS51bndhdGNoZXIoKTtcbiAgICAgICAgICAgICAgICBldmVudHMgPSBldmVudHMuY29uY2F0KHRoaXMuc2VydmVyU3luY1RyZWVfLmFja1VzZXJXcml0ZShxdWV1ZVtpXS5jdXJyZW50V3JpdGVJZCwgdHJ1ZSkpO1xuICAgICAgICAgICAgICAgIGlmIChxdWV1ZVtpXS5vbkNvbXBsZXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzbmFwc2hvdCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrcy5wdXNoKHF1ZXVlW2ldLm9uQ29tcGxldGUuYmluZChudWxsLCBuZXcgRXJyb3IoJ3NldCcpLCBmYWxzZSwgc25hcHNob3QpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxhc3RTZW50ID09PSAtMSkge1xuICAgICAgICAgICAgLy8gV2UncmUgbm90IHdhaXRpbmcgZm9yIGFueSBzZW50IHRyYW5zYWN0aW9ucy4gIFdlIGNhbiBjbGVhciB0aGUgcXVldWUuXG4gICAgICAgICAgICBub2RlLnNldFZhbHVlKG51bGwpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSB0cmFuc2FjdGlvbnMgd2UgYWJvcnRlZC5cbiAgICAgICAgICAgIHF1ZXVlLmxlbmd0aCA9IGxhc3RTZW50ICsgMTtcbiAgICAgICAgfVxuICAgICAgICAvLyBOb3cgZmlyZSB0aGUgY2FsbGJhY2tzLlxuICAgICAgICB0aGlzLmV2ZW50UXVldWVfLnJhaXNlRXZlbnRzRm9yQ2hhbmdlZFBhdGgobm9kZS5wYXRoKCksIGV2ZW50cyk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2FsbGJhY2tzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB1dGlsXzIuZXhjZXB0aW9uR3VhcmQoY2FsbGJhY2tzW2ldKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVJlcG9fdHJhbnNhY3Rpb24uanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG4vKipcbiAqIEludGVyZmFjZSBkZWZpbmluZyB0aGUgc2V0IG9mIGFjdGlvbnMgdGhhdCBjYW4gYmUgcGVyZm9ybWVkIGFnYWluc3QgdGhlIEZpcmViYXNlIHNlcnZlclxuICogKGJhc2ljYWxseSBjb3JyZXNwb25kcyB0byBvdXIgd2lyZSBwcm90b2NvbCkuXG4gKlxuICogQGludGVyZmFjZVxuICovXG52YXIgU2VydmVyQWN0aW9ucyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBTZXJ2ZXJBY3Rpb25zKCkge1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcGF0aFN0cmluZ1xuICAgICAqIEBwYXJhbSB7Kn0gZGF0YVxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oc3RyaW5nLCBzdHJpbmcpPX0gb25Db21wbGV0ZVxuICAgICAqIEBwYXJhbSB7c3RyaW5nPX0gaGFzaFxuICAgICAqL1xuICAgIFNlcnZlckFjdGlvbnMucHJvdG90eXBlLnB1dCA9IGZ1bmN0aW9uIChwYXRoU3RyaW5nLCBkYXRhLCBvbkNvbXBsZXRlLCBoYXNoKSB7IH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHBhdGhTdHJpbmdcbiAgICAgKiBAcGFyYW0geyp9IGRhdGFcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKHN0cmluZywgP3N0cmluZyl9IG9uQ29tcGxldGVcbiAgICAgKiBAcGFyYW0ge3N0cmluZz19IGhhc2hcbiAgICAgKi9cbiAgICBTZXJ2ZXJBY3Rpb25zLnByb3RvdHlwZS5tZXJnZSA9IGZ1bmN0aW9uIChwYXRoU3RyaW5nLCBkYXRhLCBvbkNvbXBsZXRlLCBoYXNoKSB7IH07XG4gICAgLyoqXG4gICAgICogUmVmcmVzaGVzIHRoZSBhdXRoIHRva2VuIGZvciB0aGUgY3VycmVudCBjb25uZWN0aW9uLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0b2tlbiBUaGUgYXV0aGVudGljYXRpb24gdG9rZW5cbiAgICAgKi9cbiAgICBTZXJ2ZXJBY3Rpb25zLnByb3RvdHlwZS5yZWZyZXNoQXV0aFRva2VuID0gZnVuY3Rpb24gKHRva2VuKSB7IH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHBhdGhTdHJpbmdcbiAgICAgKiBAcGFyYW0geyp9IGRhdGFcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKHN0cmluZywgc3RyaW5nKT19IG9uQ29tcGxldGVcbiAgICAgKi9cbiAgICBTZXJ2ZXJBY3Rpb25zLnByb3RvdHlwZS5vbkRpc2Nvbm5lY3RQdXQgPSBmdW5jdGlvbiAocGF0aFN0cmluZywgZGF0YSwgb25Db21wbGV0ZSkgeyB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoU3RyaW5nXG4gICAgICogQHBhcmFtIHsqfSBkYXRhXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbihzdHJpbmcsIHN0cmluZyk9fSBvbkNvbXBsZXRlXG4gICAgICovXG4gICAgU2VydmVyQWN0aW9ucy5wcm90b3R5cGUub25EaXNjb25uZWN0TWVyZ2UgPSBmdW5jdGlvbiAocGF0aFN0cmluZywgZGF0YSwgb25Db21wbGV0ZSkgeyB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoU3RyaW5nXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbihzdHJpbmcsIHN0cmluZyk9fSBvbkNvbXBsZXRlXG4gICAgICovXG4gICAgU2VydmVyQWN0aW9ucy5wcm90b3R5cGUub25EaXNjb25uZWN0Q2FuY2VsID0gZnVuY3Rpb24gKHBhdGhTdHJpbmcsIG9uQ29tcGxldGUpIHsgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdC48c3RyaW5nLCAqPn0gc3RhdHNcbiAgICAgKi9cbiAgICBTZXJ2ZXJBY3Rpb25zLnByb3RvdHlwZS5yZXBvcnRTdGF0cyA9IGZ1bmN0aW9uIChzdGF0cykgeyB9O1xuICAgIHJldHVybiBTZXJ2ZXJBY3Rpb25zO1xufSgpKTtcbmV4cG9ydHMuU2VydmVyQWN0aW9ucyA9IFNlcnZlckFjdGlvbnM7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNlcnZlckFjdGlvbnMuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgQ2hpbGRyZW5Ob2RlXzEgPSByZXF1aXJlKFwiLi9zbmFwL0NoaWxkcmVuTm9kZVwiKTtcbi8qKlxuICogTXV0YWJsZSBvYmplY3Qgd2hpY2ggYmFzaWNhbGx5IGp1c3Qgc3RvcmVzIGEgcmVmZXJlbmNlIHRvIHRoZSBcImxhdGVzdFwiIGltbXV0YWJsZSBzbmFwc2hvdC5cbiAqXG4gKiBAY29uc3RydWN0b3JcbiAqL1xudmFyIFNuYXBzaG90SG9sZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFNuYXBzaG90SG9sZGVyKCkge1xuICAgICAgICB0aGlzLnJvb3ROb2RlXyA9IENoaWxkcmVuTm9kZV8xLkNoaWxkcmVuTm9kZS5FTVBUWV9OT0RFO1xuICAgIH1cbiAgICBTbmFwc2hvdEhvbGRlci5wcm90b3R5cGUuZ2V0Tm9kZSA9IGZ1bmN0aW9uIChwYXRoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJvb3ROb2RlXy5nZXRDaGlsZChwYXRoKTtcbiAgICB9O1xuICAgIFNuYXBzaG90SG9sZGVyLnByb3RvdHlwZS51cGRhdGVTbmFwc2hvdCA9IGZ1bmN0aW9uIChwYXRoLCBuZXdTbmFwc2hvdE5vZGUpIHtcbiAgICAgICAgdGhpcy5yb290Tm9kZV8gPSB0aGlzLnJvb3ROb2RlXy51cGRhdGVDaGlsZChwYXRoLCBuZXdTbmFwc2hvdE5vZGUpO1xuICAgIH07XG4gICAgcmV0dXJuIFNuYXBzaG90SG9sZGVyO1xufSgpKTtcbmV4cG9ydHMuU25hcHNob3RIb2xkZXIgPSBTbmFwc2hvdEhvbGRlcjtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U25hcHNob3RIb2xkZXIuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgUGF0aF8xID0gcmVxdWlyZShcIi4vdXRpbC9QYXRoXCIpO1xudmFyIFByaW9yaXR5SW5kZXhfMSA9IHJlcXVpcmUoXCIuL3NuYXAvaW5kZXhlcy9Qcmlvcml0eUluZGV4XCIpO1xudmFyIENvdW50ZWRTZXRfMSA9IHJlcXVpcmUoXCIuL3V0aWwvQ291bnRlZFNldFwiKTtcbi8qKlxuICogSGVscGVyIGNsYXNzIHRvIHN0b3JlIGEgc3BhcnNlIHNldCBvZiBzbmFwc2hvdHMuXG4gKlxuICogQGNvbnN0cnVjdG9yXG4gKi9cbnZhciBTcGFyc2VTbmFwc2hvdFRyZWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gU3BhcnNlU25hcHNob3RUcmVlKCkge1xuICAgICAgICAvKipcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQHR5cGUge05vZGV9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnZhbHVlXyA9IG51bGw7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAdHlwZSB7Q291bnRlZFNldH1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY2hpbGRyZW5fID0gbnVsbDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgbm9kZSBzdG9yZWQgYXQgdGhlIGdpdmVuIHBhdGggaWYgb25lIGV4aXN0cy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7IVBhdGh9IHBhdGggUGF0aCB0byBsb29rIHVwIHNuYXBzaG90IGZvci5cbiAgICAgKiBAcmV0dXJuIHs/Tm9kZX0gVGhlIHJldHJpZXZlZCBub2RlLCBvciBudWxsLlxuICAgICAqL1xuICAgIFNwYXJzZVNuYXBzaG90VHJlZS5wcm90b3R5cGUuZmluZCA9IGZ1bmN0aW9uIChwYXRoKSB7XG4gICAgICAgIGlmICh0aGlzLnZhbHVlXyAhPSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy52YWx1ZV8uZ2V0Q2hpbGQocGF0aCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIXBhdGguaXNFbXB0eSgpICYmIHRoaXMuY2hpbGRyZW5fICE9IG51bGwpIHtcbiAgICAgICAgICAgIHZhciBjaGlsZEtleSA9IHBhdGguZ2V0RnJvbnQoKTtcbiAgICAgICAgICAgIHBhdGggPSBwYXRoLnBvcEZyb250KCk7XG4gICAgICAgICAgICBpZiAodGhpcy5jaGlsZHJlbl8uY29udGFpbnMoY2hpbGRLZXkpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkVHJlZSA9IHRoaXMuY2hpbGRyZW5fLmdldChjaGlsZEtleSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNoaWxkVHJlZS5maW5kKHBhdGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogU3RvcmVzIHRoZSBnaXZlbiBub2RlIGF0IHRoZSBzcGVjaWZpZWQgcGF0aC4gSWYgdGhlcmUgaXMgYWxyZWFkeSBhIG5vZGVcbiAgICAgKiBhdCBhIHNoYWxsb3dlciBwYXRoLCBpdCBtZXJnZXMgdGhlIG5ldyBkYXRhIGludG8gdGhhdCBzbmFwc2hvdCBub2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHshUGF0aH0gcGF0aCBQYXRoIHRvIGxvb2sgdXAgc25hcHNob3QgZm9yLlxuICAgICAqIEBwYXJhbSB7IU5vZGV9IGRhdGEgVGhlIG5ldyBkYXRhLCBvciBudWxsLlxuICAgICAqL1xuICAgIFNwYXJzZVNuYXBzaG90VHJlZS5wcm90b3R5cGUucmVtZW1iZXIgPSBmdW5jdGlvbiAocGF0aCwgZGF0YSkge1xuICAgICAgICBpZiAocGF0aC5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgIHRoaXMudmFsdWVfID0gZGF0YTtcbiAgICAgICAgICAgIHRoaXMuY2hpbGRyZW5fID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLnZhbHVlXyAhPT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy52YWx1ZV8gPSB0aGlzLnZhbHVlXy51cGRhdGVDaGlsZChwYXRoLCBkYXRhKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmNoaWxkcmVuXyA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbl8gPSBuZXcgQ291bnRlZFNldF8xLkNvdW50ZWRTZXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjaGlsZEtleSA9IHBhdGguZ2V0RnJvbnQoKTtcbiAgICAgICAgICAgIGlmICghdGhpcy5jaGlsZHJlbl8uY29udGFpbnMoY2hpbGRLZXkpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbl8uYWRkKGNoaWxkS2V5LCBuZXcgU3BhcnNlU25hcHNob3RUcmVlKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGNoaWxkID0gdGhpcy5jaGlsZHJlbl8uZ2V0KGNoaWxkS2V5KTtcbiAgICAgICAgICAgIHBhdGggPSBwYXRoLnBvcEZyb250KCk7XG4gICAgICAgICAgICBjaGlsZC5yZW1lbWJlcihwYXRoLCBkYXRhKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogUHVyZ2UgdGhlIGRhdGEgYXQgcGF0aCBmcm9tIHRoZSBjYWNoZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7IVBhdGh9IHBhdGggUGF0aCB0byBsb29rIHVwIHNuYXBzaG90IGZvci5cbiAgICAgKiBAcmV0dXJuIHtib29sZWFufSBUcnVlIGlmIHRoaXMgbm9kZSBzaG91bGQgbm93IGJlIHJlbW92ZWQuXG4gICAgICovXG4gICAgU3BhcnNlU25hcHNob3RUcmVlLnByb3RvdHlwZS5mb3JnZXQgPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICBpZiAocGF0aC5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgIHRoaXMudmFsdWVfID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuY2hpbGRyZW5fID0gbnVsbDtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKHRoaXMudmFsdWVfICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudmFsdWVfLmlzTGVhZk5vZGUoKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBXZSdyZSB0cnlpbmcgdG8gZm9yZ2V0IGEgbm9kZSB0aGF0IGRvZXNuJ3QgZXhpc3RcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gdGhpcy52YWx1ZV87XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmFsdWVfID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGZfMSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlLmZvckVhY2hDaGlsZChQcmlvcml0eUluZGV4XzEuUFJJT1JJVFlfSU5ERVgsIGZ1bmN0aW9uIChrZXksIHRyZWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGZfMS5yZW1lbWJlcihuZXcgUGF0aF8xLlBhdGgoa2V5KSwgdHJlZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5mb3JnZXQocGF0aCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5jaGlsZHJlbl8gIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRLZXkgPSBwYXRoLmdldEZyb250KCk7XG4gICAgICAgICAgICAgICAgcGF0aCA9IHBhdGgucG9wRnJvbnQoKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jaGlsZHJlbl8uY29udGFpbnMoY2hpbGRLZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzYWZlVG9SZW1vdmUgPSB0aGlzLmNoaWxkcmVuXy5nZXQoY2hpbGRLZXkpLmZvcmdldChwYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNhZmVUb1JlbW92ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbl8ucmVtb3ZlKGNoaWxkS2V5KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jaGlsZHJlbl8uaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2hpbGRyZW5fID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJlY3Vyc2l2ZWx5IGl0ZXJhdGVzIHRocm91Z2ggYWxsIG9mIHRoZSBzdG9yZWQgdHJlZSBhbmQgY2FsbHMgdGhlXG4gICAgICogY2FsbGJhY2sgb24gZWFjaCBvbmUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyFQYXRofSBwcmVmaXhQYXRoIFBhdGggdG8gbG9vayB1cCBub2RlIGZvci5cbiAgICAgKiBAcGFyYW0geyFGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gaW52b2tlIGZvciBlYWNoIHRyZWUuXG4gICAgICovXG4gICAgU3BhcnNlU25hcHNob3RUcmVlLnByb3RvdHlwZS5mb3JFYWNoVHJlZSA9IGZ1bmN0aW9uIChwcmVmaXhQYXRoLCBmdW5jKSB7XG4gICAgICAgIGlmICh0aGlzLnZhbHVlXyAhPT0gbnVsbCkge1xuICAgICAgICAgICAgZnVuYyhwcmVmaXhQYXRoLCB0aGlzLnZhbHVlXyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmZvckVhY2hDaGlsZChmdW5jdGlvbiAoa2V5LCB0cmVlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhdGggPSBuZXcgUGF0aF8xLlBhdGgocHJlZml4UGF0aC50b1N0cmluZygpICsgJy8nICsga2V5KTtcbiAgICAgICAgICAgICAgICB0cmVlLmZvckVhY2hUcmVlKHBhdGgsIGZ1bmMpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEl0ZXJhdGVzIHRocm91Z2ggZWFjaCBpbW1lZGlhdGUgY2hpbGQgYW5kIHRyaWdnZXJzIHRoZSBjYWxsYmFjay5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7IUZ1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byBpbnZva2UgZm9yIGVhY2ggY2hpbGQuXG4gICAgICovXG4gICAgU3BhcnNlU25hcHNob3RUcmVlLnByb3RvdHlwZS5mb3JFYWNoQ2hpbGQgPSBmdW5jdGlvbiAoZnVuYykge1xuICAgICAgICBpZiAodGhpcy5jaGlsZHJlbl8gIT09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuY2hpbGRyZW5fLmVhY2goZnVuY3Rpb24gKGtleSwgdHJlZSkge1xuICAgICAgICAgICAgICAgIGZ1bmMoa2V5LCB0cmVlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gU3BhcnNlU25hcHNob3RUcmVlO1xufSgpKTtcbmV4cG9ydHMuU3BhcnNlU25hcHNob3RUcmVlID0gU3BhcnNlU25hcHNob3RUcmVlO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TcGFyc2VTbmFwc2hvdFRyZWUuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgQ2FjaGVOb2RlXzEgPSByZXF1aXJlKFwiLi92aWV3L0NhY2hlTm9kZVwiKTtcbnZhciBDaGlsZHJlbk5vZGVfMSA9IHJlcXVpcmUoXCIuL3NuYXAvQ2hpbGRyZW5Ob2RlXCIpO1xudmFyIHV0aWxfMSA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvdXRpbFwiKTtcbnZhciB1dGlsXzIgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG52YXIgVmlld0NhY2hlXzEgPSByZXF1aXJlKFwiLi92aWV3L1ZpZXdDYWNoZVwiKTtcbnZhciBWaWV3XzEgPSByZXF1aXJlKFwiLi92aWV3L1ZpZXdcIik7XG52YXIgX19yZWZlcmVuY2VDb25zdHJ1Y3Rvcjtcbi8qKlxuICogU3luY1BvaW50IHJlcHJlc2VudHMgYSBzaW5nbGUgbG9jYXRpb24gaW4gYSBTeW5jVHJlZSB3aXRoIDEgb3IgbW9yZSBldmVudCByZWdpc3RyYXRpb25zLCBtZWFuaW5nIHdlIG5lZWQgdG9cbiAqIG1haW50YWluIDEgb3IgbW9yZSBWaWV3cyBhdCB0aGlzIGxvY2F0aW9uIHRvIGNhY2hlIHNlcnZlciBkYXRhIGFuZCByYWlzZSBhcHByb3ByaWF0ZSBldmVudHMgZm9yIHNlcnZlciBjaGFuZ2VzXG4gKiBhbmQgdXNlciB3cml0ZXMgKHNldCwgdHJhbnNhY3Rpb24sIHVwZGF0ZSkuXG4gKlxuICogSXQncyByZXNwb25zaWJsZSBmb3I6XG4gKiAgLSBNYWludGFpbmluZyB0aGUgc2V0IG9mIDEgb3IgbW9yZSB2aWV3cyBuZWNlc3NhcnkgYXQgdGhpcyBsb2NhdGlvbiAoYSBTeW5jUG9pbnQgd2l0aCAwIHZpZXdzIHNob3VsZCBiZSByZW1vdmVkKS5cbiAqICAtIFByb3h5aW5nIHVzZXIgLyBzZXJ2ZXIgb3BlcmF0aW9ucyB0byB0aGUgdmlld3MgYXMgYXBwcm9wcmlhdGUgKGkuZS4gYXBwbHlTZXJ2ZXJPdmVyd3JpdGUsXG4gKiAgICBhcHBseVVzZXJPdmVyd3JpdGUsIGV0Yy4pXG4gKi9cbnZhciBTeW5jUG9pbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gU3luY1BvaW50KCkge1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIFZpZXdzIGJlaW5nIHRyYWNrZWQgYXQgdGhpcyBsb2NhdGlvbiBpbiB0aGUgdHJlZSwgc3RvcmVkIGFzIGEgbWFwIHdoZXJlIHRoZSBrZXkgaXMgYVxuICAgICAgICAgKiBxdWVyeUlkIGFuZCB0aGUgdmFsdWUgaXMgdGhlIFZpZXcgZm9yIHRoYXQgcXVlcnkuXG4gICAgICAgICAqXG4gICAgICAgICAqIE5PVEU6IFRoaXMgbGlzdCB3aWxsIGJlIHF1aXRlIHNtYWxsICh1c3VhbGx5IDEsIGJ1dCBwZXJoYXBzIDIgb3IgMzsgYW55IG1vcmUgaXMgYW4gb2RkIHVzZSBjYXNlKS5cbiAgICAgICAgICpcbiAgICAgICAgICogQHR5cGUgeyFPYmplY3QuPCFzdHJpbmcsICFWaWV3Pn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudmlld3NfID0ge307XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTeW5jUG9pbnQsIFwiX19yZWZlcmVuY2VDb25zdHJ1Y3RvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdXRpbF8xLmFzc2VydChfX3JlZmVyZW5jZUNvbnN0cnVjdG9yLCAnUmVmZXJlbmNlLnRzIGhhcyBub3QgYmVlbiBsb2FkZWQnKTtcbiAgICAgICAgICAgIHJldHVybiBfX3JlZmVyZW5jZUNvbnN0cnVjdG9yO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWwpIHtcbiAgICAgICAgICAgIHV0aWxfMS5hc3NlcnQoIV9fcmVmZXJlbmNlQ29uc3RydWN0b3IsICdfX3JlZmVyZW5jZUNvbnN0cnVjdG9yIGhhcyBhbHJlYWR5IGJlZW4gZGVmaW5lZCcpO1xuICAgICAgICAgICAgX19yZWZlcmVuY2VDb25zdHJ1Y3RvciA9IHZhbDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBTeW5jUG9pbnQucHJvdG90eXBlLmlzRW1wdHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB1dGlsXzIuaXNFbXB0eSh0aGlzLnZpZXdzXyk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7IU9wZXJhdGlvbn0gb3BlcmF0aW9uXG4gICAgICogQHBhcmFtIHshV3JpdGVUcmVlUmVmfSB3cml0ZXNDYWNoZVxuICAgICAqIEBwYXJhbSB7P05vZGV9IG9wdENvbXBsZXRlU2VydmVyQ2FjaGVcbiAgICAgKiBAcmV0dXJuIHshQXJyYXkuPCFFdmVudD59XG4gICAgICovXG4gICAgU3luY1BvaW50LnByb3RvdHlwZS5hcHBseU9wZXJhdGlvbiA9IGZ1bmN0aW9uIChvcGVyYXRpb24sIHdyaXRlc0NhY2hlLCBvcHRDb21wbGV0ZVNlcnZlckNhY2hlKSB7XG4gICAgICAgIHZhciBxdWVyeUlkID0gb3BlcmF0aW9uLnNvdXJjZS5xdWVyeUlkO1xuICAgICAgICBpZiAocXVlcnlJZCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgdmFyIHZpZXcgPSB1dGlsXzIuc2FmZUdldCh0aGlzLnZpZXdzXywgcXVlcnlJZCk7XG4gICAgICAgICAgICB1dGlsXzEuYXNzZXJ0KHZpZXcgIT0gbnVsbCwgJ1N5bmNUcmVlIGdhdmUgdXMgYW4gb3AgZm9yIGFuIGludmFsaWQgcXVlcnkuJyk7XG4gICAgICAgICAgICByZXR1cm4gdmlldy5hcHBseU9wZXJhdGlvbihvcGVyYXRpb24sIHdyaXRlc0NhY2hlLCBvcHRDb21wbGV0ZVNlcnZlckNhY2hlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBldmVudHNfMSA9IFtdO1xuICAgICAgICAgICAgdXRpbF8yLmZvckVhY2godGhpcy52aWV3c18sIGZ1bmN0aW9uIChrZXksIHZpZXcpIHtcbiAgICAgICAgICAgICAgICBldmVudHNfMSA9IGV2ZW50c18xLmNvbmNhdCh2aWV3LmFwcGx5T3BlcmF0aW9uKG9wZXJhdGlvbiwgd3JpdGVzQ2FjaGUsIG9wdENvbXBsZXRlU2VydmVyQ2FjaGUpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGV2ZW50c18xO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBBZGQgYW4gZXZlbnQgY2FsbGJhY2sgZm9yIHRoZSBzcGVjaWZpZWQgcXVlcnkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyFRdWVyeX0gcXVlcnlcbiAgICAgKiBAcGFyYW0geyFFdmVudFJlZ2lzdHJhdGlvbn0gZXZlbnRSZWdpc3RyYXRpb25cbiAgICAgKiBAcGFyYW0geyFXcml0ZVRyZWVSZWZ9IHdyaXRlc0NhY2hlXG4gICAgICogQHBhcmFtIHs/Tm9kZX0gc2VydmVyQ2FjaGUgQ29tcGxldGUgc2VydmVyIGNhY2hlLCBpZiB3ZSBoYXZlIGl0LlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gc2VydmVyQ2FjaGVDb21wbGV0ZVxuICAgICAqIEByZXR1cm4geyFBcnJheS48IUV2ZW50Pn0gRXZlbnRzIHRvIHJhaXNlLlxuICAgICAqL1xuICAgIFN5bmNQb2ludC5wcm90b3R5cGUuYWRkRXZlbnRSZWdpc3RyYXRpb24gPSBmdW5jdGlvbiAocXVlcnksIGV2ZW50UmVnaXN0cmF0aW9uLCB3cml0ZXNDYWNoZSwgc2VydmVyQ2FjaGUsIHNlcnZlckNhY2hlQ29tcGxldGUpIHtcbiAgICAgICAgdmFyIHF1ZXJ5SWQgPSBxdWVyeS5xdWVyeUlkZW50aWZpZXIoKTtcbiAgICAgICAgdmFyIHZpZXcgPSB1dGlsXzIuc2FmZUdldCh0aGlzLnZpZXdzXywgcXVlcnlJZCk7XG4gICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgLy8gVE9ETzogbWFrZSB3cml0ZXNDYWNoZSB0YWtlIGZsYWcgZm9yIGNvbXBsZXRlIHNlcnZlciBub2RlXG4gICAgICAgICAgICB2YXIgZXZlbnRDYWNoZSA9IHdyaXRlc0NhY2hlLmNhbGNDb21wbGV0ZUV2ZW50Q2FjaGUoc2VydmVyQ2FjaGVDb21wbGV0ZSA/IHNlcnZlckNhY2hlIDogbnVsbCk7XG4gICAgICAgICAgICB2YXIgZXZlbnRDYWNoZUNvbXBsZXRlID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAoZXZlbnRDYWNoZSkge1xuICAgICAgICAgICAgICAgIGV2ZW50Q2FjaGVDb21wbGV0ZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzZXJ2ZXJDYWNoZSBpbnN0YW5jZW9mIENoaWxkcmVuTm9kZV8xLkNoaWxkcmVuTm9kZSkge1xuICAgICAgICAgICAgICAgIGV2ZW50Q2FjaGUgPSB3cml0ZXNDYWNoZS5jYWxjQ29tcGxldGVFdmVudENoaWxkcmVuKHNlcnZlckNhY2hlKTtcbiAgICAgICAgICAgICAgICBldmVudENhY2hlQ29tcGxldGUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGV2ZW50Q2FjaGUgPSBDaGlsZHJlbk5vZGVfMS5DaGlsZHJlbk5vZGUuRU1QVFlfTk9ERTtcbiAgICAgICAgICAgICAgICBldmVudENhY2hlQ29tcGxldGUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB2aWV3Q2FjaGUgPSBuZXcgVmlld0NhY2hlXzEuVmlld0NhY2hlKG5ldyBDYWNoZU5vZGVfMS5DYWNoZU5vZGUoXG4gICAgICAgICAgICAvKiogQHR5cGUgeyFOb2RlfSAqLyAoZXZlbnRDYWNoZSksIGV2ZW50Q2FjaGVDb21wbGV0ZSwgZmFsc2UpLCBuZXcgQ2FjaGVOb2RlXzEuQ2FjaGVOb2RlKFxuICAgICAgICAgICAgLyoqIEB0eXBlIHshTm9kZX0gKi8gKHNlcnZlckNhY2hlKSwgc2VydmVyQ2FjaGVDb21wbGV0ZSwgZmFsc2UpKTtcbiAgICAgICAgICAgIHZpZXcgPSBuZXcgVmlld18xLlZpZXcocXVlcnksIHZpZXdDYWNoZSk7XG4gICAgICAgICAgICB0aGlzLnZpZXdzX1txdWVyeUlkXSA9IHZpZXc7XG4gICAgICAgIH1cbiAgICAgICAgLy8gVGhpcyBpcyBndWFyYW50ZWVkIHRvIGV4aXN0IG5vdywgd2UganVzdCBjcmVhdGVkIGFueXRoaW5nIHRoYXQgd2FzIG1pc3NpbmdcbiAgICAgICAgdmlldy5hZGRFdmVudFJlZ2lzdHJhdGlvbihldmVudFJlZ2lzdHJhdGlvbik7XG4gICAgICAgIHJldHVybiB2aWV3LmdldEluaXRpYWxFdmVudHMoZXZlbnRSZWdpc3RyYXRpb24pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUmVtb3ZlIGV2ZW50IGNhbGxiYWNrKHMpLiAgUmV0dXJuIGNhbmNlbEV2ZW50cyBpZiBhIGNhbmNlbEVycm9yIGlzIHNwZWNpZmllZC5cbiAgICAgKlxuICAgICAqIElmIHF1ZXJ5IGlzIHRoZSBkZWZhdWx0IHF1ZXJ5LCB3ZSdsbCBjaGVjayBhbGwgdmlld3MgZm9yIHRoZSBzcGVjaWZpZWQgZXZlbnRSZWdpc3RyYXRpb24uXG4gICAgICogSWYgZXZlbnRSZWdpc3RyYXRpb24gaXMgbnVsbCwgd2UnbGwgcmVtb3ZlIGFsbCBjYWxsYmFja3MgZm9yIHRoZSBzcGVjaWZpZWQgdmlldyhzKS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7IVF1ZXJ5fSBxdWVyeVxuICAgICAqIEBwYXJhbSB7P0V2ZW50UmVnaXN0cmF0aW9ufSBldmVudFJlZ2lzdHJhdGlvbiBJZiBudWxsLCByZW1vdmUgYWxsIGNhbGxiYWNrcy5cbiAgICAgKiBAcGFyYW0ge0Vycm9yPX0gY2FuY2VsRXJyb3IgSWYgYSBjYW5jZWxFcnJvciBpcyBwcm92aWRlZCwgYXBwcm9wcmlhdGUgY2FuY2VsIGV2ZW50cyB3aWxsIGJlIHJldHVybmVkLlxuICAgICAqIEByZXR1cm4ge3tyZW1vdmVkOiFBcnJheS48IVF1ZXJ5PiwgZXZlbnRzOiFBcnJheS48IUV2ZW50Pn19IHJlbW92ZWQgcXVlcmllcyBhbmQgYW55IGNhbmNlbCBldmVudHNcbiAgICAgKi9cbiAgICBTeW5jUG9pbnQucHJvdG90eXBlLnJlbW92ZUV2ZW50UmVnaXN0cmF0aW9uID0gZnVuY3Rpb24gKHF1ZXJ5LCBldmVudFJlZ2lzdHJhdGlvbiwgY2FuY2VsRXJyb3IpIHtcbiAgICAgICAgdmFyIHF1ZXJ5SWQgPSBxdWVyeS5xdWVyeUlkZW50aWZpZXIoKTtcbiAgICAgICAgdmFyIHJlbW92ZWQgPSBbXTtcbiAgICAgICAgdmFyIGNhbmNlbEV2ZW50cyA9IFtdO1xuICAgICAgICB2YXIgaGFkQ29tcGxldGVWaWV3ID0gdGhpcy5oYXNDb21wbGV0ZVZpZXcoKTtcbiAgICAgICAgaWYgKHF1ZXJ5SWQgPT09ICdkZWZhdWx0Jykge1xuICAgICAgICAgICAgLy8gV2hlbiB5b3UgZG8gcmVmLm9mZiguLi4pLCB3ZSBzZWFyY2ggYWxsIHZpZXdzIGZvciB0aGUgcmVnaXN0cmF0aW9uIHRvIHJlbW92ZS5cbiAgICAgICAgICAgIHZhciBzZWxmXzEgPSB0aGlzO1xuICAgICAgICAgICAgdXRpbF8yLmZvckVhY2godGhpcy52aWV3c18sIGZ1bmN0aW9uICh2aWV3UXVlcnlJZCwgdmlldykge1xuICAgICAgICAgICAgICAgIGNhbmNlbEV2ZW50cyA9IGNhbmNlbEV2ZW50cy5jb25jYXQodmlldy5yZW1vdmVFdmVudFJlZ2lzdHJhdGlvbihldmVudFJlZ2lzdHJhdGlvbiwgY2FuY2VsRXJyb3IpKTtcbiAgICAgICAgICAgICAgICBpZiAodmlldy5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHNlbGZfMS52aWV3c19bdmlld1F1ZXJ5SWRdO1xuICAgICAgICAgICAgICAgICAgICAvLyBXZSdsbCBkZWFsIHdpdGggY29tcGxldGUgdmlld3MgbGF0ZXIuXG4gICAgICAgICAgICAgICAgICAgIGlmICghdmlld1xuICAgICAgICAgICAgICAgICAgICAgICAgLmdldFF1ZXJ5KClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5nZXRRdWVyeVBhcmFtcygpXG4gICAgICAgICAgICAgICAgICAgICAgICAubG9hZHNBbGxEYXRhKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZWQucHVzaCh2aWV3LmdldFF1ZXJ5KCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyByZW1vdmUgdGhlIGNhbGxiYWNrIGZyb20gdGhlIHNwZWNpZmljIHZpZXcuXG4gICAgICAgICAgICB2YXIgdmlldyA9IHV0aWxfMi5zYWZlR2V0KHRoaXMudmlld3NfLCBxdWVyeUlkKTtcbiAgICAgICAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgICAgICAgICAgY2FuY2VsRXZlbnRzID0gY2FuY2VsRXZlbnRzLmNvbmNhdCh2aWV3LnJlbW92ZUV2ZW50UmVnaXN0cmF0aW9uKGV2ZW50UmVnaXN0cmF0aW9uLCBjYW5jZWxFcnJvcikpO1xuICAgICAgICAgICAgICAgIGlmICh2aWV3LmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy52aWV3c19bcXVlcnlJZF07XG4gICAgICAgICAgICAgICAgICAgIC8vIFdlJ2xsIGRlYWwgd2l0aCBjb21wbGV0ZSB2aWV3cyBsYXRlci5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCF2aWV3XG4gICAgICAgICAgICAgICAgICAgICAgICAuZ2V0UXVlcnkoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmdldFF1ZXJ5UGFyYW1zKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5sb2Fkc0FsbERhdGEoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlZC5wdXNoKHZpZXcuZ2V0UXVlcnkoKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGhhZENvbXBsZXRlVmlldyAmJiAhdGhpcy5oYXNDb21wbGV0ZVZpZXcoKSkge1xuICAgICAgICAgICAgLy8gV2UgcmVtb3ZlZCBvdXIgbGFzdCBjb21wbGV0ZSB2aWV3LlxuICAgICAgICAgICAgcmVtb3ZlZC5wdXNoKG5ldyBTeW5jUG9pbnQuX19yZWZlcmVuY2VDb25zdHJ1Y3RvcihxdWVyeS5yZXBvLCBxdWVyeS5wYXRoKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgcmVtb3ZlZDogcmVtb3ZlZCwgZXZlbnRzOiBjYW5jZWxFdmVudHMgfTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4geyFBcnJheS48IVZpZXc+fVxuICAgICAqL1xuICAgIFN5bmNQb2ludC5wcm90b3R5cGUuZ2V0UXVlcnlWaWV3cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIHZhbHVlcyA9IE9iamVjdC5rZXlzKHRoaXMudmlld3NfKS5tYXAoZnVuY3Rpb24gKGtleSkgeyByZXR1cm4gX3RoaXMudmlld3NfW2tleV07IH0pO1xuICAgICAgICByZXR1cm4gdmFsdWVzLmZpbHRlcihmdW5jdGlvbiAodmlldykge1xuICAgICAgICAgICAgcmV0dXJuICF2aWV3XG4gICAgICAgICAgICAgICAgLmdldFF1ZXJ5KClcbiAgICAgICAgICAgICAgICAuZ2V0UXVlcnlQYXJhbXMoKVxuICAgICAgICAgICAgICAgIC5sb2Fkc0FsbERhdGEoKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7IVBhdGh9IHBhdGggVGhlIHBhdGggdG8gdGhlIGRlc2lyZWQgY29tcGxldGUgc25hcHNob3RcbiAgICAgKiBAcmV0dXJuIHs/Tm9kZX0gQSBjb21wbGV0ZSBjYWNoZSwgaWYgaXQgZXhpc3RzXG4gICAgICovXG4gICAgU3luY1BvaW50LnByb3RvdHlwZS5nZXRDb21wbGV0ZVNlcnZlckNhY2hlID0gZnVuY3Rpb24gKHBhdGgpIHtcbiAgICAgICAgdmFyIHNlcnZlckNhY2hlID0gbnVsbDtcbiAgICAgICAgdXRpbF8yLmZvckVhY2godGhpcy52aWV3c18sIGZ1bmN0aW9uIChrZXksIHZpZXcpIHtcbiAgICAgICAgICAgIHNlcnZlckNhY2hlID0gc2VydmVyQ2FjaGUgfHwgdmlldy5nZXRDb21wbGV0ZVNlcnZlckNhY2hlKHBhdGgpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHNlcnZlckNhY2hlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshUXVlcnl9IHF1ZXJ5XG4gICAgICogQHJldHVybiB7P1ZpZXd9XG4gICAgICovXG4gICAgU3luY1BvaW50LnByb3RvdHlwZS52aWV3Rm9yUXVlcnkgPSBmdW5jdGlvbiAocXVlcnkpIHtcbiAgICAgICAgdmFyIHBhcmFtcyA9IHF1ZXJ5LmdldFF1ZXJ5UGFyYW1zKCk7XG4gICAgICAgIGlmIChwYXJhbXMubG9hZHNBbGxEYXRhKCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldENvbXBsZXRlVmlldygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIHF1ZXJ5SWQgPSBxdWVyeS5xdWVyeUlkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIHJldHVybiB1dGlsXzIuc2FmZUdldCh0aGlzLnZpZXdzXywgcXVlcnlJZCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7IVF1ZXJ5fSBxdWVyeVxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAgICovXG4gICAgU3luY1BvaW50LnByb3RvdHlwZS52aWV3RXhpc3RzRm9yUXVlcnkgPSBmdW5jdGlvbiAocXVlcnkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmlld0ZvclF1ZXJ5KHF1ZXJ5KSAhPSBudWxsO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBTeW5jUG9pbnQucHJvdG90eXBlLmhhc0NvbXBsZXRlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Q29tcGxldGVWaWV3KCkgIT0gbnVsbDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4gez9WaWV3fVxuICAgICAqL1xuICAgIFN5bmNQb2ludC5wcm90b3R5cGUuZ2V0Q29tcGxldGVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY29tcGxldGVWaWV3ID0gdXRpbF8yLmZpbmRWYWx1ZSh0aGlzLnZpZXdzXywgZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgICAgIHJldHVybiB2aWV3XG4gICAgICAgICAgICAgICAgLmdldFF1ZXJ5KClcbiAgICAgICAgICAgICAgICAuZ2V0UXVlcnlQYXJhbXMoKVxuICAgICAgICAgICAgICAgIC5sb2Fkc0FsbERhdGEoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBjb21wbGV0ZVZpZXcgfHwgbnVsbDtcbiAgICB9O1xuICAgIHJldHVybiBTeW5jUG9pbnQ7XG59KCkpO1xuZXhwb3J0cy5TeW5jUG9pbnQgPSBTeW5jUG9pbnQ7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVN5bmNQb2ludC5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB1dGlsXzEgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG52YXIgdXRpbF8yID0gcmVxdWlyZShcIi4vdXRpbC91dGlsXCIpO1xudmFyIEFja1VzZXJXcml0ZV8xID0gcmVxdWlyZShcIi4vb3BlcmF0aW9uL0Fja1VzZXJXcml0ZVwiKTtcbnZhciBDaGlsZHJlbk5vZGVfMSA9IHJlcXVpcmUoXCIuL3NuYXAvQ2hpbGRyZW5Ob2RlXCIpO1xudmFyIHV0aWxfMyA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvdXRpbFwiKTtcbnZhciBJbW11dGFibGVUcmVlXzEgPSByZXF1aXJlKFwiLi91dGlsL0ltbXV0YWJsZVRyZWVcIik7XG52YXIgTGlzdGVuQ29tcGxldGVfMSA9IHJlcXVpcmUoXCIuL29wZXJhdGlvbi9MaXN0ZW5Db21wbGV0ZVwiKTtcbnZhciBNZXJnZV8xID0gcmVxdWlyZShcIi4vb3BlcmF0aW9uL01lcmdlXCIpO1xudmFyIE9wZXJhdGlvbl8xID0gcmVxdWlyZShcIi4vb3BlcmF0aW9uL09wZXJhdGlvblwiKTtcbnZhciBPdmVyd3JpdGVfMSA9IHJlcXVpcmUoXCIuL29wZXJhdGlvbi9PdmVyd3JpdGVcIik7XG52YXIgUGF0aF8xID0gcmVxdWlyZShcIi4vdXRpbC9QYXRoXCIpO1xudmFyIFN5bmNQb2ludF8xID0gcmVxdWlyZShcIi4vU3luY1BvaW50XCIpO1xudmFyIFdyaXRlVHJlZV8xID0gcmVxdWlyZShcIi4vV3JpdGVUcmVlXCIpO1xuLyoqXG4gKiBTeW5jVHJlZSBpcyB0aGUgY2VudHJhbCBjbGFzcyBmb3IgbWFuYWdpbmcgZXZlbnQgY2FsbGJhY2sgcmVnaXN0cmF0aW9uLCBkYXRhIGNhY2hpbmcsIHZpZXdzXG4gKiAocXVlcnkgcHJvY2Vzc2luZyksIGFuZCBldmVudCBnZW5lcmF0aW9uLiAgVGhlcmUgYXJlIHR5cGljYWxseSB0d28gU3luY1RyZWUgaW5zdGFuY2VzIGZvclxuICogZWFjaCBSZXBvLCBvbmUgZm9yIHRoZSBub3JtYWwgRmlyZWJhc2UgZGF0YSwgYW5kIG9uZSBmb3IgdGhlIC5pbmZvIGRhdGEuXG4gKlxuICogSXQgaGFzIGEgbnVtYmVyIG9mIHJlc3BvbnNpYmlsaXRpZXMsIGluY2x1ZGluZzpcbiAqICAtIFRyYWNraW5nIGFsbCB1c2VyIGV2ZW50IGNhbGxiYWNrcyAocmVnaXN0ZXJlZCB2aWEgYWRkRXZlbnRSZWdpc3RyYXRpb24oKSBhbmQgcmVtb3ZlRXZlbnRSZWdpc3RyYXRpb24oKSkuXG4gKiAgLSBBcHBseWluZyBhbmQgY2FjaGluZyBkYXRhIGNoYW5nZXMgZm9yIHVzZXIgc2V0KCksIHRyYW5zYWN0aW9uKCksIGFuZCB1cGRhdGUoKSBjYWxsc1xuICogICAgKGFwcGx5VXNlck92ZXJ3cml0ZSgpLCBhcHBseVVzZXJNZXJnZSgpKS5cbiAqICAtIEFwcGx5aW5nIGFuZCBjYWNoaW5nIGRhdGEgY2hhbmdlcyBmb3Igc2VydmVyIGRhdGEgY2hhbmdlcyAoYXBwbHlTZXJ2ZXJPdmVyd3JpdGUoKSxcbiAqICAgIGFwcGx5U2VydmVyTWVyZ2UoKSkuXG4gKiAgLSBHZW5lcmF0aW5nIHVzZXItZmFjaW5nIGV2ZW50cyBmb3Igc2VydmVyIGFuZCB1c2VyIGNoYW5nZXMgKGFsbCBvZiB0aGUgYXBwbHkqIG1ldGhvZHNcbiAqICAgIHJldHVybiB0aGUgc2V0IG9mIGV2ZW50cyB0aGF0IG5lZWQgdG8gYmUgcmFpc2VkIGFzIGEgcmVzdWx0KS5cbiAqICAtIE1haW50YWluaW5nIHRoZSBhcHByb3ByaWF0ZSBzZXQgb2Ygc2VydmVyIGxpc3RlbnMgdG8gZW5zdXJlIHdlIGFyZSBhbHdheXMgc3Vic2NyaWJlZFxuICogICAgdG8gdGhlIGNvcnJlY3Qgc2V0IG9mIHBhdGhzIGFuZCBxdWVyaWVzIHRvIHNhdGlzZnkgdGhlIGN1cnJlbnQgc2V0IG9mIHVzZXIgZXZlbnRcbiAqICAgIGNhbGxiYWNrcyAobGlzdGVucyBhcmUgc3RhcnRlZC9zdG9wcGVkIHVzaW5nIHRoZSBwcm92aWRlZCBsaXN0ZW5Qcm92aWRlcikuXG4gKlxuICogTk9URTogQWx0aG91Z2ggU3luY1RyZWUgdHJhY2tzIGV2ZW50IGNhbGxiYWNrcyBhbmQgY2FsY3VsYXRlcyBldmVudHMgdG8gcmFpc2UsIHRoZSBhY3R1YWxcbiAqIGV2ZW50cyBhcmUgcmV0dXJuZWQgdG8gdGhlIGNhbGxlciByYXRoZXIgdGhhbiByYWlzZWQgc3luY2hyb25vdXNseS5cbiAqXG4gKiBAY29uc3RydWN0b3JcbiAqL1xudmFyIFN5bmNUcmVlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7IUxpc3RlblByb3ZpZGVyfSBsaXN0ZW5Qcm92aWRlcl8gVXNlZCBieSBTeW5jVHJlZSB0byBzdGFydCAvIHN0b3AgbGlzdGVuaW5nXG4gICAgICogICB0byBzZXJ2ZXIgZGF0YS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBTeW5jVHJlZShsaXN0ZW5Qcm92aWRlcl8pIHtcbiAgICAgICAgdGhpcy5saXN0ZW5Qcm92aWRlcl8gPSBsaXN0ZW5Qcm92aWRlcl87XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUcmVlIG9mIFN5bmNQb2ludHMuICBUaGVyZSdzIGEgU3luY1BvaW50IGF0IGFueSBsb2NhdGlvbiB0aGF0IGhhcyAxIG9yIG1vcmUgdmlld3MuXG4gICAgICAgICAqIEB0eXBlIHshSW1tdXRhYmxlVHJlZS48IVN5bmNQb2ludD59XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnN5bmNQb2ludFRyZWVfID0gSW1tdXRhYmxlVHJlZV8xLkltbXV0YWJsZVRyZWUuRW1wdHk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIHRyZWUgb2YgYWxsIHBlbmRpbmcgdXNlciB3cml0ZXMgKHVzZXItaW5pdGlhdGVkIHNldCgpJ3MsIHRyYW5zYWN0aW9uKCkncywgdXBkYXRlKCkncywgZXRjLikuXG4gICAgICAgICAqIEB0eXBlIHshV3JpdGVUcmVlfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5wZW5kaW5nV3JpdGVUcmVlXyA9IG5ldyBXcml0ZVRyZWVfMS5Xcml0ZVRyZWUoKTtcbiAgICAgICAgdGhpcy50YWdUb1F1ZXJ5TWFwXyA9IHt9O1xuICAgICAgICB0aGlzLnF1ZXJ5VG9UYWdNYXBfID0ge307XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFwcGx5IHRoZSBkYXRhIGNoYW5nZXMgZm9yIGEgdXNlci1nZW5lcmF0ZWQgc2V0KCkgb3IgdHJhbnNhY3Rpb24oKSBjYWxsLlxuICAgICAqXG4gICAgICogQHBhcmFtIHshUGF0aH0gcGF0aFxuICAgICAqIEBwYXJhbSB7IU5vZGV9IG5ld0RhdGFcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gd3JpdGVJZFxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbj19IHZpc2libGVcbiAgICAgKiBAcmV0dXJuIHshQXJyYXkuPCFFdmVudD59IEV2ZW50cyB0byByYWlzZS5cbiAgICAgKi9cbiAgICBTeW5jVHJlZS5wcm90b3R5cGUuYXBwbHlVc2VyT3ZlcndyaXRlID0gZnVuY3Rpb24gKHBhdGgsIG5ld0RhdGEsIHdyaXRlSWQsIHZpc2libGUpIHtcbiAgICAgICAgLy8gUmVjb3JkIHBlbmRpbmcgd3JpdGUuXG4gICAgICAgIHRoaXMucGVuZGluZ1dyaXRlVHJlZV8uYWRkT3ZlcndyaXRlKHBhdGgsIG5ld0RhdGEsIHdyaXRlSWQsIHZpc2libGUpO1xuICAgICAgICBpZiAoIXZpc2libGUpIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFwcGx5T3BlcmF0aW9uVG9TeW5jUG9pbnRzXyhuZXcgT3ZlcndyaXRlXzEuT3ZlcndyaXRlKE9wZXJhdGlvbl8xLk9wZXJhdGlvblNvdXJjZS5Vc2VyLCBwYXRoLCBuZXdEYXRhKSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEFwcGx5IHRoZSBkYXRhIGZyb20gYSB1c2VyLWdlbmVyYXRlZCB1cGRhdGUoKSBjYWxsXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyFQYXRofSBwYXRoXG4gICAgICogQHBhcmFtIHshT2JqZWN0LjxzdHJpbmcsICFOb2RlPn0gY2hhbmdlZENoaWxkcmVuXG4gICAgICogQHBhcmFtIHshbnVtYmVyfSB3cml0ZUlkXG4gICAgICogQHJldHVybiB7IUFycmF5LjwhRXZlbnQ+fSBFdmVudHMgdG8gcmFpc2UuXG4gICAgICovXG4gICAgU3luY1RyZWUucHJvdG90eXBlLmFwcGx5VXNlck1lcmdlID0gZnVuY3Rpb24gKHBhdGgsIGNoYW5nZWRDaGlsZHJlbiwgd3JpdGVJZCkge1xuICAgICAgICAvLyBSZWNvcmQgcGVuZGluZyBtZXJnZS5cbiAgICAgICAgdGhpcy5wZW5kaW5nV3JpdGVUcmVlXy5hZGRNZXJnZShwYXRoLCBjaGFuZ2VkQ2hpbGRyZW4sIHdyaXRlSWQpO1xuICAgICAgICB2YXIgY2hhbmdlVHJlZSA9IEltbXV0YWJsZVRyZWVfMS5JbW11dGFibGVUcmVlLmZyb21PYmplY3QoY2hhbmdlZENoaWxkcmVuKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlPcGVyYXRpb25Ub1N5bmNQb2ludHNfKG5ldyBNZXJnZV8xLk1lcmdlKE9wZXJhdGlvbl8xLk9wZXJhdGlvblNvdXJjZS5Vc2VyLCBwYXRoLCBjaGFuZ2VUcmVlKSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBBY2tub3dsZWRnZSBhIHBlbmRpbmcgdXNlciB3cml0ZSB0aGF0IHdhcyBwcmV2aW91c2x5IHJlZ2lzdGVyZWQgd2l0aCBhcHBseVVzZXJPdmVyd3JpdGUoKSBvciBhcHBseVVzZXJNZXJnZSgpLlxuICAgICAqXG4gICAgICogQHBhcmFtIHshbnVtYmVyfSB3cml0ZUlkXG4gICAgICogQHBhcmFtIHtib29sZWFuPX0gcmV2ZXJ0IFRydWUgaWYgdGhlIGdpdmVuIHdyaXRlIGZhaWxlZCBhbmQgbmVlZHMgdG8gYmUgcmV2ZXJ0ZWRcbiAgICAgKiBAcmV0dXJuIHshQXJyYXkuPCFFdmVudD59IEV2ZW50cyB0byByYWlzZS5cbiAgICAgKi9cbiAgICBTeW5jVHJlZS5wcm90b3R5cGUuYWNrVXNlcldyaXRlID0gZnVuY3Rpb24gKHdyaXRlSWQsIHJldmVydCkge1xuICAgICAgICBpZiAocmV2ZXJ0ID09PSB2b2lkIDApIHsgcmV2ZXJ0ID0gZmFsc2U7IH1cbiAgICAgICAgdmFyIHdyaXRlID0gdGhpcy5wZW5kaW5nV3JpdGVUcmVlXy5nZXRXcml0ZSh3cml0ZUlkKTtcbiAgICAgICAgdmFyIG5lZWRUb1JlZXZhbHVhdGUgPSB0aGlzLnBlbmRpbmdXcml0ZVRyZWVfLnJlbW92ZVdyaXRlKHdyaXRlSWQpO1xuICAgICAgICBpZiAoIW5lZWRUb1JlZXZhbHVhdGUpIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBhZmZlY3RlZFRyZWVfMSA9IEltbXV0YWJsZVRyZWVfMS5JbW11dGFibGVUcmVlLkVtcHR5O1xuICAgICAgICAgICAgaWYgKHdyaXRlLnNuYXAgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIC8vIG92ZXJ3cml0ZVxuICAgICAgICAgICAgICAgIGFmZmVjdGVkVHJlZV8xID0gYWZmZWN0ZWRUcmVlXzEuc2V0KFBhdGhfMS5QYXRoLkVtcHR5LCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHV0aWxfMy5mb3JFYWNoKHdyaXRlLmNoaWxkcmVuLCBmdW5jdGlvbiAocGF0aFN0cmluZywgbm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBhZmZlY3RlZFRyZWVfMSA9IGFmZmVjdGVkVHJlZV8xLnNldChuZXcgUGF0aF8xLlBhdGgocGF0aFN0cmluZyksIG5vZGUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlPcGVyYXRpb25Ub1N5bmNQb2ludHNfKG5ldyBBY2tVc2VyV3JpdGVfMS5BY2tVc2VyV3JpdGUod3JpdGUucGF0aCwgYWZmZWN0ZWRUcmVlXzEsIHJldmVydCkpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBBcHBseSBuZXcgc2VydmVyIGRhdGEgZm9yIHRoZSBzcGVjaWZpZWQgcGF0aC4uXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyFQYXRofSBwYXRoXG4gICAgICogQHBhcmFtIHshTm9kZX0gbmV3RGF0YVxuICAgICAqIEByZXR1cm4geyFBcnJheS48IUV2ZW50Pn0gRXZlbnRzIHRvIHJhaXNlLlxuICAgICAqL1xuICAgIFN5bmNUcmVlLnByb3RvdHlwZS5hcHBseVNlcnZlck92ZXJ3cml0ZSA9IGZ1bmN0aW9uIChwYXRoLCBuZXdEYXRhKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5T3BlcmF0aW9uVG9TeW5jUG9pbnRzXyhuZXcgT3ZlcndyaXRlXzEuT3ZlcndyaXRlKE9wZXJhdGlvbl8xLk9wZXJhdGlvblNvdXJjZS5TZXJ2ZXIsIHBhdGgsIG5ld0RhdGEpKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEFwcGx5IG5ldyBzZXJ2ZXIgZGF0YSB0byBiZSBtZXJnZWQgaW4gYXQgdGhlIHNwZWNpZmllZCBwYXRoLlxuICAgICAqXG4gICAgICogQHBhcmFtIHshUGF0aH0gcGF0aFxuICAgICAqIEBwYXJhbSB7IU9iamVjdC48c3RyaW5nLCAhTm9kZT59IGNoYW5nZWRDaGlsZHJlblxuICAgICAqIEByZXR1cm4geyFBcnJheS48IUV2ZW50Pn0gRXZlbnRzIHRvIHJhaXNlLlxuICAgICAqL1xuICAgIFN5bmNUcmVlLnByb3RvdHlwZS5hcHBseVNlcnZlck1lcmdlID0gZnVuY3Rpb24gKHBhdGgsIGNoYW5nZWRDaGlsZHJlbikge1xuICAgICAgICB2YXIgY2hhbmdlVHJlZSA9IEltbXV0YWJsZVRyZWVfMS5JbW11dGFibGVUcmVlLmZyb21PYmplY3QoY2hhbmdlZENoaWxkcmVuKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlPcGVyYXRpb25Ub1N5bmNQb2ludHNfKG5ldyBNZXJnZV8xLk1lcmdlKE9wZXJhdGlvbl8xLk9wZXJhdGlvblNvdXJjZS5TZXJ2ZXIsIHBhdGgsIGNoYW5nZVRyZWUpKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEFwcGx5IGEgbGlzdGVuIGNvbXBsZXRlIGZvciBhIHF1ZXJ5XG4gICAgICpcbiAgICAgKiBAcGFyYW0geyFQYXRofSBwYXRoXG4gICAgICogQHJldHVybiB7IUFycmF5LjwhRXZlbnQ+fSBFdmVudHMgdG8gcmFpc2UuXG4gICAgICovXG4gICAgU3luY1RyZWUucHJvdG90eXBlLmFwcGx5TGlzdGVuQ29tcGxldGUgPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBseU9wZXJhdGlvblRvU3luY1BvaW50c18obmV3IExpc3RlbkNvbXBsZXRlXzEuTGlzdGVuQ29tcGxldGUoT3BlcmF0aW9uXzEuT3BlcmF0aW9uU291cmNlLlNlcnZlciwgcGF0aCkpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQXBwbHkgbmV3IHNlcnZlciBkYXRhIGZvciB0aGUgc3BlY2lmaWVkIHRhZ2dlZCBxdWVyeS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7IVBhdGh9IHBhdGhcbiAgICAgKiBAcGFyYW0geyFOb2RlfSBzbmFwXG4gICAgICogQHBhcmFtIHshbnVtYmVyfSB0YWdcbiAgICAgKiBAcmV0dXJuIHshQXJyYXkuPCFFdmVudD59IEV2ZW50cyB0byByYWlzZS5cbiAgICAgKi9cbiAgICBTeW5jVHJlZS5wcm90b3R5cGUuYXBwbHlUYWdnZWRRdWVyeU92ZXJ3cml0ZSA9IGZ1bmN0aW9uIChwYXRoLCBzbmFwLCB0YWcpIHtcbiAgICAgICAgdmFyIHF1ZXJ5S2V5ID0gdGhpcy5xdWVyeUtleUZvclRhZ18odGFnKTtcbiAgICAgICAgaWYgKHF1ZXJ5S2V5ICE9IG51bGwpIHtcbiAgICAgICAgICAgIHZhciByID0gU3luY1RyZWUucGFyc2VRdWVyeUtleV8ocXVlcnlLZXkpO1xuICAgICAgICAgICAgdmFyIHF1ZXJ5UGF0aCA9IHIucGF0aCwgcXVlcnlJZCA9IHIucXVlcnlJZDtcbiAgICAgICAgICAgIHZhciByZWxhdGl2ZVBhdGggPSBQYXRoXzEuUGF0aC5yZWxhdGl2ZVBhdGgocXVlcnlQYXRoLCBwYXRoKTtcbiAgICAgICAgICAgIHZhciBvcCA9IG5ldyBPdmVyd3JpdGVfMS5PdmVyd3JpdGUoT3BlcmF0aW9uXzEuT3BlcmF0aW9uU291cmNlLmZvclNlcnZlclRhZ2dlZFF1ZXJ5KHF1ZXJ5SWQpLCByZWxhdGl2ZVBhdGgsIHNuYXApO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlUYWdnZWRPcGVyYXRpb25fKHF1ZXJ5UGF0aCwgb3ApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gUXVlcnkgbXVzdCBoYXZlIGJlZW4gcmVtb3ZlZCBhbHJlYWR5XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEFwcGx5IHNlcnZlciBkYXRhIHRvIGJlIG1lcmdlZCBpbiBmb3IgdGhlIHNwZWNpZmllZCB0YWdnZWQgcXVlcnkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyFQYXRofSBwYXRoXG4gICAgICogQHBhcmFtIHshT2JqZWN0LjxzdHJpbmcsICFOb2RlPn0gY2hhbmdlZENoaWxkcmVuXG4gICAgICogQHBhcmFtIHshbnVtYmVyfSB0YWdcbiAgICAgKiBAcmV0dXJuIHshQXJyYXkuPCFFdmVudD59IEV2ZW50cyB0byByYWlzZS5cbiAgICAgKi9cbiAgICBTeW5jVHJlZS5wcm90b3R5cGUuYXBwbHlUYWdnZWRRdWVyeU1lcmdlID0gZnVuY3Rpb24gKHBhdGgsIGNoYW5nZWRDaGlsZHJlbiwgdGFnKSB7XG4gICAgICAgIHZhciBxdWVyeUtleSA9IHRoaXMucXVlcnlLZXlGb3JUYWdfKHRhZyk7XG4gICAgICAgIGlmIChxdWVyeUtleSkge1xuICAgICAgICAgICAgdmFyIHIgPSBTeW5jVHJlZS5wYXJzZVF1ZXJ5S2V5XyhxdWVyeUtleSk7XG4gICAgICAgICAgICB2YXIgcXVlcnlQYXRoID0gci5wYXRoLCBxdWVyeUlkID0gci5xdWVyeUlkO1xuICAgICAgICAgICAgdmFyIHJlbGF0aXZlUGF0aCA9IFBhdGhfMS5QYXRoLnJlbGF0aXZlUGF0aChxdWVyeVBhdGgsIHBhdGgpO1xuICAgICAgICAgICAgdmFyIGNoYW5nZVRyZWUgPSBJbW11dGFibGVUcmVlXzEuSW1tdXRhYmxlVHJlZS5mcm9tT2JqZWN0KGNoYW5nZWRDaGlsZHJlbik7XG4gICAgICAgICAgICB2YXIgb3AgPSBuZXcgTWVyZ2VfMS5NZXJnZShPcGVyYXRpb25fMS5PcGVyYXRpb25Tb3VyY2UuZm9yU2VydmVyVGFnZ2VkUXVlcnkocXVlcnlJZCksIHJlbGF0aXZlUGF0aCwgY2hhbmdlVHJlZSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hcHBseVRhZ2dlZE9wZXJhdGlvbl8ocXVlcnlQYXRoLCBvcCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBXZSd2ZSBhbHJlYWR5IHJlbW92ZWQgdGhlIHF1ZXJ5LiBObyBiaWcgZGVhbCwgaWdub3JlIHRoZSB1cGRhdGVcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQXBwbHkgYSBsaXN0ZW4gY29tcGxldGUgZm9yIGEgdGFnZ2VkIHF1ZXJ5XG4gICAgICpcbiAgICAgKiBAcGFyYW0geyFQYXRofSBwYXRoXG4gICAgICogQHBhcmFtIHshbnVtYmVyfSB0YWdcbiAgICAgKiBAcmV0dXJuIHshQXJyYXkuPCFFdmVudD59IEV2ZW50cyB0byByYWlzZS5cbiAgICAgKi9cbiAgICBTeW5jVHJlZS5wcm90b3R5cGUuYXBwbHlUYWdnZWRMaXN0ZW5Db21wbGV0ZSA9IGZ1bmN0aW9uIChwYXRoLCB0YWcpIHtcbiAgICAgICAgdmFyIHF1ZXJ5S2V5ID0gdGhpcy5xdWVyeUtleUZvclRhZ18odGFnKTtcbiAgICAgICAgaWYgKHF1ZXJ5S2V5KSB7XG4gICAgICAgICAgICB2YXIgciA9IFN5bmNUcmVlLnBhcnNlUXVlcnlLZXlfKHF1ZXJ5S2V5KTtcbiAgICAgICAgICAgIHZhciBxdWVyeVBhdGggPSByLnBhdGgsIHF1ZXJ5SWQgPSByLnF1ZXJ5SWQ7XG4gICAgICAgICAgICB2YXIgcmVsYXRpdmVQYXRoID0gUGF0aF8xLlBhdGgucmVsYXRpdmVQYXRoKHF1ZXJ5UGF0aCwgcGF0aCk7XG4gICAgICAgICAgICB2YXIgb3AgPSBuZXcgTGlzdGVuQ29tcGxldGVfMS5MaXN0ZW5Db21wbGV0ZShPcGVyYXRpb25fMS5PcGVyYXRpb25Tb3VyY2UuZm9yU2VydmVyVGFnZ2VkUXVlcnkocXVlcnlJZCksIHJlbGF0aXZlUGF0aCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hcHBseVRhZ2dlZE9wZXJhdGlvbl8ocXVlcnlQYXRoLCBvcCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBXZSd2ZSBhbHJlYWR5IHJlbW92ZWQgdGhlIHF1ZXJ5LiBObyBiaWcgZGVhbCwgaWdub3JlIHRoZSB1cGRhdGVcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQWRkIGFuIGV2ZW50IGNhbGxiYWNrIGZvciB0aGUgc3BlY2lmaWVkIHF1ZXJ5LlxuICAgICAqXG4gICAgICogQHBhcmFtIHshUXVlcnl9IHF1ZXJ5XG4gICAgICogQHBhcmFtIHshRXZlbnRSZWdpc3RyYXRpb259IGV2ZW50UmVnaXN0cmF0aW9uXG4gICAgICogQHJldHVybiB7IUFycmF5LjwhRXZlbnQ+fSBFdmVudHMgdG8gcmFpc2UuXG4gICAgICovXG4gICAgU3luY1RyZWUucHJvdG90eXBlLmFkZEV2ZW50UmVnaXN0cmF0aW9uID0gZnVuY3Rpb24gKHF1ZXJ5LCBldmVudFJlZ2lzdHJhdGlvbikge1xuICAgICAgICB2YXIgcGF0aCA9IHF1ZXJ5LnBhdGg7XG4gICAgICAgIHZhciBzZXJ2ZXJDYWNoZSA9IG51bGw7XG4gICAgICAgIHZhciBmb3VuZEFuY2VzdG9yRGVmYXVsdFZpZXcgPSBmYWxzZTtcbiAgICAgICAgLy8gQW55IGNvdmVyaW5nIHdyaXRlcyB3aWxsIG5lY2Vzc2FyaWx5IGJlIGF0IHRoZSByb290LCBzbyByZWFsbHkgYWxsIHdlIG5lZWQgdG8gZmluZCBpcyB0aGUgc2VydmVyIGNhY2hlLlxuICAgICAgICAvLyBDb25zaWRlciBvcHRpbWl6aW5nIHRoaXMgb25jZSB0aGVyZSdzIGEgYmV0dGVyIHVuZGVyc3RhbmRpbmcgb2Ygd2hhdCBhY3R1YWwgYmVoYXZpb3Igd2lsbCBiZS5cbiAgICAgICAgdGhpcy5zeW5jUG9pbnRUcmVlXy5mb3JlYWNoT25QYXRoKHBhdGgsIGZ1bmN0aW9uIChwYXRoVG9TeW5jUG9pbnQsIHNwKSB7XG4gICAgICAgICAgICB2YXIgcmVsYXRpdmVQYXRoID0gUGF0aF8xLlBhdGgucmVsYXRpdmVQYXRoKHBhdGhUb1N5bmNQb2ludCwgcGF0aCk7XG4gICAgICAgICAgICBzZXJ2ZXJDYWNoZSA9IHNlcnZlckNhY2hlIHx8IHNwLmdldENvbXBsZXRlU2VydmVyQ2FjaGUocmVsYXRpdmVQYXRoKTtcbiAgICAgICAgICAgIGZvdW5kQW5jZXN0b3JEZWZhdWx0VmlldyA9XG4gICAgICAgICAgICAgICAgZm91bmRBbmNlc3RvckRlZmF1bHRWaWV3IHx8IHNwLmhhc0NvbXBsZXRlVmlldygpO1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIHN5bmNQb2ludCA9IHRoaXMuc3luY1BvaW50VHJlZV8uZ2V0KHBhdGgpO1xuICAgICAgICBpZiAoIXN5bmNQb2ludCkge1xuICAgICAgICAgICAgc3luY1BvaW50ID0gbmV3IFN5bmNQb2ludF8xLlN5bmNQb2ludCgpO1xuICAgICAgICAgICAgdGhpcy5zeW5jUG9pbnRUcmVlXyA9IHRoaXMuc3luY1BvaW50VHJlZV8uc2V0KHBhdGgsIHN5bmNQb2ludCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBmb3VuZEFuY2VzdG9yRGVmYXVsdFZpZXcgPVxuICAgICAgICAgICAgICAgIGZvdW5kQW5jZXN0b3JEZWZhdWx0VmlldyB8fCBzeW5jUG9pbnQuaGFzQ29tcGxldGVWaWV3KCk7XG4gICAgICAgICAgICBzZXJ2ZXJDYWNoZSA9IHNlcnZlckNhY2hlIHx8IHN5bmNQb2ludC5nZXRDb21wbGV0ZVNlcnZlckNhY2hlKFBhdGhfMS5QYXRoLkVtcHR5KTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc2VydmVyQ2FjaGVDb21wbGV0ZTtcbiAgICAgICAgaWYgKHNlcnZlckNhY2hlICE9IG51bGwpIHtcbiAgICAgICAgICAgIHNlcnZlckNhY2hlQ29tcGxldGUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc2VydmVyQ2FjaGVDb21wbGV0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgc2VydmVyQ2FjaGUgPSBDaGlsZHJlbk5vZGVfMS5DaGlsZHJlbk5vZGUuRU1QVFlfTk9ERTtcbiAgICAgICAgICAgIHZhciBzdWJ0cmVlID0gdGhpcy5zeW5jUG9pbnRUcmVlXy5zdWJ0cmVlKHBhdGgpO1xuICAgICAgICAgICAgc3VidHJlZS5mb3JlYWNoQ2hpbGQoZnVuY3Rpb24gKGNoaWxkTmFtZSwgY2hpbGRTeW5jUG9pbnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgY29tcGxldGVDYWNoZSA9IGNoaWxkU3luY1BvaW50LmdldENvbXBsZXRlU2VydmVyQ2FjaGUoUGF0aF8xLlBhdGguRW1wdHkpO1xuICAgICAgICAgICAgICAgIGlmIChjb21wbGV0ZUNhY2hlKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlcnZlckNhY2hlID0gc2VydmVyQ2FjaGUudXBkYXRlSW1tZWRpYXRlQ2hpbGQoY2hpbGROYW1lLCBjb21wbGV0ZUNhY2hlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdmlld0FscmVhZHlFeGlzdHMgPSBzeW5jUG9pbnQudmlld0V4aXN0c0ZvclF1ZXJ5KHF1ZXJ5KTtcbiAgICAgICAgaWYgKCF2aWV3QWxyZWFkeUV4aXN0cyAmJiAhcXVlcnkuZ2V0UXVlcnlQYXJhbXMoKS5sb2Fkc0FsbERhdGEoKSkge1xuICAgICAgICAgICAgLy8gV2UgbmVlZCB0byB0cmFjayBhIHRhZyBmb3IgdGhpcyBxdWVyeVxuICAgICAgICAgICAgdmFyIHF1ZXJ5S2V5ID0gU3luY1RyZWUubWFrZVF1ZXJ5S2V5XyhxdWVyeSk7XG4gICAgICAgICAgICB1dGlsXzEuYXNzZXJ0KCEocXVlcnlLZXkgaW4gdGhpcy5xdWVyeVRvVGFnTWFwXyksICdWaWV3IGRvZXMgbm90IGV4aXN0LCBidXQgd2UgaGF2ZSBhIHRhZycpO1xuICAgICAgICAgICAgdmFyIHRhZyA9IFN5bmNUcmVlLmdldE5leHRRdWVyeVRhZ18oKTtcbiAgICAgICAgICAgIHRoaXMucXVlcnlUb1RhZ01hcF9bcXVlcnlLZXldID0gdGFnO1xuICAgICAgICAgICAgLy8gQ29lcmNlIHRvIHN0cmluZyB0byBhdm9pZCBzcGFyc2UgYXJyYXlzLlxuICAgICAgICAgICAgdGhpcy50YWdUb1F1ZXJ5TWFwX1snXycgKyB0YWddID0gcXVlcnlLZXk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHdyaXRlc0NhY2hlID0gdGhpcy5wZW5kaW5nV3JpdGVUcmVlXy5jaGlsZFdyaXRlcyhwYXRoKTtcbiAgICAgICAgdmFyIGV2ZW50cyA9IHN5bmNQb2ludC5hZGRFdmVudFJlZ2lzdHJhdGlvbihxdWVyeSwgZXZlbnRSZWdpc3RyYXRpb24sIHdyaXRlc0NhY2hlLCBzZXJ2ZXJDYWNoZSwgc2VydmVyQ2FjaGVDb21wbGV0ZSk7XG4gICAgICAgIGlmICghdmlld0FscmVhZHlFeGlzdHMgJiYgIWZvdW5kQW5jZXN0b3JEZWZhdWx0Vmlldykge1xuICAgICAgICAgICAgdmFyIHZpZXcgLyoqIEB0eXBlICFWaWV3ICovID0gc3luY1BvaW50LnZpZXdGb3JRdWVyeShxdWVyeSk7XG4gICAgICAgICAgICBldmVudHMgPSBldmVudHMuY29uY2F0KHRoaXMuc2V0dXBMaXN0ZW5lcl8ocXVlcnksIHZpZXcpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZXZlbnRzO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUmVtb3ZlIGV2ZW50IGNhbGxiYWNrKHMpLlxuICAgICAqXG4gICAgICogSWYgcXVlcnkgaXMgdGhlIGRlZmF1bHQgcXVlcnksIHdlJ2xsIGNoZWNrIGFsbCBxdWVyaWVzIGZvciB0aGUgc3BlY2lmaWVkIGV2ZW50UmVnaXN0cmF0aW9uLlxuICAgICAqIElmIGV2ZW50UmVnaXN0cmF0aW9uIGlzIG51bGwsIHdlJ2xsIHJlbW92ZSBhbGwgY2FsbGJhY2tzIGZvciB0aGUgc3BlY2lmaWVkIHF1ZXJ5L3F1ZXJpZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyFRdWVyeX0gcXVlcnlcbiAgICAgKiBAcGFyYW0gez9FdmVudFJlZ2lzdHJhdGlvbn0gZXZlbnRSZWdpc3RyYXRpb24gSWYgbnVsbCwgYWxsIGNhbGxiYWNrcyBhcmUgcmVtb3ZlZC5cbiAgICAgKiBAcGFyYW0ge0Vycm9yPX0gY2FuY2VsRXJyb3IgSWYgYSBjYW5jZWxFcnJvciBpcyBwcm92aWRlZCwgYXBwcm9wcmlhdGUgY2FuY2VsIGV2ZW50cyB3aWxsIGJlIHJldHVybmVkLlxuICAgICAqIEByZXR1cm4geyFBcnJheS48IUV2ZW50Pn0gQ2FuY2VsIGV2ZW50cywgaWYgY2FuY2VsRXJyb3Igd2FzIHByb3ZpZGVkLlxuICAgICAqL1xuICAgIFN5bmNUcmVlLnByb3RvdHlwZS5yZW1vdmVFdmVudFJlZ2lzdHJhdGlvbiA9IGZ1bmN0aW9uIChxdWVyeSwgZXZlbnRSZWdpc3RyYXRpb24sIGNhbmNlbEVycm9yKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIC8vIEZpbmQgdGhlIHN5bmNQb2ludCBmaXJzdC4gVGhlbiBkZWFsIHdpdGggd2hldGhlciBvciBub3QgaXQgaGFzIG1hdGNoaW5nIGxpc3RlbmVyc1xuICAgICAgICB2YXIgcGF0aCA9IHF1ZXJ5LnBhdGg7XG4gICAgICAgIHZhciBtYXliZVN5bmNQb2ludCA9IHRoaXMuc3luY1BvaW50VHJlZV8uZ2V0KHBhdGgpO1xuICAgICAgICB2YXIgY2FuY2VsRXZlbnRzID0gW107XG4gICAgICAgIC8vIEEgcmVtb3ZhbCBvbiBhIGRlZmF1bHQgcXVlcnkgYWZmZWN0cyBhbGwgcXVlcmllcyBhdCB0aGF0IGxvY2F0aW9uLiBBIHJlbW92YWwgb24gYW4gaW5kZXhlZCBxdWVyeSwgZXZlbiBvbmUgd2l0aG91dFxuICAgICAgICAvLyBvdGhlciBxdWVyeSBjb25zdHJhaW50cywgZG9lcyAqbm90KiBhZmZlY3QgYWxsIHF1ZXJpZXMgYXQgdGhhdCBsb2NhdGlvbi4gU28gdGhpcyBjaGVjayBtdXN0IGJlIGZvciAnZGVmYXVsdCcsIGFuZFxuICAgICAgICAvLyBub3QgbG9hZHNBbGxEYXRhKCkuXG4gICAgICAgIGlmIChtYXliZVN5bmNQb2ludCAmJlxuICAgICAgICAgICAgKHF1ZXJ5LnF1ZXJ5SWRlbnRpZmllcigpID09PSAnZGVmYXVsdCcgfHxcbiAgICAgICAgICAgICAgICBtYXliZVN5bmNQb2ludC52aWV3RXhpc3RzRm9yUXVlcnkocXVlcnkpKSkge1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBAdHlwZSB7e3JlbW92ZWQ6ICFBcnJheS48IVF1ZXJ5PiwgZXZlbnRzOiAhQXJyYXkuPCFFdmVudD59fVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB2YXIgcmVtb3ZlZEFuZEV2ZW50cyA9IG1heWJlU3luY1BvaW50LnJlbW92ZUV2ZW50UmVnaXN0cmF0aW9uKHF1ZXJ5LCBldmVudFJlZ2lzdHJhdGlvbiwgY2FuY2VsRXJyb3IpO1xuICAgICAgICAgICAgaWYgKG1heWJlU3luY1BvaW50LmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3luY1BvaW50VHJlZV8gPSB0aGlzLnN5bmNQb2ludFRyZWVfLnJlbW92ZShwYXRoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciByZW1vdmVkID0gcmVtb3ZlZEFuZEV2ZW50cy5yZW1vdmVkO1xuICAgICAgICAgICAgY2FuY2VsRXZlbnRzID0gcmVtb3ZlZEFuZEV2ZW50cy5ldmVudHM7XG4gICAgICAgICAgICAvLyBXZSBtYXkgaGF2ZSBqdXN0IHJlbW92ZWQgb25lIG9mIG1hbnkgbGlzdGVuZXJzIGFuZCBjYW4gc2hvcnQtY2lyY3VpdCB0aGlzIHdob2xlIHByb2Nlc3NcbiAgICAgICAgICAgIC8vIFdlIG1heSBhbHNvIG5vdCBoYXZlIHJlbW92ZWQgYSBkZWZhdWx0IGxpc3RlbmVyLCBpbiB3aGljaCBjYXNlIGFsbCBvZiB0aGUgZGVzY2VuZGFudCBsaXN0ZW5lcnMgc2hvdWxkIGFscmVhZHkgYmVcbiAgICAgICAgICAgIC8vIHByb3Blcmx5IHNldCB1cC5cbiAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAvLyBTaW5jZSBpbmRleGVkIHF1ZXJpZXMgY2FuIHNoYWRvdyBpZiB0aGV5IGRvbid0IGhhdmUgb3RoZXIgcXVlcnkgY29uc3RyYWludHMsIGNoZWNrIGZvciBsb2Fkc0FsbERhdGEoKSwgaW5zdGVhZCBvZlxuICAgICAgICAgICAgLy8gcXVlcnlJZCA9PT0gJ2RlZmF1bHQnXG4gICAgICAgICAgICB2YXIgcmVtb3ZpbmdEZWZhdWx0ID0gLTEgIT09XG4gICAgICAgICAgICAgICAgcmVtb3ZlZC5maW5kSW5kZXgoZnVuY3Rpb24gKHF1ZXJ5KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBxdWVyeS5nZXRRdWVyeVBhcmFtcygpLmxvYWRzQWxsRGF0YSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIGNvdmVyZWQgPSB0aGlzLnN5bmNQb2ludFRyZWVfLmZpbmRPblBhdGgocGF0aCwgZnVuY3Rpb24gKHJlbGF0aXZlUGF0aCwgcGFyZW50U3luY1BvaW50KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhcmVudFN5bmNQb2ludC5oYXNDb21wbGV0ZVZpZXcoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKHJlbW92aW5nRGVmYXVsdCAmJiAhY292ZXJlZCkge1xuICAgICAgICAgICAgICAgIHZhciBzdWJ0cmVlID0gdGhpcy5zeW5jUG9pbnRUcmVlXy5zdWJ0cmVlKHBhdGgpO1xuICAgICAgICAgICAgICAgIC8vIFRoZXJlIGFyZSBwb3RlbnRpYWxseSBjaGlsZCBsaXN0ZW5lcnMuIERldGVybWluZSB3aGF0IGlmIGFueSBsaXN0ZW5zIHdlIG5lZWQgdG8gc2VuZCBiZWZvcmUgZXhlY3V0aW5nIHRoZVxuICAgICAgICAgICAgICAgIC8vIHJlbW92YWxcbiAgICAgICAgICAgICAgICBpZiAoIXN1YnRyZWUuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gZm9sZCBvdmVyIG91ciBzdWJ0cmVlIGFuZCBjb2xsZWN0IHRoZSBsaXN0ZW5lcnMgdG8gc2VuZFxuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3Vmlld3MgPSB0aGlzLmNvbGxlY3REaXN0aW5jdFZpZXdzRm9yU3ViVHJlZV8oc3VidHJlZSk7XG4gICAgICAgICAgICAgICAgICAgIC8vIE9rLCB3ZSd2ZSBjb2xsZWN0ZWQgYWxsIHRoZSBsaXN0ZW5zIHdlIG5lZWQuIFNldCB0aGVtIHVwLlxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5ld1ZpZXdzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmlldyA9IG5ld1ZpZXdzW2ldLCBuZXdRdWVyeSA9IHZpZXcuZ2V0UXVlcnkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsaXN0ZW5lciA9IHRoaXMuY3JlYXRlTGlzdGVuZXJGb3JWaWV3Xyh2aWV3KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuUHJvdmlkZXJfLnN0YXJ0TGlzdGVuaW5nKFN5bmNUcmVlLnF1ZXJ5Rm9yTGlzdGVuaW5nXyhuZXdRdWVyeSksIHRoaXMudGFnRm9yUXVlcnlfKG5ld1F1ZXJ5KSwgbGlzdGVuZXIuaGFzaEZuLCBsaXN0ZW5lci5vbkNvbXBsZXRlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhlcmUncyBub3RoaW5nIGJlbG93IHVzLCBzbyBub3RoaW5nIHdlIG5lZWQgdG8gc3RhcnQgbGlzdGVuaW5nIG9uXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gSWYgd2UgcmVtb3ZlZCBhbnl0aGluZyBhbmQgd2UncmUgbm90IGNvdmVyZWQgYnkgYSBoaWdoZXIgdXAgbGlzdGVuLCB3ZSBuZWVkIHRvIHN0b3AgbGlzdGVuaW5nIG9uIHRoaXMgcXVlcnlcbiAgICAgICAgICAgIC8vIFRoZSBhYm92ZSBibG9jayBoYXMgdXMgY292ZXJlZCBpbiB0ZXJtcyBvZiBtYWtpbmcgc3VyZSB3ZSdyZSBzZXQgdXAgb24gbGlzdGVucyBsb3dlciBpbiB0aGUgdHJlZS5cbiAgICAgICAgICAgIC8vIEFsc28sIG5vdGUgdGhhdCBpZiB3ZSBoYXZlIGEgY2FuY2VsRXJyb3IsIGl0J3MgYWxyZWFkeSBiZWVuIHJlbW92ZWQgYXQgdGhlIHByb3ZpZGVyIGxldmVsLlxuICAgICAgICAgICAgaWYgKCFjb3ZlcmVkICYmIHJlbW92ZWQubGVuZ3RoID4gMCAmJiAhY2FuY2VsRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAvLyBJZiB3ZSByZW1vdmVkIGEgZGVmYXVsdCwgdGhlbiB3ZSB3ZXJlbid0IGxpc3RlbmluZyBvbiBhbnkgb2YgdGhlIG90aGVyIHF1ZXJpZXMgaGVyZS4gSnVzdCBjYW5jZWwgdGhlIG9uZVxuICAgICAgICAgICAgICAgIC8vIGRlZmF1bHQuIE90aGVyd2lzZSwgd2UgbmVlZCB0byBpdGVyYXRlIHRocm91Z2ggYW5kIGNhbmNlbCBlYWNoIGluZGl2aWR1YWwgcXVlcnlcbiAgICAgICAgICAgICAgICBpZiAocmVtb3ZpbmdEZWZhdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFdlIGRvbid0IHRhZyBkZWZhdWx0IGxpc3RlbmVyc1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmYXVsdFRhZyA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuUHJvdmlkZXJfLnN0b3BMaXN0ZW5pbmcoU3luY1RyZWUucXVlcnlGb3JMaXN0ZW5pbmdfKHF1ZXJ5KSwgZGVmYXVsdFRhZyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZW1vdmVkLmZvckVhY2goZnVuY3Rpb24gKHF1ZXJ5VG9SZW1vdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YWdUb1JlbW92ZSA9IF90aGlzLnF1ZXJ5VG9UYWdNYXBfW1N5bmNUcmVlLm1ha2VRdWVyeUtleV8ocXVlcnlUb1JlbW92ZSldO1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMubGlzdGVuUHJvdmlkZXJfLnN0b3BMaXN0ZW5pbmcoU3luY1RyZWUucXVlcnlGb3JMaXN0ZW5pbmdfKHF1ZXJ5VG9SZW1vdmUpLCB0YWdUb1JlbW92ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIE5vdywgY2xlYXIgYWxsIG9mIHRoZSB0YWdzIHdlJ3JlIHRyYWNraW5nIGZvciB0aGUgcmVtb3ZlZCBsaXN0ZW5zXG4gICAgICAgICAgICB0aGlzLnJlbW92ZVRhZ3NfKHJlbW92ZWQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gTm8tb3AsIHRoaXMgbGlzdGVuZXIgbXVzdCd2ZSBiZWVuIGFscmVhZHkgcmVtb3ZlZFxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjYW5jZWxFdmVudHM7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgY29tcGxldGUgY2FjaGUsIGlmIHdlIGhhdmUgb25lLCBvZiB0aGUgZGF0YSBhdCBhIHBhcnRpY3VsYXIgcGF0aC4gVGhlIGxvY2F0aW9uIG11c3QgaGF2ZSBhIGxpc3RlbmVyIGFib3ZlXG4gICAgICogaXQsIGJ1dCBhcyB0aGlzIGlzIG9ubHkgdXNlZCBieSB0cmFuc2FjdGlvbiBjb2RlLCB0aGF0IHNob3VsZCBhbHdheXMgYmUgdGhlIGNhc2UgYW55d2F5cy5cbiAgICAgKlxuICAgICAqIE5vdGU6IHRoaXMgbWV0aG9kIHdpbGwgKmluY2x1ZGUqIGhpZGRlbiB3cml0ZXMgZnJvbSB0cmFuc2FjdGlvbiB3aXRoIGFwcGx5TG9jYWxseSBzZXQgdG8gZmFsc2UuXG4gICAgICogQHBhcmFtIHshUGF0aH0gcGF0aCBUaGUgcGF0aCB0byB0aGUgZGF0YSB3ZSB3YW50XG4gICAgICogQHBhcmFtIHtBcnJheS48bnVtYmVyPj19IHdyaXRlSWRzVG9FeGNsdWRlIEEgc3BlY2lmaWMgc2V0IHRvIGJlIGV4Y2x1ZGVkXG4gICAgICogQHJldHVybiB7P05vZGV9XG4gICAgICovXG4gICAgU3luY1RyZWUucHJvdG90eXBlLmNhbGNDb21wbGV0ZUV2ZW50Q2FjaGUgPSBmdW5jdGlvbiAocGF0aCwgd3JpdGVJZHNUb0V4Y2x1ZGUpIHtcbiAgICAgICAgdmFyIGluY2x1ZGVIaWRkZW5TZXRzID0gdHJ1ZTtcbiAgICAgICAgdmFyIHdyaXRlVHJlZSA9IHRoaXMucGVuZGluZ1dyaXRlVHJlZV87XG4gICAgICAgIHZhciBzZXJ2ZXJDYWNoZSA9IHRoaXMuc3luY1BvaW50VHJlZV8uZmluZE9uUGF0aChwYXRoLCBmdW5jdGlvbiAocGF0aFNvRmFyLCBzeW5jUG9pbnQpIHtcbiAgICAgICAgICAgIHZhciByZWxhdGl2ZVBhdGggPSBQYXRoXzEuUGF0aC5yZWxhdGl2ZVBhdGgocGF0aFNvRmFyLCBwYXRoKTtcbiAgICAgICAgICAgIHZhciBzZXJ2ZXJDYWNoZSA9IHN5bmNQb2ludC5nZXRDb21wbGV0ZVNlcnZlckNhY2hlKHJlbGF0aXZlUGF0aCk7XG4gICAgICAgICAgICBpZiAoc2VydmVyQ2FjaGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VydmVyQ2FjaGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gd3JpdGVUcmVlLmNhbGNDb21wbGV0ZUV2ZW50Q2FjaGUocGF0aCwgc2VydmVyQ2FjaGUsIHdyaXRlSWRzVG9FeGNsdWRlLCBpbmNsdWRlSGlkZGVuU2V0cyk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBUaGlzIGNvbGxhcHNlcyBtdWx0aXBsZSB1bmZpbHRlcmVkIHZpZXdzIGludG8gYSBzaW5nbGUgdmlldywgc2luY2Ugd2Ugb25seSBuZWVkIGEgc2luZ2xlXG4gICAgICogbGlzdGVuZXIgZm9yIHRoZW0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyFJbW11dGFibGVUcmVlLjwhU3luY1BvaW50Pn0gc3VidHJlZVxuICAgICAqIEByZXR1cm4geyFBcnJheS48IVZpZXc+fVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgU3luY1RyZWUucHJvdG90eXBlLmNvbGxlY3REaXN0aW5jdFZpZXdzRm9yU3ViVHJlZV8gPSBmdW5jdGlvbiAoc3VidHJlZSkge1xuICAgICAgICByZXR1cm4gc3VidHJlZS5mb2xkKGZ1bmN0aW9uIChyZWxhdGl2ZVBhdGgsIG1heWJlQ2hpbGRTeW5jUG9pbnQsIGNoaWxkTWFwKSB7XG4gICAgICAgICAgICBpZiAobWF5YmVDaGlsZFN5bmNQb2ludCAmJiBtYXliZUNoaWxkU3luY1BvaW50Lmhhc0NvbXBsZXRlVmlldygpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbXBsZXRlVmlldyA9IG1heWJlQ2hpbGRTeW5jUG9pbnQuZ2V0Q29tcGxldGVWaWV3KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtjb21wbGV0ZVZpZXddO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gTm8gY29tcGxldGUgdmlldyBoZXJlLCBmbGF0dGVuIGFueSBkZWVwZXIgbGlzdGVucyBpbnRvIGFuIGFycmF5XG4gICAgICAgICAgICAgICAgdmFyIHZpZXdzXzEgPSBbXTtcbiAgICAgICAgICAgICAgICBpZiAobWF5YmVDaGlsZFN5bmNQb2ludCkge1xuICAgICAgICAgICAgICAgICAgICB2aWV3c18xID0gbWF5YmVDaGlsZFN5bmNQb2ludC5nZXRRdWVyeVZpZXdzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHV0aWxfMy5mb3JFYWNoKGNoaWxkTWFwLCBmdW5jdGlvbiAoa2V5LCBjaGlsZFZpZXdzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZpZXdzXzEgPSB2aWV3c18xLmNvbmNhdChjaGlsZFZpZXdzKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmlld3NfMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFBcnJheS48IVF1ZXJ5Pn0gcXVlcmllc1xuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgU3luY1RyZWUucHJvdG90eXBlLnJlbW92ZVRhZ3NfID0gZnVuY3Rpb24gKHF1ZXJpZXMpIHtcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBxdWVyaWVzLmxlbmd0aDsgKytqKSB7XG4gICAgICAgICAgICB2YXIgcmVtb3ZlZFF1ZXJ5ID0gcXVlcmllc1tqXTtcbiAgICAgICAgICAgIGlmICghcmVtb3ZlZFF1ZXJ5LmdldFF1ZXJ5UGFyYW1zKCkubG9hZHNBbGxEYXRhKCkpIHtcbiAgICAgICAgICAgICAgICAvLyBXZSBzaG91bGQgaGF2ZSBhIHRhZyBmb3IgdGhpc1xuICAgICAgICAgICAgICAgIHZhciByZW1vdmVkUXVlcnlLZXkgPSBTeW5jVHJlZS5tYWtlUXVlcnlLZXlfKHJlbW92ZWRRdWVyeSk7XG4gICAgICAgICAgICAgICAgdmFyIHJlbW92ZWRRdWVyeVRhZyA9IHRoaXMucXVlcnlUb1RhZ01hcF9bcmVtb3ZlZFF1ZXJ5S2V5XTtcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5xdWVyeVRvVGFnTWFwX1tyZW1vdmVkUXVlcnlLZXldO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnRhZ1RvUXVlcnlNYXBfWydfJyArIHJlbW92ZWRRdWVyeVRhZ107XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIE5vcm1hbGl6ZXMgYSBxdWVyeSB0byBhIHF1ZXJ5IHdlIHNlbmQgdGhlIHNlcnZlciBmb3IgbGlzdGVuaW5nXG4gICAgICogQHBhcmFtIHshUXVlcnl9IHF1ZXJ5XG4gICAgICogQHJldHVybiB7IVF1ZXJ5fSBUaGUgbm9ybWFsaXplZCBxdWVyeVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgU3luY1RyZWUucXVlcnlGb3JMaXN0ZW5pbmdfID0gZnVuY3Rpb24gKHF1ZXJ5KSB7XG4gICAgICAgIGlmIChxdWVyeS5nZXRRdWVyeVBhcmFtcygpLmxvYWRzQWxsRGF0YSgpICYmXG4gICAgICAgICAgICAhcXVlcnkuZ2V0UXVlcnlQYXJhbXMoKS5pc0RlZmF1bHQoKSkge1xuICAgICAgICAgICAgLy8gV2UgdHJlYXQgcXVlcmllcyB0aGF0IGxvYWQgYWxsIGRhdGEgYXMgZGVmYXVsdCBxdWVyaWVzXG4gICAgICAgICAgICAvLyBDYXN0IGlzIG5lY2Vzc2FyeSBiZWNhdXNlIHJlZigpIHRlY2huaWNhbGx5IHJldHVybnMgRmlyZWJhc2Ugd2hpY2ggaXMgYWN0dWFsbHkgZmIuYXBpLkZpcmViYXNlIHdoaWNoIGluaGVyaXRzXG4gICAgICAgICAgICAvLyBmcm9tIFF1ZXJ5XG4gICAgICAgICAgICByZXR1cm4gLyoqIEB0eXBlIHshUXVlcnl9ICovIHF1ZXJ5LmdldFJlZigpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHF1ZXJ5O1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBGb3IgYSBnaXZlbiBuZXcgbGlzdGVuLCBtYW5hZ2UgdGhlIGRlLWR1cGxpY2F0aW9uIG9mIG91dHN0YW5kaW5nIHN1YnNjcmlwdGlvbnMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyFRdWVyeX0gcXVlcnlcbiAgICAgKiBAcGFyYW0geyFWaWV3fSB2aWV3XG4gICAgICogQHJldHVybiB7IUFycmF5LjwhRXZlbnQ+fSBUaGlzIG1ldGhvZCBjYW4gcmV0dXJuIGV2ZW50cyB0byBzdXBwb3J0IHN5bmNocm9ub3VzIGRhdGEgc291cmNlc1xuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgU3luY1RyZWUucHJvdG90eXBlLnNldHVwTGlzdGVuZXJfID0gZnVuY3Rpb24gKHF1ZXJ5LCB2aWV3KSB7XG4gICAgICAgIHZhciBwYXRoID0gcXVlcnkucGF0aDtcbiAgICAgICAgdmFyIHRhZyA9IHRoaXMudGFnRm9yUXVlcnlfKHF1ZXJ5KTtcbiAgICAgICAgdmFyIGxpc3RlbmVyID0gdGhpcy5jcmVhdGVMaXN0ZW5lckZvclZpZXdfKHZpZXcpO1xuICAgICAgICB2YXIgZXZlbnRzID0gdGhpcy5saXN0ZW5Qcm92aWRlcl8uc3RhcnRMaXN0ZW5pbmcoU3luY1RyZWUucXVlcnlGb3JMaXN0ZW5pbmdfKHF1ZXJ5KSwgdGFnLCBsaXN0ZW5lci5oYXNoRm4sIGxpc3RlbmVyLm9uQ29tcGxldGUpO1xuICAgICAgICB2YXIgc3VidHJlZSA9IHRoaXMuc3luY1BvaW50VHJlZV8uc3VidHJlZShwYXRoKTtcbiAgICAgICAgLy8gVGhlIHJvb3Qgb2YgdGhpcyBzdWJ0cmVlIGhhcyBvdXIgcXVlcnkuIFdlJ3JlIGhlcmUgYmVjYXVzZSB3ZSBkZWZpbml0ZWx5IG5lZWQgdG8gc2VuZCBhIGxpc3RlbiBmb3IgdGhhdCwgYnV0IHdlXG4gICAgICAgIC8vIG1heSBuZWVkIHRvIHNoYWRvdyBvdGhlciBsaXN0ZW5zIGFzIHdlbGwuXG4gICAgICAgIGlmICh0YWcpIHtcbiAgICAgICAgICAgIHV0aWxfMS5hc3NlcnQoIXN1YnRyZWUudmFsdWUuaGFzQ29tcGxldGVWaWV3KCksIFwiSWYgd2UncmUgYWRkaW5nIGEgcXVlcnksIGl0IHNob3VsZG4ndCBiZSBzaGFkb3dlZFwiKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIFNoYWRvdyBldmVyeXRoaW5nIGF0IG9yIGJlbG93IHRoaXMgbG9jYXRpb24sIHRoaXMgaXMgYSBkZWZhdWx0IGxpc3RlbmVyLlxuICAgICAgICAgICAgdmFyIHF1ZXJpZXNUb1N0b3AgPSBzdWJ0cmVlLmZvbGQoZnVuY3Rpb24gKHJlbGF0aXZlUGF0aCwgbWF5YmVDaGlsZFN5bmNQb2ludCwgY2hpbGRNYXApIHtcbiAgICAgICAgICAgICAgICBpZiAoIXJlbGF0aXZlUGF0aC5pc0VtcHR5KCkgJiZcbiAgICAgICAgICAgICAgICAgICAgbWF5YmVDaGlsZFN5bmNQb2ludCAmJlxuICAgICAgICAgICAgICAgICAgICBtYXliZUNoaWxkU3luY1BvaW50Lmhhc0NvbXBsZXRlVmlldygpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbbWF5YmVDaGlsZFN5bmNQb2ludC5nZXRDb21wbGV0ZVZpZXcoKS5nZXRRdWVyeSgpXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIE5vIGRlZmF1bHQgbGlzdGVuZXIgaGVyZSwgZmxhdHRlbiBhbnkgZGVlcGVyIHF1ZXJpZXMgaW50byBhbiBhcnJheVxuICAgICAgICAgICAgICAgICAgICB2YXIgcXVlcmllc18xID0gW107XG4gICAgICAgICAgICAgICAgICAgIGlmIChtYXliZUNoaWxkU3luY1BvaW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBxdWVyaWVzXzEgPSBxdWVyaWVzXzEuY29uY2F0KG1heWJlQ2hpbGRTeW5jUG9pbnQuZ2V0UXVlcnlWaWV3cygpLm1hcChmdW5jdGlvbiAodmlldykgeyByZXR1cm4gdmlldy5nZXRRdWVyeSgpOyB9KSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdXRpbF8zLmZvckVhY2goY2hpbGRNYXAsIGZ1bmN0aW9uIChrZXksIGNoaWxkUXVlcmllcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcmllc18xID0gcXVlcmllc18xLmNvbmNhdChjaGlsZFF1ZXJpZXMpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHF1ZXJpZXNfMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcXVlcmllc1RvU3RvcC5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICAgIHZhciBxdWVyeVRvU3RvcCA9IHF1ZXJpZXNUb1N0b3BbaV07XG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5Qcm92aWRlcl8uc3RvcExpc3RlbmluZyhTeW5jVHJlZS5xdWVyeUZvckxpc3RlbmluZ18ocXVlcnlUb1N0b3ApLCB0aGlzLnRhZ0ZvclF1ZXJ5XyhxdWVyeVRvU3RvcCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBldmVudHM7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7IVZpZXd9IHZpZXdcbiAgICAgKiBAcmV0dXJuIHt7aGFzaEZuOiBmdW5jdGlvbigpLCBvbkNvbXBsZXRlOiBmdW5jdGlvbighc3RyaW5nLCAqKX19XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBTeW5jVHJlZS5wcm90b3R5cGUuY3JlYXRlTGlzdGVuZXJGb3JWaWV3XyA9IGZ1bmN0aW9uICh2aWV3KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBxdWVyeSA9IHZpZXcuZ2V0UXVlcnkoKTtcbiAgICAgICAgdmFyIHRhZyA9IHRoaXMudGFnRm9yUXVlcnlfKHF1ZXJ5KTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGhhc2hGbjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBjYWNoZSA9IHZpZXcuZ2V0U2VydmVyQ2FjaGUoKSB8fCBDaGlsZHJlbk5vZGVfMS5DaGlsZHJlbk5vZGUuRU1QVFlfTk9ERTtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FjaGUuaGFzaCgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG9uQ29tcGxldGU6IGZ1bmN0aW9uIChzdGF0dXMpIHtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdHVzID09PSAnb2snKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0YWcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5hcHBseVRhZ2dlZExpc3RlbkNvbXBsZXRlKHF1ZXJ5LnBhdGgsIHRhZyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuYXBwbHlMaXN0ZW5Db21wbGV0ZShxdWVyeS5wYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgYSBsaXN0ZW4gZmFpbGVkLCBraWxsIGFsbCBvZiB0aGUgbGlzdGVuZXJzIGhlcmUsIG5vdCBqdXN0IHRoZSBvbmUgdGhhdCB0cmlnZ2VyZWQgdGhlIGVycm9yLlxuICAgICAgICAgICAgICAgICAgICAvLyBOb3RlIHRoYXQgdGhpcyBtYXkgbmVlZCB0byBiZSBzY29wZWQgdG8ganVzdCB0aGlzIGxpc3RlbmVyIGlmIHdlIGNoYW5nZSBwZXJtaXNzaW9ucyBvbiBmaWx0ZXJlZCBjaGlsZHJlblxuICAgICAgICAgICAgICAgICAgICB2YXIgZXJyb3IgPSB1dGlsXzIuZXJyb3JGb3JTZXJ2ZXJDb2RlKHN0YXR1cywgcXVlcnkpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMucmVtb3ZlRXZlbnRSZWdpc3RyYXRpb24ocXVlcnksIFxuICAgICAgICAgICAgICAgICAgICAvKmV2ZW50UmVnaXN0cmF0aW9uKi8gbnVsbCwgZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdpdmVuIGEgcXVlcnksIGNvbXB1dGVzIGEgXCJxdWVyeUtleVwiIHN1aXRhYmxlIGZvciB1c2UgaW4gb3VyIHF1ZXJ5VG9UYWdNYXBfLlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHshUXVlcnl9IHF1ZXJ5XG4gICAgICogQHJldHVybiB7c3RyaW5nfVxuICAgICAqL1xuICAgIFN5bmNUcmVlLm1ha2VRdWVyeUtleV8gPSBmdW5jdGlvbiAocXVlcnkpIHtcbiAgICAgICAgcmV0dXJuIHF1ZXJ5LnBhdGgudG9TdHJpbmcoKSArICckJyArIHF1ZXJ5LnF1ZXJ5SWRlbnRpZmllcigpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2l2ZW4gYSBxdWVyeUtleSAoY3JlYXRlZCBieSBtYWtlUXVlcnlLZXkpLCBwYXJzZSBpdCBiYWNrIGludG8gYSBwYXRoIGFuZCBxdWVyeUlkLlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHshc3RyaW5nfSBxdWVyeUtleVxuICAgICAqIEByZXR1cm4ge3txdWVyeUlkOiAhc3RyaW5nLCBwYXRoOiAhUGF0aH19XG4gICAgICovXG4gICAgU3luY1RyZWUucGFyc2VRdWVyeUtleV8gPSBmdW5jdGlvbiAocXVlcnlLZXkpIHtcbiAgICAgICAgdmFyIHNwbGl0SW5kZXggPSBxdWVyeUtleS5pbmRleE9mKCckJyk7XG4gICAgICAgIHV0aWxfMS5hc3NlcnQoc3BsaXRJbmRleCAhPT0gLTEgJiYgc3BsaXRJbmRleCA8IHF1ZXJ5S2V5Lmxlbmd0aCAtIDEsICdCYWQgcXVlcnlLZXkuJyk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBxdWVyeUlkOiBxdWVyeUtleS5zdWJzdHIoc3BsaXRJbmRleCArIDEpLFxuICAgICAgICAgICAgcGF0aDogbmV3IFBhdGhfMS5QYXRoKHF1ZXJ5S2V5LnN1YnN0cigwLCBzcGxpdEluZGV4KSlcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgcXVlcnkgYXNzb2NpYXRlZCB3aXRoIHRoZSBnaXZlbiB0YWcsIGlmIHdlIGhhdmUgb25lXG4gICAgICogQHBhcmFtIHshbnVtYmVyfSB0YWdcbiAgICAgKiBAcmV0dXJuIHs/c3RyaW5nfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgU3luY1RyZWUucHJvdG90eXBlLnF1ZXJ5S2V5Rm9yVGFnXyA9IGZ1bmN0aW9uICh0YWcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudGFnVG9RdWVyeU1hcF9bJ18nICsgdGFnXTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgdGFnIGFzc29jaWF0ZWQgd2l0aCB0aGUgZ2l2ZW4gcXVlcnkuXG4gICAgICogQHBhcmFtIHshUXVlcnl9IHF1ZXJ5XG4gICAgICogQHJldHVybiB7P251bWJlcn1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIFN5bmNUcmVlLnByb3RvdHlwZS50YWdGb3JRdWVyeV8gPSBmdW5jdGlvbiAocXVlcnkpIHtcbiAgICAgICAgdmFyIHF1ZXJ5S2V5ID0gU3luY1RyZWUubWFrZVF1ZXJ5S2V5XyhxdWVyeSk7XG4gICAgICAgIHJldHVybiB1dGlsXzMuc2FmZUdldCh0aGlzLnF1ZXJ5VG9UYWdNYXBfLCBxdWVyeUtleSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBTdGF0aWMgYWNjZXNzb3IgZm9yIHF1ZXJ5IHRhZ3MuXG4gICAgICogQHJldHVybiB7bnVtYmVyfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgU3luY1RyZWUuZ2V0TmV4dFF1ZXJ5VGFnXyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFN5bmNUcmVlLm5leHRRdWVyeVRhZ18rKztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEEgaGVscGVyIG1ldGhvZCB0byBhcHBseSB0YWdnZWQgb3BlcmF0aW9uc1xuICAgICAqXG4gICAgICogQHBhcmFtIHshUGF0aH0gcXVlcnlQYXRoXG4gICAgICogQHBhcmFtIHshT3BlcmF0aW9ufSBvcGVyYXRpb25cbiAgICAgKiBAcmV0dXJuIHshQXJyYXkuPCFFdmVudD59XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBTeW5jVHJlZS5wcm90b3R5cGUuYXBwbHlUYWdnZWRPcGVyYXRpb25fID0gZnVuY3Rpb24gKHF1ZXJ5UGF0aCwgb3BlcmF0aW9uKSB7XG4gICAgICAgIHZhciBzeW5jUG9pbnQgPSB0aGlzLnN5bmNQb2ludFRyZWVfLmdldChxdWVyeVBhdGgpO1xuICAgICAgICB1dGlsXzEuYXNzZXJ0KHN5bmNQb2ludCwgXCJNaXNzaW5nIHN5bmMgcG9pbnQgZm9yIHF1ZXJ5IHRhZyB0aGF0IHdlJ3JlIHRyYWNraW5nXCIpO1xuICAgICAgICB2YXIgd3JpdGVzQ2FjaGUgPSB0aGlzLnBlbmRpbmdXcml0ZVRyZWVfLmNoaWxkV3JpdGVzKHF1ZXJ5UGF0aCk7XG4gICAgICAgIHJldHVybiBzeW5jUG9pbnQuYXBwbHlPcGVyYXRpb24ob3BlcmF0aW9uLCB3cml0ZXNDYWNoZSwgXG4gICAgICAgIC8qc2VydmVyQ2FjaGU9Ki8gbnVsbCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBBIGhlbHBlciBtZXRob2QgdGhhdCB2aXNpdHMgYWxsIGRlc2NlbmRhbnQgYW5kIGFuY2VzdG9yIFN5bmNQb2ludHMsIGFwcGx5aW5nIHRoZSBvcGVyYXRpb24uXG4gICAgICpcbiAgICAgKiBOT1RFUzpcbiAgICAgKiAtIERlc2NlbmRhbnQgU3luY1BvaW50cyB3aWxsIGJlIHZpc2l0ZWQgZmlyc3QgKHNpbmNlIHdlIHJhaXNlIGV2ZW50cyBkZXB0aC1maXJzdCkuXG4gIFxuICAgICAqIC0gV2UgY2FsbCBhcHBseU9wZXJhdGlvbigpIG9uIGVhY2ggU3luY1BvaW50IHBhc3NpbmcgdGhyZWUgdGhpbmdzOlxuICAgICAqICAgMS4gQSB2ZXJzaW9uIG9mIHRoZSBPcGVyYXRpb24gdGhhdCBoYXMgYmVlbiBtYWRlIHJlbGF0aXZlIHRvIHRoZSBTeW5jUG9pbnQgbG9jYXRpb24uXG4gICAgICogICAyLiBBIFdyaXRlVHJlZVJlZiBvZiBhbnkgd3JpdGVzIHdlIGhhdmUgY2FjaGVkIGF0IHRoZSBTeW5jUG9pbnQgbG9jYXRpb24uXG4gICAgICogICAzLiBBIHNuYXBzaG90IE5vZGUgd2l0aCBjYWNoZWQgc2VydmVyIGRhdGEsIGlmIHdlIGhhdmUgaXQuXG4gIFxuICAgICAqIC0gV2UgY29uY2F0ZW5hdGUgYWxsIG9mIHRoZSBldmVudHMgcmV0dXJuZWQgYnkgZWFjaCBTeW5jUG9pbnQgYW5kIHJldHVybiB0aGUgcmVzdWx0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHshT3BlcmF0aW9ufSBvcGVyYXRpb25cbiAgICAgKiBAcmV0dXJuIHshQXJyYXkuPCFFdmVudD59XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBTeW5jVHJlZS5wcm90b3R5cGUuYXBwbHlPcGVyYXRpb25Ub1N5bmNQb2ludHNfID0gZnVuY3Rpb24gKG9wZXJhdGlvbikge1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBseU9wZXJhdGlvbkhlbHBlcl8ob3BlcmF0aW9uLCB0aGlzLnN5bmNQb2ludFRyZWVfLCBcbiAgICAgICAgLypzZXJ2ZXJDYWNoZT0qLyBudWxsLCB0aGlzLnBlbmRpbmdXcml0ZVRyZWVfLmNoaWxkV3JpdGVzKFBhdGhfMS5QYXRoLkVtcHR5KSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZWN1cnNpdmUgaGVscGVyIGZvciBhcHBseU9wZXJhdGlvblRvU3luY1BvaW50c19cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHshT3BlcmF0aW9ufSBvcGVyYXRpb25cbiAgICAgKiBAcGFyYW0ge0ltbXV0YWJsZVRyZWUuPCFTeW5jUG9pbnQ+fSBzeW5jUG9pbnRUcmVlXG4gICAgICogQHBhcmFtIHs/Tm9kZX0gc2VydmVyQ2FjaGVcbiAgICAgKiBAcGFyYW0geyFXcml0ZVRyZWVSZWZ9IHdyaXRlc0NhY2hlXG4gICAgICogQHJldHVybiB7IUFycmF5LjwhRXZlbnQ+fVxuICAgICAqL1xuICAgIFN5bmNUcmVlLnByb3RvdHlwZS5hcHBseU9wZXJhdGlvbkhlbHBlcl8gPSBmdW5jdGlvbiAob3BlcmF0aW9uLCBzeW5jUG9pbnRUcmVlLCBzZXJ2ZXJDYWNoZSwgd3JpdGVzQ2FjaGUpIHtcbiAgICAgICAgaWYgKG9wZXJhdGlvbi5wYXRoLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlPcGVyYXRpb25EZXNjZW5kYW50c0hlbHBlcl8ob3BlcmF0aW9uLCBzeW5jUG9pbnRUcmVlLCBzZXJ2ZXJDYWNoZSwgd3JpdGVzQ2FjaGUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIHN5bmNQb2ludCA9IHN5bmNQb2ludFRyZWUuZ2V0KFBhdGhfMS5QYXRoLkVtcHR5KTtcbiAgICAgICAgICAgIC8vIElmIHdlIGRvbid0IGhhdmUgY2FjaGVkIHNlcnZlciBkYXRhLCBzZWUgaWYgd2UgY2FuIGdldCBpdCBmcm9tIHRoaXMgU3luY1BvaW50LlxuICAgICAgICAgICAgaWYgKHNlcnZlckNhY2hlID09IG51bGwgJiYgc3luY1BvaW50ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBzZXJ2ZXJDYWNoZSA9IHN5bmNQb2ludC5nZXRDb21wbGV0ZVNlcnZlckNhY2hlKFBhdGhfMS5QYXRoLkVtcHR5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBldmVudHMgPSBbXTtcbiAgICAgICAgICAgIHZhciBjaGlsZE5hbWUgPSBvcGVyYXRpb24ucGF0aC5nZXRGcm9udCgpO1xuICAgICAgICAgICAgdmFyIGNoaWxkT3BlcmF0aW9uID0gb3BlcmF0aW9uLm9wZXJhdGlvbkZvckNoaWxkKGNoaWxkTmFtZSk7XG4gICAgICAgICAgICB2YXIgY2hpbGRUcmVlID0gc3luY1BvaW50VHJlZS5jaGlsZHJlbi5nZXQoY2hpbGROYW1lKTtcbiAgICAgICAgICAgIGlmIChjaGlsZFRyZWUgJiYgY2hpbGRPcGVyYXRpb24pIHtcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRTZXJ2ZXJDYWNoZSA9IHNlcnZlckNhY2hlXG4gICAgICAgICAgICAgICAgICAgID8gc2VydmVyQ2FjaGUuZ2V0SW1tZWRpYXRlQ2hpbGQoY2hpbGROYW1lKVxuICAgICAgICAgICAgICAgICAgICA6IG51bGw7XG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkV3JpdGVzQ2FjaGUgPSB3cml0ZXNDYWNoZS5jaGlsZChjaGlsZE5hbWUpO1xuICAgICAgICAgICAgICAgIGV2ZW50cyA9IGV2ZW50cy5jb25jYXQodGhpcy5hcHBseU9wZXJhdGlvbkhlbHBlcl8oY2hpbGRPcGVyYXRpb24sIGNoaWxkVHJlZSwgY2hpbGRTZXJ2ZXJDYWNoZSwgY2hpbGRXcml0ZXNDYWNoZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHN5bmNQb2ludCkge1xuICAgICAgICAgICAgICAgIGV2ZW50cyA9IGV2ZW50cy5jb25jYXQoc3luY1BvaW50LmFwcGx5T3BlcmF0aW9uKG9wZXJhdGlvbiwgd3JpdGVzQ2FjaGUsIHNlcnZlckNhY2hlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZXZlbnRzO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZWN1cnNpdmUgaGVscGVyIGZvciBhcHBseU9wZXJhdGlvblRvU3luY1BvaW50c19cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHshT3BlcmF0aW9ufSBvcGVyYXRpb25cbiAgICAgKiBAcGFyYW0ge0ltbXV0YWJsZVRyZWUuPCFTeW5jUG9pbnQ+fSBzeW5jUG9pbnRUcmVlXG4gICAgICogQHBhcmFtIHs/Tm9kZX0gc2VydmVyQ2FjaGVcbiAgICAgKiBAcGFyYW0geyFXcml0ZVRyZWVSZWZ9IHdyaXRlc0NhY2hlXG4gICAgICogQHJldHVybiB7IUFycmF5LjwhRXZlbnQ+fVxuICAgICAqL1xuICAgIFN5bmNUcmVlLnByb3RvdHlwZS5hcHBseU9wZXJhdGlvbkRlc2NlbmRhbnRzSGVscGVyXyA9IGZ1bmN0aW9uIChvcGVyYXRpb24sIHN5bmNQb2ludFRyZWUsIHNlcnZlckNhY2hlLCB3cml0ZXNDYWNoZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgc3luY1BvaW50ID0gc3luY1BvaW50VHJlZS5nZXQoUGF0aF8xLlBhdGguRW1wdHkpO1xuICAgICAgICAvLyBJZiB3ZSBkb24ndCBoYXZlIGNhY2hlZCBzZXJ2ZXIgZGF0YSwgc2VlIGlmIHdlIGNhbiBnZXQgaXQgZnJvbSB0aGlzIFN5bmNQb2ludC5cbiAgICAgICAgaWYgKHNlcnZlckNhY2hlID09IG51bGwgJiYgc3luY1BvaW50ICE9IG51bGwpIHtcbiAgICAgICAgICAgIHNlcnZlckNhY2hlID0gc3luY1BvaW50LmdldENvbXBsZXRlU2VydmVyQ2FjaGUoUGF0aF8xLlBhdGguRW1wdHkpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBldmVudHMgPSBbXTtcbiAgICAgICAgc3luY1BvaW50VHJlZS5jaGlsZHJlbi5pbm9yZGVyVHJhdmVyc2FsKGZ1bmN0aW9uIChjaGlsZE5hbWUsIGNoaWxkVHJlZSkge1xuICAgICAgICAgICAgdmFyIGNoaWxkU2VydmVyQ2FjaGUgPSBzZXJ2ZXJDYWNoZVxuICAgICAgICAgICAgICAgID8gc2VydmVyQ2FjaGUuZ2V0SW1tZWRpYXRlQ2hpbGQoY2hpbGROYW1lKVxuICAgICAgICAgICAgICAgIDogbnVsbDtcbiAgICAgICAgICAgIHZhciBjaGlsZFdyaXRlc0NhY2hlID0gd3JpdGVzQ2FjaGUuY2hpbGQoY2hpbGROYW1lKTtcbiAgICAgICAgICAgIHZhciBjaGlsZE9wZXJhdGlvbiA9IG9wZXJhdGlvbi5vcGVyYXRpb25Gb3JDaGlsZChjaGlsZE5hbWUpO1xuICAgICAgICAgICAgaWYgKGNoaWxkT3BlcmF0aW9uKSB7XG4gICAgICAgICAgICAgICAgZXZlbnRzID0gZXZlbnRzLmNvbmNhdChfdGhpcy5hcHBseU9wZXJhdGlvbkRlc2NlbmRhbnRzSGVscGVyXyhjaGlsZE9wZXJhdGlvbiwgY2hpbGRUcmVlLCBjaGlsZFNlcnZlckNhY2hlLCBjaGlsZFdyaXRlc0NhY2hlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoc3luY1BvaW50KSB7XG4gICAgICAgICAgICBldmVudHMgPSBldmVudHMuY29uY2F0KHN5bmNQb2ludC5hcHBseU9wZXJhdGlvbihvcGVyYXRpb24sIHdyaXRlc0NhY2hlLCBzZXJ2ZXJDYWNoZSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBldmVudHM7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBTdGF0aWMgdHJhY2tlciBmb3IgbmV4dCBxdWVyeSB0YWcuXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIFN5bmNUcmVlLm5leHRRdWVyeVRhZ18gPSAxO1xuICAgIHJldHVybiBTeW5jVHJlZTtcbn0oKSk7XG5leHBvcnRzLlN5bmNUcmVlID0gU3luY1RyZWU7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVN5bmNUcmVlLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHV0aWxfMSA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvdXRpbFwiKTtcbnZhciB1dGlsXzIgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG52YXIgUGF0aF8xID0gcmVxdWlyZShcIi4vdXRpbC9QYXRoXCIpO1xudmFyIENvbXBvdW5kV3JpdGVfMSA9IHJlcXVpcmUoXCIuL0NvbXBvdW5kV3JpdGVcIik7XG52YXIgUHJpb3JpdHlJbmRleF8xID0gcmVxdWlyZShcIi4vc25hcC9pbmRleGVzL1ByaW9yaXR5SW5kZXhcIik7XG52YXIgQ2hpbGRyZW5Ob2RlXzEgPSByZXF1aXJlKFwiLi9zbmFwL0NoaWxkcmVuTm9kZVwiKTtcbi8qKlxuICogV3JpdGVUcmVlIHRyYWNrcyBhbGwgcGVuZGluZyB1c2VyLWluaXRpYXRlZCB3cml0ZXMgYW5kIGhhcyBtZXRob2RzIHRvIGNhbGN1bGF0ZSB0aGUgcmVzdWx0IG9mIG1lcmdpbmcgdGhlbVxuICogd2l0aCB1bmRlcmx5aW5nIHNlcnZlciBkYXRhICh0byBjcmVhdGUgXCJldmVudCBjYWNoZVwiIGRhdGEpLiAgUGVuZGluZyB3cml0ZXMgYXJlIGFkZGVkIHdpdGggYWRkT3ZlcndyaXRlKClcbiAqIGFuZCBhZGRNZXJnZSgpLCBhbmQgcmVtb3ZlZCB3aXRoIHJlbW92ZVdyaXRlKCkuXG4gKlxuICogQGNvbnN0cnVjdG9yXG4gKi9cbnZhciBXcml0ZVRyZWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gV3JpdGVUcmVlKCkge1xuICAgICAgICAvKipcbiAgICAgICAgICogQSB0cmVlIHRyYWNraW5nIHRoZSByZXN1bHQgb2YgYXBwbHlpbmcgYWxsIHZpc2libGUgd3JpdGVzLiAgVGhpcyBkb2VzIG5vdCBpbmNsdWRlIHRyYW5zYWN0aW9ucyB3aXRoXG4gICAgICAgICAqIGFwcGx5TG9jYWxseT1mYWxzZSBvciB3cml0ZXMgdGhhdCBhcmUgY29tcGxldGVseSBzaGFkb3dlZCBieSBvdGhlciB3cml0ZXMuXG4gICAgICAgICAqXG4gICAgICAgICAqIEB0eXBlIHshQ29tcG91bmRXcml0ZX1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudmlzaWJsZVdyaXRlc18gPSBDb21wb3VuZFdyaXRlXzEuQ29tcG91bmRXcml0ZS5FbXB0eTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgbGlzdCBvZiBhbGwgcGVuZGluZyB3cml0ZXMsIHJlZ2FyZGxlc3Mgb2YgdmlzaWJpbGl0eSBhbmQgc2hhZG93ZWQtbmVzcy4gIFVzZWQgdG8gY2FsY3VsYXRlIGFyYml0cmFyeVxuICAgICAgICAgKiBzZXRzIG9mIHRoZSBjaGFuZ2VkIGRhdGEsIHN1Y2ggYXMgaGlkZGVuIHdyaXRlcyAoZnJvbSB0cmFuc2FjdGlvbnMpIG9yIGNoYW5nZXMgd2l0aCBjZXJ0YWluIHdyaXRlcyBleGNsdWRlZCAoYWxzb1xuICAgICAgICAgKiB1c2VkIGJ5IHRyYW5zYWN0aW9ucykuXG4gICAgICAgICAqXG4gICAgICAgICAqIEB0eXBlIHshQXJyYXkuPCFXcml0ZVJlY29yZD59XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmFsbFdyaXRlc18gPSBbXTtcbiAgICAgICAgdGhpcy5sYXN0V3JpdGVJZF8gPSAtMTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgbmV3IFdyaXRlVHJlZVJlZiBmb3IgdGhlIGdpdmVuIHBhdGguIEZvciB1c2Ugd2l0aCBhIG5ldyBzeW5jIHBvaW50IGF0IHRoZSBnaXZlbiBwYXRoLlxuICAgICAqXG4gICAgICogQHBhcmFtIHshUGF0aH0gcGF0aFxuICAgICAqIEByZXR1cm4geyFXcml0ZVRyZWVSZWZ9XG4gICAgICovXG4gICAgV3JpdGVUcmVlLnByb3RvdHlwZS5jaGlsZFdyaXRlcyA9IGZ1bmN0aW9uIChwYXRoKSB7XG4gICAgICAgIHJldHVybiBuZXcgV3JpdGVUcmVlUmVmKHBhdGgsIHRoaXMpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUmVjb3JkIGEgbmV3IG92ZXJ3cml0ZSBmcm9tIHVzZXIgY29kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7IVBhdGh9IHBhdGhcbiAgICAgKiBAcGFyYW0geyFOb2RlfSBzbmFwXG4gICAgICogQHBhcmFtIHshbnVtYmVyfSB3cml0ZUlkXG4gICAgICogQHBhcmFtIHtib29sZWFuPX0gdmlzaWJsZSBUaGlzIGlzIHNldCB0byBmYWxzZSBieSBzb21lIHRyYW5zYWN0aW9ucy4gSXQgc2hvdWxkIGJlIGV4Y2x1ZGVkIGZyb20gZXZlbnQgY2FjaGVzXG4gICAgICovXG4gICAgV3JpdGVUcmVlLnByb3RvdHlwZS5hZGRPdmVyd3JpdGUgPSBmdW5jdGlvbiAocGF0aCwgc25hcCwgd3JpdGVJZCwgdmlzaWJsZSkge1xuICAgICAgICB1dGlsXzIuYXNzZXJ0KHdyaXRlSWQgPiB0aGlzLmxhc3RXcml0ZUlkXywgJ1N0YWNraW5nIGFuIG9sZGVyIHdyaXRlIG9uIHRvcCBvZiBuZXdlciBvbmVzJyk7XG4gICAgICAgIGlmICh2aXNpYmxlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZpc2libGUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYWxsV3JpdGVzXy5wdXNoKHtcbiAgICAgICAgICAgIHBhdGg6IHBhdGgsXG4gICAgICAgICAgICBzbmFwOiBzbmFwLFxuICAgICAgICAgICAgd3JpdGVJZDogd3JpdGVJZCxcbiAgICAgICAgICAgIHZpc2libGU6IHZpc2libGVcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh2aXNpYmxlKSB7XG4gICAgICAgICAgICB0aGlzLnZpc2libGVXcml0ZXNfID0gdGhpcy52aXNpYmxlV3JpdGVzXy5hZGRXcml0ZShwYXRoLCBzbmFwKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmxhc3RXcml0ZUlkXyA9IHdyaXRlSWQ7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZWNvcmQgYSBuZXcgbWVyZ2UgZnJvbSB1c2VyIGNvZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyFQYXRofSBwYXRoXG4gICAgICogQHBhcmFtIHshT2JqZWN0LjxzdHJpbmcsICFOb2RlPn0gY2hhbmdlZENoaWxkcmVuXG4gICAgICogQHBhcmFtIHshbnVtYmVyfSB3cml0ZUlkXG4gICAgICovXG4gICAgV3JpdGVUcmVlLnByb3RvdHlwZS5hZGRNZXJnZSA9IGZ1bmN0aW9uIChwYXRoLCBjaGFuZ2VkQ2hpbGRyZW4sIHdyaXRlSWQpIHtcbiAgICAgICAgdXRpbF8yLmFzc2VydCh3cml0ZUlkID4gdGhpcy5sYXN0V3JpdGVJZF8sICdTdGFja2luZyBhbiBvbGRlciBtZXJnZSBvbiB0b3Agb2YgbmV3ZXIgb25lcycpO1xuICAgICAgICB0aGlzLmFsbFdyaXRlc18ucHVzaCh7XG4gICAgICAgICAgICBwYXRoOiBwYXRoLFxuICAgICAgICAgICAgY2hpbGRyZW46IGNoYW5nZWRDaGlsZHJlbixcbiAgICAgICAgICAgIHdyaXRlSWQ6IHdyaXRlSWQsXG4gICAgICAgICAgICB2aXNpYmxlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnZpc2libGVXcml0ZXNfID0gdGhpcy52aXNpYmxlV3JpdGVzXy5hZGRXcml0ZXMocGF0aCwgY2hhbmdlZENoaWxkcmVuKTtcbiAgICAgICAgdGhpcy5sYXN0V3JpdGVJZF8gPSB3cml0ZUlkO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshbnVtYmVyfSB3cml0ZUlkXG4gICAgICogQHJldHVybiB7P1dyaXRlUmVjb3JkfVxuICAgICAqL1xuICAgIFdyaXRlVHJlZS5wcm90b3R5cGUuZ2V0V3JpdGUgPSBmdW5jdGlvbiAod3JpdGVJZCkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuYWxsV3JpdGVzXy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIHJlY29yZCA9IHRoaXMuYWxsV3JpdGVzX1tpXTtcbiAgICAgICAgICAgIGlmIChyZWNvcmQud3JpdGVJZCA9PT0gd3JpdGVJZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZWNvcmQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZW1vdmUgYSB3cml0ZSAoZWl0aGVyIGFuIG92ZXJ3cml0ZSBvciBtZXJnZSkgdGhhdCBoYXMgYmVlbiBzdWNjZXNzZnVsbHkgYWNrbm93bGVkZ2UgYnkgdGhlIHNlcnZlci4gUmVjYWxjdWxhdGVzXG4gICAgICogdGhlIHRyZWUgaWYgbmVjZXNzYXJ5LiAgV2UgcmV0dXJuIHRydWUgaWYgaXQgbWF5IGhhdmUgYmVlbiB2aXNpYmxlLCBtZWFuaW5nIHZpZXdzIG5lZWQgdG8gcmVldmFsdWF0ZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7IW51bWJlcn0gd3JpdGVJZFxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IHRydWUgaWYgdGhlIHdyaXRlIG1heSBoYXZlIGJlZW4gdmlzaWJsZSAobWVhbmluZyB3ZSdsbCBuZWVkIHRvIHJlZXZhbHVhdGUgLyByYWlzZVxuICAgICAqIGV2ZW50cyBhcyBhIHJlc3VsdCkuXG4gICAgICovXG4gICAgV3JpdGVUcmVlLnByb3RvdHlwZS5yZW1vdmVXcml0ZSA9IGZ1bmN0aW9uICh3cml0ZUlkKSB7XG4gICAgICAgIC8vIE5vdGU6IGRpc2FibGluZyB0aGlzIGNoZWNrLiBJdCBjb3VsZCBiZSBhIHRyYW5zYWN0aW9uIHRoYXQgcHJlZW1wdGVkIGFub3RoZXIgdHJhbnNhY3Rpb24sIGFuZCB0aHVzIHdhcyBhcHBsaWVkXG4gICAgICAgIC8vIG91dCBvZiBvcmRlci5cbiAgICAgICAgLy9jb25zdCB2YWxpZENsZWFyID0gcmV2ZXJ0IHx8IHRoaXMuYWxsV3JpdGVzXy5sZW5ndGggPT09IDAgfHwgd3JpdGVJZCA8PSB0aGlzLmFsbFdyaXRlc19bMF0ud3JpdGVJZDtcbiAgICAgICAgLy9hc3NlcnQodmFsaWRDbGVhciwgXCJFaXRoZXIgd2UgZG9uJ3QgaGF2ZSB0aGlzIHdyaXRlLCBvciBpdCdzIHRoZSBmaXJzdCBvbmUgaW4gdGhlIHF1ZXVlXCIpO1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgaWR4ID0gdGhpcy5hbGxXcml0ZXNfLmZpbmRJbmRleChmdW5jdGlvbiAocykge1xuICAgICAgICAgICAgcmV0dXJuIHMud3JpdGVJZCA9PT0gd3JpdGVJZDtcbiAgICAgICAgfSk7XG4gICAgICAgIHV0aWxfMi5hc3NlcnQoaWR4ID49IDAsICdyZW1vdmVXcml0ZSBjYWxsZWQgd2l0aCBub25leGlzdGVudCB3cml0ZUlkLicpO1xuICAgICAgICB2YXIgd3JpdGVUb1JlbW92ZSA9IHRoaXMuYWxsV3JpdGVzX1tpZHhdO1xuICAgICAgICB0aGlzLmFsbFdyaXRlc18uc3BsaWNlKGlkeCwgMSk7XG4gICAgICAgIHZhciByZW1vdmVkV3JpdGVXYXNWaXNpYmxlID0gd3JpdGVUb1JlbW92ZS52aXNpYmxlO1xuICAgICAgICB2YXIgcmVtb3ZlZFdyaXRlT3ZlcmxhcHNXaXRoT3RoZXJXcml0ZXMgPSBmYWxzZTtcbiAgICAgICAgdmFyIGkgPSB0aGlzLmFsbFdyaXRlc18ubGVuZ3RoIC0gMTtcbiAgICAgICAgd2hpbGUgKHJlbW92ZWRXcml0ZVdhc1Zpc2libGUgJiYgaSA+PSAwKSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudFdyaXRlID0gdGhpcy5hbGxXcml0ZXNfW2ldO1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRXcml0ZS52aXNpYmxlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGkgPj0gaWR4ICYmXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVjb3JkQ29udGFpbnNQYXRoXyhjdXJyZW50V3JpdGUsIHdyaXRlVG9SZW1vdmUucGF0aCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhlIHJlbW92ZWQgd3JpdGUgd2FzIGNvbXBsZXRlbHkgc2hhZG93ZWQgYnkgYSBzdWJzZXF1ZW50IHdyaXRlLlxuICAgICAgICAgICAgICAgICAgICByZW1vdmVkV3JpdGVXYXNWaXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHdyaXRlVG9SZW1vdmUucGF0aC5jb250YWlucyhjdXJyZW50V3JpdGUucGF0aCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gRWl0aGVyIHdlJ3JlIGNvdmVyaW5nIHNvbWUgd3JpdGVzIG9yIHRoZXkncmUgY292ZXJpbmcgcGFydCBvZiB1cyAoZGVwZW5kaW5nIG9uIHdoaWNoIGNhbWUgZmlyc3QpLlxuICAgICAgICAgICAgICAgICAgICByZW1vdmVkV3JpdGVPdmVybGFwc1dpdGhPdGhlcldyaXRlcyA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaS0tO1xuICAgICAgICB9XG4gICAgICAgIGlmICghcmVtb3ZlZFdyaXRlV2FzVmlzaWJsZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHJlbW92ZWRXcml0ZU92ZXJsYXBzV2l0aE90aGVyV3JpdGVzKSB7XG4gICAgICAgICAgICAvLyBUaGVyZSdzIHNvbWUgc2hhZG93aW5nIGdvaW5nIG9uLiBKdXN0IHJlYnVpbGQgdGhlIHZpc2libGUgd3JpdGVzIGZyb20gc2NyYXRjaC5cbiAgICAgICAgICAgIHRoaXMucmVzZXRUcmVlXygpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBUaGVyZSdzIG5vIHNoYWRvd2luZy4gIFdlIGNhbiBzYWZlbHkganVzdCByZW1vdmUgdGhlIHdyaXRlKHMpIGZyb20gdmlzaWJsZVdyaXRlcy5cbiAgICAgICAgICAgIGlmICh3cml0ZVRvUmVtb3ZlLnNuYXApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZpc2libGVXcml0ZXNfID0gdGhpcy52aXNpYmxlV3JpdGVzXy5yZW1vdmVXcml0ZSh3cml0ZVRvUmVtb3ZlLnBhdGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuID0gd3JpdGVUb1JlbW92ZS5jaGlsZHJlbjtcbiAgICAgICAgICAgICAgICB1dGlsXzEuZm9yRWFjaChjaGlsZHJlbiwgZnVuY3Rpb24gKGNoaWxkTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy52aXNpYmxlV3JpdGVzXyA9IF90aGlzLnZpc2libGVXcml0ZXNfLnJlbW92ZVdyaXRlKHdyaXRlVG9SZW1vdmUucGF0aC5jaGlsZChjaGlsZE5hbWUpKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYSBjb21wbGV0ZSBzbmFwc2hvdCBmb3IgdGhlIGdpdmVuIHBhdGggaWYgdGhlcmUncyB2aXNpYmxlIHdyaXRlIGRhdGEgYXQgdGhhdCBwYXRoLCBlbHNlIG51bGwuXG4gICAgICogTm8gc2VydmVyIGRhdGEgaXMgY29uc2lkZXJlZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7IVBhdGh9IHBhdGhcbiAgICAgKiBAcmV0dXJuIHs/Tm9kZX1cbiAgICAgKi9cbiAgICBXcml0ZVRyZWUucHJvdG90eXBlLmdldENvbXBsZXRlV3JpdGVEYXRhID0gZnVuY3Rpb24gKHBhdGgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmlzaWJsZVdyaXRlc18uZ2V0Q29tcGxldGVOb2RlKHBhdGgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2l2ZW4gb3B0aW9uYWwsIHVuZGVybHlpbmcgc2VydmVyIGRhdGEsIGFuZCBhbiBvcHRpb25hbCBzZXQgb2YgY29uc3RyYWludHMgKGV4Y2x1ZGUgc29tZSBzZXRzLCBpbmNsdWRlIGhpZGRlblxuICAgICAqIHdyaXRlcyksIGF0dGVtcHQgdG8gY2FsY3VsYXRlIGEgY29tcGxldGUgc25hcHNob3QgZm9yIHRoZSBnaXZlbiBwYXRoXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyFQYXRofSB0cmVlUGF0aFxuICAgICAqIEBwYXJhbSB7P05vZGV9IGNvbXBsZXRlU2VydmVyQ2FjaGVcbiAgICAgKiBAcGFyYW0ge0FycmF5LjxudW1iZXI+PX0gd3JpdGVJZHNUb0V4Y2x1ZGUgQW4gb3B0aW9uYWwgc2V0IHRvIGJlIGV4Y2x1ZGVkXG4gICAgICogQHBhcmFtIHtib29sZWFuPX0gaW5jbHVkZUhpZGRlbldyaXRlcyBEZWZhdWx0cyB0byBmYWxzZSwgd2hldGhlciBvciBub3QgdG8gbGF5ZXIgb24gd3JpdGVzIHdpdGggdmlzaWJsZSBzZXQgdG8gZmFsc2VcbiAgICAgKiBAcmV0dXJuIHs/Tm9kZX1cbiAgICAgKi9cbiAgICBXcml0ZVRyZWUucHJvdG90eXBlLmNhbGNDb21wbGV0ZUV2ZW50Q2FjaGUgPSBmdW5jdGlvbiAodHJlZVBhdGgsIGNvbXBsZXRlU2VydmVyQ2FjaGUsIHdyaXRlSWRzVG9FeGNsdWRlLCBpbmNsdWRlSGlkZGVuV3JpdGVzKSB7XG4gICAgICAgIGlmICghd3JpdGVJZHNUb0V4Y2x1ZGUgJiYgIWluY2x1ZGVIaWRkZW5Xcml0ZXMpIHtcbiAgICAgICAgICAgIHZhciBzaGFkb3dpbmdOb2RlID0gdGhpcy52aXNpYmxlV3JpdGVzXy5nZXRDb21wbGV0ZU5vZGUodHJlZVBhdGgpO1xuICAgICAgICAgICAgaWYgKHNoYWRvd2luZ05vZGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzaGFkb3dpbmdOb2RlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIHN1Yk1lcmdlID0gdGhpcy52aXNpYmxlV3JpdGVzXy5jaGlsZENvbXBvdW5kV3JpdGUodHJlZVBhdGgpO1xuICAgICAgICAgICAgICAgIGlmIChzdWJNZXJnZS5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBsZXRlU2VydmVyQ2FjaGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGNvbXBsZXRlU2VydmVyQ2FjaGUgPT0gbnVsbCAmJlxuICAgICAgICAgICAgICAgICAgICAhc3ViTWVyZ2UuaGFzQ29tcGxldGVXcml0ZShQYXRoXzEuUGF0aC5FbXB0eSkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gV2Ugd291bGRuJ3QgaGF2ZSBhIGNvbXBsZXRlIHNuYXBzaG90LCBzaW5jZSB0aGVyZSdzIG5vIHVuZGVybHlpbmcgZGF0YSBhbmQgbm8gY29tcGxldGUgc2hhZG93XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxheWVyZWRDYWNoZSA9IGNvbXBsZXRlU2VydmVyQ2FjaGUgfHwgQ2hpbGRyZW5Ob2RlXzEuQ2hpbGRyZW5Ob2RlLkVNUFRZX05PREU7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzdWJNZXJnZS5hcHBseShsYXllcmVkQ2FjaGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBtZXJnZSA9IHRoaXMudmlzaWJsZVdyaXRlc18uY2hpbGRDb21wb3VuZFdyaXRlKHRyZWVQYXRoKTtcbiAgICAgICAgICAgIGlmICghaW5jbHVkZUhpZGRlbldyaXRlcyAmJiBtZXJnZS5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29tcGxldGVTZXJ2ZXJDYWNoZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIElmIHRoZSBzZXJ2ZXIgY2FjaGUgaXMgbnVsbCwgYW5kIHdlIGRvbid0IGhhdmUgYSBjb21wbGV0ZSBjYWNoZSwgd2UgbmVlZCB0byByZXR1cm4gbnVsbFxuICAgICAgICAgICAgICAgIGlmICghaW5jbHVkZUhpZGRlbldyaXRlcyAmJlxuICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZVNlcnZlckNhY2hlID09IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgIW1lcmdlLmhhc0NvbXBsZXRlV3JpdGUoUGF0aF8xLlBhdGguRW1wdHkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZpbHRlciA9IGZ1bmN0aW9uICh3cml0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgod3JpdGUudmlzaWJsZSB8fCBpbmNsdWRlSGlkZGVuV3JpdGVzKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICghd3JpdGVJZHNUb0V4Y2x1ZGUgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIX53cml0ZUlkc1RvRXhjbHVkZS5pbmRleE9mKHdyaXRlLndyaXRlSWQpKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICh3cml0ZS5wYXRoLmNvbnRhaW5zKHRyZWVQYXRoKSB8fCB0cmVlUGF0aC5jb250YWlucyh3cml0ZS5wYXRoKSkpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWVyZ2VBdFBhdGggPSBXcml0ZVRyZWUubGF5ZXJUcmVlXyh0aGlzLmFsbFdyaXRlc18sIGZpbHRlciwgdHJlZVBhdGgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGF5ZXJlZENhY2hlID0gY29tcGxldGVTZXJ2ZXJDYWNoZSB8fCBDaGlsZHJlbk5vZGVfMS5DaGlsZHJlbk5vZGUuRU1QVFlfTk9ERTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1lcmdlQXRQYXRoLmFwcGx5KGxheWVyZWRDYWNoZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBXaXRoIG9wdGlvbmFsLCB1bmRlcmx5aW5nIHNlcnZlciBkYXRhLCBhdHRlbXB0IHRvIHJldHVybiBhIGNoaWxkcmVuIG5vZGUgb2YgY2hpbGRyZW4gdGhhdCB3ZSBoYXZlIGNvbXBsZXRlIGRhdGEgZm9yLlxuICAgICAqIFVzZWQgd2hlbiBjcmVhdGluZyBuZXcgdmlld3MsIHRvIHByZS1maWxsIHRoZWlyIGNvbXBsZXRlIGV2ZW50IGNoaWxkcmVuIHNuYXBzaG90LlxuICAgICAqXG4gICAgICogQHBhcmFtIHshUGF0aH0gdHJlZVBhdGhcbiAgICAgKiBAcGFyYW0gez9DaGlsZHJlbk5vZGV9IGNvbXBsZXRlU2VydmVyQ2hpbGRyZW5cbiAgICAgKiBAcmV0dXJuIHshQ2hpbGRyZW5Ob2RlfVxuICAgICAqL1xuICAgIFdyaXRlVHJlZS5wcm90b3R5cGUuY2FsY0NvbXBsZXRlRXZlbnRDaGlsZHJlbiA9IGZ1bmN0aW9uICh0cmVlUGF0aCwgY29tcGxldGVTZXJ2ZXJDaGlsZHJlbikge1xuICAgICAgICB2YXIgY29tcGxldGVDaGlsZHJlbiA9IENoaWxkcmVuTm9kZV8xLkNoaWxkcmVuTm9kZS5FTVBUWV9OT0RFO1xuICAgICAgICB2YXIgdG9wTGV2ZWxTZXQgPSB0aGlzLnZpc2libGVXcml0ZXNfLmdldENvbXBsZXRlTm9kZSh0cmVlUGF0aCk7XG4gICAgICAgIGlmICh0b3BMZXZlbFNldCkge1xuICAgICAgICAgICAgaWYgKCF0b3BMZXZlbFNldC5pc0xlYWZOb2RlKCkpIHtcbiAgICAgICAgICAgICAgICAvLyB3ZSdyZSBzaGFkb3dpbmcgZXZlcnl0aGluZy4gUmV0dXJuIHRoZSBjaGlsZHJlbi5cbiAgICAgICAgICAgICAgICB0b3BMZXZlbFNldC5mb3JFYWNoQ2hpbGQoUHJpb3JpdHlJbmRleF8xLlBSSU9SSVRZX0lOREVYLCBmdW5jdGlvbiAoY2hpbGROYW1lLCBjaGlsZFNuYXApIHtcbiAgICAgICAgICAgICAgICAgICAgY29tcGxldGVDaGlsZHJlbiA9IGNvbXBsZXRlQ2hpbGRyZW4udXBkYXRlSW1tZWRpYXRlQ2hpbGQoY2hpbGROYW1lLCBjaGlsZFNuYXApO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGNvbXBsZXRlQ2hpbGRyZW47XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY29tcGxldGVTZXJ2ZXJDaGlsZHJlbikge1xuICAgICAgICAgICAgLy8gTGF5ZXIgYW55IGNoaWxkcmVuIHdlIGhhdmUgb24gdG9wIG9mIHRoaXNcbiAgICAgICAgICAgIC8vIFdlIGtub3cgd2UgZG9uJ3QgaGF2ZSBhIHRvcC1sZXZlbCBzZXQsIHNvIGp1c3QgZW51bWVyYXRlIGV4aXN0aW5nIGNoaWxkcmVuXG4gICAgICAgICAgICB2YXIgbWVyZ2VfMSA9IHRoaXMudmlzaWJsZVdyaXRlc18uY2hpbGRDb21wb3VuZFdyaXRlKHRyZWVQYXRoKTtcbiAgICAgICAgICAgIGNvbXBsZXRlU2VydmVyQ2hpbGRyZW4uZm9yRWFjaENoaWxkKFByaW9yaXR5SW5kZXhfMS5QUklPUklUWV9JTkRFWCwgZnVuY3Rpb24gKGNoaWxkTmFtZSwgY2hpbGROb2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGUgPSBtZXJnZV8xXG4gICAgICAgICAgICAgICAgICAgIC5jaGlsZENvbXBvdW5kV3JpdGUobmV3IFBhdGhfMS5QYXRoKGNoaWxkTmFtZSkpXG4gICAgICAgICAgICAgICAgICAgIC5hcHBseShjaGlsZE5vZGUpO1xuICAgICAgICAgICAgICAgIGNvbXBsZXRlQ2hpbGRyZW4gPSBjb21wbGV0ZUNoaWxkcmVuLnVwZGF0ZUltbWVkaWF0ZUNoaWxkKGNoaWxkTmFtZSwgbm9kZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIEFkZCBhbnkgY29tcGxldGUgY2hpbGRyZW4gd2UgaGF2ZSBmcm9tIHRoZSBzZXRcbiAgICAgICAgICAgIG1lcmdlXzEuZ2V0Q29tcGxldGVDaGlsZHJlbigpLmZvckVhY2goZnVuY3Rpb24gKG5hbWVkTm9kZSkge1xuICAgICAgICAgICAgICAgIGNvbXBsZXRlQ2hpbGRyZW4gPSBjb21wbGV0ZUNoaWxkcmVuLnVwZGF0ZUltbWVkaWF0ZUNoaWxkKG5hbWVkTm9kZS5uYW1lLCBuYW1lZE5vZGUubm9kZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBjb21wbGV0ZUNoaWxkcmVuO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gV2UgZG9uJ3QgaGF2ZSBhbnl0aGluZyB0byBsYXllciBvbiB0b3Agb2YuIExheWVyIG9uIGFueSBjaGlsZHJlbiB3ZSBoYXZlXG4gICAgICAgICAgICAvLyBOb3RlIHRoYXQgd2UgY2FuIHJldHVybiBhbiBlbXB0eSBzbmFwIGlmIHdlIGhhdmUgYSBkZWZpbmVkIGRlbGV0ZVxuICAgICAgICAgICAgdmFyIG1lcmdlID0gdGhpcy52aXNpYmxlV3JpdGVzXy5jaGlsZENvbXBvdW5kV3JpdGUodHJlZVBhdGgpO1xuICAgICAgICAgICAgbWVyZ2UuZ2V0Q29tcGxldGVDaGlsZHJlbigpLmZvckVhY2goZnVuY3Rpb24gKG5hbWVkTm9kZSkge1xuICAgICAgICAgICAgICAgIGNvbXBsZXRlQ2hpbGRyZW4gPSBjb21wbGV0ZUNoaWxkcmVuLnVwZGF0ZUltbWVkaWF0ZUNoaWxkKG5hbWVkTm9kZS5uYW1lLCBuYW1lZE5vZGUubm9kZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBjb21wbGV0ZUNoaWxkcmVuO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHaXZlbiB0aGF0IHRoZSB1bmRlcmx5aW5nIHNlcnZlciBkYXRhIGhhcyB1cGRhdGVkLCBkZXRlcm1pbmUgd2hhdCwgaWYgYW55dGhpbmcsIG5lZWRzIHRvIGJlXG4gICAgICogYXBwbGllZCB0byB0aGUgZXZlbnQgY2FjaGUuXG4gICAgICpcbiAgICAgKiBQb3NzaWJpbGl0aWVzOlxuICAgICAqXG4gICAgICogMS4gTm8gd3JpdGVzIGFyZSBzaGFkb3dpbmcuIEV2ZW50cyBzaG91bGQgYmUgcmFpc2VkLCB0aGUgc25hcCB0byBiZSBhcHBsaWVkIGNvbWVzIGZyb20gdGhlIHNlcnZlciBkYXRhXG4gICAgICpcbiAgICAgKiAyLiBTb21lIHdyaXRlIGlzIGNvbXBsZXRlbHkgc2hhZG93aW5nLiBObyBldmVudHMgdG8gYmUgcmFpc2VkXG4gICAgICpcbiAgICAgKiAzLiBJcyBwYXJ0aWFsbHkgc2hhZG93ZWQuIEV2ZW50c1xuICAgICAqXG4gICAgICogRWl0aGVyIGV4aXN0aW5nRXZlbnRTbmFwIG9yIGV4aXN0aW5nU2VydmVyU25hcCBtdXN0IGV4aXN0XG4gICAgICpcbiAgICAgKiBAcGFyYW0geyFQYXRofSB0cmVlUGF0aFxuICAgICAqIEBwYXJhbSB7IVBhdGh9IGNoaWxkUGF0aFxuICAgICAqIEBwYXJhbSB7P05vZGV9IGV4aXN0aW5nRXZlbnRTbmFwXG4gICAgICogQHBhcmFtIHs/Tm9kZX0gZXhpc3RpbmdTZXJ2ZXJTbmFwXG4gICAgICogQHJldHVybiB7P05vZGV9XG4gICAgICovXG4gICAgV3JpdGVUcmVlLnByb3RvdHlwZS5jYWxjRXZlbnRDYWNoZUFmdGVyU2VydmVyT3ZlcndyaXRlID0gZnVuY3Rpb24gKHRyZWVQYXRoLCBjaGlsZFBhdGgsIGV4aXN0aW5nRXZlbnRTbmFwLCBleGlzdGluZ1NlcnZlclNuYXApIHtcbiAgICAgICAgdXRpbF8yLmFzc2VydChleGlzdGluZ0V2ZW50U25hcCB8fCBleGlzdGluZ1NlcnZlclNuYXAsICdFaXRoZXIgZXhpc3RpbmdFdmVudFNuYXAgb3IgZXhpc3RpbmdTZXJ2ZXJTbmFwIG11c3QgZXhpc3QnKTtcbiAgICAgICAgdmFyIHBhdGggPSB0cmVlUGF0aC5jaGlsZChjaGlsZFBhdGgpO1xuICAgICAgICBpZiAodGhpcy52aXNpYmxlV3JpdGVzXy5oYXNDb21wbGV0ZVdyaXRlKHBhdGgpKSB7XG4gICAgICAgICAgICAvLyBBdCB0aGlzIHBvaW50IHdlIGNhbiBwcm9iYWJseSBndWFyYW50ZWUgdGhhdCB3ZSdyZSBpbiBjYXNlIDIsIG1lYW5pbmcgbm8gZXZlbnRzXG4gICAgICAgICAgICAvLyBNYXkgbmVlZCB0byBjaGVjayB2aXNpYmlsaXR5IHdoaWxlIGRvaW5nIHRoZSBmaW5kUm9vdE1vc3RWYWx1ZUFuZFBhdGggY2FsbFxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBObyBjb21wbGV0ZSBzaGFkb3dpbmcuIFdlJ3JlIGVpdGhlciBwYXJ0aWFsbHkgc2hhZG93aW5nIG9yIG5vdCBzaGFkb3dpbmcgYXQgYWxsLlxuICAgICAgICAgICAgdmFyIGNoaWxkTWVyZ2UgPSB0aGlzLnZpc2libGVXcml0ZXNfLmNoaWxkQ29tcG91bmRXcml0ZShwYXRoKTtcbiAgICAgICAgICAgIGlmIChjaGlsZE1lcmdlLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgICAgIC8vIFdlJ3JlIG5vdCBzaGFkb3dpbmcgYXQgYWxsLiBDYXNlIDFcbiAgICAgICAgICAgICAgICByZXR1cm4gZXhpc3RpbmdTZXJ2ZXJTbmFwLmdldENoaWxkKGNoaWxkUGF0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBUaGlzIGNvdWxkIGJlIG1vcmUgZWZmaWNpZW50IGlmIHRoZSBzZXJ2ZXJOb2RlICsgdXBkYXRlcyBkb2Vzbid0IGNoYW5nZSB0aGUgZXZlbnRTbmFwXG4gICAgICAgICAgICAgICAgLy8gSG93ZXZlciB0aGlzIGlzIHRyaWNreSB0byBmaW5kIG91dCwgc2luY2UgdXNlciB1cGRhdGVzIGRvbid0IG5lY2Vzc2FyeSBjaGFuZ2UgdGhlIHNlcnZlclxuICAgICAgICAgICAgICAgIC8vIHNuYXAsIGUuZy4gcHJpb3JpdHkgdXBkYXRlcyBvbiBlbXB0eSBub2Rlcywgb3IgZGVlcCBkZWxldGVzLiBBbm90aGVyIHNwZWNpYWwgY2FzZSBpcyBpZiB0aGUgc2VydmVyXG4gICAgICAgICAgICAgICAgLy8gYWRkcyBub2RlcywgYnV0IGRvZXNuJ3QgY2hhbmdlIGFueSBleGlzdGluZyB3cml0ZXMuIEl0IGlzIHRoZXJlZm9yZSBub3QgZW5vdWdoIHRvXG4gICAgICAgICAgICAgICAgLy8gb25seSBjaGVjayBpZiB0aGUgdXBkYXRlcyBjaGFuZ2UgdGhlIHNlcnZlck5vZGUuXG4gICAgICAgICAgICAgICAgLy8gTWF5YmUgY2hlY2sgaWYgdGhlIG1lcmdlIHRyZWUgY29udGFpbnMgdGhlc2Ugc3BlY2lhbCBjYXNlcyBhbmQgb25seSBkbyBhIGZ1bGwgb3ZlcndyaXRlIGluIHRoYXQgY2FzZT9cbiAgICAgICAgICAgICAgICByZXR1cm4gY2hpbGRNZXJnZS5hcHBseShleGlzdGluZ1NlcnZlclNuYXAuZ2V0Q2hpbGQoY2hpbGRQYXRoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBjb21wbGV0ZSBjaGlsZCBmb3IgYSBnaXZlbiBzZXJ2ZXIgc25hcCBhZnRlciBhcHBseWluZyBhbGwgdXNlciB3cml0ZXMgb3IgbnVsbCBpZiB0aGVyZSBpcyBub1xuICAgICAqIGNvbXBsZXRlIGNoaWxkIGZvciB0aGlzIENoaWxkS2V5LlxuICAgICAqXG4gICAgICogQHBhcmFtIHshUGF0aH0gdHJlZVBhdGhcbiAgICAgKiBAcGFyYW0geyFzdHJpbmd9IGNoaWxkS2V5XG4gICAgICogQHBhcmFtIHshQ2FjaGVOb2RlfSBleGlzdGluZ1NlcnZlclNuYXBcbiAgICAgKiBAcmV0dXJuIHs/Tm9kZX1cbiAgICAgKi9cbiAgICBXcml0ZVRyZWUucHJvdG90eXBlLmNhbGNDb21wbGV0ZUNoaWxkID0gZnVuY3Rpb24gKHRyZWVQYXRoLCBjaGlsZEtleSwgZXhpc3RpbmdTZXJ2ZXJTbmFwKSB7XG4gICAgICAgIHZhciBwYXRoID0gdHJlZVBhdGguY2hpbGQoY2hpbGRLZXkpO1xuICAgICAgICB2YXIgc2hhZG93aW5nTm9kZSA9IHRoaXMudmlzaWJsZVdyaXRlc18uZ2V0Q29tcGxldGVOb2RlKHBhdGgpO1xuICAgICAgICBpZiAoc2hhZG93aW5nTm9kZSAhPSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gc2hhZG93aW5nTm9kZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChleGlzdGluZ1NlcnZlclNuYXAuaXNDb21wbGV0ZUZvckNoaWxkKGNoaWxkS2V5KSkge1xuICAgICAgICAgICAgICAgIHZhciBjaGlsZE1lcmdlID0gdGhpcy52aXNpYmxlV3JpdGVzXy5jaGlsZENvbXBvdW5kV3JpdGUocGF0aCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNoaWxkTWVyZ2UuYXBwbHkoZXhpc3RpbmdTZXJ2ZXJTbmFwLmdldE5vZGUoKS5nZXRJbW1lZGlhdGVDaGlsZChjaGlsZEtleSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBub2RlIGlmIHRoZXJlIGlzIGEgY29tcGxldGUgb3ZlcndyaXRlIGZvciB0aGlzIHBhdGguIE1vcmUgc3BlY2lmaWNhbGx5LCBpZiB0aGVyZSBpcyBhIHdyaXRlIGF0XG4gICAgICogYSBoaWdoZXIgcGF0aCwgdGhpcyB3aWxsIHJldHVybiB0aGUgY2hpbGQgb2YgdGhhdCB3cml0ZSByZWxhdGl2ZSB0byB0aGUgd3JpdGUgYW5kIHRoaXMgcGF0aC5cbiAgICAgKiBSZXR1cm5zIG51bGwgaWYgdGhlcmUgaXMgbm8gd3JpdGUgYXQgdGhpcyBwYXRoLlxuICAgICAqXG4gICAgICogQHBhcmFtIHshUGF0aH0gcGF0aFxuICAgICAqIEByZXR1cm4gez9Ob2RlfVxuICAgICAqL1xuICAgIFdyaXRlVHJlZS5wcm90b3R5cGUuc2hhZG93aW5nV3JpdGUgPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICByZXR1cm4gdGhpcy52aXNpYmxlV3JpdGVzXy5nZXRDb21wbGV0ZU5vZGUocGF0aCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyB1c2VkIHdoZW4gcHJvY2Vzc2luZyBjaGlsZCByZW1vdmUgZXZlbnRzIG9uIGEgcXVlcnkuIElmIHdlIGNhbiwgd2UgcHVsbCBpbiBjaGlsZHJlbiB0aGF0IHdlcmUgb3V0c2lkZVxuICAgICAqIHRoZSB3aW5kb3csIGJ1dCBtYXkgbm93IGJlIGluIHRoZSB3aW5kb3cuXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyFQYXRofSB0cmVlUGF0aFxuICAgICAqIEBwYXJhbSB7P05vZGV9IGNvbXBsZXRlU2VydmVyRGF0YVxuICAgICAqIEBwYXJhbSB7IU5hbWVkTm9kZX0gc3RhcnRQb3N0XG4gICAgICogQHBhcmFtIHshbnVtYmVyfSBjb3VudFxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gcmV2ZXJzZVxuICAgICAqIEBwYXJhbSB7IUluZGV4fSBpbmRleFxuICAgICAqIEByZXR1cm4geyFBcnJheS48IU5hbWVkTm9kZT59XG4gICAgICovXG4gICAgV3JpdGVUcmVlLnByb3RvdHlwZS5jYWxjSW5kZXhlZFNsaWNlID0gZnVuY3Rpb24gKHRyZWVQYXRoLCBjb21wbGV0ZVNlcnZlckRhdGEsIHN0YXJ0UG9zdCwgY291bnQsIHJldmVyc2UsIGluZGV4KSB7XG4gICAgICAgIHZhciB0b0l0ZXJhdGU7XG4gICAgICAgIHZhciBtZXJnZSA9IHRoaXMudmlzaWJsZVdyaXRlc18uY2hpbGRDb21wb3VuZFdyaXRlKHRyZWVQYXRoKTtcbiAgICAgICAgdmFyIHNoYWRvd2luZ05vZGUgPSBtZXJnZS5nZXRDb21wbGV0ZU5vZGUoUGF0aF8xLlBhdGguRW1wdHkpO1xuICAgICAgICBpZiAoc2hhZG93aW5nTm9kZSAhPSBudWxsKSB7XG4gICAgICAgICAgICB0b0l0ZXJhdGUgPSBzaGFkb3dpbmdOb2RlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNvbXBsZXRlU2VydmVyRGF0YSAhPSBudWxsKSB7XG4gICAgICAgICAgICB0b0l0ZXJhdGUgPSBtZXJnZS5hcHBseShjb21wbGV0ZVNlcnZlckRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gbm8gY2hpbGRyZW4gdG8gaXRlcmF0ZSBvblxuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgICAgIHRvSXRlcmF0ZSA9IHRvSXRlcmF0ZS53aXRoSW5kZXgoaW5kZXgpO1xuICAgICAgICBpZiAoIXRvSXRlcmF0ZS5pc0VtcHR5KCkgJiYgIXRvSXRlcmF0ZS5pc0xlYWZOb2RlKCkpIHtcbiAgICAgICAgICAgIHZhciBub2RlcyA9IFtdO1xuICAgICAgICAgICAgdmFyIGNtcCA9IGluZGV4LmdldENvbXBhcmUoKTtcbiAgICAgICAgICAgIHZhciBpdGVyID0gcmV2ZXJzZVxuICAgICAgICAgICAgICAgID8gdG9JdGVyYXRlLmdldFJldmVyc2VJdGVyYXRvckZyb20oc3RhcnRQb3N0LCBpbmRleClcbiAgICAgICAgICAgICAgICA6IHRvSXRlcmF0ZS5nZXRJdGVyYXRvckZyb20oc3RhcnRQb3N0LCBpbmRleCk7XG4gICAgICAgICAgICB2YXIgbmV4dCA9IGl0ZXIuZ2V0TmV4dCgpO1xuICAgICAgICAgICAgd2hpbGUgKG5leHQgJiYgbm9kZXMubGVuZ3RoIDwgY291bnQpIHtcbiAgICAgICAgICAgICAgICBpZiAoY21wKG5leHQsIHN0YXJ0UG9zdCkgIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZXMucHVzaChuZXh0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbmV4dCA9IGl0ZXIuZ2V0TmV4dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5vZGVzO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFXcml0ZVJlY29yZH0gd3JpdGVSZWNvcmRcbiAgICAgKiBAcGFyYW0geyFQYXRofSBwYXRoXG4gICAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIFdyaXRlVHJlZS5wcm90b3R5cGUucmVjb3JkQ29udGFpbnNQYXRoXyA9IGZ1bmN0aW9uICh3cml0ZVJlY29yZCwgcGF0aCkge1xuICAgICAgICBpZiAod3JpdGVSZWNvcmQuc25hcCkge1xuICAgICAgICAgICAgcmV0dXJuIHdyaXRlUmVjb3JkLnBhdGguY29udGFpbnMocGF0aCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBmaW5kS2V5IGNhbiByZXR1cm4gdW5kZWZpbmVkLCBzbyB1c2UgISEgdG8gY29lcmNlIHRvIGJvb2xlYW5cbiAgICAgICAgICAgIHJldHVybiAhIXV0aWxfMS5maW5kS2V5KHdyaXRlUmVjb3JkLmNoaWxkcmVuLCBmdW5jdGlvbiAoY2hpbGRTbmFwLCBjaGlsZE5hbWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gd3JpdGVSZWNvcmQucGF0aC5jaGlsZChjaGlsZE5hbWUpLmNvbnRhaW5zKHBhdGgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJlLWxheWVyIHRoZSB3cml0ZXMgYW5kIG1lcmdlcyBpbnRvIGEgdHJlZSBzbyB3ZSBjYW4gZWZmaWNpZW50bHkgY2FsY3VsYXRlIGV2ZW50IHNuYXBzaG90c1xuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgV3JpdGVUcmVlLnByb3RvdHlwZS5yZXNldFRyZWVfID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnZpc2libGVXcml0ZXNfID0gV3JpdGVUcmVlLmxheWVyVHJlZV8odGhpcy5hbGxXcml0ZXNfLCBXcml0ZVRyZWUuRGVmYXVsdEZpbHRlcl8sIFBhdGhfMS5QYXRoLkVtcHR5KTtcbiAgICAgICAgaWYgKHRoaXMuYWxsV3JpdGVzXy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0aGlzLmxhc3RXcml0ZUlkXyA9IHRoaXMuYWxsV3JpdGVzX1t0aGlzLmFsbFdyaXRlc18ubGVuZ3RoIC0gMV0ud3JpdGVJZDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubGFzdFdyaXRlSWRfID0gLTE7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFRoZSBkZWZhdWx0IGZpbHRlciB1c2VkIHdoZW4gY29uc3RydWN0aW5nIHRoZSB0cmVlLiBLZWVwIGV2ZXJ5dGhpbmcgdGhhdCdzIHZpc2libGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyFXcml0ZVJlY29yZH0gd3JpdGVcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgV3JpdGVUcmVlLkRlZmF1bHRGaWx0ZXJfID0gZnVuY3Rpb24gKHdyaXRlKSB7XG4gICAgICAgIHJldHVybiB3cml0ZS52aXNpYmxlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogU3RhdGljIG1ldGhvZC4gR2l2ZW4gYW4gYXJyYXkgb2YgV3JpdGVSZWNvcmRzLCBhIGZpbHRlciBmb3Igd2hpY2ggb25lcyB0byBpbmNsdWRlLCBhbmQgYSBwYXRoLCBjb25zdHJ1Y3QgdGhlIHRyZWUgb2ZcbiAgICAgKiBldmVudCBkYXRhIGF0IHRoYXQgcGF0aC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7IUFycmF5LjwhV3JpdGVSZWNvcmQ+fSB3cml0ZXNcbiAgICAgKiBAcGFyYW0geyFmdW5jdGlvbighV3JpdGVSZWNvcmQpOmJvb2xlYW59IGZpbHRlclxuICAgICAqIEBwYXJhbSB7IVBhdGh9IHRyZWVSb290XG4gICAgICogQHJldHVybiB7IUNvbXBvdW5kV3JpdGV9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBXcml0ZVRyZWUubGF5ZXJUcmVlXyA9IGZ1bmN0aW9uICh3cml0ZXMsIGZpbHRlciwgdHJlZVJvb3QpIHtcbiAgICAgICAgdmFyIGNvbXBvdW5kV3JpdGUgPSBDb21wb3VuZFdyaXRlXzEuQ29tcG91bmRXcml0ZS5FbXB0eTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB3cml0ZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciB3cml0ZSA9IHdyaXRlc1tpXTtcbiAgICAgICAgICAgIC8vIFRoZW9yeSwgYSBsYXRlciBzZXQgd2lsbCBlaXRoZXI6XG4gICAgICAgICAgICAvLyBhKSBhYm9ydCBhIHJlbGV2YW50IHRyYW5zYWN0aW9uLCBzbyBubyBuZWVkIHRvIHdvcnJ5IGFib3V0IGV4Y2x1ZGluZyBpdCBmcm9tIGNhbGN1bGF0aW5nIHRoYXQgdHJhbnNhY3Rpb25cbiAgICAgICAgICAgIC8vIGIpIG5vdCBiZSByZWxldmFudCB0byBhIHRyYW5zYWN0aW9uIChzZXBhcmF0ZSBicmFuY2gpLCBzbyBhZ2FpbiB3aWxsIG5vdCBhZmZlY3QgdGhlIGRhdGEgZm9yIHRoYXQgdHJhbnNhY3Rpb25cbiAgICAgICAgICAgIGlmIChmaWx0ZXIod3JpdGUpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHdyaXRlUGF0aCA9IHdyaXRlLnBhdGg7XG4gICAgICAgICAgICAgICAgdmFyIHJlbGF0aXZlUGF0aCA9IHZvaWQgMDtcbiAgICAgICAgICAgICAgICBpZiAod3JpdGUuc25hcCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodHJlZVJvb3QuY29udGFpbnMod3JpdGVQYXRoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVsYXRpdmVQYXRoID0gUGF0aF8xLlBhdGgucmVsYXRpdmVQYXRoKHRyZWVSb290LCB3cml0ZVBhdGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29tcG91bmRXcml0ZSA9IGNvbXBvdW5kV3JpdGUuYWRkV3JpdGUocmVsYXRpdmVQYXRoLCB3cml0ZS5zbmFwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh3cml0ZVBhdGguY29udGFpbnModHJlZVJvb3QpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWxhdGl2ZVBhdGggPSBQYXRoXzEuUGF0aC5yZWxhdGl2ZVBhdGgod3JpdGVQYXRoLCB0cmVlUm9vdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb21wb3VuZFdyaXRlID0gY29tcG91bmRXcml0ZS5hZGRXcml0ZShQYXRoXzEuUGF0aC5FbXB0eSwgd3JpdGUuc25hcC5nZXRDaGlsZChyZWxhdGl2ZVBhdGgpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZXJlIGlzIG5vIG92ZXJsYXAgYmV0d2VlbiByb290IHBhdGggYW5kIHdyaXRlIHBhdGgsIGlnbm9yZSB3cml0ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHdyaXRlLmNoaWxkcmVuKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0cmVlUm9vdC5jb250YWlucyh3cml0ZVBhdGgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWxhdGl2ZVBhdGggPSBQYXRoXzEuUGF0aC5yZWxhdGl2ZVBhdGgodHJlZVJvb3QsIHdyaXRlUGF0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb21wb3VuZFdyaXRlID0gY29tcG91bmRXcml0ZS5hZGRXcml0ZXMocmVsYXRpdmVQYXRoLCB3cml0ZS5jaGlsZHJlbik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAod3JpdGVQYXRoLmNvbnRhaW5zKHRyZWVSb290KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVsYXRpdmVQYXRoID0gUGF0aF8xLlBhdGgucmVsYXRpdmVQYXRoKHdyaXRlUGF0aCwgdHJlZVJvb3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlbGF0aXZlUGF0aC5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb3VuZFdyaXRlID0gY29tcG91bmRXcml0ZS5hZGRXcml0ZXMoUGF0aF8xLlBhdGguRW1wdHksIHdyaXRlLmNoaWxkcmVuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjaGlsZCA9IHV0aWxfMS5zYWZlR2V0KHdyaXRlLmNoaWxkcmVuLCByZWxhdGl2ZVBhdGguZ2V0RnJvbnQoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoaWxkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZXJlIGV4aXN0cyBhIGNoaWxkIGluIHRoaXMgbm9kZSB0aGF0IG1hdGNoZXMgdGhlIHJvb3QgcGF0aFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVlcE5vZGUgPSBjaGlsZC5nZXRDaGlsZChyZWxhdGl2ZVBhdGgucG9wRnJvbnQoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvdW5kV3JpdGUgPSBjb21wb3VuZFdyaXRlLmFkZFdyaXRlKFBhdGhfMS5QYXRoLkVtcHR5LCBkZWVwTm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlcmUgaXMgbm8gb3ZlcmxhcCBiZXR3ZWVuIHJvb3QgcGF0aCBhbmQgd3JpdGUgcGF0aCwgaWdub3JlIHdyaXRlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IHV0aWxfMi5hc3NlcnRpb25FcnJvcignV3JpdGVSZWNvcmQgc2hvdWxkIGhhdmUgLnNuYXAgb3IgLmNoaWxkcmVuJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjb21wb3VuZFdyaXRlO1xuICAgIH07XG4gICAgcmV0dXJuIFdyaXRlVHJlZTtcbn0oKSk7XG5leHBvcnRzLldyaXRlVHJlZSA9IFdyaXRlVHJlZTtcbi8qKlxuICogQSBXcml0ZVRyZWVSZWYgd3JhcHMgYSBXcml0ZVRyZWUgYW5kIGEgcGF0aCwgZm9yIGNvbnZlbmllbnQgYWNjZXNzIHRvIGEgcGFydGljdWxhciBzdWJ0cmVlLiAgQWxsIG9mIHRoZSBtZXRob2RzXG4gKiBqdXN0IHByb3h5IHRvIHRoZSB1bmRlcmx5aW5nIFdyaXRlVHJlZS5cbiAqXG4gKiBAY29uc3RydWN0b3JcbiAqL1xudmFyIFdyaXRlVHJlZVJlZiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFQYXRofSBwYXRoXG4gICAgICogQHBhcmFtIHshV3JpdGVUcmVlfSB3cml0ZVRyZWVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBXcml0ZVRyZWVSZWYocGF0aCwgd3JpdGVUcmVlKSB7XG4gICAgICAgIHRoaXMudHJlZVBhdGhfID0gcGF0aDtcbiAgICAgICAgdGhpcy53cml0ZVRyZWVfID0gd3JpdGVUcmVlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJZiBwb3NzaWJsZSwgcmV0dXJucyBhIGNvbXBsZXRlIGV2ZW50IGNhY2hlLCB1c2luZyB0aGUgdW5kZXJseWluZyBzZXJ2ZXIgZGF0YSBpZiBwb3NzaWJsZS4gSW4gYWRkaXRpb24sIGNhbiBiZSB1c2VkXG4gICAgICogdG8gZ2V0IGEgY2FjaGUgdGhhdCBpbmNsdWRlcyBoaWRkZW4gd3JpdGVzLCBhbmQgZXhjbHVkZXMgYXJiaXRyYXJ5IHdyaXRlcy4gTm90ZSB0aGF0IGN1c3RvbWl6aW5nIHRoZSByZXR1cm5lZCBub2RlXG4gICAgICogY2FuIGxlYWQgdG8gYSBtb3JlIGV4cGVuc2l2ZSBjYWxjdWxhdGlvbi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7P05vZGV9IGNvbXBsZXRlU2VydmVyQ2FjaGVcbiAgICAgKiBAcGFyYW0ge0FycmF5LjxudW1iZXI+PX0gd3JpdGVJZHNUb0V4Y2x1ZGUgT3B0aW9uYWwgd3JpdGVzIHRvIGV4Y2x1ZGUuXG4gICAgICogQHBhcmFtIHtib29sZWFuPX0gaW5jbHVkZUhpZGRlbldyaXRlcyBEZWZhdWx0cyB0byBmYWxzZSwgd2hldGhlciBvciBub3QgdG8gbGF5ZXIgb24gd3JpdGVzIHdpdGggdmlzaWJsZSBzZXQgdG8gZmFsc2VcbiAgICAgKiBAcmV0dXJuIHs/Tm9kZX1cbiAgICAgKi9cbiAgICBXcml0ZVRyZWVSZWYucHJvdG90eXBlLmNhbGNDb21wbGV0ZUV2ZW50Q2FjaGUgPSBmdW5jdGlvbiAoY29tcGxldGVTZXJ2ZXJDYWNoZSwgd3JpdGVJZHNUb0V4Y2x1ZGUsIGluY2x1ZGVIaWRkZW5Xcml0ZXMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMud3JpdGVUcmVlXy5jYWxjQ29tcGxldGVFdmVudENhY2hlKHRoaXMudHJlZVBhdGhfLCBjb21wbGV0ZVNlcnZlckNhY2hlLCB3cml0ZUlkc1RvRXhjbHVkZSwgaW5jbHVkZUhpZGRlbldyaXRlcyk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBJZiBwb3NzaWJsZSwgcmV0dXJucyBhIGNoaWxkcmVuIG5vZGUgY29udGFpbmluZyBhbGwgb2YgdGhlIGNvbXBsZXRlIGNoaWxkcmVuIHdlIGhhdmUgZGF0YSBmb3IuIFRoZSByZXR1cm5lZCBkYXRhIGlzIGFcbiAgICAgKiBtaXggb2YgdGhlIGdpdmVuIHNlcnZlciBkYXRhIGFuZCB3cml0ZSBkYXRhLlxuICAgICAqXG4gICAgICogQHBhcmFtIHs/Q2hpbGRyZW5Ob2RlfSBjb21wbGV0ZVNlcnZlckNoaWxkcmVuXG4gICAgICogQHJldHVybiB7IUNoaWxkcmVuTm9kZX1cbiAgICAgKi9cbiAgICBXcml0ZVRyZWVSZWYucHJvdG90eXBlLmNhbGNDb21wbGV0ZUV2ZW50Q2hpbGRyZW4gPSBmdW5jdGlvbiAoY29tcGxldGVTZXJ2ZXJDaGlsZHJlbikge1xuICAgICAgICByZXR1cm4gdGhpcy53cml0ZVRyZWVfLmNhbGNDb21wbGV0ZUV2ZW50Q2hpbGRyZW4odGhpcy50cmVlUGF0aF8sIGNvbXBsZXRlU2VydmVyQ2hpbGRyZW4pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2l2ZW4gdGhhdCBlaXRoZXIgdGhlIHVuZGVybHlpbmcgc2VydmVyIGRhdGEgaGFzIHVwZGF0ZWQgb3IgdGhlIG91dHN0YW5kaW5nIHdyaXRlcyBoYXZlIHVwZGF0ZWQsIGRldGVybWluZSB3aGF0LFxuICAgICAqIGlmIGFueXRoaW5nLCBuZWVkcyB0byBiZSBhcHBsaWVkIHRvIHRoZSBldmVudCBjYWNoZS5cbiAgICAgKlxuICAgICAqIFBvc3NpYmlsaXRpZXM6XG4gICAgICpcbiAgICAgKiAxLiBObyB3cml0ZXMgYXJlIHNoYWRvd2luZy4gRXZlbnRzIHNob3VsZCBiZSByYWlzZWQsIHRoZSBzbmFwIHRvIGJlIGFwcGxpZWQgY29tZXMgZnJvbSB0aGUgc2VydmVyIGRhdGFcbiAgICAgKlxuICAgICAqIDIuIFNvbWUgd3JpdGUgaXMgY29tcGxldGVseSBzaGFkb3dpbmcuIE5vIGV2ZW50cyB0byBiZSByYWlzZWRcbiAgICAgKlxuICAgICAqIDMuIElzIHBhcnRpYWxseSBzaGFkb3dlZC4gRXZlbnRzIHNob3VsZCBiZSByYWlzZWRcbiAgICAgKlxuICAgICAqIEVpdGhlciBleGlzdGluZ0V2ZW50U25hcCBvciBleGlzdGluZ1NlcnZlclNuYXAgbXVzdCBleGlzdCwgdGhpcyBpcyB2YWxpZGF0ZWQgdmlhIGFuIGFzc2VydFxuICAgICAqXG4gICAgICogQHBhcmFtIHshUGF0aH0gcGF0aFxuICAgICAqIEBwYXJhbSB7P05vZGV9IGV4aXN0aW5nRXZlbnRTbmFwXG4gICAgICogQHBhcmFtIHs/Tm9kZX0gZXhpc3RpbmdTZXJ2ZXJTbmFwXG4gICAgICogQHJldHVybiB7P05vZGV9XG4gICAgICovXG4gICAgV3JpdGVUcmVlUmVmLnByb3RvdHlwZS5jYWxjRXZlbnRDYWNoZUFmdGVyU2VydmVyT3ZlcndyaXRlID0gZnVuY3Rpb24gKHBhdGgsIGV4aXN0aW5nRXZlbnRTbmFwLCBleGlzdGluZ1NlcnZlclNuYXApIHtcbiAgICAgICAgcmV0dXJuIHRoaXMud3JpdGVUcmVlXy5jYWxjRXZlbnRDYWNoZUFmdGVyU2VydmVyT3ZlcndyaXRlKHRoaXMudHJlZVBhdGhfLCBwYXRoLCBleGlzdGluZ0V2ZW50U25hcCwgZXhpc3RpbmdTZXJ2ZXJTbmFwKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBub2RlIGlmIHRoZXJlIGlzIGEgY29tcGxldGUgb3ZlcndyaXRlIGZvciB0aGlzIHBhdGguIE1vcmUgc3BlY2lmaWNhbGx5LCBpZiB0aGVyZSBpcyBhIHdyaXRlIGF0XG4gICAgICogYSBoaWdoZXIgcGF0aCwgdGhpcyB3aWxsIHJldHVybiB0aGUgY2hpbGQgb2YgdGhhdCB3cml0ZSByZWxhdGl2ZSB0byB0aGUgd3JpdGUgYW5kIHRoaXMgcGF0aC5cbiAgICAgKiBSZXR1cm5zIG51bGwgaWYgdGhlcmUgaXMgbm8gd3JpdGUgYXQgdGhpcyBwYXRoLlxuICAgICAqXG4gICAgICogQHBhcmFtIHshUGF0aH0gcGF0aFxuICAgICAqIEByZXR1cm4gez9Ob2RlfVxuICAgICAqL1xuICAgIFdyaXRlVHJlZVJlZi5wcm90b3R5cGUuc2hhZG93aW5nV3JpdGUgPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICByZXR1cm4gdGhpcy53cml0ZVRyZWVfLnNoYWRvd2luZ1dyaXRlKHRoaXMudHJlZVBhdGhfLmNoaWxkKHBhdGgpKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIHVzZWQgd2hlbiBwcm9jZXNzaW5nIGNoaWxkIHJlbW92ZSBldmVudHMgb24gYSBxdWVyeS4gSWYgd2UgY2FuLCB3ZSBwdWxsIGluIGNoaWxkcmVuIHRoYXQgd2VyZSBvdXRzaWRlXG4gICAgICogdGhlIHdpbmRvdywgYnV0IG1heSBub3cgYmUgaW4gdGhlIHdpbmRvd1xuICAgICAqXG4gICAgICogQHBhcmFtIHs/Tm9kZX0gY29tcGxldGVTZXJ2ZXJEYXRhXG4gICAgICogQHBhcmFtIHshTmFtZWROb2RlfSBzdGFydFBvc3RcbiAgICAgKiBAcGFyYW0geyFudW1iZXJ9IGNvdW50XG4gICAgICogQHBhcmFtIHtib29sZWFufSByZXZlcnNlXG4gICAgICogQHBhcmFtIHshSW5kZXh9IGluZGV4XG4gICAgICogQHJldHVybiB7IUFycmF5LjwhTmFtZWROb2RlPn1cbiAgICAgKi9cbiAgICBXcml0ZVRyZWVSZWYucHJvdG90eXBlLmNhbGNJbmRleGVkU2xpY2UgPSBmdW5jdGlvbiAoY29tcGxldGVTZXJ2ZXJEYXRhLCBzdGFydFBvc3QsIGNvdW50LCByZXZlcnNlLCBpbmRleCkge1xuICAgICAgICByZXR1cm4gdGhpcy53cml0ZVRyZWVfLmNhbGNJbmRleGVkU2xpY2UodGhpcy50cmVlUGF0aF8sIGNvbXBsZXRlU2VydmVyRGF0YSwgc3RhcnRQb3N0LCBjb3VudCwgcmV2ZXJzZSwgaW5kZXgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGNvbXBsZXRlIGNoaWxkIGZvciBhIGdpdmVuIHNlcnZlciBzbmFwIGFmdGVyIGFwcGx5aW5nIGFsbCB1c2VyIHdyaXRlcyBvciBudWxsIGlmIHRoZXJlIGlzIG5vXG4gICAgICogY29tcGxldGUgY2hpbGQgZm9yIHRoaXMgQ2hpbGRLZXkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyFzdHJpbmd9IGNoaWxkS2V5XG4gICAgICogQHBhcmFtIHshQ2FjaGVOb2RlfSBleGlzdGluZ1NlcnZlckNhY2hlXG4gICAgICogQHJldHVybiB7P05vZGV9XG4gICAgICovXG4gICAgV3JpdGVUcmVlUmVmLnByb3RvdHlwZS5jYWxjQ29tcGxldGVDaGlsZCA9IGZ1bmN0aW9uIChjaGlsZEtleSwgZXhpc3RpbmdTZXJ2ZXJDYWNoZSkge1xuICAgICAgICByZXR1cm4gdGhpcy53cml0ZVRyZWVfLmNhbGNDb21wbGV0ZUNoaWxkKHRoaXMudHJlZVBhdGhfLCBjaGlsZEtleSwgZXhpc3RpbmdTZXJ2ZXJDYWNoZSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYSBXcml0ZVRyZWVSZWYgZm9yIGEgY2hpbGQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gY2hpbGROYW1lXG4gICAgICogQHJldHVybiB7IVdyaXRlVHJlZVJlZn1cbiAgICAgKi9cbiAgICBXcml0ZVRyZWVSZWYucHJvdG90eXBlLmNoaWxkID0gZnVuY3Rpb24gKGNoaWxkTmFtZSkge1xuICAgICAgICByZXR1cm4gbmV3IFdyaXRlVHJlZVJlZih0aGlzLnRyZWVQYXRoXy5jaGlsZChjaGlsZE5hbWUpLCB0aGlzLndyaXRlVHJlZV8pO1xuICAgIH07XG4gICAgcmV0dXJuIFdyaXRlVHJlZVJlZjtcbn0oKSk7XG5leHBvcnRzLldyaXRlVHJlZVJlZiA9IFdyaXRlVHJlZVJlZjtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9V3JpdGVUcmVlLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHV0aWxfMSA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvdXRpbFwiKTtcbnZhciBQYXRoXzEgPSByZXF1aXJlKFwiLi4vdXRpbC9QYXRoXCIpO1xudmFyIE9wZXJhdGlvbl8xID0gcmVxdWlyZShcIi4vT3BlcmF0aW9uXCIpO1xudmFyIEFja1VzZXJXcml0ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7IVBhdGh9IHBhdGhcbiAgICAgKiBAcGFyYW0geyFJbW11dGFibGVUcmVlPCFib29sZWFuPn0gYWZmZWN0ZWRUcmVlIEEgdHJlZSBjb250YWluaW5nIHRydWUgZm9yIGVhY2ggYWZmZWN0ZWQgcGF0aC4gQWZmZWN0ZWQgcGF0aHMgY2FuJ3Qgb3ZlcmxhcC5cbiAgICAgKiBAcGFyYW0geyFib29sZWFufSByZXZlcnRcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBBY2tVc2VyV3JpdGUoXG4gICAgICAgIC8qKkBpbmhlcml0RG9jICovIHBhdGgsIFxuICAgICAgICAvKipAaW5oZXJpdERvYyAqLyBhZmZlY3RlZFRyZWUsIFxuICAgICAgICAvKipAaW5oZXJpdERvYyAqLyByZXZlcnQpIHtcbiAgICAgICAgdGhpcy5wYXRoID0gcGF0aDtcbiAgICAgICAgdGhpcy5hZmZlY3RlZFRyZWUgPSBhZmZlY3RlZFRyZWU7XG4gICAgICAgIHRoaXMucmV2ZXJ0ID0gcmV2ZXJ0O1xuICAgICAgICAvKiogQGluaGVyaXREb2MgKi9cbiAgICAgICAgdGhpcy50eXBlID0gT3BlcmF0aW9uXzEuT3BlcmF0aW9uVHlwZS5BQ0tfVVNFUl9XUklURTtcbiAgICAgICAgLyoqIEBpbmhlcml0RG9jICovXG4gICAgICAgIHRoaXMuc291cmNlID0gT3BlcmF0aW9uXzEuT3BlcmF0aW9uU291cmNlLlVzZXI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgQWNrVXNlcldyaXRlLnByb3RvdHlwZS5vcGVyYXRpb25Gb3JDaGlsZCA9IGZ1bmN0aW9uIChjaGlsZE5hbWUpIHtcbiAgICAgICAgaWYgKCF0aGlzLnBhdGguaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICB1dGlsXzEuYXNzZXJ0KHRoaXMucGF0aC5nZXRGcm9udCgpID09PSBjaGlsZE5hbWUsICdvcGVyYXRpb25Gb3JDaGlsZCBjYWxsZWQgZm9yIHVucmVsYXRlZCBjaGlsZC4nKTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgQWNrVXNlcldyaXRlKHRoaXMucGF0aC5wb3BGcm9udCgpLCB0aGlzLmFmZmVjdGVkVHJlZSwgdGhpcy5yZXZlcnQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuYWZmZWN0ZWRUcmVlLnZhbHVlICE9IG51bGwpIHtcbiAgICAgICAgICAgIHV0aWxfMS5hc3NlcnQodGhpcy5hZmZlY3RlZFRyZWUuY2hpbGRyZW4uaXNFbXB0eSgpLCAnYWZmZWN0ZWRUcmVlIHNob3VsZCBub3QgaGF2ZSBvdmVybGFwcGluZyBhZmZlY3RlZCBwYXRocy4nKTtcbiAgICAgICAgICAgIC8vIEFsbCBjaGlsZCBsb2NhdGlvbnMgYXJlIGFmZmVjdGVkIGFzIHdlbGw7IGp1c3QgcmV0dXJuIHNhbWUgb3BlcmF0aW9uLlxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgY2hpbGRUcmVlID0gdGhpcy5hZmZlY3RlZFRyZWUuc3VidHJlZShuZXcgUGF0aF8xLlBhdGgoY2hpbGROYW1lKSk7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEFja1VzZXJXcml0ZShQYXRoXzEuUGF0aC5FbXB0eSwgY2hpbGRUcmVlLCB0aGlzLnJldmVydCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBBY2tVc2VyV3JpdGU7XG59KCkpO1xuZXhwb3J0cy5BY2tVc2VyV3JpdGUgPSBBY2tVc2VyV3JpdGU7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUFja1VzZXJXcml0ZS5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBQYXRoXzEgPSByZXF1aXJlKFwiLi4vdXRpbC9QYXRoXCIpO1xudmFyIE9wZXJhdGlvbl8xID0gcmVxdWlyZShcIi4vT3BlcmF0aW9uXCIpO1xuLyoqXG4gKiBAcGFyYW0geyFPcGVyYXRpb25Tb3VyY2V9IHNvdXJjZVxuICogQHBhcmFtIHshUGF0aH0gcGF0aFxuICogQGNvbnN0cnVjdG9yXG4gKiBAaW1wbGVtZW50cyB7T3BlcmF0aW9ufVxuICovXG52YXIgTGlzdGVuQ29tcGxldGUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTGlzdGVuQ29tcGxldGUoc291cmNlLCBwYXRoKSB7XG4gICAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgICB0aGlzLnBhdGggPSBwYXRoO1xuICAgICAgICAvKiogQGluaGVyaXREb2MgKi9cbiAgICAgICAgdGhpcy50eXBlID0gT3BlcmF0aW9uXzEuT3BlcmF0aW9uVHlwZS5MSVNURU5fQ09NUExFVEU7XG4gICAgfVxuICAgIExpc3RlbkNvbXBsZXRlLnByb3RvdHlwZS5vcGVyYXRpb25Gb3JDaGlsZCA9IGZ1bmN0aW9uIChjaGlsZE5hbWUpIHtcbiAgICAgICAgaWYgKHRoaXMucGF0aC5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgTGlzdGVuQ29tcGxldGUodGhpcy5zb3VyY2UsIFBhdGhfMS5QYXRoLkVtcHR5KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgTGlzdGVuQ29tcGxldGUodGhpcy5zb3VyY2UsIHRoaXMucGF0aC5wb3BGcm9udCgpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIExpc3RlbkNvbXBsZXRlO1xufSgpKTtcbmV4cG9ydHMuTGlzdGVuQ29tcGxldGUgPSBMaXN0ZW5Db21wbGV0ZTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9TGlzdGVuQ29tcGxldGUuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgT3BlcmF0aW9uXzEgPSByZXF1aXJlKFwiLi9PcGVyYXRpb25cIik7XG52YXIgT3ZlcndyaXRlXzEgPSByZXF1aXJlKFwiLi9PdmVyd3JpdGVcIik7XG52YXIgUGF0aF8xID0gcmVxdWlyZShcIi4uL3V0aWwvUGF0aFwiKTtcbnZhciB1dGlsXzEgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG4vKipcbiAqIEBwYXJhbSB7IU9wZXJhdGlvblNvdXJjZX0gc291cmNlXG4gKiBAcGFyYW0geyFQYXRofSBwYXRoXG4gKiBAcGFyYW0geyFJbW11dGFibGVUcmVlLjwhTm9kZT59IGNoaWxkcmVuXG4gKiBAY29uc3RydWN0b3JcbiAqIEBpbXBsZW1lbnRzIHtPcGVyYXRpb259XG4gKi9cbnZhciBNZXJnZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBNZXJnZShcbiAgICAgICAgLyoqQGluaGVyaXREb2MgKi8gc291cmNlLCBcbiAgICAgICAgLyoqQGluaGVyaXREb2MgKi8gcGF0aCwgXG4gICAgICAgIC8qKkBpbmhlcml0RG9jICovIGNoaWxkcmVuKSB7XG4gICAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgICB0aGlzLnBhdGggPSBwYXRoO1xuICAgICAgICB0aGlzLmNoaWxkcmVuID0gY2hpbGRyZW47XG4gICAgICAgIC8qKiBAaW5oZXJpdERvYyAqL1xuICAgICAgICB0aGlzLnR5cGUgPSBPcGVyYXRpb25fMS5PcGVyYXRpb25UeXBlLk1FUkdFO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIE1lcmdlLnByb3RvdHlwZS5vcGVyYXRpb25Gb3JDaGlsZCA9IGZ1bmN0aW9uIChjaGlsZE5hbWUpIHtcbiAgICAgICAgaWYgKHRoaXMucGF0aC5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgIHZhciBjaGlsZFRyZWUgPSB0aGlzLmNoaWxkcmVuLnN1YnRyZWUobmV3IFBhdGhfMS5QYXRoKGNoaWxkTmFtZSkpO1xuICAgICAgICAgICAgaWYgKGNoaWxkVHJlZS5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgICAgICAvLyBUaGlzIGNoaWxkIGlzIHVuYWZmZWN0ZWRcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGNoaWxkVHJlZS52YWx1ZSkge1xuICAgICAgICAgICAgICAgIC8vIFdlIGhhdmUgYSBzbmFwc2hvdCBmb3IgdGhlIGNoaWxkIGluIHF1ZXN0aW9uLiAgVGhpcyBiZWNvbWVzIGFuIG92ZXJ3cml0ZSBvZiB0aGUgY2hpbGQuXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBPdmVyd3JpdGVfMS5PdmVyd3JpdGUodGhpcy5zb3VyY2UsIFBhdGhfMS5QYXRoLkVtcHR5LCBjaGlsZFRyZWUudmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gVGhpcyBpcyBhIG1lcmdlIGF0IGEgZGVlcGVyIGxldmVsXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBNZXJnZSh0aGlzLnNvdXJjZSwgUGF0aF8xLlBhdGguRW1wdHksIGNoaWxkVHJlZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB1dGlsXzEuYXNzZXJ0KHRoaXMucGF0aC5nZXRGcm9udCgpID09PSBjaGlsZE5hbWUsIFwiQ2FuJ3QgZ2V0IGEgbWVyZ2UgZm9yIGEgY2hpbGQgbm90IG9uIHRoZSBwYXRoIG9mIHRoZSBvcGVyYXRpb25cIik7XG4gICAgICAgICAgICByZXR1cm4gbmV3IE1lcmdlKHRoaXMuc291cmNlLCB0aGlzLnBhdGgucG9wRnJvbnQoKSwgdGhpcy5jaGlsZHJlbik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgTWVyZ2UucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKCdPcGVyYXRpb24oJyArXG4gICAgICAgICAgICB0aGlzLnBhdGggK1xuICAgICAgICAgICAgJzogJyArXG4gICAgICAgICAgICB0aGlzLnNvdXJjZS50b1N0cmluZygpICtcbiAgICAgICAgICAgICcgbWVyZ2U6ICcgK1xuICAgICAgICAgICAgdGhpcy5jaGlsZHJlbi50b1N0cmluZygpICtcbiAgICAgICAgICAgICcpJyk7XG4gICAgfTtcbiAgICByZXR1cm4gTWVyZ2U7XG59KCkpO1xuZXhwb3J0cy5NZXJnZSA9IE1lcmdlO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1NZXJnZS5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB1dGlsXzEgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG4vKipcbiAqXG4gKiBAZW51bVxuICovXG52YXIgT3BlcmF0aW9uVHlwZTtcbihmdW5jdGlvbiAoT3BlcmF0aW9uVHlwZSkge1xuICAgIE9wZXJhdGlvblR5cGVbT3BlcmF0aW9uVHlwZVtcIk9WRVJXUklURVwiXSA9IDBdID0gXCJPVkVSV1JJVEVcIjtcbiAgICBPcGVyYXRpb25UeXBlW09wZXJhdGlvblR5cGVbXCJNRVJHRVwiXSA9IDFdID0gXCJNRVJHRVwiO1xuICAgIE9wZXJhdGlvblR5cGVbT3BlcmF0aW9uVHlwZVtcIkFDS19VU0VSX1dSSVRFXCJdID0gMl0gPSBcIkFDS19VU0VSX1dSSVRFXCI7XG4gICAgT3BlcmF0aW9uVHlwZVtPcGVyYXRpb25UeXBlW1wiTElTVEVOX0NPTVBMRVRFXCJdID0gM10gPSBcIkxJU1RFTl9DT01QTEVURVwiO1xufSkoT3BlcmF0aW9uVHlwZSA9IGV4cG9ydHMuT3BlcmF0aW9uVHlwZSB8fCAoZXhwb3J0cy5PcGVyYXRpb25UeXBlID0ge30pKTtcbi8qKlxuICogQHBhcmFtIHtib29sZWFufSBmcm9tVXNlclxuICogQHBhcmFtIHtib29sZWFufSBmcm9tU2VydmVyXG4gKiBAcGFyYW0gez9zdHJpbmd9IHF1ZXJ5SWRcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gdGFnZ2VkXG4gKiBAY29uc3RydWN0b3JcbiAqL1xudmFyIE9wZXJhdGlvblNvdXJjZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBPcGVyYXRpb25Tb3VyY2UoZnJvbVVzZXIsIGZyb21TZXJ2ZXIsIHF1ZXJ5SWQsIHRhZ2dlZCkge1xuICAgICAgICB0aGlzLmZyb21Vc2VyID0gZnJvbVVzZXI7XG4gICAgICAgIHRoaXMuZnJvbVNlcnZlciA9IGZyb21TZXJ2ZXI7XG4gICAgICAgIHRoaXMucXVlcnlJZCA9IHF1ZXJ5SWQ7XG4gICAgICAgIHRoaXMudGFnZ2VkID0gdGFnZ2VkO1xuICAgICAgICB1dGlsXzEuYXNzZXJ0KCF0YWdnZWQgfHwgZnJvbVNlcnZlciwgJ1RhZ2dlZCBxdWVyaWVzIG11c3QgYmUgZnJvbSBzZXJ2ZXIuJyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBjb25zdFxuICAgICAqIEB0eXBlIHshT3BlcmF0aW9uU291cmNlfVxuICAgICAqL1xuICAgIE9wZXJhdGlvblNvdXJjZS5Vc2VyID0gbmV3IE9wZXJhdGlvblNvdXJjZShcbiAgICAvKmZyb21Vc2VyPSovIHRydWUsIGZhbHNlLCBudWxsLCBcbiAgICAvKnRhZ2dlZD0qLyBmYWxzZSk7XG4gICAgLyoqXG4gICAgICogQGNvbnN0XG4gICAgICogQHR5cGUgeyFPcGVyYXRpb25Tb3VyY2V9XG4gICAgICovXG4gICAgT3BlcmF0aW9uU291cmNlLlNlcnZlciA9IG5ldyBPcGVyYXRpb25Tb3VyY2UoZmFsc2UsIFxuICAgIC8qZnJvbVNlcnZlcj0qLyB0cnVlLCBudWxsLCBcbiAgICAvKnRhZ2dlZD0qLyBmYWxzZSk7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHF1ZXJ5SWRcbiAgICAgKiBAcmV0dXJuIHshT3BlcmF0aW9uU291cmNlfVxuICAgICAqL1xuICAgIE9wZXJhdGlvblNvdXJjZS5mb3JTZXJ2ZXJUYWdnZWRRdWVyeSA9IGZ1bmN0aW9uIChxdWVyeUlkKSB7XG4gICAgICAgIHJldHVybiBuZXcgT3BlcmF0aW9uU291cmNlKGZhbHNlLCBcbiAgICAgICAgLypmcm9tU2VydmVyPSovIHRydWUsIHF1ZXJ5SWQsIFxuICAgICAgICAvKnRhZ2dlZD0qLyB0cnVlKTtcbiAgICB9O1xuICAgIHJldHVybiBPcGVyYXRpb25Tb3VyY2U7XG59KCkpO1xuZXhwb3J0cy5PcGVyYXRpb25Tb3VyY2UgPSBPcGVyYXRpb25Tb3VyY2U7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPU9wZXJhdGlvbi5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBPcGVyYXRpb25fMSA9IHJlcXVpcmUoXCIuL09wZXJhdGlvblwiKTtcbnZhciBQYXRoXzEgPSByZXF1aXJlKFwiLi4vdXRpbC9QYXRoXCIpO1xuLyoqXG4gKiBAcGFyYW0geyFPcGVyYXRpb25Tb3VyY2V9IHNvdXJjZVxuICogQHBhcmFtIHshUGF0aH0gcGF0aFxuICogQHBhcmFtIHshTm9kZX0gc25hcFxuICogQGNvbnN0cnVjdG9yXG4gKiBAaW1wbGVtZW50cyB7T3BlcmF0aW9ufVxuICovXG52YXIgT3ZlcndyaXRlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE92ZXJ3cml0ZShzb3VyY2UsIHBhdGgsIHNuYXApIHtcbiAgICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICAgIHRoaXMucGF0aCA9IHBhdGg7XG4gICAgICAgIHRoaXMuc25hcCA9IHNuYXA7XG4gICAgICAgIC8qKiBAaW5oZXJpdERvYyAqL1xuICAgICAgICB0aGlzLnR5cGUgPSBPcGVyYXRpb25fMS5PcGVyYXRpb25UeXBlLk9WRVJXUklURTtcbiAgICB9XG4gICAgT3ZlcndyaXRlLnByb3RvdHlwZS5vcGVyYXRpb25Gb3JDaGlsZCA9IGZ1bmN0aW9uIChjaGlsZE5hbWUpIHtcbiAgICAgICAgaWYgKHRoaXMucGF0aC5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgT3ZlcndyaXRlKHRoaXMuc291cmNlLCBQYXRoXzEuUGF0aC5FbXB0eSwgdGhpcy5zbmFwLmdldEltbWVkaWF0ZUNoaWxkKGNoaWxkTmFtZSkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBPdmVyd3JpdGUodGhpcy5zb3VyY2UsIHRoaXMucGF0aC5wb3BGcm9udCgpLCB0aGlzLnNuYXApO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gT3ZlcndyaXRlO1xufSgpKTtcbmV4cG9ydHMuT3ZlcndyaXRlID0gT3ZlcndyaXRlO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1PdmVyd3JpdGUuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG52YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB1dGlsXzEgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG52YXIgdXRpbF8yID0gcmVxdWlyZShcIi4uL3V0aWwvdXRpbFwiKTtcbnZhciBTb3J0ZWRNYXBfMSA9IHJlcXVpcmUoXCIuLi91dGlsL1NvcnRlZE1hcFwiKTtcbnZhciBOb2RlXzEgPSByZXF1aXJlKFwiLi9Ob2RlXCIpO1xudmFyIHNuYXBfMSA9IHJlcXVpcmUoXCIuL3NuYXBcIik7XG52YXIgUHJpb3JpdHlJbmRleF8xID0gcmVxdWlyZShcIi4vaW5kZXhlcy9Qcmlvcml0eUluZGV4XCIpO1xudmFyIEtleUluZGV4XzEgPSByZXF1aXJlKFwiLi9pbmRleGVzL0tleUluZGV4XCIpO1xudmFyIEluZGV4TWFwXzEgPSByZXF1aXJlKFwiLi9JbmRleE1hcFwiKTtcbnZhciBMZWFmTm9kZV8xID0gcmVxdWlyZShcIi4vTGVhZk5vZGVcIik7XG52YXIgY29tcGFyYXRvcnNfMSA9IHJlcXVpcmUoXCIuL2NvbXBhcmF0b3JzXCIpO1xuLy8gVE9ETzogRm9yIG1lbW9yeSBzYXZpbmdzLCBkb24ndCBzdG9yZSBwcmlvcml0eU5vZGVfIGlmIGl0J3MgZW1wdHkuXG52YXIgRU1QVFlfTk9ERTtcbi8qKlxuICogQ2hpbGRyZW5Ob2RlIGlzIGEgY2xhc3MgZm9yIHN0b3JpbmcgaW50ZXJuYWwgbm9kZXMgaW4gYSBEYXRhU25hcHNob3RcbiAqIChpLmUuIG5vZGVzIHdpdGggY2hpbGRyZW4pLiAgSXQgaW1wbGVtZW50cyBOb2RlIGFuZCBzdG9yZXMgdGhlXG4gKiBsaXN0IG9mIGNoaWxkcmVuIGluIHRoZSBjaGlsZHJlbiBwcm9wZXJ0eSwgc29ydGVkIGJ5IGNoaWxkIG5hbWUuXG4gKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAaW1wbGVtZW50cyB7Tm9kZX1cbiAqL1xudmFyIENoaWxkcmVuTm9kZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7IVNvcnRlZE1hcC48c3RyaW5nLCAhTm9kZT59IGNoaWxkcmVuXyBMaXN0IG9mIGNoaWxkcmVuXG4gICAgICogb2YgdGhpcyBub2RlLi5cbiAgICAgKiBAcGFyYW0gez9Ob2RlfSBwcmlvcml0eU5vZGVfIFRoZSBwcmlvcml0eSBvZiB0aGlzIG5vZGUgKGFzIGEgc25hcHNob3Qgbm9kZSkuXG4gICAgICogQHBhcmFtIHshSW5kZXhNYXB9IGluZGV4TWFwX1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIENoaWxkcmVuTm9kZShjaGlsZHJlbl8sIHByaW9yaXR5Tm9kZV8sIGluZGV4TWFwXykge1xuICAgICAgICB0aGlzLmNoaWxkcmVuXyA9IGNoaWxkcmVuXztcbiAgICAgICAgdGhpcy5wcmlvcml0eU5vZGVfID0gcHJpb3JpdHlOb2RlXztcbiAgICAgICAgdGhpcy5pbmRleE1hcF8gPSBpbmRleE1hcF87XG4gICAgICAgIHRoaXMubGF6eUhhc2hfID0gbnVsbDtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIE5vdGU6IFRoZSBvbmx5IHJlYXNvbiB3ZSBhbGxvdyBudWxsIHByaW9yaXR5IGlzIGZvciBFTVBUWV9OT0RFLCBzaW5jZSB3ZSBjYW4ndCB1c2VcbiAgICAgICAgICogRU1QVFlfTk9ERSBhcyB0aGUgcHJpb3JpdHkgb2YgRU1QVFlfTk9ERS4gIFdlIG1pZ2h0IHdhbnQgdG8gY29uc2lkZXIgbWFraW5nIEVNUFRZX05PREUgaXRzIG93blxuICAgICAgICAgKiBjbGFzcyBpbnN0ZWFkIG9mIGFuIGVtcHR5IENoaWxkcmVuTm9kZS5cbiAgICAgICAgICovXG4gICAgICAgIGlmICh0aGlzLnByaW9yaXR5Tm9kZV8pIHtcbiAgICAgICAgICAgIHNuYXBfMS52YWxpZGF0ZVByaW9yaXR5Tm9kZSh0aGlzLnByaW9yaXR5Tm9kZV8pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmNoaWxkcmVuXy5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgIHV0aWxfMS5hc3NlcnQoIXRoaXMucHJpb3JpdHlOb2RlXyB8fCB0aGlzLnByaW9yaXR5Tm9kZV8uaXNFbXB0eSgpLCAnQW4gZW1wdHkgbm9kZSBjYW5ub3QgaGF2ZSBhIHByaW9yaXR5Jyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENoaWxkcmVuTm9kZSwgXCJFTVBUWV9OT0RFXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gKEVNUFRZX05PREUgfHxcbiAgICAgICAgICAgICAgICAoRU1QVFlfTk9ERSA9IG5ldyBDaGlsZHJlbk5vZGUobmV3IFNvcnRlZE1hcF8xLlNvcnRlZE1hcChjb21wYXJhdG9yc18xLk5BTUVfQ09NUEFSQVRPUiksIG51bGwsIEluZGV4TWFwXzEuSW5kZXhNYXAuRGVmYXVsdCkpKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgLyoqIEBpbmhlcml0RG9jICovXG4gICAgQ2hpbGRyZW5Ob2RlLnByb3RvdHlwZS5pc0xlYWZOb2RlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICAvKiogQGluaGVyaXREb2MgKi9cbiAgICBDaGlsZHJlbk5vZGUucHJvdG90eXBlLmdldFByaW9yaXR5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcmlvcml0eU5vZGVfIHx8IEVNUFRZX05PREU7XG4gICAgfTtcbiAgICAvKiogQGluaGVyaXREb2MgKi9cbiAgICBDaGlsZHJlbk5vZGUucHJvdG90eXBlLnVwZGF0ZVByaW9yaXR5ID0gZnVuY3Rpb24gKG5ld1ByaW9yaXR5Tm9kZSkge1xuICAgICAgICBpZiAodGhpcy5jaGlsZHJlbl8uaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAvLyBEb24ndCBhbGxvdyBwcmlvcml0aWVzIG9uIGVtcHR5IG5vZGVzXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgQ2hpbGRyZW5Ob2RlKHRoaXMuY2hpbGRyZW5fLCBuZXdQcmlvcml0eU5vZGUsIHRoaXMuaW5kZXhNYXBfKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqIEBpbmhlcml0RG9jICovXG4gICAgQ2hpbGRyZW5Ob2RlLnByb3RvdHlwZS5nZXRJbW1lZGlhdGVDaGlsZCA9IGZ1bmN0aW9uIChjaGlsZE5hbWUpIHtcbiAgICAgICAgLy8gSGFjayB0byB0cmVhdCBwcmlvcml0eSBhcyBhIHJlZ3VsYXIgY2hpbGRcbiAgICAgICAgaWYgKGNoaWxkTmFtZSA9PT0gJy5wcmlvcml0eScpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFByaW9yaXR5KCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgY2hpbGQgPSB0aGlzLmNoaWxkcmVuXy5nZXQoY2hpbGROYW1lKTtcbiAgICAgICAgICAgIHJldHVybiBjaGlsZCA9PT0gbnVsbCA/IEVNUFRZX05PREUgOiBjaGlsZDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqIEBpbmhlcml0RG9jICovXG4gICAgQ2hpbGRyZW5Ob2RlLnByb3RvdHlwZS5nZXRDaGlsZCA9IGZ1bmN0aW9uIChwYXRoKSB7XG4gICAgICAgIHZhciBmcm9udCA9IHBhdGguZ2V0RnJvbnQoKTtcbiAgICAgICAgaWYgKGZyb250ID09PSBudWxsKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIHJldHVybiB0aGlzLmdldEltbWVkaWF0ZUNoaWxkKGZyb250KS5nZXRDaGlsZChwYXRoLnBvcEZyb250KCkpO1xuICAgIH07XG4gICAgLyoqIEBpbmhlcml0RG9jICovXG4gICAgQ2hpbGRyZW5Ob2RlLnByb3RvdHlwZS5oYXNDaGlsZCA9IGZ1bmN0aW9uIChjaGlsZE5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hpbGRyZW5fLmdldChjaGlsZE5hbWUpICE9PSBudWxsO1xuICAgIH07XG4gICAgLyoqIEBpbmhlcml0RG9jICovXG4gICAgQ2hpbGRyZW5Ob2RlLnByb3RvdHlwZS51cGRhdGVJbW1lZGlhdGVDaGlsZCA9IGZ1bmN0aW9uIChjaGlsZE5hbWUsIG5ld0NoaWxkTm9kZSkge1xuICAgICAgICB1dGlsXzEuYXNzZXJ0KG5ld0NoaWxkTm9kZSwgJ1dlIHNob3VsZCBhbHdheXMgYmUgcGFzc2luZyBzbmFwc2hvdCBub2RlcycpO1xuICAgICAgICBpZiAoY2hpbGROYW1lID09PSAnLnByaW9yaXR5Jykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudXBkYXRlUHJpb3JpdHkobmV3Q2hpbGROb2RlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBuYW1lZE5vZGUgPSBuZXcgTm9kZV8xLk5hbWVkTm9kZShjaGlsZE5hbWUsIG5ld0NoaWxkTm9kZSk7XG4gICAgICAgICAgICB2YXIgbmV3Q2hpbGRyZW4gPSB2b2lkIDAsIG5ld0luZGV4TWFwID0gdm9pZCAwLCBuZXdQcmlvcml0eSA9IHZvaWQgMDtcbiAgICAgICAgICAgIGlmIChuZXdDaGlsZE5vZGUuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgbmV3Q2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuXy5yZW1vdmUoY2hpbGROYW1lKTtcbiAgICAgICAgICAgICAgICBuZXdJbmRleE1hcCA9IHRoaXMuaW5kZXhNYXBfLnJlbW92ZUZyb21JbmRleGVzKG5hbWVkTm9kZSwgdGhpcy5jaGlsZHJlbl8pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbmV3Q2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuXy5pbnNlcnQoY2hpbGROYW1lLCBuZXdDaGlsZE5vZGUpO1xuICAgICAgICAgICAgICAgIG5ld0luZGV4TWFwID0gdGhpcy5pbmRleE1hcF8uYWRkVG9JbmRleGVzKG5hbWVkTm9kZSwgdGhpcy5jaGlsZHJlbl8pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbmV3UHJpb3JpdHkgPSBuZXdDaGlsZHJlbi5pc0VtcHR5KCkgPyBFTVBUWV9OT0RFIDogdGhpcy5wcmlvcml0eU5vZGVfO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBDaGlsZHJlbk5vZGUobmV3Q2hpbGRyZW4sIG5ld1ByaW9yaXR5LCBuZXdJbmRleE1hcCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKiBAaW5oZXJpdERvYyAqL1xuICAgIENoaWxkcmVuTm9kZS5wcm90b3R5cGUudXBkYXRlQ2hpbGQgPSBmdW5jdGlvbiAocGF0aCwgbmV3Q2hpbGROb2RlKSB7XG4gICAgICAgIHZhciBmcm9udCA9IHBhdGguZ2V0RnJvbnQoKTtcbiAgICAgICAgaWYgKGZyb250ID09PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3Q2hpbGROb2RlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdXRpbF8xLmFzc2VydChwYXRoLmdldEZyb250KCkgIT09ICcucHJpb3JpdHknIHx8IHBhdGguZ2V0TGVuZ3RoKCkgPT09IDEsICcucHJpb3JpdHkgbXVzdCBiZSB0aGUgbGFzdCB0b2tlbiBpbiBhIHBhdGgnKTtcbiAgICAgICAgICAgIHZhciBuZXdJbW1lZGlhdGVDaGlsZCA9IHRoaXMuZ2V0SW1tZWRpYXRlQ2hpbGQoZnJvbnQpLnVwZGF0ZUNoaWxkKHBhdGgucG9wRnJvbnQoKSwgbmV3Q2hpbGROb2RlKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnVwZGF0ZUltbWVkaWF0ZUNoaWxkKGZyb250LCBuZXdJbW1lZGlhdGVDaGlsZCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKiBAaW5oZXJpdERvYyAqL1xuICAgIENoaWxkcmVuTm9kZS5wcm90b3R5cGUuaXNFbXB0eSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hpbGRyZW5fLmlzRW1wdHkoKTtcbiAgICB9O1xuICAgIC8qKiBAaW5oZXJpdERvYyAqL1xuICAgIENoaWxkcmVuTm9kZS5wcm90b3R5cGUubnVtQ2hpbGRyZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNoaWxkcmVuXy5jb3VudCgpO1xuICAgIH07XG4gICAgLyoqIEBpbmhlcml0RG9jICovXG4gICAgQ2hpbGRyZW5Ob2RlLnByb3RvdHlwZS52YWwgPSBmdW5jdGlvbiAoZXhwb3J0Rm9ybWF0KSB7XG4gICAgICAgIGlmICh0aGlzLmlzRW1wdHkoKSlcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB2YXIgb2JqID0ge307XG4gICAgICAgIHZhciBudW1LZXlzID0gMCwgbWF4S2V5ID0gMCwgYWxsSW50ZWdlcktleXMgPSB0cnVlO1xuICAgICAgICB0aGlzLmZvckVhY2hDaGlsZChQcmlvcml0eUluZGV4XzEuUFJJT1JJVFlfSU5ERVgsIGZ1bmN0aW9uIChrZXksIGNoaWxkTm9kZSkge1xuICAgICAgICAgICAgb2JqW2tleV0gPSBjaGlsZE5vZGUudmFsKGV4cG9ydEZvcm1hdCk7XG4gICAgICAgICAgICBudW1LZXlzKys7XG4gICAgICAgICAgICBpZiAoYWxsSW50ZWdlcktleXMgJiYgQ2hpbGRyZW5Ob2RlLklOVEVHRVJfUkVHRVhQXy50ZXN0KGtleSkpIHtcbiAgICAgICAgICAgICAgICBtYXhLZXkgPSBNYXRoLm1heChtYXhLZXksIE51bWJlcihrZXkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGFsbEludGVnZXJLZXlzID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIWV4cG9ydEZvcm1hdCAmJiBhbGxJbnRlZ2VyS2V5cyAmJiBtYXhLZXkgPCAyICogbnVtS2V5cykge1xuICAgICAgICAgICAgLy8gY29udmVydCB0byBhcnJheS5cbiAgICAgICAgICAgIHZhciBhcnJheSA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIG9iailcbiAgICAgICAgICAgICAgICBhcnJheVtrZXldID0gb2JqW2tleV07XG4gICAgICAgICAgICByZXR1cm4gYXJyYXk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoZXhwb3J0Rm9ybWF0ICYmICF0aGlzLmdldFByaW9yaXR5KCkuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgb2JqWycucHJpb3JpdHknXSA9IHRoaXMuZ2V0UHJpb3JpdHkoKS52YWwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBvYmo7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKiBAaW5oZXJpdERvYyAqL1xuICAgIENoaWxkcmVuTm9kZS5wcm90b3R5cGUuaGFzaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMubGF6eUhhc2hfID09PSBudWxsKSB7XG4gICAgICAgICAgICB2YXIgdG9IYXNoXzEgPSAnJztcbiAgICAgICAgICAgIGlmICghdGhpcy5nZXRQcmlvcml0eSgpLmlzRW1wdHkoKSlcbiAgICAgICAgICAgICAgICB0b0hhc2hfMSArPVxuICAgICAgICAgICAgICAgICAgICAncHJpb3JpdHk6JyArXG4gICAgICAgICAgICAgICAgICAgICAgICBzbmFwXzEucHJpb3JpdHlIYXNoVGV4dCh0aGlzLmdldFByaW9yaXR5KCkudmFsKCkpICtcbiAgICAgICAgICAgICAgICAgICAgICAgICc6JztcbiAgICAgICAgICAgIHRoaXMuZm9yRWFjaENoaWxkKFByaW9yaXR5SW5kZXhfMS5QUklPUklUWV9JTkRFWCwgZnVuY3Rpb24gKGtleSwgY2hpbGROb2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkSGFzaCA9IGNoaWxkTm9kZS5oYXNoKCk7XG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkSGFzaCAhPT0gJycpXG4gICAgICAgICAgICAgICAgICAgIHRvSGFzaF8xICs9ICc6JyArIGtleSArICc6JyArIGNoaWxkSGFzaDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5sYXp5SGFzaF8gPSB0b0hhc2hfMSA9PT0gJycgPyAnJyA6IHV0aWxfMi5zaGExKHRvSGFzaF8xKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5sYXp5SGFzaF87XG4gICAgfTtcbiAgICAvKiogQGluaGVyaXREb2MgKi9cbiAgICBDaGlsZHJlbk5vZGUucHJvdG90eXBlLmdldFByZWRlY2Vzc29yQ2hpbGROYW1lID0gZnVuY3Rpb24gKGNoaWxkTmFtZSwgY2hpbGROb2RlLCBpbmRleCkge1xuICAgICAgICB2YXIgaWR4ID0gdGhpcy5yZXNvbHZlSW5kZXhfKGluZGV4KTtcbiAgICAgICAgaWYgKGlkeCkge1xuICAgICAgICAgICAgdmFyIHByZWRlY2Vzc29yID0gaWR4LmdldFByZWRlY2Vzc29yS2V5KG5ldyBOb2RlXzEuTmFtZWROb2RlKGNoaWxkTmFtZSwgY2hpbGROb2RlKSk7XG4gICAgICAgICAgICByZXR1cm4gcHJlZGVjZXNzb3IgPyBwcmVkZWNlc3Nvci5uYW1lIDogbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNoaWxkcmVuXy5nZXRQcmVkZWNlc3NvcktleShjaGlsZE5hbWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFJbmRleH0gaW5kZXhEZWZpbml0aW9uXG4gICAgICogQHJldHVybiB7P3N0cmluZ31cbiAgICAgKi9cbiAgICBDaGlsZHJlbk5vZGUucHJvdG90eXBlLmdldEZpcnN0Q2hpbGROYW1lID0gZnVuY3Rpb24gKGluZGV4RGVmaW5pdGlvbikge1xuICAgICAgICB2YXIgaWR4ID0gdGhpcy5yZXNvbHZlSW5kZXhfKGluZGV4RGVmaW5pdGlvbik7XG4gICAgICAgIGlmIChpZHgpIHtcbiAgICAgICAgICAgIHZhciBtaW5LZXkgPSBpZHgubWluS2V5KCk7XG4gICAgICAgICAgICByZXR1cm4gbWluS2V5ICYmIG1pbktleS5uYW1lO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2hpbGRyZW5fLm1pbktleSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFJbmRleH0gaW5kZXhEZWZpbml0aW9uXG4gICAgICogQHJldHVybiB7P05hbWVkTm9kZX1cbiAgICAgKi9cbiAgICBDaGlsZHJlbk5vZGUucHJvdG90eXBlLmdldEZpcnN0Q2hpbGQgPSBmdW5jdGlvbiAoaW5kZXhEZWZpbml0aW9uKSB7XG4gICAgICAgIHZhciBtaW5LZXkgPSB0aGlzLmdldEZpcnN0Q2hpbGROYW1lKGluZGV4RGVmaW5pdGlvbik7XG4gICAgICAgIGlmIChtaW5LZXkpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgTm9kZV8xLk5hbWVkTm9kZShtaW5LZXksIHRoaXMuY2hpbGRyZW5fLmdldChtaW5LZXkpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHaXZlbiBhbiBpbmRleCwgcmV0dXJuIHRoZSBrZXkgbmFtZSBvZiB0aGUgbGFyZ2VzdCB2YWx1ZSB3ZSBoYXZlLCBhY2NvcmRpbmcgdG8gdGhhdCBpbmRleFxuICAgICAqIEBwYXJhbSB7IUluZGV4fSBpbmRleERlZmluaXRpb25cbiAgICAgKiBAcmV0dXJuIHs/c3RyaW5nfVxuICAgICAqL1xuICAgIENoaWxkcmVuTm9kZS5wcm90b3R5cGUuZ2V0TGFzdENoaWxkTmFtZSA9IGZ1bmN0aW9uIChpbmRleERlZmluaXRpb24pIHtcbiAgICAgICAgdmFyIGlkeCA9IHRoaXMucmVzb2x2ZUluZGV4XyhpbmRleERlZmluaXRpb24pO1xuICAgICAgICBpZiAoaWR4KSB7XG4gICAgICAgICAgICB2YXIgbWF4S2V5ID0gaWR4Lm1heEtleSgpO1xuICAgICAgICAgICAgcmV0dXJuIG1heEtleSAmJiBtYXhLZXkubmFtZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNoaWxkcmVuXy5tYXhLZXkoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshSW5kZXh9IGluZGV4RGVmaW5pdGlvblxuICAgICAqIEByZXR1cm4gez9OYW1lZE5vZGV9XG4gICAgICovXG4gICAgQ2hpbGRyZW5Ob2RlLnByb3RvdHlwZS5nZXRMYXN0Q2hpbGQgPSBmdW5jdGlvbiAoaW5kZXhEZWZpbml0aW9uKSB7XG4gICAgICAgIHZhciBtYXhLZXkgPSB0aGlzLmdldExhc3RDaGlsZE5hbWUoaW5kZXhEZWZpbml0aW9uKTtcbiAgICAgICAgaWYgKG1heEtleSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBOb2RlXzEuTmFtZWROb2RlKG1heEtleSwgdGhpcy5jaGlsZHJlbl8uZ2V0KG1heEtleSkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgQ2hpbGRyZW5Ob2RlLnByb3RvdHlwZS5mb3JFYWNoQ2hpbGQgPSBmdW5jdGlvbiAoaW5kZXgsIGFjdGlvbikge1xuICAgICAgICB2YXIgaWR4ID0gdGhpcy5yZXNvbHZlSW5kZXhfKGluZGV4KTtcbiAgICAgICAgaWYgKGlkeCkge1xuICAgICAgICAgICAgcmV0dXJuIGlkeC5pbm9yZGVyVHJhdmVyc2FsKGZ1bmN0aW9uICh3cmFwcGVkTm9kZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb24od3JhcHBlZE5vZGUubmFtZSwgd3JhcHBlZE5vZGUubm9kZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNoaWxkcmVuXy5pbm9yZGVyVHJhdmVyc2FsKGFjdGlvbik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7IUluZGV4fSBpbmRleERlZmluaXRpb25cbiAgICAgKiBAcmV0dXJuIHtTb3J0ZWRNYXBJdGVyYXRvcn1cbiAgICAgKi9cbiAgICBDaGlsZHJlbk5vZGUucHJvdG90eXBlLmdldEl0ZXJhdG9yID0gZnVuY3Rpb24gKGluZGV4RGVmaW5pdGlvbikge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRJdGVyYXRvckZyb20oaW5kZXhEZWZpbml0aW9uLm1pblBvc3QoKSwgaW5kZXhEZWZpbml0aW9uKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqXG4gICAgICogQHBhcmFtIHshTmFtZWROb2RlfSBzdGFydFBvc3RcbiAgICAgKiBAcGFyYW0geyFJbmRleH0gaW5kZXhEZWZpbml0aW9uXG4gICAgICogQHJldHVybiB7IVNvcnRlZE1hcEl0ZXJhdG9yfVxuICAgICAqL1xuICAgIENoaWxkcmVuTm9kZS5wcm90b3R5cGUuZ2V0SXRlcmF0b3JGcm9tID0gZnVuY3Rpb24gKHN0YXJ0UG9zdCwgaW5kZXhEZWZpbml0aW9uKSB7XG4gICAgICAgIHZhciBpZHggPSB0aGlzLnJlc29sdmVJbmRleF8oaW5kZXhEZWZpbml0aW9uKTtcbiAgICAgICAgaWYgKGlkeCkge1xuICAgICAgICAgICAgcmV0dXJuIGlkeC5nZXRJdGVyYXRvckZyb20oc3RhcnRQb3N0LCBmdW5jdGlvbiAoa2V5KSB7IHJldHVybiBrZXk7IH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIGl0ZXJhdG9yID0gdGhpcy5jaGlsZHJlbl8uZ2V0SXRlcmF0b3JGcm9tKHN0YXJ0UG9zdC5uYW1lLCBOb2RlXzEuTmFtZWROb2RlLldyYXApO1xuICAgICAgICAgICAgdmFyIG5leHQgPSBpdGVyYXRvci5wZWVrKCk7XG4gICAgICAgICAgICB3aGlsZSAobmV4dCAhPSBudWxsICYmIGluZGV4RGVmaW5pdGlvbi5jb21wYXJlKG5leHQsIHN0YXJ0UG9zdCkgPCAwKSB7XG4gICAgICAgICAgICAgICAgaXRlcmF0b3IuZ2V0TmV4dCgpO1xuICAgICAgICAgICAgICAgIG5leHQgPSBpdGVyYXRvci5wZWVrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gaXRlcmF0b3I7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7IUluZGV4fSBpbmRleERlZmluaXRpb25cbiAgICAgKiBAcmV0dXJuIHshU29ydGVkTWFwSXRlcmF0b3J9XG4gICAgICovXG4gICAgQ2hpbGRyZW5Ob2RlLnByb3RvdHlwZS5nZXRSZXZlcnNlSXRlcmF0b3IgPSBmdW5jdGlvbiAoaW5kZXhEZWZpbml0aW9uKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFJldmVyc2VJdGVyYXRvckZyb20oaW5kZXhEZWZpbml0aW9uLm1heFBvc3QoKSwgaW5kZXhEZWZpbml0aW9uKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7IU5hbWVkTm9kZX0gZW5kUG9zdFxuICAgICAqIEBwYXJhbSB7IUluZGV4fSBpbmRleERlZmluaXRpb25cbiAgICAgKiBAcmV0dXJuIHshU29ydGVkTWFwSXRlcmF0b3J9XG4gICAgICovXG4gICAgQ2hpbGRyZW5Ob2RlLnByb3RvdHlwZS5nZXRSZXZlcnNlSXRlcmF0b3JGcm9tID0gZnVuY3Rpb24gKGVuZFBvc3QsIGluZGV4RGVmaW5pdGlvbikge1xuICAgICAgICB2YXIgaWR4ID0gdGhpcy5yZXNvbHZlSW5kZXhfKGluZGV4RGVmaW5pdGlvbik7XG4gICAgICAgIGlmIChpZHgpIHtcbiAgICAgICAgICAgIHJldHVybiBpZHguZ2V0UmV2ZXJzZUl0ZXJhdG9yRnJvbShlbmRQb3N0LCBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGtleTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIGl0ZXJhdG9yID0gdGhpcy5jaGlsZHJlbl8uZ2V0UmV2ZXJzZUl0ZXJhdG9yRnJvbShlbmRQb3N0Lm5hbWUsIE5vZGVfMS5OYW1lZE5vZGUuV3JhcCk7XG4gICAgICAgICAgICB2YXIgbmV4dCA9IGl0ZXJhdG9yLnBlZWsoKTtcbiAgICAgICAgICAgIHdoaWxlIChuZXh0ICE9IG51bGwgJiYgaW5kZXhEZWZpbml0aW9uLmNvbXBhcmUobmV4dCwgZW5kUG9zdCkgPiAwKSB7XG4gICAgICAgICAgICAgICAgaXRlcmF0b3IuZ2V0TmV4dCgpO1xuICAgICAgICAgICAgICAgIG5leHQgPSBpdGVyYXRvci5wZWVrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gaXRlcmF0b3I7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgQ2hpbGRyZW5Ob2RlLnByb3RvdHlwZS5jb21wYXJlVG8gPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICBpZiAob3RoZXIuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAob3RoZXIuaXNMZWFmTm9kZSgpIHx8IG90aGVyLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAob3RoZXIgPT09IGV4cG9ydHMuTUFYX05PREUpIHtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIE11c3QgYmUgYW5vdGhlciBub2RlIHdpdGggY2hpbGRyZW4uXG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBDaGlsZHJlbk5vZGUucHJvdG90eXBlLndpdGhJbmRleCA9IGZ1bmN0aW9uIChpbmRleERlZmluaXRpb24pIHtcbiAgICAgICAgaWYgKGluZGV4RGVmaW5pdGlvbiA9PT0gS2V5SW5kZXhfMS5LRVlfSU5ERVggfHxcbiAgICAgICAgICAgIHRoaXMuaW5kZXhNYXBfLmhhc0luZGV4KGluZGV4RGVmaW5pdGlvbikpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIG5ld0luZGV4TWFwID0gdGhpcy5pbmRleE1hcF8uYWRkSW5kZXgoaW5kZXhEZWZpbml0aW9uLCB0aGlzLmNoaWxkcmVuXyk7XG4gICAgICAgICAgICByZXR1cm4gbmV3IENoaWxkcmVuTm9kZSh0aGlzLmNoaWxkcmVuXywgdGhpcy5wcmlvcml0eU5vZGVfLCBuZXdJbmRleE1hcCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgQ2hpbGRyZW5Ob2RlLnByb3RvdHlwZS5pc0luZGV4ZWQgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIGluZGV4ID09PSBLZXlJbmRleF8xLktFWV9JTkRFWCB8fCB0aGlzLmluZGV4TWFwXy5oYXNJbmRleChpbmRleCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIENoaWxkcmVuTm9kZS5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgICAgIGlmIChvdGhlciA9PT0gdGhpcykge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAob3RoZXIuaXNMZWFmTm9kZSgpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgb3RoZXJDaGlsZHJlbk5vZGUgPSBvdGhlcjtcbiAgICAgICAgICAgIGlmICghdGhpcy5nZXRQcmlvcml0eSgpLmVxdWFscyhvdGhlckNoaWxkcmVuTm9kZS5nZXRQcmlvcml0eSgpKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuY2hpbGRyZW5fLmNvdW50KCkgPT09IG90aGVyQ2hpbGRyZW5Ob2RlLmNoaWxkcmVuXy5jb3VudCgpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNJdGVyID0gdGhpcy5nZXRJdGVyYXRvcihQcmlvcml0eUluZGV4XzEuUFJJT1JJVFlfSU5ERVgpO1xuICAgICAgICAgICAgICAgIHZhciBvdGhlckl0ZXIgPSBvdGhlckNoaWxkcmVuTm9kZS5nZXRJdGVyYXRvcihQcmlvcml0eUluZGV4XzEuUFJJT1JJVFlfSU5ERVgpO1xuICAgICAgICAgICAgICAgIHZhciB0aGlzQ3VycmVudCA9IHRoaXNJdGVyLmdldE5leHQoKTtcbiAgICAgICAgICAgICAgICB2YXIgb3RoZXJDdXJyZW50ID0gb3RoZXJJdGVyLmdldE5leHQoKTtcbiAgICAgICAgICAgICAgICB3aGlsZSAodGhpc0N1cnJlbnQgJiYgb3RoZXJDdXJyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzQ3VycmVudC5uYW1lICE9PSBvdGhlckN1cnJlbnQubmFtZSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgIXRoaXNDdXJyZW50Lm5vZGUuZXF1YWxzKG90aGVyQ3VycmVudC5ub2RlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXNDdXJyZW50ID0gdGhpc0l0ZXIuZ2V0TmV4dCgpO1xuICAgICAgICAgICAgICAgICAgICBvdGhlckN1cnJlbnQgPSBvdGhlckl0ZXIuZ2V0TmV4dCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc0N1cnJlbnQgPT09IG51bGwgJiYgb3RoZXJDdXJyZW50ID09PSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgU29ydGVkTWFwIG9yZGVyZWQgYnkgaW5kZXgsIG9yIG51bGwgaWYgdGhlIGRlZmF1bHQgKGJ5LWtleSkgb3JkZXJpbmcgY2FuIGJlIHVzZWRcbiAgICAgKiBpbnN0ZWFkLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0geyFJbmRleH0gaW5kZXhEZWZpbml0aW9uXG4gICAgICogQHJldHVybiB7P1NvcnRlZE1hcC48TmFtZWROb2RlLCBOb2RlPn1cbiAgICAgKi9cbiAgICBDaGlsZHJlbk5vZGUucHJvdG90eXBlLnJlc29sdmVJbmRleF8gPSBmdW5jdGlvbiAoaW5kZXhEZWZpbml0aW9uKSB7XG4gICAgICAgIGlmIChpbmRleERlZmluaXRpb24gPT09IEtleUluZGV4XzEuS0VZX0lOREVYKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmluZGV4TWFwXy5nZXQoaW5kZXhEZWZpbml0aW9uLnRvU3RyaW5nKCkpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEB0eXBlIHtSZWdFeHB9XG4gICAgICovXG4gICAgQ2hpbGRyZW5Ob2RlLklOVEVHRVJfUkVHRVhQXyA9IC9eKDB8WzEtOV1cXGQqKSQvO1xuICAgIHJldHVybiBDaGlsZHJlbk5vZGU7XG59KCkpO1xuZXhwb3J0cy5DaGlsZHJlbk5vZGUgPSBDaGlsZHJlbk5vZGU7XG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQGV4dGVuZHMge0NoaWxkcmVuTm9kZX1cbiAqIEBwcml2YXRlXG4gKi9cbnZhciBNYXhOb2RlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhNYXhOb2RlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIE1heE5vZGUoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBuZXcgU29ydGVkTWFwXzEuU29ydGVkTWFwKGNvbXBhcmF0b3JzXzEuTkFNRV9DT01QQVJBVE9SKSwgQ2hpbGRyZW5Ob2RlLkVNUFRZX05PREUsIEluZGV4TWFwXzEuSW5kZXhNYXAuRGVmYXVsdCkgfHwgdGhpcztcbiAgICB9XG4gICAgTWF4Tm9kZS5wcm90b3R5cGUuY29tcGFyZVRvID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgICAgIGlmIChvdGhlciA9PT0gdGhpcykge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgTWF4Tm9kZS5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgICAgIC8vIE5vdCB0aGF0IHdlIGV2ZXJ5IGNvbXBhcmUgaXQsIGJ1dCBNQVhfTk9ERSBpcyBvbmx5IGV2ZXIgZXF1YWwgdG8gaXRzZWxmXG4gICAgICAgIHJldHVybiBvdGhlciA9PT0gdGhpcztcbiAgICB9O1xuICAgIE1heE5vZGUucHJvdG90eXBlLmdldFByaW9yaXR5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIE1heE5vZGUucHJvdG90eXBlLmdldEltbWVkaWF0ZUNoaWxkID0gZnVuY3Rpb24gKGNoaWxkTmFtZSkge1xuICAgICAgICByZXR1cm4gQ2hpbGRyZW5Ob2RlLkVNUFRZX05PREU7XG4gICAgfTtcbiAgICBNYXhOb2RlLnByb3RvdHlwZS5pc0VtcHR5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICByZXR1cm4gTWF4Tm9kZTtcbn0oQ2hpbGRyZW5Ob2RlKSk7XG5leHBvcnRzLk1heE5vZGUgPSBNYXhOb2RlO1xuLyoqXG4gKiBNYXJrZXIgdGhhdCB3aWxsIHNvcnQgaGlnaGVyIHRoYW4gYW55IG90aGVyIHNuYXBzaG90LlxuICogQHR5cGUgeyFNQVhfTk9ERX1cbiAqIEBjb25zdFxuICovXG5leHBvcnRzLk1BWF9OT0RFID0gbmV3IE1heE5vZGUoKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKE5vZGVfMS5OYW1lZE5vZGUsIHtcbiAgICBNSU46IHtcbiAgICAgICAgdmFsdWU6IG5ldyBOb2RlXzEuTmFtZWROb2RlKHV0aWxfMi5NSU5fTkFNRSwgQ2hpbGRyZW5Ob2RlLkVNUFRZX05PREUpXG4gICAgfSxcbiAgICBNQVg6IHtcbiAgICAgICAgdmFsdWU6IG5ldyBOb2RlXzEuTmFtZWROb2RlKHV0aWxfMi5NQVhfTkFNRSwgZXhwb3J0cy5NQVhfTk9ERSlcbiAgICB9XG59KTtcbi8qKlxuICogUmVmZXJlbmNlIEV4dGVuc2lvbnNcbiAqL1xuS2V5SW5kZXhfMS5LZXlJbmRleC5fX0VNUFRZX05PREUgPSBDaGlsZHJlbk5vZGUuRU1QVFlfTk9ERTtcbkxlYWZOb2RlXzEuTGVhZk5vZGUuX19jaGlsZHJlbk5vZGVDb25zdHJ1Y3RvciA9IENoaWxkcmVuTm9kZTtcbnNuYXBfMS5zZXRNYXhOb2RlKGV4cG9ydHMuTUFYX05PREUpO1xuUHJpb3JpdHlJbmRleF8xLnNldE1heE5vZGUoZXhwb3J0cy5NQVhfTk9ERSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNoaWxkcmVuTm9kZS5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB1dGlsXzEgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG52YXIgY2hpbGRTZXRfMSA9IHJlcXVpcmUoXCIuL2NoaWxkU2V0XCIpO1xudmFyIHV0aWxfMiA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvdXRpbFwiKTtcbnZhciBOb2RlXzEgPSByZXF1aXJlKFwiLi9Ob2RlXCIpO1xudmFyIFByaW9yaXR5SW5kZXhfMSA9IHJlcXVpcmUoXCIuL2luZGV4ZXMvUHJpb3JpdHlJbmRleFwiKTtcbnZhciBLZXlJbmRleF8xID0gcmVxdWlyZShcIi4vaW5kZXhlcy9LZXlJbmRleFwiKTtcbnZhciBfZGVmYXVsdEluZGV4TWFwO1xudmFyIGZhbGxiYWNrT2JqZWN0ID0ge307XG4vKipcbiAqXG4gKiBAcGFyYW0ge09iamVjdC48c3RyaW5nLCBGYWxsYmFja1R5cGV8U29ydGVkTWFwLjxOYW1lZE5vZGUsIE5vZGU+Pn0gaW5kZXhlc1xuICogQHBhcmFtIHtPYmplY3QuPHN0cmluZywgSW5kZXg+fSBpbmRleFNldFxuICogQGNvbnN0cnVjdG9yXG4gKi9cbnZhciBJbmRleE1hcCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBJbmRleE1hcChpbmRleGVzXywgaW5kZXhTZXRfKSB7XG4gICAgICAgIHRoaXMuaW5kZXhlc18gPSBpbmRleGVzXztcbiAgICAgICAgdGhpcy5pbmRleFNldF8gPSBpbmRleFNldF87XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbmRleE1hcCwgXCJEZWZhdWx0XCIsIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBkZWZhdWx0IEluZGV4TWFwIGZvciBub2RlcyB3aXRob3V0IGEgcHJpb3JpdHlcbiAgICAgICAgICogQHR5cGUgeyFJbmRleE1hcH1cbiAgICAgICAgICogQGNvbnN0XG4gICAgICAgICAqL1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHV0aWxfMS5hc3NlcnQoZmFsbGJhY2tPYmplY3QgJiYgUHJpb3JpdHlJbmRleF8xLlBSSU9SSVRZX0lOREVYLCAnQ2hpbGRyZW5Ob2RlLnRzIGhhcyBub3QgYmVlbiBsb2FkZWQnKTtcbiAgICAgICAgICAgIF9kZWZhdWx0SW5kZXhNYXAgPVxuICAgICAgICAgICAgICAgIF9kZWZhdWx0SW5kZXhNYXAgfHxcbiAgICAgICAgICAgICAgICAgICAgbmV3IEluZGV4TWFwKHsgJy5wcmlvcml0eSc6IGZhbGxiYWNrT2JqZWN0IH0sIHsgJy5wcmlvcml0eSc6IFByaW9yaXR5SW5kZXhfMS5QUklPUklUWV9JTkRFWCB9KTtcbiAgICAgICAgICAgIHJldHVybiBfZGVmYXVsdEluZGV4TWFwO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7IXN0cmluZ30gaW5kZXhLZXlcbiAgICAgKiBAcmV0dXJuIHs/U29ydGVkTWFwLjxOYW1lZE5vZGUsIE5vZGU+fVxuICAgICAqL1xuICAgIEluZGV4TWFwLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoaW5kZXhLZXkpIHtcbiAgICAgICAgdmFyIHNvcnRlZE1hcCA9IHV0aWxfMi5zYWZlR2V0KHRoaXMuaW5kZXhlc18sIGluZGV4S2V5KTtcbiAgICAgICAgaWYgKCFzb3J0ZWRNYXApXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGluZGV4IGRlZmluZWQgZm9yICcgKyBpbmRleEtleSk7XG4gICAgICAgIGlmIChzb3J0ZWRNYXAgPT09IGZhbGxiYWNrT2JqZWN0KSB7XG4gICAgICAgICAgICAvLyBUaGUgaW5kZXggZXhpc3RzLCBidXQgaXQgZmFsbHMgYmFjayB0byBqdXN0IG5hbWUgY29tcGFyaXNvbi4gUmV0dXJuIG51bGwgc28gdGhhdCB0aGUgY2FsbGluZyBjb2RlIHVzZXMgdGhlXG4gICAgICAgICAgICAvLyByZWd1bGFyIGNoaWxkIG1hcFxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gc29ydGVkTWFwO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFJbmRleH0gaW5kZXhEZWZpbml0aW9uXG4gICAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBJbmRleE1hcC5wcm90b3R5cGUuaGFzSW5kZXggPSBmdW5jdGlvbiAoaW5kZXhEZWZpbml0aW9uKSB7XG4gICAgICAgIHJldHVybiB1dGlsXzIuY29udGFpbnModGhpcy5pbmRleFNldF8sIGluZGV4RGVmaW5pdGlvbi50b1N0cmluZygpKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7IUluZGV4fSBpbmRleERlZmluaXRpb25cbiAgICAgKiBAcGFyYW0geyFTb3J0ZWRNYXAuPHN0cmluZywgIU5vZGU+fSBleGlzdGluZ0NoaWxkcmVuXG4gICAgICogQHJldHVybiB7IUluZGV4TWFwfVxuICAgICAqL1xuICAgIEluZGV4TWFwLnByb3RvdHlwZS5hZGRJbmRleCA9IGZ1bmN0aW9uIChpbmRleERlZmluaXRpb24sIGV4aXN0aW5nQ2hpbGRyZW4pIHtcbiAgICAgICAgdXRpbF8xLmFzc2VydChpbmRleERlZmluaXRpb24gIT09IEtleUluZGV4XzEuS0VZX0lOREVYLCBcIktleUluZGV4IGFsd2F5cyBleGlzdHMgYW5kIGlzbid0IG1lYW50IHRvIGJlIGFkZGVkIHRvIHRoZSBJbmRleE1hcC5cIik7XG4gICAgICAgIHZhciBjaGlsZExpc3QgPSBbXTtcbiAgICAgICAgdmFyIHNhd0luZGV4ZWRWYWx1ZSA9IGZhbHNlO1xuICAgICAgICB2YXIgaXRlciA9IGV4aXN0aW5nQ2hpbGRyZW4uZ2V0SXRlcmF0b3IoTm9kZV8xLk5hbWVkTm9kZS5XcmFwKTtcbiAgICAgICAgdmFyIG5leHQgPSBpdGVyLmdldE5leHQoKTtcbiAgICAgICAgd2hpbGUgKG5leHQpIHtcbiAgICAgICAgICAgIHNhd0luZGV4ZWRWYWx1ZSA9XG4gICAgICAgICAgICAgICAgc2F3SW5kZXhlZFZhbHVlIHx8IGluZGV4RGVmaW5pdGlvbi5pc0RlZmluZWRPbihuZXh0Lm5vZGUpO1xuICAgICAgICAgICAgY2hpbGRMaXN0LnB1c2gobmV4dCk7XG4gICAgICAgICAgICBuZXh0ID0gaXRlci5nZXROZXh0KCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5ld0luZGV4O1xuICAgICAgICBpZiAoc2F3SW5kZXhlZFZhbHVlKSB7XG4gICAgICAgICAgICBuZXdJbmRleCA9IGNoaWxkU2V0XzEuYnVpbGRDaGlsZFNldChjaGlsZExpc3QsIGluZGV4RGVmaW5pdGlvbi5nZXRDb21wYXJlKCkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbmV3SW5kZXggPSBmYWxsYmFja09iamVjdDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaW5kZXhOYW1lID0gaW5kZXhEZWZpbml0aW9uLnRvU3RyaW5nKCk7XG4gICAgICAgIHZhciBuZXdJbmRleFNldCA9IHV0aWxfMi5jbG9uZSh0aGlzLmluZGV4U2V0Xyk7XG4gICAgICAgIG5ld0luZGV4U2V0W2luZGV4TmFtZV0gPSBpbmRleERlZmluaXRpb247XG4gICAgICAgIHZhciBuZXdJbmRleGVzID0gdXRpbF8yLmNsb25lKHRoaXMuaW5kZXhlc18pO1xuICAgICAgICBuZXdJbmRleGVzW2luZGV4TmFtZV0gPSBuZXdJbmRleDtcbiAgICAgICAgcmV0dXJuIG5ldyBJbmRleE1hcChuZXdJbmRleGVzLCBuZXdJbmRleFNldCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBFbnN1cmUgdGhhdCB0aGlzIG5vZGUgaXMgcHJvcGVybHkgdHJhY2tlZCBpbiBhbnkgaW5kZXhlcyB0aGF0IHdlJ3JlIG1haW50YWluaW5nXG4gICAgICogQHBhcmFtIHshTmFtZWROb2RlfSBuYW1lZE5vZGVcbiAgICAgKiBAcGFyYW0geyFTb3J0ZWRNYXAuPHN0cmluZywgIU5vZGU+fSBleGlzdGluZ0NoaWxkcmVuXG4gICAgICogQHJldHVybiB7IUluZGV4TWFwfVxuICAgICAqL1xuICAgIEluZGV4TWFwLnByb3RvdHlwZS5hZGRUb0luZGV4ZXMgPSBmdW5jdGlvbiAobmFtZWROb2RlLCBleGlzdGluZ0NoaWxkcmVuKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBuZXdJbmRleGVzID0gdXRpbF8yLm1hcCh0aGlzLmluZGV4ZXNfLCBmdW5jdGlvbiAoaW5kZXhlZENoaWxkcmVuLCBpbmRleE5hbWUpIHtcbiAgICAgICAgICAgIHZhciBpbmRleCA9IHV0aWxfMi5zYWZlR2V0KF90aGlzLmluZGV4U2V0XywgaW5kZXhOYW1lKTtcbiAgICAgICAgICAgIHV0aWxfMS5hc3NlcnQoaW5kZXgsICdNaXNzaW5nIGluZGV4IGltcGxlbWVudGF0aW9uIGZvciAnICsgaW5kZXhOYW1lKTtcbiAgICAgICAgICAgIGlmIChpbmRleGVkQ2hpbGRyZW4gPT09IGZhbGxiYWNrT2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgLy8gQ2hlY2sgdG8gc2VlIGlmIHdlIG5lZWQgdG8gaW5kZXggZXZlcnl0aGluZ1xuICAgICAgICAgICAgICAgIGlmIChpbmRleC5pc0RlZmluZWRPbihuYW1lZE5vZGUubm9kZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gV2UgbmVlZCB0byBidWlsZCB0aGlzIGluZGV4XG4gICAgICAgICAgICAgICAgICAgIHZhciBjaGlsZExpc3QgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZXIgPSBleGlzdGluZ0NoaWxkcmVuLmdldEl0ZXJhdG9yKE5vZGVfMS5OYW1lZE5vZGUuV3JhcCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXh0ID0gaXRlci5nZXROZXh0KCk7XG4gICAgICAgICAgICAgICAgICAgIHdoaWxlIChuZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV4dC5uYW1lICE9IG5hbWVkTm9kZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRMaXN0LnB1c2gobmV4dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXh0ID0gaXRlci5nZXROZXh0KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2hpbGRMaXN0LnB1c2gobmFtZWROb2RlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNoaWxkU2V0XzEuYnVpbGRDaGlsZFNldChjaGlsZExpc3QsIGluZGV4LmdldENvbXBhcmUoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBObyBjaGFuZ2UsIHRoaXMgcmVtYWlucyBhIGZhbGxiYWNrXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxsYmFja09iamVjdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgZXhpc3RpbmdTbmFwID0gZXhpc3RpbmdDaGlsZHJlbi5nZXQobmFtZWROb2RlLm5hbWUpO1xuICAgICAgICAgICAgICAgIHZhciBuZXdDaGlsZHJlbiA9IGluZGV4ZWRDaGlsZHJlbjtcbiAgICAgICAgICAgICAgICBpZiAoZXhpc3RpbmdTbmFwKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0NoaWxkcmVuID0gbmV3Q2hpbGRyZW4ucmVtb3ZlKG5ldyBOb2RlXzEuTmFtZWROb2RlKG5hbWVkTm9kZS5uYW1lLCBleGlzdGluZ1NuYXApKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ld0NoaWxkcmVuLmluc2VydChuYW1lZE5vZGUsIG5hbWVkTm9kZS5ub2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBuZXcgSW5kZXhNYXAobmV3SW5kZXhlcywgdGhpcy5pbmRleFNldF8pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgbmV3IEluZGV4TWFwIGluc3RhbmNlIHdpdGggdGhlIGdpdmVuIHZhbHVlIHJlbW92ZWRcbiAgICAgKiBAcGFyYW0geyFOYW1lZE5vZGV9IG5hbWVkTm9kZVxuICAgICAqIEBwYXJhbSB7IVNvcnRlZE1hcC48c3RyaW5nLCAhTm9kZT59IGV4aXN0aW5nQ2hpbGRyZW5cbiAgICAgKiBAcmV0dXJuIHshSW5kZXhNYXB9XG4gICAgICovXG4gICAgSW5kZXhNYXAucHJvdG90eXBlLnJlbW92ZUZyb21JbmRleGVzID0gZnVuY3Rpb24gKG5hbWVkTm9kZSwgZXhpc3RpbmdDaGlsZHJlbikge1xuICAgICAgICB2YXIgbmV3SW5kZXhlcyA9IHV0aWxfMi5tYXAodGhpcy5pbmRleGVzXywgZnVuY3Rpb24gKGluZGV4ZWRDaGlsZHJlbikge1xuICAgICAgICAgICAgaWYgKGluZGV4ZWRDaGlsZHJlbiA9PT0gZmFsbGJhY2tPYmplY3QpIHtcbiAgICAgICAgICAgICAgICAvLyBUaGlzIGlzIHRoZSBmYWxsYmFjay4gSnVzdCByZXR1cm4gaXQsIG5vdGhpbmcgdG8gZG8gaW4gdGhpcyBjYXNlXG4gICAgICAgICAgICAgICAgcmV0dXJuIGluZGV4ZWRDaGlsZHJlbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBleGlzdGluZ1NuYXAgPSBleGlzdGluZ0NoaWxkcmVuLmdldChuYW1lZE5vZGUubmFtZSk7XG4gICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nU25hcCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaW5kZXhlZENoaWxkcmVuLnJlbW92ZShuZXcgTm9kZV8xLk5hbWVkTm9kZShuYW1lZE5vZGUubmFtZSwgZXhpc3RpbmdTbmFwKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBObyByZWNvcmQgb2YgdGhpcyBjaGlsZFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaW5kZXhlZENoaWxkcmVuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBuZXcgSW5kZXhNYXAobmV3SW5kZXhlcywgdGhpcy5pbmRleFNldF8pO1xuICAgIH07XG4gICAgcmV0dXJuIEluZGV4TWFwO1xufSgpKTtcbmV4cG9ydHMuSW5kZXhNYXAgPSBJbmRleE1hcDtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9SW5kZXhNYXAuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdXRpbF8xID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xudmFyIHV0aWxfMiA9IHJlcXVpcmUoXCIuLi91dGlsL3V0aWxcIik7XG52YXIgc25hcF8xID0gcmVxdWlyZShcIi4vc25hcFwiKTtcbnZhciBfX2NoaWxkcmVuTm9kZUNvbnN0cnVjdG9yO1xuLyoqXG4gKiBMZWFmTm9kZSBpcyBhIGNsYXNzIGZvciBzdG9yaW5nIGxlYWYgbm9kZXMgaW4gYSBEYXRhU25hcHNob3QuICBJdFxuICogaW1wbGVtZW50cyBOb2RlIGFuZCBzdG9yZXMgdGhlIHZhbHVlIG9mIHRoZSBub2RlIChhIHN0cmluZyxcbiAqIG51bWJlciwgb3IgYm9vbGVhbikgYWNjZXNzaWJsZSB2aWEgZ2V0VmFsdWUoKS5cbiAqL1xudmFyIExlYWZOb2RlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIEBpbXBsZW1lbnRzIHtOb2RlfVxuICAgICAqIEBwYXJhbSB7IShzdHJpbmd8bnVtYmVyfGJvb2xlYW58T2JqZWN0KX0gdmFsdWVfIFRoZSB2YWx1ZSB0byBzdG9yZSBpbiB0aGlzIGxlYWYgbm9kZS5cbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVGhlIG9iamVjdCB0eXBlIGlzIHBvc3NpYmxlIGluIHRoZSBldmVudCBvZiBhIGRlZmVycmVkIHZhbHVlXG4gICAgICogQHBhcmFtIHshTm9kZT19IHByaW9yaXR5Tm9kZV8gVGhlIHByaW9yaXR5IG9mIHRoaXMgbm9kZS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBMZWFmTm9kZSh2YWx1ZV8sIHByaW9yaXR5Tm9kZV8pIHtcbiAgICAgICAgaWYgKHByaW9yaXR5Tm9kZV8gPT09IHZvaWQgMCkgeyBwcmlvcml0eU5vZGVfID0gTGVhZk5vZGUuX19jaGlsZHJlbk5vZGVDb25zdHJ1Y3Rvci5FTVBUWV9OT0RFOyB9XG4gICAgICAgIHRoaXMudmFsdWVfID0gdmFsdWVfO1xuICAgICAgICB0aGlzLnByaW9yaXR5Tm9kZV8gPSBwcmlvcml0eU5vZGVfO1xuICAgICAgICB0aGlzLmxhenlIYXNoXyA9IG51bGw7XG4gICAgICAgIHV0aWxfMS5hc3NlcnQodGhpcy52YWx1ZV8gIT09IHVuZGVmaW5lZCAmJiB0aGlzLnZhbHVlXyAhPT0gbnVsbCwgXCJMZWFmTm9kZSBzaG91bGRuJ3QgYmUgY3JlYXRlZCB3aXRoIG51bGwvdW5kZWZpbmVkIHZhbHVlLlwiKTtcbiAgICAgICAgc25hcF8xLnZhbGlkYXRlUHJpb3JpdHlOb2RlKHRoaXMucHJpb3JpdHlOb2RlXyk7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShMZWFmTm9kZSwgXCJfX2NoaWxkcmVuTm9kZUNvbnN0cnVjdG9yXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gX19jaGlsZHJlbk5vZGVDb25zdHJ1Y3RvcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsKSB7XG4gICAgICAgICAgICBfX2NoaWxkcmVuTm9kZUNvbnN0cnVjdG9yID0gdmFsO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICAvKiogQGluaGVyaXREb2MgKi9cbiAgICBMZWFmTm9kZS5wcm90b3R5cGUuaXNMZWFmTm9kZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICAvKiogQGluaGVyaXREb2MgKi9cbiAgICBMZWFmTm9kZS5wcm90b3R5cGUuZ2V0UHJpb3JpdHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaW9yaXR5Tm9kZV87XG4gICAgfTtcbiAgICAvKiogQGluaGVyaXREb2MgKi9cbiAgICBMZWFmTm9kZS5wcm90b3R5cGUudXBkYXRlUHJpb3JpdHkgPSBmdW5jdGlvbiAobmV3UHJpb3JpdHlOb2RlKSB7XG4gICAgICAgIHJldHVybiBuZXcgTGVhZk5vZGUodGhpcy52YWx1ZV8sIG5ld1ByaW9yaXR5Tm9kZSk7XG4gICAgfTtcbiAgICAvKiogQGluaGVyaXREb2MgKi9cbiAgICBMZWFmTm9kZS5wcm90b3R5cGUuZ2V0SW1tZWRpYXRlQ2hpbGQgPSBmdW5jdGlvbiAoY2hpbGROYW1lKSB7XG4gICAgICAgIC8vIEhhY2sgdG8gdHJlYXQgcHJpb3JpdHkgYXMgYSByZWd1bGFyIGNoaWxkXG4gICAgICAgIGlmIChjaGlsZE5hbWUgPT09ICcucHJpb3JpdHknKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcmlvcml0eU5vZGVfO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIExlYWZOb2RlLl9fY2hpbGRyZW5Ob2RlQ29uc3RydWN0b3IuRU1QVFlfTk9ERTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqIEBpbmhlcml0RG9jICovXG4gICAgTGVhZk5vZGUucHJvdG90eXBlLmdldENoaWxkID0gZnVuY3Rpb24gKHBhdGgpIHtcbiAgICAgICAgaWYgKHBhdGguaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChwYXRoLmdldEZyb250KCkgPT09ICcucHJpb3JpdHknKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcmlvcml0eU5vZGVfO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIExlYWZOb2RlLl9fY2hpbGRyZW5Ob2RlQ29uc3RydWN0b3IuRU1QVFlfTk9ERTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBMZWFmTm9kZS5wcm90b3R5cGUuaGFzQ2hpbGQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIC8qKiBAaW5oZXJpdERvYyAqL1xuICAgIExlYWZOb2RlLnByb3RvdHlwZS5nZXRQcmVkZWNlc3NvckNoaWxkTmFtZSA9IGZ1bmN0aW9uIChjaGlsZE5hbWUsIGNoaWxkTm9kZSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIC8qKiBAaW5oZXJpdERvYyAqL1xuICAgIExlYWZOb2RlLnByb3RvdHlwZS51cGRhdGVJbW1lZGlhdGVDaGlsZCA9IGZ1bmN0aW9uIChjaGlsZE5hbWUsIG5ld0NoaWxkTm9kZSkge1xuICAgICAgICBpZiAoY2hpbGROYW1lID09PSAnLnByaW9yaXR5Jykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudXBkYXRlUHJpb3JpdHkobmV3Q2hpbGROb2RlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChuZXdDaGlsZE5vZGUuaXNFbXB0eSgpICYmIGNoaWxkTmFtZSAhPT0gJy5wcmlvcml0eScpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIExlYWZOb2RlLl9fY2hpbGRyZW5Ob2RlQ29uc3RydWN0b3IuRU1QVFlfTk9ERVxuICAgICAgICAgICAgICAgIC51cGRhdGVJbW1lZGlhdGVDaGlsZChjaGlsZE5hbWUsIG5ld0NoaWxkTm9kZSlcbiAgICAgICAgICAgICAgICAudXBkYXRlUHJpb3JpdHkodGhpcy5wcmlvcml0eU5vZGVfKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqIEBpbmhlcml0RG9jICovXG4gICAgTGVhZk5vZGUucHJvdG90eXBlLnVwZGF0ZUNoaWxkID0gZnVuY3Rpb24gKHBhdGgsIG5ld0NoaWxkTm9kZSkge1xuICAgICAgICB2YXIgZnJvbnQgPSBwYXRoLmdldEZyb250KCk7XG4gICAgICAgIGlmIChmcm9udCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ld0NoaWxkTm9kZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChuZXdDaGlsZE5vZGUuaXNFbXB0eSgpICYmIGZyb250ICE9PSAnLnByaW9yaXR5Jykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB1dGlsXzEuYXNzZXJ0KGZyb250ICE9PSAnLnByaW9yaXR5JyB8fCBwYXRoLmdldExlbmd0aCgpID09PSAxLCAnLnByaW9yaXR5IG11c3QgYmUgdGhlIGxhc3QgdG9rZW4gaW4gYSBwYXRoJyk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy51cGRhdGVJbW1lZGlhdGVDaGlsZChmcm9udCwgTGVhZk5vZGUuX19jaGlsZHJlbk5vZGVDb25zdHJ1Y3Rvci5FTVBUWV9OT0RFLnVwZGF0ZUNoaWxkKHBhdGgucG9wRnJvbnQoKSwgbmV3Q2hpbGROb2RlKSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKiBAaW5oZXJpdERvYyAqL1xuICAgIExlYWZOb2RlLnByb3RvdHlwZS5pc0VtcHR5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICAvKiogQGluaGVyaXREb2MgKi9cbiAgICBMZWFmTm9kZS5wcm90b3R5cGUubnVtQ2hpbGRyZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH07XG4gICAgLyoqIEBpbmhlcml0RG9jICovXG4gICAgTGVhZk5vZGUucHJvdG90eXBlLmZvckVhY2hDaGlsZCA9IGZ1bmN0aW9uIChpbmRleCwgYWN0aW9uKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgTGVhZk5vZGUucHJvdG90eXBlLnZhbCA9IGZ1bmN0aW9uIChleHBvcnRGb3JtYXQpIHtcbiAgICAgICAgaWYgKGV4cG9ydEZvcm1hdCAmJiAhdGhpcy5nZXRQcmlvcml0eSgpLmlzRW1wdHkoKSlcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgJy52YWx1ZSc6IHRoaXMuZ2V0VmFsdWUoKSxcbiAgICAgICAgICAgICAgICAnLnByaW9yaXR5JzogdGhpcy5nZXRQcmlvcml0eSgpLnZhbCgpXG4gICAgICAgICAgICB9O1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRWYWx1ZSgpO1xuICAgIH07XG4gICAgLyoqIEBpbmhlcml0RG9jICovXG4gICAgTGVhZk5vZGUucHJvdG90eXBlLmhhc2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmxhenlIYXNoXyA9PT0gbnVsbCkge1xuICAgICAgICAgICAgdmFyIHRvSGFzaCA9ICcnO1xuICAgICAgICAgICAgaWYgKCF0aGlzLnByaW9yaXR5Tm9kZV8uaXNFbXB0eSgpKVxuICAgICAgICAgICAgICAgIHRvSGFzaCArPVxuICAgICAgICAgICAgICAgICAgICAncHJpb3JpdHk6JyArXG4gICAgICAgICAgICAgICAgICAgICAgICBzbmFwXzEucHJpb3JpdHlIYXNoVGV4dCh0aGlzLnByaW9yaXR5Tm9kZV8udmFsKCkpICtcbiAgICAgICAgICAgICAgICAgICAgICAgICc6JztcbiAgICAgICAgICAgIHZhciB0eXBlID0gdHlwZW9mIHRoaXMudmFsdWVfO1xuICAgICAgICAgICAgdG9IYXNoICs9IHR5cGUgKyAnOic7XG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICB0b0hhc2ggKz0gdXRpbF8yLmRvdWJsZVRvSUVFRTc1NFN0cmluZyh0aGlzLnZhbHVlXyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0b0hhc2ggKz0gdGhpcy52YWx1ZV87XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmxhenlIYXNoXyA9IHV0aWxfMi5zaGExKHRvSGFzaCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMubGF6eUhhc2hfO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgdmFsdWUgb2YgdGhlIGxlYWYgbm9kZS5cbiAgICAgKiBAcmV0dXJuIHtPYmplY3R8c3RyaW5nfG51bWJlcnxib29sZWFufSBUaGUgdmFsdWUgb2YgdGhlIG5vZGUuXG4gICAgICovXG4gICAgTGVhZk5vZGUucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy52YWx1ZV87XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIExlYWZOb2RlLnByb3RvdHlwZS5jb21wYXJlVG8gPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICAgICAgaWYgKG90aGVyID09PSBMZWFmTm9kZS5fX2NoaWxkcmVuTm9kZUNvbnN0cnVjdG9yLkVNUFRZX05PREUpIHtcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG90aGVyIGluc3RhbmNlb2YgTGVhZk5vZGUuX19jaGlsZHJlbk5vZGVDb25zdHJ1Y3Rvcikge1xuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdXRpbF8xLmFzc2VydChvdGhlci5pc0xlYWZOb2RlKCksICdVbmtub3duIG5vZGUgdHlwZScpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29tcGFyZVRvTGVhZk5vZGVfKG90aGVyKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQ29tcGFyaXNvbiBzcGVjaWZpY2FsbHkgZm9yIHR3byBsZWFmIG5vZGVzXG4gICAgICogQHBhcmFtIHshTGVhZk5vZGV9IG90aGVyTGVhZlxuICAgICAqIEByZXR1cm4geyFudW1iZXJ9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBMZWFmTm9kZS5wcm90b3R5cGUuY29tcGFyZVRvTGVhZk5vZGVfID0gZnVuY3Rpb24gKG90aGVyTGVhZikge1xuICAgICAgICB2YXIgb3RoZXJMZWFmVHlwZSA9IHR5cGVvZiBvdGhlckxlYWYudmFsdWVfO1xuICAgICAgICB2YXIgdGhpc0xlYWZUeXBlID0gdHlwZW9mIHRoaXMudmFsdWVfO1xuICAgICAgICB2YXIgb3RoZXJJbmRleCA9IExlYWZOb2RlLlZBTFVFX1RZUEVfT1JERVIuaW5kZXhPZihvdGhlckxlYWZUeXBlKTtcbiAgICAgICAgdmFyIHRoaXNJbmRleCA9IExlYWZOb2RlLlZBTFVFX1RZUEVfT1JERVIuaW5kZXhPZih0aGlzTGVhZlR5cGUpO1xuICAgICAgICB1dGlsXzEuYXNzZXJ0KG90aGVySW5kZXggPj0gMCwgJ1Vua25vd24gbGVhZiB0eXBlOiAnICsgb3RoZXJMZWFmVHlwZSk7XG4gICAgICAgIHV0aWxfMS5hc3NlcnQodGhpc0luZGV4ID49IDAsICdVbmtub3duIGxlYWYgdHlwZTogJyArIHRoaXNMZWFmVHlwZSk7XG4gICAgICAgIGlmIChvdGhlckluZGV4ID09PSB0aGlzSW5kZXgpIHtcbiAgICAgICAgICAgIC8vIFNhbWUgdHlwZSwgY29tcGFyZSB2YWx1ZXNcbiAgICAgICAgICAgIGlmICh0aGlzTGVhZlR5cGUgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgLy8gRGVmZXJyZWQgdmFsdWUgbm9kZXMgYXJlIGFsbCBlcXVhbCwgYnV0IHdlIHNob3VsZCBhbHNvIG5ldmVyIGdldCB0byB0aGlzIHBvaW50Li4uXG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBOb3RlIHRoYXQgdGhpcyB3b3JrcyBiZWNhdXNlIHRydWUgPiBmYWxzZSwgYWxsIG90aGVycyBhcmUgbnVtYmVyIG9yIHN0cmluZyBjb21wYXJpc29uc1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnZhbHVlXyA8IG90aGVyTGVhZi52YWx1ZV8pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLnZhbHVlXyA9PT0gb3RoZXJMZWFmLnZhbHVlXykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzSW5kZXggLSBvdGhlckluZGV4O1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIExlYWZOb2RlLnByb3RvdHlwZS53aXRoSW5kZXggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBMZWFmTm9kZS5wcm90b3R5cGUuaXNJbmRleGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgTGVhZk5vZGUucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgICAgICAvKipcbiAgICAgICAgICogQGluaGVyaXREb2NcbiAgICAgICAgICovXG4gICAgICAgIGlmIChvdGhlciA9PT0gdGhpcykge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAob3RoZXIuaXNMZWFmTm9kZSgpKSB7XG4gICAgICAgICAgICB2YXIgb3RoZXJMZWFmID0gb3RoZXI7XG4gICAgICAgICAgICByZXR1cm4gKHRoaXMudmFsdWVfID09PSBvdGhlckxlYWYudmFsdWVfICYmXG4gICAgICAgICAgICAgICAgdGhpcy5wcmlvcml0eU5vZGVfLmVxdWFscyhvdGhlckxlYWYucHJpb3JpdHlOb2RlXykpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBUaGUgc29ydCBvcmRlciBmb3IgY29tcGFyaW5nIGxlYWYgbm9kZXMgb2YgZGlmZmVyZW50IHR5cGVzLiBJZiB0d28gbGVhZiBub2RlcyBoYXZlXG4gICAgICogdGhlIHNhbWUgdHlwZSwgdGhlIGNvbXBhcmlzb24gZmFsbHMgYmFjayB0byB0aGVpciB2YWx1ZVxuICAgICAqIEB0eXBlIHtBcnJheS48IXN0cmluZz59XG4gICAgICogQGNvbnN0XG4gICAgICovXG4gICAgTGVhZk5vZGUuVkFMVUVfVFlQRV9PUkRFUiA9IFsnb2JqZWN0JywgJ2Jvb2xlYW4nLCAnbnVtYmVyJywgJ3N0cmluZyddO1xuICAgIHJldHVybiBMZWFmTm9kZTtcbn0oKSk7XG5leHBvcnRzLkxlYWZOb2RlID0gTGVhZk5vZGU7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUxlYWZOb2RlLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuLyoqXG4gKlxuICogQHBhcmFtIHshc3RyaW5nfSBuYW1lXG4gKiBAcGFyYW0geyFOb2RlfSBub2RlXG4gKiBAY29uc3RydWN0b3JcbiAqIEBzdHJ1Y3RcbiAqL1xudmFyIE5hbWVkTm9kZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBOYW1lZE5vZGUobmFtZSwgbm9kZSkge1xuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgICB0aGlzLm5vZGUgPSBub2RlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7IXN0cmluZ30gbmFtZVxuICAgICAqIEBwYXJhbSB7IU5vZGV9IG5vZGVcbiAgICAgKiBAcmV0dXJuIHtOYW1lZE5vZGV9XG4gICAgICovXG4gICAgTmFtZWROb2RlLldyYXAgPSBmdW5jdGlvbiAobmFtZSwgbm9kZSkge1xuICAgICAgICByZXR1cm4gbmV3IE5hbWVkTm9kZShuYW1lLCBub2RlKTtcbiAgICB9O1xuICAgIHJldHVybiBOYW1lZE5vZGU7XG59KCkpO1xuZXhwb3J0cy5OYW1lZE5vZGUgPSBOYW1lZE5vZGU7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPU5vZGUuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgU29ydGVkTWFwXzEgPSByZXF1aXJlKFwiLi4vdXRpbC9Tb3J0ZWRNYXBcIik7XG52YXIgU29ydGVkTWFwXzIgPSByZXF1aXJlKFwiLi4vdXRpbC9Tb3J0ZWRNYXBcIik7XG52YXIgTE9HXzIgPSBNYXRoLmxvZygyKTtcbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKi9cbnZhciBCYXNlMTJOdW0gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGxlbmd0aFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIEJhc2UxMk51bShsZW5ndGgpIHtcbiAgICAgICAgdmFyIGxvZ0Jhc2UyID0gZnVuY3Rpb24gKG51bSkge1xuICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KChNYXRoLmxvZyhudW0pIC8gTE9HXzIpLCAxMCk7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBiaXRNYXNrID0gZnVuY3Rpb24gKGJpdHMpIHsgcmV0dXJuIHBhcnNlSW50KEFycmF5KGJpdHMgKyAxKS5qb2luKCcxJyksIDIpOyB9O1xuICAgICAgICB0aGlzLmNvdW50ID0gbG9nQmFzZTIobGVuZ3RoICsgMSk7XG4gICAgICAgIHRoaXMuY3VycmVudF8gPSB0aGlzLmNvdW50IC0gMTtcbiAgICAgICAgdmFyIG1hc2sgPSBiaXRNYXNrKHRoaXMuY291bnQpO1xuICAgICAgICB0aGlzLmJpdHNfID0gKGxlbmd0aCArIDEpICYgbWFzaztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBCYXNlMTJOdW0ucHJvdG90eXBlLm5leHRCaXRJc09uZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9ub2luc3BlY3Rpb24gSlNCaXR3aXNlT3BlcmF0b3JVc2FnZVxuICAgICAgICB2YXIgcmVzdWx0ID0gISh0aGlzLmJpdHNfICYgKDB4MSA8PCB0aGlzLmN1cnJlbnRfKSk7XG4gICAgICAgIHRoaXMuY3VycmVudF8tLTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIHJldHVybiBCYXNlMTJOdW07XG59KCkpO1xuLyoqXG4gKiBUYWtlcyBhIGxpc3Qgb2YgY2hpbGQgbm9kZXMgYW5kIGNvbnN0cnVjdHMgYSBTb3J0ZWRTZXQgdXNpbmcgdGhlIGdpdmVuIGNvbXBhcmlzb25cbiAqIGZ1bmN0aW9uXG4gKlxuICogVXNlcyB0aGUgYWxnb3JpdGhtIGRlc2NyaWJlZCBpbiB0aGUgcGFwZXIgbGlua2VkIGhlcmU6XG4gKiBodHRwOi8vY2l0ZXNlZXJ4LmlzdC5wc3UuZWR1L3ZpZXdkb2Mvc3VtbWFyeT9kb2k9MTAuMS4xLjQ2LjE0NThcbiAqXG4gKiBAdGVtcGxhdGUgSywgVlxuICogQHBhcmFtIHtBcnJheS48IU5hbWVkTm9kZT59IGNoaWxkTGlzdCBVbnNvcnRlZCBsaXN0IG9mIGNoaWxkcmVuXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFOYW1lZE5vZGUsICFOYW1lZE5vZGUpOm51bWJlcn0gY21wIFRoZSBjb21wYXJpc29uIG1ldGhvZCB0byBiZSB1c2VkXG4gKiBAcGFyYW0geyhmdW5jdGlvbihOYW1lZE5vZGUpOkspPX0ga2V5Rm4gQW4gb3B0aW9uYWwgZnVuY3Rpb24gdG8gZXh0cmFjdCBLIGZyb20gYSBub2RlIHdyYXBwZXIsIGlmIEsnc1xuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgaXMgbm90IE5hbWVkTm9kZVxuICogQHBhcmFtIHsoZnVuY3Rpb24oSywgSyk6bnVtYmVyKT19IG1hcFNvcnRGbiBBbiBvcHRpb25hbCBvdmVycmlkZSBmb3IgY29tcGFyYXRvciB1c2VkIGJ5IHRoZSBnZW5lcmF0ZWQgc29ydGVkIG1hcFxuICogQHJldHVybiB7U29ydGVkTWFwLjxLLCBWPn1cbiAqL1xuZXhwb3J0cy5idWlsZENoaWxkU2V0ID0gZnVuY3Rpb24gKGNoaWxkTGlzdCwgY21wLCBrZXlGbiwgbWFwU29ydEZuKSB7XG4gICAgY2hpbGRMaXN0LnNvcnQoY21wKTtcbiAgICB2YXIgYnVpbGRCYWxhbmNlZFRyZWUgPSBmdW5jdGlvbiAobG93LCBoaWdoKSB7XG4gICAgICAgIHZhciBsZW5ndGggPSBoaWdoIC0gbG93O1xuICAgICAgICB2YXIgbmFtZWROb2RlO1xuICAgICAgICB2YXIga2V5O1xuICAgICAgICBpZiAobGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGxlbmd0aCA9PSAxKSB7XG4gICAgICAgICAgICBuYW1lZE5vZGUgPSBjaGlsZExpc3RbbG93XTtcbiAgICAgICAgICAgIGtleSA9IGtleUZuID8ga2V5Rm4obmFtZWROb2RlKSA6IG5hbWVkTm9kZTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgU29ydGVkTWFwXzEuTExSQk5vZGUoa2V5LCBuYW1lZE5vZGUubm9kZSwgU29ydGVkTWFwXzEuTExSQk5vZGUuQkxBQ0ssIG51bGwsIG51bGwpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIG1pZGRsZSA9IHBhcnNlSW50KChsZW5ndGggLyAyKSwgMTApICsgbG93O1xuICAgICAgICAgICAgdmFyIGxlZnQgPSBidWlsZEJhbGFuY2VkVHJlZShsb3csIG1pZGRsZSk7XG4gICAgICAgICAgICB2YXIgcmlnaHQgPSBidWlsZEJhbGFuY2VkVHJlZShtaWRkbGUgKyAxLCBoaWdoKTtcbiAgICAgICAgICAgIG5hbWVkTm9kZSA9IGNoaWxkTGlzdFttaWRkbGVdO1xuICAgICAgICAgICAga2V5ID0ga2V5Rm4gPyBrZXlGbihuYW1lZE5vZGUpIDogbmFtZWROb2RlO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBTb3J0ZWRNYXBfMS5MTFJCTm9kZShrZXksIG5hbWVkTm9kZS5ub2RlLCBTb3J0ZWRNYXBfMS5MTFJCTm9kZS5CTEFDSywgbGVmdCwgcmlnaHQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICB2YXIgYnVpbGRGcm9tMTJBcnJheSA9IGZ1bmN0aW9uIChiYXNlMTIpIHtcbiAgICAgICAgdmFyIG5vZGUgPSBudWxsO1xuICAgICAgICB2YXIgcm9vdCA9IG51bGw7XG4gICAgICAgIHZhciBpbmRleCA9IGNoaWxkTGlzdC5sZW5ndGg7XG4gICAgICAgIHZhciBidWlsZFBlbm5hbnQgPSBmdW5jdGlvbiAoY2h1bmtTaXplLCBjb2xvcikge1xuICAgICAgICAgICAgdmFyIGxvdyA9IGluZGV4IC0gY2h1bmtTaXplO1xuICAgICAgICAgICAgdmFyIGhpZ2ggPSBpbmRleDtcbiAgICAgICAgICAgIGluZGV4IC09IGNodW5rU2l6ZTtcbiAgICAgICAgICAgIHZhciBjaGlsZFRyZWUgPSBidWlsZEJhbGFuY2VkVHJlZShsb3cgKyAxLCBoaWdoKTtcbiAgICAgICAgICAgIHZhciBuYW1lZE5vZGUgPSBjaGlsZExpc3RbbG93XTtcbiAgICAgICAgICAgIHZhciBrZXkgPSBrZXlGbiA/IGtleUZuKG5hbWVkTm9kZSkgOiBuYW1lZE5vZGU7XG4gICAgICAgICAgICBhdHRhY2hQZW5uYW50KG5ldyBTb3J0ZWRNYXBfMS5MTFJCTm9kZShrZXksIG5hbWVkTm9kZS5ub2RlLCBjb2xvciwgbnVsbCwgY2hpbGRUcmVlKSk7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBhdHRhY2hQZW5uYW50ID0gZnVuY3Rpb24gKHBlbm5hbnQpIHtcbiAgICAgICAgICAgIGlmIChub2RlKSB7XG4gICAgICAgICAgICAgICAgbm9kZS5sZWZ0ID0gcGVubmFudDtcbiAgICAgICAgICAgICAgICBub2RlID0gcGVubmFudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJvb3QgPSBwZW5uYW50O1xuICAgICAgICAgICAgICAgIG5vZGUgPSBwZW5uYW50O1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJhc2UxMi5jb3VudDsgKytpKSB7XG4gICAgICAgICAgICB2YXIgaXNPbmUgPSBiYXNlMTIubmV4dEJpdElzT25lKCk7XG4gICAgICAgICAgICAvLyBUaGUgbnVtYmVyIG9mIG5vZGVzIHRha2VuIGluIGVhY2ggc2xpY2UgaXMgMl4oYXJyLmxlbmd0aCAtIChpICsgMSkpXG4gICAgICAgICAgICB2YXIgY2h1bmtTaXplID0gTWF0aC5wb3coMiwgYmFzZTEyLmNvdW50IC0gKGkgKyAxKSk7XG4gICAgICAgICAgICBpZiAoaXNPbmUpIHtcbiAgICAgICAgICAgICAgICBidWlsZFBlbm5hbnQoY2h1bmtTaXplLCBTb3J0ZWRNYXBfMS5MTFJCTm9kZS5CTEFDSyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBjdXJyZW50ID09IDJcbiAgICAgICAgICAgICAgICBidWlsZFBlbm5hbnQoY2h1bmtTaXplLCBTb3J0ZWRNYXBfMS5MTFJCTm9kZS5CTEFDSyk7XG4gICAgICAgICAgICAgICAgYnVpbGRQZW5uYW50KGNodW5rU2l6ZSwgU29ydGVkTWFwXzEuTExSQk5vZGUuUkVEKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcm9vdDtcbiAgICB9O1xuICAgIHZhciBiYXNlMTIgPSBuZXcgQmFzZTEyTnVtKGNoaWxkTGlzdC5sZW5ndGgpO1xuICAgIHZhciByb290ID0gYnVpbGRGcm9tMTJBcnJheShiYXNlMTIpO1xuICAgIHJldHVybiBuZXcgU29ydGVkTWFwXzIuU29ydGVkTWFwKG1hcFNvcnRGbiB8fCBjbXAsIHJvb3QpO1xufTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y2hpbGRTZXQuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdXRpbF8xID0gcmVxdWlyZShcIi4uL3V0aWwvdXRpbFwiKTtcbmZ1bmN0aW9uIE5BTUVfT05MWV9DT01QQVJBVE9SKGxlZnQsIHJpZ2h0KSB7XG4gICAgcmV0dXJuIHV0aWxfMS5uYW1lQ29tcGFyZShsZWZ0Lm5hbWUsIHJpZ2h0Lm5hbWUpO1xufVxuZXhwb3J0cy5OQU1FX09OTFlfQ09NUEFSQVRPUiA9IE5BTUVfT05MWV9DT01QQVJBVE9SO1xuZnVuY3Rpb24gTkFNRV9DT01QQVJBVE9SKGxlZnQsIHJpZ2h0KSB7XG4gICAgcmV0dXJuIHV0aWxfMS5uYW1lQ29tcGFyZShsZWZ0LCByaWdodCk7XG59XG5leHBvcnRzLk5BTUVfQ09NUEFSQVRPUiA9IE5BTUVfQ09NUEFSQVRPUjtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y29tcGFyYXRvcnMuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgTm9kZV8xID0gcmVxdWlyZShcIi4uL05vZGVcIik7XG52YXIgdXRpbF8xID0gcmVxdWlyZShcIi4uLy4uL3V0aWwvdXRpbFwiKTtcbi8qKlxuICpcbiAqIEBjb25zdHJ1Y3RvclxuICovXG52YXIgSW5kZXggPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gSW5kZXgoKSB7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEByZXR1cm4ge2Z1bmN0aW9uKCFOYW1lZE5vZGUsICFOYW1lZE5vZGUpOm51bWJlcn0gQSBzdGFuZGFsb25lIGNvbXBhcmlzb24gZnVuY3Rpb24gZm9yXG4gICAgICogdGhpcyBpbmRleFxuICAgICAqL1xuICAgIEluZGV4LnByb3RvdHlwZS5nZXRDb21wYXJlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb21wYXJlLmJpbmQodGhpcyk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHaXZlbiBhIGJlZm9yZSBhbmQgYWZ0ZXIgdmFsdWUgZm9yIGEgbm9kZSwgZGV0ZXJtaW5lIGlmIHRoZSBpbmRleGVkIHZhbHVlIGhhcyBjaGFuZ2VkLiBFdmVuIGlmIHRoZXkgYXJlIGRpZmZlcmVudCxcbiAgICAgKiBpdCdzIHBvc3NpYmxlIHRoYXQgdGhlIGNoYW5nZXMgYXJlIGlzb2xhdGVkIHRvIHBhcnRzIG9mIHRoZSBzbmFwc2hvdCB0aGF0IGFyZSBub3QgaW5kZXhlZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7IU5vZGV9IG9sZE5vZGVcbiAgICAgKiBAcGFyYW0geyFOb2RlfSBuZXdOb2RlXG4gICAgICogQHJldHVybiB7Ym9vbGVhbn0gVHJ1ZSBpZiB0aGUgcG9ydGlvbiBvZiB0aGUgc25hcHNob3QgYmVpbmcgaW5kZXhlZCBjaGFuZ2VkIGJldHdlZW4gb2xkTm9kZSBhbmQgbmV3Tm9kZVxuICAgICAqL1xuICAgIEluZGV4LnByb3RvdHlwZS5pbmRleGVkVmFsdWVDaGFuZ2VkID0gZnVuY3Rpb24gKG9sZE5vZGUsIG5ld05vZGUpIHtcbiAgICAgICAgdmFyIG9sZFdyYXBwZWQgPSBuZXcgTm9kZV8xLk5hbWVkTm9kZSh1dGlsXzEuTUlOX05BTUUsIG9sZE5vZGUpO1xuICAgICAgICB2YXIgbmV3V3JhcHBlZCA9IG5ldyBOb2RlXzEuTmFtZWROb2RlKHV0aWxfMS5NSU5fTkFNRSwgbmV3Tm9kZSk7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbXBhcmUob2xkV3JhcHBlZCwgbmV3V3JhcHBlZCkgIT09IDA7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHshTmFtZWROb2RlfSBhIG5vZGUgd3JhcHBlciB0aGF0IHdpbGwgc29ydCBlcXVhbCB0byBvciBsZXNzIHRoYW5cbiAgICAgKiBhbnkgb3RoZXIgbm9kZSB3cmFwcGVyLCB1c2luZyB0aGlzIGluZGV4XG4gICAgICovXG4gICAgSW5kZXgucHJvdG90eXBlLm1pblBvc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBOb2RlXzEuTmFtZWROb2RlLk1JTjtcbiAgICB9O1xuICAgIHJldHVybiBJbmRleDtcbn0oKSk7XG5leHBvcnRzLkluZGV4ID0gSW5kZXg7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUluZGV4LmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xudmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgSW5kZXhfMSA9IHJlcXVpcmUoXCIuL0luZGV4XCIpO1xudmFyIE5vZGVfMSA9IHJlcXVpcmUoXCIuLi9Ob2RlXCIpO1xudmFyIHV0aWxfMSA9IHJlcXVpcmUoXCIuLi8uLi91dGlsL3V0aWxcIik7XG52YXIgdXRpbF8yID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xudmFyIF9fRU1QVFlfTk9ERTtcbnZhciBLZXlJbmRleCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoS2V5SW5kZXgsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gS2V5SW5kZXgoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEtleUluZGV4LCBcIl9fRU1QVFlfTk9ERVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIF9fRU1QVFlfTk9ERTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsKSB7XG4gICAgICAgICAgICBfX0VNUFRZX05PREUgPSB2YWw7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgS2V5SW5kZXgucHJvdG90eXBlLmNvbXBhcmUgPSBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICByZXR1cm4gdXRpbF8xLm5hbWVDb21wYXJlKGEubmFtZSwgYi5uYW1lKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgS2V5SW5kZXgucHJvdG90eXBlLmlzRGVmaW5lZE9uID0gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgLy8gV2UgY291bGQgcHJvYmFibHkgcmV0dXJuIHRydWUgaGVyZSAoc2luY2UgZXZlcnkgbm9kZSBoYXMgYSBrZXkpLCBidXQgaXQncyBuZXZlciBjYWxsZWRcbiAgICAgICAgLy8gc28ganVzdCBsZWF2aW5nIHVuaW1wbGVtZW50ZWQgZm9yIG5vdy5cbiAgICAgICAgdGhyb3cgdXRpbF8yLmFzc2VydGlvbkVycm9yKCdLZXlJbmRleC5pc0RlZmluZWRPbiBub3QgZXhwZWN0ZWQgdG8gYmUgY2FsbGVkLicpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBLZXlJbmRleC5wcm90b3R5cGUuaW5kZXhlZFZhbHVlQ2hhbmdlZCA9IGZ1bmN0aW9uIChvbGROb2RlLCBuZXdOb2RlKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTsgLy8gVGhlIGtleSBmb3IgYSBub2RlIG5ldmVyIGNoYW5nZXMuXG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIEtleUluZGV4LnByb3RvdHlwZS5taW5Qb3N0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gTm9kZV8xLk5hbWVkTm9kZS5NSU47XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIEtleUluZGV4LnByb3RvdHlwZS5tYXhQb3N0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBUT0RPOiBUaGlzIHNob3VsZCByZWFsbHkgYmUgY3JlYXRlZCBvbmNlIGFuZCBjYWNoZWQgaW4gYSBzdGF0aWMgcHJvcGVydHksIGJ1dFxuICAgICAgICAvLyBOYW1lZE5vZGUgaXNuJ3QgZGVmaW5lZCB5ZXQsIHNvIEkgY2FuJ3QgdXNlIGl0IGluIGEgc3RhdGljLiAgQmxlaC5cbiAgICAgICAgcmV0dXJuIG5ldyBOb2RlXzEuTmFtZWROb2RlKHV0aWxfMS5NQVhfTkFNRSwgX19FTVBUWV9OT0RFKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7Kn0gaW5kZXhWYWx1ZVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXG4gICAgICogQHJldHVybiB7IU5hbWVkTm9kZX1cbiAgICAgKi9cbiAgICBLZXlJbmRleC5wcm90b3R5cGUubWFrZVBvc3QgPSBmdW5jdGlvbiAoaW5kZXhWYWx1ZSwgbmFtZSkge1xuICAgICAgICB1dGlsXzIuYXNzZXJ0KHR5cGVvZiBpbmRleFZhbHVlID09PSAnc3RyaW5nJywgJ0tleUluZGV4IGluZGV4VmFsdWUgbXVzdCBhbHdheXMgYmUgYSBzdHJpbmcuJyk7XG4gICAgICAgIC8vIFdlIGp1c3QgdXNlIGVtcHR5IG5vZGUsIGJ1dCBpdCdsbCBuZXZlciBiZSBjb21wYXJlZCwgc2luY2Ugb3VyIGNvbXBhcmF0b3Igb25seSBsb29rcyBhdCBuYW1lLlxuICAgICAgICByZXR1cm4gbmV3IE5vZGVfMS5OYW1lZE5vZGUoaW5kZXhWYWx1ZSwgX19FTVBUWV9OT0RFKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4geyFzdHJpbmd9IFN0cmluZyByZXByZXNlbnRhdGlvbiBmb3IgaW5jbHVzaW9uIGluIGEgcXVlcnkgc3BlY1xuICAgICAqL1xuICAgIEtleUluZGV4LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICcua2V5JztcbiAgICB9O1xuICAgIHJldHVybiBLZXlJbmRleDtcbn0oSW5kZXhfMS5JbmRleCkpO1xuZXhwb3J0cy5LZXlJbmRleCA9IEtleUluZGV4O1xuZXhwb3J0cy5LRVlfSU5ERVggPSBuZXcgS2V5SW5kZXgoKTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9S2V5SW5kZXguanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG52YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB1dGlsXzEgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG52YXIgdXRpbF8yID0gcmVxdWlyZShcIi4uLy4uL3V0aWwvdXRpbFwiKTtcbnZhciBJbmRleF8xID0gcmVxdWlyZShcIi4vSW5kZXhcIik7XG52YXIgQ2hpbGRyZW5Ob2RlXzEgPSByZXF1aXJlKFwiLi4vQ2hpbGRyZW5Ob2RlXCIpO1xudmFyIE5vZGVfMSA9IHJlcXVpcmUoXCIuLi9Ob2RlXCIpO1xudmFyIG5vZGVGcm9tSlNPTl8xID0gcmVxdWlyZShcIi4uL25vZGVGcm9tSlNPTlwiKTtcbi8qKlxuICogQHBhcmFtIHshUGF0aH0gaW5kZXhQYXRoXG4gKiBAY29uc3RydWN0b3JcbiAqIEBleHRlbmRzIHtJbmRleH1cbiAqL1xudmFyIFBhdGhJbmRleCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoUGF0aEluZGV4LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFBhdGhJbmRleChpbmRleFBhdGhfKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmluZGV4UGF0aF8gPSBpbmRleFBhdGhfO1xuICAgICAgICB1dGlsXzEuYXNzZXJ0KCFpbmRleFBhdGhfLmlzRW1wdHkoKSAmJiBpbmRleFBhdGhfLmdldEZyb250KCkgIT09ICcucHJpb3JpdHknLCBcIkNhbid0IGNyZWF0ZSBQYXRoSW5kZXggd2l0aCBlbXB0eSBwYXRoIG9yIC5wcmlvcml0eSBrZXlcIik7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshTm9kZX0gc25hcFxuICAgICAqIEByZXR1cm4geyFOb2RlfVxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBQYXRoSW5kZXgucHJvdG90eXBlLmV4dHJhY3RDaGlsZCA9IGZ1bmN0aW9uIChzbmFwKSB7XG4gICAgICAgIHJldHVybiBzbmFwLmdldENoaWxkKHRoaXMuaW5kZXhQYXRoXyk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIFBhdGhJbmRleC5wcm90b3R5cGUuaXNEZWZpbmVkT24gPSBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICByZXR1cm4gIW5vZGUuZ2V0Q2hpbGQodGhpcy5pbmRleFBhdGhfKS5pc0VtcHR5KCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIFBhdGhJbmRleC5wcm90b3R5cGUuY29tcGFyZSA9IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgIHZhciBhQ2hpbGQgPSB0aGlzLmV4dHJhY3RDaGlsZChhLm5vZGUpO1xuICAgICAgICB2YXIgYkNoaWxkID0gdGhpcy5leHRyYWN0Q2hpbGQoYi5ub2RlKTtcbiAgICAgICAgdmFyIGluZGV4Q21wID0gYUNoaWxkLmNvbXBhcmVUbyhiQ2hpbGQpO1xuICAgICAgICBpZiAoaW5kZXhDbXAgPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiB1dGlsXzIubmFtZUNvbXBhcmUoYS5uYW1lLCBiLm5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGluZGV4Q21wO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIFBhdGhJbmRleC5wcm90b3R5cGUubWFrZVBvc3QgPSBmdW5jdGlvbiAoaW5kZXhWYWx1ZSwgbmFtZSkge1xuICAgICAgICB2YXIgdmFsdWVOb2RlID0gbm9kZUZyb21KU09OXzEubm9kZUZyb21KU09OKGluZGV4VmFsdWUpO1xuICAgICAgICB2YXIgbm9kZSA9IENoaWxkcmVuTm9kZV8xLkNoaWxkcmVuTm9kZS5FTVBUWV9OT0RFLnVwZGF0ZUNoaWxkKHRoaXMuaW5kZXhQYXRoXywgdmFsdWVOb2RlKTtcbiAgICAgICAgcmV0dXJuIG5ldyBOb2RlXzEuTmFtZWROb2RlKG5hbWUsIG5vZGUpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBQYXRoSW5kZXgucHJvdG90eXBlLm1heFBvc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBub2RlID0gQ2hpbGRyZW5Ob2RlXzEuQ2hpbGRyZW5Ob2RlLkVNUFRZX05PREUudXBkYXRlQ2hpbGQodGhpcy5pbmRleFBhdGhfLCBDaGlsZHJlbk5vZGVfMS5NQVhfTk9ERSk7XG4gICAgICAgIHJldHVybiBuZXcgTm9kZV8xLk5hbWVkTm9kZSh1dGlsXzIuTUFYX05BTUUsIG5vZGUpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBQYXRoSW5kZXgucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pbmRleFBhdGhfLnNsaWNlKCkuam9pbignLycpO1xuICAgIH07XG4gICAgcmV0dXJuIFBhdGhJbmRleDtcbn0oSW5kZXhfMS5JbmRleCkpO1xuZXhwb3J0cy5QYXRoSW5kZXggPSBQYXRoSW5kZXg7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVBhdGhJbmRleC5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIEluZGV4XzEgPSByZXF1aXJlKFwiLi9JbmRleFwiKTtcbnZhciB1dGlsXzEgPSByZXF1aXJlKFwiLi4vLi4vdXRpbC91dGlsXCIpO1xudmFyIE5vZGVfMSA9IHJlcXVpcmUoXCIuLi9Ob2RlXCIpO1xudmFyIExlYWZOb2RlXzEgPSByZXF1aXJlKFwiLi4vTGVhZk5vZGVcIik7XG52YXIgbm9kZUZyb21KU09OO1xudmFyIE1BWF9OT0RFO1xuZnVuY3Rpb24gc2V0Tm9kZUZyb21KU09OKHZhbCkge1xuICAgIG5vZGVGcm9tSlNPTiA9IHZhbDtcbn1cbmV4cG9ydHMuc2V0Tm9kZUZyb21KU09OID0gc2V0Tm9kZUZyb21KU09OO1xuZnVuY3Rpb24gc2V0TWF4Tm9kZSh2YWwpIHtcbiAgICBNQVhfTk9ERSA9IHZhbDtcbn1cbmV4cG9ydHMuc2V0TWF4Tm9kZSA9IHNldE1heE5vZGU7XG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQGV4dGVuZHMge0luZGV4fVxuICogQHByaXZhdGVcbiAqL1xudmFyIFByaW9yaXR5SW5kZXggPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFByaW9yaXR5SW5kZXgsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gUHJpb3JpdHlJbmRleCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIFByaW9yaXR5SW5kZXgucHJvdG90eXBlLmNvbXBhcmUgPSBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICB2YXIgYVByaW9yaXR5ID0gYS5ub2RlLmdldFByaW9yaXR5KCk7XG4gICAgICAgIHZhciBiUHJpb3JpdHkgPSBiLm5vZGUuZ2V0UHJpb3JpdHkoKTtcbiAgICAgICAgdmFyIGluZGV4Q21wID0gYVByaW9yaXR5LmNvbXBhcmVUbyhiUHJpb3JpdHkpO1xuICAgICAgICBpZiAoaW5kZXhDbXAgPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiB1dGlsXzEubmFtZUNvbXBhcmUoYS5uYW1lLCBiLm5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGluZGV4Q21wO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIFByaW9yaXR5SW5kZXgucHJvdG90eXBlLmlzRGVmaW5lZE9uID0gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgcmV0dXJuICFub2RlLmdldFByaW9yaXR5KCkuaXNFbXB0eSgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBQcmlvcml0eUluZGV4LnByb3RvdHlwZS5pbmRleGVkVmFsdWVDaGFuZ2VkID0gZnVuY3Rpb24gKG9sZE5vZGUsIG5ld05vZGUpIHtcbiAgICAgICAgcmV0dXJuICFvbGROb2RlLmdldFByaW9yaXR5KCkuZXF1YWxzKG5ld05vZGUuZ2V0UHJpb3JpdHkoKSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIFByaW9yaXR5SW5kZXgucHJvdG90eXBlLm1pblBvc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBOb2RlXzEuTmFtZWROb2RlLk1JTjtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgUHJpb3JpdHlJbmRleC5wcm90b3R5cGUubWF4UG9zdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBOb2RlXzEuTmFtZWROb2RlKHV0aWxfMS5NQVhfTkFNRSwgbmV3IExlYWZOb2RlXzEuTGVhZk5vZGUoJ1tQUklPUklUWS1QT1NUXScsIE1BWF9OT0RFKSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyp9IGluZGV4VmFsdWVcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICAgICAqIEByZXR1cm4geyFOYW1lZE5vZGV9XG4gICAgICovXG4gICAgUHJpb3JpdHlJbmRleC5wcm90b3R5cGUubWFrZVBvc3QgPSBmdW5jdGlvbiAoaW5kZXhWYWx1ZSwgbmFtZSkge1xuICAgICAgICB2YXIgcHJpb3JpdHlOb2RlID0gbm9kZUZyb21KU09OKGluZGV4VmFsdWUpO1xuICAgICAgICByZXR1cm4gbmV3IE5vZGVfMS5OYW1lZE5vZGUobmFtZSwgbmV3IExlYWZOb2RlXzEuTGVhZk5vZGUoJ1tQUklPUklUWS1QT1NUXScsIHByaW9yaXR5Tm9kZSkpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7IXN0cmluZ30gU3RyaW5nIHJlcHJlc2VudGF0aW9uIGZvciBpbmNsdXNpb24gaW4gYSBxdWVyeSBzcGVjXG4gICAgICovXG4gICAgUHJpb3JpdHlJbmRleC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAnLnByaW9yaXR5JztcbiAgICB9O1xuICAgIHJldHVybiBQcmlvcml0eUluZGV4O1xufShJbmRleF8xLkluZGV4KSk7XG5leHBvcnRzLlByaW9yaXR5SW5kZXggPSBQcmlvcml0eUluZGV4O1xuZXhwb3J0cy5QUklPUklUWV9JTkRFWCA9IG5ldyBQcmlvcml0eUluZGV4KCk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVByaW9yaXR5SW5kZXguanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG52YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBJbmRleF8xID0gcmVxdWlyZShcIi4vSW5kZXhcIik7XG52YXIgTm9kZV8xID0gcmVxdWlyZShcIi4uL05vZGVcIik7XG52YXIgdXRpbF8xID0gcmVxdWlyZShcIi4uLy4uL3V0aWwvdXRpbFwiKTtcbnZhciBub2RlRnJvbUpTT05fMSA9IHJlcXVpcmUoXCIuLi9ub2RlRnJvbUpTT05cIik7XG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQGV4dGVuZHMge0luZGV4fVxuICogQHByaXZhdGVcbiAqL1xudmFyIFZhbHVlSW5kZXggPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFZhbHVlSW5kZXgsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVmFsdWVJbmRleCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIFZhbHVlSW5kZXgucHJvdG90eXBlLmNvbXBhcmUgPSBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICB2YXIgaW5kZXhDbXAgPSBhLm5vZGUuY29tcGFyZVRvKGIubm9kZSk7XG4gICAgICAgIGlmIChpbmRleENtcCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHV0aWxfMS5uYW1lQ29tcGFyZShhLm5hbWUsIGIubmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gaW5kZXhDbXA7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgVmFsdWVJbmRleC5wcm90b3R5cGUuaXNEZWZpbmVkT24gPSBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgVmFsdWVJbmRleC5wcm90b3R5cGUuaW5kZXhlZFZhbHVlQ2hhbmdlZCA9IGZ1bmN0aW9uIChvbGROb2RlLCBuZXdOb2RlKSB7XG4gICAgICAgIHJldHVybiAhb2xkTm9kZS5lcXVhbHMobmV3Tm9kZSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIFZhbHVlSW5kZXgucHJvdG90eXBlLm1pblBvc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBOb2RlXzEuTmFtZWROb2RlLk1JTjtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgVmFsdWVJbmRleC5wcm90b3R5cGUubWF4UG9zdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIE5vZGVfMS5OYW1lZE5vZGUuTUFYO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHsqfSBpbmRleFZhbHVlXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcbiAgICAgKiBAcmV0dXJuIHshTmFtZWROb2RlfVxuICAgICAqL1xuICAgIFZhbHVlSW5kZXgucHJvdG90eXBlLm1ha2VQb3N0ID0gZnVuY3Rpb24gKGluZGV4VmFsdWUsIG5hbWUpIHtcbiAgICAgICAgdmFyIHZhbHVlTm9kZSA9IG5vZGVGcm9tSlNPTl8xLm5vZGVGcm9tSlNPTihpbmRleFZhbHVlKTtcbiAgICAgICAgcmV0dXJuIG5ldyBOb2RlXzEuTmFtZWROb2RlKG5hbWUsIHZhbHVlTm9kZSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHshc3RyaW5nfSBTdHJpbmcgcmVwcmVzZW50YXRpb24gZm9yIGluY2x1c2lvbiBpbiBhIHF1ZXJ5IHNwZWNcbiAgICAgKi9cbiAgICBWYWx1ZUluZGV4LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICcudmFsdWUnO1xuICAgIH07XG4gICAgcmV0dXJuIFZhbHVlSW5kZXg7XG59KEluZGV4XzEuSW5kZXgpKTtcbmV4cG9ydHMuVmFsdWVJbmRleCA9IFZhbHVlSW5kZXg7XG5leHBvcnRzLlZBTFVFX0lOREVYID0gbmV3IFZhbHVlSW5kZXgoKTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9VmFsdWVJbmRleC5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBDaGlsZHJlbk5vZGVfMSA9IHJlcXVpcmUoXCIuL0NoaWxkcmVuTm9kZVwiKTtcbnZhciBMZWFmTm9kZV8xID0gcmVxdWlyZShcIi4vTGVhZk5vZGVcIik7XG52YXIgTm9kZV8xID0gcmVxdWlyZShcIi4vTm9kZVwiKTtcbnZhciB1dGlsXzEgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG52YXIgdXRpbF8yID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xudmFyIGNoaWxkU2V0XzEgPSByZXF1aXJlKFwiLi9jaGlsZFNldFwiKTtcbnZhciBjb21wYXJhdG9yc18xID0gcmVxdWlyZShcIi4vY29tcGFyYXRvcnNcIik7XG52YXIgSW5kZXhNYXBfMSA9IHJlcXVpcmUoXCIuL0luZGV4TWFwXCIpO1xudmFyIFByaW9yaXR5SW5kZXhfMSA9IHJlcXVpcmUoXCIuL2luZGV4ZXMvUHJpb3JpdHlJbmRleFwiKTtcbnZhciBVU0VfSElOWkUgPSB0cnVlO1xuLyoqXG4gKiBDb25zdHJ1Y3RzIGEgc25hcHNob3Qgbm9kZSByZXByZXNlbnRpbmcgdGhlIHBhc3NlZCBKU09OIGFuZCByZXR1cm5zIGl0LlxuICogQHBhcmFtIHsqfSBqc29uIEpTT04gdG8gY3JlYXRlIGEgbm9kZSBmb3IuXG4gKiBAcGFyYW0gez9zdHJpbmd8P251bWJlcj19IHByaW9yaXR5IE9wdGlvbmFsIHByaW9yaXR5IHRvIHVzZS4gIFRoaXMgd2lsbCBiZSBpZ25vcmVkIGlmIHRoZVxuICogcGFzc2VkIEpTT04gY29udGFpbnMgYSAucHJpb3JpdHkgcHJvcGVydHkuXG4gKiBAcmV0dXJuIHshTm9kZX1cbiAqL1xuZnVuY3Rpb24gbm9kZUZyb21KU09OKGpzb24sIHByaW9yaXR5KSB7XG4gICAgaWYgKHByaW9yaXR5ID09PSB2b2lkIDApIHsgcHJpb3JpdHkgPSBudWxsOyB9XG4gICAgaWYgKGpzb24gPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIENoaWxkcmVuTm9kZV8xLkNoaWxkcmVuTm9kZS5FTVBUWV9OT0RFO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGpzb24gPT09ICdvYmplY3QnICYmICcucHJpb3JpdHknIGluIGpzb24pIHtcbiAgICAgICAgcHJpb3JpdHkgPSBqc29uWycucHJpb3JpdHknXTtcbiAgICB9XG4gICAgdXRpbF8yLmFzc2VydChwcmlvcml0eSA9PT0gbnVsbCB8fFxuICAgICAgICB0eXBlb2YgcHJpb3JpdHkgPT09ICdzdHJpbmcnIHx8XG4gICAgICAgIHR5cGVvZiBwcmlvcml0eSA9PT0gJ251bWJlcicgfHxcbiAgICAgICAgKHR5cGVvZiBwcmlvcml0eSA9PT0gJ29iamVjdCcgJiYgJy5zdicgaW4gcHJpb3JpdHkpLCAnSW52YWxpZCBwcmlvcml0eSB0eXBlIGZvdW5kOiAnICsgdHlwZW9mIHByaW9yaXR5KTtcbiAgICBpZiAodHlwZW9mIGpzb24gPT09ICdvYmplY3QnICYmICcudmFsdWUnIGluIGpzb24gJiYganNvblsnLnZhbHVlJ10gIT09IG51bGwpIHtcbiAgICAgICAganNvbiA9IGpzb25bJy52YWx1ZSddO1xuICAgIH1cbiAgICAvLyBWYWxpZCBsZWFmIG5vZGVzIGluY2x1ZGUgbm9uLW9iamVjdHMgb3Igc2VydmVyLXZhbHVlIHdyYXBwZXIgb2JqZWN0c1xuICAgIGlmICh0eXBlb2YganNvbiAhPT0gJ29iamVjdCcgfHwgJy5zdicgaW4ganNvbikge1xuICAgICAgICB2YXIganNvbkxlYWYgPSBqc29uO1xuICAgICAgICByZXR1cm4gbmV3IExlYWZOb2RlXzEuTGVhZk5vZGUoanNvbkxlYWYsIG5vZGVGcm9tSlNPTihwcmlvcml0eSkpO1xuICAgIH1cbiAgICBpZiAoIShqc29uIGluc3RhbmNlb2YgQXJyYXkpICYmIFVTRV9ISU5aRSkge1xuICAgICAgICB2YXIgY2hpbGRyZW5fMSA9IFtdO1xuICAgICAgICB2YXIgY2hpbGRyZW5IYXZlUHJpb3JpdHlfMSA9IGZhbHNlO1xuICAgICAgICB2YXIgaGluemVKc29uT2JqXzEgPSBqc29uO1xuICAgICAgICB1dGlsXzEuZm9yRWFjaChoaW56ZUpzb25PYmpfMSwgZnVuY3Rpb24gKGtleSwgY2hpbGQpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2Yga2V5ICE9PSAnc3RyaW5nJyB8fCBrZXkuc3Vic3RyaW5nKDAsIDEpICE9PSAnLicpIHtcbiAgICAgICAgICAgICAgICAvLyBJZ25vcmUgbWV0YWRhdGEgbm9kZXNcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGROb2RlID0gbm9kZUZyb21KU09OKGhpbnplSnNvbk9ial8xW2tleV0pO1xuICAgICAgICAgICAgICAgIGlmICghY2hpbGROb2RlLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbkhhdmVQcmlvcml0eV8xID1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuSGF2ZVByaW9yaXR5XzEgfHwgIWNoaWxkTm9kZS5nZXRQcmlvcml0eSgpLmlzRW1wdHkoKTtcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW5fMS5wdXNoKG5ldyBOb2RlXzEuTmFtZWROb2RlKGtleSwgY2hpbGROb2RlKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGNoaWxkcmVuXzEubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBDaGlsZHJlbk5vZGVfMS5DaGlsZHJlbk5vZGUuRU1QVFlfTk9ERTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2hpbGRTZXQgPSBjaGlsZFNldF8xLmJ1aWxkQ2hpbGRTZXQoY2hpbGRyZW5fMSwgY29tcGFyYXRvcnNfMS5OQU1FX09OTFlfQ09NUEFSQVRPUiwgZnVuY3Rpb24gKG5hbWVkTm9kZSkgeyByZXR1cm4gbmFtZWROb2RlLm5hbWU7IH0sIGNvbXBhcmF0b3JzXzEuTkFNRV9DT01QQVJBVE9SKTtcbiAgICAgICAgaWYgKGNoaWxkcmVuSGF2ZVByaW9yaXR5XzEpIHtcbiAgICAgICAgICAgIHZhciBzb3J0ZWRDaGlsZFNldCA9IGNoaWxkU2V0XzEuYnVpbGRDaGlsZFNldChjaGlsZHJlbl8xLCBQcmlvcml0eUluZGV4XzEuUFJJT1JJVFlfSU5ERVguZ2V0Q29tcGFyZSgpKTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgQ2hpbGRyZW5Ob2RlXzEuQ2hpbGRyZW5Ob2RlKGNoaWxkU2V0LCBub2RlRnJvbUpTT04ocHJpb3JpdHkpLCBuZXcgSW5kZXhNYXBfMS5JbmRleE1hcCh7ICcucHJpb3JpdHknOiBzb3J0ZWRDaGlsZFNldCB9LCB7ICcucHJpb3JpdHknOiBQcmlvcml0eUluZGV4XzEuUFJJT1JJVFlfSU5ERVggfSkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBDaGlsZHJlbk5vZGVfMS5DaGlsZHJlbk5vZGUoY2hpbGRTZXQsIG5vZGVGcm9tSlNPTihwcmlvcml0eSksIEluZGV4TWFwXzEuSW5kZXhNYXAuRGVmYXVsdCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHZhciBub2RlXzEgPSBDaGlsZHJlbk5vZGVfMS5DaGlsZHJlbk5vZGUuRU1QVFlfTk9ERTtcbiAgICAgICAgdmFyIGpzb25PYmpfMSA9IGpzb247XG4gICAgICAgIHV0aWxfMS5mb3JFYWNoKGpzb25PYmpfMSwgZnVuY3Rpb24gKGtleSwgY2hpbGREYXRhKSB7XG4gICAgICAgICAgICBpZiAodXRpbF8xLmNvbnRhaW5zKGpzb25PYmpfMSwga2V5KSkge1xuICAgICAgICAgICAgICAgIGlmIChrZXkuc3Vic3RyaW5nKDAsIDEpICE9PSAnLicpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWdub3JlIG1ldGFkYXRhIG5vZGVzLlxuICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGROb2RlID0gbm9kZUZyb21KU09OKGNoaWxkRGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGlsZE5vZGUuaXNMZWFmTm9kZSgpIHx8ICFjaGlsZE5vZGUuaXNFbXB0eSgpKVxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZV8xID0gbm9kZV8xLnVwZGF0ZUltbWVkaWF0ZUNoaWxkKGtleSwgY2hpbGROb2RlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gbm9kZV8xLnVwZGF0ZVByaW9yaXR5KG5vZGVGcm9tSlNPTihwcmlvcml0eSkpO1xuICAgIH1cbn1cbmV4cG9ydHMubm9kZUZyb21KU09OID0gbm9kZUZyb21KU09OO1xuUHJpb3JpdHlJbmRleF8xLnNldE5vZGVGcm9tSlNPTihub2RlRnJvbUpTT04pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1ub2RlRnJvbUpTT04uanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdXRpbF8xID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xudmFyIHV0aWxfMiA9IHJlcXVpcmUoXCIuLi91dGlsL3V0aWxcIik7XG52YXIgdXRpbF8zID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xudmFyIE1BWF9OT0RFO1xuZnVuY3Rpb24gc2V0TWF4Tm9kZSh2YWwpIHtcbiAgICBNQVhfTk9ERSA9IHZhbDtcbn1cbmV4cG9ydHMuc2V0TWF4Tm9kZSA9IHNldE1heE5vZGU7XG4vKipcbiAqIEBwYXJhbSB7KCFzdHJpbmd8IW51bWJlcil9IHByaW9yaXR5XG4gKiBAcmV0dXJuIHshc3RyaW5nfVxuICovXG5leHBvcnRzLnByaW9yaXR5SGFzaFRleHQgPSBmdW5jdGlvbiAocHJpb3JpdHkpIHtcbiAgICBpZiAodHlwZW9mIHByaW9yaXR5ID09PSAnbnVtYmVyJylcbiAgICAgICAgcmV0dXJuICdudW1iZXI6JyArIHV0aWxfMi5kb3VibGVUb0lFRUU3NTRTdHJpbmcocHJpb3JpdHkpO1xuICAgIGVsc2VcbiAgICAgICAgcmV0dXJuICdzdHJpbmc6JyArIHByaW9yaXR5O1xufTtcbi8qKlxuICogVmFsaWRhdGVzIHRoYXQgYSBwcmlvcml0eSBzbmFwc2hvdCBOb2RlIGlzIHZhbGlkLlxuICpcbiAqIEBwYXJhbSB7IU5vZGV9IHByaW9yaXR5Tm9kZVxuICovXG5leHBvcnRzLnZhbGlkYXRlUHJpb3JpdHlOb2RlID0gZnVuY3Rpb24gKHByaW9yaXR5Tm9kZSkge1xuICAgIGlmIChwcmlvcml0eU5vZGUuaXNMZWFmTm9kZSgpKSB7XG4gICAgICAgIHZhciB2YWwgPSBwcmlvcml0eU5vZGUudmFsKCk7XG4gICAgICAgIHV0aWxfMS5hc3NlcnQodHlwZW9mIHZhbCA9PT0gJ3N0cmluZycgfHxcbiAgICAgICAgICAgIHR5cGVvZiB2YWwgPT09ICdudW1iZXInIHx8XG4gICAgICAgICAgICAodHlwZW9mIHZhbCA9PT0gJ29iamVjdCcgJiYgdXRpbF8zLmNvbnRhaW5zKHZhbCwgJy5zdicpKSwgJ1ByaW9yaXR5IG11c3QgYmUgYSBzdHJpbmcgb3IgbnVtYmVyLicpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdXRpbF8xLmFzc2VydChwcmlvcml0eU5vZGUgPT09IE1BWF9OT0RFIHx8IHByaW9yaXR5Tm9kZS5pc0VtcHR5KCksICdwcmlvcml0eSBvZiB1bmV4cGVjdGVkIHR5cGUuJyk7XG4gICAgfVxuICAgIC8vIERvbid0IGNhbGwgZ2V0UHJpb3JpdHkoKSBvbiBNQVhfTk9ERSB0byBhdm9pZCBoaXR0aW5nIGFzc2VydGlvbi5cbiAgICB1dGlsXzEuYXNzZXJ0KHByaW9yaXR5Tm9kZSA9PT0gTUFYX05PREUgfHwgcHJpb3JpdHlOb2RlLmdldFByaW9yaXR5KCkuaXNFbXB0eSgpLCBcIlByaW9yaXR5IG5vZGVzIGNhbid0IGhhdmUgYSBwcmlvcml0eSBvZiB0aGVpciBvd24uXCIpO1xufTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c25hcC5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB1dGlsXzEgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG52YXIgdXRpbF8yID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xuLyoqXG4gKiBUcmFja3MgYSBjb2xsZWN0aW9uIG9mIHN0YXRzLlxuICpcbiAqIEBjb25zdHJ1Y3RvclxuICovXG52YXIgU3RhdHNDb2xsZWN0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFN0YXRzQ29sbGVjdGlvbigpIHtcbiAgICAgICAgdGhpcy5jb3VudGVyc18gPSB7fTtcbiAgICB9XG4gICAgU3RhdHNDb2xsZWN0aW9uLnByb3RvdHlwZS5pbmNyZW1lbnRDb3VudGVyID0gZnVuY3Rpb24gKG5hbWUsIGFtb3VudCkge1xuICAgICAgICBpZiAoYW1vdW50ID09PSB2b2lkIDApIHsgYW1vdW50ID0gMTsgfVxuICAgICAgICBpZiAoIXV0aWxfMi5jb250YWlucyh0aGlzLmNvdW50ZXJzXywgbmFtZSkpXG4gICAgICAgICAgICB0aGlzLmNvdW50ZXJzX1tuYW1lXSA9IDA7XG4gICAgICAgIHRoaXMuY291bnRlcnNfW25hbWVdICs9IGFtb3VudDtcbiAgICB9O1xuICAgIFN0YXRzQ29sbGVjdGlvbi5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdXRpbF8xLmRlZXBDb3B5KHRoaXMuY291bnRlcnNfKTtcbiAgICB9O1xuICAgIHJldHVybiBTdGF0c0NvbGxlY3Rpb247XG59KCkpO1xuZXhwb3J0cy5TdGF0c0NvbGxlY3Rpb24gPSBTdGF0c0NvbGxlY3Rpb247XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVN0YXRzQ29sbGVjdGlvbi5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB1dGlsXzEgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG4vKipcbiAqIFJldHVybnMgdGhlIGRlbHRhIGZyb20gdGhlIHByZXZpb3VzIGNhbGwgdG8gZ2V0IHN0YXRzLlxuICpcbiAqIEBwYXJhbSBjb2xsZWN0aW9uXyBUaGUgY29sbGVjdGlvbiB0byBcImxpc3RlblwiIHRvLlxuICogQGNvbnN0cnVjdG9yXG4gKi9cbnZhciBTdGF0c0xpc3RlbmVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFN0YXRzTGlzdGVuZXIoY29sbGVjdGlvbl8pIHtcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uXyA9IGNvbGxlY3Rpb25fO1xuICAgICAgICB0aGlzLmxhc3RfID0gbnVsbDtcbiAgICB9XG4gICAgU3RhdHNMaXN0ZW5lci5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbmV3U3RhdHMgPSB0aGlzLmNvbGxlY3Rpb25fLmdldCgpO1xuICAgICAgICB2YXIgZGVsdGEgPSB1dGlsXzEuY2xvbmUobmV3U3RhdHMpO1xuICAgICAgICBpZiAodGhpcy5sYXN0Xykge1xuICAgICAgICAgICAgdXRpbF8xLmZvckVhY2godGhpcy5sYXN0XywgZnVuY3Rpb24gKHN0YXQsIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgZGVsdGFbc3RhdF0gPSBkZWx0YVtzdGF0XSAtIHZhbHVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5sYXN0XyA9IG5ld1N0YXRzO1xuICAgICAgICByZXR1cm4gZGVsdGE7XG4gICAgfTtcbiAgICByZXR1cm4gU3RhdHNMaXN0ZW5lcjtcbn0oKSk7XG5leHBvcnRzLlN0YXRzTGlzdGVuZXIgPSBTdGF0c0xpc3RlbmVyO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TdGF0c0xpc3RlbmVyLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIFN0YXRzQ29sbGVjdGlvbl8xID0gcmVxdWlyZShcIi4vU3RhdHNDb2xsZWN0aW9uXCIpO1xudmFyIFN0YXRzTWFuYWdlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBTdGF0c01hbmFnZXIoKSB7XG4gICAgfVxuICAgIFN0YXRzTWFuYWdlci5nZXRDb2xsZWN0aW9uID0gZnVuY3Rpb24gKHJlcG9JbmZvKSB7XG4gICAgICAgIHZhciBoYXNoU3RyaW5nID0gcmVwb0luZm8udG9TdHJpbmcoKTtcbiAgICAgICAgaWYgKCF0aGlzLmNvbGxlY3Rpb25zX1toYXNoU3RyaW5nXSkge1xuICAgICAgICAgICAgdGhpcy5jb2xsZWN0aW9uc19baGFzaFN0cmluZ10gPSBuZXcgU3RhdHNDb2xsZWN0aW9uXzEuU3RhdHNDb2xsZWN0aW9uKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuY29sbGVjdGlvbnNfW2hhc2hTdHJpbmddO1xuICAgIH07XG4gICAgU3RhdHNNYW5hZ2VyLmdldE9yQ3JlYXRlUmVwb3J0ZXIgPSBmdW5jdGlvbiAocmVwb0luZm8sIGNyZWF0b3JGdW5jdGlvbikge1xuICAgICAgICB2YXIgaGFzaFN0cmluZyA9IHJlcG9JbmZvLnRvU3RyaW5nKCk7XG4gICAgICAgIGlmICghdGhpcy5yZXBvcnRlcnNfW2hhc2hTdHJpbmddKSB7XG4gICAgICAgICAgICB0aGlzLnJlcG9ydGVyc19baGFzaFN0cmluZ10gPSBjcmVhdG9yRnVuY3Rpb24oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5yZXBvcnRlcnNfW2hhc2hTdHJpbmddO1xuICAgIH07XG4gICAgU3RhdHNNYW5hZ2VyLmNvbGxlY3Rpb25zXyA9IHt9O1xuICAgIFN0YXRzTWFuYWdlci5yZXBvcnRlcnNfID0ge307XG4gICAgcmV0dXJuIFN0YXRzTWFuYWdlcjtcbn0oKSk7XG5leHBvcnRzLlN0YXRzTWFuYWdlciA9IFN0YXRzTWFuYWdlcjtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3RhdHNNYW5hZ2VyLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHV0aWxfMSA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvdXRpbFwiKTtcbnZhciB1dGlsXzIgPSByZXF1aXJlKFwiLi4vdXRpbC91dGlsXCIpO1xudmFyIFN0YXRzTGlzdGVuZXJfMSA9IHJlcXVpcmUoXCIuL1N0YXRzTGlzdGVuZXJcIik7XG4vLyBBc3N1bWluZyBzb21lIGFwcHMgbWF5IGhhdmUgYSBzaG9ydCBhbW91bnQgb2YgdGltZSBvbiBwYWdlLCBhbmQgYSBidWxrIG9mIGZpcmViYXNlIG9wZXJhdGlvbnMgcHJvYmFibHlcbi8vIGhhcHBlbiBvbiBwYWdlIGxvYWQsIHdlIHRyeSB0byByZXBvcnQgb3VyIGZpcnN0IHNldCBvZiBzdGF0cyBwcmV0dHkgcXVpY2tseSwgYnV0IHdlIHdhaXQgYXQgbGVhc3QgMTBcbi8vIHNlY29uZHMgdG8gdHJ5IHRvIGVuc3VyZSB0aGUgRmlyZWJhc2UgY29ubmVjdGlvbiBpcyBlc3RhYmxpc2hlZCAvIHNldHRsZWQuXG52YXIgRklSU1RfU1RBVFNfTUlOX1RJTUUgPSAxMCAqIDEwMDA7XG52YXIgRklSU1RfU1RBVFNfTUFYX1RJTUUgPSAzMCAqIDEwMDA7XG4vLyBXZSdsbCBjb250aW51ZSB0byByZXBvcnQgc3RhdHMgb24gYXZlcmFnZSBldmVyeSA1IG1pbnV0ZXMuXG52YXIgUkVQT1JUX1NUQVRTX0lOVEVSVkFMID0gNSAqIDYwICogMTAwMDtcbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKi9cbnZhciBTdGF0c1JlcG9ydGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSBjb2xsZWN0aW9uXG4gICAgICogQHBhcmFtIHNlcnZlcl9cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBTdGF0c1JlcG9ydGVyKGNvbGxlY3Rpb24sIHNlcnZlcl8pIHtcbiAgICAgICAgdGhpcy5zZXJ2ZXJfID0gc2VydmVyXztcbiAgICAgICAgdGhpcy5zdGF0c1RvUmVwb3J0XyA9IHt9O1xuICAgICAgICB0aGlzLnN0YXRzTGlzdGVuZXJfID0gbmV3IFN0YXRzTGlzdGVuZXJfMS5TdGF0c0xpc3RlbmVyKGNvbGxlY3Rpb24pO1xuICAgICAgICB2YXIgdGltZW91dCA9IEZJUlNUX1NUQVRTX01JTl9USU1FICtcbiAgICAgICAgICAgIChGSVJTVF9TVEFUU19NQVhfVElNRSAtIEZJUlNUX1NUQVRTX01JTl9USU1FKSAqIE1hdGgucmFuZG9tKCk7XG4gICAgICAgIHV0aWxfMi5zZXRUaW1lb3V0Tm9uQmxvY2tpbmcodGhpcy5yZXBvcnRTdGF0c18uYmluZCh0aGlzKSwgTWF0aC5mbG9vcih0aW1lb3V0KSk7XG4gICAgfVxuICAgIFN0YXRzUmVwb3J0ZXIucHJvdG90eXBlLmluY2x1ZGVTdGF0ID0gZnVuY3Rpb24gKHN0YXQpIHtcbiAgICAgICAgdGhpcy5zdGF0c1RvUmVwb3J0X1tzdGF0XSA9IHRydWU7XG4gICAgfTtcbiAgICBTdGF0c1JlcG9ydGVyLnByb3RvdHlwZS5yZXBvcnRTdGF0c18gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBzdGF0cyA9IHRoaXMuc3RhdHNMaXN0ZW5lcl8uZ2V0KCk7XG4gICAgICAgIHZhciByZXBvcnRlZFN0YXRzID0ge307XG4gICAgICAgIHZhciBoYXZlU3RhdHNUb1JlcG9ydCA9IGZhbHNlO1xuICAgICAgICB1dGlsXzEuZm9yRWFjaChzdGF0cywgZnVuY3Rpb24gKHN0YXQsIHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAodmFsdWUgPiAwICYmIHV0aWxfMS5jb250YWlucyhfdGhpcy5zdGF0c1RvUmVwb3J0Xywgc3RhdCkpIHtcbiAgICAgICAgICAgICAgICByZXBvcnRlZFN0YXRzW3N0YXRdID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgaGF2ZVN0YXRzVG9SZXBvcnQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGhhdmVTdGF0c1RvUmVwb3J0KSB7XG4gICAgICAgICAgICB0aGlzLnNlcnZlcl8ucmVwb3J0U3RhdHMocmVwb3J0ZWRTdGF0cyk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gcXVldWUgb3VyIG5leHQgcnVuLlxuICAgICAgICB1dGlsXzIuc2V0VGltZW91dE5vbkJsb2NraW5nKHRoaXMucmVwb3J0U3RhdHNfLmJpbmQodGhpcyksIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDIgKiBSRVBPUlRfU1RBVFNfSU5URVJWQUwpKTtcbiAgICB9O1xuICAgIHJldHVybiBTdGF0c1JlcG9ydGVyO1xufSgpKTtcbmV4cG9ydHMuU3RhdHNSZXBvcnRlciA9IFN0YXRzUmVwb3J0ZXI7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVN0YXRzUmVwb3J0ZXIuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdXRpbF8xID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xuLyoqXG4gKiBXcmFwcyBhIERPTSBTdG9yYWdlIG9iamVjdCBhbmQ6XG4gKiAtIGF1dG9tYXRpY2FsbHkgZW5jb2RlIG9iamVjdHMgYXMgSlNPTiBzdHJpbmdzIGJlZm9yZSBzdG9yaW5nIHRoZW0gdG8gYWxsb3cgdXMgdG8gc3RvcmUgYXJiaXRyYXJ5IHR5cGVzLlxuICogLSBwcmVmaXhlcyBuYW1lcyB3aXRoIFwiZmlyZWJhc2U6XCIgdG8gYXZvaWQgY29sbGlzaW9ucyB3aXRoIGFwcCBkYXRhLlxuICpcbiAqIFdlIGF1dG9tYXRpY2FsbHkgKHNlZSBzdG9yYWdlLmpzKSBjcmVhdGUgdHdvIHN1Y2ggd3JhcHBlcnMsIG9uZSBmb3Igc2Vzc2lvblN0b3JhZ2UsXG4gKiBhbmQgb25lIGZvciBsb2NhbFN0b3JhZ2UuXG4gKlxuICogQGNvbnN0cnVjdG9yXG4gKi9cbnZhciBET01TdG9yYWdlV3JhcHBlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge1N0b3JhZ2V9IGRvbVN0b3JhZ2VfIFRoZSB1bmRlcmx5aW5nIHN0b3JhZ2Ugb2JqZWN0IChlLmcuIGxvY2FsU3RvcmFnZSBvciBzZXNzaW9uU3RvcmFnZSlcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBET01TdG9yYWdlV3JhcHBlcihkb21TdG9yYWdlXykge1xuICAgICAgICB0aGlzLmRvbVN0b3JhZ2VfID0gZG9tU3RvcmFnZV87XG4gICAgICAgIC8vIFVzZSBhIHByZWZpeCB0byBhdm9pZCBjb2xsaXNpb25zIHdpdGggb3RoZXIgc3R1ZmYgc2F2ZWQgYnkgdGhlIGFwcC5cbiAgICAgICAgdGhpcy5wcmVmaXhfID0gJ2ZpcmViYXNlOic7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgVGhlIGtleSB0byBzYXZlIHRoZSB2YWx1ZSB1bmRlclxuICAgICAqIEBwYXJhbSB7P09iamVjdH0gdmFsdWUgVGhlIHZhbHVlIGJlaW5nIHN0b3JlZCwgb3IgbnVsbCB0byByZW1vdmUgdGhlIGtleS5cbiAgICAgKi9cbiAgICBET01TdG9yYWdlV3JhcHBlci5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlID09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuZG9tU3RvcmFnZV8ucmVtb3ZlSXRlbSh0aGlzLnByZWZpeGVkTmFtZV8oa2V5KSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmRvbVN0b3JhZ2VfLnNldEl0ZW0odGhpcy5wcmVmaXhlZE5hbWVfKGtleSksIHV0aWxfMS5zdHJpbmdpZnkodmFsdWUpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGtleVxuICAgICAqIEByZXR1cm4geyp9IFRoZSB2YWx1ZSB0aGF0IHdhcyBzdG9yZWQgdW5kZXIgdGhpcyBrZXksIG9yIG51bGxcbiAgICAgKi9cbiAgICBET01TdG9yYWdlV3JhcHBlci5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKGtleSkge1xuICAgICAgICB2YXIgc3RvcmVkVmFsID0gdGhpcy5kb21TdG9yYWdlXy5nZXRJdGVtKHRoaXMucHJlZml4ZWROYW1lXyhrZXkpKTtcbiAgICAgICAgaWYgKHN0b3JlZFZhbCA9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB1dGlsXzEuanNvbkV2YWwoc3RvcmVkVmFsKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGtleVxuICAgICAqL1xuICAgIERPTVN0b3JhZ2VXcmFwcGVyLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIHRoaXMuZG9tU3RvcmFnZV8ucmVtb3ZlSXRlbSh0aGlzLnByZWZpeGVkTmFtZV8oa2V5KSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICAgICAqIEByZXR1cm4ge3N0cmluZ31cbiAgICAgKi9cbiAgICBET01TdG9yYWdlV3JhcHBlci5wcm90b3R5cGUucHJlZml4ZWROYW1lXyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByZWZpeF8gKyBuYW1lO1xuICAgIH07XG4gICAgRE9NU3RvcmFnZVdyYXBwZXIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kb21TdG9yYWdlXy50b1N0cmluZygpO1xuICAgIH07XG4gICAgcmV0dXJuIERPTVN0b3JhZ2VXcmFwcGVyO1xufSgpKTtcbmV4cG9ydHMuRE9NU3RvcmFnZVdyYXBwZXIgPSBET01TdG9yYWdlV3JhcHBlcjtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9RE9NU3RvcmFnZVdyYXBwZXIuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdXRpbF8xID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xuLyoqXG4gKiBBbiBpbi1tZW1vcnkgc3RvcmFnZSBpbXBsZW1lbnRhdGlvbiB0aGF0IG1hdGNoZXMgdGhlIEFQSSBvZiBET01TdG9yYWdlV3JhcHBlclxuICogKFRPRE86IGNyZWF0ZSBpbnRlcmZhY2UgZm9yIGJvdGggdG8gaW1wbGVtZW50KS5cbiAqXG4gKiBAY29uc3RydWN0b3JcbiAqL1xudmFyIE1lbW9yeVN0b3JhZ2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTWVtb3J5U3RvcmFnZSgpIHtcbiAgICAgICAgdGhpcy5jYWNoZV8gPSB7fTtcbiAgICAgICAgdGhpcy5pc0luTWVtb3J5U3RvcmFnZSA9IHRydWU7XG4gICAgfVxuICAgIE1lbW9yeVN0b3JhZ2UucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSA9PSBudWxsKSB7XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5jYWNoZV9ba2V5XTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY2FjaGVfW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgTWVtb3J5U3RvcmFnZS5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKGtleSkge1xuICAgICAgICBpZiAodXRpbF8xLmNvbnRhaW5zKHRoaXMuY2FjaGVfLCBrZXkpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jYWNoZV9ba2V5XTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIE1lbW9yeVN0b3JhZ2UucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgZGVsZXRlIHRoaXMuY2FjaGVfW2tleV07XG4gICAgfTtcbiAgICByZXR1cm4gTWVtb3J5U3RvcmFnZTtcbn0oKSk7XG5leHBvcnRzLk1lbW9yeVN0b3JhZ2UgPSBNZW1vcnlTdG9yYWdlO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1NZW1vcnlTdG9yYWdlLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIERPTVN0b3JhZ2VXcmFwcGVyXzEgPSByZXF1aXJlKFwiLi9ET01TdG9yYWdlV3JhcHBlclwiKTtcbnZhciBNZW1vcnlTdG9yYWdlXzEgPSByZXF1aXJlKFwiLi9NZW1vcnlTdG9yYWdlXCIpO1xuLyoqXG4gKiBIZWxwZXIgdG8gY3JlYXRlIGEgRE9NU3RvcmFnZVdyYXBwZXIgb3IgZWxzZSBmYWxsIGJhY2sgdG8gTWVtb3J5U3RvcmFnZS5cbiAqIFRPRE86IE9uY2UgTWVtb3J5U3RvcmFnZSBhbmQgRE9NU3RvcmFnZVdyYXBwZXIgaGF2ZSBhIHNoYXJlZCBpbnRlcmZhY2UgdGhpcyBtZXRob2QgYW5ub3RhdGlvbiBzaG91bGQgY2hhbmdlXG4gKiB0byByZWZsZWN0IHRoaXMgdHlwZVxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBkb21TdG9yYWdlTmFtZSBOYW1lIG9mIHRoZSB1bmRlcmx5aW5nIHN0b3JhZ2Ugb2JqZWN0XG4gKiAgIChlLmcuICdsb2NhbFN0b3JhZ2UnIG9yICdzZXNzaW9uU3RvcmFnZScpLlxuICogQHJldHVybiB7P30gVHVybmluZyBvZmYgdHlwZSBpbmZvcm1hdGlvbiB1bnRpbCBhIGNvbW1vbiBpbnRlcmZhY2UgaXMgZGVmaW5lZC5cbiAqL1xudmFyIGNyZWF0ZVN0b3JhZ2Vmb3IgPSBmdW5jdGlvbiAoZG9tU3RvcmFnZU5hbWUpIHtcbiAgICB0cnkge1xuICAgICAgICAvLyBOT1RFOiBqdXN0IGFjY2Vzc2luZyBcImxvY2FsU3RvcmFnZVwiIG9yIFwid2luZG93Wydsb2NhbFN0b3JhZ2UnXVwiIG1heSB0aHJvdyBhIHNlY3VyaXR5IGV4Y2VwdGlvbixcbiAgICAgICAgLy8gc28gaXQgbXVzdCBiZSBpbnNpZGUgdGhlIHRyeS9jYXRjaC5cbiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmXG4gICAgICAgICAgICB0eXBlb2Ygd2luZG93W2RvbVN0b3JhZ2VOYW1lXSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIC8vIE5lZWQgdG8gdGVzdCBjYWNoZS4gSnVzdCBiZWNhdXNlIGl0J3MgaGVyZSBkb2Vzbid0IG1lYW4gaXQgd29ya3NcbiAgICAgICAgICAgIHZhciBkb21TdG9yYWdlID0gd2luZG93W2RvbVN0b3JhZ2VOYW1lXTtcbiAgICAgICAgICAgIGRvbVN0b3JhZ2Uuc2V0SXRlbSgnZmlyZWJhc2U6c2VudGluZWwnLCAnY2FjaGUnKTtcbiAgICAgICAgICAgIGRvbVN0b3JhZ2UucmVtb3ZlSXRlbSgnZmlyZWJhc2U6c2VudGluZWwnKTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgRE9NU3RvcmFnZVdyYXBwZXJfMS5ET01TdG9yYWdlV3JhcHBlcihkb21TdG9yYWdlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjYXRjaCAoZSkgeyB9XG4gICAgLy8gRmFpbGVkIHRvIGNyZWF0ZSB3cmFwcGVyLiAgSnVzdCByZXR1cm4gaW4tbWVtb3J5IHN0b3JhZ2UuXG4gICAgLy8gVE9ETzogbG9nP1xuICAgIHJldHVybiBuZXcgTWVtb3J5U3RvcmFnZV8xLk1lbW9yeVN0b3JhZ2UoKTtcbn07XG4vKiogQSBzdG9yYWdlIG9iamVjdCB0aGF0IGxhc3RzIGFjcm9zcyBzZXNzaW9ucyAqL1xuZXhwb3J0cy5QZXJzaXN0ZW50U3RvcmFnZSA9IGNyZWF0ZVN0b3JhZ2Vmb3IoJ2xvY2FsU3RvcmFnZScpO1xuLyoqIEEgc3RvcmFnZSBvYmplY3QgdGhhdCBvbmx5IGxhc3RzIG9uZSBzZXNzaW9uICovXG5leHBvcnRzLlNlc3Npb25TdG9yYWdlID0gY3JlYXRlU3RvcmFnZWZvcignc2Vzc2lvblN0b3JhZ2UnKTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3RvcmFnZS5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB1dGlsXzEgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG4vKipcbiAqIEltcGxlbWVudHMgYSBzZXQgd2l0aCBhIGNvdW50IG9mIGVsZW1lbnRzLlxuICpcbiAqIEB0ZW1wbGF0ZSBLLCBWXG4gKi9cbnZhciBDb3VudGVkU2V0ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENvdW50ZWRTZXQoKSB7XG4gICAgICAgIHRoaXMuc2V0ID0ge307XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7IUt9IGl0ZW1cbiAgICAgKiBAcGFyYW0ge1Z9IHZhbFxuICAgICAqL1xuICAgIENvdW50ZWRTZXQucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIChpdGVtLCB2YWwpIHtcbiAgICAgICAgdGhpcy5zZXRbaXRlbV0gPSB2YWwgIT09IG51bGwgPyB2YWwgOiB0cnVlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshS30ga2V5XG4gICAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBDb3VudGVkU2V0LnByb3RvdHlwZS5jb250YWlucyA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgcmV0dXJuIHV0aWxfMS5jb250YWlucyh0aGlzLnNldCwga2V5KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7IUt9IGl0ZW1cbiAgICAgKiBAcmV0dXJuIHtWfVxuICAgICAqL1xuICAgIENvdW50ZWRTZXQucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRhaW5zKGl0ZW0pID8gdGhpcy5zZXRbaXRlbV0gOiB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFLfSBpdGVtXG4gICAgICovXG4gICAgQ291bnRlZFNldC5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgZGVsZXRlIHRoaXMuc2V0W2l0ZW1dO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogRGVsZXRlcyBldmVyeXRoaW5nIGluIHRoZSBzZXRcbiAgICAgKi9cbiAgICBDb3VudGVkU2V0LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zZXQgPSB7fTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFRydWUgaWYgdGhlcmUncyBub3RoaW5nIGluIHRoZSBzZXRcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgICAqL1xuICAgIENvdW50ZWRTZXQucHJvdG90eXBlLmlzRW1wdHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB1dGlsXzEuaXNFbXB0eSh0aGlzLnNldCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHtudW1iZXJ9IFRoZSBudW1iZXIgb2YgaXRlbXMgaW4gdGhlIHNldFxuICAgICAqL1xuICAgIENvdW50ZWRTZXQucHJvdG90eXBlLmNvdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdXRpbF8xLmdldENvdW50KHRoaXMuc2V0KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJ1biBhIGZ1bmN0aW9uIG9uIGVhY2ggayx2IHBhaXIgaW4gdGhlIHNldFxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oSywgVil9IGZuXG4gICAgICovXG4gICAgQ291bnRlZFNldC5wcm90b3R5cGUuZWFjaCA9IGZ1bmN0aW9uIChmbikge1xuICAgICAgICB1dGlsXzEuZm9yRWFjaCh0aGlzLnNldCwgZnVuY3Rpb24gKGssIHYpIHsgcmV0dXJuIGZuKGssIHYpOyB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIE1vc3RseSBmb3IgZGVidWdnaW5nXG4gICAgICogQHJldHVybiB7QXJyYXkuPEs+fSBUaGUga2V5cyBwcmVzZW50IGluIHRoaXMgQ291bnRlZFNldFxuICAgICAqL1xuICAgIENvdW50ZWRTZXQucHJvdG90eXBlLmtleXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBrZXlzID0gW107XG4gICAgICAgIHV0aWxfMS5mb3JFYWNoKHRoaXMuc2V0LCBmdW5jdGlvbiAoaykge1xuICAgICAgICAgICAga2V5cy5wdXNoKGspO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGtleXM7XG4gICAgfTtcbiAgICByZXR1cm4gQ291bnRlZFNldDtcbn0oKSk7XG5leHBvcnRzLkNvdW50ZWRTZXQgPSBDb3VudGVkU2V0O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Db3VudGVkU2V0LmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHV0aWxfMSA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvdXRpbFwiKTtcbi8qKlxuICogQmFzZSBjbGFzcyB0byBiZSB1c2VkIGlmIHlvdSB3YW50IHRvIGVtaXQgZXZlbnRzLiBDYWxsIHRoZSBjb25zdHJ1Y3RvciB3aXRoXG4gKiB0aGUgc2V0IG9mIGFsbG93ZWQgZXZlbnQgbmFtZXMuXG4gKi9cbnZhciBFdmVudEVtaXR0ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshQXJyYXkuPHN0cmluZz59IGFsbG93ZWRFdmVudHNfXG4gICAgICovXG4gICAgZnVuY3Rpb24gRXZlbnRFbWl0dGVyKGFsbG93ZWRFdmVudHNfKSB7XG4gICAgICAgIHRoaXMuYWxsb3dlZEV2ZW50c18gPSBhbGxvd2VkRXZlbnRzXztcbiAgICAgICAgdGhpcy5saXN0ZW5lcnNfID0ge307XG4gICAgICAgIHV0aWxfMS5hc3NlcnQoQXJyYXkuaXNBcnJheShhbGxvd2VkRXZlbnRzXykgJiYgYWxsb3dlZEV2ZW50c18ubGVuZ3RoID4gMCwgJ1JlcXVpcmVzIGEgbm9uLWVtcHR5IGFycmF5Jyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRvIGJlIGNhbGxlZCBieSBkZXJpdmVkIGNsYXNzZXMgdG8gdHJpZ2dlciBldmVudHMuXG4gICAgICogQHBhcmFtIHshc3RyaW5nfSBldmVudFR5cGVcbiAgICAgKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzXG4gICAgICovXG4gICAgRXZlbnRFbWl0dGVyLnByb3RvdHlwZS50cmlnZ2VyID0gZnVuY3Rpb24gKGV2ZW50VHlwZSkge1xuICAgICAgICB2YXIgdmFyX2FyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhcl9hcmdzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHRoaXMubGlzdGVuZXJzX1tldmVudFR5cGVdKSkge1xuICAgICAgICAgICAgLy8gQ2xvbmUgdGhlIGxpc3QsIHNpbmNlIGNhbGxiYWNrcyBjb3VsZCBhZGQvcmVtb3ZlIGxpc3RlbmVycy5cbiAgICAgICAgICAgIHZhciBsaXN0ZW5lcnMgPSB0aGlzLmxpc3RlbmVyc19bZXZlbnRUeXBlXS5zbGljZSgpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaXN0ZW5lcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBsaXN0ZW5lcnNbaV0uY2FsbGJhY2suYXBwbHkobGlzdGVuZXJzW2ldLmNvbnRleHQsIHZhcl9hcmdzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uIChldmVudFR5cGUsIGNhbGxiYWNrLCBjb250ZXh0KSB7XG4gICAgICAgIHRoaXMudmFsaWRhdGVFdmVudFR5cGVfKGV2ZW50VHlwZSk7XG4gICAgICAgIHRoaXMubGlzdGVuZXJzX1tldmVudFR5cGVdID0gdGhpcy5saXN0ZW5lcnNfW2V2ZW50VHlwZV0gfHwgW107XG4gICAgICAgIHRoaXMubGlzdGVuZXJzX1tldmVudFR5cGVdLnB1c2goeyBjYWxsYmFjazogY2FsbGJhY2ssIGNvbnRleHQ6IGNvbnRleHQgfSk7XG4gICAgICAgIHZhciBldmVudERhdGEgPSB0aGlzLmdldEluaXRpYWxFdmVudChldmVudFR5cGUpO1xuICAgICAgICBpZiAoZXZlbnREYXRhKSB7XG4gICAgICAgICAgICBjYWxsYmFjay5hcHBseShjb250ZXh0LCBldmVudERhdGEpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBFdmVudEVtaXR0ZXIucHJvdG90eXBlLm9mZiA9IGZ1bmN0aW9uIChldmVudFR5cGUsIGNhbGxiYWNrLCBjb250ZXh0KSB7XG4gICAgICAgIHRoaXMudmFsaWRhdGVFdmVudFR5cGVfKGV2ZW50VHlwZSk7XG4gICAgICAgIHZhciBsaXN0ZW5lcnMgPSB0aGlzLmxpc3RlbmVyc19bZXZlbnRUeXBlXSB8fCBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaXN0ZW5lcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChsaXN0ZW5lcnNbaV0uY2FsbGJhY2sgPT09IGNhbGxiYWNrICYmXG4gICAgICAgICAgICAgICAgKCFjb250ZXh0IHx8IGNvbnRleHQgPT09IGxpc3RlbmVyc1tpXS5jb250ZXh0KSkge1xuICAgICAgICAgICAgICAgIGxpc3RlbmVycy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBFdmVudEVtaXR0ZXIucHJvdG90eXBlLnZhbGlkYXRlRXZlbnRUeXBlXyA9IGZ1bmN0aW9uIChldmVudFR5cGUpIHtcbiAgICAgICAgdXRpbF8xLmFzc2VydCh0aGlzLmFsbG93ZWRFdmVudHNfLmZpbmQoZnVuY3Rpb24gKGV0KSB7XG4gICAgICAgICAgICByZXR1cm4gZXQgPT09IGV2ZW50VHlwZTtcbiAgICAgICAgfSksICdVbmtub3duIGV2ZW50OiAnICsgZXZlbnRUeXBlKTtcbiAgICB9O1xuICAgIHJldHVybiBFdmVudEVtaXR0ZXI7XG59KCkpO1xuZXhwb3J0cy5FdmVudEVtaXR0ZXIgPSBFdmVudEVtaXR0ZXI7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUV2ZW50RW1pdHRlci5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBTb3J0ZWRNYXBfMSA9IHJlcXVpcmUoXCIuL1NvcnRlZE1hcFwiKTtcbnZhciBQYXRoXzEgPSByZXF1aXJlKFwiLi9QYXRoXCIpO1xudmFyIHV0aWxfMSA9IHJlcXVpcmUoXCIuL3V0aWxcIik7XG52YXIgdXRpbF8yID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xudmFyIGVtcHR5Q2hpbGRyZW5TaW5nbGV0b247XG4vKipcbiAqIFNpbmdsZXRvbiBlbXB0eSBjaGlsZHJlbiBjb2xsZWN0aW9uLlxuICpcbiAqIEBjb25zdFxuICogQHR5cGUgeyFTb3J0ZWRNYXAuPHN0cmluZywgIUltbXV0YWJsZVRyZWUuPD8+Pn1cbiAqL1xudmFyIEVtcHR5Q2hpbGRyZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCFlbXB0eUNoaWxkcmVuU2luZ2xldG9uKSB7XG4gICAgICAgIGVtcHR5Q2hpbGRyZW5TaW5nbGV0b24gPSBuZXcgU29ydGVkTWFwXzEuU29ydGVkTWFwKHV0aWxfMS5zdHJpbmdDb21wYXJlKTtcbiAgICB9XG4gICAgcmV0dXJuIGVtcHR5Q2hpbGRyZW5TaW5nbGV0b247XG59O1xuLyoqXG4gKiBBIHRyZWUgd2l0aCBpbW11dGFibGUgZWxlbWVudHMuXG4gKi9cbnZhciBJbW11dGFibGVUcmVlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIEB0ZW1wbGF0ZSBUXG4gICAgICogQHBhcmFtIHs/VH0gdmFsdWVcbiAgICAgKiBAcGFyYW0ge1NvcnRlZE1hcC48c3RyaW5nLCAhSW1tdXRhYmxlVHJlZS48VD4+PX0gY2hpbGRyZW5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBJbW11dGFibGVUcmVlKHZhbHVlLCBjaGlsZHJlbikge1xuICAgICAgICBpZiAoY2hpbGRyZW4gPT09IHZvaWQgMCkgeyBjaGlsZHJlbiA9IEVtcHR5Q2hpbGRyZW4oKTsgfVxuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICAgIHRoaXMuY2hpbGRyZW4gPSBjaGlsZHJlbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQHRlbXBsYXRlIFRcbiAgICAgKiBAcGFyYW0geyFPYmplY3QuPHN0cmluZywgIVQ+fSBvYmpcbiAgICAgKiBAcmV0dXJuIHshSW1tdXRhYmxlVHJlZS48IVQ+fVxuICAgICAqL1xuICAgIEltbXV0YWJsZVRyZWUuZnJvbU9iamVjdCA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgdmFyIHRyZWUgPSBJbW11dGFibGVUcmVlLkVtcHR5O1xuICAgICAgICB1dGlsXzIuZm9yRWFjaChvYmosIGZ1bmN0aW9uIChjaGlsZFBhdGgsIGNoaWxkU25hcCkge1xuICAgICAgICAgICAgdHJlZSA9IHRyZWUuc2V0KG5ldyBQYXRoXzEuUGF0aChjaGlsZFBhdGgpLCBjaGlsZFNuYXApO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRyZWU7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBUcnVlIGlmIHRoZSB2YWx1ZSBpcyBlbXB0eSBhbmQgdGhlcmUgYXJlIG5vIGNoaWxkcmVuXG4gICAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBJbW11dGFibGVUcmVlLnByb3RvdHlwZS5pc0VtcHR5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy52YWx1ZSA9PT0gbnVsbCAmJiB0aGlzLmNoaWxkcmVuLmlzRW1wdHkoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdpdmVuIGEgcGF0aCBhbmQgcHJlZGljYXRlLCByZXR1cm4gdGhlIGZpcnN0IG5vZGUgYW5kIHRoZSBwYXRoIHRvIHRoYXQgbm9kZVxuICAgICAqIHdoZXJlIHRoZSBwcmVkaWNhdGUgcmV0dXJucyB0cnVlLlxuICAgICAqXG4gICAgICogVE9ETyBEbyBhIHBlcmYgdGVzdCAtLSBJZiB3ZSdyZSBjcmVhdGluZyBhIGJ1bmNoIG9mIHtwYXRoOiB2YWx1ZTp9IG9iamVjdHNcbiAgICAgKiBvbiB0aGUgd2F5IGJhY2sgb3V0LCBpdCBtYXkgYmUgYmV0dGVyIHRvIHBhc3MgZG93biBhIHBhdGhTb0ZhciBvYmouXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyFQYXRofSByZWxhdGl2ZVBhdGggVGhlIHJlbWFpbmRlciBvZiB0aGUgcGF0aFxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oVCk6Ym9vbGVhbn0gcHJlZGljYXRlIFRoZSBwcmVkaWNhdGUgdG8gc2F0aXNmeSB0byByZXR1cm4gYVxuICAgICAqICAgbm9kZVxuICAgICAqIEByZXR1cm4gez97cGF0aDohUGF0aCwgdmFsdWU6IVR9fVxuICAgICAqL1xuICAgIEltbXV0YWJsZVRyZWUucHJvdG90eXBlLmZpbmRSb290TW9zdE1hdGNoaW5nUGF0aEFuZFZhbHVlID0gZnVuY3Rpb24gKHJlbGF0aXZlUGF0aCwgcHJlZGljYXRlKSB7XG4gICAgICAgIGlmICh0aGlzLnZhbHVlICE9IG51bGwgJiYgcHJlZGljYXRlKHRoaXMudmFsdWUpKSB7XG4gICAgICAgICAgICByZXR1cm4geyBwYXRoOiBQYXRoXzEuUGF0aC5FbXB0eSwgdmFsdWU6IHRoaXMudmFsdWUgfTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChyZWxhdGl2ZVBhdGguaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgZnJvbnQgPSByZWxhdGl2ZVBhdGguZ2V0RnJvbnQoKTtcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGQgPSB0aGlzLmNoaWxkcmVuLmdldChmcm9udCk7XG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjaGlsZEV4aXN0aW5nUGF0aEFuZFZhbHVlID0gY2hpbGQuZmluZFJvb3RNb3N0TWF0Y2hpbmdQYXRoQW5kVmFsdWUocmVsYXRpdmVQYXRoLnBvcEZyb250KCksIHByZWRpY2F0ZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGlsZEV4aXN0aW5nUGF0aEFuZFZhbHVlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmdWxsUGF0aCA9IG5ldyBQYXRoXzEuUGF0aChmcm9udCkuY2hpbGQoY2hpbGRFeGlzdGluZ1BhdGhBbmRWYWx1ZS5wYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7IHBhdGg6IGZ1bGxQYXRoLCB2YWx1ZTogY2hpbGRFeGlzdGluZ1BhdGhBbmRWYWx1ZS52YWx1ZSB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogRmluZCwgaWYgaXQgZXhpc3RzLCB0aGUgc2hvcnRlc3Qgc3VicGF0aCBvZiB0aGUgZ2l2ZW4gcGF0aCB0aGF0IHBvaW50cyBhIGRlZmluZWRcbiAgICAgKiB2YWx1ZSBpbiB0aGUgdHJlZVxuICAgICAqIEBwYXJhbSB7IVBhdGh9IHJlbGF0aXZlUGF0aFxuICAgICAqIEByZXR1cm4gez97cGF0aDogIVBhdGgsIHZhbHVlOiAhVH19XG4gICAgICovXG4gICAgSW1tdXRhYmxlVHJlZS5wcm90b3R5cGUuZmluZFJvb3RNb3N0VmFsdWVBbmRQYXRoID0gZnVuY3Rpb24gKHJlbGF0aXZlUGF0aCkge1xuICAgICAgICByZXR1cm4gdGhpcy5maW5kUm9vdE1vc3RNYXRjaGluZ1BhdGhBbmRWYWx1ZShyZWxhdGl2ZVBhdGgsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRydWU7IH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshUGF0aH0gcmVsYXRpdmVQYXRoXG4gICAgICogQHJldHVybiB7IUltbXV0YWJsZVRyZWUuPFQ+fSBUaGUgc3VidHJlZSBhdCB0aGUgZ2l2ZW4gcGF0aFxuICAgICAqL1xuICAgIEltbXV0YWJsZVRyZWUucHJvdG90eXBlLnN1YnRyZWUgPSBmdW5jdGlvbiAocmVsYXRpdmVQYXRoKSB7XG4gICAgICAgIGlmIChyZWxhdGl2ZVBhdGguaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBmcm9udCA9IHJlbGF0aXZlUGF0aC5nZXRGcm9udCgpO1xuICAgICAgICAgICAgdmFyIGNoaWxkVHJlZSA9IHRoaXMuY2hpbGRyZW4uZ2V0KGZyb250KTtcbiAgICAgICAgICAgIGlmIChjaGlsZFRyZWUgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2hpbGRUcmVlLnN1YnRyZWUocmVsYXRpdmVQYXRoLnBvcEZyb250KCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEltbXV0YWJsZVRyZWUuRW1wdHk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFNldHMgYSB2YWx1ZSBhdCB0aGUgc3BlY2lmaWVkIHBhdGguXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyFQYXRofSByZWxhdGl2ZVBhdGggUGF0aCB0byBzZXQgdmFsdWUgYXQuXG4gICAgICogQHBhcmFtIHs/VH0gdG9TZXQgVmFsdWUgdG8gc2V0LlxuICAgICAqIEByZXR1cm4geyFJbW11dGFibGVUcmVlLjxUPn0gUmVzdWx0aW5nIHRyZWUuXG4gICAgICovXG4gICAgSW1tdXRhYmxlVHJlZS5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKHJlbGF0aXZlUGF0aCwgdG9TZXQpIHtcbiAgICAgICAgaWYgKHJlbGF0aXZlUGF0aC5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgSW1tdXRhYmxlVHJlZSh0b1NldCwgdGhpcy5jaGlsZHJlbik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgZnJvbnQgPSByZWxhdGl2ZVBhdGguZ2V0RnJvbnQoKTtcbiAgICAgICAgICAgIHZhciBjaGlsZCA9IHRoaXMuY2hpbGRyZW4uZ2V0KGZyb250KSB8fCBJbW11dGFibGVUcmVlLkVtcHR5O1xuICAgICAgICAgICAgdmFyIG5ld0NoaWxkID0gY2hpbGQuc2V0KHJlbGF0aXZlUGF0aC5wb3BGcm9udCgpLCB0b1NldCk7XG4gICAgICAgICAgICB2YXIgbmV3Q2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuLmluc2VydChmcm9udCwgbmV3Q2hpbGQpO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBJbW11dGFibGVUcmVlKHRoaXMudmFsdWUsIG5ld0NoaWxkcmVuKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyB0aGUgdmFsdWUgYXQgdGhlIHNwZWNpZmllZCBwYXRoLlxuICAgICAqXG4gICAgICogQHBhcmFtIHshUGF0aH0gcmVsYXRpdmVQYXRoIFBhdGggdG8gdmFsdWUgdG8gcmVtb3ZlLlxuICAgICAqIEByZXR1cm4geyFJbW11dGFibGVUcmVlLjxUPn0gUmVzdWx0aW5nIHRyZWUuXG4gICAgICovXG4gICAgSW1tdXRhYmxlVHJlZS5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKHJlbGF0aXZlUGF0aCkge1xuICAgICAgICBpZiAocmVsYXRpdmVQYXRoLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuY2hpbGRyZW4uaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEltbXV0YWJsZVRyZWUuRW1wdHk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEltbXV0YWJsZVRyZWUobnVsbCwgdGhpcy5jaGlsZHJlbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgZnJvbnQgPSByZWxhdGl2ZVBhdGguZ2V0RnJvbnQoKTtcbiAgICAgICAgICAgIHZhciBjaGlsZCA9IHRoaXMuY2hpbGRyZW4uZ2V0KGZyb250KTtcbiAgICAgICAgICAgIGlmIChjaGlsZCkge1xuICAgICAgICAgICAgICAgIHZhciBuZXdDaGlsZCA9IGNoaWxkLnJlbW92ZShyZWxhdGl2ZVBhdGgucG9wRnJvbnQoKSk7XG4gICAgICAgICAgICAgICAgdmFyIG5ld0NoaWxkcmVuID0gdm9pZCAwO1xuICAgICAgICAgICAgICAgIGlmIChuZXdDaGlsZC5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3Q2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuLnJlbW92ZShmcm9udCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBuZXdDaGlsZHJlbiA9IHRoaXMuY2hpbGRyZW4uaW5zZXJ0KGZyb250LCBuZXdDaGlsZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnZhbHVlID09PSBudWxsICYmIG5ld0NoaWxkcmVuLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gSW1tdXRhYmxlVHJlZS5FbXB0eTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgSW1tdXRhYmxlVHJlZSh0aGlzLnZhbHVlLCBuZXdDaGlsZHJlbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldHMgYSB2YWx1ZSBmcm9tIHRoZSB0cmVlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHshUGF0aH0gcmVsYXRpdmVQYXRoIFBhdGggdG8gZ2V0IHZhbHVlIGZvci5cbiAgICAgKiBAcmV0dXJuIHs/VH0gVmFsdWUgYXQgcGF0aCwgb3IgbnVsbC5cbiAgICAgKi9cbiAgICBJbW11dGFibGVUcmVlLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAocmVsYXRpdmVQYXRoKSB7XG4gICAgICAgIGlmIChyZWxhdGl2ZVBhdGguaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBmcm9udCA9IHJlbGF0aXZlUGF0aC5nZXRGcm9udCgpO1xuICAgICAgICAgICAgdmFyIGNoaWxkID0gdGhpcy5jaGlsZHJlbi5nZXQoZnJvbnQpO1xuICAgICAgICAgICAgaWYgKGNoaWxkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNoaWxkLmdldChyZWxhdGl2ZVBhdGgucG9wRnJvbnQoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogUmVwbGFjZSB0aGUgc3VidHJlZSBhdCB0aGUgc3BlY2lmaWVkIHBhdGggd2l0aCB0aGUgZ2l2ZW4gbmV3IHRyZWUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyFQYXRofSByZWxhdGl2ZVBhdGggUGF0aCB0byByZXBsYWNlIHN1YnRyZWUgZm9yLlxuICAgICAqIEBwYXJhbSB7IUltbXV0YWJsZVRyZWV9IG5ld1RyZWUgTmV3IHRyZWUuXG4gICAgICogQHJldHVybiB7IUltbXV0YWJsZVRyZWV9IFJlc3VsdGluZyB0cmVlLlxuICAgICAqL1xuICAgIEltbXV0YWJsZVRyZWUucHJvdG90eXBlLnNldFRyZWUgPSBmdW5jdGlvbiAocmVsYXRpdmVQYXRoLCBuZXdUcmVlKSB7XG4gICAgICAgIGlmIChyZWxhdGl2ZVBhdGguaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3VHJlZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBmcm9udCA9IHJlbGF0aXZlUGF0aC5nZXRGcm9udCgpO1xuICAgICAgICAgICAgdmFyIGNoaWxkID0gdGhpcy5jaGlsZHJlbi5nZXQoZnJvbnQpIHx8IEltbXV0YWJsZVRyZWUuRW1wdHk7XG4gICAgICAgICAgICB2YXIgbmV3Q2hpbGQgPSBjaGlsZC5zZXRUcmVlKHJlbGF0aXZlUGF0aC5wb3BGcm9udCgpLCBuZXdUcmVlKTtcbiAgICAgICAgICAgIHZhciBuZXdDaGlsZHJlbiA9IHZvaWQgMDtcbiAgICAgICAgICAgIGlmIChuZXdDaGlsZC5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgICAgICBuZXdDaGlsZHJlbiA9IHRoaXMuY2hpbGRyZW4ucmVtb3ZlKGZyb250KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG5ld0NoaWxkcmVuID0gdGhpcy5jaGlsZHJlbi5pbnNlcnQoZnJvbnQsIG5ld0NoaWxkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXcgSW1tdXRhYmxlVHJlZSh0aGlzLnZhbHVlLCBuZXdDaGlsZHJlbik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFBlcmZvcm1zIGEgZGVwdGggZmlyc3QgZm9sZCBvbiB0aGlzIHRyZWUuIFRyYW5zZm9ybXMgYSB0cmVlIGludG8gYSBzaW5nbGVcbiAgICAgKiB2YWx1ZSwgZ2l2ZW4gYSBmdW5jdGlvbiB0aGF0IG9wZXJhdGVzIG9uIHRoZSBwYXRoIHRvIGEgbm9kZSwgYW4gb3B0aW9uYWxcbiAgICAgKiBjdXJyZW50IHZhbHVlLCBhbmQgYSBtYXAgb2YgY2hpbGQgbmFtZXMgdG8gZm9sZGVkIHN1YnRyZWVzXG4gICAgICogQHRlbXBsYXRlIFZcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKFBhdGgsID9ULCBPYmplY3QuPHN0cmluZywgVj4pOlZ9IGZuXG4gICAgICogQHJldHVybiB7Vn1cbiAgICAgKi9cbiAgICBJbW11dGFibGVUcmVlLnByb3RvdHlwZS5mb2xkID0gZnVuY3Rpb24gKGZuKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZvbGRfKFBhdGhfMS5QYXRoLkVtcHR5LCBmbik7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZWN1cnNpdmUgaGVscGVyIGZvciBwdWJsaWMtZmFjaW5nIGZvbGQoKSBtZXRob2RcbiAgICAgKiBAdGVtcGxhdGUgVlxuICAgICAqIEBwYXJhbSB7IVBhdGh9IHBhdGhTb0ZhclxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oUGF0aCwgP1QsIE9iamVjdC48c3RyaW5nLCBWPik6Vn0gZm5cbiAgICAgKiBAcmV0dXJuIHtWfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgSW1tdXRhYmxlVHJlZS5wcm90b3R5cGUuZm9sZF8gPSBmdW5jdGlvbiAocGF0aFNvRmFyLCBmbikge1xuICAgICAgICB2YXIgYWNjdW0gPSB7fTtcbiAgICAgICAgdGhpcy5jaGlsZHJlbi5pbm9yZGVyVHJhdmVyc2FsKGZ1bmN0aW9uIChjaGlsZEtleSwgY2hpbGRUcmVlKSB7XG4gICAgICAgICAgICBhY2N1bVtjaGlsZEtleV0gPSBjaGlsZFRyZWUuZm9sZF8ocGF0aFNvRmFyLmNoaWxkKGNoaWxkS2V5KSwgZm4pO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGZuKHBhdGhTb0ZhciwgdGhpcy52YWx1ZSwgYWNjdW0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogRmluZCB0aGUgZmlyc3QgbWF0Y2hpbmcgdmFsdWUgb24gdGhlIGdpdmVuIHBhdGguIFJldHVybiB0aGUgcmVzdWx0IG9mIGFwcGx5aW5nIGYgdG8gaXQuXG4gICAgICogQHRlbXBsYXRlIFZcbiAgICAgKiBAcGFyYW0geyFQYXRofSBwYXRoXG4gICAgICogQHBhcmFtIHshZnVuY3Rpb24oIVBhdGgsICFUKTo/Vn0gZlxuICAgICAqIEByZXR1cm4gez9WfVxuICAgICAqL1xuICAgIEltbXV0YWJsZVRyZWUucHJvdG90eXBlLmZpbmRPblBhdGggPSBmdW5jdGlvbiAocGF0aCwgZikge1xuICAgICAgICByZXR1cm4gdGhpcy5maW5kT25QYXRoXyhwYXRoLCBQYXRoXzEuUGF0aC5FbXB0eSwgZik7XG4gICAgfTtcbiAgICBJbW11dGFibGVUcmVlLnByb3RvdHlwZS5maW5kT25QYXRoXyA9IGZ1bmN0aW9uIChwYXRoVG9Gb2xsb3csIHBhdGhTb0ZhciwgZikge1xuICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy52YWx1ZSA/IGYocGF0aFNvRmFyLCB0aGlzLnZhbHVlKSA6IGZhbHNlO1xuICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKHBhdGhUb0ZvbGxvdy5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBmcm9udCA9IHBhdGhUb0ZvbGxvdy5nZXRGcm9udCgpO1xuICAgICAgICAgICAgICAgIHZhciBuZXh0Q2hpbGQgPSB0aGlzLmNoaWxkcmVuLmdldChmcm9udCk7XG4gICAgICAgICAgICAgICAgaWYgKG5leHRDaGlsZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV4dENoaWxkLmZpbmRPblBhdGhfKHBhdGhUb0ZvbGxvdy5wb3BGcm9udCgpLCBwYXRoU29GYXIuY2hpbGQoZnJvbnQpLCBmKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyFQYXRofSBwYXRoXG4gICAgICogQHBhcmFtIHshZnVuY3Rpb24oIVBhdGgsICFUKX0gZlxuICAgICAqIEByZXR1cm5zIHshSW1tdXRhYmxlVHJlZS48VD59XG4gICAgICovXG4gICAgSW1tdXRhYmxlVHJlZS5wcm90b3R5cGUuZm9yZWFjaE9uUGF0aCA9IGZ1bmN0aW9uIChwYXRoLCBmKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZvcmVhY2hPblBhdGhfKHBhdGgsIFBhdGhfMS5QYXRoLkVtcHR5LCBmKTtcbiAgICB9O1xuICAgIEltbXV0YWJsZVRyZWUucHJvdG90eXBlLmZvcmVhY2hPblBhdGhfID0gZnVuY3Rpb24gKHBhdGhUb0ZvbGxvdywgY3VycmVudFJlbGF0aXZlUGF0aCwgZikge1xuICAgICAgICBpZiAocGF0aFRvRm9sbG93LmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAodGhpcy52YWx1ZSkge1xuICAgICAgICAgICAgICAgIGYoY3VycmVudFJlbGF0aXZlUGF0aCwgdGhpcy52YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZnJvbnQgPSBwYXRoVG9Gb2xsb3cuZ2V0RnJvbnQoKTtcbiAgICAgICAgICAgIHZhciBuZXh0Q2hpbGQgPSB0aGlzLmNoaWxkcmVuLmdldChmcm9udCk7XG4gICAgICAgICAgICBpZiAobmV4dENoaWxkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5leHRDaGlsZC5mb3JlYWNoT25QYXRoXyhwYXRoVG9Gb2xsb3cucG9wRnJvbnQoKSwgY3VycmVudFJlbGF0aXZlUGF0aC5jaGlsZChmcm9udCksIGYpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEltbXV0YWJsZVRyZWUuRW1wdHk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIENhbGxzIHRoZSBnaXZlbiBmdW5jdGlvbiBmb3IgZWFjaCBub2RlIGluIHRoZSB0cmVlIHRoYXQgaGFzIGEgdmFsdWUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKCFQYXRoLCAhVCl9IGYgQSBmdW5jdGlvbiB0byBiZSBjYWxsZWQgd2l0aFxuICAgICAqICAgdGhlIHBhdGggZnJvbSB0aGUgcm9vdCBvZiB0aGUgdHJlZSB0byBhIG5vZGUsIGFuZCB0aGUgdmFsdWUgYXQgdGhhdCBub2RlLlxuICAgICAqICAgQ2FsbGVkIGluIGRlcHRoLWZpcnN0IG9yZGVyLlxuICAgICAqL1xuICAgIEltbXV0YWJsZVRyZWUucHJvdG90eXBlLmZvcmVhY2ggPSBmdW5jdGlvbiAoZikge1xuICAgICAgICB0aGlzLmZvcmVhY2hfKFBhdGhfMS5QYXRoLkVtcHR5LCBmKTtcbiAgICB9O1xuICAgIEltbXV0YWJsZVRyZWUucHJvdG90eXBlLmZvcmVhY2hfID0gZnVuY3Rpb24gKGN1cnJlbnRSZWxhdGl2ZVBhdGgsIGYpIHtcbiAgICAgICAgdGhpcy5jaGlsZHJlbi5pbm9yZGVyVHJhdmVyc2FsKGZ1bmN0aW9uIChjaGlsZE5hbWUsIGNoaWxkVHJlZSkge1xuICAgICAgICAgICAgY2hpbGRUcmVlLmZvcmVhY2hfKGN1cnJlbnRSZWxhdGl2ZVBhdGguY2hpbGQoY2hpbGROYW1lKSwgZik7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodGhpcy52YWx1ZSkge1xuICAgICAgICAgICAgZihjdXJyZW50UmVsYXRpdmVQYXRoLCB0aGlzLnZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKHN0cmluZywgIVQpfSBmXG4gICAgICovXG4gICAgSW1tdXRhYmxlVHJlZS5wcm90b3R5cGUuZm9yZWFjaENoaWxkID0gZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgdGhpcy5jaGlsZHJlbi5pbm9yZGVyVHJhdmVyc2FsKGZ1bmN0aW9uIChjaGlsZE5hbWUsIGNoaWxkVHJlZSkge1xuICAgICAgICAgICAgaWYgKGNoaWxkVHJlZS52YWx1ZSkge1xuICAgICAgICAgICAgICAgIGYoY2hpbGROYW1lLCBjaGlsZFRyZWUudmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEltbXV0YWJsZVRyZWUuRW1wdHkgPSBuZXcgSW1tdXRhYmxlVHJlZShudWxsKTtcbiAgICByZXR1cm4gSW1tdXRhYmxlVHJlZTtcbn0oKSk7XG5leHBvcnRzLkltbXV0YWJsZVRyZWUgPSBJbW11dGFibGVUcmVlO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1JbW11dGFibGVUcmVlLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHV0aWxfMSA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvdXRpbFwiKTtcbi8qKlxuICogRmFuY3kgSUQgZ2VuZXJhdG9yIHRoYXQgY3JlYXRlcyAyMC1jaGFyYWN0ZXIgc3RyaW5nIGlkZW50aWZpZXJzIHdpdGggdGhlXG4gKiBmb2xsb3dpbmcgcHJvcGVydGllczpcbiAqXG4gKiAxLiBUaGV5J3JlIGJhc2VkIG9uIHRpbWVzdGFtcCBzbyB0aGF0IHRoZXkgc29ydCAqYWZ0ZXIqIGFueSBleGlzdGluZyBpZHMuXG4gKiAyLiBUaGV5IGNvbnRhaW4gNzItYml0cyBvZiByYW5kb20gZGF0YSBhZnRlciB0aGUgdGltZXN0YW1wIHNvIHRoYXQgSURzIHdvbid0XG4gKiAgICBjb2xsaWRlIHdpdGggb3RoZXIgY2xpZW50cycgSURzLlxuICogMy4gVGhleSBzb3J0ICpsZXhpY29ncmFwaGljYWxseSogKHNvIHRoZSB0aW1lc3RhbXAgaXMgY29udmVydGVkIHRvIGNoYXJhY3RlcnNcbiAqICAgIHRoYXQgd2lsbCBzb3J0IHByb3Blcmx5KS5cbiAqIDQuIFRoZXkncmUgbW9ub3RvbmljYWxseSBpbmNyZWFzaW5nLiBFdmVuIGlmIHlvdSBnZW5lcmF0ZSBtb3JlIHRoYW4gb25lIGluXG4gKiAgICB0aGUgc2FtZSB0aW1lc3RhbXAsIHRoZSBsYXR0ZXIgb25lcyB3aWxsIHNvcnQgYWZ0ZXIgdGhlIGZvcm1lciBvbmVzLiBXZSBkb1xuICogICAgdGhpcyBieSB1c2luZyB0aGUgcHJldmlvdXMgcmFuZG9tIGJpdHMgYnV0IFwiaW5jcmVtZW50aW5nXCIgdGhlbSBieSAxIChvbmx5XG4gKiAgICBpbiB0aGUgY2FzZSBvZiBhIHRpbWVzdGFtcCBjb2xsaXNpb24pLlxuICovXG5leHBvcnRzLm5leHRQdXNoSWQgPSAoZnVuY3Rpb24gKCkge1xuICAgIC8vIE1vZGVsZWQgYWZ0ZXIgYmFzZTY0IHdlYi1zYWZlIGNoYXJzLCBidXQgb3JkZXJlZCBieSBBU0NJSS5cbiAgICB2YXIgUFVTSF9DSEFSUyA9ICctMDEyMzQ1Njc4OUFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaX2FiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6JztcbiAgICAvLyBUaW1lc3RhbXAgb2YgbGFzdCBwdXNoLCB1c2VkIHRvIHByZXZlbnQgbG9jYWwgY29sbGlzaW9ucyBpZiB5b3UgcHVzaCB0d2ljZVxuICAgIC8vIGluIG9uZSBtcy5cbiAgICB2YXIgbGFzdFB1c2hUaW1lID0gMDtcbiAgICAvLyBXZSBnZW5lcmF0ZSA3Mi1iaXRzIG9mIHJhbmRvbW5lc3Mgd2hpY2ggZ2V0IHR1cm5lZCBpbnRvIDEyIGNoYXJhY3RlcnMgYW5kXG4gICAgLy8gYXBwZW5kZWQgdG8gdGhlIHRpbWVzdGFtcCB0byBwcmV2ZW50IGNvbGxpc2lvbnMgd2l0aCBvdGhlciBjbGllbnRzLiBXZVxuICAgIC8vIHN0b3JlIHRoZSBsYXN0IGNoYXJhY3RlcnMgd2UgZ2VuZXJhdGVkIGJlY2F1c2UgaW4gdGhlIGV2ZW50IG9mIGEgY29sbGlzaW9uLFxuICAgIC8vIHdlJ2xsIHVzZSB0aG9zZSBzYW1lIGNoYXJhY3RlcnMgZXhjZXB0IFwiaW5jcmVtZW50ZWRcIiBieSBvbmUuXG4gICAgdmFyIGxhc3RSYW5kQ2hhcnMgPSBbXTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG5vdykge1xuICAgICAgICB2YXIgZHVwbGljYXRlVGltZSA9IG5vdyA9PT0gbGFzdFB1c2hUaW1lO1xuICAgICAgICBsYXN0UHVzaFRpbWUgPSBub3c7XG4gICAgICAgIHZhciBpO1xuICAgICAgICB2YXIgdGltZVN0YW1wQ2hhcnMgPSBuZXcgQXJyYXkoOCk7XG4gICAgICAgIGZvciAoaSA9IDc7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICB0aW1lU3RhbXBDaGFyc1tpXSA9IFBVU0hfQ0hBUlMuY2hhckF0KG5vdyAlIDY0KTtcbiAgICAgICAgICAgIC8vIE5PVEU6IENhbid0IHVzZSA8PCBoZXJlIGJlY2F1c2UgamF2YXNjcmlwdCB3aWxsIGNvbnZlcnQgdG8gaW50IGFuZCBsb3NlXG4gICAgICAgICAgICAvLyB0aGUgdXBwZXIgYml0cy5cbiAgICAgICAgICAgIG5vdyA9IE1hdGguZmxvb3Iobm93IC8gNjQpO1xuICAgICAgICB9XG4gICAgICAgIHV0aWxfMS5hc3NlcnQobm93ID09PSAwLCAnQ2Fubm90IHB1c2ggYXQgdGltZSA9PSAwJyk7XG4gICAgICAgIHZhciBpZCA9IHRpbWVTdGFtcENoYXJzLmpvaW4oJycpO1xuICAgICAgICBpZiAoIWR1cGxpY2F0ZVRpbWUpIHtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCAxMjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgbGFzdFJhbmRDaGFyc1tpXSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDY0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIElmIHRoZSB0aW1lc3RhbXAgaGFzbid0IGNoYW5nZWQgc2luY2UgbGFzdCBwdXNoLCB1c2UgdGhlIHNhbWUgcmFuZG9tXG4gICAgICAgICAgICAvLyBudW1iZXIsIGV4Y2VwdCBpbmNyZW1lbnRlZCBieSAxLlxuICAgICAgICAgICAgZm9yIChpID0gMTE7IGkgPj0gMCAmJiBsYXN0UmFuZENoYXJzW2ldID09PSA2MzsgaS0tKSB7XG4gICAgICAgICAgICAgICAgbGFzdFJhbmRDaGFyc1tpXSA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsYXN0UmFuZENoYXJzW2ldKys7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChpID0gMDsgaSA8IDEyOyBpKyspIHtcbiAgICAgICAgICAgIGlkICs9IFBVU0hfQ0hBUlMuY2hhckF0KGxhc3RSYW5kQ2hhcnNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHV0aWxfMS5hc3NlcnQoaWQubGVuZ3RoID09PSAyMCwgJ25leHRQdXNoSWQ6IExlbmd0aCBzaG91bGQgYmUgMjAuJyk7XG4gICAgICAgIHJldHVybiBpZDtcbiAgICB9O1xufSkoKTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9TmV4dFB1c2hJZC5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHV0aWxfMSA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvdXRpbFwiKTtcbnZhciBFdmVudEVtaXR0ZXJfMSA9IHJlcXVpcmUoXCIuL0V2ZW50RW1pdHRlclwiKTtcbnZhciB1dGlsXzIgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG4vKipcbiAqIE1vbml0b3JzIG9ubGluZSBzdGF0ZSAoYXMgcmVwb3J0ZWQgYnkgd2luZG93Lm9ubGluZS9vZmZsaW5lIGV2ZW50cykuXG4gKlxuICogVGhlIGV4cGVjdGF0aW9uIGlzIHRoYXQgdGhpcyBjb3VsZCBoYXZlIG1hbnkgZmFsc2UgcG9zaXRpdmVzICh0aGlua3Mgd2UgYXJlIG9ubGluZVxuICogd2hlbiB3ZSdyZSBub3QpLCBidXQgbm8gZmFsc2UgbmVnYXRpdmVzLiAgU28gd2UgY2FuIHNhZmVseSB1c2UgaXQgdG8gZGV0ZXJtaW5lIHdoZW5cbiAqIHdlIGRlZmluaXRlbHkgY2Fubm90IHJlYWNoIHRoZSBpbnRlcm5ldC5cbiAqXG4gKiBAZXh0ZW5kcyB7RXZlbnRFbWl0dGVyfVxuICovXG52YXIgT25saW5lTW9uaXRvciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoT25saW5lTW9uaXRvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBPbmxpbmVNb25pdG9yKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBbJ29ubGluZSddKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5vbmxpbmVfID0gdHJ1ZTtcbiAgICAgICAgLy8gV2UndmUgaGFkIHJlcGVhdGVkIGNvbXBsYWludHMgdGhhdCBDb3Jkb3ZhIGFwcHMgY2FuIGdldCBzdHVjayBcIm9mZmxpbmVcIiwgZS5nLlxuICAgICAgICAvLyBodHRwczovL2ZvcnVtLmlvbmljZnJhbWV3b3JrLmNvbS90L2ZpcmViYXNlLWNvbm5lY3Rpb24taXMtbG9zdC1hbmQtbmV2ZXItY29tZS1iYWNrLzQzODEwXG4gICAgICAgIC8vIEl0IHdvdWxkIHNlZW0gdGhhdCB0aGUgJ29ubGluZScgZXZlbnQgZG9lcyBub3QgYWx3YXlzIGZpcmUgY29uc2lzdGVudGx5LiBTbyB3ZSBkaXNhYmxlIGl0XG4gICAgICAgIC8vIGZvciBDb3Jkb3ZhLlxuICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiZcbiAgICAgICAgICAgIHR5cGVvZiB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciAhPT0gJ3VuZGVmaW5lZCcgJiZcbiAgICAgICAgICAgICF1dGlsXzIuaXNNb2JpbGVDb3Jkb3ZhKCkpIHtcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdvbmxpbmUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFfdGhpcy5vbmxpbmVfKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLm9ubGluZV8gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy50cmlnZ2VyKCdvbmxpbmUnLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCBmYWxzZSk7XG4gICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignb2ZmbGluZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMub25saW5lXykge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5vbmxpbmVfID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnRyaWdnZXIoJ29ubGluZScsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCBmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPbmxpbmVNb25pdG9yLmdldEluc3RhbmNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbmV3IE9ubGluZU1vbml0b3IoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7IXN0cmluZ30gZXZlbnRUeXBlXG4gICAgICogQHJldHVybiB7QXJyYXkuPGJvb2xlYW4+fVxuICAgICAqL1xuICAgIE9ubGluZU1vbml0b3IucHJvdG90eXBlLmdldEluaXRpYWxFdmVudCA9IGZ1bmN0aW9uIChldmVudFR5cGUpIHtcbiAgICAgICAgdXRpbF8xLmFzc2VydChldmVudFR5cGUgPT09ICdvbmxpbmUnLCAnVW5rbm93biBldmVudCB0eXBlOiAnICsgZXZlbnRUeXBlKTtcbiAgICAgICAgcmV0dXJuIFt0aGlzLm9ubGluZV9dO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBPbmxpbmVNb25pdG9yLnByb3RvdHlwZS5jdXJyZW50bHlPbmxpbmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm9ubGluZV87XG4gICAgfTtcbiAgICByZXR1cm4gT25saW5lTW9uaXRvcjtcbn0oRXZlbnRFbWl0dGVyXzEuRXZlbnRFbWl0dGVyKSk7XG5leHBvcnRzLk9ubGluZU1vbml0b3IgPSBPbmxpbmVNb25pdG9yO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1PbmxpbmVNb25pdG9yLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHV0aWxfMSA9IHJlcXVpcmUoXCIuL3V0aWxcIik7XG52YXIgdXRpbF8yID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xuLyoqXG4gKiBBbiBpbW11dGFibGUgb2JqZWN0IHJlcHJlc2VudGluZyBhIHBhcnNlZCBwYXRoLiAgSXQncyBpbW11dGFibGUgc28gdGhhdCB5b3VcbiAqIGNhbiBwYXNzIHRoZW0gYXJvdW5kIHRvIG90aGVyIGZ1bmN0aW9ucyB3aXRob3V0IHdvcnJ5aW5nIGFib3V0IHRoZW0gY2hhbmdpbmdcbiAqIGl0LlxuICovXG52YXIgUGF0aCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge3N0cmluZ3xBcnJheS48c3RyaW5nPn0gcGF0aE9yU3RyaW5nIFBhdGggc3RyaW5nIHRvIHBhcnNlLFxuICAgICAqICAgICAgb3IgYW5vdGhlciBwYXRoLCBvciB0aGUgcmF3IHRva2VucyBhcnJheVxuICAgICAqIEBwYXJhbSB7bnVtYmVyPX0gcGllY2VOdW1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBQYXRoKHBhdGhPclN0cmluZywgcGllY2VOdW0pIHtcbiAgICAgICAgaWYgKHBpZWNlTnVtID09PSB2b2lkIDApIHtcbiAgICAgICAgICAgIHRoaXMucGllY2VzXyA9IHBhdGhPclN0cmluZy5zcGxpdCgnLycpO1xuICAgICAgICAgICAgLy8gUmVtb3ZlIGVtcHR5IHBpZWNlcy5cbiAgICAgICAgICAgIHZhciBjb3B5VG8gPSAwO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnBpZWNlc18ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5waWVjZXNfW2ldLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5waWVjZXNfW2NvcHlUb10gPSB0aGlzLnBpZWNlc19baV07XG4gICAgICAgICAgICAgICAgICAgIGNvcHlUbysrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucGllY2VzXy5sZW5ndGggPSBjb3B5VG87XG4gICAgICAgICAgICB0aGlzLnBpZWNlTnVtXyA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnBpZWNlc18gPSBwYXRoT3JTdHJpbmc7XG4gICAgICAgICAgICB0aGlzLnBpZWNlTnVtXyA9IHBpZWNlTnVtO1xuICAgICAgICB9XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQYXRoLCBcIkVtcHR5XCIsIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNpbmdsZXRvbiB0byByZXByZXNlbnQgYW4gZW1wdHkgcGF0aFxuICAgICAgICAgKlxuICAgICAgICAgKiBAY29uc3RcbiAgICAgICAgICovXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBQYXRoKCcnKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgUGF0aC5wcm90b3R5cGUuZ2V0RnJvbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnBpZWNlTnVtXyA+PSB0aGlzLnBpZWNlc18ubGVuZ3RoKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIHJldHVybiB0aGlzLnBpZWNlc19bdGhpcy5waWVjZU51bV9dO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7bnVtYmVyfSBUaGUgbnVtYmVyIG9mIHNlZ21lbnRzIGluIHRoaXMgcGF0aFxuICAgICAqL1xuICAgIFBhdGgucHJvdG90eXBlLmdldExlbmd0aCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGllY2VzXy5sZW5ndGggLSB0aGlzLnBpZWNlTnVtXztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4geyFQYXRofVxuICAgICAqL1xuICAgIFBhdGgucHJvdG90eXBlLnBvcEZyb250ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcGllY2VOdW0gPSB0aGlzLnBpZWNlTnVtXztcbiAgICAgICAgaWYgKHBpZWNlTnVtIDwgdGhpcy5waWVjZXNfLmxlbmd0aCkge1xuICAgICAgICAgICAgcGllY2VOdW0rKztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IFBhdGgodGhpcy5waWVjZXNfLCBwaWVjZU51bSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHs/c3RyaW5nfVxuICAgICAqL1xuICAgIFBhdGgucHJvdG90eXBlLmdldEJhY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnBpZWNlTnVtXyA8IHRoaXMucGllY2VzXy5sZW5ndGgpXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5waWVjZXNfW3RoaXMucGllY2VzXy5sZW5ndGggLSAxXTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBQYXRoLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHBhdGhTdHJpbmcgPSAnJztcbiAgICAgICAgZm9yICh2YXIgaSA9IHRoaXMucGllY2VOdW1fOyBpIDwgdGhpcy5waWVjZXNfLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5waWVjZXNfW2ldICE9PSAnJylcbiAgICAgICAgICAgICAgICBwYXRoU3RyaW5nICs9ICcvJyArIHRoaXMucGllY2VzX1tpXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGF0aFN0cmluZyB8fCAnLyc7XG4gICAgfTtcbiAgICBQYXRoLnByb3RvdHlwZS50b1VybEVuY29kZWRTdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBwYXRoU3RyaW5nID0gJyc7XG4gICAgICAgIGZvciAodmFyIGkgPSB0aGlzLnBpZWNlTnVtXzsgaSA8IHRoaXMucGllY2VzXy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHRoaXMucGllY2VzX1tpXSAhPT0gJycpXG4gICAgICAgICAgICAgICAgcGF0aFN0cmluZyArPSAnLycgKyBlbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKHRoaXMucGllY2VzX1tpXSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwYXRoU3RyaW5nIHx8ICcvJztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFNoYWxsb3cgY29weSBvZiB0aGUgcGFydHMgb2YgdGhlIHBhdGguXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcj19IGJlZ2luXG4gICAgICogQHJldHVybiB7IUFycmF5PHN0cmluZz59XG4gICAgICovXG4gICAgUGF0aC5wcm90b3R5cGUuc2xpY2UgPSBmdW5jdGlvbiAoYmVnaW4pIHtcbiAgICAgICAgaWYgKGJlZ2luID09PSB2b2lkIDApIHsgYmVnaW4gPSAwOyB9XG4gICAgICAgIHJldHVybiB0aGlzLnBpZWNlc18uc2xpY2UodGhpcy5waWVjZU51bV8gKyBiZWdpbik7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHs/UGF0aH1cbiAgICAgKi9cbiAgICBQYXRoLnByb3RvdHlwZS5wYXJlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnBpZWNlTnVtXyA+PSB0aGlzLnBpZWNlc18ubGVuZ3RoKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIHZhciBwaWVjZXMgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IHRoaXMucGllY2VOdW1fOyBpIDwgdGhpcy5waWVjZXNfLmxlbmd0aCAtIDE7IGkrKylcbiAgICAgICAgICAgIHBpZWNlcy5wdXNoKHRoaXMucGllY2VzX1tpXSk7XG4gICAgICAgIHJldHVybiBuZXcgUGF0aChwaWVjZXMsIDApO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtzdHJpbmd8IVBhdGh9IGNoaWxkUGF0aE9ialxuICAgICAqIEByZXR1cm4geyFQYXRofVxuICAgICAqL1xuICAgIFBhdGgucHJvdG90eXBlLmNoaWxkID0gZnVuY3Rpb24gKGNoaWxkUGF0aE9iaikge1xuICAgICAgICB2YXIgcGllY2VzID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSB0aGlzLnBpZWNlTnVtXzsgaSA8IHRoaXMucGllY2VzXy5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgIHBpZWNlcy5wdXNoKHRoaXMucGllY2VzX1tpXSk7XG4gICAgICAgIGlmIChjaGlsZFBhdGhPYmogaW5zdGFuY2VvZiBQYXRoKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gY2hpbGRQYXRoT2JqLnBpZWNlTnVtXzsgaSA8IGNoaWxkUGF0aE9iai5waWVjZXNfLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcGllY2VzLnB1c2goY2hpbGRQYXRoT2JqLnBpZWNlc19baV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIGNoaWxkUGllY2VzID0gY2hpbGRQYXRoT2JqLnNwbGl0KCcvJyk7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoaWxkUGllY2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkUGllY2VzW2ldLmxlbmd0aCA+IDApXG4gICAgICAgICAgICAgICAgICAgIHBpZWNlcy5wdXNoKGNoaWxkUGllY2VzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IFBhdGgocGllY2VzLCAwKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IFRydWUgaWYgdGhlcmUgYXJlIG5vIHNlZ21lbnRzIGluIHRoaXMgcGF0aFxuICAgICAqL1xuICAgIFBhdGgucHJvdG90eXBlLmlzRW1wdHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBpZWNlTnVtXyA+PSB0aGlzLnBpZWNlc18ubGVuZ3RoO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshUGF0aH0gb3V0ZXJQYXRoXG4gICAgICogQHBhcmFtIHshUGF0aH0gaW5uZXJQYXRoXG4gICAgICogQHJldHVybiB7IVBhdGh9IFRoZSBwYXRoIGZyb20gb3V0ZXJQYXRoIHRvIGlubmVyUGF0aFxuICAgICAqL1xuICAgIFBhdGgucmVsYXRpdmVQYXRoID0gZnVuY3Rpb24gKG91dGVyUGF0aCwgaW5uZXJQYXRoKSB7XG4gICAgICAgIHZhciBvdXRlciA9IG91dGVyUGF0aC5nZXRGcm9udCgpLCBpbm5lciA9IGlubmVyUGF0aC5nZXRGcm9udCgpO1xuICAgICAgICBpZiAob3V0ZXIgPT09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiBpbm5lclBhdGg7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAob3V0ZXIgPT09IGlubmVyKSB7XG4gICAgICAgICAgICByZXR1cm4gUGF0aC5yZWxhdGl2ZVBhdGgob3V0ZXJQYXRoLnBvcEZyb250KCksIGlubmVyUGF0aC5wb3BGcm9udCgpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSU5URVJOQUwgRVJST1I6IGlubmVyUGF0aCAoJyArXG4gICAgICAgICAgICAgICAgaW5uZXJQYXRoICtcbiAgICAgICAgICAgICAgICAnKSBpcyBub3Qgd2l0aGluICcgK1xuICAgICAgICAgICAgICAgICdvdXRlclBhdGggKCcgK1xuICAgICAgICAgICAgICAgIG91dGVyUGF0aCArXG4gICAgICAgICAgICAgICAgJyknKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshUGF0aH0gbGVmdFxuICAgICAqIEBwYXJhbSB7IVBhdGh9IHJpZ2h0XG4gICAgICogQHJldHVybiB7bnVtYmVyfSAtMSwgMCwgMSBpZiBsZWZ0IGlzIGxlc3MsIGVxdWFsLCBvciBncmVhdGVyIHRoYW4gdGhlIHJpZ2h0LlxuICAgICAqL1xuICAgIFBhdGguY29tcGFyZVBhdGhzID0gZnVuY3Rpb24gKGxlZnQsIHJpZ2h0KSB7XG4gICAgICAgIHZhciBsZWZ0S2V5cyA9IGxlZnQuc2xpY2UoKTtcbiAgICAgICAgdmFyIHJpZ2h0S2V5cyA9IHJpZ2h0LnNsaWNlKCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVmdEtleXMubGVuZ3RoICYmIGkgPCByaWdodEtleXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBjbXAgPSB1dGlsXzEubmFtZUNvbXBhcmUobGVmdEtleXNbaV0sIHJpZ2h0S2V5c1tpXSk7XG4gICAgICAgICAgICBpZiAoY21wICE9PSAwKVxuICAgICAgICAgICAgICAgIHJldHVybiBjbXA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxlZnRLZXlzLmxlbmd0aCA9PT0gcmlnaHRLZXlzLmxlbmd0aClcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICByZXR1cm4gbGVmdEtleXMubGVuZ3RoIDwgcmlnaHRLZXlzLmxlbmd0aCA/IC0xIDogMTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqXG4gICAgICogQHBhcmFtIHtQYXRofSBvdGhlclxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IHRydWUgaWYgcGF0aHMgYXJlIHRoZSBzYW1lLlxuICAgICAqL1xuICAgIFBhdGgucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgICAgICBpZiAodGhpcy5nZXRMZW5ndGgoKSAhPT0gb3RoZXIuZ2V0TGVuZ3RoKCkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gdGhpcy5waWVjZU51bV8sIGogPSBvdGhlci5waWVjZU51bV87IGkgPD0gdGhpcy5waWVjZXNfLmxlbmd0aDsgaSsrLCBqKyspIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnBpZWNlc19baV0gIT09IG90aGVyLnBpZWNlc19bal0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7IVBhdGh9IG90aGVyXG4gICAgICogQHJldHVybiB7Ym9vbGVhbn0gVHJ1ZSBpZiB0aGlzIHBhdGggaXMgYSBwYXJlbnQgKG9yIHRoZSBzYW1lIGFzKSBvdGhlclxuICAgICAqL1xuICAgIFBhdGgucHJvdG90eXBlLmNvbnRhaW5zID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgICAgIHZhciBpID0gdGhpcy5waWVjZU51bV87XG4gICAgICAgIHZhciBqID0gb3RoZXIucGllY2VOdW1fO1xuICAgICAgICBpZiAodGhpcy5nZXRMZW5ndGgoKSA+IG90aGVyLmdldExlbmd0aCgpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgd2hpbGUgKGkgPCB0aGlzLnBpZWNlc18ubGVuZ3RoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5waWVjZXNfW2ldICE9PSBvdGhlci5waWVjZXNfW2pdKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgKytpO1xuICAgICAgICAgICAgKytqO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgcmV0dXJuIFBhdGg7XG59KCkpOyAvLyBlbmQgUGF0aFxuZXhwb3J0cy5QYXRoID0gUGF0aDtcbi8qKlxuICogRHluYW1pYyAobXV0YWJsZSkgcGF0aCB1c2VkIHRvIGNvdW50IHBhdGggbGVuZ3Rocy5cbiAqXG4gKiBUaGlzIGNsYXNzIGlzIHVzZWQgdG8gZWZmaWNpZW50bHkgY2hlY2sgcGF0aHMgZm9yIHZhbGlkXG4gKiBsZW5ndGggKGluIFVURjggYnl0ZXMpIGFuZCBkZXB0aCAodXNlZCBpbiBwYXRoIHZhbGlkYXRpb24pLlxuICpcbiAqIFRocm93cyBFcnJvciBleGNlcHRpb24gaWYgcGF0aCBpcyBldmVyIGludmFsaWQuXG4gKlxuICogVGhlIGRlZmluaXRpb24gb2YgYSBwYXRoIGFsd2F5cyBiZWdpbnMgd2l0aCAnLycuXG4gKi9cbnZhciBWYWxpZGF0aW9uUGF0aCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFQYXRofSBwYXRoIEluaXRpYWwgUGF0aC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZXJyb3JQcmVmaXhfIFByZWZpeCBmb3IgYW55IGVycm9yIG1lc3NhZ2VzLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFZhbGlkYXRpb25QYXRoKHBhdGgsIGVycm9yUHJlZml4Xykge1xuICAgICAgICB0aGlzLmVycm9yUHJlZml4XyA9IGVycm9yUHJlZml4XztcbiAgICAgICAgLyoqIEB0eXBlIHshQXJyYXk8c3RyaW5nPn0gKi9cbiAgICAgICAgdGhpcy5wYXJ0c18gPSBwYXRoLnNsaWNlKCk7XG4gICAgICAgIC8qKiBAdHlwZSB7bnVtYmVyfSBJbml0aWFsaXplIHRvIG51bWJlciBvZiAnLycgY2hhcnMgbmVlZGVkIGluIHBhdGguICovXG4gICAgICAgIHRoaXMuYnl0ZUxlbmd0aF8gPSBNYXRoLm1heCgxLCB0aGlzLnBhcnRzXy5sZW5ndGgpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMucGFydHNfLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB0aGlzLmJ5dGVMZW5ndGhfICs9IHV0aWxfMi5zdHJpbmdMZW5ndGgodGhpcy5wYXJ0c19baV0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2hlY2tWYWxpZF8oKTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZhbGlkYXRpb25QYXRoLCBcIk1BWF9QQVRIX0RFUFRIXCIsIHtcbiAgICAgICAgLyoqIEBjb25zdCB7bnVtYmVyfSBNYXhpbXVtIGtleSBkZXB0aC4gKi9cbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gMzI7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWYWxpZGF0aW9uUGF0aCwgXCJNQVhfUEFUSF9MRU5HVEhfQllURVNcIiwge1xuICAgICAgICAvKiogQGNvbnN0IHtudW1iZXJ9IE1heGltdW0gbnVtYmVyIG9mIChVVEY4KSBieXRlcyBpbiBhIEZpcmViYXNlIHBhdGguICovXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIDc2ODtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgLyoqIEBwYXJhbSB7c3RyaW5nfSBjaGlsZCAqL1xuICAgIFZhbGlkYXRpb25QYXRoLnByb3RvdHlwZS5wdXNoID0gZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgIC8vIENvdW50IHRoZSBuZWVkZWQgJy8nXG4gICAgICAgIGlmICh0aGlzLnBhcnRzXy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0aGlzLmJ5dGVMZW5ndGhfICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wYXJ0c18ucHVzaChjaGlsZCk7XG4gICAgICAgIHRoaXMuYnl0ZUxlbmd0aF8gKz0gdXRpbF8yLnN0cmluZ0xlbmd0aChjaGlsZCk7XG4gICAgICAgIHRoaXMuY2hlY2tWYWxpZF8oKTtcbiAgICB9O1xuICAgIFZhbGlkYXRpb25QYXRoLnByb3RvdHlwZS5wb3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBsYXN0ID0gdGhpcy5wYXJ0c18ucG9wKCk7XG4gICAgICAgIHRoaXMuYnl0ZUxlbmd0aF8gLT0gdXRpbF8yLnN0cmluZ0xlbmd0aChsYXN0KTtcbiAgICAgICAgLy8gVW4tY291bnQgdGhlIHByZXZpb3VzICcvJ1xuICAgICAgICBpZiAodGhpcy5wYXJ0c18ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGhpcy5ieXRlTGVuZ3RoXyAtPSAxO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWYWxpZGF0aW9uUGF0aC5wcm90b3R5cGUuY2hlY2tWYWxpZF8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmJ5dGVMZW5ndGhfID4gVmFsaWRhdGlvblBhdGguTUFYX1BBVEhfTEVOR1RIX0JZVEVTKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IodGhpcy5lcnJvclByZWZpeF8gK1xuICAgICAgICAgICAgICAgICdoYXMgYSBrZXkgcGF0aCBsb25nZXIgdGhhbiAnICtcbiAgICAgICAgICAgICAgICBWYWxpZGF0aW9uUGF0aC5NQVhfUEFUSF9MRU5HVEhfQllURVMgK1xuICAgICAgICAgICAgICAgICcgYnl0ZXMgKCcgK1xuICAgICAgICAgICAgICAgIHRoaXMuYnl0ZUxlbmd0aF8gK1xuICAgICAgICAgICAgICAgICcpLicpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBhcnRzXy5sZW5ndGggPiBWYWxpZGF0aW9uUGF0aC5NQVhfUEFUSF9ERVBUSCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKHRoaXMuZXJyb3JQcmVmaXhfICtcbiAgICAgICAgICAgICAgICAncGF0aCBzcGVjaWZpZWQgZXhjZWVkcyB0aGUgbWF4aW11bSBkZXB0aCB0aGF0IGNhbiBiZSB3cml0dGVuICgnICtcbiAgICAgICAgICAgICAgICBWYWxpZGF0aW9uUGF0aC5NQVhfUEFUSF9ERVBUSCArXG4gICAgICAgICAgICAgICAgJykgb3Igb2JqZWN0IGNvbnRhaW5zIGEgY3ljbGUgJyArXG4gICAgICAgICAgICAgICAgdGhpcy50b0Vycm9yU3RyaW5nKCkpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBTdHJpbmcgZm9yIHVzZSBpbiBlcnJvciBtZXNzYWdlcyAtIHVzZXMgJy4nIG5vdGF0aW9uIGZvciBwYXRoLlxuICAgICAqXG4gICAgICogQHJldHVybiB7c3RyaW5nfVxuICAgICAqL1xuICAgIFZhbGlkYXRpb25QYXRoLnByb3RvdHlwZS50b0Vycm9yU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5wYXJ0c18ubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXCJpbiBwcm9wZXJ0eSAnXCIgKyB0aGlzLnBhcnRzXy5qb2luKCcuJykgKyBcIidcIjtcbiAgICB9O1xuICAgIHJldHVybiBWYWxpZGF0aW9uUGF0aDtcbn0oKSk7XG5leHBvcnRzLlZhbGlkYXRpb25QYXRoID0gVmFsaWRhdGlvblBhdGg7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVBhdGguanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdXRpbF8xID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xudmFyIFBhdGhfMSA9IHJlcXVpcmUoXCIuL1BhdGhcIik7XG52YXIgU3BhcnNlU25hcHNob3RUcmVlXzEgPSByZXF1aXJlKFwiLi4vU3BhcnNlU25hcHNob3RUcmVlXCIpO1xudmFyIExlYWZOb2RlXzEgPSByZXF1aXJlKFwiLi4vc25hcC9MZWFmTm9kZVwiKTtcbnZhciBub2RlRnJvbUpTT05fMSA9IHJlcXVpcmUoXCIuLi9zbmFwL25vZGVGcm9tSlNPTlwiKTtcbnZhciBQcmlvcml0eUluZGV4XzEgPSByZXF1aXJlKFwiLi4vc25hcC9pbmRleGVzL1ByaW9yaXR5SW5kZXhcIik7XG4vKipcbiAqIEdlbmVyYXRlIHBsYWNlaG9sZGVycyBmb3IgZGVmZXJyZWQgdmFsdWVzLlxuICogQHBhcmFtIHs/T2JqZWN0fSB2YWx1ZXNcbiAqIEByZXR1cm4geyFPYmplY3R9XG4gKi9cbmV4cG9ydHMuZ2VuZXJhdGVXaXRoVmFsdWVzID0gZnVuY3Rpb24gKHZhbHVlcykge1xuICAgIHZhbHVlcyA9IHZhbHVlcyB8fCB7fTtcbiAgICB2YWx1ZXNbJ3RpbWVzdGFtcCddID0gdmFsdWVzWyd0aW1lc3RhbXAnXSB8fCBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgICByZXR1cm4gdmFsdWVzO1xufTtcbi8qKlxuICogVmFsdWUgdG8gdXNlIHdoZW4gZmlyaW5nIGxvY2FsIGV2ZW50cy4gV2hlbiB3cml0aW5nIHNlcnZlciB2YWx1ZXMsIGZpcmVcbiAqIGxvY2FsIGV2ZW50cyB3aXRoIGFuIGFwcHJveGltYXRlIHZhbHVlLCBvdGhlcndpc2UgcmV0dXJuIHZhbHVlIGFzLWlzLlxuICogQHBhcmFtIHsoT2JqZWN0fHN0cmluZ3xudW1iZXJ8Ym9vbGVhbil9IHZhbHVlXG4gKiBAcGFyYW0geyFPYmplY3R9IHNlcnZlclZhbHVlc1xuICogQHJldHVybiB7IShzdHJpbmd8bnVtYmVyfGJvb2xlYW4pfVxuICovXG5leHBvcnRzLnJlc29sdmVEZWZlcnJlZFZhbHVlID0gZnVuY3Rpb24gKHZhbHVlLCBzZXJ2ZXJWYWx1ZXMpIHtcbiAgICBpZiAoIXZhbHVlIHx8IHR5cGVvZiB2YWx1ZSAhPT0gJ29iamVjdCcpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdXRpbF8xLmFzc2VydCgnLnN2JyBpbiB2YWx1ZSwgJ1VuZXhwZWN0ZWQgbGVhZiBub2RlIG9yIHByaW9yaXR5IGNvbnRlbnRzJyk7XG4gICAgICAgIHJldHVybiBzZXJ2ZXJWYWx1ZXNbdmFsdWVbJy5zdiddXTtcbiAgICB9XG59O1xuLyoqXG4gKiBSZWN1cnNpdmVseSByZXBsYWNlIGFsbCBkZWZlcnJlZCB2YWx1ZXMgYW5kIHByaW9yaXRpZXMgaW4gdGhlIHRyZWUgd2l0aCB0aGVcbiAqIHNwZWNpZmllZCBnZW5lcmF0ZWQgcmVwbGFjZW1lbnQgdmFsdWVzLlxuICogQHBhcmFtIHshU3BhcnNlU25hcHNob3RUcmVlfSB0cmVlXG4gKiBAcGFyYW0geyFPYmplY3R9IHNlcnZlclZhbHVlc1xuICogQHJldHVybiB7IVNwYXJzZVNuYXBzaG90VHJlZX1cbiAqL1xuZXhwb3J0cy5yZXNvbHZlRGVmZXJyZWRWYWx1ZVRyZWUgPSBmdW5jdGlvbiAodHJlZSwgc2VydmVyVmFsdWVzKSB7XG4gICAgdmFyIHJlc29sdmVkVHJlZSA9IG5ldyBTcGFyc2VTbmFwc2hvdFRyZWVfMS5TcGFyc2VTbmFwc2hvdFRyZWUoKTtcbiAgICB0cmVlLmZvckVhY2hUcmVlKG5ldyBQYXRoXzEuUGF0aCgnJyksIGZ1bmN0aW9uIChwYXRoLCBub2RlKSB7XG4gICAgICAgIHJlc29sdmVkVHJlZS5yZW1lbWJlcihwYXRoLCBleHBvcnRzLnJlc29sdmVEZWZlcnJlZFZhbHVlU25hcHNob3Qobm9kZSwgc2VydmVyVmFsdWVzKSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc29sdmVkVHJlZTtcbn07XG4vKipcbiAqIFJlY3Vyc2l2ZWx5IHJlcGxhY2UgYWxsIGRlZmVycmVkIHZhbHVlcyBhbmQgcHJpb3JpdGllcyBpbiB0aGUgbm9kZSB3aXRoIHRoZVxuICogc3BlY2lmaWVkIGdlbmVyYXRlZCByZXBsYWNlbWVudCB2YWx1ZXMuICBJZiB0aGVyZSBhcmUgbm8gc2VydmVyIHZhbHVlcyBpbiB0aGUgbm9kZSxcbiAqIGl0J2xsIGJlIHJldHVybmVkIGFzLWlzLlxuICogQHBhcmFtIHshTm9kZX0gbm9kZVxuICogQHBhcmFtIHshT2JqZWN0fSBzZXJ2ZXJWYWx1ZXNcbiAqIEByZXR1cm4geyFOb2RlfVxuICovXG5leHBvcnRzLnJlc29sdmVEZWZlcnJlZFZhbHVlU25hcHNob3QgPSBmdW5jdGlvbiAobm9kZSwgc2VydmVyVmFsdWVzKSB7XG4gICAgdmFyIHJhd1ByaSA9IG5vZGUuZ2V0UHJpb3JpdHkoKS52YWwoKTtcbiAgICB2YXIgcHJpb3JpdHkgPSBleHBvcnRzLnJlc29sdmVEZWZlcnJlZFZhbHVlKHJhd1ByaSwgc2VydmVyVmFsdWVzKTtcbiAgICB2YXIgbmV3Tm9kZTtcbiAgICBpZiAobm9kZS5pc0xlYWZOb2RlKCkpIHtcbiAgICAgICAgdmFyIGxlYWZOb2RlID0gbm9kZTtcbiAgICAgICAgdmFyIHZhbHVlID0gZXhwb3J0cy5yZXNvbHZlRGVmZXJyZWRWYWx1ZShsZWFmTm9kZS5nZXRWYWx1ZSgpLCBzZXJ2ZXJWYWx1ZXMpO1xuICAgICAgICBpZiAodmFsdWUgIT09IGxlYWZOb2RlLmdldFZhbHVlKCkgfHxcbiAgICAgICAgICAgIHByaW9yaXR5ICE9PSBsZWFmTm9kZS5nZXRQcmlvcml0eSgpLnZhbCgpKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IExlYWZOb2RlXzEuTGVhZk5vZGUodmFsdWUsIG5vZGVGcm9tSlNPTl8xLm5vZGVGcm9tSlNPTihwcmlvcml0eSkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHZhciBjaGlsZHJlbk5vZGUgPSBub2RlO1xuICAgICAgICBuZXdOb2RlID0gY2hpbGRyZW5Ob2RlO1xuICAgICAgICBpZiAocHJpb3JpdHkgIT09IGNoaWxkcmVuTm9kZS5nZXRQcmlvcml0eSgpLnZhbCgpKSB7XG4gICAgICAgICAgICBuZXdOb2RlID0gbmV3Tm9kZS51cGRhdGVQcmlvcml0eShuZXcgTGVhZk5vZGVfMS5MZWFmTm9kZShwcmlvcml0eSkpO1xuICAgICAgICB9XG4gICAgICAgIGNoaWxkcmVuTm9kZS5mb3JFYWNoQ2hpbGQoUHJpb3JpdHlJbmRleF8xLlBSSU9SSVRZX0lOREVYLCBmdW5jdGlvbiAoY2hpbGROYW1lLCBjaGlsZE5vZGUpIHtcbiAgICAgICAgICAgIHZhciBuZXdDaGlsZE5vZGUgPSBleHBvcnRzLnJlc29sdmVEZWZlcnJlZFZhbHVlU25hcHNob3QoY2hpbGROb2RlLCBzZXJ2ZXJWYWx1ZXMpO1xuICAgICAgICAgICAgaWYgKG5ld0NoaWxkTm9kZSAhPT0gY2hpbGROb2RlKSB7XG4gICAgICAgICAgICAgICAgbmV3Tm9kZSA9IG5ld05vZGUudXBkYXRlSW1tZWRpYXRlQ2hpbGQoY2hpbGROYW1lLCBuZXdDaGlsZE5vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIG5ld05vZGU7XG4gICAgfVxufTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U2VydmVyVmFsdWVzLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuLyoqXG4gKiBBbiBpdGVyYXRvciBvdmVyIGFuIExMUkJOb2RlLlxuICovXG52YXIgU29ydGVkTWFwSXRlcmF0b3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQHRlbXBsYXRlIEssIFYsIFRcbiAgICAgKiBAcGFyYW0ge0xMUkJOb2RlfExMUkJFbXB0eU5vZGV9IG5vZGUgTm9kZSB0byBpdGVyYXRlLlxuICAgICAqIEBwYXJhbSB7P0t9IHN0YXJ0S2V5XG4gICAgICogQHBhcmFtIHtmdW5jdGlvbihLLCBLKTogbnVtYmVyfSBjb21wYXJhdG9yXG4gICAgICogQHBhcmFtIHtib29sZWFufSBpc1JldmVyc2VfIFdoZXRoZXIgb3Igbm90IHRvIGl0ZXJhdGUgaW4gcmV2ZXJzZVxuICAgICAqIEBwYXJhbSB7KGZ1bmN0aW9uKEssIFYpOlQpPX0gcmVzdWx0R2VuZXJhdG9yX1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIFNvcnRlZE1hcEl0ZXJhdG9yKG5vZGUsIHN0YXJ0S2V5LCBjb21wYXJhdG9yLCBpc1JldmVyc2VfLCByZXN1bHRHZW5lcmF0b3JfKSB7XG4gICAgICAgIGlmIChyZXN1bHRHZW5lcmF0b3JfID09PSB2b2lkIDApIHsgcmVzdWx0R2VuZXJhdG9yXyA9IG51bGw7IH1cbiAgICAgICAgdGhpcy5pc1JldmVyc2VfID0gaXNSZXZlcnNlXztcbiAgICAgICAgdGhpcy5yZXN1bHRHZW5lcmF0b3JfID0gcmVzdWx0R2VuZXJhdG9yXztcbiAgICAgICAgLyoqIEBwcml2YXRlXG4gICAgICAgICAqIEB0eXBlIHtBcnJheS48IUxMUkJOb2RlPn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubm9kZVN0YWNrXyA9IFtdO1xuICAgICAgICB2YXIgY21wID0gMTtcbiAgICAgICAgd2hpbGUgKCFub2RlLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgbm9kZSA9IG5vZGU7XG4gICAgICAgICAgICBjbXAgPSBzdGFydEtleSA/IGNvbXBhcmF0b3Iobm9kZS5rZXksIHN0YXJ0S2V5KSA6IDE7XG4gICAgICAgICAgICAvLyBmbGlwIHRoZSBjb21wYXJpc29uIGlmIHdlJ3JlIGdvaW5nIGluIHJldmVyc2VcbiAgICAgICAgICAgIGlmIChpc1JldmVyc2VfKVxuICAgICAgICAgICAgICAgIGNtcCAqPSAtMTtcbiAgICAgICAgICAgIGlmIChjbXAgPCAwKSB7XG4gICAgICAgICAgICAgICAgLy8gVGhpcyBub2RlIGlzIGxlc3MgdGhhbiBvdXIgc3RhcnQga2V5LiBpZ25vcmUgaXRcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1JldmVyc2VfKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGUgPSBub2RlLmxlZnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBub2RlID0gbm9kZS5yaWdodDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjbXAgPT09IDApIHtcbiAgICAgICAgICAgICAgICAvLyBUaGlzIG5vZGUgaXMgZXhhY3RseSBlcXVhbCB0byBvdXIgc3RhcnQga2V5LiBQdXNoIGl0IG9uIHRoZSBzdGFjaywgYnV0IHN0b3AgaXRlcmF0aW5nO1xuICAgICAgICAgICAgICAgIHRoaXMubm9kZVN0YWNrXy5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gVGhpcyBub2RlIGlzIGdyZWF0ZXIgdGhhbiBvdXIgc3RhcnQga2V5LCBhZGQgaXQgdG8gdGhlIHN0YWNrIGFuZCBtb3ZlIHRvIHRoZSBuZXh0IG9uZVxuICAgICAgICAgICAgICAgIHRoaXMubm9kZVN0YWNrXy5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzUmV2ZXJzZV8pIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZSA9IG5vZGUucmlnaHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBub2RlID0gbm9kZS5sZWZ0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBTb3J0ZWRNYXBJdGVyYXRvci5wcm90b3R5cGUuZ2V0TmV4dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMubm9kZVN0YWNrXy5sZW5ndGggPT09IDApXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgdmFyIG5vZGUgPSB0aGlzLm5vZGVTdGFja18ucG9wKCk7XG4gICAgICAgIHZhciByZXN1bHQ7XG4gICAgICAgIGlmICh0aGlzLnJlc3VsdEdlbmVyYXRvcl8pXG4gICAgICAgICAgICByZXN1bHQgPSB0aGlzLnJlc3VsdEdlbmVyYXRvcl8obm9kZS5rZXksIG5vZGUudmFsdWUpO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICByZXN1bHQgPSB7IGtleTogbm9kZS5rZXksIHZhbHVlOiBub2RlLnZhbHVlIH07XG4gICAgICAgIGlmICh0aGlzLmlzUmV2ZXJzZV8pIHtcbiAgICAgICAgICAgIG5vZGUgPSBub2RlLmxlZnQ7XG4gICAgICAgICAgICB3aGlsZSAoIW5vZGUuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlU3RhY2tfLnB1c2gobm9kZSk7XG4gICAgICAgICAgICAgICAgbm9kZSA9IG5vZGUucmlnaHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBub2RlID0gbm9kZS5yaWdodDtcbiAgICAgICAgICAgIHdoaWxlICghbm9kZS5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGVTdGFja18ucHVzaChub2RlKTtcbiAgICAgICAgICAgICAgICBub2RlID0gbm9kZS5sZWZ0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBTb3J0ZWRNYXBJdGVyYXRvci5wcm90b3R5cGUuaGFzTmV4dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubm9kZVN0YWNrXy5sZW5ndGggPiAwO1xuICAgIH07XG4gICAgU29ydGVkTWFwSXRlcmF0b3IucHJvdG90eXBlLnBlZWsgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLm5vZGVTdGFja18ubGVuZ3RoID09PSAwKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIHZhciBub2RlID0gdGhpcy5ub2RlU3RhY2tfW3RoaXMubm9kZVN0YWNrXy5sZW5ndGggLSAxXTtcbiAgICAgICAgaWYgKHRoaXMucmVzdWx0R2VuZXJhdG9yXykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVzdWx0R2VuZXJhdG9yXyhub2RlLmtleSwgbm9kZS52YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4geyBrZXk6IG5vZGUua2V5LCB2YWx1ZTogbm9kZS52YWx1ZSB9O1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gU29ydGVkTWFwSXRlcmF0b3I7XG59KCkpO1xuZXhwb3J0cy5Tb3J0ZWRNYXBJdGVyYXRvciA9IFNvcnRlZE1hcEl0ZXJhdG9yO1xuLyoqXG4gKiBSZXByZXNlbnRzIGEgbm9kZSBpbiBhIExlZnQtbGVhbmluZyBSZWQtQmxhY2sgdHJlZS5cbiAqL1xudmFyIExMUkJOb2RlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIEB0ZW1wbGF0ZSBLLCBWXG4gICAgICogQHBhcmFtIHshS30ga2V5IEtleSBhc3NvY2lhdGVkIHdpdGggdGhpcyBub2RlLlxuICAgICAqIEBwYXJhbSB7IVZ9IHZhbHVlIFZhbHVlIGFzc29jaWF0ZWQgd2l0aCB0aGlzIG5vZGUuXG4gICAgICogQHBhcmFtIHs/Ym9vbGVhbn0gY29sb3IgV2hldGhlciB0aGlzIG5vZGUgaXMgcmVkLlxuICAgICAqIEBwYXJhbSB7PyhMTFJCTm9kZXxMTFJCRW1wdHlOb2RlKT19IGxlZnQgTGVmdCBjaGlsZC5cbiAgICAgKiBAcGFyYW0gez8oTExSQk5vZGV8TExSQkVtcHR5Tm9kZSk9fSByaWdodCBSaWdodCBjaGlsZC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBMTFJCTm9kZShrZXksIHZhbHVlLCBjb2xvciwgbGVmdCwgcmlnaHQpIHtcbiAgICAgICAgdGhpcy5rZXkgPSBrZXk7XG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5jb2xvciA9IGNvbG9yICE9IG51bGwgPyBjb2xvciA6IExMUkJOb2RlLlJFRDtcbiAgICAgICAgdGhpcy5sZWZ0ID1cbiAgICAgICAgICAgIGxlZnQgIT0gbnVsbCA/IGxlZnQgOiBTb3J0ZWRNYXAuRU1QVFlfTk9ERTtcbiAgICAgICAgdGhpcy5yaWdodCA9XG4gICAgICAgICAgICByaWdodCAhPSBudWxsID8gcmlnaHQgOiBTb3J0ZWRNYXAuRU1QVFlfTk9ERTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGNvcHkgb2YgdGhlIGN1cnJlbnQgbm9kZSwgb3B0aW9uYWxseSByZXBsYWNpbmcgcGllY2VzIG9mIGl0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHs/S30ga2V5IE5ldyBrZXkgZm9yIHRoZSBub2RlLCBvciBudWxsLlxuICAgICAqIEBwYXJhbSB7P1Z9IHZhbHVlIE5ldyB2YWx1ZSBmb3IgdGhlIG5vZGUsIG9yIG51bGwuXG4gICAgICogQHBhcmFtIHs/Ym9vbGVhbn0gY29sb3IgTmV3IGNvbG9yIGZvciB0aGUgbm9kZSwgb3IgbnVsbC5cbiAgICAgKiBAcGFyYW0gez9MTFJCTm9kZXxMTFJCRW1wdHlOb2RlfSBsZWZ0IE5ldyBsZWZ0IGNoaWxkIGZvciB0aGUgbm9kZSwgb3IgbnVsbC5cbiAgICAgKiBAcGFyYW0gez9MTFJCTm9kZXxMTFJCRW1wdHlOb2RlfSByaWdodCBOZXcgcmlnaHQgY2hpbGQgZm9yIHRoZSBub2RlLCBvciBudWxsLlxuICAgICAqIEByZXR1cm4geyFMTFJCTm9kZX0gVGhlIG5vZGUgY29weS5cbiAgICAgKi9cbiAgICBMTFJCTm9kZS5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChrZXksIHZhbHVlLCBjb2xvciwgbGVmdCwgcmlnaHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBMTFJCTm9kZShrZXkgIT0gbnVsbCA/IGtleSA6IHRoaXMua2V5LCB2YWx1ZSAhPSBudWxsID8gdmFsdWUgOiB0aGlzLnZhbHVlLCBjb2xvciAhPSBudWxsID8gY29sb3IgOiB0aGlzLmNvbG9yLCBsZWZ0ICE9IG51bGwgPyBsZWZ0IDogdGhpcy5sZWZ0LCByaWdodCAhPSBudWxsID8gcmlnaHQgOiB0aGlzLnJpZ2h0KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4ge251bWJlcn0gVGhlIHRvdGFsIG51bWJlciBvZiBub2RlcyBpbiB0aGUgdHJlZS5cbiAgICAgKi9cbiAgICBMTFJCTm9kZS5wcm90b3R5cGUuY291bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxlZnQuY291bnQoKSArIDEgKyB0aGlzLnJpZ2h0LmNvdW50KCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufSBUcnVlIGlmIHRoZSB0cmVlIGlzIGVtcHR5LlxuICAgICAqL1xuICAgIExMUkJOb2RlLnByb3RvdHlwZS5pc0VtcHR5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBUcmF2ZXJzZXMgdGhlIHRyZWUgaW4ga2V5IG9yZGVyIGFuZCBjYWxscyB0aGUgc3BlY2lmaWVkIGFjdGlvbiBmdW5jdGlvblxuICAgICAqIGZvciBlYWNoIG5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKCFLLCAhVik6Kn0gYWN0aW9uIENhbGxiYWNrIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZCBmb3IgZWFjaFxuICAgICAqICAgbm9kZS4gIElmIGl0IHJldHVybnMgdHJ1ZSwgdHJhdmVyc2FsIGlzIGFib3J0ZWQuXG4gICAgICogQHJldHVybiB7Kn0gVGhlIGZpcnN0IHRydXRoeSB2YWx1ZSByZXR1cm5lZCBieSBhY3Rpb24sIG9yIHRoZSBsYXN0IGZhbHNleVxuICAgICAqICAgdmFsdWUgcmV0dXJuZWQgYnkgYWN0aW9uXG4gICAgICovXG4gICAgTExSQk5vZGUucHJvdG90eXBlLmlub3JkZXJUcmF2ZXJzYWwgPSBmdW5jdGlvbiAoYWN0aW9uKSB7XG4gICAgICAgIHJldHVybiAodGhpcy5sZWZ0Lmlub3JkZXJUcmF2ZXJzYWwoYWN0aW9uKSB8fFxuICAgICAgICAgICAgYWN0aW9uKHRoaXMua2V5LCB0aGlzLnZhbHVlKSB8fFxuICAgICAgICAgICAgdGhpcy5yaWdodC5pbm9yZGVyVHJhdmVyc2FsKGFjdGlvbikpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogVHJhdmVyc2VzIHRoZSB0cmVlIGluIHJldmVyc2Uga2V5IG9yZGVyIGFuZCBjYWxscyB0aGUgc3BlY2lmaWVkIGFjdGlvbiBmdW5jdGlvblxuICAgICAqIGZvciBlYWNoIG5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKCFPYmplY3QsICFPYmplY3QpfSBhY3Rpb24gQ2FsbGJhY2sgZnVuY3Rpb24gdG8gYmUgY2FsbGVkIGZvciBlYWNoXG4gICAgICogbm9kZS4gIElmIGl0IHJldHVybnMgdHJ1ZSwgdHJhdmVyc2FsIGlzIGFib3J0ZWQuXG4gICAgICogQHJldHVybiB7Kn0gVHJ1ZSBpZiB0cmF2ZXJzYWwgd2FzIGFib3J0ZWQuXG4gICAgICovXG4gICAgTExSQk5vZGUucHJvdG90eXBlLnJldmVyc2VUcmF2ZXJzYWwgPSBmdW5jdGlvbiAoYWN0aW9uKSB7XG4gICAgICAgIHJldHVybiAodGhpcy5yaWdodC5yZXZlcnNlVHJhdmVyc2FsKGFjdGlvbikgfHxcbiAgICAgICAgICAgIGFjdGlvbih0aGlzLmtleSwgdGhpcy52YWx1ZSkgfHxcbiAgICAgICAgICAgIHRoaXMubGVmdC5yZXZlcnNlVHJhdmVyc2FsKGFjdGlvbikpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7IU9iamVjdH0gVGhlIG1pbmltdW0gbm9kZSBpbiB0aGUgdHJlZS5cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIExMUkJOb2RlLnByb3RvdHlwZS5taW5fID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5sZWZ0LmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sZWZ0Lm1pbl8oKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7IUt9IFRoZSBtYXhpbXVtIGtleSBpbiB0aGUgdHJlZS5cbiAgICAgKi9cbiAgICBMTFJCTm9kZS5wcm90b3R5cGUubWluS2V5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5taW5fKCkua2V5O1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7IUt9IFRoZSBtYXhpbXVtIGtleSBpbiB0aGUgdHJlZS5cbiAgICAgKi9cbiAgICBMTFJCTm9kZS5wcm90b3R5cGUubWF4S2V5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5yaWdodC5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmtleTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJpZ2h0Lm1heEtleSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7IU9iamVjdH0ga2V5IEtleSB0byBpbnNlcnQuXG4gICAgICogQHBhcmFtIHshT2JqZWN0fSB2YWx1ZSBWYWx1ZSB0byBpbnNlcnQuXG4gICAgICogQHBhcmFtIHtDb21wYXJhdG9yfSBjb21wYXJhdG9yIENvbXBhcmF0b3IuXG4gICAgICogQHJldHVybiB7IUxMUkJOb2RlfSBOZXcgdHJlZSwgd2l0aCB0aGUga2V5L3ZhbHVlIGFkZGVkLlxuICAgICAqL1xuICAgIExMUkJOb2RlLnByb3RvdHlwZS5pbnNlcnQgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSwgY29tcGFyYXRvcikge1xuICAgICAgICB2YXIgY21wLCBuO1xuICAgICAgICBuID0gdGhpcztcbiAgICAgICAgY21wID0gY29tcGFyYXRvcihrZXksIG4ua2V5KTtcbiAgICAgICAgaWYgKGNtcCA8IDApIHtcbiAgICAgICAgICAgIG4gPSBuLmNvcHkobnVsbCwgbnVsbCwgbnVsbCwgbi5sZWZ0Lmluc2VydChrZXksIHZhbHVlLCBjb21wYXJhdG9yKSwgbnVsbCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY21wID09PSAwKSB7XG4gICAgICAgICAgICBuID0gbi5jb3B5KG51bGwsIHZhbHVlLCBudWxsLCBudWxsLCBudWxsKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG4gPSBuLmNvcHkobnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgbi5yaWdodC5pbnNlcnQoa2V5LCB2YWx1ZSwgY29tcGFyYXRvcikpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuLmZpeFVwXygpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcmV0dXJuIHshTExSQk5vZGV8TExSQkVtcHR5Tm9kZX0gTmV3IHRyZWUsIHdpdGggdGhlIG1pbmltdW0ga2V5IHJlbW92ZWQuXG4gICAgICovXG4gICAgTExSQk5vZGUucHJvdG90eXBlLnJlbW92ZU1pbl8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmxlZnQuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICByZXR1cm4gU29ydGVkTWFwLkVNUFRZX05PREU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG4gPSB0aGlzO1xuICAgICAgICBpZiAoIW4ubGVmdC5pc1JlZF8oKSAmJiAhbi5sZWZ0LmxlZnQuaXNSZWRfKCkpXG4gICAgICAgICAgICBuID0gbi5tb3ZlUmVkTGVmdF8oKTtcbiAgICAgICAgbiA9IG4uY29weShudWxsLCBudWxsLCBudWxsLCBuLmxlZnQucmVtb3ZlTWluXygpLCBudWxsKTtcbiAgICAgICAgcmV0dXJuIG4uZml4VXBfKCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFPYmplY3R9IGtleSBUaGUga2V5IG9mIHRoZSBpdGVtIHRvIHJlbW92ZS5cbiAgICAgKiBAcGFyYW0ge0NvbXBhcmF0b3J9IGNvbXBhcmF0b3IgQ29tcGFyYXRvci5cbiAgICAgKiBAcmV0dXJuIHshTExSQk5vZGV8TExSQkVtcHR5Tm9kZX0gTmV3IHRyZWUsIHdpdGggdGhlIHNwZWNpZmllZCBpdGVtIHJlbW92ZWQuXG4gICAgICovXG4gICAgTExSQk5vZGUucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uIChrZXksIGNvbXBhcmF0b3IpIHtcbiAgICAgICAgdmFyIG4sIHNtYWxsZXN0O1xuICAgICAgICBuID0gdGhpcztcbiAgICAgICAgaWYgKGNvbXBhcmF0b3Ioa2V5LCBuLmtleSkgPCAwKSB7XG4gICAgICAgICAgICBpZiAoIW4ubGVmdC5pc0VtcHR5KCkgJiYgIW4ubGVmdC5pc1JlZF8oKSAmJiAhbi5sZWZ0LmxlZnQuaXNSZWRfKCkpIHtcbiAgICAgICAgICAgICAgICBuID0gbi5tb3ZlUmVkTGVmdF8oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG4gPSBuLmNvcHkobnVsbCwgbnVsbCwgbnVsbCwgbi5sZWZ0LnJlbW92ZShrZXksIGNvbXBhcmF0b3IpLCBudWxsKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChuLmxlZnQuaXNSZWRfKCkpXG4gICAgICAgICAgICAgICAgbiA9IG4ucm90YXRlUmlnaHRfKCk7XG4gICAgICAgICAgICBpZiAoIW4ucmlnaHQuaXNFbXB0eSgpICYmICFuLnJpZ2h0LmlzUmVkXygpICYmICFuLnJpZ2h0LmxlZnQuaXNSZWRfKCkpIHtcbiAgICAgICAgICAgICAgICBuID0gbi5tb3ZlUmVkUmlnaHRfKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY29tcGFyYXRvcihrZXksIG4ua2V5KSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGlmIChuLnJpZ2h0LmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gU29ydGVkTWFwLkVNUFRZX05PREU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzbWFsbGVzdCA9IG4ucmlnaHQubWluXygpO1xuICAgICAgICAgICAgICAgICAgICBuID0gbi5jb3B5KHNtYWxsZXN0LmtleSwgc21hbGxlc3QudmFsdWUsIG51bGwsIG51bGwsIG4ucmlnaHQucmVtb3ZlTWluXygpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBuID0gbi5jb3B5KG51bGwsIG51bGwsIG51bGwsIG51bGwsIG4ucmlnaHQucmVtb3ZlKGtleSwgY29tcGFyYXRvcikpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuLmZpeFVwXygpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufSBXaGV0aGVyIHRoaXMgaXMgYSBSRUQgbm9kZS5cbiAgICAgKi9cbiAgICBMTFJCTm9kZS5wcm90b3R5cGUuaXNSZWRfID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb2xvcjtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHJldHVybiB7IUxMUkJOb2RlfSBOZXcgdHJlZSBhZnRlciBwZXJmb3JtaW5nIGFueSBuZWVkZWQgcm90YXRpb25zLlxuICAgICAqL1xuICAgIExMUkJOb2RlLnByb3RvdHlwZS5maXhVcF8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBuID0gdGhpcztcbiAgICAgICAgaWYgKG4ucmlnaHQuaXNSZWRfKCkgJiYgIW4ubGVmdC5pc1JlZF8oKSlcbiAgICAgICAgICAgIG4gPSBuLnJvdGF0ZUxlZnRfKCk7XG4gICAgICAgIGlmIChuLmxlZnQuaXNSZWRfKCkgJiYgbi5sZWZ0LmxlZnQuaXNSZWRfKCkpXG4gICAgICAgICAgICBuID0gbi5yb3RhdGVSaWdodF8oKTtcbiAgICAgICAgaWYgKG4ubGVmdC5pc1JlZF8oKSAmJiBuLnJpZ2h0LmlzUmVkXygpKVxuICAgICAgICAgICAgbiA9IG4uY29sb3JGbGlwXygpO1xuICAgICAgICByZXR1cm4gbjtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHJldHVybiB7IUxMUkJOb2RlfSBOZXcgdHJlZSwgYWZ0ZXIgbW92ZVJlZExlZnQuXG4gICAgICovXG4gICAgTExSQk5vZGUucHJvdG90eXBlLm1vdmVSZWRMZWZ0XyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG4gPSB0aGlzLmNvbG9yRmxpcF8oKTtcbiAgICAgICAgaWYgKG4ucmlnaHQubGVmdC5pc1JlZF8oKSkge1xuICAgICAgICAgICAgbiA9IG4uY29weShudWxsLCBudWxsLCBudWxsLCBudWxsLCBuLnJpZ2h0LnJvdGF0ZVJpZ2h0XygpKTtcbiAgICAgICAgICAgIG4gPSBuLnJvdGF0ZUxlZnRfKCk7XG4gICAgICAgICAgICBuID0gbi5jb2xvckZsaXBfKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG47XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEByZXR1cm4geyFMTFJCTm9kZX0gTmV3IHRyZWUsIGFmdGVyIG1vdmVSZWRSaWdodC5cbiAgICAgKi9cbiAgICBMTFJCTm9kZS5wcm90b3R5cGUubW92ZVJlZFJpZ2h0XyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG4gPSB0aGlzLmNvbG9yRmxpcF8oKTtcbiAgICAgICAgaWYgKG4ubGVmdC5sZWZ0LmlzUmVkXygpKSB7XG4gICAgICAgICAgICBuID0gbi5yb3RhdGVSaWdodF8oKTtcbiAgICAgICAgICAgIG4gPSBuLmNvbG9yRmxpcF8oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbjtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHJldHVybiB7IUxMUkJOb2RlfSBOZXcgdHJlZSwgYWZ0ZXIgcm90YXRlTGVmdC5cbiAgICAgKi9cbiAgICBMTFJCTm9kZS5wcm90b3R5cGUucm90YXRlTGVmdF8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBubCA9IHRoaXMuY29weShudWxsLCBudWxsLCBMTFJCTm9kZS5SRUQsIG51bGwsIHRoaXMucmlnaHQubGVmdCk7XG4gICAgICAgIHJldHVybiB0aGlzLnJpZ2h0LmNvcHkobnVsbCwgbnVsbCwgdGhpcy5jb2xvciwgbmwsIG51bGwpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcmV0dXJuIHshTExSQk5vZGV9IE5ldyB0cmVlLCBhZnRlciByb3RhdGVSaWdodC5cbiAgICAgKi9cbiAgICBMTFJCTm9kZS5wcm90b3R5cGUucm90YXRlUmlnaHRfID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbnIgPSB0aGlzLmNvcHkobnVsbCwgbnVsbCwgTExSQk5vZGUuUkVELCB0aGlzLmxlZnQucmlnaHQsIG51bGwpO1xuICAgICAgICByZXR1cm4gdGhpcy5sZWZ0LmNvcHkobnVsbCwgbnVsbCwgdGhpcy5jb2xvciwgbnVsbCwgbnIpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcmV0dXJuIHshTExSQk5vZGV9IE5ldyB0cmVlLCBhZnRlciBjb2xvckZsaXAuXG4gICAgICovXG4gICAgTExSQk5vZGUucHJvdG90eXBlLmNvbG9yRmxpcF8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBsZWZ0ID0gdGhpcy5sZWZ0LmNvcHkobnVsbCwgbnVsbCwgIXRoaXMubGVmdC5jb2xvciwgbnVsbCwgbnVsbCk7XG4gICAgICAgIHZhciByaWdodCA9IHRoaXMucmlnaHQuY29weShudWxsLCBudWxsLCAhdGhpcy5yaWdodC5jb2xvciwgbnVsbCwgbnVsbCk7XG4gICAgICAgIHJldHVybiB0aGlzLmNvcHkobnVsbCwgbnVsbCwgIXRoaXMuY29sb3IsIGxlZnQsIHJpZ2h0KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEZvciB0ZXN0aW5nLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufSBUcnVlIGlmIGFsbCBpcyB3ZWxsLlxuICAgICAqL1xuICAgIExMUkJOb2RlLnByb3RvdHlwZS5jaGVja01heERlcHRoXyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGJsYWNrRGVwdGggPSB0aGlzLmNoZWNrXygpO1xuICAgICAgICByZXR1cm4gTWF0aC5wb3coMi4wLCBibGFja0RlcHRoKSA8PSB0aGlzLmNvdW50KCkgKyAxO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcmV0dXJuIHtudW1iZXJ9IE5vdCBzdXJlIHdoYXQgdGhpcyByZXR1cm5zIGV4YWN0bHkuIDotKS5cbiAgICAgKi9cbiAgICBMTFJCTm9kZS5wcm90b3R5cGUuY2hlY2tfID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYmxhY2tEZXB0aDtcbiAgICAgICAgaWYgKHRoaXMuaXNSZWRfKCkgJiYgdGhpcy5sZWZ0LmlzUmVkXygpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlZCBub2RlIGhhcyByZWQgY2hpbGQoJyArIHRoaXMua2V5ICsgJywnICsgdGhpcy52YWx1ZSArICcpJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucmlnaHQuaXNSZWRfKCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUmlnaHQgY2hpbGQgb2YgKCcgKyB0aGlzLmtleSArICcsJyArIHRoaXMudmFsdWUgKyAnKSBpcyByZWQnKTtcbiAgICAgICAgfVxuICAgICAgICBibGFja0RlcHRoID0gdGhpcy5sZWZ0LmNoZWNrXygpO1xuICAgICAgICBpZiAoYmxhY2tEZXB0aCAhPT0gdGhpcy5yaWdodC5jaGVja18oKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdCbGFjayBkZXB0aHMgZGlmZmVyJyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gYmxhY2tEZXB0aCArICh0aGlzLmlzUmVkXygpID8gMCA6IDEpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBMTFJCTm9kZS5SRUQgPSB0cnVlO1xuICAgIExMUkJOb2RlLkJMQUNLID0gZmFsc2U7XG4gICAgcmV0dXJuIExMUkJOb2RlO1xufSgpKTtcbmV4cG9ydHMuTExSQk5vZGUgPSBMTFJCTm9kZTtcbi8qKlxuICogUmVwcmVzZW50cyBhbiBlbXB0eSBub2RlIChhIGxlYWYgbm9kZSBpbiB0aGUgUmVkLUJsYWNrIFRyZWUpLlxuICovXG52YXIgTExSQkVtcHR5Tm9kZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBMTFJCRW1wdHlOb2RlKCkge1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgY29weSBvZiB0aGUgY3VycmVudCBub2RlLlxuICAgICAqXG4gICAgICogQHJldHVybiB7IUxMUkJFbXB0eU5vZGV9IFRoZSBub2RlIGNvcHkuXG4gICAgICovXG4gICAgTExSQkVtcHR5Tm9kZS5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChrZXksIHZhbHVlLCBjb2xvciwgbGVmdCwgcmlnaHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgY29weSBvZiB0aGUgdHJlZSwgd2l0aCB0aGUgc3BlY2lmaWVkIGtleS92YWx1ZSBhZGRlZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7IUt9IGtleSBLZXkgdG8gYmUgYWRkZWQuXG4gICAgICogQHBhcmFtIHshVn0gdmFsdWUgVmFsdWUgdG8gYmUgYWRkZWQuXG4gICAgICogQHBhcmFtIHtDb21wYXJhdG9yfSBjb21wYXJhdG9yIENvbXBhcmF0b3IuXG4gICAgICogQHJldHVybiB7IUxMUkJOb2RlfSBOZXcgdHJlZSwgd2l0aCBpdGVtIGFkZGVkLlxuICAgICAqL1xuICAgIExMUkJFbXB0eU5vZGUucHJvdG90eXBlLmluc2VydCA9IGZ1bmN0aW9uIChrZXksIHZhbHVlLCBjb21wYXJhdG9yKSB7XG4gICAgICAgIHJldHVybiBuZXcgTExSQk5vZGUoa2V5LCB2YWx1ZSwgbnVsbCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgY29weSBvZiB0aGUgdHJlZSwgd2l0aCB0aGUgc3BlY2lmaWVkIGtleSByZW1vdmVkLlxuICAgICAqXG4gICAgICogQHBhcmFtIHshS30ga2V5IFRoZSBrZXkgdG8gcmVtb3ZlLlxuICAgICAqIEBwYXJhbSB7Q29tcGFyYXRvcn0gY29tcGFyYXRvciBDb21wYXJhdG9yLlxuICAgICAqIEByZXR1cm4geyFMTFJCRW1wdHlOb2RlfSBOZXcgdHJlZSwgd2l0aCBpdGVtIHJlbW92ZWQuXG4gICAgICovXG4gICAgTExSQkVtcHR5Tm9kZS5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKGtleSwgY29tcGFyYXRvcikge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4ge251bWJlcn0gVGhlIHRvdGFsIG51bWJlciBvZiBub2RlcyBpbiB0aGUgdHJlZS5cbiAgICAgKi9cbiAgICBMTFJCRW1wdHlOb2RlLnByb3RvdHlwZS5jb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufSBUcnVlIGlmIHRoZSB0cmVlIGlzIGVtcHR5LlxuICAgICAqL1xuICAgIExMUkJFbXB0eU5vZGUucHJvdG90eXBlLmlzRW1wdHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogVHJhdmVyc2VzIHRoZSB0cmVlIGluIGtleSBvcmRlciBhbmQgY2FsbHMgdGhlIHNwZWNpZmllZCBhY3Rpb24gZnVuY3Rpb25cbiAgICAgKiBmb3IgZWFjaCBub2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbighSywgIVYpOip9IGFjdGlvbiBDYWxsYmFjayBmdW5jdGlvbiB0byBiZSBjYWxsZWQgZm9yIGVhY2hcbiAgICAgKiBub2RlLiAgSWYgaXQgcmV0dXJucyB0cnVlLCB0cmF2ZXJzYWwgaXMgYWJvcnRlZC5cbiAgICAgKiBAcmV0dXJuIHtib29sZWFufSBUcnVlIGlmIHRyYXZlcnNhbCB3YXMgYWJvcnRlZC5cbiAgICAgKi9cbiAgICBMTFJCRW1wdHlOb2RlLnByb3RvdHlwZS5pbm9yZGVyVHJhdmVyc2FsID0gZnVuY3Rpb24gKGFjdGlvbikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBUcmF2ZXJzZXMgdGhlIHRyZWUgaW4gcmV2ZXJzZSBrZXkgb3JkZXIgYW5kIGNhbGxzIHRoZSBzcGVjaWZpZWQgYWN0aW9uIGZ1bmN0aW9uXG4gICAgICogZm9yIGVhY2ggbm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oIUssICFWKX0gYWN0aW9uIENhbGxiYWNrIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZCBmb3IgZWFjaFxuICAgICAqIG5vZGUuICBJZiBpdCByZXR1cm5zIHRydWUsIHRyYXZlcnNhbCBpcyBhYm9ydGVkLlxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IFRydWUgaWYgdHJhdmVyc2FsIHdhcyBhYm9ydGVkLlxuICAgICAqL1xuICAgIExMUkJFbXB0eU5vZGUucHJvdG90eXBlLnJldmVyc2VUcmF2ZXJzYWwgPSBmdW5jdGlvbiAoYWN0aW9uKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4ge251bGx9XG4gICAgICovXG4gICAgTExSQkVtcHR5Tm9kZS5wcm90b3R5cGUubWluS2V5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4ge251bGx9XG4gICAgICovXG4gICAgTExSQkVtcHR5Tm9kZS5wcm90b3R5cGUubWF4S2V5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHJldHVybiB7bnVtYmVyfSBOb3Qgc3VyZSB3aGF0IHRoaXMgcmV0dXJucyBleGFjdGx5LiA6LSkuXG4gICAgICovXG4gICAgTExSQkVtcHR5Tm9kZS5wcm90b3R5cGUuY2hlY2tfID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHJldHVybiB7Ym9vbGVhbn0gV2hldGhlciB0aGlzIG5vZGUgaXMgcmVkLlxuICAgICAqL1xuICAgIExMUkJFbXB0eU5vZGUucHJvdG90eXBlLmlzUmVkXyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgcmV0dXJuIExMUkJFbXB0eU5vZGU7XG59KCkpO1xuZXhwb3J0cy5MTFJCRW1wdHlOb2RlID0gTExSQkVtcHR5Tm9kZTtcbi8qKlxuICogQW4gaW1tdXRhYmxlIHNvcnRlZCBtYXAgaW1wbGVtZW50YXRpb24sIGJhc2VkIG9uIGEgTGVmdC1sZWFuaW5nIFJlZC1CbGFja1xuICogdHJlZS5cbiAqL1xudmFyIFNvcnRlZE1hcCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKiBAdGVtcGxhdGUgSywgVlxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oSywgSyk6bnVtYmVyfSBjb21wYXJhdG9yXyBLZXkgY29tcGFyYXRvci5cbiAgICAgKiBAcGFyYW0ge0xMUkJOb2RlPX0gcm9vdF8gKE9wdGlvbmFsKSBSb290IG5vZGUgZm9yIHRoZSBtYXAuXG4gICAgICovXG4gICAgZnVuY3Rpb24gU29ydGVkTWFwKGNvbXBhcmF0b3JfLCByb290Xykge1xuICAgICAgICBpZiAocm9vdF8gPT09IHZvaWQgMCkgeyByb290XyA9IFNvcnRlZE1hcC5FTVBUWV9OT0RFOyB9XG4gICAgICAgIHRoaXMuY29tcGFyYXRvcl8gPSBjb21wYXJhdG9yXztcbiAgICAgICAgdGhpcy5yb290XyA9IHJvb3RfO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgY29weSBvZiB0aGUgbWFwLCB3aXRoIHRoZSBzcGVjaWZpZWQga2V5L3ZhbHVlIGFkZGVkIG9yIHJlcGxhY2VkLlxuICAgICAqIChUT0RPOiBXZSBzaG91bGQgcGVyaGFwcyByZW5hbWUgdGhpcyBtZXRob2QgdG8gJ3B1dCcpXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyFLfSBrZXkgS2V5IHRvIGJlIGFkZGVkLlxuICAgICAqIEBwYXJhbSB7IVZ9IHZhbHVlIFZhbHVlIHRvIGJlIGFkZGVkLlxuICAgICAqIEByZXR1cm4geyFTb3J0ZWRNYXAuPEssIFY+fSBOZXcgbWFwLCB3aXRoIGl0ZW0gYWRkZWQuXG4gICAgICovXG4gICAgU29ydGVkTWFwLnByb3RvdHlwZS5pbnNlcnQgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xuICAgICAgICByZXR1cm4gbmV3IFNvcnRlZE1hcCh0aGlzLmNvbXBhcmF0b3JfLCB0aGlzLnJvb3RfXG4gICAgICAgICAgICAuaW5zZXJ0KGtleSwgdmFsdWUsIHRoaXMuY29tcGFyYXRvcl8pXG4gICAgICAgICAgICAuY29weShudWxsLCBudWxsLCBMTFJCTm9kZS5CTEFDSywgbnVsbCwgbnVsbCkpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGNvcHkgb2YgdGhlIG1hcCwgd2l0aCB0aGUgc3BlY2lmaWVkIGtleSByZW1vdmVkLlxuICAgICAqXG4gICAgICogQHBhcmFtIHshS30ga2V5IFRoZSBrZXkgdG8gcmVtb3ZlLlxuICAgICAqIEByZXR1cm4geyFTb3J0ZWRNYXAuPEssIFY+fSBOZXcgbWFwLCB3aXRoIGl0ZW0gcmVtb3ZlZC5cbiAgICAgKi9cbiAgICBTb3J0ZWRNYXAucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTb3J0ZWRNYXAodGhpcy5jb21wYXJhdG9yXywgdGhpcy5yb290X1xuICAgICAgICAgICAgLnJlbW92ZShrZXksIHRoaXMuY29tcGFyYXRvcl8pXG4gICAgICAgICAgICAuY29weShudWxsLCBudWxsLCBMTFJCTm9kZS5CTEFDSywgbnVsbCwgbnVsbCkpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgdmFsdWUgb2YgdGhlIG5vZGUgd2l0aCB0aGUgZ2l2ZW4ga2V5LCBvciBudWxsLlxuICAgICAqXG4gICAgICogQHBhcmFtIHshS30ga2V5IFRoZSBrZXkgdG8gbG9vayB1cC5cbiAgICAgKiBAcmV0dXJuIHs/Vn0gVGhlIHZhbHVlIG9mIHRoZSBub2RlIHdpdGggdGhlIGdpdmVuIGtleSwgb3IgbnVsbCBpZiB0aGVcbiAgICAgKiBrZXkgZG9lc24ndCBleGlzdC5cbiAgICAgKi9cbiAgICBTb3J0ZWRNYXAucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgdmFyIGNtcDtcbiAgICAgICAgdmFyIG5vZGUgPSB0aGlzLnJvb3RfO1xuICAgICAgICB3aGlsZSAoIW5vZGUuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICBjbXAgPSB0aGlzLmNvbXBhcmF0b3JfKGtleSwgbm9kZS5rZXkpO1xuICAgICAgICAgICAgaWYgKGNtcCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBub2RlLnZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY21wIDwgMCkge1xuICAgICAgICAgICAgICAgIG5vZGUgPSBub2RlLmxlZnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjbXAgPiAwKSB7XG4gICAgICAgICAgICAgICAgbm9kZSA9IG5vZGUucmlnaHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBrZXkgb2YgdGhlIGl0ZW0gKmJlZm9yZSogdGhlIHNwZWNpZmllZCBrZXksIG9yIG51bGwgaWYga2V5IGlzIHRoZSBmaXJzdCBpdGVtLlxuICAgICAqIEBwYXJhbSB7S30ga2V5IFRoZSBrZXkgdG8gZmluZCB0aGUgcHJlZGVjZXNzb3Igb2ZcbiAgICAgKiBAcmV0dXJuIHs/S30gVGhlIHByZWRlY2Vzc29yIGtleS5cbiAgICAgKi9cbiAgICBTb3J0ZWRNYXAucHJvdG90eXBlLmdldFByZWRlY2Vzc29yS2V5ID0gZnVuY3Rpb24gKGtleSkge1xuICAgICAgICB2YXIgY21wLCBub2RlID0gdGhpcy5yb290XywgcmlnaHRQYXJlbnQgPSBudWxsO1xuICAgICAgICB3aGlsZSAoIW5vZGUuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICBjbXAgPSB0aGlzLmNvbXBhcmF0b3JfKGtleSwgbm9kZS5rZXkpO1xuICAgICAgICAgICAgaWYgKGNtcCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGlmICghbm9kZS5sZWZ0LmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgICAgICAgICBub2RlID0gbm9kZS5sZWZ0O1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoIW5vZGUucmlnaHQuaXNFbXB0eSgpKVxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSA9IG5vZGUucmlnaHQ7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBub2RlLmtleTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAocmlnaHRQYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJpZ2h0UGFyZW50LmtleTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOyAvLyBmaXJzdCBpdGVtLlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGNtcCA8IDApIHtcbiAgICAgICAgICAgICAgICBub2RlID0gbm9kZS5sZWZ0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY21wID4gMCkge1xuICAgICAgICAgICAgICAgIHJpZ2h0UGFyZW50ID0gbm9kZTtcbiAgICAgICAgICAgICAgICBub2RlID0gbm9kZS5yaWdodDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0F0dGVtcHRlZCB0byBmaW5kIHByZWRlY2Vzc29yIGtleSBmb3IgYSBub25leGlzdGVudCBrZXkuICBXaGF0IGdpdmVzPycpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7Ym9vbGVhbn0gVHJ1ZSBpZiB0aGUgbWFwIGlzIGVtcHR5LlxuICAgICAqL1xuICAgIFNvcnRlZE1hcC5wcm90b3R5cGUuaXNFbXB0eSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucm9vdF8uaXNFbXB0eSgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7bnVtYmVyfSBUaGUgdG90YWwgbnVtYmVyIG9mIG5vZGVzIGluIHRoZSBtYXAuXG4gICAgICovXG4gICAgU29ydGVkTWFwLnByb3RvdHlwZS5jb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucm9vdF8uY291bnQoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4gez9LfSBUaGUgbWluaW11bSBrZXkgaW4gdGhlIG1hcC5cbiAgICAgKi9cbiAgICBTb3J0ZWRNYXAucHJvdG90eXBlLm1pbktleSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucm9vdF8ubWluS2V5KCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHs/S30gVGhlIG1heGltdW0ga2V5IGluIHRoZSBtYXAuXG4gICAgICovXG4gICAgU29ydGVkTWFwLnByb3RvdHlwZS5tYXhLZXkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJvb3RfLm1heEtleSgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogVHJhdmVyc2VzIHRoZSBtYXAgaW4ga2V5IG9yZGVyIGFuZCBjYWxscyB0aGUgc3BlY2lmaWVkIGFjdGlvbiBmdW5jdGlvblxuICAgICAqIGZvciBlYWNoIGtleS92YWx1ZSBwYWlyLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbighSywgIVYpOip9IGFjdGlvbiBDYWxsYmFjayBmdW5jdGlvbiB0byBiZSBjYWxsZWRcbiAgICAgKiBmb3IgZWFjaCBrZXkvdmFsdWUgcGFpci4gIElmIGFjdGlvbiByZXR1cm5zIHRydWUsIHRyYXZlcnNhbCBpcyBhYm9ydGVkLlxuICAgICAqIEByZXR1cm4geyp9IFRoZSBmaXJzdCB0cnV0aHkgdmFsdWUgcmV0dXJuZWQgYnkgYWN0aW9uLCBvciB0aGUgbGFzdCBmYWxzZXlcbiAgICAgKiAgIHZhbHVlIHJldHVybmVkIGJ5IGFjdGlvblxuICAgICAqL1xuICAgIFNvcnRlZE1hcC5wcm90b3R5cGUuaW5vcmRlclRyYXZlcnNhbCA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucm9vdF8uaW5vcmRlclRyYXZlcnNhbChhY3Rpb24pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogVHJhdmVyc2VzIHRoZSBtYXAgaW4gcmV2ZXJzZSBrZXkgb3JkZXIgYW5kIGNhbGxzIHRoZSBzcGVjaWZpZWQgYWN0aW9uIGZ1bmN0aW9uXG4gICAgICogZm9yIGVhY2gga2V5L3ZhbHVlIHBhaXIuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKCFPYmplY3QsICFPYmplY3QpfSBhY3Rpb24gQ2FsbGJhY2sgZnVuY3Rpb24gdG8gYmUgY2FsbGVkXG4gICAgICogZm9yIGVhY2gga2V5L3ZhbHVlIHBhaXIuICBJZiBhY3Rpb24gcmV0dXJucyB0cnVlLCB0cmF2ZXJzYWwgaXMgYWJvcnRlZC5cbiAgICAgKiBAcmV0dXJuIHsqfSBUcnVlIGlmIHRoZSB0cmF2ZXJzYWwgd2FzIGFib3J0ZWQuXG4gICAgICovXG4gICAgU29ydGVkTWFwLnByb3RvdHlwZS5yZXZlcnNlVHJhdmVyc2FsID0gZnVuY3Rpb24gKGFjdGlvbikge1xuICAgICAgICByZXR1cm4gdGhpcy5yb290Xy5yZXZlcnNlVHJhdmVyc2FsKGFjdGlvbik7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGFuIGl0ZXJhdG9yIG92ZXIgdGhlIFNvcnRlZE1hcC5cbiAgICAgKiBAdGVtcGxhdGUgVFxuICAgICAqIEBwYXJhbSB7KGZ1bmN0aW9uKEssIFYpOlQpPX0gcmVzdWx0R2VuZXJhdG9yXG4gICAgICogQHJldHVybiB7U29ydGVkTWFwSXRlcmF0b3IuPEssIFYsIFQ+fSBUaGUgaXRlcmF0b3IuXG4gICAgICovXG4gICAgU29ydGVkTWFwLnByb3RvdHlwZS5nZXRJdGVyYXRvciA9IGZ1bmN0aW9uIChyZXN1bHRHZW5lcmF0b3IpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTb3J0ZWRNYXBJdGVyYXRvcih0aGlzLnJvb3RfLCBudWxsLCB0aGlzLmNvbXBhcmF0b3JfLCBmYWxzZSwgcmVzdWx0R2VuZXJhdG9yKTtcbiAgICB9O1xuICAgIFNvcnRlZE1hcC5wcm90b3R5cGUuZ2V0SXRlcmF0b3JGcm9tID0gZnVuY3Rpb24gKGtleSwgcmVzdWx0R2VuZXJhdG9yKSB7XG4gICAgICAgIHJldHVybiBuZXcgU29ydGVkTWFwSXRlcmF0b3IodGhpcy5yb290Xywga2V5LCB0aGlzLmNvbXBhcmF0b3JfLCBmYWxzZSwgcmVzdWx0R2VuZXJhdG9yKTtcbiAgICB9O1xuICAgIFNvcnRlZE1hcC5wcm90b3R5cGUuZ2V0UmV2ZXJzZUl0ZXJhdG9yRnJvbSA9IGZ1bmN0aW9uIChrZXksIHJlc3VsdEdlbmVyYXRvcikge1xuICAgICAgICByZXR1cm4gbmV3IFNvcnRlZE1hcEl0ZXJhdG9yKHRoaXMucm9vdF8sIGtleSwgdGhpcy5jb21wYXJhdG9yXywgdHJ1ZSwgcmVzdWx0R2VuZXJhdG9yKTtcbiAgICB9O1xuICAgIFNvcnRlZE1hcC5wcm90b3R5cGUuZ2V0UmV2ZXJzZUl0ZXJhdG9yID0gZnVuY3Rpb24gKHJlc3VsdEdlbmVyYXRvcikge1xuICAgICAgICByZXR1cm4gbmV3IFNvcnRlZE1hcEl0ZXJhdG9yKHRoaXMucm9vdF8sIG51bGwsIHRoaXMuY29tcGFyYXRvcl8sIHRydWUsIHJlc3VsdEdlbmVyYXRvcik7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBBbHdheXMgdXNlIHRoZSBzYW1lIGVtcHR5IG5vZGUsIHRvIHJlZHVjZSBtZW1vcnkuXG4gICAgICogQGNvbnN0XG4gICAgICovXG4gICAgU29ydGVkTWFwLkVNUFRZX05PREUgPSBuZXcgTExSQkVtcHR5Tm9kZSgpO1xuICAgIHJldHVybiBTb3J0ZWRNYXA7XG59KCkpO1xuZXhwb3J0cy5Tb3J0ZWRNYXAgPSBTb3J0ZWRNYXA7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNvcnRlZE1hcC5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB1dGlsXzEgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG52YXIgUGF0aF8xID0gcmVxdWlyZShcIi4vUGF0aFwiKTtcbnZhciB1dGlsXzIgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG4vKipcbiAqIE5vZGUgaW4gYSBUcmVlLlxuICovXG52YXIgVHJlZU5vZGUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gVHJlZU5vZGUoKSB7XG4gICAgICAgIC8vIFRPRE86IENvbnNpZGVyIG1ha2luZyBhY2Nlc3NvcnMgdGhhdCBjcmVhdGUgY2hpbGRyZW4gYW5kIHZhbHVlIGxhemlseSBvclxuICAgICAgICAvLyBzZXBhcmF0ZSBJbnRlcm5hbCAvIExlYWYgJ3R5cGVzJy5cbiAgICAgICAgdGhpcy5jaGlsZHJlbiA9IHt9O1xuICAgICAgICB0aGlzLmNoaWxkQ291bnQgPSAwO1xuICAgICAgICB0aGlzLnZhbHVlID0gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIFRyZWVOb2RlO1xufSgpKTtcbmV4cG9ydHMuVHJlZU5vZGUgPSBUcmVlTm9kZTtcbi8qKlxuICogQSBsaWdodC13ZWlnaHQgdHJlZSwgdHJhdmVyc2FibGUgYnkgcGF0aC4gIE5vZGVzIGNhbiBoYXZlIGJvdGggdmFsdWVzIGFuZCBjaGlsZHJlbi5cbiAqIE5vZGVzIGFyZSBub3QgZW51bWVyYXRlZCAoYnkgZm9yRWFjaENoaWxkKSB1bmxlc3MgdGhleSBoYXZlIGEgdmFsdWUgb3Igbm9uLWVtcHR5XG4gKiBjaGlsZHJlbi5cbiAqL1xudmFyIFRyZWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQHRlbXBsYXRlIFRcbiAgICAgKiBAcGFyYW0ge3N0cmluZz19IG5hbWVfIE9wdGlvbmFsIG5hbWUgb2YgdGhlIG5vZGUuXG4gICAgICogQHBhcmFtIHtUcmVlPX0gcGFyZW50XyBPcHRpb25hbCBwYXJlbnQgbm9kZS5cbiAgICAgKiBAcGFyYW0ge1RyZWVOb2RlPX0gbm9kZV8gT3B0aW9uYWwgbm9kZSB0byB3cmFwLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFRyZWUobmFtZV8sIHBhcmVudF8sIG5vZGVfKSB7XG4gICAgICAgIGlmIChuYW1lXyA9PT0gdm9pZCAwKSB7IG5hbWVfID0gJyc7IH1cbiAgICAgICAgaWYgKHBhcmVudF8gPT09IHZvaWQgMCkgeyBwYXJlbnRfID0gbnVsbDsgfVxuICAgICAgICBpZiAobm9kZV8gPT09IHZvaWQgMCkgeyBub2RlXyA9IG5ldyBUcmVlTm9kZSgpOyB9XG4gICAgICAgIHRoaXMubmFtZV8gPSBuYW1lXztcbiAgICAgICAgdGhpcy5wYXJlbnRfID0gcGFyZW50XztcbiAgICAgICAgdGhpcy5ub2RlXyA9IG5vZGVfO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgc3ViLVRyZWUgZm9yIHRoZSBnaXZlbiBwYXRoLlxuICAgICAqXG4gICAgICogQHBhcmFtIHshKHN0cmluZ3xQYXRoKX0gcGF0aE9iaiBQYXRoIHRvIGxvb2sgdXAuXG4gICAgICogQHJldHVybiB7IVRyZWUuPFQ+fSBUcmVlIGZvciBwYXRoLlxuICAgICAqL1xuICAgIFRyZWUucHJvdG90eXBlLnN1YlRyZWUgPSBmdW5jdGlvbiAocGF0aE9iaikge1xuICAgICAgICAvLyBUT0RPOiBSZXF1aXJlIHBhdGhPYmogdG8gYmUgUGF0aD9cbiAgICAgICAgdmFyIHBhdGggPSBwYXRoT2JqIGluc3RhbmNlb2YgUGF0aF8xLlBhdGggPyBwYXRoT2JqIDogbmV3IFBhdGhfMS5QYXRoKHBhdGhPYmopO1xuICAgICAgICB2YXIgY2hpbGQgPSB0aGlzLCBuZXh0O1xuICAgICAgICB3aGlsZSAoKG5leHQgPSBwYXRoLmdldEZyb250KCkpICE9PSBudWxsKSB7XG4gICAgICAgICAgICB2YXIgY2hpbGROb2RlID0gdXRpbF8yLnNhZmVHZXQoY2hpbGQubm9kZV8uY2hpbGRyZW4sIG5leHQpIHx8IG5ldyBUcmVlTm9kZSgpO1xuICAgICAgICAgICAgY2hpbGQgPSBuZXcgVHJlZShuZXh0LCBjaGlsZCwgY2hpbGROb2RlKTtcbiAgICAgICAgICAgIHBhdGggPSBwYXRoLnBvcEZyb250KCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNoaWxkO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgZGF0YSBhc3NvY2lhdGVkIHdpdGggdGhpcyB0cmVlIG5vZGUuXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHs/VH0gVGhlIGRhdGEgb3IgbnVsbCBpZiBubyBkYXRhIGV4aXN0cy5cbiAgICAgKi9cbiAgICBUcmVlLnByb3RvdHlwZS5nZXRWYWx1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubm9kZV8udmFsdWU7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBTZXRzIGRhdGEgdG8gdGhpcyB0cmVlIG5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyFUfSB2YWx1ZSBWYWx1ZSB0byBzZXQuXG4gICAgICovXG4gICAgVHJlZS5wcm90b3R5cGUuc2V0VmFsdWUgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdXRpbF8xLmFzc2VydCh0eXBlb2YgdmFsdWUgIT09ICd1bmRlZmluZWQnLCAnQ2Fubm90IHNldCB2YWx1ZSB0byB1bmRlZmluZWQnKTtcbiAgICAgICAgdGhpcy5ub2RlXy52YWx1ZSA9IHZhbHVlO1xuICAgICAgICB0aGlzLnVwZGF0ZVBhcmVudHNfKCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBDbGVhcnMgdGhlIGNvbnRlbnRzIG9mIHRoZSB0cmVlIG5vZGUgKGl0cyB2YWx1ZSBhbmQgYWxsIGNoaWxkcmVuKS5cbiAgICAgKi9cbiAgICBUcmVlLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5ub2RlXy52YWx1ZSA9IG51bGw7XG4gICAgICAgIHRoaXMubm9kZV8uY2hpbGRyZW4gPSB7fTtcbiAgICAgICAgdGhpcy5ub2RlXy5jaGlsZENvdW50ID0gMDtcbiAgICAgICAgdGhpcy51cGRhdGVQYXJlbnRzXygpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7Ym9vbGVhbn0gV2hldGhlciB0aGUgdHJlZSBoYXMgYW55IGNoaWxkcmVuLlxuICAgICAqL1xuICAgIFRyZWUucHJvdG90eXBlLmhhc0NoaWxkcmVuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ub2RlXy5jaGlsZENvdW50ID4gMDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IFdoZXRoZXIgdGhlIHRyZWUgaXMgZW1wdHkgKG5vIHZhbHVlIG9yIGNoaWxkcmVuKS5cbiAgICAgKi9cbiAgICBUcmVlLnByb3RvdHlwZS5pc0VtcHR5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRWYWx1ZSgpID09PSBudWxsICYmICF0aGlzLmhhc0NoaWxkcmVuKCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBDYWxscyBhY3Rpb24gZm9yIGVhY2ggY2hpbGQgb2YgdGhpcyB0cmVlIG5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKCFUcmVlLjxUPil9IGFjdGlvbiBBY3Rpb24gdG8gYmUgY2FsbGVkIGZvciBlYWNoIGNoaWxkLlxuICAgICAqL1xuICAgIFRyZWUucHJvdG90eXBlLmZvckVhY2hDaGlsZCA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdXRpbF8yLmZvckVhY2godGhpcy5ub2RlXy5jaGlsZHJlbiwgZnVuY3Rpb24gKGNoaWxkLCBjaGlsZFRyZWUpIHtcbiAgICAgICAgICAgIGFjdGlvbihuZXcgVHJlZShjaGlsZCwgX3RoaXMsIGNoaWxkVHJlZSkpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIERvZXMgYSBkZXB0aC1maXJzdCB0cmF2ZXJzYWwgb2YgdGhpcyBub2RlJ3MgZGVzY2VuZGFudHMsIGNhbGxpbmcgYWN0aW9uIGZvciBlYWNoIG9uZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oIVRyZWUuPFQ+KX0gYWN0aW9uIEFjdGlvbiB0byBiZSBjYWxsZWQgZm9yIGVhY2ggY2hpbGQuXG4gICAgICogQHBhcmFtIHtib29sZWFuPX0gaW5jbHVkZVNlbGYgV2hldGhlciB0byBjYWxsIGFjdGlvbiBvbiB0aGlzIG5vZGUgYXMgd2VsbC4gRGVmYXVsdHMgdG9cbiAgICAgKiAgIGZhbHNlLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbj19IGNoaWxkcmVuRmlyc3QgV2hldGhlciB0byBjYWxsIGFjdGlvbiBvbiBjaGlsZHJlbiBiZWZvcmUgY2FsbGluZyBpdCBvblxuICAgICAqICAgcGFyZW50LlxuICAgICAqL1xuICAgIFRyZWUucHJvdG90eXBlLmZvckVhY2hEZXNjZW5kYW50ID0gZnVuY3Rpb24gKGFjdGlvbiwgaW5jbHVkZVNlbGYsIGNoaWxkcmVuRmlyc3QpIHtcbiAgICAgICAgaWYgKGluY2x1ZGVTZWxmICYmICFjaGlsZHJlbkZpcnN0KVxuICAgICAgICAgICAgYWN0aW9uKHRoaXMpO1xuICAgICAgICB0aGlzLmZvckVhY2hDaGlsZChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgIGNoaWxkLmZvckVhY2hEZXNjZW5kYW50KGFjdGlvbiwgLyppbmNsdWRlU2VsZj0qLyB0cnVlLCBjaGlsZHJlbkZpcnN0KTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChpbmNsdWRlU2VsZiAmJiBjaGlsZHJlbkZpcnN0KVxuICAgICAgICAgICAgYWN0aW9uKHRoaXMpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQ2FsbHMgYWN0aW9uIG9uIGVhY2ggYW5jZXN0b3Igbm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oIVRyZWUuPFQ+KX0gYWN0aW9uIEFjdGlvbiB0byBiZSBjYWxsZWQgb24gZWFjaCBwYXJlbnQ7IHJldHVyblxuICAgICAqICAgdHJ1ZSB0byBhYm9ydC5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW49fSBpbmNsdWRlU2VsZiBXaGV0aGVyIHRvIGNhbGwgYWN0aW9uIG9uIHRoaXMgbm9kZSBhcyB3ZWxsLlxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IHRydWUgaWYgdGhlIGFjdGlvbiBjYWxsYmFjayByZXR1cm5lZCB0cnVlLlxuICAgICAqL1xuICAgIFRyZWUucHJvdG90eXBlLmZvckVhY2hBbmNlc3RvciA9IGZ1bmN0aW9uIChhY3Rpb24sIGluY2x1ZGVTZWxmKSB7XG4gICAgICAgIHZhciBub2RlID0gaW5jbHVkZVNlbGYgPyB0aGlzIDogdGhpcy5wYXJlbnQoKTtcbiAgICAgICAgd2hpbGUgKG5vZGUgIT09IG51bGwpIHtcbiAgICAgICAgICAgIGlmIChhY3Rpb24obm9kZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5vZGUgPSBub2RlLnBhcmVudCgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIERvZXMgYSBkZXB0aC1maXJzdCB0cmF2ZXJzYWwgb2YgdGhpcyBub2RlJ3MgZGVzY2VuZGFudHMuICBXaGVuIGEgZGVzY2VuZGFudCB3aXRoIGEgdmFsdWVcbiAgICAgKiBpcyBmb3VuZCwgYWN0aW9uIGlzIGNhbGxlZCBvbiBpdCBhbmQgdHJhdmVyc2FsIGRvZXMgbm90IGNvbnRpbnVlIGluc2lkZSB0aGUgbm9kZS5cbiAgICAgKiBBY3Rpb24gaXMgKm5vdCogY2FsbGVkIG9uIHRoaXMgbm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oIVRyZWUuPFQ+KX0gYWN0aW9uIEFjdGlvbiB0byBiZSBjYWxsZWQgZm9yIGVhY2ggY2hpbGQuXG4gICAgICovXG4gICAgVHJlZS5wcm90b3R5cGUuZm9yRWFjaEltbWVkaWF0ZURlc2NlbmRhbnRXaXRoVmFsdWUgPSBmdW5jdGlvbiAoYWN0aW9uKSB7XG4gICAgICAgIHRoaXMuZm9yRWFjaENoaWxkKGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICAgICAgaWYgKGNoaWxkLmdldFZhbHVlKCkgIT09IG51bGwpXG4gICAgICAgICAgICAgICAgYWN0aW9uKGNoaWxkKTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBjaGlsZC5mb3JFYWNoSW1tZWRpYXRlRGVzY2VuZGFudFdpdGhWYWx1ZShhY3Rpb24pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4geyFQYXRofSBUaGUgcGF0aCBvZiB0aGlzIHRyZWUgbm9kZSwgYXMgYSBQYXRoLlxuICAgICAqL1xuICAgIFRyZWUucHJvdG90eXBlLnBhdGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBuZXcgUGF0aF8xLlBhdGgodGhpcy5wYXJlbnRfID09PSBudWxsXG4gICAgICAgICAgICA/IHRoaXMubmFtZV9cbiAgICAgICAgICAgIDogdGhpcy5wYXJlbnRfLnBhdGgoKSArICcvJyArIHRoaXMubmFtZV8pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7c3RyaW5nfSBUaGUgbmFtZSBvZiB0aGUgdHJlZSBub2RlLlxuICAgICAqL1xuICAgIFRyZWUucHJvdG90eXBlLm5hbWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hbWVfO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7P1RyZWV9IFRoZSBwYXJlbnQgdHJlZSBub2RlLCBvciBudWxsIGlmIHRoaXMgaXMgdGhlIHJvb3Qgb2YgdGhlIHRyZWUuXG4gICAgICovXG4gICAgVHJlZS5wcm90b3R5cGUucGFyZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnRfO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQWRkcyBvciByZW1vdmVzIHRoaXMgY2hpbGQgZnJvbSBpdHMgcGFyZW50IGJhc2VkIG9uIHdoZXRoZXIgaXQncyBlbXB0eSBvciBub3QuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIFRyZWUucHJvdG90eXBlLnVwZGF0ZVBhcmVudHNfID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5wYXJlbnRfICE9PSBudWxsKVxuICAgICAgICAgICAgdGhpcy5wYXJlbnRfLnVwZGF0ZUNoaWxkXyh0aGlzLm5hbWVfLCB0aGlzKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEFkZHMgb3IgcmVtb3ZlcyB0aGUgcGFzc2VkIGNoaWxkIHRvIHRoaXMgdHJlZSBub2RlLCBkZXBlbmRpbmcgb24gd2hldGhlciBpdCdzIGVtcHR5LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGNoaWxkTmFtZSBUaGUgbmFtZSBvZiB0aGUgY2hpbGQgdG8gdXBkYXRlLlxuICAgICAqIEBwYXJhbSB7IVRyZWUuPFQ+fSBjaGlsZCBUaGUgY2hpbGQgdG8gdXBkYXRlLlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgVHJlZS5wcm90b3R5cGUudXBkYXRlQ2hpbGRfID0gZnVuY3Rpb24gKGNoaWxkTmFtZSwgY2hpbGQpIHtcbiAgICAgICAgdmFyIGNoaWxkRW1wdHkgPSBjaGlsZC5pc0VtcHR5KCk7XG4gICAgICAgIHZhciBjaGlsZEV4aXN0cyA9IHV0aWxfMi5jb250YWlucyh0aGlzLm5vZGVfLmNoaWxkcmVuLCBjaGlsZE5hbWUpO1xuICAgICAgICBpZiAoY2hpbGRFbXB0eSAmJiBjaGlsZEV4aXN0cykge1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMubm9kZV8uY2hpbGRyZW5bY2hpbGROYW1lXTtcbiAgICAgICAgICAgIHRoaXMubm9kZV8uY2hpbGRDb3VudC0tO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVQYXJlbnRzXygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCFjaGlsZEVtcHR5ICYmICFjaGlsZEV4aXN0cykge1xuICAgICAgICAgICAgdGhpcy5ub2RlXy5jaGlsZHJlbltjaGlsZE5hbWVdID0gY2hpbGQubm9kZV87XG4gICAgICAgICAgICB0aGlzLm5vZGVfLmNoaWxkQ291bnQrKztcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUGFyZW50c18oKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIFRyZWU7XG59KCkpO1xuZXhwb3J0cy5UcmVlID0gVHJlZTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9VHJlZS5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIEV2ZW50RW1pdHRlcl8xID0gcmVxdWlyZShcIi4vRXZlbnRFbWl0dGVyXCIpO1xudmFyIHV0aWxfMSA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvdXRpbFwiKTtcbi8qKlxuICogQGV4dGVuZHMge0V2ZW50RW1pdHRlcn1cbiAqL1xudmFyIFZpc2liaWxpdHlNb25pdG9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhWaXNpYmlsaXR5TW9uaXRvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBWaXNpYmlsaXR5TW9uaXRvcigpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgWyd2aXNpYmxlJ10pIHx8IHRoaXM7XG4gICAgICAgIHZhciBoaWRkZW47XG4gICAgICAgIHZhciB2aXNpYmlsaXR5Q2hhbmdlO1xuICAgICAgICBpZiAodHlwZW9mIGRvY3VtZW50ICE9PSAndW5kZWZpbmVkJyAmJlxuICAgICAgICAgICAgdHlwZW9mIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGRvY3VtZW50WydoaWRkZW4nXSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAvLyBPcGVyYSAxMi4xMCBhbmQgRmlyZWZveCAxOCBhbmQgbGF0ZXIgc3VwcG9ydFxuICAgICAgICAgICAgICAgIHZpc2liaWxpdHlDaGFuZ2UgPSAndmlzaWJpbGl0eWNoYW5nZSc7XG4gICAgICAgICAgICAgICAgaGlkZGVuID0gJ2hpZGRlbic7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgZG9jdW1lbnRbJ21vekhpZGRlbiddICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIHZpc2liaWxpdHlDaGFuZ2UgPSAnbW96dmlzaWJpbGl0eWNoYW5nZSc7XG4gICAgICAgICAgICAgICAgaGlkZGVuID0gJ21vekhpZGRlbic7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgZG9jdW1lbnRbJ21zSGlkZGVuJ10gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgdmlzaWJpbGl0eUNoYW5nZSA9ICdtc3Zpc2liaWxpdHljaGFuZ2UnO1xuICAgICAgICAgICAgICAgIGhpZGRlbiA9ICdtc0hpZGRlbic7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgZG9jdW1lbnRbJ3dlYmtpdEhpZGRlbiddICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIHZpc2liaWxpdHlDaGFuZ2UgPSAnd2Via2l0dmlzaWJpbGl0eWNoYW5nZSc7XG4gICAgICAgICAgICAgICAgaGlkZGVuID0gJ3dlYmtpdEhpZGRlbic7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gSW5pdGlhbGx5LCB3ZSBhbHdheXMgYXNzdW1lIHdlIGFyZSB2aXNpYmxlLiBUaGlzIGVuc3VyZXMgdGhhdCBpbiBicm93c2Vyc1xuICAgICAgICAvLyB3aXRob3V0IHBhZ2UgdmlzaWJpbGl0eSBzdXBwb3J0IG9yIGluIGNhc2VzIHdoZXJlIHdlIGFyZSBuZXZlciB2aXNpYmxlXG4gICAgICAgIC8vIChlLmcuIGNocm9tZSBleHRlbnNpb24pLCB3ZSBhY3QgYXMgaWYgd2UgYXJlIHZpc2libGUsIGkuZS4gZG9uJ3QgZGVsYXlcbiAgICAgICAgLy8gcmVjb25uZWN0c1xuICAgICAgICBfdGhpcy52aXNpYmxlXyA9IHRydWU7XG4gICAgICAgIGlmICh2aXNpYmlsaXR5Q2hhbmdlKSB7XG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKHZpc2liaWxpdHlDaGFuZ2UsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdmlzaWJsZSA9ICFkb2N1bWVudFtoaWRkZW5dO1xuICAgICAgICAgICAgICAgIGlmICh2aXNpYmxlICE9PSBfdGhpcy52aXNpYmxlXykge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy52aXNpYmxlXyA9IHZpc2libGU7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnRyaWdnZXIoJ3Zpc2libGUnLCB2aXNpYmxlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCBmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBWaXNpYmlsaXR5TW9uaXRvci5nZXRJbnN0YW5jZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBWaXNpYmlsaXR5TW9uaXRvcigpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshc3RyaW5nfSBldmVudFR5cGVcbiAgICAgKiBAcmV0dXJuIHtBcnJheS48Ym9vbGVhbj59XG4gICAgICovXG4gICAgVmlzaWJpbGl0eU1vbml0b3IucHJvdG90eXBlLmdldEluaXRpYWxFdmVudCA9IGZ1bmN0aW9uIChldmVudFR5cGUpIHtcbiAgICAgICAgdXRpbF8xLmFzc2VydChldmVudFR5cGUgPT09ICd2aXNpYmxlJywgJ1Vua25vd24gZXZlbnQgdHlwZTogJyArIGV2ZW50VHlwZSk7XG4gICAgICAgIHJldHVybiBbdGhpcy52aXNpYmxlX107XG4gICAgfTtcbiAgICByZXR1cm4gVmlzaWJpbGl0eU1vbml0b3I7XG59KEV2ZW50RW1pdHRlcl8xLkV2ZW50RW1pdHRlcikpO1xuZXhwb3J0cy5WaXNpYmlsaXR5TW9uaXRvciA9IFZpc2liaWxpdHlNb25pdG9yO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1WaXNpYmlsaXR5TW9uaXRvci5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBQYXRoXzEgPSByZXF1aXJlKFwiLi4vUGF0aFwiKTtcbnZhciBSZXBvSW5mb18xID0gcmVxdWlyZShcIi4uLy4uL1JlcG9JbmZvXCIpO1xudmFyIHV0aWxfMSA9IHJlcXVpcmUoXCIuLi91dGlsXCIpO1xuLyoqXG4gKiBAcGFyYW0geyFzdHJpbmd9IHBhdGhTdHJpbmdcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZnVuY3Rpb24gZGVjb2RlUGF0aChwYXRoU3RyaW5nKSB7XG4gICAgdmFyIHBhdGhTdHJpbmdEZWNvZGVkID0gJyc7XG4gICAgdmFyIHBpZWNlcyA9IHBhdGhTdHJpbmcuc3BsaXQoJy8nKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBpZWNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAocGllY2VzW2ldLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHZhciBwaWVjZSA9IHBpZWNlc1tpXTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgcGllY2UgPSBkZWNvZGVVUklDb21wb25lbnQocGllY2UucmVwbGFjZSgvXFwrL2csICcgJykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHsgfVxuICAgICAgICAgICAgcGF0aFN0cmluZ0RlY29kZWQgKz0gJy8nICsgcGllY2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHBhdGhTdHJpbmdEZWNvZGVkO1xufVxuLyoqXG4gKlxuICogQHBhcmFtIHshc3RyaW5nfSBkYXRhVVJMXG4gKiBAcmV0dXJuIHt7cmVwb0luZm86ICFSZXBvSW5mbywgcGF0aDogIVBhdGh9fVxuICovXG5leHBvcnRzLnBhcnNlUmVwb0luZm8gPSBmdW5jdGlvbiAoZGF0YVVSTCkge1xuICAgIHZhciBwYXJzZWRVcmwgPSBleHBvcnRzLnBhcnNlVVJMKGRhdGFVUkwpLCBuYW1lc3BhY2UgPSBwYXJzZWRVcmwuc3ViZG9tYWluO1xuICAgIGlmIChwYXJzZWRVcmwuZG9tYWluID09PSAnZmlyZWJhc2UnKSB7XG4gICAgICAgIHV0aWxfMS5mYXRhbChwYXJzZWRVcmwuaG9zdCArXG4gICAgICAgICAgICAnIGlzIG5vIGxvbmdlciBzdXBwb3J0ZWQuICcgK1xuICAgICAgICAgICAgJ1BsZWFzZSB1c2UgPFlPVVIgRklSRUJBU0U+LmZpcmViYXNlaW8uY29tIGluc3RlYWQnKTtcbiAgICB9XG4gICAgLy8gQ2F0Y2ggY29tbW9uIGVycm9yIG9mIHVuaW5pdGlhbGl6ZWQgbmFtZXNwYWNlIHZhbHVlLlxuICAgIGlmICghbmFtZXNwYWNlIHx8IG5hbWVzcGFjZSA9PSAndW5kZWZpbmVkJykge1xuICAgICAgICB1dGlsXzEuZmF0YWwoJ0Nhbm5vdCBwYXJzZSBGaXJlYmFzZSB1cmwuIFBsZWFzZSB1c2UgaHR0cHM6Ly88WU9VUiBGSVJFQkFTRT4uZmlyZWJhc2Vpby5jb20nKTtcbiAgICB9XG4gICAgaWYgKCFwYXJzZWRVcmwuc2VjdXJlKSB7XG4gICAgICAgIHV0aWxfMS53YXJuSWZQYWdlSXNTZWN1cmUoKTtcbiAgICB9XG4gICAgdmFyIHdlYlNvY2tldE9ubHkgPSBwYXJzZWRVcmwuc2NoZW1lID09PSAnd3MnIHx8IHBhcnNlZFVybC5zY2hlbWUgPT09ICd3c3MnO1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlcG9JbmZvOiBuZXcgUmVwb0luZm9fMS5SZXBvSW5mbyhwYXJzZWRVcmwuaG9zdCwgcGFyc2VkVXJsLnNlY3VyZSwgbmFtZXNwYWNlLCB3ZWJTb2NrZXRPbmx5KSxcbiAgICAgICAgcGF0aDogbmV3IFBhdGhfMS5QYXRoKHBhcnNlZFVybC5wYXRoU3RyaW5nKVxuICAgIH07XG59O1xuLyoqXG4gKlxuICogQHBhcmFtIHshc3RyaW5nfSBkYXRhVVJMXG4gKiBAcmV0dXJuIHt7aG9zdDogc3RyaW5nLCBwb3J0OiBudW1iZXIsIGRvbWFpbjogc3RyaW5nLCBzdWJkb21haW46IHN0cmluZywgc2VjdXJlOiBib29sZWFuLCBzY2hlbWU6IHN0cmluZywgcGF0aFN0cmluZzogc3RyaW5nfX1cbiAqL1xuZXhwb3J0cy5wYXJzZVVSTCA9IGZ1bmN0aW9uIChkYXRhVVJMKSB7XG4gICAgLy8gRGVmYXVsdCB0byBlbXB0eSBzdHJpbmdzIGluIHRoZSBldmVudCBvZiBhIG1hbGZvcm1lZCBzdHJpbmcuXG4gICAgdmFyIGhvc3QgPSAnJywgZG9tYWluID0gJycsIHN1YmRvbWFpbiA9ICcnLCBwYXRoU3RyaW5nID0gJyc7XG4gICAgLy8gQWx3YXlzIGRlZmF1bHQgdG8gU1NMLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAgICB2YXIgc2VjdXJlID0gdHJ1ZSwgc2NoZW1lID0gJ2h0dHBzJywgcG9ydCA9IDQ0MztcbiAgICAvLyBEb24ndCBkbyBhbnkgdmFsaWRhdGlvbiBoZXJlLiBUaGUgY2FsbGVyIGlzIHJlc3BvbnNpYmxlIGZvciB2YWxpZGF0aW5nIHRoZSByZXN1bHQgb2YgcGFyc2luZy5cbiAgICBpZiAodHlwZW9mIGRhdGFVUkwgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIC8vIFBhcnNlIHNjaGVtZS5cbiAgICAgICAgdmFyIGNvbG9uSW5kID0gZGF0YVVSTC5pbmRleE9mKCcvLycpO1xuICAgICAgICBpZiAoY29sb25JbmQgPj0gMCkge1xuICAgICAgICAgICAgc2NoZW1lID0gZGF0YVVSTC5zdWJzdHJpbmcoMCwgY29sb25JbmQgLSAxKTtcbiAgICAgICAgICAgIGRhdGFVUkwgPSBkYXRhVVJMLnN1YnN0cmluZyhjb2xvbkluZCArIDIpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFBhcnNlIGhvc3QgYW5kIHBhdGguXG4gICAgICAgIHZhciBzbGFzaEluZCA9IGRhdGFVUkwuaW5kZXhPZignLycpO1xuICAgICAgICBpZiAoc2xhc2hJbmQgPT09IC0xKSB7XG4gICAgICAgICAgICBzbGFzaEluZCA9IGRhdGFVUkwubGVuZ3RoO1xuICAgICAgICB9XG4gICAgICAgIGhvc3QgPSBkYXRhVVJMLnN1YnN0cmluZygwLCBzbGFzaEluZCk7XG4gICAgICAgIHBhdGhTdHJpbmcgPSBkZWNvZGVQYXRoKGRhdGFVUkwuc3Vic3RyaW5nKHNsYXNoSW5kKSk7XG4gICAgICAgIHZhciBwYXJ0cyA9IGhvc3Quc3BsaXQoJy4nKTtcbiAgICAgICAgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMykge1xuICAgICAgICAgICAgLy8gTm9ybWFsaXplIG5hbWVzcGFjZXMgdG8gbG93ZXJjYXNlIHRvIHNoYXJlIHN0b3JhZ2UgLyBjb25uZWN0aW9uLlxuICAgICAgICAgICAgZG9tYWluID0gcGFydHNbMV07XG4gICAgICAgICAgICBzdWJkb21haW4gPSBwYXJ0c1swXS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgICAgZG9tYWluID0gcGFydHNbMF07XG4gICAgICAgIH1cbiAgICAgICAgLy8gSWYgd2UgaGF2ZSBhIHBvcnQsIHVzZSBzY2hlbWUgZm9yIGRldGVybWluaW5nIGlmIGl0J3Mgc2VjdXJlLlxuICAgICAgICBjb2xvbkluZCA9IGhvc3QuaW5kZXhPZignOicpO1xuICAgICAgICBpZiAoY29sb25JbmQgPj0gMCkge1xuICAgICAgICAgICAgc2VjdXJlID0gc2NoZW1lID09PSAnaHR0cHMnIHx8IHNjaGVtZSA9PT0gJ3dzcyc7XG4gICAgICAgICAgICBwb3J0ID0gcGFyc2VJbnQoaG9zdC5zdWJzdHJpbmcoY29sb25JbmQgKyAxKSwgMTApO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIGhvc3Q6IGhvc3QsXG4gICAgICAgIHBvcnQ6IHBvcnQsXG4gICAgICAgIGRvbWFpbjogZG9tYWluLFxuICAgICAgICBzdWJkb21haW46IHN1YmRvbWFpbixcbiAgICAgICAgc2VjdXJlOiBzZWN1cmUsXG4gICAgICAgIHNjaGVtZTogc2NoZW1lLFxuICAgICAgICBwYXRoU3RyaW5nOiBwYXRoU3RyaW5nXG4gICAgfTtcbn07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhcnNlci5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB1dGlsXzEgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG52YXIgdXRpbF8yID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xudmFyIHV0aWxfMyA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvdXRpbFwiKTtcbnZhciB1dGlsXzQgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG52YXIgdXRpbF81ID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xudmFyIHV0aWxfNiA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvdXRpbFwiKTtcbnZhciBzdG9yYWdlXzEgPSByZXF1aXJlKFwiLi4vc3RvcmFnZS9zdG9yYWdlXCIpO1xudmFyIHV0aWxfNyA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvdXRpbFwiKTtcbi8qKlxuICogUmV0dXJucyBhIGxvY2FsbHktdW5pcXVlIElEIChnZW5lcmF0ZWQgYnkganVzdCBpbmNyZW1lbnRpbmcgdXAgZnJvbSAwIGVhY2ggdGltZSBpdHMgY2FsbGVkKS5cbiAqIEB0eXBlIHtmdW5jdGlvbigpOiBudW1iZXJ9IEdlbmVyYXRlZCBJRC5cbiAqL1xuZXhwb3J0cy5MVUlER2VuZXJhdG9yID0gKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaWQgPSAxO1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBpZCsrO1xuICAgIH07XG59KSgpO1xuLyoqXG4gKiBTaGExIGhhc2ggb2YgdGhlIGlucHV0IHN0cmluZ1xuICogQHBhcmFtIHshc3RyaW5nfSBzdHIgVGhlIHN0cmluZyB0byBoYXNoXG4gKiBAcmV0dXJuIHshc3RyaW5nfSBUaGUgcmVzdWx0aW5nIGhhc2hcbiAqL1xuZXhwb3J0cy5zaGExID0gZnVuY3Rpb24gKHN0cikge1xuICAgIHZhciB1dGY4Qnl0ZXMgPSB1dGlsXzUuc3RyaW5nVG9CeXRlQXJyYXkoc3RyKTtcbiAgICB2YXIgc2hhMSA9IG5ldyB1dGlsXzQuU2hhMSgpO1xuICAgIHNoYTEudXBkYXRlKHV0ZjhCeXRlcyk7XG4gICAgdmFyIHNoYTFCeXRlcyA9IHNoYTEuZGlnZXN0KCk7XG4gICAgcmV0dXJuIHV0aWxfMy5iYXNlNjQuZW5jb2RlQnl0ZUFycmF5KHNoYTFCeXRlcyk7XG59O1xuLyoqXG4gKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKiBAcHJpdmF0ZVxuICovXG52YXIgYnVpbGRMb2dNZXNzYWdlXyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdmFyX2FyZ3MgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXJfYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgIH1cbiAgICB2YXIgbWVzc2FnZSA9ICcnO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmFyX2FyZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFyX2FyZ3NbaV0pIHx8XG4gICAgICAgICAgICAodmFyX2FyZ3NbaV0gJiZcbiAgICAgICAgICAgICAgICB0eXBlb2YgdmFyX2FyZ3NbaV0gPT09ICdvYmplY3QnICYmXG4gICAgICAgICAgICAgICAgdHlwZW9mIHZhcl9hcmdzW2ldLmxlbmd0aCA9PT0gJ251bWJlcicpKSB7XG4gICAgICAgICAgICBtZXNzYWdlICs9IGJ1aWxkTG9nTWVzc2FnZV8uYXBwbHkobnVsbCwgdmFyX2FyZ3NbaV0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiB2YXJfYXJnc1tpXSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIG1lc3NhZ2UgKz0gdXRpbF82LnN0cmluZ2lmeSh2YXJfYXJnc1tpXSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBtZXNzYWdlICs9IHZhcl9hcmdzW2ldO1xuICAgICAgICB9XG4gICAgICAgIG1lc3NhZ2UgKz0gJyAnO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbn07XG4vKipcbiAqIFVzZSB0aGlzIGZvciBhbGwgZGVidWcgbWVzc2FnZXMgaW4gRmlyZWJhc2UuXG4gKiBAdHlwZSB7P2Z1bmN0aW9uKHN0cmluZyl9XG4gKi9cbmV4cG9ydHMubG9nZ2VyID0gbnVsbDtcbi8qKlxuICogRmxhZyB0byBjaGVjayBmb3IgbG9nIGF2YWlsYWJpbGl0eSBvbiBmaXJzdCBsb2cgbWVzc2FnZVxuICogQHR5cGUge2Jvb2xlYW59XG4gKiBAcHJpdmF0ZVxuICovXG52YXIgZmlyc3RMb2dfID0gdHJ1ZTtcbi8qKlxuICogVGhlIGltcGxlbWVudGF0aW9uIG9mIEZpcmViYXNlLmVuYWJsZUxvZ2dpbmcgKGRlZmluZWQgaGVyZSB0byBicmVhayBkZXBlbmRlbmNpZXMpXG4gKiBAcGFyYW0ge2Jvb2xlYW58P2Z1bmN0aW9uKHN0cmluZyl9IGxvZ2dlcl8gQSBmbGFnIHRvIHR1cm4gb24gbG9nZ2luZywgb3IgYSBjdXN0b20gbG9nZ2VyXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBwZXJzaXN0ZW50IFdoZXRoZXIgb3Igbm90IHRvIHBlcnNpc3QgbG9nZ2luZyBzZXR0aW5ncyBhY3Jvc3MgcmVmcmVzaGVzXG4gKi9cbmV4cG9ydHMuZW5hYmxlTG9nZ2luZyA9IGZ1bmN0aW9uIChsb2dnZXJfLCBwZXJzaXN0ZW50KSB7XG4gICAgdXRpbF8xLmFzc2VydCghcGVyc2lzdGVudCB8fCAobG9nZ2VyXyA9PT0gdHJ1ZSB8fCBsb2dnZXJfID09PSBmYWxzZSksIFwiQ2FuJ3QgdHVybiBvbiBjdXN0b20gbG9nZ2VycyBwZXJzaXN0ZW50bHkuXCIpO1xuICAgIGlmIChsb2dnZXJfID09PSB0cnVlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgY29uc29sZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgY29uc29sZS5sb2cgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICBleHBvcnRzLmxvZ2dlciA9IGNvbnNvbGUubG9nLmJpbmQoY29uc29sZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgY29uc29sZS5sb2cgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgLy8gSUUgZG9lcyB0aGlzLlxuICAgICAgICAgICAgICAgIGV4cG9ydHMubG9nZ2VyID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cobWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAocGVyc2lzdGVudClcbiAgICAgICAgICAgIHN0b3JhZ2VfMS5TZXNzaW9uU3RvcmFnZS5zZXQoJ2xvZ2dpbmdfZW5hYmxlZCcsIHRydWUpO1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlb2YgbG9nZ2VyXyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBleHBvcnRzLmxvZ2dlciA9IGxvZ2dlcl87XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBleHBvcnRzLmxvZ2dlciA9IG51bGw7XG4gICAgICAgIHN0b3JhZ2VfMS5TZXNzaW9uU3RvcmFnZS5yZW1vdmUoJ2xvZ2dpbmdfZW5hYmxlZCcpO1xuICAgIH1cbn07XG4vKipcbiAqXG4gKiBAcGFyYW0gey4uLihzdHJpbmd8QXJndW1lbnRzKX0gdmFyX2FyZ3NcbiAqL1xuZXhwb3J0cy5sb2cgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHZhcl9hcmdzID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyX2FyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgaWYgKGZpcnN0TG9nXyA9PT0gdHJ1ZSkge1xuICAgICAgICBmaXJzdExvZ18gPSBmYWxzZTtcbiAgICAgICAgaWYgKGV4cG9ydHMubG9nZ2VyID09PSBudWxsICYmIHN0b3JhZ2VfMS5TZXNzaW9uU3RvcmFnZS5nZXQoJ2xvZ2dpbmdfZW5hYmxlZCcpID09PSB0cnVlKVxuICAgICAgICAgICAgZXhwb3J0cy5lbmFibGVMb2dnaW5nKHRydWUpO1xuICAgIH1cbiAgICBpZiAoZXhwb3J0cy5sb2dnZXIpIHtcbiAgICAgICAgdmFyIG1lc3NhZ2UgPSBidWlsZExvZ01lc3NhZ2VfLmFwcGx5KG51bGwsIHZhcl9hcmdzKTtcbiAgICAgICAgZXhwb3J0cy5sb2dnZXIobWVzc2FnZSk7XG4gICAgfVxufTtcbi8qKlxuICogQHBhcmFtIHshc3RyaW5nfSBwcmVmaXhcbiAqIEByZXR1cm4ge2Z1bmN0aW9uKC4uLlsqXSl9XG4gKi9cbmV4cG9ydHMubG9nV3JhcHBlciA9IGZ1bmN0aW9uIChwcmVmaXgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdmFyX2FyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhcl9hcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgZXhwb3J0cy5sb2cuYXBwbHkodm9pZCAwLCBbcHJlZml4XS5jb25jYXQodmFyX2FyZ3MpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQHBhcmFtIHsuLi5zdHJpbmd9IHZhcl9hcmdzXG4gKi9cbmV4cG9ydHMuZXJyb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHZhcl9hcmdzID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyX2FyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICB2YXIgbWVzc2FnZSA9ICdGSVJFQkFTRSBJTlRFUk5BTCBFUlJPUjogJyArIGJ1aWxkTG9nTWVzc2FnZV8uYXBwbHkodm9pZCAwLCB2YXJfYXJncyk7XG4gICAgICAgIGlmICh0eXBlb2YgY29uc29sZS5lcnJvciAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IobWVzc2FnZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhtZXNzYWdlKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG4vKipcbiAqIEBwYXJhbSB7Li4uc3RyaW5nfSB2YXJfYXJnc1xuICovXG5leHBvcnRzLmZhdGFsID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB2YXJfYXJncyA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhcl9hcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgfVxuICAgIHZhciBtZXNzYWdlID0gYnVpbGRMb2dNZXNzYWdlXy5hcHBseSh2b2lkIDAsIHZhcl9hcmdzKTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZJUkVCQVNFIEZBVEFMIEVSUk9SOiAnICsgbWVzc2FnZSk7XG59O1xuLyoqXG4gKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzXG4gKi9cbmV4cG9ydHMud2FybiA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdmFyX2FyZ3MgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXJfYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGNvbnNvbGUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHZhciBtZXNzYWdlID0gJ0ZJUkVCQVNFIFdBUk5JTkc6ICcgKyBidWlsZExvZ01lc3NhZ2VfLmFwcGx5KHZvaWQgMCwgdmFyX2FyZ3MpO1xuICAgICAgICBpZiAodHlwZW9mIGNvbnNvbGUud2FybiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihtZXNzYWdlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKG1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgfVxufTtcbi8qKlxuICogTG9ncyBhIHdhcm5pbmcgaWYgdGhlIGNvbnRhaW5pbmcgcGFnZSB1c2VzIGh0dHBzLiBDYWxsZWQgd2hlbiBhIGNhbGwgdG8gbmV3IEZpcmViYXNlXG4gKiBkb2VzIG5vdCB1c2UgaHR0cHMuXG4gKi9cbmV4cG9ydHMud2FybklmUGFnZUlzU2VjdXJlID0gZnVuY3Rpb24gKCkge1xuICAgIC8vIEJlIHZlcnkgY2FyZWZ1bCBhY2Nlc3NpbmcgYnJvd3NlciBnbG9iYWxzLiBXaG8ga25vd3Mgd2hhdCBtYXkgb3IgbWF5IG5vdCBleGlzdC5cbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiZcbiAgICAgICAgd2luZG93LmxvY2F0aW9uICYmXG4gICAgICAgIHdpbmRvdy5sb2NhdGlvbi5wcm90b2NvbCAmJlxuICAgICAgICB3aW5kb3cubG9jYXRpb24ucHJvdG9jb2wuaW5kZXhPZignaHR0cHM6JykgIT09IC0xKSB7XG4gICAgICAgIGV4cG9ydHMud2FybignSW5zZWN1cmUgRmlyZWJhc2UgYWNjZXNzIGZyb20gYSBzZWN1cmUgcGFnZS4gJyArXG4gICAgICAgICAgICAnUGxlYXNlIHVzZSBodHRwcyBpbiBjYWxscyB0byBuZXcgRmlyZWJhc2UoKS4nKTtcbiAgICB9XG59O1xuLyoqXG4gKiBAcGFyYW0geyFTdHJpbmd9IG1ldGhvZE5hbWVcbiAqL1xuZXhwb3J0cy53YXJuQWJvdXRVbnN1cHBvcnRlZE1ldGhvZCA9IGZ1bmN0aW9uIChtZXRob2ROYW1lKSB7XG4gICAgZXhwb3J0cy53YXJuKG1ldGhvZE5hbWUgK1xuICAgICAgICAnIGlzIHVuc3VwcG9ydGVkIGFuZCB3aWxsIGxpa2VseSBjaGFuZ2Ugc29vbi4gICcgK1xuICAgICAgICAnUGxlYXNlIGRvIG5vdCB1c2UuJyk7XG59O1xuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgZGF0YSBpcyBOYU4sIG9yICsvLSBJbmZpbml0eS5cbiAqIEBwYXJhbSB7Kn0gZGF0YVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0cy5pc0ludmFsaWRKU09OTnVtYmVyID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICByZXR1cm4gKHR5cGVvZiBkYXRhID09PSAnbnVtYmVyJyAmJlxuICAgICAgICAoZGF0YSAhPSBkYXRhIHx8IC8vIE5hTlxuICAgICAgICAgICAgZGF0YSA9PSBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkgfHxcbiAgICAgICAgICAgIGRhdGEgPT0gTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZKSk7XG59O1xuLyoqXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCl9IGZuXG4gKi9cbmV4cG9ydHMuZXhlY3V0ZVdoZW5ET01SZWFkeSA9IGZ1bmN0aW9uIChmbikge1xuICAgIGlmICh1dGlsXzcuaXNOb2RlU2RrKCkgfHwgZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2NvbXBsZXRlJykge1xuICAgICAgICBmbigpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgLy8gTW9kZWxlZCBhZnRlciBqUXVlcnkuIFRyeSBET01Db250ZW50TG9hZGVkIGFuZCBvbnJlYWR5c3RhdGVjaGFuZ2UgKHdoaWNoXG4gICAgICAgIC8vIGZpcmUgYmVmb3JlIG9ubG9hZCksIGJ1dCBmYWxsIGJhY2sgdG8gb25sb2FkLlxuICAgICAgICB2YXIgY2FsbGVkXzEgPSBmYWxzZTtcbiAgICAgICAgdmFyIHdyYXBwZWRGbl8xID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCFkb2N1bWVudC5ib2R5KSB7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCh3cmFwcGVkRm5fMSwgTWF0aC5mbG9vcigxMCkpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghY2FsbGVkXzEpIHtcbiAgICAgICAgICAgICAgICBjYWxsZWRfMSA9IHRydWU7XG4gICAgICAgICAgICAgICAgZm4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgaWYgKGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIpIHtcbiAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCB3cmFwcGVkRm5fMSwgZmFsc2UpO1xuICAgICAgICAgICAgLy8gZmFsbGJhY2sgdG8gb25sb2FkLlxuICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCB3cmFwcGVkRm5fMSwgZmFsc2UpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGRvY3VtZW50LmF0dGFjaEV2ZW50KSB7XG4gICAgICAgICAgICAvLyBJRS5cbiAgICAgICAgICAgIGRvY3VtZW50LmF0dGFjaEV2ZW50KCdvbnJlYWR5c3RhdGVjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICdjb21wbGV0ZScpXG4gICAgICAgICAgICAgICAgICAgIHdyYXBwZWRGbl8xKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIGZhbGxiYWNrIHRvIG9ubG9hZC5cbiAgICAgICAgICAgIHdpbmRvdy5hdHRhY2hFdmVudCgnb25sb2FkJywgd3JhcHBlZEZuXzEpO1xuICAgICAgICAgICAgLy8galF1ZXJ5IGhhcyBhbiBleHRyYSBoYWNrIGZvciBJRSB0aGF0IHdlIGNvdWxkIGVtcGxveSAoYmFzZWQgb25cbiAgICAgICAgICAgIC8vIGh0dHA6Ly9qYXZhc2NyaXB0Lm53Ym94LmNvbS9JRUNvbnRlbnRMb2FkZWQvKSBCdXQgaXQgbG9va3MgcmVhbGx5IG9sZC5cbiAgICAgICAgICAgIC8vIEknbSBob3Bpbmcgd2UgZG9uJ3QgbmVlZCBpdC5cbiAgICAgICAgfVxuICAgIH1cbn07XG4vKipcbiAqIE1pbmltdW0ga2V5IG5hbWUuIEludmFsaWQgZm9yIGFjdHVhbCBkYXRhLCB1c2VkIGFzIGEgbWFya2VyIHRvIHNvcnQgYmVmb3JlIGFueSB2YWxpZCBuYW1lc1xuICogQHR5cGUgeyFzdHJpbmd9XG4gKi9cbmV4cG9ydHMuTUlOX05BTUUgPSAnW01JTl9OQU1FXSc7XG4vKipcbiAqIE1heGltdW0ga2V5IG5hbWUuIEludmFsaWQgZm9yIGFjdHVhbCBkYXRhLCB1c2VkIGFzIGEgbWFya2VyIHRvIHNvcnQgYWJvdmUgYW55IHZhbGlkIG5hbWVzXG4gKiBAdHlwZSB7IXN0cmluZ31cbiAqL1xuZXhwb3J0cy5NQVhfTkFNRSA9ICdbTUFYX05BTUVdJztcbi8qKlxuICogQ29tcGFyZXMgdmFsaWQgRmlyZWJhc2Uga2V5IG5hbWVzLCBwbHVzIG1pbiBhbmQgbWF4IG5hbWVcbiAqIEBwYXJhbSB7IXN0cmluZ30gYVxuICogQHBhcmFtIHshc3RyaW5nfSBiXG4gKiBAcmV0dXJuIHshbnVtYmVyfVxuICovXG5leHBvcnRzLm5hbWVDb21wYXJlID0gZnVuY3Rpb24gKGEsIGIpIHtcbiAgICBpZiAoYSA9PT0gYikge1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgZWxzZSBpZiAoYSA9PT0gZXhwb3J0cy5NSU5fTkFNRSB8fCBiID09PSBleHBvcnRzLk1BWF9OQU1FKSB7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgZWxzZSBpZiAoYiA9PT0gZXhwb3J0cy5NSU5fTkFNRSB8fCBhID09PSBleHBvcnRzLk1BWF9OQU1FKSB7XG4gICAgICAgIHJldHVybiAxO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdmFyIGFBc0ludCA9IGV4cG9ydHMudHJ5UGFyc2VJbnQoYSksIGJBc0ludCA9IGV4cG9ydHMudHJ5UGFyc2VJbnQoYik7XG4gICAgICAgIGlmIChhQXNJbnQgIT09IG51bGwpIHtcbiAgICAgICAgICAgIGlmIChiQXNJbnQgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYUFzSW50IC0gYkFzSW50ID09IDAgPyBhLmxlbmd0aCAtIGIubGVuZ3RoIDogYUFzSW50IC0gYkFzSW50O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGJBc0ludCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gYSA8IGIgPyAtMSA6IDE7XG4gICAgICAgIH1cbiAgICB9XG59O1xuLyoqXG4gKiBAcGFyYW0geyFzdHJpbmd9IGFcbiAqIEBwYXJhbSB7IXN0cmluZ30gYlxuICogQHJldHVybiB7IW51bWJlcn0gY29tcGFyaXNvbiByZXN1bHQuXG4gKi9cbmV4cG9ydHMuc3RyaW5nQ29tcGFyZSA9IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgaWYgKGEgPT09IGIpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIGVsc2UgaWYgKGEgPCBiKSB7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiAxO1xuICAgIH1cbn07XG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXlcbiAqIEBwYXJhbSB7T2JqZWN0fSBvYmpcbiAqIEByZXR1cm4geyp9XG4gKi9cbmV4cG9ydHMucmVxdWlyZUtleSA9IGZ1bmN0aW9uIChrZXksIG9iaikge1xuICAgIGlmIChvYmogJiYga2V5IGluIG9iaikge1xuICAgICAgICByZXR1cm4gb2JqW2tleV07XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgcmVxdWlyZWQga2V5ICgnICsga2V5ICsgJykgaW4gb2JqZWN0OiAnICsgdXRpbF82LnN0cmluZ2lmeShvYmopKTtcbiAgICB9XG59O1xuLyoqXG4gKiBAcGFyYW0geyp9IG9ialxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnRzLk9iamVjdFRvVW5pcXVlS2V5ID0gZnVuY3Rpb24gKG9iaikge1xuICAgIGlmICh0eXBlb2Ygb2JqICE9PSAnb2JqZWN0JyB8fCBvYmogPT09IG51bGwpXG4gICAgICAgIHJldHVybiB1dGlsXzYuc3RyaW5naWZ5KG9iaik7XG4gICAgdmFyIGtleXMgPSBbXTtcbiAgICBmb3IgKHZhciBrIGluIG9iaikge1xuICAgICAgICBrZXlzLnB1c2goayk7XG4gICAgfVxuICAgIC8vIEV4cG9ydCBhcyBqc29uLCBidXQgd2l0aCB0aGUga2V5cyBzb3J0ZWQuXG4gICAga2V5cy5zb3J0KCk7XG4gICAgdmFyIGtleSA9ICd7JztcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGkgIT09IDApXG4gICAgICAgICAgICBrZXkgKz0gJywnO1xuICAgICAgICBrZXkgKz0gdXRpbF82LnN0cmluZ2lmeShrZXlzW2ldKTtcbiAgICAgICAga2V5ICs9ICc6JztcbiAgICAgICAga2V5ICs9IGV4cG9ydHMuT2JqZWN0VG9VbmlxdWVLZXkob2JqW2tleXNbaV1dKTtcbiAgICB9XG4gICAga2V5ICs9ICd9JztcbiAgICByZXR1cm4ga2V5O1xufTtcbi8qKlxuICogU3BsaXRzIGEgc3RyaW5nIGludG8gYSBudW1iZXIgb2Ygc21hbGxlciBzZWdtZW50cyBvZiBtYXhpbXVtIHNpemVcbiAqIEBwYXJhbSB7IXN0cmluZ30gc3RyIFRoZSBzdHJpbmdcbiAqIEBwYXJhbSB7IW51bWJlcn0gc2Vnc2l6ZSBUaGUgbWF4aW11bSBudW1iZXIgb2YgY2hhcnMgaW4gdGhlIHN0cmluZy5cbiAqIEByZXR1cm4ge0FycmF5LjxzdHJpbmc+fSBUaGUgc3RyaW5nLCBzcGxpdCBpbnRvIGFwcHJvcHJpYXRlbHktc2l6ZWQgY2h1bmtzXG4gKi9cbmV4cG9ydHMuc3BsaXRTdHJpbmdCeVNpemUgPSBmdW5jdGlvbiAoc3RyLCBzZWdzaXplKSB7XG4gICAgdmFyIGxlbiA9IHN0ci5sZW5ndGg7XG4gICAgaWYgKGxlbiA8PSBzZWdzaXplKSB7XG4gICAgICAgIHJldHVybiBbc3RyXTtcbiAgICB9XG4gICAgdmFyIGRhdGFTZWdzID0gW107XG4gICAgZm9yICh2YXIgYyA9IDA7IGMgPCBsZW47IGMgKz0gc2Vnc2l6ZSkge1xuICAgICAgICBpZiAoYyArIHNlZ3NpemUgPiBsZW4pIHtcbiAgICAgICAgICAgIGRhdGFTZWdzLnB1c2goc3RyLnN1YnN0cmluZyhjLCBsZW4pKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGRhdGFTZWdzLnB1c2goc3RyLnN1YnN0cmluZyhjLCBjICsgc2Vnc2l6ZSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBkYXRhU2Vncztcbn07XG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gZWFjaCAoa2V5LCB2YWx1ZSkgcGFpciBpbiBhbiBvYmplY3Qgb3JcbiAqIGFwcGx5IGEgZnVuY3Rpb24gdG8gZWFjaCAoaW5kZXgsIHZhbHVlKSBwYWlyIGluIGFuIGFycmF5XG4gKiBAcGFyYW0geyEoT2JqZWN0fEFycmF5KX0gb2JqIFRoZSBvYmplY3Qgb3IgYXJyYXkgdG8gaXRlcmF0ZSBvdmVyXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKD8sID8pfSBmbiBUaGUgZnVuY3Rpb24gdG8gYXBwbHlcbiAqL1xuZXhwb3J0cy5lYWNoID0gZnVuY3Rpb24gKG9iaiwgZm4pIHtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShvYmopKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb2JqLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICBmbihpLCBvYmpbaV0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICAvKipcbiAgICAgICAgICogaW4gdGhlIGNvbnZlcnNpb24gb2YgY29kZSB3ZSByZW1vdmVkIHRoZSBnb29nLm9iamVjdC5mb3JFYWNoXG4gICAgICAgICAqIGZ1bmN0aW9uIHdoaWNoIGRpZCBhIHZhbHVlLGtleSBjYWxsYmFjay4gV2Ugc3RhbmRhcmRpemVkIG9uXG4gICAgICAgICAqIGEgc2luZ2xlIGltcGwgdGhhdCBkb2VzIGEga2V5LCB2YWx1ZSBjYWxsYmFjay4gU28gd2UgaW52ZXJ0XG4gICAgICAgICAqIHRvIG5vdCBoYXZlIHRvIHRvdWNoIHRoZSBgZWFjaGAgY29kZSBwb2ludHNcbiAgICAgICAgICovXG4gICAgICAgIHV0aWxfMi5mb3JFYWNoKG9iaiwgZnVuY3Rpb24gKGtleSwgdmFsKSB7IHJldHVybiBmbih2YWwsIGtleSk7IH0pO1xuICAgIH1cbn07XG4vKipcbiAqIExpa2UgZ29vZy5iaW5kLCBidXQgZG9lc24ndCBib3RoZXIgdG8gY3JlYXRlIGEgY2xvc3VyZSBpZiBvcHRfY29udGV4dCBpcyBudWxsL3VuZGVmaW5lZC5cbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKil9IGNhbGxiYWNrIENhbGxiYWNrIGZ1bmN0aW9uLlxuICogQHBhcmFtIHs/T2JqZWN0PX0gY29udGV4dCBPcHRpb25hbCBjb250ZXh0IHRvIGJpbmQgdG8uXG4gKiBAcmV0dXJuIHtmdW5jdGlvbigqKX1cbiAqL1xuZXhwb3J0cy5iaW5kQ2FsbGJhY2sgPSBmdW5jdGlvbiAoY2FsbGJhY2ssIGNvbnRleHQpIHtcbiAgICByZXR1cm4gY29udGV4dCA/IGNhbGxiYWNrLmJpbmQoY29udGV4dCkgOiBjYWxsYmFjaztcbn07XG4vKipcbiAqIEJvcnJvd2VkIGZyb20gaHR0cDovL2hnLnNlY29uZGxpZmUuY29tL2xsc2Qvc3JjL3RpcC9qcy90eXBlZGFycmF5LmpzIChNSVQgTGljZW5zZSlcbiAqIEkgbWFkZSBvbmUgbW9kaWZpY2F0aW9uIGF0IHRoZSBlbmQgYW5kIHJlbW92ZWQgdGhlIE5hTiAvIEluZmluaXR5XG4gKiBoYW5kbGluZyAoc2luY2UgaXQgc2VlbWVkIGJyb2tlbiBbY2F1c2VkIGFuIG92ZXJmbG93XSBhbmQgd2UgZG9uJ3QgbmVlZCBpdCkuICBTZWUgTUpMIGNvbW1lbnRzLlxuICogQHBhcmFtIHshbnVtYmVyfSB2IEEgZG91YmxlXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydHMuZG91YmxlVG9JRUVFNzU0U3RyaW5nID0gZnVuY3Rpb24gKHYpIHtcbiAgICB1dGlsXzEuYXNzZXJ0KCFleHBvcnRzLmlzSW52YWxpZEpTT05OdW1iZXIodiksICdJbnZhbGlkIEpTT04gbnVtYmVyJyk7IC8vIE1KTFxuICAgIHZhciBlYml0cyA9IDExLCBmYml0cyA9IDUyO1xuICAgIHZhciBiaWFzID0gKDEgPDwgKGViaXRzIC0gMSkpIC0gMSwgcywgZSwgZiwgbG4sIGksIGJpdHMsIHN0cjtcbiAgICAvLyBDb21wdXRlIHNpZ24sIGV4cG9uZW50LCBmcmFjdGlvblxuICAgIC8vIFNraXAgTmFOIC8gSW5maW5pdHkgaGFuZGxpbmcgLS1NSkwuXG4gICAgaWYgKHYgPT09IDApIHtcbiAgICAgICAgZSA9IDA7XG4gICAgICAgIGYgPSAwO1xuICAgICAgICBzID0gMSAvIHYgPT09IC1JbmZpbml0eSA/IDEgOiAwO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcyA9IHYgPCAwO1xuICAgICAgICB2ID0gTWF0aC5hYnModik7XG4gICAgICAgIGlmICh2ID49IE1hdGgucG93KDIsIDEgLSBiaWFzKSkge1xuICAgICAgICAgICAgLy8gTm9ybWFsaXplZFxuICAgICAgICAgICAgbG4gPSBNYXRoLm1pbihNYXRoLmZsb29yKE1hdGgubG9nKHYpIC8gTWF0aC5MTjIpLCBiaWFzKTtcbiAgICAgICAgICAgIGUgPSBsbiArIGJpYXM7XG4gICAgICAgICAgICBmID0gTWF0aC5yb3VuZCh2ICogTWF0aC5wb3coMiwgZmJpdHMgLSBsbikgLSBNYXRoLnBvdygyLCBmYml0cykpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gRGVub3JtYWxpemVkXG4gICAgICAgICAgICBlID0gMDtcbiAgICAgICAgICAgIGYgPSBNYXRoLnJvdW5kKHYgLyBNYXRoLnBvdygyLCAxIC0gYmlhcyAtIGZiaXRzKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gUGFjayBzaWduLCBleHBvbmVudCwgZnJhY3Rpb25cbiAgICBiaXRzID0gW107XG4gICAgZm9yIChpID0gZmJpdHM7IGk7IGkgLT0gMSkge1xuICAgICAgICBiaXRzLnB1c2goZiAlIDIgPyAxIDogMCk7XG4gICAgICAgIGYgPSBNYXRoLmZsb29yKGYgLyAyKTtcbiAgICB9XG4gICAgZm9yIChpID0gZWJpdHM7IGk7IGkgLT0gMSkge1xuICAgICAgICBiaXRzLnB1c2goZSAlIDIgPyAxIDogMCk7XG4gICAgICAgIGUgPSBNYXRoLmZsb29yKGUgLyAyKTtcbiAgICB9XG4gICAgYml0cy5wdXNoKHMgPyAxIDogMCk7XG4gICAgYml0cy5yZXZlcnNlKCk7XG4gICAgc3RyID0gYml0cy5qb2luKCcnKTtcbiAgICAvLyBSZXR1cm4gdGhlIGRhdGEgYXMgYSBoZXggc3RyaW5nLiAtLU1KTFxuICAgIHZhciBoZXhCeXRlU3RyaW5nID0gJyc7XG4gICAgZm9yIChpID0gMDsgaSA8IDY0OyBpICs9IDgpIHtcbiAgICAgICAgdmFyIGhleEJ5dGUgPSBwYXJzZUludChzdHIuc3Vic3RyKGksIDgpLCAyKS50b1N0cmluZygxNik7XG4gICAgICAgIGlmIChoZXhCeXRlLmxlbmd0aCA9PT0gMSlcbiAgICAgICAgICAgIGhleEJ5dGUgPSAnMCcgKyBoZXhCeXRlO1xuICAgICAgICBoZXhCeXRlU3RyaW5nID0gaGV4Qnl0ZVN0cmluZyArIGhleEJ5dGU7XG4gICAgfVxuICAgIHJldHVybiBoZXhCeXRlU3RyaW5nLnRvTG93ZXJDYXNlKCk7XG59O1xuLyoqXG4gKiBVc2VkIHRvIGRldGVjdCBpZiB3ZSdyZSBpbiBhIENocm9tZSBjb250ZW50IHNjcmlwdCAod2hpY2ggZXhlY3V0ZXMgaW4gYW5cbiAqIGlzb2xhdGVkIGVudmlyb25tZW50IHdoZXJlIGxvbmctcG9sbGluZyBkb2Vzbid0IHdvcmspLlxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0cy5pc0Nocm9tZUV4dGVuc2lvbkNvbnRlbnRTY3JpcHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuICEhKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnICYmXG4gICAgICAgIHdpbmRvd1snY2hyb21lJ10gJiZcbiAgICAgICAgd2luZG93WydjaHJvbWUnXVsnZXh0ZW5zaW9uJ10gJiZcbiAgICAgICAgIS9eY2hyb21lLy50ZXN0KHdpbmRvdy5sb2NhdGlvbi5ocmVmKSk7XG59O1xuLyoqXG4gKiBVc2VkIHRvIGRldGVjdCBpZiB3ZSdyZSBpbiBhIFdpbmRvd3MgOCBTdG9yZSBhcHAuXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnRzLmlzV2luZG93c1N0b3JlQXBwID0gZnVuY3Rpb24gKCkge1xuICAgIC8vIENoZWNrIGZvciB0aGUgcHJlc2VuY2Ugb2YgYSBjb3VwbGUgV2luUlQgZ2xvYmFsc1xuICAgIHJldHVybiB0eXBlb2YgV2luZG93cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIFdpbmRvd3MuVUkgPT09ICdvYmplY3QnO1xufTtcbi8qKlxuICogQ29udmVydHMgYSBzZXJ2ZXIgZXJyb3IgY29kZSB0byBhIEphdmFzY3JpcHQgRXJyb3JcbiAqIEBwYXJhbSB7IXN0cmluZ30gY29kZVxuICogQHBhcmFtIHshUXVlcnl9IHF1ZXJ5XG4gKiBAcmV0dXJuIHtFcnJvcn1cbiAqL1xuZXhwb3J0cy5lcnJvckZvclNlcnZlckNvZGUgPSBmdW5jdGlvbiAoY29kZSwgcXVlcnkpIHtcbiAgICB2YXIgcmVhc29uID0gJ1Vua25vd24gRXJyb3InO1xuICAgIGlmIChjb2RlID09PSAndG9vX2JpZycpIHtcbiAgICAgICAgcmVhc29uID1cbiAgICAgICAgICAgICdUaGUgZGF0YSByZXF1ZXN0ZWQgZXhjZWVkcyB0aGUgbWF4aW11bSBzaXplICcgK1xuICAgICAgICAgICAgICAgICd0aGF0IGNhbiBiZSBhY2Nlc3NlZCB3aXRoIGEgc2luZ2xlIHJlcXVlc3QuJztcbiAgICB9XG4gICAgZWxzZSBpZiAoY29kZSA9PSAncGVybWlzc2lvbl9kZW5pZWQnKSB7XG4gICAgICAgIHJlYXNvbiA9IFwiQ2xpZW50IGRvZXNuJ3QgaGF2ZSBwZXJtaXNzaW9uIHRvIGFjY2VzcyB0aGUgZGVzaXJlZCBkYXRhLlwiO1xuICAgIH1cbiAgICBlbHNlIGlmIChjb2RlID09ICd1bmF2YWlsYWJsZScpIHtcbiAgICAgICAgcmVhc29uID0gJ1RoZSBzZXJ2aWNlIGlzIHVuYXZhaWxhYmxlJztcbiAgICB9XG4gICAgdmFyIGVycm9yID0gbmV3IEVycm9yKGNvZGUgKyAnIGF0ICcgKyBxdWVyeS5wYXRoLnRvU3RyaW5nKCkgKyAnOiAnICsgcmVhc29uKTtcbiAgICBlcnJvci5jb2RlID0gY29kZS50b1VwcGVyQ2FzZSgpO1xuICAgIHJldHVybiBlcnJvcjtcbn07XG4vKipcbiAqIFVzZWQgdG8gdGVzdCBmb3IgaW50ZWdlci1sb29raW5nIHN0cmluZ3NcbiAqIEB0eXBlIHtSZWdFeHB9XG4gKiBAcHJpdmF0ZVxuICovXG5leHBvcnRzLklOVEVHRVJfUkVHRVhQXyA9IG5ldyBSZWdFeHAoJ14tP1xcXFxkezEsMTB9JCcpO1xuLyoqXG4gKiBJZiB0aGUgc3RyaW5nIGNvbnRhaW5zIGEgMzItYml0IGludGVnZXIsIHJldHVybiBpdC4gIEVsc2UgcmV0dXJuIG51bGwuXG4gKiBAcGFyYW0geyFzdHJpbmd9IHN0clxuICogQHJldHVybiB7P251bWJlcn1cbiAqL1xuZXhwb3J0cy50cnlQYXJzZUludCA9IGZ1bmN0aW9uIChzdHIpIHtcbiAgICBpZiAoZXhwb3J0cy5JTlRFR0VSX1JFR0VYUF8udGVzdChzdHIpKSB7XG4gICAgICAgIHZhciBpbnRWYWwgPSBOdW1iZXIoc3RyKTtcbiAgICAgICAgaWYgKGludFZhbCA+PSAtMjE0NzQ4MzY0OCAmJiBpbnRWYWwgPD0gMjE0NzQ4MzY0Nykge1xuICAgICAgICAgICAgcmV0dXJuIGludFZhbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn07XG4vKipcbiAqIEhlbHBlciB0byBydW4gc29tZSBjb2RlIGJ1dCBjYXRjaCBhbnkgZXhjZXB0aW9ucyBhbmQgcmUtdGhyb3cgdGhlbSBsYXRlci5cbiAqIFVzZWZ1bCBmb3IgcHJldmVudGluZyB1c2VyIGNhbGxiYWNrcyBmcm9tIGJyZWFraW5nIGludGVybmFsIGNvZGUuXG4gKlxuICogUmUtdGhyb3dpbmcgdGhlIGV4Y2VwdGlvbiBmcm9tIGEgc2V0VGltZW91dCBpcyBhIGxpdHRsZSBldmlsLCBidXQgaXQncyB2ZXJ5XG4gKiBjb252ZW5pZW50ICh3ZSBkb24ndCBoYXZlIHRvIHRyeSB0byBmaWd1cmUgb3V0IHdoZW4gaXMgYSBzYWZlIHBvaW50IHRvXG4gKiByZS10aHJvdyBpdCksIGFuZCB0aGUgYmVoYXZpb3Igc2VlbXMgcmVhc29uYWJsZTpcbiAqXG4gKiAqIElmIHlvdSBhcmVuJ3QgcGF1c2luZyBvbiBleGNlcHRpb25zLCB5b3UgZ2V0IGFuIGVycm9yIGluIHRoZSBjb25zb2xlIHdpdGhcbiAqICAgdGhlIGNvcnJlY3Qgc3RhY2sgdHJhY2UuXG4gKiAqIElmIHlvdSdyZSBwYXVzaW5nIG9uIGFsbCBleGNlcHRpb25zLCB0aGUgZGVidWdnZXIgd2lsbCBwYXVzZSBvbiB5b3VyXG4gKiAgIGV4Y2VwdGlvbiBhbmQgdGhlbiBhZ2FpbiB3aGVuIHdlIHJldGhyb3cgaXQuXG4gKiAqIElmIHlvdSdyZSBvbmx5IHBhdXNpbmcgb24gdW5jYXVnaHQgZXhjZXB0aW9ucywgdGhlIGRlYnVnZ2VyIHdpbGwgb25seSBwYXVzZVxuICogICBvbiB1cyByZS10aHJvd2luZyBpdC5cbiAqXG4gKiBAcGFyYW0geyFmdW5jdGlvbigpfSBmbiBUaGUgY29kZSB0byBndWFyZC5cbiAqL1xuZXhwb3J0cy5leGNlcHRpb25HdWFyZCA9IGZ1bmN0aW9uIChmbikge1xuICAgIHRyeSB7XG4gICAgICAgIGZuKCk7XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIC8vIFJlLXRocm93IGV4Y2VwdGlvbiB3aGVuIGl0J3Mgc2FmZS5cbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvLyBJdCB1c2VkIHRvIGJlIHRoYXQgXCJ0aHJvdyBlXCIgd291bGQgcmVzdWx0IGluIGEgZ29vZCBjb25zb2xlIGVycm9yIHdpdGhcbiAgICAgICAgICAgIC8vIHJlbGV2YW50IGNvbnRleHQsIGJ1dCBhcyBvZiBDaHJvbWUgMzksIHlvdSBqdXN0IGdldCB0aGUgZmlyZWJhc2UuanNcbiAgICAgICAgICAgIC8vIGZpbGUvbGluZSBudW1iZXIgd2hlcmUgd2UgcmUtdGhyb3cgaXQsIHdoaWNoIGlzIHVzZWxlc3MuIFNvIHdlIGxvZ1xuICAgICAgICAgICAgLy8gZS5zdGFjayBleHBsaWNpdGx5LlxuICAgICAgICAgICAgdmFyIHN0YWNrID0gZS5zdGFjayB8fCAnJztcbiAgICAgICAgICAgIGV4cG9ydHMud2FybignRXhjZXB0aW9uIHdhcyB0aHJvd24gYnkgdXNlciBjYWxsYmFjay4nLCBzdGFjayk7XG4gICAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICB9LCBNYXRoLmZsb29yKDApKTtcbiAgICB9XG59O1xuLyoqXG4gKiBIZWxwZXIgZnVuY3Rpb24gdG8gc2FmZWx5IGNhbGwgb3B0X2NhbGxiYWNrIHdpdGggdGhlIHNwZWNpZmllZCBhcmd1bWVudHMuICBJdDpcbiAqIDEuIFR1cm5zIGludG8gYSBuby1vcCBpZiBvcHRfY2FsbGJhY2sgaXMgbnVsbCBvciB1bmRlZmluZWQuXG4gKiAyLiBXcmFwcyB0aGUgY2FsbCBpbnNpZGUgZXhjZXB0aW9uR3VhcmQgdG8gcHJldmVudCBleGNlcHRpb25zIGZyb20gYnJlYWtpbmcgb3VyIHN0YXRlLlxuICpcbiAqIEBwYXJhbSB7P0Z1bmN0aW9uPX0gY2FsbGJhY2sgT3B0aW9uYWwgb25Db21wbGV0ZSBjYWxsYmFjay5cbiAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3MgQXJiaXRyYXJ5IGFyZ3MgdG8gYmUgcGFzc2VkIHRvIG9wdF9vbkNvbXBsZXRlXG4gKi9cbmV4cG9ydHMuY2FsbFVzZXJDYWxsYmFjayA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgIHZhciB2YXJfYXJncyA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhcl9hcmdzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGNhbGxiYWNrID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGV4cG9ydHMuZXhjZXB0aW9uR3VhcmQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY2FsbGJhY2suYXBwbHkodm9pZCAwLCB2YXJfYXJncyk7XG4gICAgICAgIH0pO1xuICAgIH1cbn07XG4vKipcbiAqIEByZXR1cm4ge2Jvb2xlYW59IHRydWUgaWYgd2UgdGhpbmsgd2UncmUgY3VycmVudGx5IGJlaW5nIGNyYXdsZWQuXG4gKi9cbmV4cG9ydHMuYmVpbmdDcmF3bGVkID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB1c2VyQWdlbnQgPSAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcgJiZcbiAgICAgICAgd2luZG93WyduYXZpZ2F0b3InXSAmJlxuICAgICAgICB3aW5kb3dbJ25hdmlnYXRvciddWyd1c2VyQWdlbnQnXSkgfHxcbiAgICAgICAgJyc7XG4gICAgLy8gRm9yIG5vdyB3ZSB3aGl0ZWxpc3QgdGhlIG1vc3QgcG9wdWxhciBjcmF3bGVycy4gIFdlIHNob3VsZCByZWZpbmUgdGhpcyB0byBiZSB0aGUgc2V0IG9mIGNyYXdsZXJzIHdlXG4gICAgLy8gYmVsaWV2ZSB0byBzdXBwb3J0IEphdmFTY3JpcHQvQUpBWCByZW5kZXJpbmcuXG4gICAgLy8gTk9URTogR29vZ2xlIFdlYm1hc3RlciBUb29scyBkb2Vzbid0IHJlYWxseSBiZWxvbmcsIGJ1dCB0aGVpciBcIlRoaXMgaXMgaG93IGEgdmlzaXRvciB0byB5b3VyIHdlYnNpdGVcbiAgICAvLyB3b3VsZCBoYXZlIHNlZW4gdGhlIHBhZ2VcIiBpcyBmbGFreSBpZiB3ZSBkb24ndCB0cmVhdCBpdCBhcyBhIGNyYXdsZXIuXG4gICAgcmV0dXJuICh1c2VyQWdlbnQuc2VhcmNoKC9nb29nbGVib3R8Z29vZ2xlIHdlYm1hc3RlciB0b29sc3xiaW5nYm90fHlhaG9vISBzbHVycHxiYWlkdXNwaWRlcnx5YW5kZXhib3R8ZHVja2R1Y2tib3QvaSkgPj0gMCk7XG59O1xuLyoqXG4gKiBFeHBvcnQgYSBwcm9wZXJ0eSBvZiBhbiBvYmplY3QgdXNpbmcgYSBnZXR0ZXIgZnVuY3Rpb24uXG4gKlxuICogQHBhcmFtIHshT2JqZWN0fSBvYmplY3RcbiAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXG4gKiBAcGFyYW0geyFmdW5jdGlvbigpOiAqfSBmbkdldFxuICovXG5leHBvcnRzLmV4cG9ydFByb3BHZXR0ZXIgPSBmdW5jdGlvbiAob2JqZWN0LCBuYW1lLCBmbkdldCkge1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmplY3QsIG5hbWUsIHsgZ2V0OiBmbkdldCB9KTtcbn07XG4vKipcbiAqIFNhbWUgYXMgc2V0VGltZW91dCgpIGV4Y2VwdCBvbiBOb2RlLkpTIGl0IHdpbGwgL25vdC8gcHJldmVudCB0aGUgcHJvY2VzcyBmcm9tIGV4aXRpbmcuXG4gKlxuICogSXQgaXMgcmVtb3ZlZCB3aXRoIGNsZWFyVGltZW91dCgpIGFzIG5vcm1hbC5cbiAqXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBGdW5jdGlvbiB0byBydW4uXG4gKiBAcGFyYW0ge251bWJlcn0gdGltZSBNaWxsaXNlY29uZHMgdG8gd2FpdCBiZWZvcmUgcnVubmluZy5cbiAqIEByZXR1cm4ge251bWJlcnxPYmplY3R9IFRoZSBzZXRUaW1lb3V0KCkgcmV0dXJuIHZhbHVlLlxuICovXG5leHBvcnRzLnNldFRpbWVvdXROb25CbG9ja2luZyA9IGZ1bmN0aW9uIChmbiwgdGltZSkge1xuICAgIHZhciB0aW1lb3V0ID0gc2V0VGltZW91dChmbiwgdGltZSk7XG4gICAgaWYgKHR5cGVvZiB0aW1lb3V0ID09PSAnb2JqZWN0JyAmJiB0aW1lb3V0Wyd1bnJlZiddKSB7XG4gICAgICAgIHRpbWVvdXRbJ3VucmVmJ10oKTtcbiAgICB9XG4gICAgcmV0dXJuIHRpbWVvdXQ7XG59O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD11dGlsLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIFBhdGhfMSA9IHJlcXVpcmUoXCIuL1BhdGhcIik7XG52YXIgdXRpbF8xID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xudmFyIHV0aWxfMiA9IHJlcXVpcmUoXCIuL3V0aWxcIik7XG52YXIgdXRpbF8zID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xudmFyIHV0aWxfNCA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvdXRpbFwiKTtcbi8qKlxuICogVHJ1ZSBmb3IgaW52YWxpZCBGaXJlYmFzZSBrZXlzXG4gKiBAdHlwZSB7UmVnRXhwfVxuICogQHByaXZhdGVcbiAqL1xuZXhwb3J0cy5JTlZBTElEX0tFWV9SRUdFWF8gPSAvW1xcW1xcXS4jJFxcL1xcdTAwMDAtXFx1MDAxRlxcdTAwN0ZdLztcbi8qKlxuICogVHJ1ZSBmb3IgaW52YWxpZCBGaXJlYmFzZSBwYXRocy5cbiAqIEFsbG93cyAnLycgaW4gcGF0aHMuXG4gKiBAdHlwZSB7UmVnRXhwfVxuICogQHByaXZhdGVcbiAqL1xuZXhwb3J0cy5JTlZBTElEX1BBVEhfUkVHRVhfID0gL1tcXFtcXF0uIyRcXHUwMDAwLVxcdTAwMUZcXHUwMDdGXS87XG4vKipcbiAqIE1heGltdW0gbnVtYmVyIG9mIGNoYXJhY3RlcnMgdG8gYWxsb3cgaW4gbGVhZiB2YWx1ZVxuICogQHR5cGUge251bWJlcn1cbiAqIEBwcml2YXRlXG4gKi9cbmV4cG9ydHMuTUFYX0xFQUZfU0laRV8gPSAxMCAqIDEwMjQgKiAxMDI0O1xuLyoqXG4gKiBAcGFyYW0geyp9IGtleVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0cy5pc1ZhbGlkS2V5ID0gZnVuY3Rpb24gKGtleSkge1xuICAgIHJldHVybiAodHlwZW9mIGtleSA9PT0gJ3N0cmluZycgJiYga2V5Lmxlbmd0aCAhPT0gMCAmJiAhZXhwb3J0cy5JTlZBTElEX0tFWV9SRUdFWF8udGVzdChrZXkpKTtcbn07XG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoU3RyaW5nXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnRzLmlzVmFsaWRQYXRoU3RyaW5nID0gZnVuY3Rpb24gKHBhdGhTdHJpbmcpIHtcbiAgICByZXR1cm4gKHR5cGVvZiBwYXRoU3RyaW5nID09PSAnc3RyaW5nJyAmJlxuICAgICAgICBwYXRoU3RyaW5nLmxlbmd0aCAhPT0gMCAmJlxuICAgICAgICAhZXhwb3J0cy5JTlZBTElEX1BBVEhfUkVHRVhfLnRlc3QocGF0aFN0cmluZykpO1xufTtcbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IHBhdGhTdHJpbmdcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydHMuaXNWYWxpZFJvb3RQYXRoU3RyaW5nID0gZnVuY3Rpb24gKHBhdGhTdHJpbmcpIHtcbiAgICBpZiAocGF0aFN0cmluZykge1xuICAgICAgICAvLyBBbGxvdyAnLy5pbmZvLycgYXQgdGhlIGJlZ2lubmluZy5cbiAgICAgICAgcGF0aFN0cmluZyA9IHBhdGhTdHJpbmcucmVwbGFjZSgvXlxcLypcXC5pbmZvKFxcL3wkKS8sICcvJyk7XG4gICAgfVxuICAgIHJldHVybiBleHBvcnRzLmlzVmFsaWRQYXRoU3RyaW5nKHBhdGhTdHJpbmcpO1xufTtcbi8qKlxuICogQHBhcmFtIHsqfSBwcmlvcml0eVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0cy5pc1ZhbGlkUHJpb3JpdHkgPSBmdW5jdGlvbiAocHJpb3JpdHkpIHtcbiAgICByZXR1cm4gKHByaW9yaXR5ID09PSBudWxsIHx8XG4gICAgICAgIHR5cGVvZiBwcmlvcml0eSA9PT0gJ3N0cmluZycgfHxcbiAgICAgICAgKHR5cGVvZiBwcmlvcml0eSA9PT0gJ251bWJlcicgJiYgIXV0aWxfMi5pc0ludmFsaWRKU09OTnVtYmVyKHByaW9yaXR5KSkgfHxcbiAgICAgICAgKHByaW9yaXR5ICYmIHR5cGVvZiBwcmlvcml0eSA9PT0gJ29iamVjdCcgJiYgdXRpbF8xLmNvbnRhaW5zKHByaW9yaXR5LCAnLnN2JykpKTtcbn07XG4vKipcbiAqIFByZS12YWxpZGF0ZSBhIGRhdHVtIHBhc3NlZCBhcyBhbiBhcmd1bWVudCB0byBGaXJlYmFzZSBmdW5jdGlvbi5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gZm5OYW1lXG4gKiBAcGFyYW0ge251bWJlcn0gYXJndW1lbnROdW1iZXJcbiAqIEBwYXJhbSB7Kn0gZGF0YVxuICogQHBhcmFtIHshUGF0aH0gcGF0aFxuICogQHBhcmFtIHtib29sZWFufSBvcHRpb25hbFxuICovXG5leHBvcnRzLnZhbGlkYXRlRmlyZWJhc2VEYXRhQXJnID0gZnVuY3Rpb24gKGZuTmFtZSwgYXJndW1lbnROdW1iZXIsIGRhdGEsIHBhdGgsIG9wdGlvbmFsKSB7XG4gICAgaWYgKG9wdGlvbmFsICYmIGRhdGEgPT09IHVuZGVmaW5lZClcbiAgICAgICAgcmV0dXJuO1xuICAgIGV4cG9ydHMudmFsaWRhdGVGaXJlYmFzZURhdGEodXRpbF8zLmVycm9yUHJlZml4KGZuTmFtZSwgYXJndW1lbnROdW1iZXIsIG9wdGlvbmFsKSwgZGF0YSwgcGF0aCk7XG59O1xuLyoqXG4gKiBWYWxpZGF0ZSBhIGRhdGEgb2JqZWN0IGNsaWVudC1zaWRlIGJlZm9yZSBzZW5kaW5nIHRvIHNlcnZlci5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gZXJyb3JQcmVmaXhcbiAqIEBwYXJhbSB7Kn0gZGF0YVxuICogQHBhcmFtIHshUGF0aHwhVmFsaWRhdGlvblBhdGh9IHBhdGhfXG4gKi9cbmV4cG9ydHMudmFsaWRhdGVGaXJlYmFzZURhdGEgPSBmdW5jdGlvbiAoZXJyb3JQcmVmaXgsIGRhdGEsIHBhdGhfKSB7XG4gICAgdmFyIHBhdGggPSBwYXRoXyBpbnN0YW5jZW9mIFBhdGhfMS5QYXRoID8gbmV3IFBhdGhfMS5WYWxpZGF0aW9uUGF0aChwYXRoXywgZXJyb3JQcmVmaXgpIDogcGF0aF87XG4gICAgaWYgKGRhdGEgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JQcmVmaXggKyAnY29udGFpbnMgdW5kZWZpbmVkICcgKyBwYXRoLnRvRXJyb3JTdHJpbmcoKSk7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JQcmVmaXggK1xuICAgICAgICAgICAgJ2NvbnRhaW5zIGEgZnVuY3Rpb24gJyArXG4gICAgICAgICAgICBwYXRoLnRvRXJyb3JTdHJpbmcoKSArXG4gICAgICAgICAgICAnIHdpdGggY29udGVudHMgPSAnICtcbiAgICAgICAgICAgIGRhdGEudG9TdHJpbmcoKSk7XG4gICAgfVxuICAgIGlmICh1dGlsXzIuaXNJbnZhbGlkSlNPTk51bWJlcihkYXRhKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JQcmVmaXggKyAnY29udGFpbnMgJyArIGRhdGEudG9TdHJpbmcoKSArICcgJyArIHBhdGgudG9FcnJvclN0cmluZygpKTtcbiAgICB9XG4gICAgLy8gQ2hlY2sgbWF4IGxlYWYgc2l6ZSwgYnV0IHRyeSB0byBhdm9pZCB0aGUgdXRmOCBjb252ZXJzaW9uIGlmIHdlIGNhbi5cbiAgICBpZiAodHlwZW9mIGRhdGEgPT09ICdzdHJpbmcnICYmXG4gICAgICAgIGRhdGEubGVuZ3RoID4gZXhwb3J0cy5NQVhfTEVBRl9TSVpFXyAvIDMgJiZcbiAgICAgICAgdXRpbF80LnN0cmluZ0xlbmd0aChkYXRhKSA+IGV4cG9ydHMuTUFYX0xFQUZfU0laRV8pIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yUHJlZml4ICtcbiAgICAgICAgICAgICdjb250YWlucyBhIHN0cmluZyBncmVhdGVyIHRoYW4gJyArXG4gICAgICAgICAgICBleHBvcnRzLk1BWF9MRUFGX1NJWkVfICtcbiAgICAgICAgICAgICcgdXRmOCBieXRlcyAnICtcbiAgICAgICAgICAgIHBhdGgudG9FcnJvclN0cmluZygpICtcbiAgICAgICAgICAgIFwiICgnXCIgK1xuICAgICAgICAgICAgZGF0YS5zdWJzdHJpbmcoMCwgNTApICtcbiAgICAgICAgICAgIFwiLi4uJylcIik7XG4gICAgfVxuICAgIC8vIFRPRE8gPSBQZXJmID0gQ29uc2lkZXIgY29tYmluaW5nIHRoZSByZWN1cnNpdmUgdmFsaWRhdGlvbiBvZiBrZXlzIGludG8gTm9kZUZyb21KU09OXG4gICAgLy8gdG8gc2F2ZSBleHRyYSB3YWxraW5nIG9mIGxhcmdlIG9iamVjdHMuXG4gICAgaWYgKGRhdGEgJiYgdHlwZW9mIGRhdGEgPT09ICdvYmplY3QnKSB7XG4gICAgICAgIHZhciBoYXNEb3RWYWx1ZV8xID0gZmFsc2UsIGhhc0FjdHVhbENoaWxkXzEgPSBmYWxzZTtcbiAgICAgICAgdXRpbF8xLmZvckVhY2goZGF0YSwgZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcbiAgICAgICAgICAgIGlmIChrZXkgPT09ICcudmFsdWUnKSB7XG4gICAgICAgICAgICAgICAgaGFzRG90VmFsdWVfMSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChrZXkgIT09ICcucHJpb3JpdHknICYmIGtleSAhPT0gJy5zdicpIHtcbiAgICAgICAgICAgICAgICBoYXNBY3R1YWxDaGlsZF8xID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpZiAoIWV4cG9ydHMuaXNWYWxpZEtleShrZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvclByZWZpeCArXG4gICAgICAgICAgICAgICAgICAgICAgICAnIGNvbnRhaW5zIGFuIGludmFsaWQga2V5ICgnICtcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleSArXG4gICAgICAgICAgICAgICAgICAgICAgICAnKSAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGgudG9FcnJvclN0cmluZygpICtcbiAgICAgICAgICAgICAgICAgICAgICAgICcuICBLZXlzIG11c3QgYmUgbm9uLWVtcHR5IHN0cmluZ3MgJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnYW5kIGNhblxcJ3QgY29udGFpbiBcIi5cIiwgXCIjXCIsIFwiJFwiLCBcIi9cIiwgXCJbXCIsIG9yIFwiXVwiJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGF0aC5wdXNoKGtleSk7XG4gICAgICAgICAgICBleHBvcnRzLnZhbGlkYXRlRmlyZWJhc2VEYXRhKGVycm9yUHJlZml4LCB2YWx1ZSwgcGF0aCk7XG4gICAgICAgICAgICBwYXRoLnBvcCgpO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGhhc0RvdFZhbHVlXzEgJiYgaGFzQWN0dWFsQ2hpbGRfMSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yUHJlZml4ICtcbiAgICAgICAgICAgICAgICAnIGNvbnRhaW5zIFwiLnZhbHVlXCIgY2hpbGQgJyArXG4gICAgICAgICAgICAgICAgcGF0aC50b0Vycm9yU3RyaW5nKCkgK1xuICAgICAgICAgICAgICAgICcgaW4gYWRkaXRpb24gdG8gYWN0dWFsIGNoaWxkcmVuLicpO1xuICAgICAgICB9XG4gICAgfVxufTtcbi8qKlxuICogUHJlLXZhbGlkYXRlIHBhdGhzIHBhc3NlZCBpbiB0aGUgZmlyZWJhc2UgZnVuY3Rpb24uXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGVycm9yUHJlZml4XG4gKiBAcGFyYW0ge0FycmF5PCFQYXRoPn0gbWVyZ2VQYXRoc1xuICovXG5leHBvcnRzLnZhbGlkYXRlRmlyZWJhc2VNZXJnZVBhdGhzID0gZnVuY3Rpb24gKGVycm9yUHJlZml4LCBtZXJnZVBhdGhzKSB7XG4gICAgdmFyIGksIGN1clBhdGg7XG4gICAgZm9yIChpID0gMDsgaSA8IG1lcmdlUGF0aHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY3VyUGF0aCA9IG1lcmdlUGF0aHNbaV07XG4gICAgICAgIHZhciBrZXlzID0gY3VyUGF0aC5zbGljZSgpO1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGtleXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgIGlmIChrZXlzW2pdID09PSAnLnByaW9yaXR5JyAmJiBqID09PSBrZXlzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICAvLyAucHJpb3JpdHkgaXMgT0tcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKCFleHBvcnRzLmlzVmFsaWRLZXkoa2V5c1tqXSkpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JQcmVmaXggK1xuICAgICAgICAgICAgICAgICAgICAnY29udGFpbnMgYW4gaW52YWxpZCBrZXkgKCcgK1xuICAgICAgICAgICAgICAgICAgICBrZXlzW2pdICtcbiAgICAgICAgICAgICAgICAgICAgJykgaW4gcGF0aCAnICtcbiAgICAgICAgICAgICAgICAgICAgY3VyUGF0aC50b1N0cmluZygpICtcbiAgICAgICAgICAgICAgICAgICAgJy4gS2V5cyBtdXN0IGJlIG5vbi1lbXB0eSBzdHJpbmdzICcgK1xuICAgICAgICAgICAgICAgICAgICAnYW5kIGNhblxcJ3QgY29udGFpbiBcIi5cIiwgXCIjXCIsIFwiJFwiLCBcIi9cIiwgXCJbXCIsIG9yIFwiXVwiJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gQ2hlY2sgdGhhdCB1cGRhdGUga2V5cyBhcmUgbm90IGRlc2NlbmRhbnRzIG9mIGVhY2ggb3RoZXIuXG4gICAgLy8gV2UgcmVseSBvbiB0aGUgcHJvcGVydHkgdGhhdCBzb3J0aW5nIGd1YXJhbnRlZXMgdGhhdCBhbmNlc3RvcnMgY29tZVxuICAgIC8vIHJpZ2h0IGJlZm9yZSBkZXNjZW5kYW50cy5cbiAgICBtZXJnZVBhdGhzLnNvcnQoUGF0aF8xLlBhdGguY29tcGFyZVBhdGhzKTtcbiAgICB2YXIgcHJldlBhdGggPSBudWxsO1xuICAgIGZvciAoaSA9IDA7IGkgPCBtZXJnZVBhdGhzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGN1clBhdGggPSBtZXJnZVBhdGhzW2ldO1xuICAgICAgICBpZiAocHJldlBhdGggIT09IG51bGwgJiYgcHJldlBhdGguY29udGFpbnMoY3VyUGF0aCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvclByZWZpeCArXG4gICAgICAgICAgICAgICAgJ2NvbnRhaW5zIGEgcGF0aCAnICtcbiAgICAgICAgICAgICAgICBwcmV2UGF0aC50b1N0cmluZygpICtcbiAgICAgICAgICAgICAgICAnIHRoYXQgaXMgYW5jZXN0b3Igb2YgYW5vdGhlciBwYXRoICcgK1xuICAgICAgICAgICAgICAgIGN1clBhdGgudG9TdHJpbmcoKSk7XG4gICAgICAgIH1cbiAgICAgICAgcHJldlBhdGggPSBjdXJQYXRoO1xuICAgIH1cbn07XG4vKipcbiAqIHByZS12YWxpZGF0ZSBhbiBvYmplY3QgcGFzc2VkIGFzIGFuIGFyZ3VtZW50IHRvIGZpcmViYXNlIGZ1bmN0aW9uIChcbiAqIG11c3QgYmUgYW4gb2JqZWN0IC0gZS5nLiBmb3IgZmlyZWJhc2UudXBkYXRlKCkpLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBmbk5hbWVcbiAqIEBwYXJhbSB7bnVtYmVyfSBhcmd1bWVudE51bWJlclxuICogQHBhcmFtIHsqfSBkYXRhXG4gKiBAcGFyYW0geyFQYXRofSBwYXRoXG4gKiBAcGFyYW0ge2Jvb2xlYW59IG9wdGlvbmFsXG4gKi9cbmV4cG9ydHMudmFsaWRhdGVGaXJlYmFzZU1lcmdlRGF0YUFyZyA9IGZ1bmN0aW9uIChmbk5hbWUsIGFyZ3VtZW50TnVtYmVyLCBkYXRhLCBwYXRoLCBvcHRpb25hbCkge1xuICAgIGlmIChvcHRpb25hbCAmJiBkYXRhID09PSB1bmRlZmluZWQpXG4gICAgICAgIHJldHVybjtcbiAgICB2YXIgZXJyb3JQcmVmaXggPSB1dGlsXzMuZXJyb3JQcmVmaXgoZm5OYW1lLCBhcmd1bWVudE51bWJlciwgb3B0aW9uYWwpO1xuICAgIGlmICghKGRhdGEgJiYgdHlwZW9mIGRhdGEgPT09ICdvYmplY3QnKSB8fCBBcnJheS5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvclByZWZpeCArICcgbXVzdCBiZSBhbiBvYmplY3QgY29udGFpbmluZyB0aGUgY2hpbGRyZW4gdG8gcmVwbGFjZS4nKTtcbiAgICB9XG4gICAgdmFyIG1lcmdlUGF0aHMgPSBbXTtcbiAgICB1dGlsXzEuZm9yRWFjaChkYXRhLCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xuICAgICAgICB2YXIgY3VyUGF0aCA9IG5ldyBQYXRoXzEuUGF0aChrZXkpO1xuICAgICAgICBleHBvcnRzLnZhbGlkYXRlRmlyZWJhc2VEYXRhKGVycm9yUHJlZml4LCB2YWx1ZSwgcGF0aC5jaGlsZChjdXJQYXRoKSk7XG4gICAgICAgIGlmIChjdXJQYXRoLmdldEJhY2soKSA9PT0gJy5wcmlvcml0eScpIHtcbiAgICAgICAgICAgIGlmICghZXhwb3J0cy5pc1ZhbGlkUHJpb3JpdHkodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yUHJlZml4ICtcbiAgICAgICAgICAgICAgICAgICAgXCJjb250YWlucyBhbiBpbnZhbGlkIHZhbHVlIGZvciAnXCIgK1xuICAgICAgICAgICAgICAgICAgICBjdXJQYXRoLnRvU3RyaW5nKCkgK1xuICAgICAgICAgICAgICAgICAgICBcIicsIHdoaWNoIG11c3QgYmUgYSB2YWxpZCBcIiArXG4gICAgICAgICAgICAgICAgICAgICdGaXJlYmFzZSBwcmlvcml0eSAoYSBzdHJpbmcsIGZpbml0ZSBudW1iZXIsIHNlcnZlciB2YWx1ZSwgb3IgbnVsbCkuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbWVyZ2VQYXRocy5wdXNoKGN1clBhdGgpO1xuICAgIH0pO1xuICAgIGV4cG9ydHMudmFsaWRhdGVGaXJlYmFzZU1lcmdlUGF0aHMoZXJyb3JQcmVmaXgsIG1lcmdlUGF0aHMpO1xufTtcbmV4cG9ydHMudmFsaWRhdGVQcmlvcml0eSA9IGZ1bmN0aW9uIChmbk5hbWUsIGFyZ3VtZW50TnVtYmVyLCBwcmlvcml0eSwgb3B0aW9uYWwpIHtcbiAgICBpZiAob3B0aW9uYWwgJiYgcHJpb3JpdHkgPT09IHVuZGVmaW5lZClcbiAgICAgICAgcmV0dXJuO1xuICAgIGlmICh1dGlsXzIuaXNJbnZhbGlkSlNPTk51bWJlcihwcmlvcml0eSkpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcih1dGlsXzMuZXJyb3JQcmVmaXgoZm5OYW1lLCBhcmd1bWVudE51bWJlciwgb3B0aW9uYWwpICtcbiAgICAgICAgICAgICdpcyAnICtcbiAgICAgICAgICAgIHByaW9yaXR5LnRvU3RyaW5nKCkgK1xuICAgICAgICAgICAgJywgYnV0IG11c3QgYmUgYSB2YWxpZCBGaXJlYmFzZSBwcmlvcml0eSAoYSBzdHJpbmcsIGZpbml0ZSBudW1iZXIsICcgK1xuICAgICAgICAgICAgJ3NlcnZlciB2YWx1ZSwgb3IgbnVsbCkuJyk7XG4gICAgLy8gU3BlY2lhbCBjYXNlIHRvIGFsbG93IGltcG9ydGluZyBkYXRhIHdpdGggYSAuc3YuXG4gICAgaWYgKCFleHBvcnRzLmlzVmFsaWRQcmlvcml0eShwcmlvcml0eSkpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcih1dGlsXzMuZXJyb3JQcmVmaXgoZm5OYW1lLCBhcmd1bWVudE51bWJlciwgb3B0aW9uYWwpICtcbiAgICAgICAgICAgICdtdXN0IGJlIGEgdmFsaWQgRmlyZWJhc2UgcHJpb3JpdHkgJyArXG4gICAgICAgICAgICAnKGEgc3RyaW5nLCBmaW5pdGUgbnVtYmVyLCBzZXJ2ZXIgdmFsdWUsIG9yIG51bGwpLicpO1xufTtcbmV4cG9ydHMudmFsaWRhdGVFdmVudFR5cGUgPSBmdW5jdGlvbiAoZm5OYW1lLCBhcmd1bWVudE51bWJlciwgZXZlbnRUeXBlLCBvcHRpb25hbCkge1xuICAgIGlmIChvcHRpb25hbCAmJiBldmVudFR5cGUgPT09IHVuZGVmaW5lZClcbiAgICAgICAgcmV0dXJuO1xuICAgIHN3aXRjaCAoZXZlbnRUeXBlKSB7XG4gICAgICAgIGNhc2UgJ3ZhbHVlJzpcbiAgICAgICAgY2FzZSAnY2hpbGRfYWRkZWQnOlxuICAgICAgICBjYXNlICdjaGlsZF9yZW1vdmVkJzpcbiAgICAgICAgY2FzZSAnY2hpbGRfY2hhbmdlZCc6XG4gICAgICAgIGNhc2UgJ2NoaWxkX21vdmVkJzpcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKHV0aWxfMy5lcnJvclByZWZpeChmbk5hbWUsIGFyZ3VtZW50TnVtYmVyLCBvcHRpb25hbCkgK1xuICAgICAgICAgICAgICAgICdtdXN0IGJlIGEgdmFsaWQgZXZlbnQgdHlwZSA9IFwidmFsdWVcIiwgXCJjaGlsZF9hZGRlZFwiLCBcImNoaWxkX3JlbW92ZWRcIiwgJyArXG4gICAgICAgICAgICAgICAgJ1wiY2hpbGRfY2hhbmdlZFwiLCBvciBcImNoaWxkX21vdmVkXCIuJyk7XG4gICAgfVxufTtcbmV4cG9ydHMudmFsaWRhdGVLZXkgPSBmdW5jdGlvbiAoZm5OYW1lLCBhcmd1bWVudE51bWJlciwga2V5LCBvcHRpb25hbCkge1xuICAgIGlmIChvcHRpb25hbCAmJiBrZXkgPT09IHVuZGVmaW5lZClcbiAgICAgICAgcmV0dXJuO1xuICAgIGlmICghZXhwb3J0cy5pc1ZhbGlkS2V5KGtleSkpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcih1dGlsXzMuZXJyb3JQcmVmaXgoZm5OYW1lLCBhcmd1bWVudE51bWJlciwgb3B0aW9uYWwpICtcbiAgICAgICAgICAgICd3YXMgYW4gaW52YWxpZCBrZXkgPSBcIicgK1xuICAgICAgICAgICAga2V5ICtcbiAgICAgICAgICAgICdcIi4gIEZpcmViYXNlIGtleXMgbXVzdCBiZSBub24tZW1wdHkgc3RyaW5ncyBhbmQgJyArXG4gICAgICAgICAgICAnY2FuXFwndCBjb250YWluIFwiLlwiLCBcIiNcIiwgXCIkXCIsIFwiL1wiLCBcIltcIiwgb3IgXCJdXCIpLicpO1xufTtcbmV4cG9ydHMudmFsaWRhdGVQYXRoU3RyaW5nID0gZnVuY3Rpb24gKGZuTmFtZSwgYXJndW1lbnROdW1iZXIsIHBhdGhTdHJpbmcsIG9wdGlvbmFsKSB7XG4gICAgaWYgKG9wdGlvbmFsICYmIHBhdGhTdHJpbmcgPT09IHVuZGVmaW5lZClcbiAgICAgICAgcmV0dXJuO1xuICAgIGlmICghZXhwb3J0cy5pc1ZhbGlkUGF0aFN0cmluZyhwYXRoU3RyaW5nKSlcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKHV0aWxfMy5lcnJvclByZWZpeChmbk5hbWUsIGFyZ3VtZW50TnVtYmVyLCBvcHRpb25hbCkgK1xuICAgICAgICAgICAgJ3dhcyBhbiBpbnZhbGlkIHBhdGggPSBcIicgK1xuICAgICAgICAgICAgcGF0aFN0cmluZyArXG4gICAgICAgICAgICAnXCIuIFBhdGhzIG11c3QgYmUgbm9uLWVtcHR5IHN0cmluZ3MgYW5kICcgK1xuICAgICAgICAgICAgJ2NhblxcJ3QgY29udGFpbiBcIi5cIiwgXCIjXCIsIFwiJFwiLCBcIltcIiwgb3IgXCJdXCInKTtcbn07XG5leHBvcnRzLnZhbGlkYXRlUm9vdFBhdGhTdHJpbmcgPSBmdW5jdGlvbiAoZm5OYW1lLCBhcmd1bWVudE51bWJlciwgcGF0aFN0cmluZywgb3B0aW9uYWwpIHtcbiAgICBpZiAocGF0aFN0cmluZykge1xuICAgICAgICAvLyBBbGxvdyAnLy5pbmZvLycgYXQgdGhlIGJlZ2lubmluZy5cbiAgICAgICAgcGF0aFN0cmluZyA9IHBhdGhTdHJpbmcucmVwbGFjZSgvXlxcLypcXC5pbmZvKFxcL3wkKS8sICcvJyk7XG4gICAgfVxuICAgIGV4cG9ydHMudmFsaWRhdGVQYXRoU3RyaW5nKGZuTmFtZSwgYXJndW1lbnROdW1iZXIsIHBhdGhTdHJpbmcsIG9wdGlvbmFsKTtcbn07XG5leHBvcnRzLnZhbGlkYXRlV3JpdGFibGVQYXRoID0gZnVuY3Rpb24gKGZuTmFtZSwgcGF0aCkge1xuICAgIGlmIChwYXRoLmdldEZyb250KCkgPT09ICcuaW5mbycpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGZuTmFtZSArIFwiIGZhaWxlZCA9IENhbid0IG1vZGlmeSBkYXRhIHVuZGVyIC8uaW5mby9cIik7XG4gICAgfVxufTtcbmV4cG9ydHMudmFsaWRhdGVVcmwgPSBmdW5jdGlvbiAoZm5OYW1lLCBhcmd1bWVudE51bWJlciwgcGFyc2VkVXJsKSB7XG4gICAgLy8gVE9ETyA9IFZhbGlkYXRlIHNlcnZlciBiZXR0ZXIuXG4gICAgdmFyIHBhdGhTdHJpbmcgPSBwYXJzZWRVcmwucGF0aC50b1N0cmluZygpO1xuICAgIGlmICghKHR5cGVvZiBwYXJzZWRVcmwucmVwb0luZm8uaG9zdCA9PT0gJ3N0cmluZycpIHx8XG4gICAgICAgIHBhcnNlZFVybC5yZXBvSW5mby5ob3N0Lmxlbmd0aCA9PT0gMCB8fFxuICAgICAgICAhZXhwb3J0cy5pc1ZhbGlkS2V5KHBhcnNlZFVybC5yZXBvSW5mby5uYW1lc3BhY2UpIHx8XG4gICAgICAgIChwYXRoU3RyaW5nLmxlbmd0aCAhPT0gMCAmJiAhZXhwb3J0cy5pc1ZhbGlkUm9vdFBhdGhTdHJpbmcocGF0aFN0cmluZykpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcih1dGlsXzMuZXJyb3JQcmVmaXgoZm5OYW1lLCBhcmd1bWVudE51bWJlciwgZmFsc2UpICtcbiAgICAgICAgICAgICdtdXN0IGJlIGEgdmFsaWQgZmlyZWJhc2UgVVJMIGFuZCAnICtcbiAgICAgICAgICAgICd0aGUgcGF0aCBjYW5cXCd0IGNvbnRhaW4gXCIuXCIsIFwiI1wiLCBcIiRcIiwgXCJbXCIsIG9yIFwiXVwiLicpO1xuICAgIH1cbn07XG5leHBvcnRzLnZhbGlkYXRlQ3JlZGVudGlhbCA9IGZ1bmN0aW9uIChmbk5hbWUsIGFyZ3VtZW50TnVtYmVyLCBjcmVkLCBvcHRpb25hbCkge1xuICAgIGlmIChvcHRpb25hbCAmJiBjcmVkID09PSB1bmRlZmluZWQpXG4gICAgICAgIHJldHVybjtcbiAgICBpZiAoISh0eXBlb2YgY3JlZCA9PT0gJ3N0cmluZycpKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IodXRpbF8zLmVycm9yUHJlZml4KGZuTmFtZSwgYXJndW1lbnROdW1iZXIsIG9wdGlvbmFsKSArXG4gICAgICAgICAgICAnbXVzdCBiZSBhIHZhbGlkIGNyZWRlbnRpYWwgKGEgc3RyaW5nKS4nKTtcbn07XG5leHBvcnRzLnZhbGlkYXRlQm9vbGVhbiA9IGZ1bmN0aW9uIChmbk5hbWUsIGFyZ3VtZW50TnVtYmVyLCBib29sLCBvcHRpb25hbCkge1xuICAgIGlmIChvcHRpb25hbCAmJiBib29sID09PSB1bmRlZmluZWQpXG4gICAgICAgIHJldHVybjtcbiAgICBpZiAodHlwZW9mIGJvb2wgIT09ICdib29sZWFuJylcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKHV0aWxfMy5lcnJvclByZWZpeChmbk5hbWUsIGFyZ3VtZW50TnVtYmVyLCBvcHRpb25hbCkgKyAnbXVzdCBiZSBhIGJvb2xlYW4uJyk7XG59O1xuZXhwb3J0cy52YWxpZGF0ZVN0cmluZyA9IGZ1bmN0aW9uIChmbk5hbWUsIGFyZ3VtZW50TnVtYmVyLCBzdHJpbmcsIG9wdGlvbmFsKSB7XG4gICAgaWYgKG9wdGlvbmFsICYmIHN0cmluZyA9PT0gdW5kZWZpbmVkKVxuICAgICAgICByZXR1cm47XG4gICAgaWYgKCEodHlwZW9mIHN0cmluZyA9PT0gJ3N0cmluZycpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcih1dGlsXzMuZXJyb3JQcmVmaXgoZm5OYW1lLCBhcmd1bWVudE51bWJlciwgb3B0aW9uYWwpICtcbiAgICAgICAgICAgICdtdXN0IGJlIGEgdmFsaWQgc3RyaW5nLicpO1xuICAgIH1cbn07XG5leHBvcnRzLnZhbGlkYXRlT2JqZWN0ID0gZnVuY3Rpb24gKGZuTmFtZSwgYXJndW1lbnROdW1iZXIsIG9iaiwgb3B0aW9uYWwpIHtcbiAgICBpZiAob3B0aW9uYWwgJiYgb2JqID09PSB1bmRlZmluZWQpXG4gICAgICAgIHJldHVybjtcbiAgICBpZiAoIShvYmogJiYgdHlwZW9mIG9iaiA9PT0gJ29iamVjdCcpIHx8IG9iaiA9PT0gbnVsbCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IodXRpbF8zLmVycm9yUHJlZml4KGZuTmFtZSwgYXJndW1lbnROdW1iZXIsIG9wdGlvbmFsKSArXG4gICAgICAgICAgICAnbXVzdCBiZSBhIHZhbGlkIG9iamVjdC4nKTtcbiAgICB9XG59O1xuZXhwb3J0cy52YWxpZGF0ZU9iamVjdENvbnRhaW5zS2V5ID0gZnVuY3Rpb24gKGZuTmFtZSwgYXJndW1lbnROdW1iZXIsIG9iaiwga2V5LCBvcHRpb25hbCwgb3B0X3R5cGUpIHtcbiAgICB2YXIgb2JqZWN0Q29udGFpbnNLZXkgPSBvYmogJiYgdHlwZW9mIG9iaiA9PT0gJ29iamVjdCcgJiYgdXRpbF8xLmNvbnRhaW5zKG9iaiwga2V5KTtcbiAgICBpZiAoIW9iamVjdENvbnRhaW5zS2V5KSB7XG4gICAgICAgIGlmIChvcHRpb25hbCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKHV0aWxfMy5lcnJvclByZWZpeChmbk5hbWUsIGFyZ3VtZW50TnVtYmVyLCBvcHRpb25hbCkgK1xuICAgICAgICAgICAgICAgICdtdXN0IGNvbnRhaW4gdGhlIGtleSBcIicgK1xuICAgICAgICAgICAgICAgIGtleSArXG4gICAgICAgICAgICAgICAgJ1wiJyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKG9wdF90eXBlKSB7XG4gICAgICAgIHZhciB2YWwgPSB1dGlsXzEuc2FmZUdldChvYmosIGtleSk7XG4gICAgICAgIGlmICgob3B0X3R5cGUgPT09ICdudW1iZXInICYmICEodHlwZW9mIHZhbCA9PT0gJ251bWJlcicpKSB8fFxuICAgICAgICAgICAgKG9wdF90eXBlID09PSAnc3RyaW5nJyAmJiAhKHR5cGVvZiB2YWwgPT09ICdzdHJpbmcnKSkgfHxcbiAgICAgICAgICAgIChvcHRfdHlwZSA9PT0gJ2Jvb2xlYW4nICYmICEodHlwZW9mIHZhbCA9PT0gJ2Jvb2xlYW4nKSkgfHxcbiAgICAgICAgICAgIChvcHRfdHlwZSA9PT0gJ2Z1bmN0aW9uJyAmJiAhKHR5cGVvZiB2YWwgPT09ICdmdW5jdGlvbicpKSB8fFxuICAgICAgICAgICAgKG9wdF90eXBlID09PSAnb2JqZWN0JyAmJiAhKHR5cGVvZiB2YWwgPT09ICdvYmplY3QnKSAmJiB2YWwpKSB7XG4gICAgICAgICAgICBpZiAob3B0aW9uYWwpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IodXRpbF8zLmVycm9yUHJlZml4KGZuTmFtZSwgYXJndW1lbnROdW1iZXIsIG9wdGlvbmFsKSArXG4gICAgICAgICAgICAgICAgICAgICdjb250YWlucyBpbnZhbGlkIHZhbHVlIGZvciBrZXkgXCInICtcbiAgICAgICAgICAgICAgICAgICAga2V5ICtcbiAgICAgICAgICAgICAgICAgICAgJ1wiIChtdXN0IGJlIG9mIHR5cGUgXCInICtcbiAgICAgICAgICAgICAgICAgICAgb3B0X3R5cGUgK1xuICAgICAgICAgICAgICAgICAgICAnXCIpJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IodXRpbF8zLmVycm9yUHJlZml4KGZuTmFtZSwgYXJndW1lbnROdW1iZXIsIG9wdGlvbmFsKSArXG4gICAgICAgICAgICAgICAgICAgICdtdXN0IGNvbnRhaW4gdGhlIGtleSBcIicgK1xuICAgICAgICAgICAgICAgICAgICBrZXkgK1xuICAgICAgICAgICAgICAgICAgICAnXCIgd2l0aCB0eXBlIFwiJyArXG4gICAgICAgICAgICAgICAgICAgIG9wdF90eXBlICtcbiAgICAgICAgICAgICAgICAgICAgJ1wiJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD12YWxpZGF0aW9uLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuLyoqXG4gKiBBIGNhY2hlIG5vZGUgb25seSBzdG9yZXMgY29tcGxldGUgY2hpbGRyZW4uIEFkZGl0aW9uYWxseSBpdCBob2xkcyBhIGZsYWcgd2hldGhlciB0aGUgbm9kZSBjYW4gYmUgY29uc2lkZXJlZCBmdWxseVxuICogaW5pdGlhbGl6ZWQgaW4gdGhlIHNlbnNlIHRoYXQgd2Uga25vdyBhdCBvbmUgcG9pbnQgaW4gdGltZSB0aGlzIHJlcHJlc2VudGVkIGEgdmFsaWQgc3RhdGUgb2YgdGhlIHdvcmxkLCBlLmcuXG4gKiBpbml0aWFsaXplZCB3aXRoIGRhdGEgZnJvbSB0aGUgc2VydmVyLCBvciBhIGNvbXBsZXRlIG92ZXJ3cml0ZSBieSB0aGUgY2xpZW50LiBUaGUgZmlsdGVyZWQgZmxhZyBhbHNvIHRyYWNrc1xuICogd2hldGhlciBhIG5vZGUgcG90ZW50aWFsbHkgaGFkIGNoaWxkcmVuIHJlbW92ZWQgZHVlIHRvIGEgZmlsdGVyLlxuICovXG52YXIgQ2FjaGVOb2RlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7IU5vZGV9IG5vZGVfXG4gICAgICogQHBhcmFtIHtib29sZWFufSBmdWxseUluaXRpYWxpemVkX1xuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gZmlsdGVyZWRfXG4gICAgICovXG4gICAgZnVuY3Rpb24gQ2FjaGVOb2RlKG5vZGVfLCBmdWxseUluaXRpYWxpemVkXywgZmlsdGVyZWRfKSB7XG4gICAgICAgIHRoaXMubm9kZV8gPSBub2RlXztcbiAgICAgICAgdGhpcy5mdWxseUluaXRpYWxpemVkXyA9IGZ1bGx5SW5pdGlhbGl6ZWRfO1xuICAgICAgICB0aGlzLmZpbHRlcmVkXyA9IGZpbHRlcmVkXztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB3aGV0aGVyIHRoaXMgbm9kZSB3YXMgZnVsbHkgaW5pdGlhbGl6ZWQgd2l0aCBlaXRoZXIgc2VydmVyIGRhdGEgb3IgYSBjb21wbGV0ZSBvdmVyd3JpdGUgYnkgdGhlIGNsaWVudFxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAgICovXG4gICAgQ2FjaGVOb2RlLnByb3RvdHlwZS5pc0Z1bGx5SW5pdGlhbGl6ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZ1bGx5SW5pdGlhbGl6ZWRfO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB3aGV0aGVyIHRoaXMgbm9kZSBpcyBwb3RlbnRpYWxseSBtaXNzaW5nIGNoaWxkcmVuIGR1ZSB0byBhIGZpbHRlciBhcHBsaWVkIHRvIHRoZSBub2RlXG4gICAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBDYWNoZU5vZGUucHJvdG90eXBlLmlzRmlsdGVyZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpbHRlcmVkXztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7IVBhdGh9IHBhdGhcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgICAqL1xuICAgIENhY2hlTm9kZS5wcm90b3R5cGUuaXNDb21wbGV0ZUZvclBhdGggPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICBpZiAocGF0aC5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmlzRnVsbHlJbml0aWFsaXplZCgpICYmICF0aGlzLmZpbHRlcmVkXztcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2hpbGRLZXkgPSBwYXRoLmdldEZyb250KCk7XG4gICAgICAgIHJldHVybiB0aGlzLmlzQ29tcGxldGVGb3JDaGlsZChjaGlsZEtleSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFzdHJpbmd9IGtleVxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAgICovXG4gICAgQ2FjaGVOb2RlLnByb3RvdHlwZS5pc0NvbXBsZXRlRm9yQ2hpbGQgPSBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIHJldHVybiAoKHRoaXMuaXNGdWxseUluaXRpYWxpemVkKCkgJiYgIXRoaXMuZmlsdGVyZWRfKSB8fCB0aGlzLm5vZGVfLmhhc0NoaWxkKGtleSkpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7IU5vZGV9XG4gICAgICovXG4gICAgQ2FjaGVOb2RlLnByb3RvdHlwZS5nZXROb2RlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ub2RlXztcbiAgICB9O1xuICAgIHJldHVybiBDYWNoZU5vZGU7XG59KCkpO1xuZXhwb3J0cy5DYWNoZU5vZGUgPSBDYWNoZU5vZGU7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNhY2hlTm9kZS5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAc3RydWN0XG4gKiBAcGFyYW0geyFzdHJpbmd9IHR5cGUgVGhlIGV2ZW50IHR5cGVcbiAqIEBwYXJhbSB7IU5vZGV9IHNuYXBzaG90Tm9kZSBUaGUgZGF0YVxuICogQHBhcmFtIHtzdHJpbmc9fSBjaGlsZE5hbWUgVGhlIG5hbWUgZm9yIHRoaXMgY2hpbGQsIGlmIGl0J3MgYSBjaGlsZCBldmVudFxuICogQHBhcmFtIHtOb2RlPX0gb2xkU25hcCBVc2VkIGZvciBpbnRlcm1lZGlhdGUgcHJvY2Vzc2luZyBvZiBjaGlsZCBjaGFuZ2VkIGV2ZW50c1xuICogQHBhcmFtIHtzdHJpbmc9fSBwcmV2TmFtZSBUaGUgbmFtZSBmb3IgdGhlIHByZXZpb3VzIGNoaWxkLCBpZiBhcHBsaWNhYmxlXG4gKi9cbnZhciBDaGFuZ2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ2hhbmdlKHR5cGUsIHNuYXBzaG90Tm9kZSwgY2hpbGROYW1lLCBvbGRTbmFwLCBwcmV2TmFtZSkge1xuICAgICAgICB0aGlzLnR5cGUgPSB0eXBlO1xuICAgICAgICB0aGlzLnNuYXBzaG90Tm9kZSA9IHNuYXBzaG90Tm9kZTtcbiAgICAgICAgdGhpcy5jaGlsZE5hbWUgPSBjaGlsZE5hbWU7XG4gICAgICAgIHRoaXMub2xkU25hcCA9IG9sZFNuYXA7XG4gICAgICAgIHRoaXMucHJldk5hbWUgPSBwcmV2TmFtZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshTm9kZX0gc25hcHNob3RcbiAgICAgKiBAcmV0dXJuIHshQ2hhbmdlfVxuICAgICAqL1xuICAgIENoYW5nZS52YWx1ZUNoYW5nZSA9IGZ1bmN0aW9uIChzbmFwc2hvdCkge1xuICAgICAgICByZXR1cm4gbmV3IENoYW5nZShDaGFuZ2UuVkFMVUUsIHNuYXBzaG90KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBjaGlsZEtleVxuICAgICAqIEBwYXJhbSB7IU5vZGV9IHNuYXBzaG90XG4gICAgICogQHJldHVybiB7IUNoYW5nZX1cbiAgICAgKi9cbiAgICBDaGFuZ2UuY2hpbGRBZGRlZENoYW5nZSA9IGZ1bmN0aW9uIChjaGlsZEtleSwgc25hcHNob3QpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBDaGFuZ2UoQ2hhbmdlLkNISUxEX0FEREVELCBzbmFwc2hvdCwgY2hpbGRLZXkpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGNoaWxkS2V5XG4gICAgICogQHBhcmFtIHshTm9kZX0gc25hcHNob3RcbiAgICAgKiBAcmV0dXJuIHshQ2hhbmdlfVxuICAgICAqL1xuICAgIENoYW5nZS5jaGlsZFJlbW92ZWRDaGFuZ2UgPSBmdW5jdGlvbiAoY2hpbGRLZXksIHNuYXBzaG90KSB7XG4gICAgICAgIHJldHVybiBuZXcgQ2hhbmdlKENoYW5nZS5DSElMRF9SRU1PVkVELCBzbmFwc2hvdCwgY2hpbGRLZXkpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGNoaWxkS2V5XG4gICAgICogQHBhcmFtIHshTm9kZX0gbmV3U25hcHNob3RcbiAgICAgKiBAcGFyYW0geyFOb2RlfSBvbGRTbmFwc2hvdFxuICAgICAqIEByZXR1cm4geyFDaGFuZ2V9XG4gICAgICovXG4gICAgQ2hhbmdlLmNoaWxkQ2hhbmdlZENoYW5nZSA9IGZ1bmN0aW9uIChjaGlsZEtleSwgbmV3U25hcHNob3QsIG9sZFNuYXBzaG90KSB7XG4gICAgICAgIHJldHVybiBuZXcgQ2hhbmdlKENoYW5nZS5DSElMRF9DSEFOR0VELCBuZXdTbmFwc2hvdCwgY2hpbGRLZXksIG9sZFNuYXBzaG90KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBjaGlsZEtleVxuICAgICAqIEBwYXJhbSB7IU5vZGV9IHNuYXBzaG90XG4gICAgICogQHJldHVybiB7IUNoYW5nZX1cbiAgICAgKi9cbiAgICBDaGFuZ2UuY2hpbGRNb3ZlZENoYW5nZSA9IGZ1bmN0aW9uIChjaGlsZEtleSwgc25hcHNob3QpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBDaGFuZ2UoQ2hhbmdlLkNISUxEX01PVkVELCBzbmFwc2hvdCwgY2hpbGRLZXkpO1xuICAgIH07XG4gICAgLy9ldmVudCB0eXBlc1xuICAgIC8qKiBFdmVudCB0eXBlIGZvciBhIGNoaWxkIGFkZGVkICovXG4gICAgQ2hhbmdlLkNISUxEX0FEREVEID0gJ2NoaWxkX2FkZGVkJztcbiAgICAvKiogRXZlbnQgdHlwZSBmb3IgYSBjaGlsZCByZW1vdmVkICovXG4gICAgQ2hhbmdlLkNISUxEX1JFTU9WRUQgPSAnY2hpbGRfcmVtb3ZlZCc7XG4gICAgLyoqIEV2ZW50IHR5cGUgZm9yIGEgY2hpbGQgY2hhbmdlZCAqL1xuICAgIENoYW5nZS5DSElMRF9DSEFOR0VEID0gJ2NoaWxkX2NoYW5nZWQnO1xuICAgIC8qKiBFdmVudCB0eXBlIGZvciBhIGNoaWxkIG1vdmVkICovXG4gICAgQ2hhbmdlLkNISUxEX01PVkVEID0gJ2NoaWxkX21vdmVkJztcbiAgICAvKiogRXZlbnQgdHlwZSBmb3IgYSB2YWx1ZSBjaGFuZ2UgKi9cbiAgICBDaGFuZ2UuVkFMVUUgPSAndmFsdWUnO1xuICAgIHJldHVybiBDaGFuZ2U7XG59KCkpO1xuZXhwb3J0cy5DaGFuZ2UgPSBDaGFuZ2U7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNoYW5nZS5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB1dGlsXzEgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG52YXIgQ2hhbmdlXzEgPSByZXF1aXJlKFwiLi9DaGFuZ2VcIik7XG52YXIgdXRpbF8yID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqL1xudmFyIENoaWxkQ2hhbmdlQWNjdW11bGF0b3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ2hpbGRDaGFuZ2VBY2N1bXVsYXRvcigpIHtcbiAgICAgICAgdGhpcy5jaGFuZ2VNYXBfID0ge307XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7IUNoYW5nZX0gY2hhbmdlXG4gICAgICovXG4gICAgQ2hpbGRDaGFuZ2VBY2N1bXVsYXRvci5wcm90b3R5cGUudHJhY2tDaGlsZENoYW5nZSA9IGZ1bmN0aW9uIChjaGFuZ2UpIHtcbiAgICAgICAgdmFyIHR5cGUgPSBjaGFuZ2UudHlwZTtcbiAgICAgICAgdmFyIGNoaWxkS2V5IC8qKiBAdHlwZSB7IXN0cmluZ30gKi8gPSBjaGFuZ2UuY2hpbGROYW1lO1xuICAgICAgICB1dGlsXzIuYXNzZXJ0KHR5cGUgPT0gQ2hhbmdlXzEuQ2hhbmdlLkNISUxEX0FEREVEIHx8XG4gICAgICAgICAgICB0eXBlID09IENoYW5nZV8xLkNoYW5nZS5DSElMRF9DSEFOR0VEIHx8XG4gICAgICAgICAgICB0eXBlID09IENoYW5nZV8xLkNoYW5nZS5DSElMRF9SRU1PVkVELCAnT25seSBjaGlsZCBjaGFuZ2VzIHN1cHBvcnRlZCBmb3IgdHJhY2tpbmcnKTtcbiAgICAgICAgdXRpbF8yLmFzc2VydChjaGlsZEtleSAhPT0gJy5wcmlvcml0eScsICdPbmx5IG5vbi1wcmlvcml0eSBjaGlsZCBjaGFuZ2VzIGNhbiBiZSB0cmFja2VkLicpO1xuICAgICAgICB2YXIgb2xkQ2hhbmdlID0gdXRpbF8xLnNhZmVHZXQodGhpcy5jaGFuZ2VNYXBfLCBjaGlsZEtleSk7XG4gICAgICAgIGlmIChvbGRDaGFuZ2UpIHtcbiAgICAgICAgICAgIHZhciBvbGRUeXBlID0gb2xkQ2hhbmdlLnR5cGU7XG4gICAgICAgICAgICBpZiAodHlwZSA9PSBDaGFuZ2VfMS5DaGFuZ2UuQ0hJTERfQURERUQgJiYgb2xkVHlwZSA9PSBDaGFuZ2VfMS5DaGFuZ2UuQ0hJTERfUkVNT1ZFRCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2hhbmdlTWFwX1tjaGlsZEtleV0gPSBDaGFuZ2VfMS5DaGFuZ2UuY2hpbGRDaGFuZ2VkQ2hhbmdlKGNoaWxkS2V5LCBjaGFuZ2Uuc25hcHNob3ROb2RlLCBvbGRDaGFuZ2Uuc25hcHNob3ROb2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGUgPT0gQ2hhbmdlXzEuQ2hhbmdlLkNISUxEX1JFTU9WRUQgJiZcbiAgICAgICAgICAgICAgICBvbGRUeXBlID09IENoYW5nZV8xLkNoYW5nZS5DSElMRF9BRERFRCkge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmNoYW5nZU1hcF9bY2hpbGRLZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodHlwZSA9PSBDaGFuZ2VfMS5DaGFuZ2UuQ0hJTERfUkVNT1ZFRCAmJlxuICAgICAgICAgICAgICAgIG9sZFR5cGUgPT0gQ2hhbmdlXzEuQ2hhbmdlLkNISUxEX0NIQU5HRUQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNoYW5nZU1hcF9bY2hpbGRLZXldID0gQ2hhbmdlXzEuQ2hhbmdlLmNoaWxkUmVtb3ZlZENoYW5nZShjaGlsZEtleSwgb2xkQ2hhbmdlLm9sZFNuYXApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodHlwZSA9PSBDaGFuZ2VfMS5DaGFuZ2UuQ0hJTERfQ0hBTkdFRCAmJlxuICAgICAgICAgICAgICAgIG9sZFR5cGUgPT0gQ2hhbmdlXzEuQ2hhbmdlLkNISUxEX0FEREVEKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jaGFuZ2VNYXBfW2NoaWxkS2V5XSA9IENoYW5nZV8xLkNoYW5nZS5jaGlsZEFkZGVkQ2hhbmdlKGNoaWxkS2V5LCBjaGFuZ2Uuc25hcHNob3ROb2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGUgPT0gQ2hhbmdlXzEuQ2hhbmdlLkNISUxEX0NIQU5HRUQgJiZcbiAgICAgICAgICAgICAgICBvbGRUeXBlID09IENoYW5nZV8xLkNoYW5nZS5DSElMRF9DSEFOR0VEKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jaGFuZ2VNYXBfW2NoaWxkS2V5XSA9IENoYW5nZV8xLkNoYW5nZS5jaGlsZENoYW5nZWRDaGFuZ2UoY2hpbGRLZXksIGNoYW5nZS5zbmFwc2hvdE5vZGUsIG9sZENoYW5nZS5vbGRTbmFwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IHV0aWxfMi5hc3NlcnRpb25FcnJvcignSWxsZWdhbCBjb21iaW5hdGlvbiBvZiBjaGFuZ2VzOiAnICtcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlICtcbiAgICAgICAgICAgICAgICAgICAgJyBvY2N1cnJlZCBhZnRlciAnICtcbiAgICAgICAgICAgICAgICAgICAgb2xkQ2hhbmdlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlTWFwX1tjaGlsZEtleV0gPSBjaGFuZ2U7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4geyFBcnJheS48IUNoYW5nZT59XG4gICAgICovXG4gICAgQ2hpbGRDaGFuZ2VBY2N1bXVsYXRvci5wcm90b3R5cGUuZ2V0Q2hhbmdlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHV0aWxfMS5nZXRWYWx1ZXModGhpcy5jaGFuZ2VNYXBfKTtcbiAgICB9O1xuICAgIHJldHVybiBDaGlsZENoYW5nZUFjY3VtdWxhdG9yO1xufSgpKTtcbmV4cG9ydHMuQ2hpbGRDaGFuZ2VBY2N1bXVsYXRvciA9IENoaWxkQ2hhbmdlQWNjdW11bGF0b3I7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNoaWxkQ2hhbmdlQWNjdW11bGF0b3IuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgQ2FjaGVOb2RlXzEgPSByZXF1aXJlKFwiLi9DYWNoZU5vZGVcIik7XG4vKipcbiAqIEFuIGltcGxlbWVudGF0aW9uIG9mIENvbXBsZXRlQ2hpbGRTb3VyY2UgdGhhdCBuZXZlciByZXR1cm5zIGFueSBhZGRpdGlvbmFsIGNoaWxkcmVuXG4gKlxuICogQHByaXZhdGVcbiAqIEBjb25zdHJ1Y3RvclxuICogQGltcGxlbWVudHMgQ29tcGxldGVDaGlsZFNvdXJjZVxuICovXG52YXIgTm9Db21wbGV0ZUNoaWxkU291cmNlXyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBOb0NvbXBsZXRlQ2hpbGRTb3VyY2VfKCkge1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIE5vQ29tcGxldGVDaGlsZFNvdXJjZV8ucHJvdG90eXBlLmdldENvbXBsZXRlQ2hpbGQgPSBmdW5jdGlvbiAoY2hpbGRLZXkpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIE5vQ29tcGxldGVDaGlsZFNvdXJjZV8ucHJvdG90eXBlLmdldENoaWxkQWZ0ZXJDaGlsZCA9IGZ1bmN0aW9uIChpbmRleCwgY2hpbGQsIHJldmVyc2UpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICByZXR1cm4gTm9Db21wbGV0ZUNoaWxkU291cmNlXztcbn0oKSk7XG5leHBvcnRzLk5vQ29tcGxldGVDaGlsZFNvdXJjZV8gPSBOb0NvbXBsZXRlQ2hpbGRTb3VyY2VfO1xuLyoqXG4gKiBTaW5nbGV0b24gaW5zdGFuY2UuXG4gKiBAY29uc3RcbiAqIEB0eXBlIHshQ29tcGxldGVDaGlsZFNvdXJjZX1cbiAqL1xuZXhwb3J0cy5OT19DT01QTEVURV9DSElMRF9TT1VSQ0UgPSBuZXcgTm9Db21wbGV0ZUNoaWxkU291cmNlXygpO1xuLyoqXG4gKiBBbiBpbXBsZW1lbnRhdGlvbiBvZiBDb21wbGV0ZUNoaWxkU291cmNlIHRoYXQgdXNlcyBhIFdyaXRlVHJlZSBpbiBhZGRpdGlvbiB0byBhbnkgb3RoZXIgc2VydmVyIGRhdGEgb3JcbiAqIG9sZCBldmVudCBjYWNoZXMgYXZhaWxhYmxlIHRvIGNhbGN1bGF0ZSBjb21wbGV0ZSBjaGlsZHJlbi5cbiAqXG4gKlxuICogQGltcGxlbWVudHMgQ29tcGxldGVDaGlsZFNvdXJjZVxuICovXG52YXIgV3JpdGVUcmVlQ29tcGxldGVDaGlsZFNvdXJjZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFXcml0ZVRyZWVSZWZ9IHdyaXRlc19cbiAgICAgKiBAcGFyYW0geyFWaWV3Q2FjaGV9IHZpZXdDYWNoZV9cbiAgICAgKiBAcGFyYW0gez9Ob2RlfSBvcHRDb21wbGV0ZVNlcnZlckNhY2hlX1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIFdyaXRlVHJlZUNvbXBsZXRlQ2hpbGRTb3VyY2Uod3JpdGVzXywgdmlld0NhY2hlXywgb3B0Q29tcGxldGVTZXJ2ZXJDYWNoZV8pIHtcbiAgICAgICAgaWYgKG9wdENvbXBsZXRlU2VydmVyQ2FjaGVfID09PSB2b2lkIDApIHsgb3B0Q29tcGxldGVTZXJ2ZXJDYWNoZV8gPSBudWxsOyB9XG4gICAgICAgIHRoaXMud3JpdGVzXyA9IHdyaXRlc187XG4gICAgICAgIHRoaXMudmlld0NhY2hlXyA9IHZpZXdDYWNoZV87XG4gICAgICAgIHRoaXMub3B0Q29tcGxldGVTZXJ2ZXJDYWNoZV8gPSBvcHRDb21wbGV0ZVNlcnZlckNhY2hlXztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBXcml0ZVRyZWVDb21wbGV0ZUNoaWxkU291cmNlLnByb3RvdHlwZS5nZXRDb21wbGV0ZUNoaWxkID0gZnVuY3Rpb24gKGNoaWxkS2V5KSB7XG4gICAgICAgIHZhciBub2RlID0gdGhpcy52aWV3Q2FjaGVfLmdldEV2ZW50Q2FjaGUoKTtcbiAgICAgICAgaWYgKG5vZGUuaXNDb21wbGV0ZUZvckNoaWxkKGNoaWxkS2V5KSkge1xuICAgICAgICAgICAgcmV0dXJuIG5vZGUuZ2V0Tm9kZSgpLmdldEltbWVkaWF0ZUNoaWxkKGNoaWxkS2V5KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBzZXJ2ZXJOb2RlID0gdGhpcy5vcHRDb21wbGV0ZVNlcnZlckNhY2hlXyAhPSBudWxsXG4gICAgICAgICAgICAgICAgPyBuZXcgQ2FjaGVOb2RlXzEuQ2FjaGVOb2RlKHRoaXMub3B0Q29tcGxldGVTZXJ2ZXJDYWNoZV8sIHRydWUsIGZhbHNlKVxuICAgICAgICAgICAgICAgIDogdGhpcy52aWV3Q2FjaGVfLmdldFNlcnZlckNhY2hlKCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy53cml0ZXNfLmNhbGNDb21wbGV0ZUNoaWxkKGNoaWxkS2V5LCBzZXJ2ZXJOb2RlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBXcml0ZVRyZWVDb21wbGV0ZUNoaWxkU291cmNlLnByb3RvdHlwZS5nZXRDaGlsZEFmdGVyQ2hpbGQgPSBmdW5jdGlvbiAoaW5kZXgsIGNoaWxkLCByZXZlcnNlKSB7XG4gICAgICAgIHZhciBjb21wbGV0ZVNlcnZlckRhdGEgPSB0aGlzLm9wdENvbXBsZXRlU2VydmVyQ2FjaGVfICE9IG51bGxcbiAgICAgICAgICAgID8gdGhpcy5vcHRDb21wbGV0ZVNlcnZlckNhY2hlX1xuICAgICAgICAgICAgOiB0aGlzLnZpZXdDYWNoZV8uZ2V0Q29tcGxldGVTZXJ2ZXJTbmFwKCk7XG4gICAgICAgIHZhciBub2RlcyA9IHRoaXMud3JpdGVzXy5jYWxjSW5kZXhlZFNsaWNlKGNvbXBsZXRlU2VydmVyRGF0YSwgY2hpbGQsIDEsIHJldmVyc2UsIGluZGV4KTtcbiAgICAgICAgaWYgKG5vZGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbm9kZXNbMF07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBXcml0ZVRyZWVDb21wbGV0ZUNoaWxkU291cmNlO1xufSgpKTtcbmV4cG9ydHMuV3JpdGVUcmVlQ29tcGxldGVDaGlsZFNvdXJjZSA9IFdyaXRlVHJlZUNvbXBsZXRlQ2hpbGRTb3VyY2U7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNvbXBsZXRlQ2hpbGRTb3VyY2UuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdXRpbF8xID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xuLyoqXG4gKiBFbmNhcHN1bGF0ZXMgdGhlIGRhdGEgbmVlZGVkIHRvIHJhaXNlIGFuIGV2ZW50XG4gKiBAaW1wbGVtZW50cyB7RXZlbnR9XG4gKi9cbnZhciBEYXRhRXZlbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshc3RyaW5nfSBldmVudFR5cGUgT25lIG9mOiB2YWx1ZSwgY2hpbGRfYWRkZWQsIGNoaWxkX2NoYW5nZWQsIGNoaWxkX21vdmVkLCBjaGlsZF9yZW1vdmVkXG4gICAgICogQHBhcmFtIHshRXZlbnRSZWdpc3RyYXRpb259IGV2ZW50UmVnaXN0cmF0aW9uIFRoZSBmdW5jdGlvbiB0byBjYWxsIHRvIHdpdGggdGhlIGV2ZW50IGRhdGEuIFVzZXIgcHJvdmlkZWRcbiAgICAgKiBAcGFyYW0geyFEYXRhU25hcHNob3R9IHNuYXBzaG90IFRoZSBkYXRhIGJhY2tpbmcgdGhlIGV2ZW50XG4gICAgICogQHBhcmFtIHs/c3RyaW5nPX0gcHJldk5hbWUgT3B0aW9uYWwsIHRoZSBuYW1lIG9mIHRoZSBwcmV2aW91cyBjaGlsZCBmb3IgY2hpbGRfKiBldmVudHMuXG4gICAgICovXG4gICAgZnVuY3Rpb24gRGF0YUV2ZW50KGV2ZW50VHlwZSwgZXZlbnRSZWdpc3RyYXRpb24sIHNuYXBzaG90LCBwcmV2TmFtZSkge1xuICAgICAgICB0aGlzLmV2ZW50VHlwZSA9IGV2ZW50VHlwZTtcbiAgICAgICAgdGhpcy5ldmVudFJlZ2lzdHJhdGlvbiA9IGV2ZW50UmVnaXN0cmF0aW9uO1xuICAgICAgICB0aGlzLnNuYXBzaG90ID0gc25hcHNob3Q7XG4gICAgICAgIHRoaXMucHJldk5hbWUgPSBwcmV2TmFtZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBEYXRhRXZlbnQucHJvdG90eXBlLmdldFBhdGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciByZWYgPSB0aGlzLnNuYXBzaG90LmdldFJlZigpO1xuICAgICAgICBpZiAodGhpcy5ldmVudFR5cGUgPT09ICd2YWx1ZScpIHtcbiAgICAgICAgICAgIHJldHVybiByZWYucGF0aDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiByZWYuZ2V0UGFyZW50KCkucGF0aDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBEYXRhRXZlbnQucHJvdG90eXBlLmdldEV2ZW50VHlwZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXZlbnRUeXBlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBEYXRhRXZlbnQucHJvdG90eXBlLmdldEV2ZW50UnVubmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ldmVudFJlZ2lzdHJhdGlvbi5nZXRFdmVudFJ1bm5lcih0aGlzKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgRGF0YUV2ZW50LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLmdldFBhdGgoKS50b1N0cmluZygpICtcbiAgICAgICAgICAgICc6JyArXG4gICAgICAgICAgICB0aGlzLmV2ZW50VHlwZSArXG4gICAgICAgICAgICAnOicgK1xuICAgICAgICAgICAgdXRpbF8xLnN0cmluZ2lmeSh0aGlzLnNuYXBzaG90LmV4cG9ydFZhbCgpKSk7XG4gICAgfTtcbiAgICByZXR1cm4gRGF0YUV2ZW50O1xufSgpKTtcbmV4cG9ydHMuRGF0YUV2ZW50ID0gRGF0YUV2ZW50O1xudmFyIENhbmNlbEV2ZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7RXZlbnRSZWdpc3RyYXRpb259IGV2ZW50UmVnaXN0cmF0aW9uXG4gICAgICogQHBhcmFtIHtFcnJvcn0gZXJyb3JcbiAgICAgKiBAcGFyYW0geyFQYXRofSBwYXRoXG4gICAgICovXG4gICAgZnVuY3Rpb24gQ2FuY2VsRXZlbnQoZXZlbnRSZWdpc3RyYXRpb24sIGVycm9yLCBwYXRoKSB7XG4gICAgICAgIHRoaXMuZXZlbnRSZWdpc3RyYXRpb24gPSBldmVudFJlZ2lzdHJhdGlvbjtcbiAgICAgICAgdGhpcy5lcnJvciA9IGVycm9yO1xuICAgICAgICB0aGlzLnBhdGggPSBwYXRoO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIENhbmNlbEV2ZW50LnByb3RvdHlwZS5nZXRQYXRoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXRoO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBDYW5jZWxFdmVudC5wcm90b3R5cGUuZ2V0RXZlbnRUeXBlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gJ2NhbmNlbCc7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIENhbmNlbEV2ZW50LnByb3RvdHlwZS5nZXRFdmVudFJ1bm5lciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXZlbnRSZWdpc3RyYXRpb24uZ2V0RXZlbnRSdW5uZXIodGhpcyk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIENhbmNlbEV2ZW50LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGF0aC50b1N0cmluZygpICsgJzpjYW5jZWwnO1xuICAgIH07XG4gICAgcmV0dXJuIENhbmNlbEV2ZW50O1xufSgpKTtcbmV4cG9ydHMuQ2FuY2VsRXZlbnQgPSBDYW5jZWxFdmVudDtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9RXZlbnQuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgTm9kZV8xID0gcmVxdWlyZShcIi4uL3NuYXAvTm9kZVwiKTtcbnZhciBDaGFuZ2VfMSA9IHJlcXVpcmUoXCIuL0NoYW5nZVwiKTtcbnZhciB1dGlsXzEgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG4vKipcbiAqIEFuIEV2ZW50R2VuZXJhdG9yIGlzIHVzZWQgdG8gY29udmVydCBcInJhd1wiIGNoYW5nZXMgKENoYW5nZSkgYXMgY29tcHV0ZWQgYnkgdGhlXG4gKiBDYWNoZURpZmZlciBpbnRvIGFjdHVhbCBldmVudHMgKEV2ZW50KSB0aGF0IGNhbiBiZSByYWlzZWQuICBTZWUgZ2VuZXJhdGVFdmVudHNGb3JDaGFuZ2VzKClcbiAqIGZvciBkZXRhaWxzLlxuICpcbiAqIEBjb25zdHJ1Y3RvclxuICovXG52YXIgRXZlbnRHZW5lcmF0b3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyFRdWVyeX0gcXVlcnlfXG4gICAgICovXG4gICAgZnVuY3Rpb24gRXZlbnRHZW5lcmF0b3IocXVlcnlfKSB7XG4gICAgICAgIHRoaXMucXVlcnlfID0gcXVlcnlfO1xuICAgICAgICAvKipcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQHR5cGUgeyFJbmRleH1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaW5kZXhfID0gdGhpcy5xdWVyeV8uZ2V0UXVlcnlQYXJhbXMoKS5nZXRJbmRleCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHaXZlbiBhIHNldCBvZiByYXcgY2hhbmdlcyAobm8gbW92ZWQgZXZlbnRzIGFuZCBwcmV2TmFtZSBub3Qgc3BlY2lmaWVkIHlldCksIGFuZCBhIHNldCBvZlxuICAgICAqIEV2ZW50UmVnaXN0cmF0aW9ucyB0aGF0IHNob3VsZCBiZSBub3RpZmllZCBvZiB0aGVzZSBjaGFuZ2VzLCBnZW5lcmF0ZSB0aGUgYWN0dWFsIGV2ZW50cyB0byBiZSByYWlzZWQuXG4gICAgICpcbiAgICAgKiBOb3RlczpcbiAgICAgKiAgLSBjaGlsZF9tb3ZlZCBldmVudHMgd2lsbCBiZSBzeW50aGVzaXplZCBhdCB0aGlzIHRpbWUgZm9yIGFueSBjaGlsZF9jaGFuZ2VkIGV2ZW50cyB0aGF0IGFmZmVjdFxuICAgICAqICAgIG91ciBpbmRleC5cbiAgICAgKiAgLSBwcmV2TmFtZSB3aWxsIGJlIGNhbGN1bGF0ZWQgYmFzZWQgb24gdGhlIGluZGV4IG9yZGVyaW5nLlxuICAgICAqXG4gICAgICogQHBhcmFtIHshQXJyYXkuPCFDaGFuZ2U+fSBjaGFuZ2VzXG4gICAgICogQHBhcmFtIHshTm9kZX0gZXZlbnRDYWNoZVxuICAgICAqIEBwYXJhbSB7IUFycmF5LjwhRXZlbnRSZWdpc3RyYXRpb24+fSBldmVudFJlZ2lzdHJhdGlvbnNcbiAgICAgKiBAcmV0dXJuIHshQXJyYXkuPCFFdmVudD59XG4gICAgICovXG4gICAgRXZlbnRHZW5lcmF0b3IucHJvdG90eXBlLmdlbmVyYXRlRXZlbnRzRm9yQ2hhbmdlcyA9IGZ1bmN0aW9uIChjaGFuZ2VzLCBldmVudENhY2hlLCBldmVudFJlZ2lzdHJhdGlvbnMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGV2ZW50cyA9IFtdO1xuICAgICAgICB2YXIgbW92ZXMgPSBbXTtcbiAgICAgICAgY2hhbmdlcy5mb3JFYWNoKGZ1bmN0aW9uIChjaGFuZ2UpIHtcbiAgICAgICAgICAgIGlmIChjaGFuZ2UudHlwZSA9PT0gQ2hhbmdlXzEuQ2hhbmdlLkNISUxEX0NIQU5HRUQgJiZcbiAgICAgICAgICAgICAgICBfdGhpcy5pbmRleF8uaW5kZXhlZFZhbHVlQ2hhbmdlZChjaGFuZ2Uub2xkU25hcCwgY2hhbmdlLnNuYXBzaG90Tm9kZSkpIHtcbiAgICAgICAgICAgICAgICBtb3Zlcy5wdXNoKENoYW5nZV8xLkNoYW5nZS5jaGlsZE1vdmVkQ2hhbmdlKGNoYW5nZS5jaGlsZE5hbWUsIGNoYW5nZS5zbmFwc2hvdE5vZGUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZ2VuZXJhdGVFdmVudHNGb3JUeXBlXyhldmVudHMsIENoYW5nZV8xLkNoYW5nZS5DSElMRF9SRU1PVkVELCBjaGFuZ2VzLCBldmVudFJlZ2lzdHJhdGlvbnMsIGV2ZW50Q2FjaGUpO1xuICAgICAgICB0aGlzLmdlbmVyYXRlRXZlbnRzRm9yVHlwZV8oZXZlbnRzLCBDaGFuZ2VfMS5DaGFuZ2UuQ0hJTERfQURERUQsIGNoYW5nZXMsIGV2ZW50UmVnaXN0cmF0aW9ucywgZXZlbnRDYWNoZSk7XG4gICAgICAgIHRoaXMuZ2VuZXJhdGVFdmVudHNGb3JUeXBlXyhldmVudHMsIENoYW5nZV8xLkNoYW5nZS5DSElMRF9NT1ZFRCwgbW92ZXMsIGV2ZW50UmVnaXN0cmF0aW9ucywgZXZlbnRDYWNoZSk7XG4gICAgICAgIHRoaXMuZ2VuZXJhdGVFdmVudHNGb3JUeXBlXyhldmVudHMsIENoYW5nZV8xLkNoYW5nZS5DSElMRF9DSEFOR0VELCBjaGFuZ2VzLCBldmVudFJlZ2lzdHJhdGlvbnMsIGV2ZW50Q2FjaGUpO1xuICAgICAgICB0aGlzLmdlbmVyYXRlRXZlbnRzRm9yVHlwZV8oZXZlbnRzLCBDaGFuZ2VfMS5DaGFuZ2UuVkFMVUUsIGNoYW5nZXMsIGV2ZW50UmVnaXN0cmF0aW9ucywgZXZlbnRDYWNoZSk7XG4gICAgICAgIHJldHVybiBldmVudHM7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHaXZlbiBjaGFuZ2VzIG9mIGEgc2luZ2xlIGNoYW5nZSB0eXBlLCBnZW5lcmF0ZSB0aGUgY29ycmVzcG9uZGluZyBldmVudHMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyFBcnJheS48IUV2ZW50Pn0gZXZlbnRzXG4gICAgICogQHBhcmFtIHshc3RyaW5nfSBldmVudFR5cGVcbiAgICAgKiBAcGFyYW0geyFBcnJheS48IUNoYW5nZT59IGNoYW5nZXNcbiAgICAgKiBAcGFyYW0geyFBcnJheS48IUV2ZW50UmVnaXN0cmF0aW9uPn0gcmVnaXN0cmF0aW9uc1xuICAgICAqIEBwYXJhbSB7IU5vZGV9IGV2ZW50Q2FjaGVcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIEV2ZW50R2VuZXJhdG9yLnByb3RvdHlwZS5nZW5lcmF0ZUV2ZW50c0ZvclR5cGVfID0gZnVuY3Rpb24gKGV2ZW50cywgZXZlbnRUeXBlLCBjaGFuZ2VzLCByZWdpc3RyYXRpb25zLCBldmVudENhY2hlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBmaWx0ZXJlZENoYW5nZXMgPSBjaGFuZ2VzLmZpbHRlcihmdW5jdGlvbiAoY2hhbmdlKSB7IHJldHVybiBjaGFuZ2UudHlwZSA9PT0gZXZlbnRUeXBlOyB9KTtcbiAgICAgICAgZmlsdGVyZWRDaGFuZ2VzLnNvcnQodGhpcy5jb21wYXJlQ2hhbmdlc18uYmluZCh0aGlzKSk7XG4gICAgICAgIGZpbHRlcmVkQ2hhbmdlcy5mb3JFYWNoKGZ1bmN0aW9uIChjaGFuZ2UpIHtcbiAgICAgICAgICAgIHZhciBtYXRlcmlhbGl6ZWRDaGFuZ2UgPSBfdGhpcy5tYXRlcmlhbGl6ZVNpbmdsZUNoYW5nZV8oY2hhbmdlLCBldmVudENhY2hlKTtcbiAgICAgICAgICAgIHJlZ2lzdHJhdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAocmVnaXN0cmF0aW9uKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlZ2lzdHJhdGlvbi5yZXNwb25kc1RvKGNoYW5nZS50eXBlKSkge1xuICAgICAgICAgICAgICAgICAgICBldmVudHMucHVzaChyZWdpc3RyYXRpb24uY3JlYXRlRXZlbnQobWF0ZXJpYWxpemVkQ2hhbmdlLCBfdGhpcy5xdWVyeV8pKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFDaGFuZ2V9IGNoYW5nZVxuICAgICAqIEBwYXJhbSB7IU5vZGV9IGV2ZW50Q2FjaGVcbiAgICAgKiBAcmV0dXJuIHshQ2hhbmdlfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgRXZlbnRHZW5lcmF0b3IucHJvdG90eXBlLm1hdGVyaWFsaXplU2luZ2xlQ2hhbmdlXyA9IGZ1bmN0aW9uIChjaGFuZ2UsIGV2ZW50Q2FjaGUpIHtcbiAgICAgICAgaWYgKGNoYW5nZS50eXBlID09PSAndmFsdWUnIHx8IGNoYW5nZS50eXBlID09PSAnY2hpbGRfcmVtb3ZlZCcpIHtcbiAgICAgICAgICAgIHJldHVybiBjaGFuZ2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjaGFuZ2UucHJldk5hbWUgPSBldmVudENhY2hlLmdldFByZWRlY2Vzc29yQ2hpbGROYW1lKFxuICAgICAgICAgICAgLyoqIEB0eXBlIHshc3RyaW5nfSAqL1xuICAgICAgICAgICAgY2hhbmdlLmNoaWxkTmFtZSwgY2hhbmdlLnNuYXBzaG90Tm9kZSwgdGhpcy5pbmRleF8pO1xuICAgICAgICAgICAgcmV0dXJuIGNoYW5nZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshQ2hhbmdlfSBhXG4gICAgICogQHBhcmFtIHshQ2hhbmdlfSBiXG4gICAgICogQHJldHVybiB7bnVtYmVyfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgRXZlbnRHZW5lcmF0b3IucHJvdG90eXBlLmNvbXBhcmVDaGFuZ2VzXyA9IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgIGlmIChhLmNoaWxkTmFtZSA9PSBudWxsIHx8IGIuY2hpbGROYW1lID09IG51bGwpIHtcbiAgICAgICAgICAgIHRocm93IHV0aWxfMS5hc3NlcnRpb25FcnJvcignU2hvdWxkIG9ubHkgY29tcGFyZSBjaGlsZF8gZXZlbnRzLicpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhV3JhcHBlZCA9IG5ldyBOb2RlXzEuTmFtZWROb2RlKGEuY2hpbGROYW1lLCBhLnNuYXBzaG90Tm9kZSk7XG4gICAgICAgIHZhciBiV3JhcHBlZCA9IG5ldyBOb2RlXzEuTmFtZWROb2RlKGIuY2hpbGROYW1lLCBiLnNuYXBzaG90Tm9kZSk7XG4gICAgICAgIHJldHVybiB0aGlzLmluZGV4Xy5jb21wYXJlKGFXcmFwcGVkLCBiV3JhcHBlZCk7XG4gICAgfTtcbiAgICByZXR1cm4gRXZlbnRHZW5lcmF0b3I7XG59KCkpO1xuZXhwb3J0cy5FdmVudEdlbmVyYXRvciA9IEV2ZW50R2VuZXJhdG9yO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1FdmVudEdlbmVyYXRvci5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB1dGlsXzEgPSByZXF1aXJlKFwiLi4vdXRpbC91dGlsXCIpO1xuLyoqXG4gKiBUaGUgZXZlbnQgcXVldWUgc2VydmVzIGEgZmV3IHB1cnBvc2VzOlxuICogMS4gSXQgZW5zdXJlcyB3ZSBtYWludGFpbiBldmVudCBvcmRlciBpbiB0aGUgZmFjZSBvZiBldmVudCBjYWxsYmFja3MgZG9pbmcgb3BlcmF0aW9ucyB0aGF0IHJlc3VsdCBpbiBtb3JlXG4gKiAgICBldmVudHMgYmVpbmcgcXVldWVkLlxuICogMi4gcmFpc2VRdWV1ZWRFdmVudHMoKSBoYW5kbGVzIGJlaW5nIGNhbGxlZCByZWVudHJhbnRseSBuaWNlbHkuICBUaGF0IGlzLCBpZiBpbiB0aGUgY291cnNlIG9mIHJhaXNpbmcgZXZlbnRzLFxuICogICAgcmFpc2VRdWV1ZWRFdmVudHMoKSBpcyBjYWxsZWQgYWdhaW4sIHRoZSBcImlubmVyXCIgY2FsbCB3aWxsIHBpY2sgdXAgcmFpc2luZyBldmVudHMgd2hlcmUgdGhlIFwib3V0ZXJcIiBjYWxsXG4gKiAgICBsZWZ0IG9mZiwgZW5zdXJpbmcgdGhhdCB0aGUgZXZlbnRzIGFyZSBzdGlsbCByYWlzZWQgc3luY2hyb25vdXNseSBhbmQgaW4gb3JkZXIuXG4gKiAzLiBZb3UgY2FuIHVzZSByYWlzZUV2ZW50c0F0UGF0aCBhbmQgcmFpc2VFdmVudHNGb3JDaGFuZ2VkUGF0aCB0byBlbnN1cmUgb25seSByZWxldmFudCBwcmV2aW91c2x5LXF1ZXVlZFxuICogICAgZXZlbnRzIGFyZSByYWlzZWQgc3luY2hyb25vdXNseS5cbiAqXG4gKiBOT1RFOiBUaGlzIGNhbiBhbGwgZ28gYXdheSBpZi93aGVuIHdlIG1vdmUgdG8gYXN5bmMgZXZlbnRzLlxuICpcbiAqIEBjb25zdHJ1Y3RvclxuICovXG52YXIgRXZlbnRRdWV1ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBFdmVudFF1ZXVlKCkge1xuICAgICAgICAvKipcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQHR5cGUgeyFBcnJheS48RXZlbnRMaXN0Pn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZXZlbnRMaXN0c18gPSBbXTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRyYWNrcyByZWN1cnNpb24gZGVwdGggb2YgcmFpc2VRdWV1ZWRFdmVudHNfLCBmb3IgZGVidWdnaW5nIHB1cnBvc2VzLlxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAdHlwZSB7IW51bWJlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucmVjdXJzaW9uRGVwdGhfID0gMDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshQXJyYXkuPEV2ZW50Pn0gZXZlbnREYXRhTGlzdCBUaGUgbmV3IGV2ZW50cyB0byBxdWV1ZS5cbiAgICAgKi9cbiAgICBFdmVudFF1ZXVlLnByb3RvdHlwZS5xdWV1ZUV2ZW50cyA9IGZ1bmN0aW9uIChldmVudERhdGFMaXN0KSB7XG4gICAgICAgIC8vIFdlIGdyb3VwIGV2ZW50cyBieSBwYXRoLCBzdG9yaW5nIHRoZW0gaW4gYSBzaW5nbGUgRXZlbnRMaXN0LCB0byBtYWtlIGl0IGVhc2llciB0byBza2lwIG92ZXIgdGhlbSBxdWlja2x5LlxuICAgICAgICB2YXIgY3Vyckxpc3QgPSBudWxsO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGV2ZW50RGF0YUxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBldmVudERhdGEgPSBldmVudERhdGFMaXN0W2ldO1xuICAgICAgICAgICAgdmFyIGV2ZW50UGF0aCA9IGV2ZW50RGF0YS5nZXRQYXRoKCk7XG4gICAgICAgICAgICBpZiAoY3Vyckxpc3QgIT09IG51bGwgJiYgIWV2ZW50UGF0aC5lcXVhbHMoY3Vyckxpc3QuZ2V0UGF0aCgpKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZXZlbnRMaXN0c18ucHVzaChjdXJyTGlzdCk7XG4gICAgICAgICAgICAgICAgY3Vyckxpc3QgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGN1cnJMaXN0ID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY3Vyckxpc3QgPSBuZXcgRXZlbnRMaXN0KGV2ZW50UGF0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjdXJyTGlzdC5hZGQoZXZlbnREYXRhKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY3Vyckxpc3QpIHtcbiAgICAgICAgICAgIHRoaXMuZXZlbnRMaXN0c18ucHVzaChjdXJyTGlzdCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFF1ZXVlcyB0aGUgc3BlY2lmaWVkIGV2ZW50cyBhbmQgc3luY2hyb25vdXNseSByYWlzZXMgYWxsIGV2ZW50cyAoaW5jbHVkaW5nIHByZXZpb3VzbHkgcXVldWVkIG9uZXMpXG4gICAgICogZm9yIHRoZSBzcGVjaWZpZWQgcGF0aC5cbiAgICAgKlxuICAgICAqIEl0IGlzIGFzc3VtZWQgdGhhdCB0aGUgbmV3IGV2ZW50cyBhcmUgYWxsIGZvciB0aGUgc3BlY2lmaWVkIHBhdGguXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyFQYXRofSBwYXRoIFRoZSBwYXRoIHRvIHJhaXNlIGV2ZW50cyBmb3IuXG4gICAgICogQHBhcmFtIHshQXJyYXkuPEV2ZW50Pn0gZXZlbnREYXRhTGlzdCBUaGUgbmV3IGV2ZW50cyB0byByYWlzZS5cbiAgICAgKi9cbiAgICBFdmVudFF1ZXVlLnByb3RvdHlwZS5yYWlzZUV2ZW50c0F0UGF0aCA9IGZ1bmN0aW9uIChwYXRoLCBldmVudERhdGFMaXN0KSB7XG4gICAgICAgIHRoaXMucXVldWVFdmVudHMoZXZlbnREYXRhTGlzdCk7XG4gICAgICAgIHRoaXMucmFpc2VRdWV1ZWRFdmVudHNNYXRjaGluZ1ByZWRpY2F0ZV8oZnVuY3Rpb24gKGV2ZW50UGF0aCkge1xuICAgICAgICAgICAgcmV0dXJuIGV2ZW50UGF0aC5lcXVhbHMocGF0aCk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUXVldWVzIHRoZSBzcGVjaWZpZWQgZXZlbnRzIGFuZCBzeW5jaHJvbm91c2x5IHJhaXNlcyBhbGwgZXZlbnRzIChpbmNsdWRpbmcgcHJldmlvdXNseSBxdWV1ZWQgb25lcykgZm9yXG4gICAgICogbG9jYXRpb25zIHJlbGF0ZWQgdG8gdGhlIHNwZWNpZmllZCBjaGFuZ2UgcGF0aCAoaS5lLiBhbGwgYW5jZXN0b3JzIGFuZCBkZXNjZW5kYW50cykuXG4gICAgICpcbiAgICAgKiBJdCBpcyBhc3N1bWVkIHRoYXQgdGhlIG5ldyBldmVudHMgYXJlIGFsbCByZWxhdGVkIChhbmNlc3RvciBvciBkZXNjZW5kYW50KSB0byB0aGUgc3BlY2lmaWVkIHBhdGguXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyFQYXRofSBjaGFuZ2VkUGF0aCBUaGUgcGF0aCB0byByYWlzZSBldmVudHMgZm9yLlxuICAgICAqIEBwYXJhbSB7IUFycmF5LjwhRXZlbnQ+fSBldmVudERhdGFMaXN0IFRoZSBldmVudHMgdG8gcmFpc2VcbiAgICAgKi9cbiAgICBFdmVudFF1ZXVlLnByb3RvdHlwZS5yYWlzZUV2ZW50c0ZvckNoYW5nZWRQYXRoID0gZnVuY3Rpb24gKGNoYW5nZWRQYXRoLCBldmVudERhdGFMaXN0KSB7XG4gICAgICAgIHRoaXMucXVldWVFdmVudHMoZXZlbnREYXRhTGlzdCk7XG4gICAgICAgIHRoaXMucmFpc2VRdWV1ZWRFdmVudHNNYXRjaGluZ1ByZWRpY2F0ZV8oZnVuY3Rpb24gKGV2ZW50UGF0aCkge1xuICAgICAgICAgICAgcmV0dXJuIGV2ZW50UGF0aC5jb250YWlucyhjaGFuZ2VkUGF0aCkgfHwgY2hhbmdlZFBhdGguY29udGFpbnMoZXZlbnRQYXRoKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFmdW5jdGlvbighUGF0aCk6Ym9vbGVhbn0gcHJlZGljYXRlXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBFdmVudFF1ZXVlLnByb3RvdHlwZS5yYWlzZVF1ZXVlZEV2ZW50c01hdGNoaW5nUHJlZGljYXRlXyA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICAgICAgdGhpcy5yZWN1cnNpb25EZXB0aF8rKztcbiAgICAgICAgdmFyIHNlbnRBbGwgPSB0cnVlO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuZXZlbnRMaXN0c18ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBldmVudExpc3QgPSB0aGlzLmV2ZW50TGlzdHNfW2ldO1xuICAgICAgICAgICAgaWYgKGV2ZW50TGlzdCkge1xuICAgICAgICAgICAgICAgIHZhciBldmVudFBhdGggPSBldmVudExpc3QuZ2V0UGF0aCgpO1xuICAgICAgICAgICAgICAgIGlmIChwcmVkaWNhdGUoZXZlbnRQYXRoKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmV2ZW50TGlzdHNfW2ldLnJhaXNlKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZXZlbnRMaXN0c19baV0gPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc2VudEFsbCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VudEFsbCkge1xuICAgICAgICAgICAgdGhpcy5ldmVudExpc3RzXyA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVjdXJzaW9uRGVwdGhfLS07XG4gICAgfTtcbiAgICByZXR1cm4gRXZlbnRRdWV1ZTtcbn0oKSk7XG5leHBvcnRzLkV2ZW50UXVldWUgPSBFdmVudFF1ZXVlO1xuLyoqXG4gKiBAcGFyYW0geyFQYXRofSBwYXRoXG4gKiBAY29uc3RydWN0b3JcbiAqL1xudmFyIEV2ZW50TGlzdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBFdmVudExpc3QocGF0aF8pIHtcbiAgICAgICAgdGhpcy5wYXRoXyA9IHBhdGhfO1xuICAgICAgICAvKipcbiAgICAgICAgICogQHR5cGUgeyFBcnJheS48RXZlbnQ+fVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5ldmVudHNfID0gW107XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7IUV2ZW50fSBldmVudERhdGFcbiAgICAgKi9cbiAgICBFdmVudExpc3QucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIChldmVudERhdGEpIHtcbiAgICAgICAgdGhpcy5ldmVudHNfLnB1c2goZXZlbnREYXRhKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEl0ZXJhdGVzIHRocm91Z2ggdGhlIGxpc3QgYW5kIHJhaXNlcyBlYWNoIGV2ZW50XG4gICAgICovXG4gICAgRXZlbnRMaXN0LnByb3RvdHlwZS5yYWlzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmV2ZW50c18ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBldmVudERhdGEgPSB0aGlzLmV2ZW50c19baV07XG4gICAgICAgICAgICBpZiAoZXZlbnREYXRhICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5ldmVudHNfW2ldID0gbnVsbDtcbiAgICAgICAgICAgICAgICB2YXIgZXZlbnRGbiA9IGV2ZW50RGF0YS5nZXRFdmVudFJ1bm5lcigpO1xuICAgICAgICAgICAgICAgIGlmICh1dGlsXzEubG9nZ2VyKSB7XG4gICAgICAgICAgICAgICAgICAgIHV0aWxfMS5sb2coJ2V2ZW50OiAnICsgZXZlbnREYXRhLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB1dGlsXzEuZXhjZXB0aW9uR3VhcmQoZXZlbnRGbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4geyFQYXRofVxuICAgICAqL1xuICAgIEV2ZW50TGlzdC5wcm90b3R5cGUuZ2V0UGF0aCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGF0aF87XG4gICAgfTtcbiAgICByZXR1cm4gRXZlbnRMaXN0O1xufSgpKTtcbmV4cG9ydHMuRXZlbnRMaXN0ID0gRXZlbnRMaXN0O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1FdmVudFF1ZXVlLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIERhdGFTbmFwc2hvdF8xID0gcmVxdWlyZShcIi4uLy4uL2FwaS9EYXRhU25hcHNob3RcIik7XG52YXIgRXZlbnRfMSA9IHJlcXVpcmUoXCIuL0V2ZW50XCIpO1xudmFyIHV0aWxfMSA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvdXRpbFwiKTtcbnZhciB1dGlsXzIgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG4vKipcbiAqIFJlcHJlc2VudHMgcmVnaXN0cmF0aW9uIGZvciAndmFsdWUnIGV2ZW50cy5cbiAqL1xudmFyIFZhbHVlRXZlbnRSZWdpc3RyYXRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHs/ZnVuY3Rpb24oIURhdGFTbmFwc2hvdCl9IGNhbGxiYWNrX1xuICAgICAqIEBwYXJhbSB7P2Z1bmN0aW9uKEVycm9yKX0gY2FuY2VsQ2FsbGJhY2tfXG4gICAgICogQHBhcmFtIHs/T2JqZWN0fSBjb250ZXh0X1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIFZhbHVlRXZlbnRSZWdpc3RyYXRpb24oY2FsbGJhY2tfLCBjYW5jZWxDYWxsYmFja18sIGNvbnRleHRfKSB7XG4gICAgICAgIHRoaXMuY2FsbGJhY2tfID0gY2FsbGJhY2tfO1xuICAgICAgICB0aGlzLmNhbmNlbENhbGxiYWNrXyA9IGNhbmNlbENhbGxiYWNrXztcbiAgICAgICAgdGhpcy5jb250ZXh0XyA9IGNvbnRleHRfO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIFZhbHVlRXZlbnRSZWdpc3RyYXRpb24ucHJvdG90eXBlLnJlc3BvbmRzVG8gPSBmdW5jdGlvbiAoZXZlbnRUeXBlKSB7XG4gICAgICAgIHJldHVybiBldmVudFR5cGUgPT09ICd2YWx1ZSc7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIFZhbHVlRXZlbnRSZWdpc3RyYXRpb24ucHJvdG90eXBlLmNyZWF0ZUV2ZW50ID0gZnVuY3Rpb24gKGNoYW5nZSwgcXVlcnkpIHtcbiAgICAgICAgdmFyIGluZGV4ID0gcXVlcnkuZ2V0UXVlcnlQYXJhbXMoKS5nZXRJbmRleCgpO1xuICAgICAgICByZXR1cm4gbmV3IEV2ZW50XzEuRGF0YUV2ZW50KCd2YWx1ZScsIHRoaXMsIG5ldyBEYXRhU25hcHNob3RfMS5EYXRhU25hcHNob3QoY2hhbmdlLnNuYXBzaG90Tm9kZSwgcXVlcnkuZ2V0UmVmKCksIGluZGV4KSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIFZhbHVlRXZlbnRSZWdpc3RyYXRpb24ucHJvdG90eXBlLmdldEV2ZW50UnVubmVyID0gZnVuY3Rpb24gKGV2ZW50RGF0YSkge1xuICAgICAgICB2YXIgY3R4ID0gdGhpcy5jb250ZXh0XztcbiAgICAgICAgaWYgKGV2ZW50RGF0YS5nZXRFdmVudFR5cGUoKSA9PT0gJ2NhbmNlbCcpIHtcbiAgICAgICAgICAgIHV0aWxfMi5hc3NlcnQodGhpcy5jYW5jZWxDYWxsYmFja18sICdSYWlzaW5nIGEgY2FuY2VsIGV2ZW50IG9uIGEgbGlzdGVuZXIgd2l0aCBubyBjYW5jZWwgY2FsbGJhY2snKTtcbiAgICAgICAgICAgIHZhciBjYW5jZWxDQl8xID0gdGhpcy5jYW5jZWxDYWxsYmFja187XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIC8vIFdlIGtub3cgdGhhdCBlcnJvciBleGlzdHMsIHdlIGNoZWNrZWQgYWJvdmUgdGhhdCB0aGlzIGlzIGEgY2FuY2VsIGV2ZW50XG4gICAgICAgICAgICAgICAgY2FuY2VsQ0JfMS5jYWxsKGN0eCwgZXZlbnREYXRhLmVycm9yKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgY2JfMSA9IHRoaXMuY2FsbGJhY2tfO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBjYl8xLmNhbGwoY3R4LCBldmVudERhdGEuc25hcHNob3QpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBWYWx1ZUV2ZW50UmVnaXN0cmF0aW9uLnByb3RvdHlwZS5jcmVhdGVDYW5jZWxFdmVudCA9IGZ1bmN0aW9uIChlcnJvciwgcGF0aCkge1xuICAgICAgICBpZiAodGhpcy5jYW5jZWxDYWxsYmFja18pIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgRXZlbnRfMS5DYW5jZWxFdmVudCh0aGlzLCBlcnJvciwgcGF0aCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBWYWx1ZUV2ZW50UmVnaXN0cmF0aW9uLnByb3RvdHlwZS5tYXRjaGVzID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgICAgIGlmICghKG90aGVyIGluc3RhbmNlb2YgVmFsdWVFdmVudFJlZ2lzdHJhdGlvbikpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghb3RoZXIuY2FsbGJhY2tfIHx8ICF0aGlzLmNhbGxiYWNrXykge1xuICAgICAgICAgICAgLy8gSWYgbm8gY2FsbGJhY2sgc3BlY2lmaWVkLCB3ZSBjb25zaWRlciBpdCB0byBtYXRjaCBhbnkgY2FsbGJhY2suXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiAob3RoZXIuY2FsbGJhY2tfID09PSB0aGlzLmNhbGxiYWNrXyAmJiBvdGhlci5jb250ZXh0XyA9PT0gdGhpcy5jb250ZXh0Xyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgVmFsdWVFdmVudFJlZ2lzdHJhdGlvbi5wcm90b3R5cGUuaGFzQW55Q2FsbGJhY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNhbGxiYWNrXyAhPT0gbnVsbDtcbiAgICB9O1xuICAgIHJldHVybiBWYWx1ZUV2ZW50UmVnaXN0cmF0aW9uO1xufSgpKTtcbmV4cG9ydHMuVmFsdWVFdmVudFJlZ2lzdHJhdGlvbiA9IFZhbHVlRXZlbnRSZWdpc3RyYXRpb247XG4vKipcbiAqIFJlcHJlc2VudHMgdGhlIHJlZ2lzdHJhdGlvbiBvZiAxIG9yIG1vcmUgY2hpbGRfeHh4IGV2ZW50cy5cbiAqXG4gKiBDdXJyZW50bHksIGl0IGlzIGFsd2F5cyBleGFjdGx5IDEgY2hpbGRfeHh4IGV2ZW50LCBidXQgdGhlIGlkZWEgaXMgd2UgbWlnaHQgbGV0IHlvdVxuICogcmVnaXN0ZXIgYSBncm91cCBvZiBjYWxsYmFja3MgdG9nZXRoZXIgaW4gdGhlIGZ1dHVyZS5cbiAqXG4gKiBAY29uc3RydWN0b3JcbiAqIEBpbXBsZW1lbnRzIHtFdmVudFJlZ2lzdHJhdGlvbn1cbiAqL1xudmFyIENoaWxkRXZlbnRSZWdpc3RyYXRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHs/T2JqZWN0LjxzdHJpbmcsIGZ1bmN0aW9uKCFEYXRhU25hcHNob3QsID9zdHJpbmc9KT59IGNhbGxiYWNrc19cbiAgICAgKiBAcGFyYW0gez9mdW5jdGlvbihFcnJvcil9IGNhbmNlbENhbGxiYWNrX1xuICAgICAqIEBwYXJhbSB7T2JqZWN0PX0gY29udGV4dF9cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBDaGlsZEV2ZW50UmVnaXN0cmF0aW9uKGNhbGxiYWNrc18sIGNhbmNlbENhbGxiYWNrXywgY29udGV4dF8pIHtcbiAgICAgICAgdGhpcy5jYWxsYmFja3NfID0gY2FsbGJhY2tzXztcbiAgICAgICAgdGhpcy5jYW5jZWxDYWxsYmFja18gPSBjYW5jZWxDYWxsYmFja187XG4gICAgICAgIHRoaXMuY29udGV4dF8gPSBjb250ZXh0XztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBDaGlsZEV2ZW50UmVnaXN0cmF0aW9uLnByb3RvdHlwZS5yZXNwb25kc1RvID0gZnVuY3Rpb24gKGV2ZW50VHlwZSkge1xuICAgICAgICB2YXIgZXZlbnRUb0NoZWNrID0gZXZlbnRUeXBlID09PSAnY2hpbGRyZW5fYWRkZWQnID8gJ2NoaWxkX2FkZGVkJyA6IGV2ZW50VHlwZTtcbiAgICAgICAgZXZlbnRUb0NoZWNrID1cbiAgICAgICAgICAgIGV2ZW50VG9DaGVjayA9PT0gJ2NoaWxkcmVuX3JlbW92ZWQnID8gJ2NoaWxkX3JlbW92ZWQnIDogZXZlbnRUb0NoZWNrO1xuICAgICAgICByZXR1cm4gdXRpbF8xLmNvbnRhaW5zKHRoaXMuY2FsbGJhY2tzXywgZXZlbnRUb0NoZWNrKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgQ2hpbGRFdmVudFJlZ2lzdHJhdGlvbi5wcm90b3R5cGUuY3JlYXRlQ2FuY2VsRXZlbnQgPSBmdW5jdGlvbiAoZXJyb3IsIHBhdGgpIHtcbiAgICAgICAgaWYgKHRoaXMuY2FuY2VsQ2FsbGJhY2tfKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEV2ZW50XzEuQ2FuY2VsRXZlbnQodGhpcywgZXJyb3IsIHBhdGgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgQ2hpbGRFdmVudFJlZ2lzdHJhdGlvbi5wcm90b3R5cGUuY3JlYXRlRXZlbnQgPSBmdW5jdGlvbiAoY2hhbmdlLCBxdWVyeSkge1xuICAgICAgICB1dGlsXzIuYXNzZXJ0KGNoYW5nZS5jaGlsZE5hbWUgIT0gbnVsbCwgJ0NoaWxkIGV2ZW50cyBzaG91bGQgaGF2ZSBhIGNoaWxkTmFtZS4nKTtcbiAgICAgICAgdmFyIHJlZiA9IHF1ZXJ5LmdldFJlZigpLmNoaWxkKC8qKiBAdHlwZSB7IXN0cmluZ30gKi8gKGNoYW5nZS5jaGlsZE5hbWUpKTtcbiAgICAgICAgdmFyIGluZGV4ID0gcXVlcnkuZ2V0UXVlcnlQYXJhbXMoKS5nZXRJbmRleCgpO1xuICAgICAgICByZXR1cm4gbmV3IEV2ZW50XzEuRGF0YUV2ZW50KGNoYW5nZS50eXBlLCB0aGlzLCBuZXcgRGF0YVNuYXBzaG90XzEuRGF0YVNuYXBzaG90KGNoYW5nZS5zbmFwc2hvdE5vZGUsIHJlZiwgaW5kZXgpLCBjaGFuZ2UucHJldk5hbWUpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBDaGlsZEV2ZW50UmVnaXN0cmF0aW9uLnByb3RvdHlwZS5nZXRFdmVudFJ1bm5lciA9IGZ1bmN0aW9uIChldmVudERhdGEpIHtcbiAgICAgICAgdmFyIGN0eCA9IHRoaXMuY29udGV4dF87XG4gICAgICAgIGlmIChldmVudERhdGEuZ2V0RXZlbnRUeXBlKCkgPT09ICdjYW5jZWwnKSB7XG4gICAgICAgICAgICB1dGlsXzIuYXNzZXJ0KHRoaXMuY2FuY2VsQ2FsbGJhY2tfLCAnUmFpc2luZyBhIGNhbmNlbCBldmVudCBvbiBhIGxpc3RlbmVyIHdpdGggbm8gY2FuY2VsIGNhbGxiYWNrJyk7XG4gICAgICAgICAgICB2YXIgY2FuY2VsQ0JfMiA9IHRoaXMuY2FuY2VsQ2FsbGJhY2tfO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAvLyBXZSBrbm93IHRoYXQgZXJyb3IgZXhpc3RzLCB3ZSBjaGVja2VkIGFib3ZlIHRoYXQgdGhpcyBpcyBhIGNhbmNlbCBldmVudFxuICAgICAgICAgICAgICAgIGNhbmNlbENCXzIuY2FsbChjdHgsIGV2ZW50RGF0YS5lcnJvcik7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIGNiXzIgPSB0aGlzLmNhbGxiYWNrc19bZXZlbnREYXRhLmV2ZW50VHlwZV07XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGNiXzIuY2FsbChjdHgsIGV2ZW50RGF0YS5zbmFwc2hvdCwgZXZlbnREYXRhLnByZXZOYW1lKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgQ2hpbGRFdmVudFJlZ2lzdHJhdGlvbi5wcm90b3R5cGUubWF0Y2hlcyA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgICAgICBpZiAob3RoZXIgaW5zdGFuY2VvZiBDaGlsZEV2ZW50UmVnaXN0cmF0aW9uKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuY2FsbGJhY2tzXyB8fCAhb3RoZXIuY2FsbGJhY2tzXykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5jb250ZXh0XyA9PT0gb3RoZXIuY29udGV4dF8pIHtcbiAgICAgICAgICAgICAgICB2YXIgb3RoZXJDb3VudCA9IHV0aWxfMS5nZXRDb3VudChvdGhlci5jYWxsYmFja3NfKTtcbiAgICAgICAgICAgICAgICB2YXIgdGhpc0NvdW50ID0gdXRpbF8xLmdldENvdW50KHRoaXMuY2FsbGJhY2tzXyk7XG4gICAgICAgICAgICAgICAgaWYgKG90aGVyQ291bnQgPT09IHRoaXNDb3VudCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiBjb3VudCBpcyAxLCBkbyBhbiBleGFjdCBtYXRjaCBvbiBldmVudFR5cGUsIGlmIGVpdGhlciBpcyBkZWZpbmVkIGJ1dCBudWxsLCBpdCdzIGEgbWF0Y2guXG4gICAgICAgICAgICAgICAgICAgIC8vICBJZiBldmVudCB0eXBlcyBkb24ndCBtYXRjaCwgbm90IGEgbWF0Y2hcbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgY291bnQgaXMgbm90IDEsIGV4YWN0IG1hdGNoIGFjcm9zcyBhbGxcbiAgICAgICAgICAgICAgICAgICAgaWYgKG90aGVyQ291bnQgPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvdGhlcktleSAvKiogQHR5cGUgeyFzdHJpbmd9ICovID0gdXRpbF8xLmdldEFueUtleShvdGhlci5jYWxsYmFja3NfKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aGlzS2V5IC8qKiBAdHlwZSB7IXN0cmluZ30gKi8gPSB1dGlsXzEuZ2V0QW55S2V5KHRoaXMuY2FsbGJhY2tzXyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKHRoaXNLZXkgPT09IG90aGVyS2V5ICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKCFvdGhlci5jYWxsYmFja3NfW290aGVyS2V5XSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdGhpcy5jYWxsYmFja3NfW3RoaXNLZXldIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG90aGVyLmNhbGxiYWNrc19bb3RoZXJLZXldID09PSB0aGlzLmNhbGxiYWNrc19bdGhpc0tleV0pKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEV4YWN0IG1hdGNoIG9uIGVhY2gga2V5LlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHV0aWxfMS5ldmVyeSh0aGlzLmNhbGxiYWNrc18sIGZ1bmN0aW9uIChldmVudFR5cGUsIGNiKSB7IHJldHVybiBvdGhlci5jYWxsYmFja3NfW2V2ZW50VHlwZV0gPT09IGNiOyB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIENoaWxkRXZlbnRSZWdpc3RyYXRpb24ucHJvdG90eXBlLmhhc0FueUNhbGxiYWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jYWxsYmFja3NfICE9PSBudWxsO1xuICAgIH07XG4gICAgcmV0dXJuIENoaWxkRXZlbnRSZWdpc3RyYXRpb247XG59KCkpO1xuZXhwb3J0cy5DaGlsZEV2ZW50UmVnaXN0cmF0aW9uID0gQ2hpbGRFdmVudFJlZ2lzdHJhdGlvbjtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9RXZlbnRSZWdpc3RyYXRpb24uanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdXRpbF8xID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xudmFyIHV0aWxfMiA9IHJlcXVpcmUoXCIuLi91dGlsL3V0aWxcIik7XG52YXIgS2V5SW5kZXhfMSA9IHJlcXVpcmUoXCIuLi9zbmFwL2luZGV4ZXMvS2V5SW5kZXhcIik7XG52YXIgUHJpb3JpdHlJbmRleF8xID0gcmVxdWlyZShcIi4uL3NuYXAvaW5kZXhlcy9Qcmlvcml0eUluZGV4XCIpO1xudmFyIFZhbHVlSW5kZXhfMSA9IHJlcXVpcmUoXCIuLi9zbmFwL2luZGV4ZXMvVmFsdWVJbmRleFwiKTtcbnZhciBQYXRoSW5kZXhfMSA9IHJlcXVpcmUoXCIuLi9zbmFwL2luZGV4ZXMvUGF0aEluZGV4XCIpO1xudmFyIEluZGV4ZWRGaWx0ZXJfMSA9IHJlcXVpcmUoXCIuL2ZpbHRlci9JbmRleGVkRmlsdGVyXCIpO1xudmFyIExpbWl0ZWRGaWx0ZXJfMSA9IHJlcXVpcmUoXCIuL2ZpbHRlci9MaW1pdGVkRmlsdGVyXCIpO1xudmFyIFJhbmdlZEZpbHRlcl8xID0gcmVxdWlyZShcIi4vZmlsdGVyL1JhbmdlZEZpbHRlclwiKTtcbnZhciB1dGlsXzMgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG4vKipcbiAqIFRoaXMgY2xhc3MgaXMgYW4gaW1tdXRhYmxlLWZyb20tdGhlLXB1YmxpYy1hcGkgc3RydWN0IGNvbnRhaW5pbmcgYSBzZXQgb2YgcXVlcnkgcGFyYW1ldGVycyBkZWZpbmluZyBhXG4gKiByYW5nZSB0byBiZSByZXR1cm5lZCBmb3IgYSBwYXJ0aWN1bGFyIGxvY2F0aW9uLiBJdCBpcyBhc3N1bWVkIHRoYXQgdmFsaWRhdGlvbiBvZiBwYXJhbWV0ZXJzIGlzIGRvbmUgYXQgdGhlXG4gKiB1c2VyLWZhY2luZyBBUEkgbGV2ZWwsIHNvIGl0IGlzIG5vdCBkb25lIGhlcmUuXG4gKiBAY29uc3RydWN0b3JcbiAqL1xudmFyIFF1ZXJ5UGFyYW1zID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFF1ZXJ5UGFyYW1zKCkge1xuICAgICAgICB0aGlzLmxpbWl0U2V0XyA9IGZhbHNlO1xuICAgICAgICB0aGlzLnN0YXJ0U2V0XyA9IGZhbHNlO1xuICAgICAgICB0aGlzLnN0YXJ0TmFtZVNldF8gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5lbmRTZXRfID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZW5kTmFtZVNldF8gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5saW1pdF8gPSAwO1xuICAgICAgICB0aGlzLnZpZXdGcm9tXyA9ICcnO1xuICAgICAgICB0aGlzLmluZGV4U3RhcnRWYWx1ZV8gPSBudWxsO1xuICAgICAgICB0aGlzLmluZGV4U3RhcnROYW1lXyA9ICcnO1xuICAgICAgICB0aGlzLmluZGV4RW5kVmFsdWVfID0gbnVsbDtcbiAgICAgICAgdGhpcy5pbmRleEVuZE5hbWVfID0gJyc7XG4gICAgICAgIHRoaXMuaW5kZXhfID0gUHJpb3JpdHlJbmRleF8xLlBSSU9SSVRZX0lOREVYO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgICAqL1xuICAgIFF1ZXJ5UGFyYW1zLnByb3RvdHlwZS5oYXNTdGFydCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RhcnRTZXRfO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7Ym9vbGVhbn0gVHJ1ZSBpZiBpdCB3b3VsZCByZXR1cm4gZnJvbSBsZWZ0LlxuICAgICAqL1xuICAgIFF1ZXJ5UGFyYW1zLnByb3RvdHlwZS5pc1ZpZXdGcm9tTGVmdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMudmlld0Zyb21fID09PSAnJykge1xuICAgICAgICAgICAgLy8gbGltaXQoKSwgcmF0aGVyIHRoYW4gbGltaXRUb0ZpcnN0IG9yIGxpbWl0VG9MYXN0IHdhcyBjYWxsZWQuXG4gICAgICAgICAgICAvLyBUaGlzIG1lYW5zIHRoYXQgb25seSBvbmUgb2Ygc3RhcnRTZXRfIGFuZCBlbmRTZXRfIGlzIHRydWUuIFVzZSB0aGVtXG4gICAgICAgICAgICAvLyB0byBjYWxjdWxhdGUgd2hpY2ggc2lkZSBvZiB0aGUgdmlldyB0byBhbmNob3IgdG8uIElmIG5laXRoZXIgaXMgc2V0LFxuICAgICAgICAgICAgLy8gYW5jaG9yIHRvIHRoZSBlbmQuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdGFydFNldF87XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gKHRoaXMudmlld0Zyb21fID09PSBRdWVyeVBhcmFtcy5XSVJFX1BST1RPQ09MX0NPTlNUQU5UU18uVklFV19GUk9NX0xFRlQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBPbmx5IHZhbGlkIHRvIGNhbGwgaWYgaGFzU3RhcnQoKSByZXR1cm5zIHRydWVcbiAgICAgKiBAcmV0dXJuIHsqfVxuICAgICAqL1xuICAgIFF1ZXJ5UGFyYW1zLnByb3RvdHlwZS5nZXRJbmRleFN0YXJ0VmFsdWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHV0aWxfMS5hc3NlcnQodGhpcy5zdGFydFNldF8sICdPbmx5IHZhbGlkIGlmIHN0YXJ0IGhhcyBiZWVuIHNldCcpO1xuICAgICAgICByZXR1cm4gdGhpcy5pbmRleFN0YXJ0VmFsdWVfO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogT25seSB2YWxpZCB0byBjYWxsIGlmIGhhc1N0YXJ0KCkgcmV0dXJucyB0cnVlLlxuICAgICAqIFJldHVybnMgdGhlIHN0YXJ0aW5nIGtleSBuYW1lIGZvciB0aGUgcmFuZ2UgZGVmaW5lZCBieSB0aGVzZSBxdWVyeSBwYXJhbWV0ZXJzXG4gICAgICogQHJldHVybiB7IXN0cmluZ31cbiAgICAgKi9cbiAgICBRdWVyeVBhcmFtcy5wcm90b3R5cGUuZ2V0SW5kZXhTdGFydE5hbWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHV0aWxfMS5hc3NlcnQodGhpcy5zdGFydFNldF8sICdPbmx5IHZhbGlkIGlmIHN0YXJ0IGhhcyBiZWVuIHNldCcpO1xuICAgICAgICBpZiAodGhpcy5zdGFydE5hbWVTZXRfKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pbmRleFN0YXJ0TmFtZV87XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdXRpbF8yLk1JTl9OQU1FO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgICAqL1xuICAgIFF1ZXJ5UGFyYW1zLnByb3RvdHlwZS5oYXNFbmQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVuZFNldF87XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBPbmx5IHZhbGlkIHRvIGNhbGwgaWYgaGFzRW5kKCkgcmV0dXJucyB0cnVlLlxuICAgICAqIEByZXR1cm4geyp9XG4gICAgICovXG4gICAgUXVlcnlQYXJhbXMucHJvdG90eXBlLmdldEluZGV4RW5kVmFsdWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHV0aWxfMS5hc3NlcnQodGhpcy5lbmRTZXRfLCAnT25seSB2YWxpZCBpZiBlbmQgaGFzIGJlZW4gc2V0Jyk7XG4gICAgICAgIHJldHVybiB0aGlzLmluZGV4RW5kVmFsdWVfO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogT25seSB2YWxpZCB0byBjYWxsIGlmIGhhc0VuZCgpIHJldHVybnMgdHJ1ZS5cbiAgICAgKiBSZXR1cm5zIHRoZSBlbmQga2V5IG5hbWUgZm9yIHRoZSByYW5nZSBkZWZpbmVkIGJ5IHRoZXNlIHF1ZXJ5IHBhcmFtZXRlcnNcbiAgICAgKiBAcmV0dXJuIHshc3RyaW5nfVxuICAgICAqL1xuICAgIFF1ZXJ5UGFyYW1zLnByb3RvdHlwZS5nZXRJbmRleEVuZE5hbWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHV0aWxfMS5hc3NlcnQodGhpcy5lbmRTZXRfLCAnT25seSB2YWxpZCBpZiBlbmQgaGFzIGJlZW4gc2V0Jyk7XG4gICAgICAgIGlmICh0aGlzLmVuZE5hbWVTZXRfKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pbmRleEVuZE5hbWVfO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHV0aWxfMi5NQVhfTkFNRTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBRdWVyeVBhcmFtcy5wcm90b3R5cGUuaGFzTGltaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxpbWl0U2V0XztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IFRydWUgaWYgYSBsaW1pdCBoYXMgYmVlbiBzZXQgYW5kIGl0IGhhcyBiZWVuIGV4cGxpY2l0bHkgYW5jaG9yZWRcbiAgICAgKi9cbiAgICBRdWVyeVBhcmFtcy5wcm90b3R5cGUuaGFzQW5jaG9yZWRMaW1pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubGltaXRTZXRfICYmIHRoaXMudmlld0Zyb21fICE9PSAnJztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIE9ubHkgdmFsaWQgdG8gY2FsbCBpZiBoYXNMaW1pdCgpIHJldHVybnMgdHJ1ZVxuICAgICAqIEByZXR1cm4geyFudW1iZXJ9XG4gICAgICovXG4gICAgUXVlcnlQYXJhbXMucHJvdG90eXBlLmdldExpbWl0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB1dGlsXzEuYXNzZXJ0KHRoaXMubGltaXRTZXRfLCAnT25seSB2YWxpZCBpZiBsaW1pdCBoYXMgYmVlbiBzZXQnKTtcbiAgICAgICAgcmV0dXJuIHRoaXMubGltaXRfO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7IUluZGV4fVxuICAgICAqL1xuICAgIFF1ZXJ5UGFyYW1zLnByb3RvdHlwZS5nZXRJbmRleCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5kZXhfO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7IVF1ZXJ5UGFyYW1zfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgUXVlcnlQYXJhbXMucHJvdG90eXBlLmNvcHlfID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY29weSA9IG5ldyBRdWVyeVBhcmFtcygpO1xuICAgICAgICBjb3B5LmxpbWl0U2V0XyA9IHRoaXMubGltaXRTZXRfO1xuICAgICAgICBjb3B5LmxpbWl0XyA9IHRoaXMubGltaXRfO1xuICAgICAgICBjb3B5LnN0YXJ0U2V0XyA9IHRoaXMuc3RhcnRTZXRfO1xuICAgICAgICBjb3B5LmluZGV4U3RhcnRWYWx1ZV8gPSB0aGlzLmluZGV4U3RhcnRWYWx1ZV87XG4gICAgICAgIGNvcHkuc3RhcnROYW1lU2V0XyA9IHRoaXMuc3RhcnROYW1lU2V0XztcbiAgICAgICAgY29weS5pbmRleFN0YXJ0TmFtZV8gPSB0aGlzLmluZGV4U3RhcnROYW1lXztcbiAgICAgICAgY29weS5lbmRTZXRfID0gdGhpcy5lbmRTZXRfO1xuICAgICAgICBjb3B5LmluZGV4RW5kVmFsdWVfID0gdGhpcy5pbmRleEVuZFZhbHVlXztcbiAgICAgICAgY29weS5lbmROYW1lU2V0XyA9IHRoaXMuZW5kTmFtZVNldF87XG4gICAgICAgIGNvcHkuaW5kZXhFbmROYW1lXyA9IHRoaXMuaW5kZXhFbmROYW1lXztcbiAgICAgICAgY29weS5pbmRleF8gPSB0aGlzLmluZGV4XztcbiAgICAgICAgY29weS52aWV3RnJvbV8gPSB0aGlzLnZpZXdGcm9tXztcbiAgICAgICAgcmV0dXJuIGNvcHk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFudW1iZXJ9IG5ld0xpbWl0XG4gICAgICogQHJldHVybiB7IVF1ZXJ5UGFyYW1zfVxuICAgICAqL1xuICAgIFF1ZXJ5UGFyYW1zLnByb3RvdHlwZS5saW1pdCA9IGZ1bmN0aW9uIChuZXdMaW1pdCkge1xuICAgICAgICB2YXIgbmV3UGFyYW1zID0gdGhpcy5jb3B5XygpO1xuICAgICAgICBuZXdQYXJhbXMubGltaXRTZXRfID0gdHJ1ZTtcbiAgICAgICAgbmV3UGFyYW1zLmxpbWl0XyA9IG5ld0xpbWl0O1xuICAgICAgICBuZXdQYXJhbXMudmlld0Zyb21fID0gJyc7XG4gICAgICAgIHJldHVybiBuZXdQYXJhbXM7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFudW1iZXJ9IG5ld0xpbWl0XG4gICAgICogQHJldHVybiB7IVF1ZXJ5UGFyYW1zfVxuICAgICAqL1xuICAgIFF1ZXJ5UGFyYW1zLnByb3RvdHlwZS5saW1pdFRvRmlyc3QgPSBmdW5jdGlvbiAobmV3TGltaXQpIHtcbiAgICAgICAgdmFyIG5ld1BhcmFtcyA9IHRoaXMuY29weV8oKTtcbiAgICAgICAgbmV3UGFyYW1zLmxpbWl0U2V0XyA9IHRydWU7XG4gICAgICAgIG5ld1BhcmFtcy5saW1pdF8gPSBuZXdMaW1pdDtcbiAgICAgICAgbmV3UGFyYW1zLnZpZXdGcm9tXyA9IFF1ZXJ5UGFyYW1zLldJUkVfUFJPVE9DT0xfQ09OU1RBTlRTXy5WSUVXX0ZST01fTEVGVDtcbiAgICAgICAgcmV0dXJuIG5ld1BhcmFtcztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7IW51bWJlcn0gbmV3TGltaXRcbiAgICAgKiBAcmV0dXJuIHshUXVlcnlQYXJhbXN9XG4gICAgICovXG4gICAgUXVlcnlQYXJhbXMucHJvdG90eXBlLmxpbWl0VG9MYXN0ID0gZnVuY3Rpb24gKG5ld0xpbWl0KSB7XG4gICAgICAgIHZhciBuZXdQYXJhbXMgPSB0aGlzLmNvcHlfKCk7XG4gICAgICAgIG5ld1BhcmFtcy5saW1pdFNldF8gPSB0cnVlO1xuICAgICAgICBuZXdQYXJhbXMubGltaXRfID0gbmV3TGltaXQ7XG4gICAgICAgIG5ld1BhcmFtcy52aWV3RnJvbV8gPSBRdWVyeVBhcmFtcy5XSVJFX1BST1RPQ09MX0NPTlNUQU5UU18uVklFV19GUk9NX1JJR0hUO1xuICAgICAgICByZXR1cm4gbmV3UGFyYW1zO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHsqfSBpbmRleFZhbHVlXG4gICAgICogQHBhcmFtIHs/c3RyaW5nPX0ga2V5XG4gICAgICogQHJldHVybiB7IVF1ZXJ5UGFyYW1zfVxuICAgICAqL1xuICAgIFF1ZXJ5UGFyYW1zLnByb3RvdHlwZS5zdGFydEF0ID0gZnVuY3Rpb24gKGluZGV4VmFsdWUsIGtleSkge1xuICAgICAgICB2YXIgbmV3UGFyYW1zID0gdGhpcy5jb3B5XygpO1xuICAgICAgICBuZXdQYXJhbXMuc3RhcnRTZXRfID0gdHJ1ZTtcbiAgICAgICAgaWYgKCEoaW5kZXhWYWx1ZSAhPT0gdW5kZWZpbmVkKSkge1xuICAgICAgICAgICAgaW5kZXhWYWx1ZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgbmV3UGFyYW1zLmluZGV4U3RhcnRWYWx1ZV8gPSBpbmRleFZhbHVlO1xuICAgICAgICBpZiAoa2V5ICE9IG51bGwpIHtcbiAgICAgICAgICAgIG5ld1BhcmFtcy5zdGFydE5hbWVTZXRfID0gdHJ1ZTtcbiAgICAgICAgICAgIG5ld1BhcmFtcy5pbmRleFN0YXJ0TmFtZV8gPSBrZXk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBuZXdQYXJhbXMuc3RhcnROYW1lU2V0XyA9IGZhbHNlO1xuICAgICAgICAgICAgbmV3UGFyYW1zLmluZGV4U3RhcnROYW1lXyA9ICcnO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXdQYXJhbXM7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyp9IGluZGV4VmFsdWVcbiAgICAgKiBAcGFyYW0gez9zdHJpbmc9fSBrZXlcbiAgICAgKiBAcmV0dXJuIHshUXVlcnlQYXJhbXN9XG4gICAgICovXG4gICAgUXVlcnlQYXJhbXMucHJvdG90eXBlLmVuZEF0ID0gZnVuY3Rpb24gKGluZGV4VmFsdWUsIGtleSkge1xuICAgICAgICB2YXIgbmV3UGFyYW1zID0gdGhpcy5jb3B5XygpO1xuICAgICAgICBuZXdQYXJhbXMuZW5kU2V0XyA9IHRydWU7XG4gICAgICAgIGlmICghKGluZGV4VmFsdWUgIT09IHVuZGVmaW5lZCkpIHtcbiAgICAgICAgICAgIGluZGV4VmFsdWUgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIG5ld1BhcmFtcy5pbmRleEVuZFZhbHVlXyA9IGluZGV4VmFsdWU7XG4gICAgICAgIGlmIChrZXkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgbmV3UGFyYW1zLmVuZE5hbWVTZXRfID0gdHJ1ZTtcbiAgICAgICAgICAgIG5ld1BhcmFtcy5pbmRleEVuZE5hbWVfID0ga2V5O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbmV3UGFyYW1zLmVuZE5hbWVTZXRfID0gZmFsc2U7XG4gICAgICAgICAgICBuZXdQYXJhbXMuaW5kZXhFbmROYW1lXyA9ICcnO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXdQYXJhbXM7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFJbmRleH0gaW5kZXhcbiAgICAgKiBAcmV0dXJuIHshUXVlcnlQYXJhbXN9XG4gICAgICovXG4gICAgUXVlcnlQYXJhbXMucHJvdG90eXBlLm9yZGVyQnkgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgdmFyIG5ld1BhcmFtcyA9IHRoaXMuY29weV8oKTtcbiAgICAgICAgbmV3UGFyYW1zLmluZGV4XyA9IGluZGV4O1xuICAgICAgICByZXR1cm4gbmV3UGFyYW1zO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7IU9iamVjdH1cbiAgICAgKi9cbiAgICBRdWVyeVBhcmFtcy5wcm90b3R5cGUuZ2V0UXVlcnlPYmplY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBXSVJFX1BST1RPQ09MX0NPTlNUQU5UUyA9IFF1ZXJ5UGFyYW1zLldJUkVfUFJPVE9DT0xfQ09OU1RBTlRTXztcbiAgICAgICAgdmFyIG9iaiA9IHt9O1xuICAgICAgICBpZiAodGhpcy5zdGFydFNldF8pIHtcbiAgICAgICAgICAgIG9ialtXSVJFX1BST1RPQ09MX0NPTlNUQU5UUy5JTkRFWF9TVEFSVF9WQUxVRV0gPSB0aGlzLmluZGV4U3RhcnRWYWx1ZV87XG4gICAgICAgICAgICBpZiAodGhpcy5zdGFydE5hbWVTZXRfKSB7XG4gICAgICAgICAgICAgICAgb2JqW1dJUkVfUFJPVE9DT0xfQ09OU1RBTlRTLklOREVYX1NUQVJUX05BTUVdID0gdGhpcy5pbmRleFN0YXJ0TmFtZV87XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZW5kU2V0Xykge1xuICAgICAgICAgICAgb2JqW1dJUkVfUFJPVE9DT0xfQ09OU1RBTlRTLklOREVYX0VORF9WQUxVRV0gPSB0aGlzLmluZGV4RW5kVmFsdWVfO1xuICAgICAgICAgICAgaWYgKHRoaXMuZW5kTmFtZVNldF8pIHtcbiAgICAgICAgICAgICAgICBvYmpbV0lSRV9QUk9UT0NPTF9DT05TVEFOVFMuSU5ERVhfRU5EX05BTUVdID0gdGhpcy5pbmRleEVuZE5hbWVfO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmxpbWl0U2V0Xykge1xuICAgICAgICAgICAgb2JqW1dJUkVfUFJPVE9DT0xfQ09OU1RBTlRTLkxJTUlUXSA9IHRoaXMubGltaXRfO1xuICAgICAgICAgICAgdmFyIHZpZXdGcm9tID0gdGhpcy52aWV3RnJvbV87XG4gICAgICAgICAgICBpZiAodmlld0Zyb20gPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNWaWV3RnJvbUxlZnQoKSkge1xuICAgICAgICAgICAgICAgICAgICB2aWV3RnJvbSA9IFdJUkVfUFJPVE9DT0xfQ09OU1RBTlRTLlZJRVdfRlJPTV9MRUZUO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmlld0Zyb20gPSBXSVJFX1BST1RPQ09MX0NPTlNUQU5UUy5WSUVXX0ZST01fUklHSFQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb2JqW1dJUkVfUFJPVE9DT0xfQ09OU1RBTlRTLlZJRVdfRlJPTV0gPSB2aWV3RnJvbTtcbiAgICAgICAgfVxuICAgICAgICAvLyBGb3Igbm93LCBwcmlvcml0eSBpbmRleCBpcyB0aGUgZGVmYXVsdCwgc28gd2Ugb25seSBzcGVjaWZ5IGlmIGl0J3Mgc29tZSBvdGhlciBpbmRleFxuICAgICAgICBpZiAodGhpcy5pbmRleF8gIT09IFByaW9yaXR5SW5kZXhfMS5QUklPUklUWV9JTkRFWCkge1xuICAgICAgICAgICAgb2JqW1dJUkVfUFJPVE9DT0xfQ09OU1RBTlRTLklOREVYXSA9IHRoaXMuaW5kZXhfLnRvU3RyaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAgICovXG4gICAgUXVlcnlQYXJhbXMucHJvdG90eXBlLmxvYWRzQWxsRGF0YSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICEodGhpcy5zdGFydFNldF8gfHwgdGhpcy5lbmRTZXRfIHx8IHRoaXMubGltaXRTZXRfKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAgICovXG4gICAgUXVlcnlQYXJhbXMucHJvdG90eXBlLmlzRGVmYXVsdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9hZHNBbGxEYXRhKCkgJiYgdGhpcy5pbmRleF8gPT0gUHJpb3JpdHlJbmRleF8xLlBSSU9SSVRZX0lOREVYO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7IU5vZGVGaWx0ZXJ9XG4gICAgICovXG4gICAgUXVlcnlQYXJhbXMucHJvdG90eXBlLmdldE5vZGVGaWx0ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmxvYWRzQWxsRGF0YSgpKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEluZGV4ZWRGaWx0ZXJfMS5JbmRleGVkRmlsdGVyKHRoaXMuZ2V0SW5kZXgoKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5oYXNMaW1pdCgpKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IExpbWl0ZWRGaWx0ZXJfMS5MaW1pdGVkRmlsdGVyKHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBSYW5nZWRGaWx0ZXJfMS5SYW5nZWRGaWx0ZXIodGhpcyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBzZXQgb2YgUkVTVCBxdWVyeSBzdHJpbmcgcGFyYW1ldGVycyByZXByZXNlbnRpbmcgdGhpcyBxdWVyeS5cbiAgICAgKlxuICAgICAqIEByZXR1cm4geyFPYmplY3QuPHN0cmluZywqPn0gcXVlcnkgc3RyaW5nIHBhcmFtZXRlcnNcbiAgICAgKi9cbiAgICBRdWVyeVBhcmFtcy5wcm90b3R5cGUudG9SZXN0UXVlcnlTdHJpbmdQYXJhbWV0ZXJzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgUkVTVF9DT05TVEFOVFMgPSBRdWVyeVBhcmFtcy5SRVNUX1FVRVJZX0NPTlNUQU5UU187XG4gICAgICAgIHZhciBxcyA9IHt9O1xuICAgICAgICBpZiAodGhpcy5pc0RlZmF1bHQoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHFzO1xuICAgICAgICB9XG4gICAgICAgIHZhciBvcmRlckJ5O1xuICAgICAgICBpZiAodGhpcy5pbmRleF8gPT09IFByaW9yaXR5SW5kZXhfMS5QUklPUklUWV9JTkRFWCkge1xuICAgICAgICAgICAgb3JkZXJCeSA9IFJFU1RfQ09OU1RBTlRTLlBSSU9SSVRZX0lOREVYO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuaW5kZXhfID09PSBWYWx1ZUluZGV4XzEuVkFMVUVfSU5ERVgpIHtcbiAgICAgICAgICAgIG9yZGVyQnkgPSBSRVNUX0NPTlNUQU5UUy5WQUxVRV9JTkRFWDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLmluZGV4XyA9PT0gS2V5SW5kZXhfMS5LRVlfSU5ERVgpIHtcbiAgICAgICAgICAgIG9yZGVyQnkgPSBSRVNUX0NPTlNUQU5UUy5LRVlfSU5ERVg7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB1dGlsXzEuYXNzZXJ0KHRoaXMuaW5kZXhfIGluc3RhbmNlb2YgUGF0aEluZGV4XzEuUGF0aEluZGV4LCAnVW5yZWNvZ25pemVkIGluZGV4IHR5cGUhJyk7XG4gICAgICAgICAgICBvcmRlckJ5ID0gdGhpcy5pbmRleF8udG9TdHJpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICBxc1tSRVNUX0NPTlNUQU5UUy5PUkRFUl9CWV0gPSB1dGlsXzMuc3RyaW5naWZ5KG9yZGVyQnkpO1xuICAgICAgICBpZiAodGhpcy5zdGFydFNldF8pIHtcbiAgICAgICAgICAgIHFzW1JFU1RfQ09OU1RBTlRTLlNUQVJUX0FUXSA9IHV0aWxfMy5zdHJpbmdpZnkodGhpcy5pbmRleFN0YXJ0VmFsdWVfKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnN0YXJ0TmFtZVNldF8pIHtcbiAgICAgICAgICAgICAgICBxc1tSRVNUX0NPTlNUQU5UUy5TVEFSVF9BVF0gKz0gJywnICsgdXRpbF8zLnN0cmluZ2lmeSh0aGlzLmluZGV4U3RhcnROYW1lXyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZW5kU2V0Xykge1xuICAgICAgICAgICAgcXNbUkVTVF9DT05TVEFOVFMuRU5EX0FUXSA9IHV0aWxfMy5zdHJpbmdpZnkodGhpcy5pbmRleEVuZFZhbHVlXyk7XG4gICAgICAgICAgICBpZiAodGhpcy5lbmROYW1lU2V0Xykge1xuICAgICAgICAgICAgICAgIHFzW1JFU1RfQ09OU1RBTlRTLkVORF9BVF0gKz0gJywnICsgdXRpbF8zLnN0cmluZ2lmeSh0aGlzLmluZGV4RW5kTmFtZV8pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmxpbWl0U2V0Xykge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNWaWV3RnJvbUxlZnQoKSkge1xuICAgICAgICAgICAgICAgIHFzW1JFU1RfQ09OU1RBTlRTLkxJTUlUX1RPX0ZJUlNUXSA9IHRoaXMubGltaXRfO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcXNbUkVTVF9DT05TVEFOVFMuTElNSVRfVE9fTEFTVF0gPSB0aGlzLmxpbWl0XztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcXM7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBXaXJlIFByb3RvY29sIENvbnN0YW50c1xuICAgICAqIEBjb25zdFxuICAgICAqIEBlbnVtIHtzdHJpbmd9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBRdWVyeVBhcmFtcy5XSVJFX1BST1RPQ09MX0NPTlNUQU5UU18gPSB7XG4gICAgICAgIElOREVYX1NUQVJUX1ZBTFVFOiAnc3AnLFxuICAgICAgICBJTkRFWF9TVEFSVF9OQU1FOiAnc24nLFxuICAgICAgICBJTkRFWF9FTkRfVkFMVUU6ICdlcCcsXG4gICAgICAgIElOREVYX0VORF9OQU1FOiAnZW4nLFxuICAgICAgICBMSU1JVDogJ2wnLFxuICAgICAgICBWSUVXX0ZST006ICd2ZicsXG4gICAgICAgIFZJRVdfRlJPTV9MRUZUOiAnbCcsXG4gICAgICAgIFZJRVdfRlJPTV9SSUdIVDogJ3InLFxuICAgICAgICBJTkRFWDogJ2knXG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSRVNUIFF1ZXJ5IENvbnN0YW50c1xuICAgICAqIEBjb25zdFxuICAgICAqIEBlbnVtIHtzdHJpbmd9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBRdWVyeVBhcmFtcy5SRVNUX1FVRVJZX0NPTlNUQU5UU18gPSB7XG4gICAgICAgIE9SREVSX0JZOiAnb3JkZXJCeScsXG4gICAgICAgIFBSSU9SSVRZX0lOREVYOiAnJHByaW9yaXR5JyxcbiAgICAgICAgVkFMVUVfSU5ERVg6ICckdmFsdWUnLFxuICAgICAgICBLRVlfSU5ERVg6ICcka2V5JyxcbiAgICAgICAgU1RBUlRfQVQ6ICdzdGFydEF0JyxcbiAgICAgICAgRU5EX0FUOiAnZW5kQXQnLFxuICAgICAgICBMSU1JVF9UT19GSVJTVDogJ2xpbWl0VG9GaXJzdCcsXG4gICAgICAgIExJTUlUX1RPX0xBU1Q6ICdsaW1pdFRvTGFzdCdcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIERlZmF1bHQsIGVtcHR5IHF1ZXJ5IHBhcmFtZXRlcnNcbiAgICAgKiBAdHlwZSB7IVF1ZXJ5UGFyYW1zfVxuICAgICAqIEBjb25zdFxuICAgICAqL1xuICAgIFF1ZXJ5UGFyYW1zLkRFRkFVTFQgPSBuZXcgUXVlcnlQYXJhbXMoKTtcbiAgICByZXR1cm4gUXVlcnlQYXJhbXM7XG59KCkpO1xuZXhwb3J0cy5RdWVyeVBhcmFtcyA9IFF1ZXJ5UGFyYW1zO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1RdWVyeVBhcmFtcy5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBJbmRleGVkRmlsdGVyXzEgPSByZXF1aXJlKFwiLi9maWx0ZXIvSW5kZXhlZEZpbHRlclwiKTtcbnZhciBWaWV3UHJvY2Vzc29yXzEgPSByZXF1aXJlKFwiLi9WaWV3UHJvY2Vzc29yXCIpO1xudmFyIENoaWxkcmVuTm9kZV8xID0gcmVxdWlyZShcIi4uL3NuYXAvQ2hpbGRyZW5Ob2RlXCIpO1xudmFyIENhY2hlTm9kZV8xID0gcmVxdWlyZShcIi4vQ2FjaGVOb2RlXCIpO1xudmFyIFZpZXdDYWNoZV8xID0gcmVxdWlyZShcIi4vVmlld0NhY2hlXCIpO1xudmFyIEV2ZW50R2VuZXJhdG9yXzEgPSByZXF1aXJlKFwiLi9FdmVudEdlbmVyYXRvclwiKTtcbnZhciB1dGlsXzEgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG52YXIgT3BlcmF0aW9uXzEgPSByZXF1aXJlKFwiLi4vb3BlcmF0aW9uL09wZXJhdGlvblwiKTtcbnZhciBDaGFuZ2VfMSA9IHJlcXVpcmUoXCIuL0NoYW5nZVwiKTtcbnZhciBQcmlvcml0eUluZGV4XzEgPSByZXF1aXJlKFwiLi4vc25hcC9pbmRleGVzL1ByaW9yaXR5SW5kZXhcIik7XG4vKipcbiAqIEEgdmlldyByZXByZXNlbnRzIGEgc3BlY2lmaWMgbG9jYXRpb24gYW5kIHF1ZXJ5IHRoYXQgaGFzIDEgb3IgbW9yZSBldmVudCByZWdpc3RyYXRpb25zLlxuICpcbiAqIEl0IGRvZXMgc2V2ZXJhbCB0aGluZ3M6XG4gKiAgLSBNYWludGFpbnMgdGhlIGxpc3Qgb2YgZXZlbnQgcmVnaXN0cmF0aW9ucyBmb3IgdGhpcyBsb2NhdGlvbi9xdWVyeS5cbiAqICAtIE1haW50YWlucyBhIGNhY2hlIG9mIHRoZSBkYXRhIHZpc2libGUgZm9yIHRoaXMgbG9jYXRpb24vcXVlcnkuXG4gKiAgLSBBcHBsaWVzIG5ldyBvcGVyYXRpb25zICh2aWEgYXBwbHlPcGVyYXRpb24pLCB1cGRhdGVzIHRoZSBjYWNoZSwgYW5kIGJhc2VkIG9uIHRoZSBldmVudFxuICogICAgcmVnaXN0cmF0aW9ucyByZXR1cm5zIHRoZSBzZXQgb2YgZXZlbnRzIHRvIGJlIHJhaXNlZC5cbiAqIEBjb25zdHJ1Y3RvclxuICovXG52YXIgVmlldyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7IVF1ZXJ5fSBxdWVyeV9cbiAgICAgKiBAcGFyYW0geyFWaWV3Q2FjaGV9IGluaXRpYWxWaWV3Q2FjaGVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBWaWV3KHF1ZXJ5XywgaW5pdGlhbFZpZXdDYWNoZSkge1xuICAgICAgICB0aGlzLnF1ZXJ5XyA9IHF1ZXJ5XztcbiAgICAgICAgdGhpcy5ldmVudFJlZ2lzdHJhdGlvbnNfID0gW107XG4gICAgICAgIHZhciBwYXJhbXMgPSB0aGlzLnF1ZXJ5Xy5nZXRRdWVyeVBhcmFtcygpO1xuICAgICAgICB2YXIgaW5kZXhGaWx0ZXIgPSBuZXcgSW5kZXhlZEZpbHRlcl8xLkluZGV4ZWRGaWx0ZXIocGFyYW1zLmdldEluZGV4KCkpO1xuICAgICAgICB2YXIgZmlsdGVyID0gcGFyYW1zLmdldE5vZGVGaWx0ZXIoKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEB0eXBlIHtWaWV3UHJvY2Vzc29yfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5wcm9jZXNzb3JfID0gbmV3IFZpZXdQcm9jZXNzb3JfMS5WaWV3UHJvY2Vzc29yKGZpbHRlcik7XG4gICAgICAgIHZhciBpbml0aWFsU2VydmVyQ2FjaGUgPSBpbml0aWFsVmlld0NhY2hlLmdldFNlcnZlckNhY2hlKCk7XG4gICAgICAgIHZhciBpbml0aWFsRXZlbnRDYWNoZSA9IGluaXRpYWxWaWV3Q2FjaGUuZ2V0RXZlbnRDYWNoZSgpO1xuICAgICAgICAvLyBEb24ndCBmaWx0ZXIgc2VydmVyIG5vZGUgd2l0aCBvdGhlciBmaWx0ZXIgdGhhbiBpbmRleCwgd2FpdCBmb3IgdGFnZ2VkIGxpc3RlblxuICAgICAgICB2YXIgc2VydmVyU25hcCA9IGluZGV4RmlsdGVyLnVwZGF0ZUZ1bGxOb2RlKENoaWxkcmVuTm9kZV8xLkNoaWxkcmVuTm9kZS5FTVBUWV9OT0RFLCBpbml0aWFsU2VydmVyQ2FjaGUuZ2V0Tm9kZSgpLCBudWxsKTtcbiAgICAgICAgdmFyIGV2ZW50U25hcCA9IGZpbHRlci51cGRhdGVGdWxsTm9kZShDaGlsZHJlbk5vZGVfMS5DaGlsZHJlbk5vZGUuRU1QVFlfTk9ERSwgaW5pdGlhbEV2ZW50Q2FjaGUuZ2V0Tm9kZSgpLCBudWxsKTtcbiAgICAgICAgdmFyIG5ld1NlcnZlckNhY2hlID0gbmV3IENhY2hlTm9kZV8xLkNhY2hlTm9kZShzZXJ2ZXJTbmFwLCBpbml0aWFsU2VydmVyQ2FjaGUuaXNGdWxseUluaXRpYWxpemVkKCksIGluZGV4RmlsdGVyLmZpbHRlcnNOb2RlcygpKTtcbiAgICAgICAgdmFyIG5ld0V2ZW50Q2FjaGUgPSBuZXcgQ2FjaGVOb2RlXzEuQ2FjaGVOb2RlKGV2ZW50U25hcCwgaW5pdGlhbEV2ZW50Q2FjaGUuaXNGdWxseUluaXRpYWxpemVkKCksIGZpbHRlci5maWx0ZXJzTm9kZXMoKSk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAdHlwZSB7IVZpZXdDYWNoZX1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudmlld0NhY2hlXyA9IG5ldyBWaWV3Q2FjaGVfMS5WaWV3Q2FjaGUobmV3RXZlbnRDYWNoZSwgbmV3U2VydmVyQ2FjaGUpO1xuICAgICAgICAvKipcbiAgICAgICAgICogQHR5cGUgeyFFdmVudEdlbmVyYXRvcn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZXZlbnRHZW5lcmF0b3JfID0gbmV3IEV2ZW50R2VuZXJhdG9yXzEuRXZlbnRHZW5lcmF0b3IodGhpcy5xdWVyeV8pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHshUXVlcnl9XG4gICAgICovXG4gICAgVmlldy5wcm90b3R5cGUuZ2V0UXVlcnkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnF1ZXJ5XztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4gez9Ob2RlfVxuICAgICAqL1xuICAgIFZpZXcucHJvdG90eXBlLmdldFNlcnZlckNhY2hlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy52aWV3Q2FjaGVfLmdldFNlcnZlckNhY2hlKCkuZ2V0Tm9kZSgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshUGF0aH0gcGF0aFxuICAgICAqIEByZXR1cm4gez9Ob2RlfVxuICAgICAqL1xuICAgIFZpZXcucHJvdG90eXBlLmdldENvbXBsZXRlU2VydmVyQ2FjaGUgPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICB2YXIgY2FjaGUgPSB0aGlzLnZpZXdDYWNoZV8uZ2V0Q29tcGxldGVTZXJ2ZXJTbmFwKCk7XG4gICAgICAgIGlmIChjYWNoZSkge1xuICAgICAgICAgICAgLy8gSWYgdGhpcyBpc24ndCBhIFwibG9hZHNBbGxEYXRhXCIgdmlldywgdGhlbiBjYWNoZSBpc24ndCBhY3R1YWxseSBhIGNvbXBsZXRlIGNhY2hlIGFuZFxuICAgICAgICAgICAgLy8gd2UgbmVlZCB0byBzZWUgaWYgaXQgY29udGFpbnMgdGhlIGNoaWxkIHdlJ3JlIGludGVyZXN0ZWQgaW4uXG4gICAgICAgICAgICBpZiAodGhpcy5xdWVyeV8uZ2V0UXVlcnlQYXJhbXMoKS5sb2Fkc0FsbERhdGEoKSB8fFxuICAgICAgICAgICAgICAgICghcGF0aC5pc0VtcHR5KCkgJiYgIWNhY2hlLmdldEltbWVkaWF0ZUNoaWxkKHBhdGguZ2V0RnJvbnQoKSkuaXNFbXB0eSgpKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjYWNoZS5nZXRDaGlsZChwYXRoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAgICovXG4gICAgVmlldy5wcm90b3R5cGUuaXNFbXB0eSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXZlbnRSZWdpc3RyYXRpb25zXy5sZW5ndGggPT09IDA7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFFdmVudFJlZ2lzdHJhdGlvbn0gZXZlbnRSZWdpc3RyYXRpb25cbiAgICAgKi9cbiAgICBWaWV3LnByb3RvdHlwZS5hZGRFdmVudFJlZ2lzdHJhdGlvbiA9IGZ1bmN0aW9uIChldmVudFJlZ2lzdHJhdGlvbikge1xuICAgICAgICB0aGlzLmV2ZW50UmVnaXN0cmF0aW9uc18ucHVzaChldmVudFJlZ2lzdHJhdGlvbik7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0gez9FdmVudFJlZ2lzdHJhdGlvbn0gZXZlbnRSZWdpc3RyYXRpb24gSWYgbnVsbCwgcmVtb3ZlIGFsbCBjYWxsYmFja3MuXG4gICAgICogQHBhcmFtIHtFcnJvcj19IGNhbmNlbEVycm9yIElmIGEgY2FuY2VsRXJyb3IgaXMgcHJvdmlkZWQsIGFwcHJvcHJpYXRlIGNhbmNlbCBldmVudHMgd2lsbCBiZSByZXR1cm5lZC5cbiAgICAgKiBAcmV0dXJuIHshQXJyYXkuPCFFdmVudD59IENhbmNlbCBldmVudHMsIGlmIGNhbmNlbEVycm9yIHdhcyBwcm92aWRlZC5cbiAgICAgKi9cbiAgICBWaWV3LnByb3RvdHlwZS5yZW1vdmVFdmVudFJlZ2lzdHJhdGlvbiA9IGZ1bmN0aW9uIChldmVudFJlZ2lzdHJhdGlvbiwgY2FuY2VsRXJyb3IpIHtcbiAgICAgICAgdmFyIGNhbmNlbEV2ZW50cyA9IFtdO1xuICAgICAgICBpZiAoY2FuY2VsRXJyb3IpIHtcbiAgICAgICAgICAgIHV0aWxfMS5hc3NlcnQoZXZlbnRSZWdpc3RyYXRpb24gPT0gbnVsbCwgJ0EgY2FuY2VsIHNob3VsZCBjYW5jZWwgYWxsIGV2ZW50IHJlZ2lzdHJhdGlvbnMuJyk7XG4gICAgICAgICAgICB2YXIgcGF0aF8xID0gdGhpcy5xdWVyeV8ucGF0aDtcbiAgICAgICAgICAgIHRoaXMuZXZlbnRSZWdpc3RyYXRpb25zXy5mb3JFYWNoKGZ1bmN0aW9uIChyZWdpc3RyYXRpb24pIHtcbiAgICAgICAgICAgICAgICBjYW5jZWxFcnJvciAvKiogQHR5cGUgeyFFcnJvcn0gKi8gPSBjYW5jZWxFcnJvcjtcbiAgICAgICAgICAgICAgICB2YXIgbWF5YmVFdmVudCA9IHJlZ2lzdHJhdGlvbi5jcmVhdGVDYW5jZWxFdmVudChjYW5jZWxFcnJvciwgcGF0aF8xKTtcbiAgICAgICAgICAgICAgICBpZiAobWF5YmVFdmVudCkge1xuICAgICAgICAgICAgICAgICAgICBjYW5jZWxFdmVudHMucHVzaChtYXliZUV2ZW50KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZXZlbnRSZWdpc3RyYXRpb24pIHtcbiAgICAgICAgICAgIHZhciByZW1haW5pbmcgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5ldmVudFJlZ2lzdHJhdGlvbnNfLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGV4aXN0aW5nID0gdGhpcy5ldmVudFJlZ2lzdHJhdGlvbnNfW2ldO1xuICAgICAgICAgICAgICAgIGlmICghZXhpc3RpbmcubWF0Y2hlcyhldmVudFJlZ2lzdHJhdGlvbikpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVtYWluaW5nLnB1c2goZXhpc3RpbmcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChldmVudFJlZ2lzdHJhdGlvbi5oYXNBbnlDYWxsYmFjaygpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFdlJ3JlIHJlbW92aW5nIGp1c3QgdGhpcyBvbmVcbiAgICAgICAgICAgICAgICAgICAgcmVtYWluaW5nID0gcmVtYWluaW5nLmNvbmNhdCh0aGlzLmV2ZW50UmVnaXN0cmF0aW9uc18uc2xpY2UoaSArIDEpKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5ldmVudFJlZ2lzdHJhdGlvbnNfID0gcmVtYWluaW5nO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5ldmVudFJlZ2lzdHJhdGlvbnNfID0gW107XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNhbmNlbEV2ZW50cztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEFwcGxpZXMgdGhlIGdpdmVuIE9wZXJhdGlvbiwgdXBkYXRlcyBvdXIgY2FjaGUsIGFuZCByZXR1cm5zIHRoZSBhcHByb3ByaWF0ZSBldmVudHMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyFPcGVyYXRpb259IG9wZXJhdGlvblxuICAgICAqIEBwYXJhbSB7IVdyaXRlVHJlZVJlZn0gd3JpdGVzQ2FjaGVcbiAgICAgKiBAcGFyYW0gez9Ob2RlfSBjb21wbGV0ZVNlcnZlckNhY2hlXG4gICAgICogQHJldHVybiB7IUFycmF5LjwhRXZlbnQ+fVxuICAgICAqL1xuICAgIFZpZXcucHJvdG90eXBlLmFwcGx5T3BlcmF0aW9uID0gZnVuY3Rpb24gKG9wZXJhdGlvbiwgd3JpdGVzQ2FjaGUsIGNvbXBsZXRlU2VydmVyQ2FjaGUpIHtcbiAgICAgICAgaWYgKG9wZXJhdGlvbi50eXBlID09PSBPcGVyYXRpb25fMS5PcGVyYXRpb25UeXBlLk1FUkdFICYmXG4gICAgICAgICAgICBvcGVyYXRpb24uc291cmNlLnF1ZXJ5SWQgIT09IG51bGwpIHtcbiAgICAgICAgICAgIHV0aWxfMS5hc3NlcnQodGhpcy52aWV3Q2FjaGVfLmdldENvbXBsZXRlU2VydmVyU25hcCgpLCAnV2Ugc2hvdWxkIGFsd2F5cyBoYXZlIGEgZnVsbCBjYWNoZSBiZWZvcmUgaGFuZGxpbmcgbWVyZ2VzJyk7XG4gICAgICAgICAgICB1dGlsXzEuYXNzZXJ0KHRoaXMudmlld0NhY2hlXy5nZXRDb21wbGV0ZUV2ZW50U25hcCgpLCAnTWlzc2luZyBldmVudCBjYWNoZSwgZXZlbiB0aG91Z2ggd2UgaGF2ZSBhIHNlcnZlciBjYWNoZScpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBvbGRWaWV3Q2FjaGUgPSB0aGlzLnZpZXdDYWNoZV87XG4gICAgICAgIHZhciByZXN1bHQgPSB0aGlzLnByb2Nlc3Nvcl8uYXBwbHlPcGVyYXRpb24ob2xkVmlld0NhY2hlLCBvcGVyYXRpb24sIHdyaXRlc0NhY2hlLCBjb21wbGV0ZVNlcnZlckNhY2hlKTtcbiAgICAgICAgdGhpcy5wcm9jZXNzb3JfLmFzc2VydEluZGV4ZWQocmVzdWx0LnZpZXdDYWNoZSk7XG4gICAgICAgIHV0aWxfMS5hc3NlcnQocmVzdWx0LnZpZXdDYWNoZS5nZXRTZXJ2ZXJDYWNoZSgpLmlzRnVsbHlJbml0aWFsaXplZCgpIHx8XG4gICAgICAgICAgICAhb2xkVmlld0NhY2hlLmdldFNlcnZlckNhY2hlKCkuaXNGdWxseUluaXRpYWxpemVkKCksICdPbmNlIGEgc2VydmVyIHNuYXAgaXMgY29tcGxldGUsIGl0IHNob3VsZCBuZXZlciBnbyBiYWNrJyk7XG4gICAgICAgIHRoaXMudmlld0NhY2hlXyA9IHJlc3VsdC52aWV3Q2FjaGU7XG4gICAgICAgIHJldHVybiB0aGlzLmdlbmVyYXRlRXZlbnRzRm9yQ2hhbmdlc18ocmVzdWx0LmNoYW5nZXMsIHJlc3VsdC52aWV3Q2FjaGUuZ2V0RXZlbnRDYWNoZSgpLmdldE5vZGUoKSwgbnVsbCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFFdmVudFJlZ2lzdHJhdGlvbn0gcmVnaXN0cmF0aW9uXG4gICAgICogQHJldHVybiB7IUFycmF5LjwhRXZlbnQ+fVxuICAgICAqL1xuICAgIFZpZXcucHJvdG90eXBlLmdldEluaXRpYWxFdmVudHMgPSBmdW5jdGlvbiAocmVnaXN0cmF0aW9uKSB7XG4gICAgICAgIHZhciBldmVudFNuYXAgPSB0aGlzLnZpZXdDYWNoZV8uZ2V0RXZlbnRDYWNoZSgpO1xuICAgICAgICB2YXIgaW5pdGlhbENoYW5nZXMgPSBbXTtcbiAgICAgICAgaWYgKCFldmVudFNuYXAuZ2V0Tm9kZSgpLmlzTGVhZk5vZGUoKSkge1xuICAgICAgICAgICAgdmFyIGV2ZW50Tm9kZSA9IGV2ZW50U25hcC5nZXROb2RlKCk7XG4gICAgICAgICAgICBldmVudE5vZGUuZm9yRWFjaENoaWxkKFByaW9yaXR5SW5kZXhfMS5QUklPUklUWV9JTkRFWCwgZnVuY3Rpb24gKGtleSwgY2hpbGROb2RlKSB7XG4gICAgICAgICAgICAgICAgaW5pdGlhbENoYW5nZXMucHVzaChDaGFuZ2VfMS5DaGFuZ2UuY2hpbGRBZGRlZENoYW5nZShrZXksIGNoaWxkTm9kZSkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV2ZW50U25hcC5pc0Z1bGx5SW5pdGlhbGl6ZWQoKSkge1xuICAgICAgICAgICAgaW5pdGlhbENoYW5nZXMucHVzaChDaGFuZ2VfMS5DaGFuZ2UudmFsdWVDaGFuZ2UoZXZlbnRTbmFwLmdldE5vZGUoKSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmdlbmVyYXRlRXZlbnRzRm9yQ2hhbmdlc18oaW5pdGlhbENoYW5nZXMsIGV2ZW50U25hcC5nZXROb2RlKCksIHJlZ2lzdHJhdGlvbik7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7IUFycmF5LjwhQ2hhbmdlPn0gY2hhbmdlc1xuICAgICAqIEBwYXJhbSB7IU5vZGV9IGV2ZW50Q2FjaGVcbiAgICAgKiBAcGFyYW0ge0V2ZW50UmVnaXN0cmF0aW9uPX0gZXZlbnRSZWdpc3RyYXRpb25cbiAgICAgKiBAcmV0dXJuIHshQXJyYXkuPCFFdmVudD59XG4gICAgICovXG4gICAgVmlldy5wcm90b3R5cGUuZ2VuZXJhdGVFdmVudHNGb3JDaGFuZ2VzXyA9IGZ1bmN0aW9uIChjaGFuZ2VzLCBldmVudENhY2hlLCBldmVudFJlZ2lzdHJhdGlvbikge1xuICAgICAgICB2YXIgcmVnaXN0cmF0aW9ucyA9IGV2ZW50UmVnaXN0cmF0aW9uXG4gICAgICAgICAgICA/IFtldmVudFJlZ2lzdHJhdGlvbl1cbiAgICAgICAgICAgIDogdGhpcy5ldmVudFJlZ2lzdHJhdGlvbnNfO1xuICAgICAgICByZXR1cm4gdGhpcy5ldmVudEdlbmVyYXRvcl8uZ2VuZXJhdGVFdmVudHNGb3JDaGFuZ2VzKGNoYW5nZXMsIGV2ZW50Q2FjaGUsIHJlZ2lzdHJhdGlvbnMpO1xuICAgIH07XG4gICAgcmV0dXJuIFZpZXc7XG59KCkpO1xuZXhwb3J0cy5WaWV3ID0gVmlldztcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Vmlldy5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBDaGlsZHJlbk5vZGVfMSA9IHJlcXVpcmUoXCIuLi9zbmFwL0NoaWxkcmVuTm9kZVwiKTtcbnZhciBDYWNoZU5vZGVfMSA9IHJlcXVpcmUoXCIuL0NhY2hlTm9kZVwiKTtcbi8qKlxuICogU3RvcmVzIHRoZSBkYXRhIHdlIGhhdmUgY2FjaGVkIGZvciBhIHZpZXcuXG4gKlxuICogc2VydmVyU25hcCBpcyB0aGUgY2FjaGVkIHNlcnZlciBkYXRhLCBldmVudFNuYXAgaXMgdGhlIGNhY2hlZCBldmVudCBkYXRhIChzZXJ2ZXIgZGF0YSBwbHVzIGFueSBsb2NhbCB3cml0ZXMpLlxuICpcbiAqIEBjb25zdHJ1Y3RvclxuICovXG52YXIgVmlld0NhY2hlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqXG4gICAgICogQHBhcmFtIHshQ2FjaGVOb2RlfSBldmVudENhY2hlX1xuICAgICAqIEBwYXJhbSB7IUNhY2hlTm9kZX0gc2VydmVyQ2FjaGVfXG4gICAgICovXG4gICAgZnVuY3Rpb24gVmlld0NhY2hlKGV2ZW50Q2FjaGVfLCBzZXJ2ZXJDYWNoZV8pIHtcbiAgICAgICAgdGhpcy5ldmVudENhY2hlXyA9IGV2ZW50Q2FjaGVfO1xuICAgICAgICB0aGlzLnNlcnZlckNhY2hlXyA9IHNlcnZlckNhY2hlXztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshTm9kZX0gZXZlbnRTbmFwXG4gICAgICogQHBhcmFtIHtib29sZWFufSBjb21wbGV0ZVxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gZmlsdGVyZWRcbiAgICAgKiBAcmV0dXJuIHshVmlld0NhY2hlfVxuICAgICAqL1xuICAgIFZpZXdDYWNoZS5wcm90b3R5cGUudXBkYXRlRXZlbnRTbmFwID0gZnVuY3Rpb24gKGV2ZW50U25hcCwgY29tcGxldGUsIGZpbHRlcmVkKSB7XG4gICAgICAgIHJldHVybiBuZXcgVmlld0NhY2hlKG5ldyBDYWNoZU5vZGVfMS5DYWNoZU5vZGUoZXZlbnRTbmFwLCBjb21wbGV0ZSwgZmlsdGVyZWQpLCB0aGlzLnNlcnZlckNhY2hlXyk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFOb2RlfSBzZXJ2ZXJTbmFwXG4gICAgICogQHBhcmFtIHtib29sZWFufSBjb21wbGV0ZVxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gZmlsdGVyZWRcbiAgICAgKiBAcmV0dXJuIHshVmlld0NhY2hlfVxuICAgICAqL1xuICAgIFZpZXdDYWNoZS5wcm90b3R5cGUudXBkYXRlU2VydmVyU25hcCA9IGZ1bmN0aW9uIChzZXJ2ZXJTbmFwLCBjb21wbGV0ZSwgZmlsdGVyZWQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBWaWV3Q2FjaGUodGhpcy5ldmVudENhY2hlXywgbmV3IENhY2hlTm9kZV8xLkNhY2hlTm9kZShzZXJ2ZXJTbmFwLCBjb21wbGV0ZSwgZmlsdGVyZWQpKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4geyFDYWNoZU5vZGV9XG4gICAgICovXG4gICAgVmlld0NhY2hlLnByb3RvdHlwZS5nZXRFdmVudENhY2hlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ldmVudENhY2hlXztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4gez9Ob2RlfVxuICAgICAqL1xuICAgIFZpZXdDYWNoZS5wcm90b3R5cGUuZ2V0Q29tcGxldGVFdmVudFNuYXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmV2ZW50Q2FjaGVfLmlzRnVsbHlJbml0aWFsaXplZCgpXG4gICAgICAgICAgICA/IHRoaXMuZXZlbnRDYWNoZV8uZ2V0Tm9kZSgpXG4gICAgICAgICAgICA6IG51bGw7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHshQ2FjaGVOb2RlfVxuICAgICAqL1xuICAgIFZpZXdDYWNoZS5wcm90b3R5cGUuZ2V0U2VydmVyQ2FjaGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNlcnZlckNhY2hlXztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4gez9Ob2RlfVxuICAgICAqL1xuICAgIFZpZXdDYWNoZS5wcm90b3R5cGUuZ2V0Q29tcGxldGVTZXJ2ZXJTbmFwID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zZXJ2ZXJDYWNoZV8uaXNGdWxseUluaXRpYWxpemVkKClcbiAgICAgICAgICAgID8gdGhpcy5zZXJ2ZXJDYWNoZV8uZ2V0Tm9kZSgpXG4gICAgICAgICAgICA6IG51bGw7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAY29uc3RcbiAgICAgKiBAdHlwZSB7Vmlld0NhY2hlfVxuICAgICAqL1xuICAgIFZpZXdDYWNoZS5FbXB0eSA9IG5ldyBWaWV3Q2FjaGUobmV3IENhY2hlTm9kZV8xLkNhY2hlTm9kZShDaGlsZHJlbk5vZGVfMS5DaGlsZHJlbk5vZGUuRU1QVFlfTk9ERSwgXG4gICAgLypmdWxseUluaXRpYWxpemVkPSovIGZhbHNlLCBcbiAgICAvKmZpbHRlcmVkPSovIGZhbHNlKSwgbmV3IENhY2hlTm9kZV8xLkNhY2hlTm9kZShDaGlsZHJlbk5vZGVfMS5DaGlsZHJlbk5vZGUuRU1QVFlfTk9ERSwgXG4gICAgLypmdWxseUluaXRpYWxpemVkPSovIGZhbHNlLCBcbiAgICAvKmZpbHRlcmVkPSovIGZhbHNlKSk7XG4gICAgcmV0dXJuIFZpZXdDYWNoZTtcbn0oKSk7XG5leHBvcnRzLlZpZXdDYWNoZSA9IFZpZXdDYWNoZTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Vmlld0NhY2hlLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIE9wZXJhdGlvbl8xID0gcmVxdWlyZShcIi4uL29wZXJhdGlvbi9PcGVyYXRpb25cIik7XG52YXIgdXRpbF8xID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xudmFyIENoaWxkQ2hhbmdlQWNjdW11bGF0b3JfMSA9IHJlcXVpcmUoXCIuL0NoaWxkQ2hhbmdlQWNjdW11bGF0b3JcIik7XG52YXIgQ2hhbmdlXzEgPSByZXF1aXJlKFwiLi9DaGFuZ2VcIik7XG52YXIgQ2hpbGRyZW5Ob2RlXzEgPSByZXF1aXJlKFwiLi4vc25hcC9DaGlsZHJlbk5vZGVcIik7XG52YXIgS2V5SW5kZXhfMSA9IHJlcXVpcmUoXCIuLi9zbmFwL2luZGV4ZXMvS2V5SW5kZXhcIik7XG52YXIgSW1tdXRhYmxlVHJlZV8xID0gcmVxdWlyZShcIi4uL3V0aWwvSW1tdXRhYmxlVHJlZVwiKTtcbnZhciBQYXRoXzEgPSByZXF1aXJlKFwiLi4vdXRpbC9QYXRoXCIpO1xudmFyIENvbXBsZXRlQ2hpbGRTb3VyY2VfMSA9IHJlcXVpcmUoXCIuL0NvbXBsZXRlQ2hpbGRTb3VyY2VcIik7XG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHN0cnVjdFxuICovXG52YXIgUHJvY2Vzc29yUmVzdWx0ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7IVZpZXdDYWNoZX0gdmlld0NhY2hlXG4gICAgICogQHBhcmFtIHshQXJyYXkuPCFDaGFuZ2U+fSBjaGFuZ2VzXG4gICAgICovXG4gICAgZnVuY3Rpb24gUHJvY2Vzc29yUmVzdWx0KHZpZXdDYWNoZSwgY2hhbmdlcykge1xuICAgICAgICB0aGlzLnZpZXdDYWNoZSA9IHZpZXdDYWNoZTtcbiAgICAgICAgdGhpcy5jaGFuZ2VzID0gY2hhbmdlcztcbiAgICB9XG4gICAgcmV0dXJuIFByb2Nlc3NvclJlc3VsdDtcbn0oKSk7XG5leHBvcnRzLlByb2Nlc3NvclJlc3VsdCA9IFByb2Nlc3NvclJlc3VsdDtcbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKi9cbnZhciBWaWV3UHJvY2Vzc29yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7IU5vZGVGaWx0ZXJ9IGZpbHRlcl9cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBWaWV3UHJvY2Vzc29yKGZpbHRlcl8pIHtcbiAgICAgICAgdGhpcy5maWx0ZXJfID0gZmlsdGVyXztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshVmlld0NhY2hlfSB2aWV3Q2FjaGVcbiAgICAgKi9cbiAgICBWaWV3UHJvY2Vzc29yLnByb3RvdHlwZS5hc3NlcnRJbmRleGVkID0gZnVuY3Rpb24gKHZpZXdDYWNoZSkge1xuICAgICAgICB1dGlsXzEuYXNzZXJ0KHZpZXdDYWNoZVxuICAgICAgICAgICAgLmdldEV2ZW50Q2FjaGUoKVxuICAgICAgICAgICAgLmdldE5vZGUoKVxuICAgICAgICAgICAgLmlzSW5kZXhlZCh0aGlzLmZpbHRlcl8uZ2V0SW5kZXgoKSksICdFdmVudCBzbmFwIG5vdCBpbmRleGVkJyk7XG4gICAgICAgIHV0aWxfMS5hc3NlcnQodmlld0NhY2hlXG4gICAgICAgICAgICAuZ2V0U2VydmVyQ2FjaGUoKVxuICAgICAgICAgICAgLmdldE5vZGUoKVxuICAgICAgICAgICAgLmlzSW5kZXhlZCh0aGlzLmZpbHRlcl8uZ2V0SW5kZXgoKSksICdTZXJ2ZXIgc25hcCBub3QgaW5kZXhlZCcpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshVmlld0NhY2hlfSBvbGRWaWV3Q2FjaGVcbiAgICAgKiBAcGFyYW0geyFPcGVyYXRpb259IG9wZXJhdGlvblxuICAgICAqIEBwYXJhbSB7IVdyaXRlVHJlZVJlZn0gd3JpdGVzQ2FjaGVcbiAgICAgKiBAcGFyYW0gez9Ob2RlfSBjb21wbGV0ZUNhY2hlXG4gICAgICogQHJldHVybiB7IVByb2Nlc3NvclJlc3VsdH1cbiAgICAgKi9cbiAgICBWaWV3UHJvY2Vzc29yLnByb3RvdHlwZS5hcHBseU9wZXJhdGlvbiA9IGZ1bmN0aW9uIChvbGRWaWV3Q2FjaGUsIG9wZXJhdGlvbiwgd3JpdGVzQ2FjaGUsIGNvbXBsZXRlQ2FjaGUpIHtcbiAgICAgICAgdmFyIGFjY3VtdWxhdG9yID0gbmV3IENoaWxkQ2hhbmdlQWNjdW11bGF0b3JfMS5DaGlsZENoYW5nZUFjY3VtdWxhdG9yKCk7XG4gICAgICAgIHZhciBuZXdWaWV3Q2FjaGUsIGZpbHRlclNlcnZlck5vZGU7XG4gICAgICAgIGlmIChvcGVyYXRpb24udHlwZSA9PT0gT3BlcmF0aW9uXzEuT3BlcmF0aW9uVHlwZS5PVkVSV1JJVEUpIHtcbiAgICAgICAgICAgIHZhciBvdmVyd3JpdGUgPSBvcGVyYXRpb247XG4gICAgICAgICAgICBpZiAob3ZlcndyaXRlLnNvdXJjZS5mcm9tVXNlcikge1xuICAgICAgICAgICAgICAgIG5ld1ZpZXdDYWNoZSA9IHRoaXMuYXBwbHlVc2VyT3ZlcndyaXRlXyhvbGRWaWV3Q2FjaGUsIG92ZXJ3cml0ZS5wYXRoLCBvdmVyd3JpdGUuc25hcCwgd3JpdGVzQ2FjaGUsIGNvbXBsZXRlQ2FjaGUsIGFjY3VtdWxhdG9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHV0aWxfMS5hc3NlcnQob3ZlcndyaXRlLnNvdXJjZS5mcm9tU2VydmVyLCAnVW5rbm93biBzb3VyY2UuJyk7XG4gICAgICAgICAgICAgICAgLy8gV2UgZmlsdGVyIHRoZSBub2RlIGlmIGl0J3MgYSB0YWdnZWQgdXBkYXRlIG9yIHRoZSBub2RlIGhhcyBiZWVuIHByZXZpb3VzbHkgZmlsdGVyZWQgIGFuZCB0aGVcbiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgaXMgbm90IGF0IHRoZSByb290IGluIHdoaWNoIGNhc2UgaXQgaXMgb2sgKGFuZCBuZWNlc3NhcnkpIHRvIG1hcmsgdGhlIG5vZGUgdW5maWx0ZXJlZFxuICAgICAgICAgICAgICAgIC8vIGFnYWluXG4gICAgICAgICAgICAgICAgZmlsdGVyU2VydmVyTm9kZSA9XG4gICAgICAgICAgICAgICAgICAgIG92ZXJ3cml0ZS5zb3VyY2UudGFnZ2VkIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAob2xkVmlld0NhY2hlLmdldFNlcnZlckNhY2hlKCkuaXNGaWx0ZXJlZCgpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIW92ZXJ3cml0ZS5wYXRoLmlzRW1wdHkoKSk7XG4gICAgICAgICAgICAgICAgbmV3Vmlld0NhY2hlID0gdGhpcy5hcHBseVNlcnZlck92ZXJ3cml0ZV8ob2xkVmlld0NhY2hlLCBvdmVyd3JpdGUucGF0aCwgb3ZlcndyaXRlLnNuYXAsIHdyaXRlc0NhY2hlLCBjb21wbGV0ZUNhY2hlLCBmaWx0ZXJTZXJ2ZXJOb2RlLCBhY2N1bXVsYXRvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAob3BlcmF0aW9uLnR5cGUgPT09IE9wZXJhdGlvbl8xLk9wZXJhdGlvblR5cGUuTUVSR0UpIHtcbiAgICAgICAgICAgIHZhciBtZXJnZSA9IG9wZXJhdGlvbjtcbiAgICAgICAgICAgIGlmIChtZXJnZS5zb3VyY2UuZnJvbVVzZXIpIHtcbiAgICAgICAgICAgICAgICBuZXdWaWV3Q2FjaGUgPSB0aGlzLmFwcGx5VXNlck1lcmdlXyhvbGRWaWV3Q2FjaGUsIG1lcmdlLnBhdGgsIG1lcmdlLmNoaWxkcmVuLCB3cml0ZXNDYWNoZSwgY29tcGxldGVDYWNoZSwgYWNjdW11bGF0b3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdXRpbF8xLmFzc2VydChtZXJnZS5zb3VyY2UuZnJvbVNlcnZlciwgJ1Vua25vd24gc291cmNlLicpO1xuICAgICAgICAgICAgICAgIC8vIFdlIGZpbHRlciB0aGUgbm9kZSBpZiBpdCdzIGEgdGFnZ2VkIHVwZGF0ZSBvciB0aGUgbm9kZSBoYXMgYmVlbiBwcmV2aW91c2x5IGZpbHRlcmVkXG4gICAgICAgICAgICAgICAgZmlsdGVyU2VydmVyTm9kZSA9XG4gICAgICAgICAgICAgICAgICAgIG1lcmdlLnNvdXJjZS50YWdnZWQgfHwgb2xkVmlld0NhY2hlLmdldFNlcnZlckNhY2hlKCkuaXNGaWx0ZXJlZCgpO1xuICAgICAgICAgICAgICAgIG5ld1ZpZXdDYWNoZSA9IHRoaXMuYXBwbHlTZXJ2ZXJNZXJnZV8ob2xkVmlld0NhY2hlLCBtZXJnZS5wYXRoLCBtZXJnZS5jaGlsZHJlbiwgd3JpdGVzQ2FjaGUsIGNvbXBsZXRlQ2FjaGUsIGZpbHRlclNlcnZlck5vZGUsIGFjY3VtdWxhdG9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChvcGVyYXRpb24udHlwZSA9PT0gT3BlcmF0aW9uXzEuT3BlcmF0aW9uVHlwZS5BQ0tfVVNFUl9XUklURSkge1xuICAgICAgICAgICAgdmFyIGFja1VzZXJXcml0ZSA9IG9wZXJhdGlvbjtcbiAgICAgICAgICAgIGlmICghYWNrVXNlcldyaXRlLnJldmVydCkge1xuICAgICAgICAgICAgICAgIG5ld1ZpZXdDYWNoZSA9IHRoaXMuYWNrVXNlcldyaXRlXyhvbGRWaWV3Q2FjaGUsIGFja1VzZXJXcml0ZS5wYXRoLCBhY2tVc2VyV3JpdGUuYWZmZWN0ZWRUcmVlLCB3cml0ZXNDYWNoZSwgY29tcGxldGVDYWNoZSwgYWNjdW11bGF0b3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbmV3Vmlld0NhY2hlID0gdGhpcy5yZXZlcnRVc2VyV3JpdGVfKG9sZFZpZXdDYWNoZSwgYWNrVXNlcldyaXRlLnBhdGgsIHdyaXRlc0NhY2hlLCBjb21wbGV0ZUNhY2hlLCBhY2N1bXVsYXRvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAob3BlcmF0aW9uLnR5cGUgPT09IE9wZXJhdGlvbl8xLk9wZXJhdGlvblR5cGUuTElTVEVOX0NPTVBMRVRFKSB7XG4gICAgICAgICAgICBuZXdWaWV3Q2FjaGUgPSB0aGlzLmxpc3RlbkNvbXBsZXRlXyhvbGRWaWV3Q2FjaGUsIG9wZXJhdGlvbi5wYXRoLCB3cml0ZXNDYWNoZSwgYWNjdW11bGF0b3IpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgdXRpbF8xLmFzc2VydGlvbkVycm9yKCdVbmtub3duIG9wZXJhdGlvbiB0eXBlOiAnICsgb3BlcmF0aW9uLnR5cGUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjaGFuZ2VzID0gYWNjdW11bGF0b3IuZ2V0Q2hhbmdlcygpO1xuICAgICAgICBWaWV3UHJvY2Vzc29yLm1heWJlQWRkVmFsdWVFdmVudF8ob2xkVmlld0NhY2hlLCBuZXdWaWV3Q2FjaGUsIGNoYW5nZXMpO1xuICAgICAgICByZXR1cm4gbmV3IFByb2Nlc3NvclJlc3VsdChuZXdWaWV3Q2FjaGUsIGNoYW5nZXMpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshVmlld0NhY2hlfSBvbGRWaWV3Q2FjaGVcbiAgICAgKiBAcGFyYW0geyFWaWV3Q2FjaGV9IG5ld1ZpZXdDYWNoZVxuICAgICAqIEBwYXJhbSB7IUFycmF5LjwhQ2hhbmdlPn0gYWNjdW11bGF0b3JcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIFZpZXdQcm9jZXNzb3IubWF5YmVBZGRWYWx1ZUV2ZW50XyA9IGZ1bmN0aW9uIChvbGRWaWV3Q2FjaGUsIG5ld1ZpZXdDYWNoZSwgYWNjdW11bGF0b3IpIHtcbiAgICAgICAgdmFyIGV2ZW50U25hcCA9IG5ld1ZpZXdDYWNoZS5nZXRFdmVudENhY2hlKCk7XG4gICAgICAgIGlmIChldmVudFNuYXAuaXNGdWxseUluaXRpYWxpemVkKCkpIHtcbiAgICAgICAgICAgIHZhciBpc0xlYWZPckVtcHR5ID0gZXZlbnRTbmFwLmdldE5vZGUoKS5pc0xlYWZOb2RlKCkgfHwgZXZlbnRTbmFwLmdldE5vZGUoKS5pc0VtcHR5KCk7XG4gICAgICAgICAgICB2YXIgb2xkQ29tcGxldGVTbmFwID0gb2xkVmlld0NhY2hlLmdldENvbXBsZXRlRXZlbnRTbmFwKCk7XG4gICAgICAgICAgICBpZiAoYWNjdW11bGF0b3IubGVuZ3RoID4gMCB8fFxuICAgICAgICAgICAgICAgICFvbGRWaWV3Q2FjaGUuZ2V0RXZlbnRDYWNoZSgpLmlzRnVsbHlJbml0aWFsaXplZCgpIHx8XG4gICAgICAgICAgICAgICAgKGlzTGVhZk9yRW1wdHkgJiZcbiAgICAgICAgICAgICAgICAgICAgIWV2ZW50U25hcFxuICAgICAgICAgICAgICAgICAgICAgICAgLmdldE5vZGUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVxdWFscygvKiogQHR5cGUgeyFOb2RlfSAqLyAob2xkQ29tcGxldGVTbmFwKSkpIHx8XG4gICAgICAgICAgICAgICAgIWV2ZW50U25hcFxuICAgICAgICAgICAgICAgICAgICAuZ2V0Tm9kZSgpXG4gICAgICAgICAgICAgICAgICAgIC5nZXRQcmlvcml0eSgpXG4gICAgICAgICAgICAgICAgICAgIC5lcXVhbHMob2xkQ29tcGxldGVTbmFwLmdldFByaW9yaXR5KCkpKSB7XG4gICAgICAgICAgICAgICAgYWNjdW11bGF0b3IucHVzaChDaGFuZ2VfMS5DaGFuZ2UudmFsdWVDaGFuZ2UoXG4gICAgICAgICAgICAgICAgLyoqIEB0eXBlIHshTm9kZX0gKi8gbmV3Vmlld0NhY2hlLmdldENvbXBsZXRlRXZlbnRTbmFwKCkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshVmlld0NhY2hlfSB2aWV3Q2FjaGVcbiAgICAgKiBAcGFyYW0geyFQYXRofSBjaGFuZ2VQYXRoXG4gICAgICogQHBhcmFtIHshV3JpdGVUcmVlUmVmfSB3cml0ZXNDYWNoZVxuICAgICAqIEBwYXJhbSB7IUNvbXBsZXRlQ2hpbGRTb3VyY2V9IHNvdXJjZVxuICAgICAqIEBwYXJhbSB7IUNoaWxkQ2hhbmdlQWNjdW11bGF0b3J9IGFjY3VtdWxhdG9yXG4gICAgICogQHJldHVybiB7IVZpZXdDYWNoZX1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIFZpZXdQcm9jZXNzb3IucHJvdG90eXBlLmdlbmVyYXRlRXZlbnRDYWNoZUFmdGVyU2VydmVyRXZlbnRfID0gZnVuY3Rpb24gKHZpZXdDYWNoZSwgY2hhbmdlUGF0aCwgd3JpdGVzQ2FjaGUsIHNvdXJjZSwgYWNjdW11bGF0b3IpIHtcbiAgICAgICAgdmFyIG9sZEV2ZW50U25hcCA9IHZpZXdDYWNoZS5nZXRFdmVudENhY2hlKCk7XG4gICAgICAgIGlmICh3cml0ZXNDYWNoZS5zaGFkb3dpbmdXcml0ZShjaGFuZ2VQYXRoKSAhPSBudWxsKSB7XG4gICAgICAgICAgICAvLyB3ZSBoYXZlIGEgc2hhZG93aW5nIHdyaXRlLCBpZ25vcmUgY2hhbmdlc1xuICAgICAgICAgICAgcmV0dXJuIHZpZXdDYWNoZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBuZXdFdmVudENhY2hlID0gdm9pZCAwLCBzZXJ2ZXJOb2RlID0gdm9pZCAwO1xuICAgICAgICAgICAgaWYgKGNoYW5nZVBhdGguaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgLy8gVE9ETzogZmlndXJlIG91dCBob3cgdGhpcyBwbGF5cyB3aXRoIFwic2xpZGluZyBhY2sgd2luZG93c1wiXG4gICAgICAgICAgICAgICAgdXRpbF8xLmFzc2VydCh2aWV3Q2FjaGUuZ2V0U2VydmVyQ2FjaGUoKS5pc0Z1bGx5SW5pdGlhbGl6ZWQoKSwgJ0lmIGNoYW5nZSBwYXRoIGlzIGVtcHR5LCB3ZSBtdXN0IGhhdmUgY29tcGxldGUgc2VydmVyIGRhdGEnKTtcbiAgICAgICAgICAgICAgICBpZiAodmlld0NhY2hlLmdldFNlcnZlckNhY2hlKCkuaXNGaWx0ZXJlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gc3BlY2lhbCBjYXNlIHRoaXMsIGJlY2F1c2Ugd2UgbmVlZCB0byBvbmx5IGFwcGx5IHdyaXRlcyB0byBjb21wbGV0ZSBjaGlsZHJlbiwgb3JcbiAgICAgICAgICAgICAgICAgICAgLy8gd2UgbWlnaHQgZW5kIHVwIHJhaXNpbmcgZXZlbnRzIGZvciBpbmNvbXBsZXRlIGNoaWxkcmVuLiBJZiB0aGUgc2VydmVyIGRhdGEgaXMgZmlsdGVyZWQgZGVlcFxuICAgICAgICAgICAgICAgICAgICAvLyB3cml0ZXMgY2Fubm90IGJlIGd1YXJhbnRlZWQgdG8gYmUgY29tcGxldGVcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNlcnZlckNhY2hlID0gdmlld0NhY2hlLmdldENvbXBsZXRlU2VydmVyU25hcCgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29tcGxldGVDaGlsZHJlbiA9IHNlcnZlckNhY2hlIGluc3RhbmNlb2YgQ2hpbGRyZW5Ob2RlXzEuQ2hpbGRyZW5Ob2RlXG4gICAgICAgICAgICAgICAgICAgICAgICA/IHNlcnZlckNhY2hlXG4gICAgICAgICAgICAgICAgICAgICAgICA6IENoaWxkcmVuTm9kZV8xLkNoaWxkcmVuTm9kZS5FTVBUWV9OT0RFO1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29tcGxldGVFdmVudENoaWxkcmVuID0gd3JpdGVzQ2FjaGUuY2FsY0NvbXBsZXRlRXZlbnRDaGlsZHJlbihjb21wbGV0ZUNoaWxkcmVuKTtcbiAgICAgICAgICAgICAgICAgICAgbmV3RXZlbnRDYWNoZSA9IHRoaXMuZmlsdGVyXy51cGRhdGVGdWxsTm9kZSh2aWV3Q2FjaGUuZ2V0RXZlbnRDYWNoZSgpLmdldE5vZGUoKSwgY29tcGxldGVFdmVudENoaWxkcmVuLCBhY2N1bXVsYXRvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29tcGxldGVOb2RlID0gd3JpdGVzQ2FjaGUuY2FsY0NvbXBsZXRlRXZlbnRDYWNoZSh2aWV3Q2FjaGUuZ2V0Q29tcGxldGVTZXJ2ZXJTbmFwKCkpO1xuICAgICAgICAgICAgICAgICAgICBuZXdFdmVudENhY2hlID0gdGhpcy5maWx0ZXJfLnVwZGF0ZUZ1bGxOb2RlKHZpZXdDYWNoZS5nZXRFdmVudENhY2hlKCkuZ2V0Tm9kZSgpLCBjb21wbGV0ZU5vZGUsIGFjY3VtdWxhdG9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRLZXkgPSBjaGFuZ2VQYXRoLmdldEZyb250KCk7XG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkS2V5ID09ICcucHJpb3JpdHknKSB7XG4gICAgICAgICAgICAgICAgICAgIHV0aWxfMS5hc3NlcnQoY2hhbmdlUGF0aC5nZXRMZW5ndGgoKSA9PSAxLCBcIkNhbid0IGhhdmUgYSBwcmlvcml0eSB3aXRoIGFkZGl0aW9uYWwgcGF0aCBjb21wb25lbnRzXCIpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgb2xkRXZlbnROb2RlID0gb2xkRXZlbnRTbmFwLmdldE5vZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgc2VydmVyTm9kZSA9IHZpZXdDYWNoZS5nZXRTZXJ2ZXJDYWNoZSgpLmdldE5vZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gd2UgbWlnaHQgaGF2ZSBvdmVyd3JpdGVzIGZvciB0aGlzIHByaW9yaXR5XG4gICAgICAgICAgICAgICAgICAgIHZhciB1cGRhdGVkUHJpb3JpdHkgPSB3cml0ZXNDYWNoZS5jYWxjRXZlbnRDYWNoZUFmdGVyU2VydmVyT3ZlcndyaXRlKGNoYW5nZVBhdGgsIG9sZEV2ZW50Tm9kZSwgc2VydmVyTm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh1cGRhdGVkUHJpb3JpdHkgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3RXZlbnRDYWNoZSA9IHRoaXMuZmlsdGVyXy51cGRhdGVQcmlvcml0eShvbGRFdmVudE5vZGUsIHVwZGF0ZWRQcmlvcml0eSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBwcmlvcml0eSBkaWRuJ3QgY2hhbmdlLCBrZWVwIG9sZCBub2RlXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdFdmVudENhY2hlID0gb2xkRXZlbnRTbmFwLmdldE5vZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNoaWxkQ2hhbmdlUGF0aCA9IGNoYW5nZVBhdGgucG9wRnJvbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gdXBkYXRlIGNoaWxkXG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdFdmVudENoaWxkID0gdm9pZCAwO1xuICAgICAgICAgICAgICAgICAgICBpZiAob2xkRXZlbnRTbmFwLmlzQ29tcGxldGVGb3JDaGlsZChjaGlsZEtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZlck5vZGUgPSB2aWV3Q2FjaGUuZ2V0U2VydmVyQ2FjaGUoKS5nZXROb2RlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXZlbnRDaGlsZFVwZGF0ZSA9IHdyaXRlc0NhY2hlLmNhbGNFdmVudENhY2hlQWZ0ZXJTZXJ2ZXJPdmVyd3JpdGUoY2hhbmdlUGF0aCwgb2xkRXZlbnRTbmFwLmdldE5vZGUoKSwgc2VydmVyTm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnRDaGlsZFVwZGF0ZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3RXZlbnRDaGlsZCA9IG9sZEV2ZW50U25hcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZ2V0Tm9kZSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5nZXRJbW1lZGlhdGVDaGlsZChjaGlsZEtleSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnVwZGF0ZUNoaWxkKGNoaWxkQ2hhbmdlUGF0aCwgZXZlbnRDaGlsZFVwZGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3RoaW5nIGNoYW5nZWQsIGp1c3Qga2VlcCB0aGUgb2xkIGNoaWxkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3RXZlbnRDaGlsZCA9IG9sZEV2ZW50U25hcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZ2V0Tm9kZSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5nZXRJbW1lZGlhdGVDaGlsZChjaGlsZEtleSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdFdmVudENoaWxkID0gd3JpdGVzQ2FjaGUuY2FsY0NvbXBsZXRlQ2hpbGQoY2hpbGRLZXksIHZpZXdDYWNoZS5nZXRTZXJ2ZXJDYWNoZSgpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAobmV3RXZlbnRDaGlsZCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdFdmVudENhY2hlID0gdGhpcy5maWx0ZXJfLnVwZGF0ZUNoaWxkKG9sZEV2ZW50U25hcC5nZXROb2RlKCksIGNoaWxkS2V5LCBuZXdFdmVudENoaWxkLCBjaGlsZENoYW5nZVBhdGgsIHNvdXJjZSwgYWNjdW11bGF0b3IpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbm8gY29tcGxldGUgY2hpbGQgYXZhaWxhYmxlIG9yIG5vIGNoYW5nZVxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3RXZlbnRDYWNoZSA9IG9sZEV2ZW50U25hcC5nZXROb2RlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdmlld0NhY2hlLnVwZGF0ZUV2ZW50U25hcChuZXdFdmVudENhY2hlLCBvbGRFdmVudFNuYXAuaXNGdWxseUluaXRpYWxpemVkKCkgfHwgY2hhbmdlUGF0aC5pc0VtcHR5KCksIHRoaXMuZmlsdGVyXy5maWx0ZXJzTm9kZXMoKSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7IVZpZXdDYWNoZX0gb2xkVmlld0NhY2hlXG4gICAgICogQHBhcmFtIHshUGF0aH0gY2hhbmdlUGF0aFxuICAgICAqIEBwYXJhbSB7IU5vZGV9IGNoYW5nZWRTbmFwXG4gICAgICogQHBhcmFtIHshV3JpdGVUcmVlUmVmfSB3cml0ZXNDYWNoZVxuICAgICAqIEBwYXJhbSB7P05vZGV9IGNvbXBsZXRlQ2FjaGVcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGZpbHRlclNlcnZlck5vZGVcbiAgICAgKiBAcGFyYW0geyFDaGlsZENoYW5nZUFjY3VtdWxhdG9yfSBhY2N1bXVsYXRvclxuICAgICAqIEByZXR1cm4geyFWaWV3Q2FjaGV9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBWaWV3UHJvY2Vzc29yLnByb3RvdHlwZS5hcHBseVNlcnZlck92ZXJ3cml0ZV8gPSBmdW5jdGlvbiAob2xkVmlld0NhY2hlLCBjaGFuZ2VQYXRoLCBjaGFuZ2VkU25hcCwgd3JpdGVzQ2FjaGUsIGNvbXBsZXRlQ2FjaGUsIGZpbHRlclNlcnZlck5vZGUsIGFjY3VtdWxhdG9yKSB7XG4gICAgICAgIHZhciBvbGRTZXJ2ZXJTbmFwID0gb2xkVmlld0NhY2hlLmdldFNlcnZlckNhY2hlKCk7XG4gICAgICAgIHZhciBuZXdTZXJ2ZXJDYWNoZTtcbiAgICAgICAgdmFyIHNlcnZlckZpbHRlciA9IGZpbHRlclNlcnZlck5vZGVcbiAgICAgICAgICAgID8gdGhpcy5maWx0ZXJfXG4gICAgICAgICAgICA6IHRoaXMuZmlsdGVyXy5nZXRJbmRleGVkRmlsdGVyKCk7XG4gICAgICAgIGlmIChjaGFuZ2VQYXRoLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgbmV3U2VydmVyQ2FjaGUgPSBzZXJ2ZXJGaWx0ZXIudXBkYXRlRnVsbE5vZGUob2xkU2VydmVyU25hcC5nZXROb2RlKCksIGNoYW5nZWRTbmFwLCBudWxsKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChzZXJ2ZXJGaWx0ZXIuZmlsdGVyc05vZGVzKCkgJiYgIW9sZFNlcnZlclNuYXAuaXNGaWx0ZXJlZCgpKSB7XG4gICAgICAgICAgICAvLyB3ZSB3YW50IHRvIGZpbHRlciB0aGUgc2VydmVyIG5vZGUsIGJ1dCB3ZSBkaWRuJ3QgZmlsdGVyIHRoZSBzZXJ2ZXIgbm9kZSB5ZXQsIHNvIHNpbXVsYXRlIGEgZnVsbCB1cGRhdGVcbiAgICAgICAgICAgIHZhciBuZXdTZXJ2ZXJOb2RlID0gb2xkU2VydmVyU25hcFxuICAgICAgICAgICAgICAgIC5nZXROb2RlKClcbiAgICAgICAgICAgICAgICAudXBkYXRlQ2hpbGQoY2hhbmdlUGF0aCwgY2hhbmdlZFNuYXApO1xuICAgICAgICAgICAgbmV3U2VydmVyQ2FjaGUgPSBzZXJ2ZXJGaWx0ZXIudXBkYXRlRnVsbE5vZGUob2xkU2VydmVyU25hcC5nZXROb2RlKCksIG5ld1NlcnZlck5vZGUsIG51bGwpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIGNoaWxkS2V5ID0gY2hhbmdlUGF0aC5nZXRGcm9udCgpO1xuICAgICAgICAgICAgaWYgKCFvbGRTZXJ2ZXJTbmFwLmlzQ29tcGxldGVGb3JQYXRoKGNoYW5nZVBhdGgpICYmXG4gICAgICAgICAgICAgICAgY2hhbmdlUGF0aC5nZXRMZW5ndGgoKSA+IDEpIHtcbiAgICAgICAgICAgICAgICAvLyBXZSBkb24ndCB1cGRhdGUgaW5jb21wbGV0ZSBub2RlcyB3aXRoIHVwZGF0ZXMgaW50ZW5kZWQgZm9yIG90aGVyIGxpc3RlbmVyc1xuICAgICAgICAgICAgICAgIHJldHVybiBvbGRWaWV3Q2FjaGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgY2hpbGRDaGFuZ2VQYXRoID0gY2hhbmdlUGF0aC5wb3BGcm9udCgpO1xuICAgICAgICAgICAgdmFyIGNoaWxkTm9kZSA9IG9sZFNlcnZlclNuYXAuZ2V0Tm9kZSgpLmdldEltbWVkaWF0ZUNoaWxkKGNoaWxkS2V5KTtcbiAgICAgICAgICAgIHZhciBuZXdDaGlsZE5vZGUgPSBjaGlsZE5vZGUudXBkYXRlQ2hpbGQoY2hpbGRDaGFuZ2VQYXRoLCBjaGFuZ2VkU25hcCk7XG4gICAgICAgICAgICBpZiAoY2hpbGRLZXkgPT0gJy5wcmlvcml0eScpIHtcbiAgICAgICAgICAgICAgICBuZXdTZXJ2ZXJDYWNoZSA9IHNlcnZlckZpbHRlci51cGRhdGVQcmlvcml0eShvbGRTZXJ2ZXJTbmFwLmdldE5vZGUoKSwgbmV3Q2hpbGROb2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG5ld1NlcnZlckNhY2hlID0gc2VydmVyRmlsdGVyLnVwZGF0ZUNoaWxkKG9sZFNlcnZlclNuYXAuZ2V0Tm9kZSgpLCBjaGlsZEtleSwgbmV3Q2hpbGROb2RlLCBjaGlsZENoYW5nZVBhdGgsIENvbXBsZXRlQ2hpbGRTb3VyY2VfMS5OT19DT01QTEVURV9DSElMRF9TT1VSQ0UsIG51bGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBuZXdWaWV3Q2FjaGUgPSBvbGRWaWV3Q2FjaGUudXBkYXRlU2VydmVyU25hcChuZXdTZXJ2ZXJDYWNoZSwgb2xkU2VydmVyU25hcC5pc0Z1bGx5SW5pdGlhbGl6ZWQoKSB8fCBjaGFuZ2VQYXRoLmlzRW1wdHkoKSwgc2VydmVyRmlsdGVyLmZpbHRlcnNOb2RlcygpKTtcbiAgICAgICAgdmFyIHNvdXJjZSA9IG5ldyBDb21wbGV0ZUNoaWxkU291cmNlXzEuV3JpdGVUcmVlQ29tcGxldGVDaGlsZFNvdXJjZSh3cml0ZXNDYWNoZSwgbmV3Vmlld0NhY2hlLCBjb21wbGV0ZUNhY2hlKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2VuZXJhdGVFdmVudENhY2hlQWZ0ZXJTZXJ2ZXJFdmVudF8obmV3Vmlld0NhY2hlLCBjaGFuZ2VQYXRoLCB3cml0ZXNDYWNoZSwgc291cmNlLCBhY2N1bXVsYXRvcik7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFWaWV3Q2FjaGV9IG9sZFZpZXdDYWNoZVxuICAgICAqIEBwYXJhbSB7IVBhdGh9IGNoYW5nZVBhdGhcbiAgICAgKiBAcGFyYW0geyFOb2RlfSBjaGFuZ2VkU25hcFxuICAgICAqIEBwYXJhbSB7IVdyaXRlVHJlZVJlZn0gd3JpdGVzQ2FjaGVcbiAgICAgKiBAcGFyYW0gez9Ob2RlfSBjb21wbGV0ZUNhY2hlXG4gICAgICogQHBhcmFtIHshQ2hpbGRDaGFuZ2VBY2N1bXVsYXRvcn0gYWNjdW11bGF0b3JcbiAgICAgKiBAcmV0dXJuIHshVmlld0NhY2hlfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgVmlld1Byb2Nlc3Nvci5wcm90b3R5cGUuYXBwbHlVc2VyT3ZlcndyaXRlXyA9IGZ1bmN0aW9uIChvbGRWaWV3Q2FjaGUsIGNoYW5nZVBhdGgsIGNoYW5nZWRTbmFwLCB3cml0ZXNDYWNoZSwgY29tcGxldGVDYWNoZSwgYWNjdW11bGF0b3IpIHtcbiAgICAgICAgdmFyIG9sZEV2ZW50U25hcCA9IG9sZFZpZXdDYWNoZS5nZXRFdmVudENhY2hlKCk7XG4gICAgICAgIHZhciBuZXdWaWV3Q2FjaGUsIG5ld0V2ZW50Q2FjaGU7XG4gICAgICAgIHZhciBzb3VyY2UgPSBuZXcgQ29tcGxldGVDaGlsZFNvdXJjZV8xLldyaXRlVHJlZUNvbXBsZXRlQ2hpbGRTb3VyY2Uod3JpdGVzQ2FjaGUsIG9sZFZpZXdDYWNoZSwgY29tcGxldGVDYWNoZSk7XG4gICAgICAgIGlmIChjaGFuZ2VQYXRoLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgbmV3RXZlbnRDYWNoZSA9IHRoaXMuZmlsdGVyXy51cGRhdGVGdWxsTm9kZShvbGRWaWV3Q2FjaGUuZ2V0RXZlbnRDYWNoZSgpLmdldE5vZGUoKSwgY2hhbmdlZFNuYXAsIGFjY3VtdWxhdG9yKTtcbiAgICAgICAgICAgIG5ld1ZpZXdDYWNoZSA9IG9sZFZpZXdDYWNoZS51cGRhdGVFdmVudFNuYXAobmV3RXZlbnRDYWNoZSwgdHJ1ZSwgdGhpcy5maWx0ZXJfLmZpbHRlcnNOb2RlcygpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBjaGlsZEtleSA9IGNoYW5nZVBhdGguZ2V0RnJvbnQoKTtcbiAgICAgICAgICAgIGlmIChjaGlsZEtleSA9PT0gJy5wcmlvcml0eScpIHtcbiAgICAgICAgICAgICAgICBuZXdFdmVudENhY2hlID0gdGhpcy5maWx0ZXJfLnVwZGF0ZVByaW9yaXR5KG9sZFZpZXdDYWNoZS5nZXRFdmVudENhY2hlKCkuZ2V0Tm9kZSgpLCBjaGFuZ2VkU25hcCk7XG4gICAgICAgICAgICAgICAgbmV3Vmlld0NhY2hlID0gb2xkVmlld0NhY2hlLnVwZGF0ZUV2ZW50U25hcChuZXdFdmVudENhY2hlLCBvbGRFdmVudFNuYXAuaXNGdWxseUluaXRpYWxpemVkKCksIG9sZEV2ZW50U25hcC5pc0ZpbHRlcmVkKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkQ2hhbmdlUGF0aCA9IGNoYW5nZVBhdGgucG9wRnJvbnQoKTtcbiAgICAgICAgICAgICAgICB2YXIgb2xkQ2hpbGQgPSBvbGRFdmVudFNuYXAuZ2V0Tm9kZSgpLmdldEltbWVkaWF0ZUNoaWxkKGNoaWxkS2V5KTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3Q2hpbGQgPSB2b2lkIDA7XG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkQ2hhbmdlUGF0aC5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQ2hpbGQgb3ZlcndyaXRlLCB3ZSBjYW4gcmVwbGFjZSB0aGUgY2hpbGRcbiAgICAgICAgICAgICAgICAgICAgbmV3Q2hpbGQgPSBjaGFuZ2VkU25hcDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjaGlsZE5vZGUgPSBzb3VyY2UuZ2V0Q29tcGxldGVDaGlsZChjaGlsZEtleSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGlsZE5vZGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoaWxkQ2hhbmdlUGF0aC5nZXRCYWNrKCkgPT09ICcucHJpb3JpdHknICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGROb2RlLmdldENoaWxkKGNoaWxkQ2hhbmdlUGF0aC5wYXJlbnQoKSkuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBpcyBhIHByaW9yaXR5IHVwZGF0ZSBvbiBhbiBlbXB0eSBub2RlLiBJZiB0aGlzIG5vZGUgZXhpc3RzIG9uIHRoZSBzZXJ2ZXIsIHRoZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlcnZlciB3aWxsIHNlbmQgZG93biB0aGUgcHJpb3JpdHkgaW4gdGhlIHVwZGF0ZSwgc28gaWdub3JlIGZvciBub3dcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdDaGlsZCA9IGNoaWxkTm9kZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0NoaWxkID0gY2hpbGROb2RlLnVwZGF0ZUNoaWxkKGNoaWxkQ2hhbmdlUGF0aCwgY2hhbmdlZFNuYXApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlcmUgaXMgbm8gY29tcGxldGUgY2hpbGQgbm9kZSBhdmFpbGFibGVcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0NoaWxkID0gQ2hpbGRyZW5Ob2RlXzEuQ2hpbGRyZW5Ob2RlLkVNUFRZX05PREU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFvbGRDaGlsZC5lcXVhbHMobmV3Q2hpbGQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdFdmVudFNuYXAgPSB0aGlzLmZpbHRlcl8udXBkYXRlQ2hpbGQob2xkRXZlbnRTbmFwLmdldE5vZGUoKSwgY2hpbGRLZXksIG5ld0NoaWxkLCBjaGlsZENoYW5nZVBhdGgsIHNvdXJjZSwgYWNjdW11bGF0b3IpO1xuICAgICAgICAgICAgICAgICAgICBuZXdWaWV3Q2FjaGUgPSBvbGRWaWV3Q2FjaGUudXBkYXRlRXZlbnRTbmFwKG5ld0V2ZW50U25hcCwgb2xkRXZlbnRTbmFwLmlzRnVsbHlJbml0aWFsaXplZCgpLCB0aGlzLmZpbHRlcl8uZmlsdGVyc05vZGVzKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3Vmlld0NhY2hlID0gb2xkVmlld0NhY2hlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3Vmlld0NhY2hlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshVmlld0NhY2hlfSB2aWV3Q2FjaGVcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gY2hpbGRLZXlcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgVmlld1Byb2Nlc3Nvci5jYWNoZUhhc0NoaWxkXyA9IGZ1bmN0aW9uICh2aWV3Q2FjaGUsIGNoaWxkS2V5KSB7XG4gICAgICAgIHJldHVybiB2aWV3Q2FjaGUuZ2V0RXZlbnRDYWNoZSgpLmlzQ29tcGxldGVGb3JDaGlsZChjaGlsZEtleSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFWaWV3Q2FjaGV9IHZpZXdDYWNoZVxuICAgICAqIEBwYXJhbSB7IVBhdGh9IHBhdGhcbiAgICAgKiBAcGFyYW0ge0ltbXV0YWJsZVRyZWUuPCFOb2RlPn0gY2hhbmdlZENoaWxkcmVuXG4gICAgICogQHBhcmFtIHshV3JpdGVUcmVlUmVmfSB3cml0ZXNDYWNoZVxuICAgICAqIEBwYXJhbSB7P05vZGV9IHNlcnZlckNhY2hlXG4gICAgICogQHBhcmFtIHshQ2hpbGRDaGFuZ2VBY2N1bXVsYXRvcn0gYWNjdW11bGF0b3JcbiAgICAgKiBAcmV0dXJuIHshVmlld0NhY2hlfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgVmlld1Byb2Nlc3Nvci5wcm90b3R5cGUuYXBwbHlVc2VyTWVyZ2VfID0gZnVuY3Rpb24gKHZpZXdDYWNoZSwgcGF0aCwgY2hhbmdlZENoaWxkcmVuLCB3cml0ZXNDYWNoZSwgc2VydmVyQ2FjaGUsIGFjY3VtdWxhdG9yKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIC8vIEhBQ0s6IEluIHRoZSBjYXNlIG9mIGEgbGltaXQgcXVlcnksIHRoZXJlIG1heSBiZSBzb21lIGNoYW5nZXMgdGhhdCBidW1wIHRoaW5ncyBvdXQgb2YgdGhlXG4gICAgICAgIC8vIHdpbmRvdyBsZWF2aW5nIHJvb20gZm9yIG5ldyBpdGVtcy4gIEl0J3MgaW1wb3J0YW50IHdlIHByb2Nlc3MgdGhlc2UgY2hhbmdlcyBmaXJzdCwgc28gd2VcbiAgICAgICAgLy8gaXRlcmF0ZSB0aGUgY2hhbmdlcyB0d2ljZSwgZmlyc3QgcHJvY2Vzc2luZyBhbnkgdGhhdCBhZmZlY3QgaXRlbXMgY3VycmVudGx5IGluIHZpZXcuXG4gICAgICAgIC8vIFRPRE86IEkgY29uc2lkZXIgYW4gaXRlbSBcImluIHZpZXdcIiBpZiBjYWNoZUhhc0NoaWxkIGlzIHRydWUsIHdoaWNoIGNoZWNrcyBib3RoIHRoZSBzZXJ2ZXJcbiAgICAgICAgLy8gYW5kIGV2ZW50IHNuYXAuICBJJ20gbm90IHN1cmUgaWYgdGhpcyB3aWxsIHJlc3VsdCBpbiBlZGdlIGNhc2VzIHdoZW4gYSBjaGlsZCBpcyBpbiBvbmUgYnV0XG4gICAgICAgIC8vIG5vdCB0aGUgb3RoZXIuXG4gICAgICAgIHZhciBjdXJWaWV3Q2FjaGUgPSB2aWV3Q2FjaGU7XG4gICAgICAgIGNoYW5nZWRDaGlsZHJlbi5mb3JlYWNoKGZ1bmN0aW9uIChyZWxhdGl2ZVBhdGgsIGNoaWxkTm9kZSkge1xuICAgICAgICAgICAgdmFyIHdyaXRlUGF0aCA9IHBhdGguY2hpbGQocmVsYXRpdmVQYXRoKTtcbiAgICAgICAgICAgIGlmIChWaWV3UHJvY2Vzc29yLmNhY2hlSGFzQ2hpbGRfKHZpZXdDYWNoZSwgd3JpdGVQYXRoLmdldEZyb250KCkpKSB7XG4gICAgICAgICAgICAgICAgY3VyVmlld0NhY2hlID0gX3RoaXMuYXBwbHlVc2VyT3ZlcndyaXRlXyhjdXJWaWV3Q2FjaGUsIHdyaXRlUGF0aCwgY2hpbGROb2RlLCB3cml0ZXNDYWNoZSwgc2VydmVyQ2FjaGUsIGFjY3VtdWxhdG9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGNoYW5nZWRDaGlsZHJlbi5mb3JlYWNoKGZ1bmN0aW9uIChyZWxhdGl2ZVBhdGgsIGNoaWxkTm9kZSkge1xuICAgICAgICAgICAgdmFyIHdyaXRlUGF0aCA9IHBhdGguY2hpbGQocmVsYXRpdmVQYXRoKTtcbiAgICAgICAgICAgIGlmICghVmlld1Byb2Nlc3Nvci5jYWNoZUhhc0NoaWxkXyh2aWV3Q2FjaGUsIHdyaXRlUGF0aC5nZXRGcm9udCgpKSkge1xuICAgICAgICAgICAgICAgIGN1clZpZXdDYWNoZSA9IF90aGlzLmFwcGx5VXNlck92ZXJ3cml0ZV8oY3VyVmlld0NhY2hlLCB3cml0ZVBhdGgsIGNoaWxkTm9kZSwgd3JpdGVzQ2FjaGUsIHNlcnZlckNhY2hlLCBhY2N1bXVsYXRvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gY3VyVmlld0NhY2hlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshTm9kZX0gbm9kZVxuICAgICAqIEBwYXJhbSB7SW1tdXRhYmxlVHJlZS48IU5vZGU+fSBtZXJnZVxuICAgICAqIEByZXR1cm4geyFOb2RlfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgVmlld1Byb2Nlc3Nvci5wcm90b3R5cGUuYXBwbHlNZXJnZV8gPSBmdW5jdGlvbiAobm9kZSwgbWVyZ2UpIHtcbiAgICAgICAgbWVyZ2UuZm9yZWFjaChmdW5jdGlvbiAocmVsYXRpdmVQYXRoLCBjaGlsZE5vZGUpIHtcbiAgICAgICAgICAgIG5vZGUgPSBub2RlLnVwZGF0ZUNoaWxkKHJlbGF0aXZlUGF0aCwgY2hpbGROb2RlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBub2RlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshVmlld0NhY2hlfSB2aWV3Q2FjaGVcbiAgICAgKiBAcGFyYW0geyFQYXRofSBwYXRoXG4gICAgICogQHBhcmFtIHshSW1tdXRhYmxlVHJlZS48IU5vZGU+fSBjaGFuZ2VkQ2hpbGRyZW5cbiAgICAgKiBAcGFyYW0geyFXcml0ZVRyZWVSZWZ9IHdyaXRlc0NhY2hlXG4gICAgICogQHBhcmFtIHs/Tm9kZX0gc2VydmVyQ2FjaGVcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGZpbHRlclNlcnZlck5vZGVcbiAgICAgKiBAcGFyYW0geyFDaGlsZENoYW5nZUFjY3VtdWxhdG9yfSBhY2N1bXVsYXRvclxuICAgICAqIEByZXR1cm4geyFWaWV3Q2FjaGV9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBWaWV3UHJvY2Vzc29yLnByb3RvdHlwZS5hcHBseVNlcnZlck1lcmdlXyA9IGZ1bmN0aW9uICh2aWV3Q2FjaGUsIHBhdGgsIGNoYW5nZWRDaGlsZHJlbiwgd3JpdGVzQ2FjaGUsIHNlcnZlckNhY2hlLCBmaWx0ZXJTZXJ2ZXJOb2RlLCBhY2N1bXVsYXRvcikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAvLyBJZiB3ZSBkb24ndCBoYXZlIGEgY2FjaGUgeWV0LCB0aGlzIG1lcmdlIHdhcyBpbnRlbmRlZCBmb3IgYSBwcmV2aW91c2x5IGxpc3RlbiBpbiB0aGUgc2FtZSBsb2NhdGlvbi4gSWdub3JlIGl0IGFuZFxuICAgICAgICAvLyB3YWl0IGZvciB0aGUgY29tcGxldGUgZGF0YSB1cGRhdGUgY29taW5nIHNvb24uXG4gICAgICAgIGlmICh2aWV3Q2FjaGVcbiAgICAgICAgICAgIC5nZXRTZXJ2ZXJDYWNoZSgpXG4gICAgICAgICAgICAuZ2V0Tm9kZSgpXG4gICAgICAgICAgICAuaXNFbXB0eSgpICYmXG4gICAgICAgICAgICAhdmlld0NhY2hlLmdldFNlcnZlckNhY2hlKCkuaXNGdWxseUluaXRpYWxpemVkKCkpIHtcbiAgICAgICAgICAgIHJldHVybiB2aWV3Q2FjaGU7XG4gICAgICAgIH1cbiAgICAgICAgLy8gSEFDSzogSW4gdGhlIGNhc2Ugb2YgYSBsaW1pdCBxdWVyeSwgdGhlcmUgbWF5IGJlIHNvbWUgY2hhbmdlcyB0aGF0IGJ1bXAgdGhpbmdzIG91dCBvZiB0aGVcbiAgICAgICAgLy8gd2luZG93IGxlYXZpbmcgcm9vbSBmb3IgbmV3IGl0ZW1zLiAgSXQncyBpbXBvcnRhbnQgd2UgcHJvY2VzcyB0aGVzZSBjaGFuZ2VzIGZpcnN0LCBzbyB3ZVxuICAgICAgICAvLyBpdGVyYXRlIHRoZSBjaGFuZ2VzIHR3aWNlLCBmaXJzdCBwcm9jZXNzaW5nIGFueSB0aGF0IGFmZmVjdCBpdGVtcyBjdXJyZW50bHkgaW4gdmlldy5cbiAgICAgICAgLy8gVE9ETzogSSBjb25zaWRlciBhbiBpdGVtIFwiaW4gdmlld1wiIGlmIGNhY2hlSGFzQ2hpbGQgaXMgdHJ1ZSwgd2hpY2ggY2hlY2tzIGJvdGggdGhlIHNlcnZlclxuICAgICAgICAvLyBhbmQgZXZlbnQgc25hcC4gIEknbSBub3Qgc3VyZSBpZiB0aGlzIHdpbGwgcmVzdWx0IGluIGVkZ2UgY2FzZXMgd2hlbiBhIGNoaWxkIGlzIGluIG9uZSBidXRcbiAgICAgICAgLy8gbm90IHRoZSBvdGhlci5cbiAgICAgICAgdmFyIGN1clZpZXdDYWNoZSA9IHZpZXdDYWNoZTtcbiAgICAgICAgdmFyIHZpZXdNZXJnZVRyZWU7XG4gICAgICAgIGlmIChwYXRoLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgdmlld01lcmdlVHJlZSA9IGNoYW5nZWRDaGlsZHJlbjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZpZXdNZXJnZVRyZWUgPSBJbW11dGFibGVUcmVlXzEuSW1tdXRhYmxlVHJlZS5FbXB0eS5zZXRUcmVlKHBhdGgsIGNoYW5nZWRDaGlsZHJlbik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNlcnZlck5vZGUgPSB2aWV3Q2FjaGUuZ2V0U2VydmVyQ2FjaGUoKS5nZXROb2RlKCk7XG4gICAgICAgIHZpZXdNZXJnZVRyZWUuY2hpbGRyZW4uaW5vcmRlclRyYXZlcnNhbChmdW5jdGlvbiAoY2hpbGRLZXksIGNoaWxkVHJlZSkge1xuICAgICAgICAgICAgaWYgKHNlcnZlck5vZGUuaGFzQ2hpbGQoY2hpbGRLZXkpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNlcnZlckNoaWxkID0gdmlld0NhY2hlXG4gICAgICAgICAgICAgICAgICAgIC5nZXRTZXJ2ZXJDYWNoZSgpXG4gICAgICAgICAgICAgICAgICAgIC5nZXROb2RlKClcbiAgICAgICAgICAgICAgICAgICAgLmdldEltbWVkaWF0ZUNoaWxkKGNoaWxkS2V5KTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3Q2hpbGQgPSBfdGhpcy5hcHBseU1lcmdlXyhzZXJ2ZXJDaGlsZCwgY2hpbGRUcmVlKTtcbiAgICAgICAgICAgICAgICBjdXJWaWV3Q2FjaGUgPSBfdGhpcy5hcHBseVNlcnZlck92ZXJ3cml0ZV8oY3VyVmlld0NhY2hlLCBuZXcgUGF0aF8xLlBhdGgoY2hpbGRLZXkpLCBuZXdDaGlsZCwgd3JpdGVzQ2FjaGUsIHNlcnZlckNhY2hlLCBmaWx0ZXJTZXJ2ZXJOb2RlLCBhY2N1bXVsYXRvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB2aWV3TWVyZ2VUcmVlLmNoaWxkcmVuLmlub3JkZXJUcmF2ZXJzYWwoZnVuY3Rpb24gKGNoaWxkS2V5LCBjaGlsZE1lcmdlVHJlZSkge1xuICAgICAgICAgICAgdmFyIGlzVW5rbm93bkRlZXBNZXJnZSA9ICF2aWV3Q2FjaGUuZ2V0U2VydmVyQ2FjaGUoKS5pc0NvbXBsZXRlRm9yQ2hpbGQoY2hpbGRLZXkpICYmXG4gICAgICAgICAgICAgICAgY2hpbGRNZXJnZVRyZWUudmFsdWUgPT0gbnVsbDtcbiAgICAgICAgICAgIGlmICghc2VydmVyTm9kZS5oYXNDaGlsZChjaGlsZEtleSkgJiYgIWlzVW5rbm93bkRlZXBNZXJnZSkge1xuICAgICAgICAgICAgICAgIHZhciBzZXJ2ZXJDaGlsZCA9IHZpZXdDYWNoZVxuICAgICAgICAgICAgICAgICAgICAuZ2V0U2VydmVyQ2FjaGUoKVxuICAgICAgICAgICAgICAgICAgICAuZ2V0Tm9kZSgpXG4gICAgICAgICAgICAgICAgICAgIC5nZXRJbW1lZGlhdGVDaGlsZChjaGlsZEtleSk7XG4gICAgICAgICAgICAgICAgdmFyIG5ld0NoaWxkID0gX3RoaXMuYXBwbHlNZXJnZV8oc2VydmVyQ2hpbGQsIGNoaWxkTWVyZ2VUcmVlKTtcbiAgICAgICAgICAgICAgICBjdXJWaWV3Q2FjaGUgPSBfdGhpcy5hcHBseVNlcnZlck92ZXJ3cml0ZV8oY3VyVmlld0NhY2hlLCBuZXcgUGF0aF8xLlBhdGgoY2hpbGRLZXkpLCBuZXdDaGlsZCwgd3JpdGVzQ2FjaGUsIHNlcnZlckNhY2hlLCBmaWx0ZXJTZXJ2ZXJOb2RlLCBhY2N1bXVsYXRvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gY3VyVmlld0NhY2hlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshVmlld0NhY2hlfSB2aWV3Q2FjaGVcbiAgICAgKiBAcGFyYW0geyFQYXRofSBhY2tQYXRoXG4gICAgICogQHBhcmFtIHshSW1tdXRhYmxlVHJlZTwhYm9vbGVhbj59IGFmZmVjdGVkVHJlZVxuICAgICAqIEBwYXJhbSB7IVdyaXRlVHJlZVJlZn0gd3JpdGVzQ2FjaGVcbiAgICAgKiBAcGFyYW0gez9Ob2RlfSBjb21wbGV0ZUNhY2hlXG4gICAgICogQHBhcmFtIHshQ2hpbGRDaGFuZ2VBY2N1bXVsYXRvcn0gYWNjdW11bGF0b3JcbiAgICAgKiBAcmV0dXJuIHshVmlld0NhY2hlfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgVmlld1Byb2Nlc3Nvci5wcm90b3R5cGUuYWNrVXNlcldyaXRlXyA9IGZ1bmN0aW9uICh2aWV3Q2FjaGUsIGFja1BhdGgsIGFmZmVjdGVkVHJlZSwgd3JpdGVzQ2FjaGUsIGNvbXBsZXRlQ2FjaGUsIGFjY3VtdWxhdG9yKSB7XG4gICAgICAgIGlmICh3cml0ZXNDYWNoZS5zaGFkb3dpbmdXcml0ZShhY2tQYXRoKSAhPSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gdmlld0NhY2hlO1xuICAgICAgICB9XG4gICAgICAgIC8vIE9ubHkgZmlsdGVyIHNlcnZlciBub2RlIGlmIGl0IGlzIGN1cnJlbnRseSBmaWx0ZXJlZFxuICAgICAgICB2YXIgZmlsdGVyU2VydmVyTm9kZSA9IHZpZXdDYWNoZS5nZXRTZXJ2ZXJDYWNoZSgpLmlzRmlsdGVyZWQoKTtcbiAgICAgICAgLy8gRXNzZW50aWFsbHkgd2UnbGwganVzdCBnZXQgb3VyIGV4aXN0aW5nIHNlcnZlciBjYWNoZSBmb3IgdGhlIGFmZmVjdGVkIHBhdGhzIGFuZCByZS1hcHBseSBpdCBhcyBhIHNlcnZlciB1cGRhdGVcbiAgICAgICAgLy8gbm93IHRoYXQgaXQgd29uJ3QgYmUgc2hhZG93ZWQuXG4gICAgICAgIHZhciBzZXJ2ZXJDYWNoZSA9IHZpZXdDYWNoZS5nZXRTZXJ2ZXJDYWNoZSgpO1xuICAgICAgICBpZiAoYWZmZWN0ZWRUcmVlLnZhbHVlICE9IG51bGwpIHtcbiAgICAgICAgICAgIC8vIFRoaXMgaXMgYW4gb3ZlcndyaXRlLlxuICAgICAgICAgICAgaWYgKChhY2tQYXRoLmlzRW1wdHkoKSAmJiBzZXJ2ZXJDYWNoZS5pc0Z1bGx5SW5pdGlhbGl6ZWQoKSkgfHxcbiAgICAgICAgICAgICAgICBzZXJ2ZXJDYWNoZS5pc0NvbXBsZXRlRm9yUGF0aChhY2tQYXRoKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmFwcGx5U2VydmVyT3ZlcndyaXRlXyh2aWV3Q2FjaGUsIGFja1BhdGgsIHNlcnZlckNhY2hlLmdldE5vZGUoKS5nZXRDaGlsZChhY2tQYXRoKSwgd3JpdGVzQ2FjaGUsIGNvbXBsZXRlQ2FjaGUsIGZpbHRlclNlcnZlck5vZGUsIGFjY3VtdWxhdG9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGFja1BhdGguaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgLy8gVGhpcyBpcyBhIGdvb2Z5IGVkZ2UgY2FzZSB3aGVyZSB3ZSBhcmUgYWNraW5nIGRhdGEgYXQgdGhpcyBsb2NhdGlvbiBidXQgZG9uJ3QgaGF2ZSBmdWxsIGRhdGEuICBXZVxuICAgICAgICAgICAgICAgIC8vIHNob3VsZCBqdXN0IHJlLWFwcGx5IHdoYXRldmVyIHdlIGhhdmUgaW4gb3VyIGNhY2hlIGFzIGEgbWVyZ2UuXG4gICAgICAgICAgICAgICAgdmFyIGNoYW5nZWRDaGlsZHJlbl8xID0gSW1tdXRhYmxlVHJlZV8xLkltbXV0YWJsZVRyZWUuRW1wdHk7XG4gICAgICAgICAgICAgICAgc2VydmVyQ2FjaGUuZ2V0Tm9kZSgpLmZvckVhY2hDaGlsZChLZXlJbmRleF8xLktFWV9JTkRFWCwgZnVuY3Rpb24gKG5hbWUsIG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlZENoaWxkcmVuXzEgPSBjaGFuZ2VkQ2hpbGRyZW5fMS5zZXQobmV3IFBhdGhfMS5QYXRoKG5hbWUpLCBub2RlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hcHBseVNlcnZlck1lcmdlXyh2aWV3Q2FjaGUsIGFja1BhdGgsIGNoYW5nZWRDaGlsZHJlbl8xLCB3cml0ZXNDYWNoZSwgY29tcGxldGVDYWNoZSwgZmlsdGVyU2VydmVyTm9kZSwgYWNjdW11bGF0b3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZpZXdDYWNoZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIFRoaXMgaXMgYSBtZXJnZS5cbiAgICAgICAgICAgIHZhciBjaGFuZ2VkQ2hpbGRyZW5fMiA9IEltbXV0YWJsZVRyZWVfMS5JbW11dGFibGVUcmVlLkVtcHR5O1xuICAgICAgICAgICAgYWZmZWN0ZWRUcmVlLmZvcmVhY2goZnVuY3Rpb24gKG1lcmdlUGF0aCwgdmFsdWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2VydmVyQ2FjaGVQYXRoID0gYWNrUGF0aC5jaGlsZChtZXJnZVBhdGgpO1xuICAgICAgICAgICAgICAgIGlmIChzZXJ2ZXJDYWNoZS5pc0NvbXBsZXRlRm9yUGF0aChzZXJ2ZXJDYWNoZVBhdGgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZWRDaGlsZHJlbl8yID0gY2hhbmdlZENoaWxkcmVuXzIuc2V0KG1lcmdlUGF0aCwgc2VydmVyQ2FjaGUuZ2V0Tm9kZSgpLmdldENoaWxkKHNlcnZlckNhY2hlUGF0aCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlTZXJ2ZXJNZXJnZV8odmlld0NhY2hlLCBhY2tQYXRoLCBjaGFuZ2VkQ2hpbGRyZW5fMiwgd3JpdGVzQ2FjaGUsIGNvbXBsZXRlQ2FjaGUsIGZpbHRlclNlcnZlck5vZGUsIGFjY3VtdWxhdG9yKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshVmlld0NhY2hlfSB2aWV3Q2FjaGVcbiAgICAgKiBAcGFyYW0geyFQYXRofSBwYXRoXG4gICAgICogQHBhcmFtIHshV3JpdGVUcmVlUmVmfSB3cml0ZXNDYWNoZVxuICAgICAqIEBwYXJhbSB7IUNoaWxkQ2hhbmdlQWNjdW11bGF0b3J9IGFjY3VtdWxhdG9yXG4gICAgICogQHJldHVybiB7IVZpZXdDYWNoZX1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIFZpZXdQcm9jZXNzb3IucHJvdG90eXBlLmxpc3RlbkNvbXBsZXRlXyA9IGZ1bmN0aW9uICh2aWV3Q2FjaGUsIHBhdGgsIHdyaXRlc0NhY2hlLCBhY2N1bXVsYXRvcikge1xuICAgICAgICB2YXIgb2xkU2VydmVyTm9kZSA9IHZpZXdDYWNoZS5nZXRTZXJ2ZXJDYWNoZSgpO1xuICAgICAgICB2YXIgbmV3Vmlld0NhY2hlID0gdmlld0NhY2hlLnVwZGF0ZVNlcnZlclNuYXAob2xkU2VydmVyTm9kZS5nZXROb2RlKCksIG9sZFNlcnZlck5vZGUuaXNGdWxseUluaXRpYWxpemVkKCkgfHwgcGF0aC5pc0VtcHR5KCksIG9sZFNlcnZlck5vZGUuaXNGaWx0ZXJlZCgpKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2VuZXJhdGVFdmVudENhY2hlQWZ0ZXJTZXJ2ZXJFdmVudF8obmV3Vmlld0NhY2hlLCBwYXRoLCB3cml0ZXNDYWNoZSwgQ29tcGxldGVDaGlsZFNvdXJjZV8xLk5PX0NPTVBMRVRFX0NISUxEX1NPVVJDRSwgYWNjdW11bGF0b3IpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshVmlld0NhY2hlfSB2aWV3Q2FjaGVcbiAgICAgKiBAcGFyYW0geyFQYXRofSBwYXRoXG4gICAgICogQHBhcmFtIHshV3JpdGVUcmVlUmVmfSB3cml0ZXNDYWNoZVxuICAgICAqIEBwYXJhbSB7P05vZGV9IGNvbXBsZXRlU2VydmVyQ2FjaGVcbiAgICAgKiBAcGFyYW0geyFDaGlsZENoYW5nZUFjY3VtdWxhdG9yfSBhY2N1bXVsYXRvclxuICAgICAqIEByZXR1cm4geyFWaWV3Q2FjaGV9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBWaWV3UHJvY2Vzc29yLnByb3RvdHlwZS5yZXZlcnRVc2VyV3JpdGVfID0gZnVuY3Rpb24gKHZpZXdDYWNoZSwgcGF0aCwgd3JpdGVzQ2FjaGUsIGNvbXBsZXRlU2VydmVyQ2FjaGUsIGFjY3VtdWxhdG9yKSB7XG4gICAgICAgIHZhciBjb21wbGV0ZTtcbiAgICAgICAgaWYgKHdyaXRlc0NhY2hlLnNoYWRvd2luZ1dyaXRlKHBhdGgpICE9IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiB2aWV3Q2FjaGU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgc291cmNlID0gbmV3IENvbXBsZXRlQ2hpbGRTb3VyY2VfMS5Xcml0ZVRyZWVDb21wbGV0ZUNoaWxkU291cmNlKHdyaXRlc0NhY2hlLCB2aWV3Q2FjaGUsIGNvbXBsZXRlU2VydmVyQ2FjaGUpO1xuICAgICAgICAgICAgdmFyIG9sZEV2ZW50Q2FjaGUgPSB2aWV3Q2FjaGUuZ2V0RXZlbnRDYWNoZSgpLmdldE5vZGUoKTtcbiAgICAgICAgICAgIHZhciBuZXdFdmVudENhY2hlID0gdm9pZCAwO1xuICAgICAgICAgICAgaWYgKHBhdGguaXNFbXB0eSgpIHx8IHBhdGguZ2V0RnJvbnQoKSA9PT0gJy5wcmlvcml0eScpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmV3Tm9kZSA9IHZvaWQgMDtcbiAgICAgICAgICAgICAgICBpZiAodmlld0NhY2hlLmdldFNlcnZlckNhY2hlKCkuaXNGdWxseUluaXRpYWxpemVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3Tm9kZSA9IHdyaXRlc0NhY2hlLmNhbGNDb21wbGV0ZUV2ZW50Q2FjaGUodmlld0NhY2hlLmdldENvbXBsZXRlU2VydmVyU25hcCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzZXJ2ZXJDaGlsZHJlbiA9IHZpZXdDYWNoZS5nZXRTZXJ2ZXJDYWNoZSgpLmdldE5vZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgdXRpbF8xLmFzc2VydChzZXJ2ZXJDaGlsZHJlbiBpbnN0YW5jZW9mIENoaWxkcmVuTm9kZV8xLkNoaWxkcmVuTm9kZSwgJ3NlcnZlckNoaWxkcmVuIHdvdWxkIGJlIGNvbXBsZXRlIGlmIGxlYWYgbm9kZScpO1xuICAgICAgICAgICAgICAgICAgICBuZXdOb2RlID0gd3JpdGVzQ2FjaGUuY2FsY0NvbXBsZXRlRXZlbnRDaGlsZHJlbihzZXJ2ZXJDaGlsZHJlbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG5ld05vZGUgPSBuZXdOb2RlO1xuICAgICAgICAgICAgICAgIG5ld0V2ZW50Q2FjaGUgPSB0aGlzLmZpbHRlcl8udXBkYXRlRnVsbE5vZGUob2xkRXZlbnRDYWNoZSwgbmV3Tm9kZSwgYWNjdW11bGF0b3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkS2V5ID0gcGF0aC5nZXRGcm9udCgpO1xuICAgICAgICAgICAgICAgIHZhciBuZXdDaGlsZCA9IHdyaXRlc0NhY2hlLmNhbGNDb21wbGV0ZUNoaWxkKGNoaWxkS2V5LCB2aWV3Q2FjaGUuZ2V0U2VydmVyQ2FjaGUoKSk7XG4gICAgICAgICAgICAgICAgaWYgKG5ld0NoaWxkID09IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgdmlld0NhY2hlLmdldFNlcnZlckNhY2hlKCkuaXNDb21wbGV0ZUZvckNoaWxkKGNoaWxkS2V5KSkge1xuICAgICAgICAgICAgICAgICAgICBuZXdDaGlsZCA9IG9sZEV2ZW50Q2FjaGUuZ2V0SW1tZWRpYXRlQ2hpbGQoY2hpbGRLZXkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobmV3Q2hpbGQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBuZXdFdmVudENhY2hlID0gdGhpcy5maWx0ZXJfLnVwZGF0ZUNoaWxkKG9sZEV2ZW50Q2FjaGUsIGNoaWxkS2V5LCBuZXdDaGlsZCwgcGF0aC5wb3BGcm9udCgpLCBzb3VyY2UsIGFjY3VtdWxhdG9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodmlld0NhY2hlXG4gICAgICAgICAgICAgICAgICAgIC5nZXRFdmVudENhY2hlKClcbiAgICAgICAgICAgICAgICAgICAgLmdldE5vZGUoKVxuICAgICAgICAgICAgICAgICAgICAuaGFzQ2hpbGQoY2hpbGRLZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIE5vIGNvbXBsZXRlIGNoaWxkIGF2YWlsYWJsZSwgZGVsZXRlIHRoZSBleGlzdGluZyBvbmUsIGlmIGFueVxuICAgICAgICAgICAgICAgICAgICBuZXdFdmVudENhY2hlID0gdGhpcy5maWx0ZXJfLnVwZGF0ZUNoaWxkKG9sZEV2ZW50Q2FjaGUsIGNoaWxkS2V5LCBDaGlsZHJlbk5vZGVfMS5DaGlsZHJlbk5vZGUuRU1QVFlfTk9ERSwgcGF0aC5wb3BGcm9udCgpLCBzb3VyY2UsIGFjY3VtdWxhdG9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0V2ZW50Q2FjaGUgPSBvbGRFdmVudENhY2hlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobmV3RXZlbnRDYWNoZS5pc0VtcHR5KCkgJiZcbiAgICAgICAgICAgICAgICAgICAgdmlld0NhY2hlLmdldFNlcnZlckNhY2hlKCkuaXNGdWxseUluaXRpYWxpemVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gV2UgbWlnaHQgaGF2ZSByZXZlcnRlZCBhbGwgY2hpbGQgd3JpdGVzLiBNYXliZSB0aGUgb2xkIGV2ZW50IHdhcyBhIGxlYWYgbm9kZVxuICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZSA9IHdyaXRlc0NhY2hlLmNhbGNDb21wbGV0ZUV2ZW50Q2FjaGUodmlld0NhY2hlLmdldENvbXBsZXRlU2VydmVyU25hcCgpKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXBsZXRlLmlzTGVhZk5vZGUoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3RXZlbnRDYWNoZSA9IHRoaXMuZmlsdGVyXy51cGRhdGVGdWxsTm9kZShuZXdFdmVudENhY2hlLCBjb21wbGV0ZSwgYWNjdW11bGF0b3IpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29tcGxldGUgPVxuICAgICAgICAgICAgICAgIHZpZXdDYWNoZS5nZXRTZXJ2ZXJDYWNoZSgpLmlzRnVsbHlJbml0aWFsaXplZCgpIHx8XG4gICAgICAgICAgICAgICAgICAgIHdyaXRlc0NhY2hlLnNoYWRvd2luZ1dyaXRlKFBhdGhfMS5QYXRoLkVtcHR5KSAhPSBudWxsO1xuICAgICAgICAgICAgcmV0dXJuIHZpZXdDYWNoZS51cGRhdGVFdmVudFNuYXAobmV3RXZlbnRDYWNoZSwgY29tcGxldGUsIHRoaXMuZmlsdGVyXy5maWx0ZXJzTm9kZXMoKSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBWaWV3UHJvY2Vzc29yO1xufSgpKTtcbmV4cG9ydHMuVmlld1Byb2Nlc3NvciA9IFZpZXdQcm9jZXNzb3I7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVZpZXdQcm9jZXNzb3IuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdXRpbF8xID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xudmFyIENoYW5nZV8xID0gcmVxdWlyZShcIi4uL0NoYW5nZVwiKTtcbnZhciBDaGlsZHJlbk5vZGVfMSA9IHJlcXVpcmUoXCIuLi8uLi9zbmFwL0NoaWxkcmVuTm9kZVwiKTtcbnZhciBQcmlvcml0eUluZGV4XzEgPSByZXF1aXJlKFwiLi4vLi4vc25hcC9pbmRleGVzL1ByaW9yaXR5SW5kZXhcIik7XG4vKipcbiAqIERvZXNuJ3QgcmVhbGx5IGZpbHRlciBub2RlcyBidXQgYXBwbGllcyBhbiBpbmRleCB0byB0aGUgbm9kZSBhbmQga2VlcHMgdHJhY2sgb2YgYW55IGNoYW5nZXNcbiAqXG4gKiBAY29uc3RydWN0b3JcbiAqIEBpbXBsZW1lbnRzIHtOb2RlRmlsdGVyfVxuICogQHBhcmFtIHshSW5kZXh9IGluZGV4XG4gKi9cbnZhciBJbmRleGVkRmlsdGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEluZGV4ZWRGaWx0ZXIoaW5kZXhfKSB7XG4gICAgICAgIHRoaXMuaW5kZXhfID0gaW5kZXhfO1xuICAgIH1cbiAgICBJbmRleGVkRmlsdGVyLnByb3RvdHlwZS51cGRhdGVDaGlsZCA9IGZ1bmN0aW9uIChzbmFwLCBrZXksIG5ld0NoaWxkLCBhZmZlY3RlZFBhdGgsIHNvdXJjZSwgb3B0Q2hhbmdlQWNjdW11bGF0b3IpIHtcbiAgICAgICAgdXRpbF8xLmFzc2VydChzbmFwLmlzSW5kZXhlZCh0aGlzLmluZGV4XyksICdBIG5vZGUgbXVzdCBiZSBpbmRleGVkIGlmIG9ubHkgYSBjaGlsZCBpcyB1cGRhdGVkJyk7XG4gICAgICAgIHZhciBvbGRDaGlsZCA9IHNuYXAuZ2V0SW1tZWRpYXRlQ2hpbGQoa2V5KTtcbiAgICAgICAgLy8gQ2hlY2sgaWYgYW55dGhpbmcgYWN0dWFsbHkgY2hhbmdlZC5cbiAgICAgICAgaWYgKG9sZENoaWxkLmdldENoaWxkKGFmZmVjdGVkUGF0aCkuZXF1YWxzKG5ld0NoaWxkLmdldENoaWxkKGFmZmVjdGVkUGF0aCkpKSB7XG4gICAgICAgICAgICAvLyBUaGVyZSdzIGFuIGVkZ2UgY2FzZSB3aGVyZSBhIGNoaWxkIGNhbiBlbnRlciBvciBsZWF2ZSB0aGUgdmlldyBiZWNhdXNlIGFmZmVjdGVkUGF0aCB3YXMgc2V0IHRvIG51bGwuXG4gICAgICAgICAgICAvLyBJbiB0aGlzIGNhc2UsIGFmZmVjdGVkUGF0aCB3aWxsIGFwcGVhciBudWxsIGluIGJvdGggdGhlIG9sZCBhbmQgbmV3IHNuYXBzaG90cy4gIFNvIHdlIG5lZWRcbiAgICAgICAgICAgIC8vIHRvIGF2b2lkIHRyZWF0aW5nIHRoZXNlIGNhc2VzIGFzIFwibm90aGluZyBjaGFuZ2VkLlwiXG4gICAgICAgICAgICBpZiAob2xkQ2hpbGQuaXNFbXB0eSgpID09IG5ld0NoaWxkLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgICAgIC8vIE5vdGhpbmcgY2hhbmdlZC5cbiAgICAgICAgICAgICAgICAvLyBUaGlzIGFzc2VydCBzaG91bGQgYmUgdmFsaWQsIGJ1dCBpdCdzIGV4cGVuc2l2ZSAoY2FuIGRvbWluYXRlIHBlcmYgdGVzdGluZykgc28gZG9uJ3QgYWN0dWFsbHkgZG8gaXQuXG4gICAgICAgICAgICAgICAgLy9hc3NlcnQob2xkQ2hpbGQuZXF1YWxzKG5ld0NoaWxkKSwgJ09sZCBhbmQgbmV3IHNuYXBzaG90cyBzaG91bGQgYmUgZXF1YWwuJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNuYXA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9wdENoYW5nZUFjY3VtdWxhdG9yICE9IG51bGwpIHtcbiAgICAgICAgICAgIGlmIChuZXdDaGlsZC5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgICAgICBpZiAoc25hcC5oYXNDaGlsZChrZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgIG9wdENoYW5nZUFjY3VtdWxhdG9yLnRyYWNrQ2hpbGRDaGFuZ2UoQ2hhbmdlXzEuQ2hhbmdlLmNoaWxkUmVtb3ZlZENoYW5nZShrZXksIG9sZENoaWxkKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB1dGlsXzEuYXNzZXJ0KHNuYXAuaXNMZWFmTm9kZSgpLCAnQSBjaGlsZCByZW1vdmUgd2l0aG91dCBhbiBvbGQgY2hpbGQgb25seSBtYWtlcyBzZW5zZSBvbiBhIGxlYWYgbm9kZScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG9sZENoaWxkLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgICAgIG9wdENoYW5nZUFjY3VtdWxhdG9yLnRyYWNrQ2hpbGRDaGFuZ2UoQ2hhbmdlXzEuQ2hhbmdlLmNoaWxkQWRkZWRDaGFuZ2Uoa2V5LCBuZXdDaGlsZCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3B0Q2hhbmdlQWNjdW11bGF0b3IudHJhY2tDaGlsZENoYW5nZShDaGFuZ2VfMS5DaGFuZ2UuY2hpbGRDaGFuZ2VkQ2hhbmdlKGtleSwgbmV3Q2hpbGQsIG9sZENoaWxkKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNuYXAuaXNMZWFmTm9kZSgpICYmIG5ld0NoaWxkLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHNuYXA7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBNYWtlIHN1cmUgdGhlIG5vZGUgaXMgaW5kZXhlZFxuICAgICAgICAgICAgcmV0dXJuIHNuYXAudXBkYXRlSW1tZWRpYXRlQ2hpbGQoa2V5LCBuZXdDaGlsZCkud2l0aEluZGV4KHRoaXMuaW5kZXhfKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBJbmRleGVkRmlsdGVyLnByb3RvdHlwZS51cGRhdGVGdWxsTm9kZSA9IGZ1bmN0aW9uIChvbGRTbmFwLCBuZXdTbmFwLCBvcHRDaGFuZ2VBY2N1bXVsYXRvcikge1xuICAgICAgICBpZiAob3B0Q2hhbmdlQWNjdW11bGF0b3IgIT0gbnVsbCkge1xuICAgICAgICAgICAgaWYgKCFvbGRTbmFwLmlzTGVhZk5vZGUoKSkge1xuICAgICAgICAgICAgICAgIG9sZFNuYXAuZm9yRWFjaENoaWxkKFByaW9yaXR5SW5kZXhfMS5QUklPUklUWV9JTkRFWCwgZnVuY3Rpb24gKGtleSwgY2hpbGROb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghbmV3U25hcC5oYXNDaGlsZChrZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRDaGFuZ2VBY2N1bXVsYXRvci50cmFja0NoaWxkQ2hhbmdlKENoYW5nZV8xLkNoYW5nZS5jaGlsZFJlbW92ZWRDaGFuZ2Uoa2V5LCBjaGlsZE5vZGUpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFuZXdTbmFwLmlzTGVhZk5vZGUoKSkge1xuICAgICAgICAgICAgICAgIG5ld1NuYXAuZm9yRWFjaENoaWxkKFByaW9yaXR5SW5kZXhfMS5QUklPUklUWV9JTkRFWCwgZnVuY3Rpb24gKGtleSwgY2hpbGROb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvbGRTbmFwLmhhc0NoaWxkKGtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvbGRDaGlsZCA9IG9sZFNuYXAuZ2V0SW1tZWRpYXRlQ2hpbGQoa2V5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghb2xkQ2hpbGQuZXF1YWxzKGNoaWxkTm9kZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRDaGFuZ2VBY2N1bXVsYXRvci50cmFja0NoaWxkQ2hhbmdlKENoYW5nZV8xLkNoYW5nZS5jaGlsZENoYW5nZWRDaGFuZ2Uoa2V5LCBjaGlsZE5vZGUsIG9sZENoaWxkKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRDaGFuZ2VBY2N1bXVsYXRvci50cmFja0NoaWxkQ2hhbmdlKENoYW5nZV8xLkNoYW5nZS5jaGlsZEFkZGVkQ2hhbmdlKGtleSwgY2hpbGROb2RlKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3U25hcC53aXRoSW5kZXgodGhpcy5pbmRleF8pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBJbmRleGVkRmlsdGVyLnByb3RvdHlwZS51cGRhdGVQcmlvcml0eSA9IGZ1bmN0aW9uIChvbGRTbmFwLCBuZXdQcmlvcml0eSkge1xuICAgICAgICBpZiAob2xkU25hcC5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgIHJldHVybiBDaGlsZHJlbk5vZGVfMS5DaGlsZHJlbk5vZGUuRU1QVFlfTk9ERTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBvbGRTbmFwLnVwZGF0ZVByaW9yaXR5KG5ld1ByaW9yaXR5KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBJbmRleGVkRmlsdGVyLnByb3RvdHlwZS5maWx0ZXJzTm9kZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgSW5kZXhlZEZpbHRlci5wcm90b3R5cGUuZ2V0SW5kZXhlZEZpbHRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIEluZGV4ZWRGaWx0ZXIucHJvdG90eXBlLmdldEluZGV4ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pbmRleF87XG4gICAgfTtcbiAgICByZXR1cm4gSW5kZXhlZEZpbHRlcjtcbn0oKSk7XG5leHBvcnRzLkluZGV4ZWRGaWx0ZXIgPSBJbmRleGVkRmlsdGVyO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1JbmRleGVkRmlsdGVyLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIFJhbmdlZEZpbHRlcl8xID0gcmVxdWlyZShcIi4vUmFuZ2VkRmlsdGVyXCIpO1xudmFyIENoaWxkcmVuTm9kZV8xID0gcmVxdWlyZShcIi4uLy4uL3NuYXAvQ2hpbGRyZW5Ob2RlXCIpO1xudmFyIE5vZGVfMSA9IHJlcXVpcmUoXCIuLi8uLi9zbmFwL05vZGVcIik7XG52YXIgdXRpbF8xID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xudmFyIENoYW5nZV8xID0gcmVxdWlyZShcIi4uL0NoYW5nZVwiKTtcbi8qKlxuICogQXBwbGllcyBhIGxpbWl0IGFuZCBhIHJhbmdlIHRvIGEgbm9kZSBhbmQgdXNlcyBSYW5nZWRGaWx0ZXIgdG8gZG8gdGhlIGhlYXZ5IGxpZnRpbmcgd2hlcmUgcG9zc2libGVcbiAqXG4gKiBAY29uc3RydWN0b3JcbiAqIEBpbXBsZW1lbnRzIHtOb2RlRmlsdGVyfVxuICovXG52YXIgTGltaXRlZEZpbHRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFRdWVyeVBhcmFtc30gcGFyYW1zXG4gICAgICovXG4gICAgZnVuY3Rpb24gTGltaXRlZEZpbHRlcihwYXJhbXMpIHtcbiAgICAgICAgdGhpcy5yYW5nZWRGaWx0ZXJfID0gbmV3IFJhbmdlZEZpbHRlcl8xLlJhbmdlZEZpbHRlcihwYXJhbXMpO1xuICAgICAgICB0aGlzLmluZGV4XyA9IHBhcmFtcy5nZXRJbmRleCgpO1xuICAgICAgICB0aGlzLmxpbWl0XyA9IHBhcmFtcy5nZXRMaW1pdCgpO1xuICAgICAgICB0aGlzLnJldmVyc2VfID0gIXBhcmFtcy5pc1ZpZXdGcm9tTGVmdCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIExpbWl0ZWRGaWx0ZXIucHJvdG90eXBlLnVwZGF0ZUNoaWxkID0gZnVuY3Rpb24gKHNuYXAsIGtleSwgbmV3Q2hpbGQsIGFmZmVjdGVkUGF0aCwgc291cmNlLCBvcHRDaGFuZ2VBY2N1bXVsYXRvcikge1xuICAgICAgICBpZiAoIXRoaXMucmFuZ2VkRmlsdGVyXy5tYXRjaGVzKG5ldyBOb2RlXzEuTmFtZWROb2RlKGtleSwgbmV3Q2hpbGQpKSkge1xuICAgICAgICAgICAgbmV3Q2hpbGQgPSBDaGlsZHJlbk5vZGVfMS5DaGlsZHJlbk5vZGUuRU1QVFlfTk9ERTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc25hcC5nZXRJbW1lZGlhdGVDaGlsZChrZXkpLmVxdWFscyhuZXdDaGlsZCkpIHtcbiAgICAgICAgICAgIC8vIE5vIGNoYW5nZVxuICAgICAgICAgICAgcmV0dXJuIHNuYXA7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc25hcC5udW1DaGlsZHJlbigpIDwgdGhpcy5saW1pdF8pIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJhbmdlZEZpbHRlcl9cbiAgICAgICAgICAgICAgICAuZ2V0SW5kZXhlZEZpbHRlcigpXG4gICAgICAgICAgICAgICAgLnVwZGF0ZUNoaWxkKHNuYXAsIGtleSwgbmV3Q2hpbGQsIGFmZmVjdGVkUGF0aCwgc291cmNlLCBvcHRDaGFuZ2VBY2N1bXVsYXRvcik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5mdWxsTGltaXRVcGRhdGVDaGlsZF8oc25hcCwga2V5LCBuZXdDaGlsZCwgc291cmNlLCBvcHRDaGFuZ2VBY2N1bXVsYXRvcik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgTGltaXRlZEZpbHRlci5wcm90b3R5cGUudXBkYXRlRnVsbE5vZGUgPSBmdW5jdGlvbiAob2xkU25hcCwgbmV3U25hcCwgb3B0Q2hhbmdlQWNjdW11bGF0b3IpIHtcbiAgICAgICAgdmFyIGZpbHRlcmVkO1xuICAgICAgICBpZiAobmV3U25hcC5pc0xlYWZOb2RlKCkgfHwgbmV3U25hcC5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgIC8vIE1ha2Ugc3VyZSB3ZSBoYXZlIGEgY2hpbGRyZW4gbm9kZSB3aXRoIHRoZSBjb3JyZWN0IGluZGV4LCBub3QgYSBsZWFmIG5vZGU7XG4gICAgICAgICAgICBmaWx0ZXJlZCA9IENoaWxkcmVuTm9kZV8xLkNoaWxkcmVuTm9kZS5FTVBUWV9OT0RFLndpdGhJbmRleCh0aGlzLmluZGV4Xyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAodGhpcy5saW1pdF8gKiAyIDwgbmV3U25hcC5udW1DaGlsZHJlbigpICYmXG4gICAgICAgICAgICAgICAgbmV3U25hcC5pc0luZGV4ZWQodGhpcy5pbmRleF8pKSB7XG4gICAgICAgICAgICAgICAgLy8gRWFzaWVyIHRvIGJ1aWxkIHVwIGEgc25hcHNob3QsIHNpbmNlIHdoYXQgd2UncmUgZ2l2ZW4gaGFzIG1vcmUgdGhhbiB0d2ljZSB0aGUgZWxlbWVudHMgd2Ugd2FudFxuICAgICAgICAgICAgICAgIGZpbHRlcmVkID0gQ2hpbGRyZW5Ob2RlXzEuQ2hpbGRyZW5Ob2RlLkVNUFRZX05PREUud2l0aEluZGV4KHRoaXMuaW5kZXhfKTtcbiAgICAgICAgICAgICAgICAvLyBhbmNob3IgdG8gdGhlIHN0YXJ0UG9zdCwgZW5kUG9zdCwgb3IgbGFzdCBlbGVtZW50IGFzIGFwcHJvcHJpYXRlXG4gICAgICAgICAgICAgICAgdmFyIGl0ZXJhdG9yID0gdm9pZCAwO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnJldmVyc2VfKSB7XG4gICAgICAgICAgICAgICAgICAgIGl0ZXJhdG9yID0gbmV3U25hcC5nZXRSZXZlcnNlSXRlcmF0b3JGcm9tKHRoaXMucmFuZ2VkRmlsdGVyXy5nZXRFbmRQb3N0KCksIHRoaXMuaW5kZXhfKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGl0ZXJhdG9yID0gbmV3U25hcC5nZXRJdGVyYXRvckZyb20odGhpcy5yYW5nZWRGaWx0ZXJfLmdldFN0YXJ0UG9zdCgpLCB0aGlzLmluZGV4Xyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBjb3VudCA9IDA7XG4gICAgICAgICAgICAgICAgd2hpbGUgKGl0ZXJhdG9yLmhhc05leHQoKSAmJiBjb3VudCA8IHRoaXMubGltaXRfKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXh0ID0gaXRlcmF0b3IuZ2V0TmV4dCgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaW5SYW5nZSA9IHZvaWQgMDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucmV2ZXJzZV8pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluUmFuZ2UgPVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW5kZXhfLmNvbXBhcmUodGhpcy5yYW5nZWRGaWx0ZXJfLmdldFN0YXJ0UG9zdCgpLCBuZXh0KSA8PSAwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5SYW5nZSA9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbmRleF8uY29tcGFyZShuZXh0LCB0aGlzLnJhbmdlZEZpbHRlcl8uZ2V0RW5kUG9zdCgpKSA8PSAwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChpblJhbmdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJlZCA9IGZpbHRlcmVkLnVwZGF0ZUltbWVkaWF0ZUNoaWxkKG5leHQubmFtZSwgbmV4dC5ub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50Kys7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiB3ZSBoYXZlIHJlYWNoZWQgdGhlIGVuZCBwb3N0LCB3ZSBjYW5ub3Qga2VlcCBhZGRpbmcgZWxlbW1lbnRzXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIFRoZSBzbmFwIGNvbnRhaW5zIGxlc3MgdGhhbiB0d2ljZSB0aGUgbGltaXQuIEZhc3RlciB0byBkZWxldGUgZnJvbSB0aGUgc25hcCB0aGFuIGJ1aWxkIHVwIGEgbmV3IG9uZVxuICAgICAgICAgICAgICAgIGZpbHRlcmVkID0gbmV3U25hcC53aXRoSW5kZXgodGhpcy5pbmRleF8pO1xuICAgICAgICAgICAgICAgIC8vIERvbid0IHN1cHBvcnQgcHJpb3JpdGllcyBvbiBxdWVyaWVzXG4gICAgICAgICAgICAgICAgZmlsdGVyZWQgPSBmaWx0ZXJlZC51cGRhdGVQcmlvcml0eShDaGlsZHJlbk5vZGVfMS5DaGlsZHJlbk5vZGUuRU1QVFlfTk9ERSk7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXJ0UG9zdCA9IHZvaWQgMDtcbiAgICAgICAgICAgICAgICB2YXIgZW5kUG9zdCA9IHZvaWQgMDtcbiAgICAgICAgICAgICAgICB2YXIgY21wID0gdm9pZCAwO1xuICAgICAgICAgICAgICAgIHZhciBpdGVyYXRvciA9IHZvaWQgMDtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5yZXZlcnNlXykge1xuICAgICAgICAgICAgICAgICAgICBpdGVyYXRvciA9IGZpbHRlcmVkLmdldFJldmVyc2VJdGVyYXRvcih0aGlzLmluZGV4Xyk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0UG9zdCA9IHRoaXMucmFuZ2VkRmlsdGVyXy5nZXRFbmRQb3N0KCk7XG4gICAgICAgICAgICAgICAgICAgIGVuZFBvc3QgPSB0aGlzLnJhbmdlZEZpbHRlcl8uZ2V0U3RhcnRQb3N0KCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRleENvbXBhcmVfMSA9IHRoaXMuaW5kZXhfLmdldENvbXBhcmUoKTtcbiAgICAgICAgICAgICAgICAgICAgY21wID0gZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGluZGV4Q29tcGFyZV8xKGIsIGEpOyB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaXRlcmF0b3IgPSBmaWx0ZXJlZC5nZXRJdGVyYXRvcih0aGlzLmluZGV4Xyk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0UG9zdCA9IHRoaXMucmFuZ2VkRmlsdGVyXy5nZXRTdGFydFBvc3QoKTtcbiAgICAgICAgICAgICAgICAgICAgZW5kUG9zdCA9IHRoaXMucmFuZ2VkRmlsdGVyXy5nZXRFbmRQb3N0KCk7XG4gICAgICAgICAgICAgICAgICAgIGNtcCA9IHRoaXMuaW5kZXhfLmdldENvbXBhcmUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGNvdW50ID0gMDtcbiAgICAgICAgICAgICAgICB2YXIgZm91bmRTdGFydFBvc3QgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB3aGlsZSAoaXRlcmF0b3IuaGFzTmV4dCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXh0ID0gaXRlcmF0b3IuZ2V0TmV4dCgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWZvdW5kU3RhcnRQb3N0ICYmIGNtcChzdGFydFBvc3QsIG5leHQpIDw9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0YXJ0IGFkZGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgZm91bmRTdGFydFBvc3QgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciBpblJhbmdlID0gZm91bmRTdGFydFBvc3QgJiYgY291bnQgPCB0aGlzLmxpbWl0XyAmJiBjbXAobmV4dCwgZW5kUG9zdCkgPD0gMDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluUmFuZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50Kys7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJlZCA9IGZpbHRlcmVkLnVwZGF0ZUltbWVkaWF0ZUNoaWxkKG5leHQubmFtZSwgQ2hpbGRyZW5Ob2RlXzEuQ2hpbGRyZW5Ob2RlLkVNUFRZX05PREUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJhbmdlZEZpbHRlcl9cbiAgICAgICAgICAgIC5nZXRJbmRleGVkRmlsdGVyKClcbiAgICAgICAgICAgIC51cGRhdGVGdWxsTm9kZShvbGRTbmFwLCBmaWx0ZXJlZCwgb3B0Q2hhbmdlQWNjdW11bGF0b3IpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBMaW1pdGVkRmlsdGVyLnByb3RvdHlwZS51cGRhdGVQcmlvcml0eSA9IGZ1bmN0aW9uIChvbGRTbmFwLCBuZXdQcmlvcml0eSkge1xuICAgICAgICAvLyBEb24ndCBzdXBwb3J0IHByaW9yaXRpZXMgb24gcXVlcmllc1xuICAgICAgICByZXR1cm4gb2xkU25hcDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgTGltaXRlZEZpbHRlci5wcm90b3R5cGUuZmlsdGVyc05vZGVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgTGltaXRlZEZpbHRlci5wcm90b3R5cGUuZ2V0SW5kZXhlZEZpbHRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmFuZ2VkRmlsdGVyXy5nZXRJbmRleGVkRmlsdGVyKCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIExpbWl0ZWRGaWx0ZXIucHJvdG90eXBlLmdldEluZGV4ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pbmRleF87XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFOb2RlfSBzbmFwXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGNoaWxkS2V5XG4gICAgICogQHBhcmFtIHshTm9kZX0gY2hpbGRTbmFwXG4gICAgICogQHBhcmFtIHshQ29tcGxldGVDaGlsZFNvdXJjZX0gc291cmNlXG4gICAgICogQHBhcmFtIHs/Q2hpbGRDaGFuZ2VBY2N1bXVsYXRvcn0gY2hhbmdlQWNjdW11bGF0b3JcbiAgICAgKiBAcmV0dXJuIHshTm9kZX1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIExpbWl0ZWRGaWx0ZXIucHJvdG90eXBlLmZ1bGxMaW1pdFVwZGF0ZUNoaWxkXyA9IGZ1bmN0aW9uIChzbmFwLCBjaGlsZEtleSwgY2hpbGRTbmFwLCBzb3VyY2UsIGNoYW5nZUFjY3VtdWxhdG9yKSB7XG4gICAgICAgIC8vIFRPRE86IHJlbmFtZSBhbGwgY2FjaGUgc3R1ZmYgZXRjIHRvIGdlbmVyYWwgc25hcCB0ZXJtaW5vbG9neVxuICAgICAgICB2YXIgY21wO1xuICAgICAgICBpZiAodGhpcy5yZXZlcnNlXykge1xuICAgICAgICAgICAgdmFyIGluZGV4Q21wXzEgPSB0aGlzLmluZGV4Xy5nZXRDb21wYXJlKCk7XG4gICAgICAgICAgICBjbXAgPSBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gaW5kZXhDbXBfMShiLCBhKTsgfTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNtcCA9IHRoaXMuaW5kZXhfLmdldENvbXBhcmUoKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgb2xkRXZlbnRDYWNoZSA9IHNuYXA7XG4gICAgICAgIHV0aWxfMS5hc3NlcnQob2xkRXZlbnRDYWNoZS5udW1DaGlsZHJlbigpID09IHRoaXMubGltaXRfLCAnJyk7XG4gICAgICAgIHZhciBuZXdDaGlsZE5hbWVkTm9kZSA9IG5ldyBOb2RlXzEuTmFtZWROb2RlKGNoaWxkS2V5LCBjaGlsZFNuYXApO1xuICAgICAgICB2YXIgd2luZG93Qm91bmRhcnkgPSB0aGlzLnJldmVyc2VfXG4gICAgICAgICAgICA/IG9sZEV2ZW50Q2FjaGUuZ2V0Rmlyc3RDaGlsZCh0aGlzLmluZGV4XylcbiAgICAgICAgICAgIDogb2xkRXZlbnRDYWNoZS5nZXRMYXN0Q2hpbGQodGhpcy5pbmRleF8pO1xuICAgICAgICB2YXIgaW5SYW5nZSA9IHRoaXMucmFuZ2VkRmlsdGVyXy5tYXRjaGVzKG5ld0NoaWxkTmFtZWROb2RlKTtcbiAgICAgICAgaWYgKG9sZEV2ZW50Q2FjaGUuaGFzQ2hpbGQoY2hpbGRLZXkpKSB7XG4gICAgICAgICAgICB2YXIgb2xkQ2hpbGRTbmFwID0gb2xkRXZlbnRDYWNoZS5nZXRJbW1lZGlhdGVDaGlsZChjaGlsZEtleSk7XG4gICAgICAgICAgICB2YXIgbmV4dENoaWxkID0gc291cmNlLmdldENoaWxkQWZ0ZXJDaGlsZCh0aGlzLmluZGV4Xywgd2luZG93Qm91bmRhcnksIHRoaXMucmV2ZXJzZV8pO1xuICAgICAgICAgICAgd2hpbGUgKG5leHRDaGlsZCAhPSBudWxsICYmXG4gICAgICAgICAgICAgICAgKG5leHRDaGlsZC5uYW1lID09IGNoaWxkS2V5IHx8IG9sZEV2ZW50Q2FjaGUuaGFzQ2hpbGQobmV4dENoaWxkLm5hbWUpKSkge1xuICAgICAgICAgICAgICAgIC8vIFRoZXJlIGlzIGEgd2VpcmQgZWRnZSBjYXNlIHdoZXJlIGEgbm9kZSBpcyB1cGRhdGVkIGFzIHBhcnQgb2YgYSBtZXJnZSBpbiB0aGUgd3JpdGUgdHJlZSwgYnV0IGhhc24ndFxuICAgICAgICAgICAgICAgIC8vIGJlZW4gYXBwbGllZCB0byB0aGUgbGltaXRlZCBmaWx0ZXIgeWV0LiBJZ25vcmUgdGhpcyBuZXh0IGNoaWxkIHdoaWNoIHdpbGwgYmUgdXBkYXRlZCBsYXRlciBpblxuICAgICAgICAgICAgICAgIC8vIHRoZSBsaW1pdGVkIGZpbHRlci4uLlxuICAgICAgICAgICAgICAgIG5leHRDaGlsZCA9IHNvdXJjZS5nZXRDaGlsZEFmdGVyQ2hpbGQodGhpcy5pbmRleF8sIG5leHRDaGlsZCwgdGhpcy5yZXZlcnNlXyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgY29tcGFyZU5leHQgPSBuZXh0Q2hpbGQgPT0gbnVsbCA/IDEgOiBjbXAobmV4dENoaWxkLCBuZXdDaGlsZE5hbWVkTm9kZSk7XG4gICAgICAgICAgICB2YXIgcmVtYWluc0luV2luZG93ID0gaW5SYW5nZSAmJiAhY2hpbGRTbmFwLmlzRW1wdHkoKSAmJiBjb21wYXJlTmV4dCA+PSAwO1xuICAgICAgICAgICAgaWYgKHJlbWFpbnNJbldpbmRvdykge1xuICAgICAgICAgICAgICAgIGlmIChjaGFuZ2VBY2N1bXVsYXRvciAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZUFjY3VtdWxhdG9yLnRyYWNrQ2hpbGRDaGFuZ2UoQ2hhbmdlXzEuQ2hhbmdlLmNoaWxkQ2hhbmdlZENoYW5nZShjaGlsZEtleSwgY2hpbGRTbmFwLCBvbGRDaGlsZFNuYXApKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9sZEV2ZW50Q2FjaGUudXBkYXRlSW1tZWRpYXRlQ2hpbGQoY2hpbGRLZXksIGNoaWxkU25hcCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoY2hhbmdlQWNjdW11bGF0b3IgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VBY2N1bXVsYXRvci50cmFja0NoaWxkQ2hhbmdlKENoYW5nZV8xLkNoYW5nZS5jaGlsZFJlbW92ZWRDaGFuZ2UoY2hpbGRLZXksIG9sZENoaWxkU25hcCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgbmV3RXZlbnRDYWNoZSA9IG9sZEV2ZW50Q2FjaGUudXBkYXRlSW1tZWRpYXRlQ2hpbGQoY2hpbGRLZXksIENoaWxkcmVuTm9kZV8xLkNoaWxkcmVuTm9kZS5FTVBUWV9OT0RFKTtcbiAgICAgICAgICAgICAgICB2YXIgbmV4dENoaWxkSW5SYW5nZSA9IG5leHRDaGlsZCAhPSBudWxsICYmIHRoaXMucmFuZ2VkRmlsdGVyXy5tYXRjaGVzKG5leHRDaGlsZCk7XG4gICAgICAgICAgICAgICAgaWYgKG5leHRDaGlsZEluUmFuZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoYW5nZUFjY3VtdWxhdG9yICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZUFjY3VtdWxhdG9yLnRyYWNrQ2hpbGRDaGFuZ2UoQ2hhbmdlXzEuQ2hhbmdlLmNoaWxkQWRkZWRDaGFuZ2UobmV4dENoaWxkLm5hbWUsIG5leHRDaGlsZC5ub2RlKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ld0V2ZW50Q2FjaGUudXBkYXRlSW1tZWRpYXRlQ2hpbGQobmV4dENoaWxkLm5hbWUsIG5leHRDaGlsZC5ub2RlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXdFdmVudENhY2hlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjaGlsZFNuYXAuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAvLyB3ZSdyZSBkZWxldGluZyBhIG5vZGUsIGJ1dCBpdCB3YXMgbm90IGluIHRoZSB3aW5kb3csIHNvIGlnbm9yZSBpdFxuICAgICAgICAgICAgcmV0dXJuIHNuYXA7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaW5SYW5nZSkge1xuICAgICAgICAgICAgaWYgKGNtcCh3aW5kb3dCb3VuZGFyeSwgbmV3Q2hpbGROYW1lZE5vZGUpID49IDApIHtcbiAgICAgICAgICAgICAgICBpZiAoY2hhbmdlQWNjdW11bGF0b3IgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VBY2N1bXVsYXRvci50cmFja0NoaWxkQ2hhbmdlKENoYW5nZV8xLkNoYW5nZS5jaGlsZFJlbW92ZWRDaGFuZ2Uod2luZG93Qm91bmRhcnkubmFtZSwgd2luZG93Qm91bmRhcnkubm9kZSkpO1xuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VBY2N1bXVsYXRvci50cmFja0NoaWxkQ2hhbmdlKENoYW5nZV8xLkNoYW5nZS5jaGlsZEFkZGVkQ2hhbmdlKGNoaWxkS2V5LCBjaGlsZFNuYXApKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9sZEV2ZW50Q2FjaGVcbiAgICAgICAgICAgICAgICAgICAgLnVwZGF0ZUltbWVkaWF0ZUNoaWxkKGNoaWxkS2V5LCBjaGlsZFNuYXApXG4gICAgICAgICAgICAgICAgICAgIC51cGRhdGVJbW1lZGlhdGVDaGlsZCh3aW5kb3dCb3VuZGFyeS5uYW1lLCBDaGlsZHJlbk5vZGVfMS5DaGlsZHJlbk5vZGUuRU1QVFlfTk9ERSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc25hcDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBzbmFwO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gTGltaXRlZEZpbHRlcjtcbn0oKSk7XG5leHBvcnRzLkxpbWl0ZWRGaWx0ZXIgPSBMaW1pdGVkRmlsdGVyO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1MaW1pdGVkRmlsdGVyLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIEluZGV4ZWRGaWx0ZXJfMSA9IHJlcXVpcmUoXCIuL0luZGV4ZWRGaWx0ZXJcIik7XG52YXIgUHJpb3JpdHlJbmRleF8xID0gcmVxdWlyZShcIi4uLy4uL3NuYXAvaW5kZXhlcy9Qcmlvcml0eUluZGV4XCIpO1xudmFyIE5vZGVfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9jb3JlL3NuYXAvTm9kZVwiKTtcbnZhciBDaGlsZHJlbk5vZGVfMSA9IHJlcXVpcmUoXCIuLi8uLi9zbmFwL0NoaWxkcmVuTm9kZVwiKTtcbi8qKlxuICogRmlsdGVycyBub2RlcyBieSByYW5nZSBhbmQgdXNlcyBhbiBJbmRleEZpbHRlciB0byB0cmFjayBhbnkgY2hhbmdlcyBhZnRlciBmaWx0ZXJpbmcgdGhlIG5vZGVcbiAqXG4gKiBAY29uc3RydWN0b3JcbiAqIEBpbXBsZW1lbnRzIHtOb2RlRmlsdGVyfVxuICovXG52YXIgUmFuZ2VkRmlsdGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7IVF1ZXJ5UGFyYW1zfSBwYXJhbXNcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBSYW5nZWRGaWx0ZXIocGFyYW1zKSB7XG4gICAgICAgIHRoaXMuaW5kZXhlZEZpbHRlcl8gPSBuZXcgSW5kZXhlZEZpbHRlcl8xLkluZGV4ZWRGaWx0ZXIocGFyYW1zLmdldEluZGV4KCkpO1xuICAgICAgICB0aGlzLmluZGV4XyA9IHBhcmFtcy5nZXRJbmRleCgpO1xuICAgICAgICB0aGlzLnN0YXJ0UG9zdF8gPSBSYW5nZWRGaWx0ZXIuZ2V0U3RhcnRQb3N0XyhwYXJhbXMpO1xuICAgICAgICB0aGlzLmVuZFBvc3RfID0gUmFuZ2VkRmlsdGVyLmdldEVuZFBvc3RfKHBhcmFtcyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEByZXR1cm4geyFOYW1lZE5vZGV9XG4gICAgICovXG4gICAgUmFuZ2VkRmlsdGVyLnByb3RvdHlwZS5nZXRTdGFydFBvc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN0YXJ0UG9zdF87XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHshTmFtZWROb2RlfVxuICAgICAqL1xuICAgIFJhbmdlZEZpbHRlci5wcm90b3R5cGUuZ2V0RW5kUG9zdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZW5kUG9zdF87XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFOYW1lZE5vZGV9IG5vZGVcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgICAqL1xuICAgIFJhbmdlZEZpbHRlci5wcm90b3R5cGUubWF0Y2hlcyA9IGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgIHJldHVybiAodGhpcy5pbmRleF8uY29tcGFyZSh0aGlzLmdldFN0YXJ0UG9zdCgpLCBub2RlKSA8PSAwICYmXG4gICAgICAgICAgICB0aGlzLmluZGV4Xy5jb21wYXJlKG5vZGUsIHRoaXMuZ2V0RW5kUG9zdCgpKSA8PSAwKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgUmFuZ2VkRmlsdGVyLnByb3RvdHlwZS51cGRhdGVDaGlsZCA9IGZ1bmN0aW9uIChzbmFwLCBrZXksIG5ld0NoaWxkLCBhZmZlY3RlZFBhdGgsIHNvdXJjZSwgb3B0Q2hhbmdlQWNjdW11bGF0b3IpIHtcbiAgICAgICAgaWYgKCF0aGlzLm1hdGNoZXMobmV3IE5vZGVfMS5OYW1lZE5vZGUoa2V5LCBuZXdDaGlsZCkpKSB7XG4gICAgICAgICAgICBuZXdDaGlsZCA9IENoaWxkcmVuTm9kZV8xLkNoaWxkcmVuTm9kZS5FTVBUWV9OT0RFO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmluZGV4ZWRGaWx0ZXJfLnVwZGF0ZUNoaWxkKHNuYXAsIGtleSwgbmV3Q2hpbGQsIGFmZmVjdGVkUGF0aCwgc291cmNlLCBvcHRDaGFuZ2VBY2N1bXVsYXRvcik7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIFJhbmdlZEZpbHRlci5wcm90b3R5cGUudXBkYXRlRnVsbE5vZGUgPSBmdW5jdGlvbiAob2xkU25hcCwgbmV3U25hcCwgb3B0Q2hhbmdlQWNjdW11bGF0b3IpIHtcbiAgICAgICAgaWYgKG5ld1NuYXAuaXNMZWFmTm9kZSgpKSB7XG4gICAgICAgICAgICAvLyBNYWtlIHN1cmUgd2UgaGF2ZSBhIGNoaWxkcmVuIG5vZGUgd2l0aCB0aGUgY29ycmVjdCBpbmRleCwgbm90IGEgbGVhZiBub2RlO1xuICAgICAgICAgICAgbmV3U25hcCA9IENoaWxkcmVuTm9kZV8xLkNoaWxkcmVuTm9kZS5FTVBUWV9OT0RFO1xuICAgICAgICB9XG4gICAgICAgIHZhciBmaWx0ZXJlZCA9IG5ld1NuYXAud2l0aEluZGV4KHRoaXMuaW5kZXhfKTtcbiAgICAgICAgLy8gRG9uJ3Qgc3VwcG9ydCBwcmlvcml0aWVzIG9uIHF1ZXJpZXNcbiAgICAgICAgZmlsdGVyZWQgPSBmaWx0ZXJlZC51cGRhdGVQcmlvcml0eShDaGlsZHJlbk5vZGVfMS5DaGlsZHJlbk5vZGUuRU1QVFlfTk9ERSk7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgbmV3U25hcC5mb3JFYWNoQ2hpbGQoUHJpb3JpdHlJbmRleF8xLlBSSU9SSVRZX0lOREVYLCBmdW5jdGlvbiAoa2V5LCBjaGlsZE5vZGUpIHtcbiAgICAgICAgICAgIGlmICghc2VsZi5tYXRjaGVzKG5ldyBOb2RlXzEuTmFtZWROb2RlKGtleSwgY2hpbGROb2RlKSkpIHtcbiAgICAgICAgICAgICAgICBmaWx0ZXJlZCA9IGZpbHRlcmVkLnVwZGF0ZUltbWVkaWF0ZUNoaWxkKGtleSwgQ2hpbGRyZW5Ob2RlXzEuQ2hpbGRyZW5Ob2RlLkVNUFRZX05PREUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5kZXhlZEZpbHRlcl8udXBkYXRlRnVsbE5vZGUob2xkU25hcCwgZmlsdGVyZWQsIG9wdENoYW5nZUFjY3VtdWxhdG9yKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgUmFuZ2VkRmlsdGVyLnByb3RvdHlwZS51cGRhdGVQcmlvcml0eSA9IGZ1bmN0aW9uIChvbGRTbmFwLCBuZXdQcmlvcml0eSkge1xuICAgICAgICAvLyBEb24ndCBzdXBwb3J0IHByaW9yaXRpZXMgb24gcXVlcmllc1xuICAgICAgICByZXR1cm4gb2xkU25hcDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgUmFuZ2VkRmlsdGVyLnByb3RvdHlwZS5maWx0ZXJzTm9kZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBSYW5nZWRGaWx0ZXIucHJvdG90eXBlLmdldEluZGV4ZWRGaWx0ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmluZGV4ZWRGaWx0ZXJfO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBSYW5nZWRGaWx0ZXIucHJvdG90eXBlLmdldEluZGV4ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pbmRleF87XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFRdWVyeVBhcmFtc30gcGFyYW1zXG4gICAgICogQHJldHVybiB7IU5hbWVkTm9kZX1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIFJhbmdlZEZpbHRlci5nZXRTdGFydFBvc3RfID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICBpZiAocGFyYW1zLmhhc1N0YXJ0KCkpIHtcbiAgICAgICAgICAgIHZhciBzdGFydE5hbWUgPSBwYXJhbXMuZ2V0SW5kZXhTdGFydE5hbWUoKTtcbiAgICAgICAgICAgIHJldHVybiBwYXJhbXMuZ2V0SW5kZXgoKS5tYWtlUG9zdChwYXJhbXMuZ2V0SW5kZXhTdGFydFZhbHVlKCksIHN0YXJ0TmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gcGFyYW1zLmdldEluZGV4KCkubWluUG9zdCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFRdWVyeVBhcmFtc30gcGFyYW1zXG4gICAgICogQHJldHVybiB7IU5hbWVkTm9kZX1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIFJhbmdlZEZpbHRlci5nZXRFbmRQb3N0XyA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgaWYgKHBhcmFtcy5oYXNFbmQoKSkge1xuICAgICAgICAgICAgdmFyIGVuZE5hbWUgPSBwYXJhbXMuZ2V0SW5kZXhFbmROYW1lKCk7XG4gICAgICAgICAgICByZXR1cm4gcGFyYW1zLmdldEluZGV4KCkubWFrZVBvc3QocGFyYW1zLmdldEluZGV4RW5kVmFsdWUoKSwgZW5kTmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gcGFyYW1zLmdldEluZGV4KCkubWF4UG9zdCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gUmFuZ2VkRmlsdGVyO1xufSgpKTtcbmV4cG9ydHMuUmFuZ2VkRmlsdGVyID0gUmFuZ2VkRmlsdGVyO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1SYW5nZWRGaWx0ZXIuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdXRpbF8xID0gcmVxdWlyZShcIi4uL2NvcmUvdXRpbC91dGlsXCIpO1xudmFyIENvdW50ZWRTZXRfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3V0aWwvQ291bnRlZFNldFwiKTtcbnZhciBTdGF0c01hbmFnZXJfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3N0YXRzL1N0YXRzTWFuYWdlclwiKTtcbnZhciBQYWNrZXRSZWNlaXZlcl8xID0gcmVxdWlyZShcIi4vcG9sbGluZy9QYWNrZXRSZWNlaXZlclwiKTtcbnZhciBDb25zdGFudHNfMSA9IHJlcXVpcmUoXCIuL0NvbnN0YW50c1wiKTtcbnZhciB1dGlsXzIgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG52YXIgdXRpbF8zID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xuLy8gVVJMIHF1ZXJ5IHBhcmFtZXRlcnMgYXNzb2NpYXRlZCB3aXRoIGxvbmdwb2xsaW5nXG5leHBvcnRzLkZJUkVCQVNFX0xPTkdQT0xMX1NUQVJUX1BBUkFNID0gJ3N0YXJ0JztcbmV4cG9ydHMuRklSRUJBU0VfTE9OR1BPTExfQ0xPU0VfQ09NTUFORCA9ICdjbG9zZSc7XG5leHBvcnRzLkZJUkVCQVNFX0xPTkdQT0xMX0NPTU1BTkRfQ0JfTkFNRSA9ICdwTFBDb21tYW5kJztcbmV4cG9ydHMuRklSRUJBU0VfTE9OR1BPTExfREFUQV9DQl9OQU1FID0gJ3BSVExQQ0InO1xuZXhwb3J0cy5GSVJFQkFTRV9MT05HUE9MTF9JRF9QQVJBTSA9ICdpZCc7XG5leHBvcnRzLkZJUkVCQVNFX0xPTkdQT0xMX1BXX1BBUkFNID0gJ3B3JztcbmV4cG9ydHMuRklSRUJBU0VfTE9OR1BPTExfU0VSSUFMX1BBUkFNID0gJ3Nlcic7XG5leHBvcnRzLkZJUkVCQVNFX0xPTkdQT0xMX0NBTExCQUNLX0lEX1BBUkFNID0gJ2NiJztcbmV4cG9ydHMuRklSRUJBU0VfTE9OR1BPTExfU0VHTUVOVF9OVU1fUEFSQU0gPSAnc2VnJztcbmV4cG9ydHMuRklSRUJBU0VfTE9OR1BPTExfU0VHTUVOVFNfSU5fUEFDS0VUID0gJ3RzJztcbmV4cG9ydHMuRklSRUJBU0VfTE9OR1BPTExfREFUQV9QQVJBTSA9ICdkJztcbmV4cG9ydHMuRklSRUJBU0VfTE9OR1BPTExfRElTQ09OTl9GUkFNRV9QQVJBTSA9ICdkaXNjb25uJztcbmV4cG9ydHMuRklSRUJBU0VfTE9OR1BPTExfRElTQ09OTl9GUkFNRV9SRVFVRVNUX1BBUkFNID0gJ2RmcmFtZSc7XG4vL0RhdGEgc2l6ZSBjb25zdGFudHMuXG4vL1RPRE86IFBlcmY6IHRoZSBtYXhpbXVtIGxlbmd0aCBhY3R1YWxseSBkaWZmZXJzIGZyb20gYnJvd3NlciB0byBicm93c2VyLlxuLy8gV2Ugc2hvdWxkIGNoZWNrIHdoYXQgYnJvd3NlciB3ZSdyZSBvbiBhbmQgc2V0IGFjY29yZGluZ2x5LlxudmFyIE1BWF9VUkxfREFUQV9TSVpFID0gMTg3MDtcbnZhciBTRUdfSEVBREVSX1NJWkUgPSAzMDsgLy9pZTogJnNlZz04Mjk5MjM0JnRzPTk4MjM4OTEyMyZkPVxudmFyIE1BWF9QQVlMT0FEX1NJWkUgPSBNQVhfVVJMX0RBVEFfU0laRSAtIFNFR19IRUFERVJfU0laRTtcbi8qKlxuICogS2VlcGFsaXZlIHBlcmlvZFxuICogc2VuZCBhIGZyZXNoIHJlcXVlc3QgYXQgbWluaW11bSBldmVyeSAyNSBzZWNvbmRzLiBPcGVyYSBoYXMgYSBtYXhpbXVtIHJlcXVlc3RcbiAqIGxlbmd0aCBvZiAzMCBzZWNvbmRzIHRoYXQgd2UgY2FuJ3QgZXhjZWVkLlxuICogQGNvbnN0XG4gKiBAdHlwZSB7bnVtYmVyfVxuICovXG52YXIgS0VFUEFMSVZFX1JFUVVFU1RfSU5URVJWQUwgPSAyNTAwMDtcbi8qKlxuICogSG93IGxvbmcgdG8gd2FpdCBiZWZvcmUgYWJvcnRpbmcgYSBsb25nLXBvbGxpbmcgY29ubmVjdGlvbiBhdHRlbXB0LlxuICogQGNvbnN0XG4gKiBAdHlwZSB7bnVtYmVyfVxuICovXG52YXIgTFBfQ09OTkVDVF9USU1FT1VUID0gMzAwMDA7XG4vKipcbiAqIFRoaXMgY2xhc3MgbWFuYWdlcyBhIHNpbmdsZSBsb25nLXBvbGxpbmcgY29ubmVjdGlvbi5cbiAqXG4gKiBAY29uc3RydWN0b3JcbiAqIEBpbXBsZW1lbnRzIHtUcmFuc3BvcnR9XG4gKi9cbnZhciBCcm93c2VyUG9sbENvbm5lY3Rpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGNvbm5JZCBBbiBpZGVudGlmaWVyIGZvciB0aGlzIGNvbm5lY3Rpb24sIHVzZWQgZm9yIGxvZ2dpbmdcbiAgICAgKiBAcGFyYW0ge1JlcG9JbmZvfSByZXBvSW5mbyBUaGUgaW5mbyBmb3IgdGhlIGVuZHBvaW50IHRvIHNlbmQgZGF0YSB0by5cbiAgICAgKiBAcGFyYW0ge3N0cmluZz19IHRyYW5zcG9ydFNlc3Npb25JZCBPcHRpb25hbCB0cmFuc3BvcnRTZXNzaW9uaWQgaWYgd2UgYXJlIHJlY29ubmVjdGluZyBmb3IgYW4gZXhpc3RpbmdcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNwb3J0IHNlc3Npb25cbiAgICAgKiBAcGFyYW0ge3N0cmluZz19ICBsYXN0U2Vzc2lvbklkIE9wdGlvbmFsIGxhc3RTZXNzaW9uSWQgaWYgdGhlIFBlcnNpc3RlbnRDb25uZWN0aW9uIGhhcyBhbHJlYWR5IGNyZWF0ZWQgYVxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbm5lY3Rpb24gcHJldmlvdXNseVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIEJyb3dzZXJQb2xsQ29ubmVjdGlvbihjb25uSWQsIHJlcG9JbmZvLCB0cmFuc3BvcnRTZXNzaW9uSWQsIGxhc3RTZXNzaW9uSWQpIHtcbiAgICAgICAgdGhpcy5jb25uSWQgPSBjb25uSWQ7XG4gICAgICAgIHRoaXMucmVwb0luZm8gPSByZXBvSW5mbztcbiAgICAgICAgdGhpcy50cmFuc3BvcnRTZXNzaW9uSWQgPSB0cmFuc3BvcnRTZXNzaW9uSWQ7XG4gICAgICAgIHRoaXMubGFzdFNlc3Npb25JZCA9IGxhc3RTZXNzaW9uSWQ7XG4gICAgICAgIHRoaXMuYnl0ZXNTZW50ID0gMDtcbiAgICAgICAgdGhpcy5ieXRlc1JlY2VpdmVkID0gMDtcbiAgICAgICAgdGhpcy5ldmVyQ29ubmVjdGVkXyA9IGZhbHNlO1xuICAgICAgICB0aGlzLmxvZ18gPSB1dGlsXzEubG9nV3JhcHBlcihjb25uSWQpO1xuICAgICAgICB0aGlzLnN0YXRzXyA9IFN0YXRzTWFuYWdlcl8xLlN0YXRzTWFuYWdlci5nZXRDb2xsZWN0aW9uKHJlcG9JbmZvKTtcbiAgICAgICAgdGhpcy51cmxGbiA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgICAgIHJldHVybiByZXBvSW5mby5jb25uZWN0aW9uVVJMKENvbnN0YW50c18xLkxPTkdfUE9MTElORywgcGFyYW1zKTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKE9iamVjdCl9IG9uTWVzc2FnZSBDYWxsYmFjayB3aGVuIG1lc3NhZ2VzIGFycml2ZVxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oKX0gb25EaXNjb25uZWN0IENhbGxiYWNrIHdpdGggY29ubmVjdGlvbiBsb3N0LlxuICAgICAqL1xuICAgIEJyb3dzZXJQb2xsQ29ubmVjdGlvbi5wcm90b3R5cGUub3BlbiA9IGZ1bmN0aW9uIChvbk1lc3NhZ2UsIG9uRGlzY29ubmVjdCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLmN1clNlZ21lbnROdW0gPSAwO1xuICAgICAgICB0aGlzLm9uRGlzY29ubmVjdF8gPSBvbkRpc2Nvbm5lY3Q7XG4gICAgICAgIHRoaXMubXlQYWNrZXRPcmRlcmVyID0gbmV3IFBhY2tldFJlY2VpdmVyXzEuUGFja2V0UmVjZWl2ZXIob25NZXNzYWdlKTtcbiAgICAgICAgdGhpcy5pc0Nsb3NlZF8gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5jb25uZWN0VGltZW91dFRpbWVyXyA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3RoaXMubG9nXygnVGltZWQgb3V0IHRyeWluZyB0byBjb25uZWN0LicpO1xuICAgICAgICAgICAgLy8gTWFrZSBzdXJlIHdlIGNsZWFyIHRoZSBob3N0IGNhY2hlXG4gICAgICAgICAgICBfdGhpcy5vbkNsb3NlZF8oKTtcbiAgICAgICAgICAgIF90aGlzLmNvbm5lY3RUaW1lb3V0VGltZXJfID0gbnVsbDtcbiAgICAgICAgfSwgTWF0aC5mbG9vcihMUF9DT05ORUNUX1RJTUVPVVQpKTtcbiAgICAgICAgLy8gRW5zdXJlIHdlIGRlbGF5IHRoZSBjcmVhdGlvbiBvZiB0aGUgaWZyYW1lIHVudGlsIHRoZSBET00gaXMgbG9hZGVkLlxuICAgICAgICB1dGlsXzEuZXhlY3V0ZVdoZW5ET01SZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoX3RoaXMuaXNDbG9zZWRfKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIC8vU2V0IHVwIGEgY2FsbGJhY2sgdGhhdCBnZXRzIHRyaWdnZXJlZCBvbmNlIGEgY29ubmVjdGlvbiBpcyBzZXQgdXAuXG4gICAgICAgICAgICBfdGhpcy5zY3JpcHRUYWdIb2xkZXIgPSBuZXcgRmlyZWJhc2VJRnJhbWVTY3JpcHRIb2xkZXIoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgY29tbWFuZCA9IGFyZ3NbMF0sIGFyZzEgPSBhcmdzWzFdLCBhcmcyID0gYXJnc1syXSwgYXJnMyA9IGFyZ3NbM10sIGFyZzQgPSBhcmdzWzRdO1xuICAgICAgICAgICAgICAgIF90aGlzLmluY3JlbWVudEluY29taW5nQnl0ZXNfKGFyZ3MpO1xuICAgICAgICAgICAgICAgIGlmICghX3RoaXMuc2NyaXB0VGFnSG9sZGVyKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47IC8vIHdlIGNsb3NlZCB0aGUgY29ubmVjdGlvbi5cbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuY29ubmVjdFRpbWVvdXRUaW1lcl8pIHtcbiAgICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KF90aGlzLmNvbm5lY3RUaW1lb3V0VGltZXJfKTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuY29ubmVjdFRpbWVvdXRUaW1lcl8gPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfdGhpcy5ldmVyQ29ubmVjdGVkXyA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQgPT0gZXhwb3J0cy5GSVJFQkFTRV9MT05HUE9MTF9TVEFSVF9QQVJBTSkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5pZCA9IGFyZzE7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnBhc3N3b3JkID0gYXJnMjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoY29tbWFuZCA9PT0gZXhwb3J0cy5GSVJFQkFTRV9MT05HUE9MTF9DTE9TRV9DT01NQU5EKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIERvbid0IGNsZWFyIHRoZSBob3N0IGNhY2hlLiBXZSBnb3QgYSByZXNwb25zZSBmcm9tIHRoZSBzZXJ2ZXIsIHNvIHdlIGtub3cgaXQncyByZWFjaGFibGVcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFyZzEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFdlIGFyZW4ndCBleHBlY3RpbmcgYW55IG1vcmUgZGF0YSAob3RoZXIgdGhhbiB3aGF0IHRoZSBzZXJ2ZXIncyBhbHJlYWR5IGluIHRoZSBwcm9jZXNzIG9mIHNlbmRpbmcgdXNcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRocm91Z2ggb3VyIGFscmVhZHkgb3BlbiBwb2xscyksIHNvIGRvbid0IHNlbmQgYW55IG1vcmUuXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zY3JpcHRUYWdIb2xkZXIuc2VuZE5ld1BvbGxzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhcmcxIGluIHRoaXMgY2FzZSBpcyB0aGUgbGFzdCByZXNwb25zZSBudW1iZXIgc2VudCBieSB0aGUgc2VydmVyLiBXZSBzaG91bGQgdHJ5IHRvIHJlY2VpdmVcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFsbCBvZiB0aGUgcmVzcG9uc2VzIHVwIHRvIHRoaXMgb25lIGJlZm9yZSBjbG9zaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5teVBhY2tldE9yZGVyZXIuY2xvc2VBZnRlcihhcmcxLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMub25DbG9zZWRfKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLm9uQ2xvc2VkXygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VucmVjb2duaXplZCBjb21tYW5kIHJlY2VpdmVkOiAnICsgY29tbWFuZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcE4gPSBhcmdzWzBdLCBkYXRhID0gYXJnc1sxXTtcbiAgICAgICAgICAgICAgICBfdGhpcy5pbmNyZW1lbnRJbmNvbWluZ0J5dGVzXyhhcmdzKTtcbiAgICAgICAgICAgICAgICBfdGhpcy5teVBhY2tldE9yZGVyZXIuaGFuZGxlUmVzcG9uc2UocE4sIGRhdGEpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzLm9uQ2xvc2VkXygpO1xuICAgICAgICAgICAgfSwgX3RoaXMudXJsRm4pO1xuICAgICAgICAgICAgLy9TZW5kIHRoZSBpbml0aWFsIHJlcXVlc3QgdG8gY29ubmVjdC4gVGhlIHNlcmlhbCBudW1iZXIgaXMgc2ltcGx5IHRvIGtlZXAgdGhlIGJyb3dzZXIgZnJvbSBwdWxsaW5nIHByZXZpb3VzIHJlc3VsdHNcbiAgICAgICAgICAgIC8vZnJvbSBjYWNoZS5cbiAgICAgICAgICAgIHZhciB1cmxQYXJhbXMgPSB7fTtcbiAgICAgICAgICAgIHVybFBhcmFtc1tleHBvcnRzLkZJUkVCQVNFX0xPTkdQT0xMX1NUQVJUX1BBUkFNXSA9ICd0JztcbiAgICAgICAgICAgIHVybFBhcmFtc1tleHBvcnRzLkZJUkVCQVNFX0xPTkdQT0xMX1NFUklBTF9QQVJBTV0gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwMDAwMDApO1xuICAgICAgICAgICAgaWYgKF90aGlzLnNjcmlwdFRhZ0hvbGRlci51bmlxdWVDYWxsYmFja0lkZW50aWZpZXIpXG4gICAgICAgICAgICAgICAgdXJsUGFyYW1zW2V4cG9ydHMuRklSRUJBU0VfTE9OR1BPTExfQ0FMTEJBQ0tfSURfUEFSQU1dID0gX3RoaXMuc2NyaXB0VGFnSG9sZGVyLnVuaXF1ZUNhbGxiYWNrSWRlbnRpZmllcjtcbiAgICAgICAgICAgIHVybFBhcmFtc1tDb25zdGFudHNfMS5WRVJTSU9OX1BBUkFNXSA9IENvbnN0YW50c18xLlBST1RPQ09MX1ZFUlNJT047XG4gICAgICAgICAgICBpZiAoX3RoaXMudHJhbnNwb3J0U2Vzc2lvbklkKSB7XG4gICAgICAgICAgICAgICAgdXJsUGFyYW1zW0NvbnN0YW50c18xLlRSQU5TUE9SVF9TRVNTSU9OX1BBUkFNXSA9IF90aGlzLnRyYW5zcG9ydFNlc3Npb25JZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChfdGhpcy5sYXN0U2Vzc2lvbklkKSB7XG4gICAgICAgICAgICAgICAgdXJsUGFyYW1zW0NvbnN0YW50c18xLkxBU1RfU0VTU0lPTl9QQVJBTV0gPSBfdGhpcy5sYXN0U2Vzc2lvbklkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCF1dGlsXzMuaXNOb2RlU2RrKCkgJiZcbiAgICAgICAgICAgICAgICB0eXBlb2YgbG9jYXRpb24gIT09ICd1bmRlZmluZWQnICYmXG4gICAgICAgICAgICAgICAgbG9jYXRpb24uaHJlZiAmJlxuICAgICAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYuaW5kZXhPZihDb25zdGFudHNfMS5GT1JHRV9ET01BSU4pICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIHVybFBhcmFtc1tDb25zdGFudHNfMS5SRUZFUkVSX1BBUkFNXSA9IENvbnN0YW50c18xLkZPUkdFX1JFRjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjb25uZWN0VVJMID0gX3RoaXMudXJsRm4odXJsUGFyYW1zKTtcbiAgICAgICAgICAgIF90aGlzLmxvZ18oJ0Nvbm5lY3RpbmcgdmlhIGxvbmctcG9sbCB0byAnICsgY29ubmVjdFVSTCk7XG4gICAgICAgICAgICBfdGhpcy5zY3JpcHRUYWdIb2xkZXIuYWRkVGFnKGNvbm5lY3RVUkwsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAvKiBkbyBub3RoaW5nICovXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBDYWxsIHRoaXMgd2hlbiBhIGhhbmRzaGFrZSBoYXMgY29tcGxldGVkIHN1Y2Nlc3NmdWxseSBhbmQgd2Ugd2FudCB0byBjb25zaWRlciB0aGUgY29ubmVjdGlvbiBlc3RhYmxpc2hlZFxuICAgICAqL1xuICAgIEJyb3dzZXJQb2xsQ29ubmVjdGlvbi5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc2NyaXB0VGFnSG9sZGVyLnN0YXJ0TG9uZ1BvbGwodGhpcy5pZCwgdGhpcy5wYXNzd29yZCk7XG4gICAgICAgIHRoaXMuYWRkRGlzY29ubmVjdFBpbmdGcmFtZSh0aGlzLmlkLCB0aGlzLnBhc3N3b3JkKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEZvcmNlcyBsb25nIHBvbGxpbmcgdG8gYmUgY29uc2lkZXJlZCBhcyBhIHBvdGVudGlhbCB0cmFuc3BvcnRcbiAgICAgKi9cbiAgICBCcm93c2VyUG9sbENvbm5lY3Rpb24uZm9yY2VBbGxvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgQnJvd3NlclBvbGxDb25uZWN0aW9uLmZvcmNlQWxsb3dfID0gdHJ1ZTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEZvcmNlcyBsb25ncG9sbGluZyB0byBub3QgYmUgY29uc2lkZXJlZCBhcyBhIHBvdGVudGlhbCB0cmFuc3BvcnRcbiAgICAgKi9cbiAgICBCcm93c2VyUG9sbENvbm5lY3Rpb24uZm9yY2VEaXNhbGxvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgQnJvd3NlclBvbGxDb25uZWN0aW9uLmZvcmNlRGlzYWxsb3dfID0gdHJ1ZTtcbiAgICB9O1xuICAgIC8vIFN0YXRpYyBtZXRob2QsIHVzZSBzdHJpbmcgbGl0ZXJhbCBzbyBpdCBjYW4gYmUgYWNjZXNzZWQgaW4gYSBnZW5lcmljIHdheVxuICAgIEJyb3dzZXJQb2xsQ29ubmVjdGlvbi5pc0F2YWlsYWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gTk9URTogSW4gUmVhY3QtTmF0aXZlIHRoZXJlJ3Mgbm9ybWFsbHkgbm8gJ2RvY3VtZW50JywgYnV0IGlmIHlvdSBkZWJ1ZyBhIFJlYWN0LU5hdGl2ZSBhcHAgaW5cbiAgICAgICAgLy8gdGhlIENocm9tZSBkZWJ1Z2dlciwgJ2RvY3VtZW50JyBpcyBkZWZpbmVkLCBidXQgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCBpcyBudWxsICgyMDE1LzA2LzA4KS5cbiAgICAgICAgcmV0dXJuIChCcm93c2VyUG9sbENvbm5lY3Rpb24uZm9yY2VBbGxvd18gfHxcbiAgICAgICAgICAgICghQnJvd3NlclBvbGxDb25uZWN0aW9uLmZvcmNlRGlzYWxsb3dfICYmXG4gICAgICAgICAgICAgICAgdHlwZW9mIGRvY3VtZW50ICE9PSAndW5kZWZpbmVkJyAmJlxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQgIT0gbnVsbCAmJlxuICAgICAgICAgICAgICAgICF1dGlsXzEuaXNDaHJvbWVFeHRlbnNpb25Db250ZW50U2NyaXB0KCkgJiZcbiAgICAgICAgICAgICAgICAhdXRpbF8xLmlzV2luZG93c1N0b3JlQXBwKCkgJiZcbiAgICAgICAgICAgICAgICAhdXRpbF8zLmlzTm9kZVNkaygpKSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBOby1vcCBmb3IgcG9sbGluZ1xuICAgICAqL1xuICAgIEJyb3dzZXJQb2xsQ29ubmVjdGlvbi5wcm90b3R5cGUubWFya0Nvbm5lY3Rpb25IZWFsdGh5ID0gZnVuY3Rpb24gKCkgeyB9O1xuICAgIC8qKlxuICAgICAqIFN0b3BzIHBvbGxpbmcgYW5kIGNsZWFucyB1cCB0aGUgaWZyYW1lXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBCcm93c2VyUG9sbENvbm5lY3Rpb24ucHJvdG90eXBlLnNodXRkb3duXyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5pc0Nsb3NlZF8gPSB0cnVlO1xuICAgICAgICBpZiAodGhpcy5zY3JpcHRUYWdIb2xkZXIpIHtcbiAgICAgICAgICAgIHRoaXMuc2NyaXB0VGFnSG9sZGVyLmNsb3NlKCk7XG4gICAgICAgICAgICB0aGlzLnNjcmlwdFRhZ0hvbGRlciA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgLy9yZW1vdmUgdGhlIGRpc2Nvbm5lY3QgZnJhbWUsIHdoaWNoIHdpbGwgdHJpZ2dlciBhbiBYSFIgY2FsbCB0byB0aGUgc2VydmVyIHRvIHRlbGwgaXQgd2UncmUgbGVhdmluZy5cbiAgICAgICAgaWYgKHRoaXMubXlEaXNjb25uRnJhbWUpIHtcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQodGhpcy5teURpc2Nvbm5GcmFtZSk7XG4gICAgICAgICAgICB0aGlzLm15RGlzY29ubkZyYW1lID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jb25uZWN0VGltZW91dFRpbWVyXykge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuY29ubmVjdFRpbWVvdXRUaW1lcl8pO1xuICAgICAgICAgICAgdGhpcy5jb25uZWN0VGltZW91dFRpbWVyXyA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFRyaWdnZXJlZCB3aGVuIHRoaXMgdHJhbnNwb3J0IGlzIGNsb3NlZFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgQnJvd3NlclBvbGxDb25uZWN0aW9uLnByb3RvdHlwZS5vbkNsb3NlZF8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5pc0Nsb3NlZF8pIHtcbiAgICAgICAgICAgIHRoaXMubG9nXygnTG9uZ3BvbGwgaXMgY2xvc2luZyBpdHNlbGYnKTtcbiAgICAgICAgICAgIHRoaXMuc2h1dGRvd25fKCk7XG4gICAgICAgICAgICBpZiAodGhpcy5vbkRpc2Nvbm5lY3RfKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkRpc2Nvbm5lY3RfKHRoaXMuZXZlckNvbm5lY3RlZF8pO1xuICAgICAgICAgICAgICAgIHRoaXMub25EaXNjb25uZWN0XyA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEV4dGVybmFsLWZhY2luZyBjbG9zZSBoYW5kbGVyLiBSZWFsVGltZSBoYXMgcmVxdWVzdGVkIHdlIHNodXQgZG93bi4gS2lsbCBvdXIgY29ubmVjdGlvbiBhbmQgdGVsbCB0aGUgc2VydmVyXG4gICAgICogdGhhdCB3ZSd2ZSBsZWZ0LlxuICAgICAqL1xuICAgIEJyb3dzZXJQb2xsQ29ubmVjdGlvbi5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5pc0Nsb3NlZF8pIHtcbiAgICAgICAgICAgIHRoaXMubG9nXygnTG9uZ3BvbGwgaXMgYmVpbmcgY2xvc2VkLicpO1xuICAgICAgICAgICAgdGhpcy5zaHV0ZG93bl8oKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogU2VuZCB0aGUgSlNPTiBvYmplY3QgZG93biB0byB0aGUgc2VydmVyLiBJdCB3aWxsIG5lZWQgdG8gYmUgc3RyaW5naWZpZWQsIGJhc2U2NCBlbmNvZGVkLCBhbmQgdGhlblxuICAgICAqIGJyb2tlbiBpbnRvIGNodW5rcyAoc2luY2UgVVJMcyBoYXZlIGEgc21hbGwgbWF4aW11bSBsZW5ndGgpLlxuICAgICAqIEBwYXJhbSB7IU9iamVjdH0gZGF0YSBUaGUgSlNPTiBkYXRhIHRvIHRyYW5zbWl0LlxuICAgICAqL1xuICAgIEJyb3dzZXJQb2xsQ29ubmVjdGlvbi5wcm90b3R5cGUuc2VuZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHZhciBkYXRhU3RyID0gdXRpbF8yLnN0cmluZ2lmeShkYXRhKTtcbiAgICAgICAgdGhpcy5ieXRlc1NlbnQgKz0gZGF0YVN0ci5sZW5ndGg7XG4gICAgICAgIHRoaXMuc3RhdHNfLmluY3JlbWVudENvdW50ZXIoJ2J5dGVzX3NlbnQnLCBkYXRhU3RyLmxlbmd0aCk7XG4gICAgICAgIC8vZmlyc3QsIGxldHMgZ2V0IHRoZSBiYXNlNjQtZW5jb2RlZCBkYXRhXG4gICAgICAgIHZhciBiYXNlNjRkYXRhID0gdXRpbF8yLmJhc2U2NEVuY29kZShkYXRhU3RyKTtcbiAgICAgICAgLy9XZSBjYW4gb25seSBmaXQgYSBjZXJ0YWluIGFtb3VudCBpbiBlYWNoIFVSTCwgc28gd2UgbmVlZCB0byBzcGxpdCB0aGlzIHJlcXVlc3RcbiAgICAgICAgLy91cCBpbnRvIG11bHRpcGxlIHBpZWNlcyBpZiBpdCBkb2Vzbid0IGZpdCBpbiBvbmUgcmVxdWVzdC5cbiAgICAgICAgdmFyIGRhdGFTZWdzID0gdXRpbF8xLnNwbGl0U3RyaW5nQnlTaXplKGJhc2U2NGRhdGEsIE1BWF9QQVlMT0FEX1NJWkUpO1xuICAgICAgICAvL0VucXVldWUgZWFjaCBzZWdtZW50IGZvciB0cmFuc21pc3Npb24uIFdlIGFzc2lnbiBlYWNoIGNodW5rIGEgc2VxdWVudGlhbCBJRCBhbmQgYSB0b3RhbCBudW1iZXJcbiAgICAgICAgLy9vZiBzZWdtZW50cyBzbyB0aGF0IHdlIGNhbiByZWFzc2VtYmxlIHRoZSBwYWNrZXQgb24gdGhlIHNlcnZlci5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhU2Vncy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5zY3JpcHRUYWdIb2xkZXIuZW5xdWV1ZVNlZ21lbnQodGhpcy5jdXJTZWdtZW50TnVtLCBkYXRhU2Vncy5sZW5ndGgsIGRhdGFTZWdzW2ldKTtcbiAgICAgICAgICAgIHRoaXMuY3VyU2VnbWVudE51bSsrO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBUaGlzIGlzIGhvdyB3ZSBub3RpZnkgdGhlIHNlcnZlciB0aGF0IHdlJ3JlIGxlYXZpbmcuXG4gICAgICogV2UgYXJlbid0IGFibGUgdG8gc2VuZCByZXF1ZXN0cyB3aXRoIERIVE1MIG9uIGEgd2luZG93IGNsb3NlIGV2ZW50LCBidXQgd2UgY2FuXG4gICAgICogdHJpZ2dlciBYSFIgcmVxdWVzdHMgaW4gc29tZSBicm93c2VycyAoZXZlcnl0aGluZyBidXQgT3BlcmEgYmFzaWNhbGx5KS5cbiAgICAgKiBAcGFyYW0geyFzdHJpbmd9IGlkXG4gICAgICogQHBhcmFtIHshc3RyaW5nfSBwd1xuICAgICAqL1xuICAgIEJyb3dzZXJQb2xsQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkRGlzY29ubmVjdFBpbmdGcmFtZSA9IGZ1bmN0aW9uIChpZCwgcHcpIHtcbiAgICAgICAgaWYgKHV0aWxfMy5pc05vZGVTZGsoKSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy5teURpc2Nvbm5GcmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lmcmFtZScpO1xuICAgICAgICB2YXIgdXJsUGFyYW1zID0ge307XG4gICAgICAgIHVybFBhcmFtc1tleHBvcnRzLkZJUkVCQVNFX0xPTkdQT0xMX0RJU0NPTk5fRlJBTUVfUkVRVUVTVF9QQVJBTV0gPSAndCc7XG4gICAgICAgIHVybFBhcmFtc1tleHBvcnRzLkZJUkVCQVNFX0xPTkdQT0xMX0lEX1BBUkFNXSA9IGlkO1xuICAgICAgICB1cmxQYXJhbXNbZXhwb3J0cy5GSVJFQkFTRV9MT05HUE9MTF9QV19QQVJBTV0gPSBwdztcbiAgICAgICAgdGhpcy5teURpc2Nvbm5GcmFtZS5zcmMgPSB0aGlzLnVybEZuKHVybFBhcmFtcyk7XG4gICAgICAgIHRoaXMubXlEaXNjb25uRnJhbWUuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLm15RGlzY29ubkZyYW1lKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFVzZWQgdG8gdHJhY2sgdGhlIGJ5dGVzIHJlY2VpdmVkIGJ5IHRoaXMgY2xpZW50XG4gICAgICogQHBhcmFtIHsqfSBhcmdzXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBCcm93c2VyUG9sbENvbm5lY3Rpb24ucHJvdG90eXBlLmluY3JlbWVudEluY29taW5nQnl0ZXNfID0gZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgLy8gVE9ETzogVGhpcyBpcyBhbiBhbm5veWluZyBwZXJmIGhpdCBqdXN0IHRvIHRyYWNrIHRoZSBudW1iZXIgb2YgaW5jb21pbmcgYnl0ZXMuICBNYXliZSBpdCBzaG91bGQgYmUgb3B0LWluLlxuICAgICAgICB2YXIgYnl0ZXNSZWNlaXZlZCA9IHV0aWxfMi5zdHJpbmdpZnkoYXJncykubGVuZ3RoO1xuICAgICAgICB0aGlzLmJ5dGVzUmVjZWl2ZWQgKz0gYnl0ZXNSZWNlaXZlZDtcbiAgICAgICAgdGhpcy5zdGF0c18uaW5jcmVtZW50Q291bnRlcignYnl0ZXNfcmVjZWl2ZWQnLCBieXRlc1JlY2VpdmVkKTtcbiAgICB9O1xuICAgIHJldHVybiBCcm93c2VyUG9sbENvbm5lY3Rpb247XG59KCkpO1xuZXhwb3J0cy5Ccm93c2VyUG9sbENvbm5lY3Rpb24gPSBCcm93c2VyUG9sbENvbm5lY3Rpb247XG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gKiBBIHdyYXBwZXIgYXJvdW5kIGFuIGlmcmFtZSB0aGF0IGlzIHVzZWQgYXMgYSBsb25nLXBvbGxpbmcgc2NyaXB0IGhvbGRlci5cbiAqIEBjb25zdHJ1Y3RvclxuICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbnZhciBGaXJlYmFzZUlGcmFtZVNjcmlwdEhvbGRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0gY29tbWFuZENCIC0gVGhlIGNhbGxiYWNrIHRvIGJlIGNhbGxlZCB3aGVuIGNvbnRyb2wgY29tbWFuZHMgYXJlIHJlY2V2aWVkIGZyb20gdGhlIHNlcnZlci5cbiAgICAgKiBAcGFyYW0gb25NZXNzYWdlQ0IgLSBUaGUgY2FsbGJhY2sgdG8gYmUgdHJpZ2dlcmVkIHdoZW4gcmVzcG9uc2VzIGFycml2ZSBmcm9tIHRoZSBzZXJ2ZXIuXG4gICAgICogQHBhcmFtIG9uRGlzY29ubmVjdCAtIFRoZSBjYWxsYmFjayB0byBiZSB0cmlnZ2VyZWQgd2hlbiB0aGlzIHRhZyBob2xkZXIgaXMgY2xvc2VkXG4gICAgICogQHBhcmFtIHVybEZuIC0gQSBmdW5jdGlvbiB0aGF0IHByb3ZpZGVzIHRoZSBVUkwgb2YgdGhlIGVuZHBvaW50IHRvIHNlbmQgZGF0YSB0by5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBGaXJlYmFzZUlGcmFtZVNjcmlwdEhvbGRlcihjb21tYW5kQ0IsIG9uTWVzc2FnZUNCLCBvbkRpc2Nvbm5lY3QsIHVybEZuKSB7XG4gICAgICAgIHRoaXMub25EaXNjb25uZWN0ID0gb25EaXNjb25uZWN0O1xuICAgICAgICB0aGlzLnVybEZuID0gdXJsRm47XG4gICAgICAgIC8vV2UgbWFpbnRhaW4gYSBjb3VudCBvZiBhbGwgb2YgdGhlIG91dHN0YW5kaW5nIHJlcXVlc3RzLCBiZWNhdXNlIGlmIHdlIGhhdmUgdG9vIG1hbnkgYWN0aXZlIGF0IG9uY2UgaXQgY2FuIGNhdXNlXG4gICAgICAgIC8vcHJvYmxlbXMgaW4gc29tZSBicm93c2Vycy5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEB0eXBlIHtDb3VudGVkU2V0LjxudW1iZXIsIG51bWJlcj59XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm91dHN0YW5kaW5nUmVxdWVzdHMgPSBuZXcgQ291bnRlZFNldF8xLkNvdW50ZWRTZXQoKTtcbiAgICAgICAgLy9BIHF1ZXVlIG9mIHRoZSBwZW5kaW5nIHNlZ21lbnRzIHdhaXRpbmcgZm9yIHRyYW5zbWlzc2lvbiB0byB0aGUgc2VydmVyLlxuICAgICAgICB0aGlzLnBlbmRpbmdTZWdzID0gW107XG4gICAgICAgIC8vQSBzZXJpYWwgbnVtYmVyLiBXZSB1c2UgdGhpcyBmb3IgdHdvIHRoaW5nczpcbiAgICAgICAgLy8gMSkgQSB3YXkgdG8gZW5zdXJlIHRoZSBicm93c2VyIGRvZXNuJ3QgY2FjaGUgcmVzcG9uc2VzIHRvIHBvbGxzXG4gICAgICAgIC8vIDIpIEEgd2F5IHRvIG1ha2UgdGhlIHNlcnZlciBhd2FyZSB3aGVuIGxvbmctcG9sbHMgYXJyaXZlIGluIGEgZGlmZmVyZW50IG9yZGVyIHRoYW4gd2Ugc3RhcnRlZCB0aGVtLiBUaGVcbiAgICAgICAgLy8gICAgc2VydmVyIG5lZWRzIHRvIHJlbGVhc2UgYm90aCBwb2xscyBpbiB0aGlzIGNhc2Ugb3IgaXQgd2lsbCBjYXVzZSBwcm9ibGVtcyBpbiBPcGVyYSBzaW5jZSBPcGVyYSBjYW4gb25seSBleGVjdXRlXG4gICAgICAgIC8vICAgIEpTT05QIGNvZGUgaW4gdGhlIG9yZGVyIGl0IHdhcyBhZGRlZCB0byB0aGUgaWZyYW1lLlxuICAgICAgICB0aGlzLmN1cnJlbnRTZXJpYWwgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwMDAwMDApO1xuICAgICAgICAvLyBUaGlzIGdldHMgc2V0IHRvIGZhbHNlIHdoZW4gd2UncmUgXCJjbG9zaW5nIGRvd25cIiB0aGUgY29ubmVjdGlvbiAoZS5nLiB3ZSdyZSBzd2l0Y2hpbmcgdHJhbnNwb3J0cyBidXQgdGhlcmUncyBzdGlsbFxuICAgICAgICAvLyBpbmNvbWluZyBkYXRhIGZyb20gdGhlIHNlcnZlciB0aGF0IHdlJ3JlIHdhaXRpbmcgZm9yKS5cbiAgICAgICAgdGhpcy5zZW5kTmV3UG9sbHMgPSB0cnVlO1xuICAgICAgICBpZiAoIXV0aWxfMy5pc05vZGVTZGsoKSkge1xuICAgICAgICAgICAgLy9FYWNoIHNjcmlwdCBob2xkZXIgcmVnaXN0ZXJzIGEgY291cGxlIG9mIHVuaXF1ZWx5IG5hbWVkIGNhbGxiYWNrcyB3aXRoIHRoZSB3aW5kb3cuIFRoZXNlIGFyZSBjYWxsZWQgZnJvbSB0aGVcbiAgICAgICAgICAgIC8vaWZyYW1lcyB3aGVyZSB3ZSBwdXQgdGhlIGxvbmctcG9sbGluZyBzY3JpcHQgdGFncy4gV2UgaGF2ZSB0d28gY2FsbGJhY2tzOlxuICAgICAgICAgICAgLy8gICAxKSBDb21tYW5kIENhbGxiYWNrIC0gVHJpZ2dlcmVkIGZvciBjb250cm9sIGlzc3VlcywgbGlrZSBzdGFydGluZyBhIGNvbm5lY3Rpb24uXG4gICAgICAgICAgICAvLyAgIDIpIE1lc3NhZ2UgQ2FsbGJhY2sgLSBUcmlnZ2VyZWQgd2hlbiBuZXcgZGF0YSBhcnJpdmVzLlxuICAgICAgICAgICAgdGhpcy51bmlxdWVDYWxsYmFja0lkZW50aWZpZXIgPSB1dGlsXzEuTFVJREdlbmVyYXRvcigpO1xuICAgICAgICAgICAgd2luZG93W2V4cG9ydHMuRklSRUJBU0VfTE9OR1BPTExfQ09NTUFORF9DQl9OQU1FICsgdGhpcy51bmlxdWVDYWxsYmFja0lkZW50aWZpZXJdID0gY29tbWFuZENCO1xuICAgICAgICAgICAgd2luZG93W2V4cG9ydHMuRklSRUJBU0VfTE9OR1BPTExfREFUQV9DQl9OQU1FICsgdGhpcy51bmlxdWVDYWxsYmFja0lkZW50aWZpZXJdID0gb25NZXNzYWdlQ0I7XG4gICAgICAgICAgICAvL0NyZWF0ZSBhbiBpZnJhbWUgZm9yIHVzIHRvIGFkZCBzY3JpcHQgdGFncyB0by5cbiAgICAgICAgICAgIHRoaXMubXlJRnJhbWUgPSBGaXJlYmFzZUlGcmFtZVNjcmlwdEhvbGRlci5jcmVhdGVJRnJhbWVfKCk7XG4gICAgICAgICAgICAvLyBTZXQgdGhlIGlmcmFtZSdzIGNvbnRlbnRzLlxuICAgICAgICAgICAgdmFyIHNjcmlwdCA9ICcnO1xuICAgICAgICAgICAgLy8gaWYgd2Ugc2V0IGEgamF2YXNjcmlwdCB1cmwsIGl0J3MgSUUgYW5kIHdlIG5lZWQgdG8gc2V0IHRoZSBkb2N1bWVudCBkb21haW4uIFRoZSBqYXZhc2NyaXB0IHVybCBpcyBzdWZmaWNpZW50XG4gICAgICAgICAgICAvLyBmb3IgaWU5LCBidXQgaWU4IG5lZWRzIHRvIGRvIGl0IGFnYWluIGluIHRoZSBkb2N1bWVudCBpdHNlbGYuXG4gICAgICAgICAgICBpZiAodGhpcy5teUlGcmFtZS5zcmMgJiZcbiAgICAgICAgICAgICAgICB0aGlzLm15SUZyYW1lLnNyYy5zdWJzdHIoMCwgJ2phdmFzY3JpcHQ6Jy5sZW5ndGgpID09PSAnamF2YXNjcmlwdDonKSB7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnREb21haW4gPSBkb2N1bWVudC5kb21haW47XG4gICAgICAgICAgICAgICAgc2NyaXB0ID0gJzxzY3JpcHQ+ZG9jdW1lbnQuZG9tYWluPVwiJyArIGN1cnJlbnREb21haW4gKyAnXCI7PC9zY3JpcHQ+JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBpZnJhbWVDb250ZW50cyA9ICc8aHRtbD48Ym9keT4nICsgc2NyaXB0ICsgJzwvYm9keT48L2h0bWw+JztcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5teUlGcmFtZS5kb2Mub3BlbigpO1xuICAgICAgICAgICAgICAgIHRoaXMubXlJRnJhbWUuZG9jLndyaXRlKGlmcmFtZUNvbnRlbnRzKTtcbiAgICAgICAgICAgICAgICB0aGlzLm15SUZyYW1lLmRvYy5jbG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICB1dGlsXzEubG9nKCdmcmFtZSB3cml0aW5nIGV4Y2VwdGlvbicpO1xuICAgICAgICAgICAgICAgIGlmIChlLnN0YWNrKSB7XG4gICAgICAgICAgICAgICAgICAgIHV0aWxfMS5sb2coZS5zdGFjayk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHV0aWxfMS5sb2coZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmNvbW1hbmRDQiA9IGNvbW1hbmRDQjtcbiAgICAgICAgICAgIHRoaXMub25NZXNzYWdlQ0IgPSBvbk1lc3NhZ2VDQjtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBFYWNoIGJyb3dzZXIgaGFzIGl0cyBvd24gZnVubnkgd2F5IHRvIGhhbmRsZSBpZnJhbWVzLiBIZXJlIHdlIG11c2ggdGhlbSBhbGwgdG9nZXRoZXIgaW50byBvbmUgb2JqZWN0IHRoYXQgSSBjYW5cbiAgICAgKiBhY3R1YWxseSB1c2UuXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcmV0dXJuIHtFbGVtZW50fVxuICAgICAqL1xuICAgIEZpcmViYXNlSUZyYW1lU2NyaXB0SG9sZGVyLmNyZWF0ZUlGcmFtZV8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBpZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTtcbiAgICAgICAgaWZyYW1lLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgIC8vIFRoaXMgaXMgbmVjZXNzYXJ5IGluIG9yZGVyIHRvIGluaXRpYWxpemUgdGhlIGRvY3VtZW50IGluc2lkZSB0aGUgaWZyYW1lXG4gICAgICAgIGlmIChkb2N1bWVudC5ib2R5KSB7XG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGlmcmFtZSk7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIElmIGRvY3VtZW50LmRvbWFpbiBoYXMgYmVlbiBtb2RpZmllZCBpbiBJRSwgdGhpcyB3aWxsIHRocm93IGFuIGVycm9yLCBhbmQgd2UgbmVlZCB0byBzZXQgdGhlXG4gICAgICAgICAgICAgICAgLy8gZG9tYWluIG9mIHRoZSBpZnJhbWUncyBkb2N1bWVudCBtYW51YWxseS4gV2UgY2FuIGRvIHRoaXMgdmlhIGEgamF2YXNjcmlwdDogdXJsIGFzIHRoZSBzcmMgYXR0cmlidXRlXG4gICAgICAgICAgICAgICAgLy8gQWxzbyBub3RlIHRoYXQgd2UgbXVzdCBkbyB0aGlzICphZnRlciogdGhlIGlmcmFtZSBoYXMgYmVlbiBhcHBlbmRlZCB0byB0aGUgcGFnZS4gT3RoZXJ3aXNlIGl0IGRvZXNuJ3Qgd29yay5cbiAgICAgICAgICAgICAgICB2YXIgYSA9IGlmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50O1xuICAgICAgICAgICAgICAgIGlmICghYSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBBcG9sb2dpZXMgZm9yIHRoZSBsb2ctc3BhbSwgSSBuZWVkIHRvIGRvIHNvbWV0aGluZyB0byBrZWVwIGNsb3N1cmUgZnJvbSBvcHRpbWl6aW5nIG91dCB0aGUgYXNzaWdubWVudCBhYm92ZS5cbiAgICAgICAgICAgICAgICAgICAgdXRpbF8xLmxvZygnTm8gSUUgZG9tYWluIHNldHRpbmcgcmVxdWlyZWQnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIHZhciBkb21haW4gPSBkb2N1bWVudC5kb21haW47XG4gICAgICAgICAgICAgICAgaWZyYW1lLnNyYyA9XG4gICAgICAgICAgICAgICAgICAgIFwiamF2YXNjcmlwdDp2b2lkKChmdW5jdGlvbigpe2RvY3VtZW50Lm9wZW4oKTtkb2N1bWVudC5kb21haW49J1wiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvbWFpbiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIic7ZG9jdW1lbnQuY2xvc2UoKTt9KSgpKVwiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gTG9uZ1BvbGxDb25uZWN0aW9uIGF0dGVtcHRzIHRvIGRlbGF5IGluaXRpYWxpemF0aW9uIHVudGlsIHRoZSBkb2N1bWVudCBpcyByZWFkeSwgc28gaG9wZWZ1bGx5IHRoaXNcbiAgICAgICAgICAgIC8vIG5ldmVyIGdldHMgaGl0LlxuICAgICAgICAgICAgdGhyb3cgJ0RvY3VtZW50IGJvZHkgaGFzIG5vdCBpbml0aWFsaXplZC4gV2FpdCB0byBpbml0aWFsaXplIEZpcmViYXNlIHVudGlsIGFmdGVyIHRoZSBkb2N1bWVudCBpcyByZWFkeS4nO1xuICAgICAgICB9XG4gICAgICAgIC8vIEdldCB0aGUgZG9jdW1lbnQgb2YgdGhlIGlmcmFtZSBpbiBhIGJyb3dzZXItc3BlY2lmaWMgd2F5LlxuICAgICAgICBpZiAoaWZyYW1lLmNvbnRlbnREb2N1bWVudCkge1xuICAgICAgICAgICAgaWZyYW1lLmRvYyA9IGlmcmFtZS5jb250ZW50RG9jdW1lbnQ7IC8vIEZpcmVmb3gsIE9wZXJhLCBTYWZhcmlcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpZnJhbWUuY29udGVudFdpbmRvdykge1xuICAgICAgICAgICAgaWZyYW1lLmRvYyA9IGlmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50OyAvLyBJbnRlcm5ldCBFeHBsb3JlclxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGlmcmFtZS5kb2N1bWVudCkge1xuICAgICAgICAgICAgaWZyYW1lLmRvYyA9IGlmcmFtZS5kb2N1bWVudDsgLy9vdGhlcnM/XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGlmcmFtZTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIENhbmNlbCBhbGwgb3V0c3RhbmRpbmcgcXVlcmllcyBhbmQgcmVtb3ZlIHRoZSBmcmFtZS5cbiAgICAgKi9cbiAgICBGaXJlYmFzZUlGcmFtZVNjcmlwdEhvbGRlci5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIC8vTWFyayB0aGlzIGlmcmFtZSBhcyBkZWFkLCBzbyBubyBuZXcgcmVxdWVzdHMgYXJlIHNlbnQuXG4gICAgICAgIHRoaXMuYWxpdmUgPSBmYWxzZTtcbiAgICAgICAgaWYgKHRoaXMubXlJRnJhbWUpIHtcbiAgICAgICAgICAgIC8vV2UgaGF2ZSB0byBhY3R1YWxseSByZW1vdmUgYWxsIG9mIHRoZSBodG1sIGluc2lkZSB0aGlzIGlmcmFtZSBiZWZvcmUgcmVtb3ZpbmcgaXQgZnJvbSB0aGVcbiAgICAgICAgICAgIC8vd2luZG93LCBvciBJRSB3aWxsIGNvbnRpbnVlIGxvYWRpbmcgYW5kIGV4ZWN1dGluZyB0aGUgc2NyaXB0IHRhZ3Mgd2UndmUgYWxyZWFkeSBhZGRlZCwgd2hpY2hcbiAgICAgICAgICAgIC8vY2FuIGxlYWQgdG8gc29tZSBlcnJvcnMgYmVpbmcgdGhyb3duLiBTZXR0aW5nIGlubmVySFRNTCBzZWVtcyB0byBiZSB0aGUgZWFzaWVzdCB3YXkgdG8gZG8gdGhpcy5cbiAgICAgICAgICAgIHRoaXMubXlJRnJhbWUuZG9jLmJvZHkuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMubXlJRnJhbWUgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChfdGhpcy5teUlGcmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLm15SUZyYW1lID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCBNYXRoLmZsb29yKDApKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodXRpbF8zLmlzTm9kZVNkaygpICYmIHRoaXMubXlJRCkge1xuICAgICAgICAgICAgdmFyIHVybFBhcmFtcyA9IHt9O1xuICAgICAgICAgICAgdXJsUGFyYW1zW2V4cG9ydHMuRklSRUJBU0VfTE9OR1BPTExfRElTQ09OTl9GUkFNRV9QQVJBTV0gPSAndCc7XG4gICAgICAgICAgICB1cmxQYXJhbXNbZXhwb3J0cy5GSVJFQkFTRV9MT05HUE9MTF9JRF9QQVJBTV0gPSB0aGlzLm15SUQ7XG4gICAgICAgICAgICB1cmxQYXJhbXNbZXhwb3J0cy5GSVJFQkFTRV9MT05HUE9MTF9QV19QQVJBTV0gPSB0aGlzLm15UFc7XG4gICAgICAgICAgICB2YXIgdGhlVVJMID0gdGhpcy51cmxGbih1cmxQYXJhbXMpO1xuICAgICAgICAgICAgRmlyZWJhc2VJRnJhbWVTY3JpcHRIb2xkZXIubm9kZVJlc3RSZXF1ZXN0KHRoZVVSTCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gUHJvdGVjdCBmcm9tIGJlaW5nIGNhbGxlZCByZWN1cnNpdmVseS5cbiAgICAgICAgdmFyIG9uRGlzY29ubmVjdCA9IHRoaXMub25EaXNjb25uZWN0O1xuICAgICAgICBpZiAob25EaXNjb25uZWN0KSB7XG4gICAgICAgICAgICB0aGlzLm9uRGlzY29ubmVjdCA9IG51bGw7XG4gICAgICAgICAgICBvbkRpc2Nvbm5lY3QoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQWN0dWFsbHkgc3RhcnQgdGhlIGxvbmctcG9sbGluZyBzZXNzaW9uIGJ5IGFkZGluZyB0aGUgZmlyc3Qgc2NyaXB0IHRhZyhzKSB0byB0aGUgaWZyYW1lLlxuICAgICAqIEBwYXJhbSB7IXN0cmluZ30gaWQgLSBUaGUgSUQgb2YgdGhpcyBjb25uZWN0aW9uXG4gICAgICogQHBhcmFtIHshc3RyaW5nfSBwdyAtIFRoZSBwYXNzd29yZCBmb3IgdGhpcyBjb25uZWN0aW9uXG4gICAgICovXG4gICAgRmlyZWJhc2VJRnJhbWVTY3JpcHRIb2xkZXIucHJvdG90eXBlLnN0YXJ0TG9uZ1BvbGwgPSBmdW5jdGlvbiAoaWQsIHB3KSB7XG4gICAgICAgIHRoaXMubXlJRCA9IGlkO1xuICAgICAgICB0aGlzLm15UFcgPSBwdztcbiAgICAgICAgdGhpcy5hbGl2ZSA9IHRydWU7XG4gICAgICAgIC8vc2VuZCB0aGUgaW5pdGlhbCByZXF1ZXN0LiBJZiB0aGVyZSBhcmUgcmVxdWVzdHMgcXVldWVkLCBtYWtlIHN1cmUgdGhhdCB3ZSB0cmFuc21pdCBhcyBtYW55IGFzIHdlIGFyZSBjdXJyZW50bHkgYWJsZSB0by5cbiAgICAgICAgd2hpbGUgKHRoaXMubmV3UmVxdWVzdF8oKSkgeyB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBUaGlzIGlzIGNhbGxlZCBhbnkgdGltZSBzb21lb25lIG1pZ2h0IHdhbnQgYSBzY3JpcHQgdGFnIHRvIGJlIGFkZGVkLiBJdCBhZGRzIGEgc2NyaXB0IHRhZyB3aGVuIHRoZXJlIGFyZW4ndFxuICAgICAqIHRvbyBtYW55IG91dHN0YW5kaW5nIHJlcXVlc3RzIGFuZCB3ZSBhcmUgc3RpbGwgYWxpdmUuXG4gICAgICpcbiAgICAgKiBJZiB0aGVyZSBhcmUgb3V0c3RhbmRpbmcgcGFja2V0IHNlZ21lbnRzIHRvIHNlbmQsIGl0IHNlbmRzIG9uZS4gSWYgdGhlcmUgYXJlbid0LCBpdCBzZW5kcyBhIGxvbmctcG9sbCBhbnl3YXlzIGlmXG4gICAgICogbmVlZGVkLlxuICAgICAqL1xuICAgIEZpcmViYXNlSUZyYW1lU2NyaXB0SG9sZGVyLnByb3RvdHlwZS5uZXdSZXF1ZXN0XyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gV2Uga2VlcCBvbmUgb3V0c3RhbmRpbmcgcmVxdWVzdCBvcGVuIGFsbCB0aGUgdGltZSB0byByZWNlaXZlIGRhdGEsIGJ1dCBpZiB3ZSBuZWVkIHRvIHNlbmQgZGF0YVxuICAgICAgICAvLyAocGVuZGluZ1NlZ3MubGVuZ3RoID4gMCkgdGhlbiB3ZSBjcmVhdGUgYSBuZXcgcmVxdWVzdCB0byBzZW5kIHRoZSBkYXRhLiAgVGhlIHNlcnZlciB3aWxsIGF1dG9tYXRpY2FsbHlcbiAgICAgICAgLy8gY2xvc2UgdGhlIG9sZCByZXF1ZXN0LlxuICAgICAgICBpZiAodGhpcy5hbGl2ZSAmJlxuICAgICAgICAgICAgdGhpcy5zZW5kTmV3UG9sbHMgJiZcbiAgICAgICAgICAgIHRoaXMub3V0c3RhbmRpbmdSZXF1ZXN0cy5jb3VudCgpIDwgKHRoaXMucGVuZGluZ1NlZ3MubGVuZ3RoID4gMCA/IDIgOiAxKSkge1xuICAgICAgICAgICAgLy9jb25zdHJ1Y3Qgb3VyIHVybFxuICAgICAgICAgICAgdGhpcy5jdXJyZW50U2VyaWFsKys7XG4gICAgICAgICAgICB2YXIgdXJsUGFyYW1zID0ge307XG4gICAgICAgICAgICB1cmxQYXJhbXNbZXhwb3J0cy5GSVJFQkFTRV9MT05HUE9MTF9JRF9QQVJBTV0gPSB0aGlzLm15SUQ7XG4gICAgICAgICAgICB1cmxQYXJhbXNbZXhwb3J0cy5GSVJFQkFTRV9MT05HUE9MTF9QV19QQVJBTV0gPSB0aGlzLm15UFc7XG4gICAgICAgICAgICB1cmxQYXJhbXNbZXhwb3J0cy5GSVJFQkFTRV9MT05HUE9MTF9TRVJJQUxfUEFSQU1dID0gdGhpcy5jdXJyZW50U2VyaWFsO1xuICAgICAgICAgICAgdmFyIHRoZVVSTCA9IHRoaXMudXJsRm4odXJsUGFyYW1zKTtcbiAgICAgICAgICAgIC8vTm93IGFkZCBhcyBtdWNoIGRhdGEgYXMgd2UgY2FuLlxuICAgICAgICAgICAgdmFyIGN1ckRhdGFTdHJpbmcgPSAnJztcbiAgICAgICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgICAgIHdoaWxlICh0aGlzLnBlbmRpbmdTZWdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAvL2ZpcnN0LCBsZXRzIHNlZSBpZiB0aGUgbmV4dCBzZWdtZW50IHdpbGwgZml0LlxuICAgICAgICAgICAgICAgIHZhciBuZXh0U2VnID0gdGhpcy5wZW5kaW5nU2Vnc1swXTtcbiAgICAgICAgICAgICAgICBpZiAobmV4dFNlZy5kLmxlbmd0aCArIFNFR19IRUFERVJfU0laRSArIGN1ckRhdGFTdHJpbmcubGVuZ3RoIDw9XG4gICAgICAgICAgICAgICAgICAgIE1BWF9VUkxfREFUQV9TSVpFKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vZ3JlYXQsIHRoZSBzZWdtZW50IHdpbGwgZml0LiBMZXRzIGFwcGVuZCBpdC5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHRoZVNlZyA9IHRoaXMucGVuZGluZ1NlZ3Muc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgY3VyRGF0YVN0cmluZyA9XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJEYXRhU3RyaW5nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnJicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cG9ydHMuRklSRUJBU0VfTE9OR1BPTExfU0VHTUVOVF9OVU1fUEFSQU0gK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICc9JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlU2VnLnNlZyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJyYnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBvcnRzLkZJUkVCQVNFX0xPTkdQT0xMX1NFR01FTlRTX0lOX1BBQ0tFVCArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJz0nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGVTZWcudHMgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICcmJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3J0cy5GSVJFQkFTRV9MT05HUE9MTF9EQVRBX1BBUkFNICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPScgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZVNlZy5kO1xuICAgICAgICAgICAgICAgICAgICBpKys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGVVUkwgPSB0aGVVUkwgKyBjdXJEYXRhU3RyaW5nO1xuICAgICAgICAgICAgdGhpcy5hZGRMb25nUG9sbFRhZ18odGhlVVJMLCB0aGlzLmN1cnJlbnRTZXJpYWwpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFF1ZXVlIGEgcGFja2V0IGZvciB0cmFuc21pc3Npb24gdG8gdGhlIHNlcnZlci5cbiAgICAgKiBAcGFyYW0gc2VnbnVtIC0gQSBzZXF1ZW50aWFsIGlkIGZvciB0aGlzIHBhY2tldCBzZWdtZW50IHVzZWQgZm9yIHJlYXNzZW1ibHlcbiAgICAgKiBAcGFyYW0gdG90YWxzZWdzIC0gVGhlIHRvdGFsIG51bWJlciBvZiBzZWdtZW50cyBpbiB0aGlzIHBhY2tldFxuICAgICAqIEBwYXJhbSBkYXRhIC0gVGhlIGRhdGEgZm9yIHRoaXMgc2VnbWVudC5cbiAgICAgKi9cbiAgICBGaXJlYmFzZUlGcmFtZVNjcmlwdEhvbGRlci5wcm90b3R5cGUuZW5xdWV1ZVNlZ21lbnQgPSBmdW5jdGlvbiAoc2VnbnVtLCB0b3RhbHNlZ3MsIGRhdGEpIHtcbiAgICAgICAgLy9hZGQgdGhpcyB0byB0aGUgcXVldWUgb2Ygc2VnbWVudHMgdG8gc2VuZC5cbiAgICAgICAgdGhpcy5wZW5kaW5nU2Vncy5wdXNoKHsgc2VnOiBzZWdudW0sIHRzOiB0b3RhbHNlZ3MsIGQ6IGRhdGEgfSk7XG4gICAgICAgIC8vc2VuZCB0aGUgZGF0YSBpbW1lZGlhdGVseSBpZiB0aGVyZSBpc24ndCBhbHJlYWR5IGRhdGEgYmVpbmcgdHJhbnNtaXR0ZWQsIHVubGVzc1xuICAgICAgICAvL3N0YXJ0TG9uZ1BvbGwgaGFzbid0IGJlZW4gY2FsbGVkIHlldC5cbiAgICAgICAgaWYgKHRoaXMuYWxpdmUpIHtcbiAgICAgICAgICAgIHRoaXMubmV3UmVxdWVzdF8oKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQWRkIGEgc2NyaXB0IHRhZyBmb3IgYSByZWd1bGFyIGxvbmctcG9sbCByZXF1ZXN0LlxuICAgICAqIEBwYXJhbSB7IXN0cmluZ30gdXJsIC0gVGhlIFVSTCBvZiB0aGUgc2NyaXB0IHRhZy5cbiAgICAgKiBAcGFyYW0geyFudW1iZXJ9IHNlcmlhbCAtIFRoZSBzZXJpYWwgbnVtYmVyIG9mIHRoZSByZXF1ZXN0LlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgRmlyZWJhc2VJRnJhbWVTY3JpcHRIb2xkZXIucHJvdG90eXBlLmFkZExvbmdQb2xsVGFnXyA9IGZ1bmN0aW9uICh1cmwsIHNlcmlhbCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAvL3JlbWVtYmVyIHRoYXQgd2Ugc2VudCB0aGlzIHJlcXVlc3QuXG4gICAgICAgIHRoaXMub3V0c3RhbmRpbmdSZXF1ZXN0cy5hZGQoc2VyaWFsLCAxKTtcbiAgICAgICAgdmFyIGRvTmV3UmVxdWVzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF90aGlzLm91dHN0YW5kaW5nUmVxdWVzdHMucmVtb3ZlKHNlcmlhbCk7XG4gICAgICAgICAgICBfdGhpcy5uZXdSZXF1ZXN0XygpO1xuICAgICAgICB9O1xuICAgICAgICAvLyBJZiB0aGlzIHJlcXVlc3QgZG9lc24ndCByZXR1cm4gb24gaXRzIG93biBhY2NvcmQgKGJ5IHRoZSBzZXJ2ZXIgc2VuZGluZyB1cyBzb21lIGRhdGEpLCB3ZSdsbFxuICAgICAgICAvLyBjcmVhdGUgYSBuZXcgb25lIGFmdGVyIHRoZSBLRUVQQUxJVkUgaW50ZXJ2YWwgdG8gbWFrZSBzdXJlIHdlIGFsd2F5cyBrZWVwIGEgZnJlc2ggcmVxdWVzdCBvcGVuLlxuICAgICAgICB2YXIga2VlcGFsaXZlVGltZW91dCA9IHNldFRpbWVvdXQoZG9OZXdSZXF1ZXN0LCBNYXRoLmZsb29yKEtFRVBBTElWRV9SRVFVRVNUX0lOVEVSVkFMKSk7XG4gICAgICAgIHZhciByZWFkeVN0YXRlQ0IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvLyBSZXF1ZXN0IGNvbXBsZXRlZC4gIENhbmNlbCB0aGUga2VlcGFsaXZlLlxuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KGtlZXBhbGl2ZVRpbWVvdXQpO1xuICAgICAgICAgICAgLy8gVHJpZ2dlciBhIG5ldyByZXF1ZXN0IHNvIHdlIGNhbiBjb250aW51ZSByZWNlaXZpbmcgZGF0YS5cbiAgICAgICAgICAgIGRvTmV3UmVxdWVzdCgpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmFkZFRhZyh1cmwsIHJlYWR5U3RhdGVDQik7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBBZGQgYW4gYXJiaXRyYXJ5IHNjcmlwdCB0YWcgdG8gdGhlIGlmcmFtZS5cbiAgICAgKiBAcGFyYW0geyFzdHJpbmd9IHVybCAtIFRoZSBVUkwgZm9yIHRoZSBzY3JpcHQgdGFnIHNvdXJjZS5cbiAgICAgKiBAcGFyYW0geyFmdW5jdGlvbigpfSBsb2FkQ0IgLSBBIGNhbGxiYWNrIHRvIGJlIHRyaWdnZXJlZCBvbmNlIHRoZSBzY3JpcHQgaGFzIGxvYWRlZC5cbiAgICAgKi9cbiAgICBGaXJlYmFzZUlGcmFtZVNjcmlwdEhvbGRlci5wcm90b3R5cGUuYWRkVGFnID0gZnVuY3Rpb24gKHVybCwgbG9hZENCKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh1dGlsXzMuaXNOb2RlU2RrKCkpIHtcbiAgICAgICAgICAgIHRoaXMuZG9Ob2RlTG9uZ1BvbGwodXJsLCBsb2FkQ0IpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgd2UncmUgYWxyZWFkeSBjbG9zZWQsIGRvbid0IGFkZCB0aGlzIHBvbGxcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFfdGhpcy5zZW5kTmV3UG9sbHMpXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdTY3JpcHRfMSA9IF90aGlzLm15SUZyYW1lLmRvYy5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcbiAgICAgICAgICAgICAgICAgICAgbmV3U2NyaXB0XzEudHlwZSA9ICd0ZXh0L2phdmFzY3JpcHQnO1xuICAgICAgICAgICAgICAgICAgICBuZXdTY3JpcHRfMS5hc3luYyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG5ld1NjcmlwdF8xLnNyYyA9IHVybDtcbiAgICAgICAgICAgICAgICAgICAgbmV3U2NyaXB0XzEub25sb2FkID0gbmV3U2NyaXB0XzEub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJzdGF0ZSA9IG5ld1NjcmlwdF8xLnJlYWR5U3RhdGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJzdGF0ZSB8fCByc3RhdGUgPT09ICdsb2FkZWQnIHx8IHJzdGF0ZSA9PT0gJ2NvbXBsZXRlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1NjcmlwdF8xLm9ubG9hZCA9IG5ld1NjcmlwdF8xLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5ld1NjcmlwdF8xLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3U2NyaXB0XzEucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChuZXdTY3JpcHRfMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRDQigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBuZXdTY3JpcHRfMS5vbmVycm9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXRpbF8xLmxvZygnTG9uZy1wb2xsIHNjcmlwdCBmYWlsZWQgdG8gbG9hZDogJyArIHVybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZW5kTmV3UG9sbHMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLm15SUZyYW1lLmRvYy5ib2R5LmFwcGVuZENoaWxkKG5ld1NjcmlwdF8xKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVE9ETzogd2Ugc2hvdWxkIG1ha2UgdGhpcyBlcnJvciB2aXNpYmxlIHNvbWVob3dcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCBNYXRoLmZsb29yKDEpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIEZpcmViYXNlSUZyYW1lU2NyaXB0SG9sZGVyO1xufSgpKTtcbmV4cG9ydHMuRmlyZWJhc2VJRnJhbWVTY3JpcHRIb2xkZXIgPSBGaXJlYmFzZUlGcmFtZVNjcmlwdEhvbGRlcjtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9QnJvd3NlclBvbGxDb25uZWN0aW9uLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHV0aWxfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3V0aWwvdXRpbFwiKTtcbnZhciBzdG9yYWdlXzEgPSByZXF1aXJlKFwiLi4vY29yZS9zdG9yYWdlL3N0b3JhZ2VcIik7XG52YXIgQ29uc3RhbnRzXzEgPSByZXF1aXJlKFwiLi9Db25zdGFudHNcIik7XG52YXIgVHJhbnNwb3J0TWFuYWdlcl8xID0gcmVxdWlyZShcIi4vVHJhbnNwb3J0TWFuYWdlclwiKTtcbi8vIEFib3J0IHVwZ3JhZGUgYXR0ZW1wdCBpZiBpdCB0YWtlcyBsb25nZXIgdGhhbiA2MHMuXG52YXIgVVBHUkFERV9USU1FT1VUID0gNjAwMDA7XG4vLyBGb3Igc29tZSB0cmFuc3BvcnRzIChXZWJTb2NrZXRzKSwgd2UgbmVlZCB0byBcInZhbGlkYXRlXCIgdGhlIHRyYW5zcG9ydCBieSBleGNoYW5naW5nIGEgZmV3IHJlcXVlc3RzIGFuZCByZXNwb25zZXMuXG4vLyBJZiB3ZSBoYXZlbid0IHNlbnQgZW5vdWdoIHJlcXVlc3RzIHdpdGhpbiA1cywgd2UnbGwgc3RhcnQgc2VuZGluZyBub29wIHBpbmcgcmVxdWVzdHMuXG52YXIgREVMQVlfQkVGT1JFX1NFTkRJTkdfRVhUUkFfUkVRVUVTVFMgPSA1MDAwO1xuLy8gSWYgdGhlIGluaXRpYWwgZGF0YSBzZW50IHRyaWdnZXJzIGEgbG90IG9mIGJhbmR3aWR0aCAoaS5lLiBpdCdzIGEgbGFyZ2UgcHV0IG9yIGEgbGlzdGVuIGZvciBhIGxhcmdlIGFtb3VudCBvZiBkYXRhKVxuLy8gdGhlbiB3ZSBtYXkgbm90IGJlIGFibGUgdG8gZXhjaGFuZ2Ugb3VyIHBpbmcvcG9uZyByZXF1ZXN0cyB3aXRoaW4gdGhlIGhlYWx0aHkgdGltZW91dC4gIFNvIGlmIHdlIHJlYWNoIHRoZSB0aW1lb3V0XG4vLyBidXQgd2UndmUgc2VudC9yZWNlaXZlZCBlbm91Z2ggYnl0ZXMsIHdlIGRvbid0IGNhbmNlbCB0aGUgY29ubmVjdGlvbi5cbnZhciBCWVRFU19TRU5UX0hFQUxUSFlfT1ZFUlJJREUgPSAxMCAqIDEwMjQ7XG52YXIgQllURVNfUkVDRUlWRURfSEVBTFRIWV9PVkVSUklERSA9IDEwMCAqIDEwMjQ7XG52YXIgTUVTU0FHRV9UWVBFID0gJ3QnO1xudmFyIE1FU1NBR0VfREFUQSA9ICdkJztcbnZhciBDT05UUk9MX1NIVVRET1dOID0gJ3MnO1xudmFyIENPTlRST0xfUkVTRVQgPSAncic7XG52YXIgQ09OVFJPTF9FUlJPUiA9ICdlJztcbnZhciBDT05UUk9MX1BPTkcgPSAnbyc7XG52YXIgU1dJVENIX0FDSyA9ICdhJztcbnZhciBFTkRfVFJBTlNNSVNTSU9OID0gJ24nO1xudmFyIFBJTkcgPSAncCc7XG52YXIgU0VSVkVSX0hFTExPID0gJ2gnO1xuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IHJlYWwtdGltZSBjb25uZWN0aW9uIHRvIHRoZSBzZXJ2ZXIgdXNpbmcgd2hpY2hldmVyIG1ldGhvZCB3b3Jrc1xuICogYmVzdCBpbiB0aGUgY3VycmVudCBicm93c2VyLlxuICpcbiAqIEBjb25zdHJ1Y3RvclxuICovXG52YXIgQ29ubmVjdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0geyFzdHJpbmd9IGlkIC0gYW4gaWQgZm9yIHRoaXMgY29ubmVjdGlvblxuICAgICAqIEBwYXJhbSB7IVJlcG9JbmZvfSByZXBvSW5mb18gLSB0aGUgaW5mbyBmb3IgdGhlIGVuZHBvaW50IHRvIGNvbm5lY3QgdG9cbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKE9iamVjdCl9IG9uTWVzc2FnZV8gLSB0aGUgY2FsbGJhY2sgdG8gYmUgdHJpZ2dlcmVkIHdoZW4gYSBzZXJ2ZXItcHVzaCBtZXNzYWdlIGFycml2ZXNcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKG51bWJlciwgc3RyaW5nKX0gb25SZWFkeV8gLSB0aGUgY2FsbGJhY2sgdG8gYmUgdHJpZ2dlcmVkIHdoZW4gdGhpcyBjb25uZWN0aW9uIGlzIHJlYWR5IHRvIHNlbmQgbWVzc2FnZXMuXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbigpfSBvbkRpc2Nvbm5lY3RfIC0gdGhlIGNhbGxiYWNrIHRvIGJlIHRyaWdnZXJlZCB3aGVuIGEgY29ubmVjdGlvbiB3YXMgbG9zdFxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oc3RyaW5nKX0gb25LaWxsXyAtIHRoZSBjYWxsYmFjayB0byBiZSB0cmlnZ2VyZWQgd2hlbiB0aGlzIGNvbm5lY3Rpb24gaGFzIHBlcm1hbmVudGx5IHNodXQgZG93bi5cbiAgICAgKiBAcGFyYW0ge3N0cmluZz19IGxhc3RTZXNzaW9uSWQgLSBsYXN0IHNlc3Npb24gaWQgaW4gcGVyc2lzdGVudCBjb25uZWN0aW9uLiBpcyB1c2VkIHRvIGNsZWFuIHVwIG9sZCBzZXNzaW9uIGluIHJlYWwtdGltZSBzZXJ2ZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBDb25uZWN0aW9uKGlkLCByZXBvSW5mb18sIG9uTWVzc2FnZV8sIG9uUmVhZHlfLCBvbkRpc2Nvbm5lY3RfLCBvbktpbGxfLCBsYXN0U2Vzc2lvbklkKSB7XG4gICAgICAgIHRoaXMuaWQgPSBpZDtcbiAgICAgICAgdGhpcy5yZXBvSW5mb18gPSByZXBvSW5mb187XG4gICAgICAgIHRoaXMub25NZXNzYWdlXyA9IG9uTWVzc2FnZV87XG4gICAgICAgIHRoaXMub25SZWFkeV8gPSBvblJlYWR5XztcbiAgICAgICAgdGhpcy5vbkRpc2Nvbm5lY3RfID0gb25EaXNjb25uZWN0XztcbiAgICAgICAgdGhpcy5vbktpbGxfID0gb25LaWxsXztcbiAgICAgICAgdGhpcy5sYXN0U2Vzc2lvbklkID0gbGFzdFNlc3Npb25JZDtcbiAgICAgICAgdGhpcy5jb25uZWN0aW9uQ291bnQgPSAwO1xuICAgICAgICB0aGlzLnBlbmRpbmdEYXRhTWVzc2FnZXMgPSBbXTtcbiAgICAgICAgdGhpcy5zdGF0ZV8gPSAwIC8qIENPTk5FQ1RJTkcgKi87XG4gICAgICAgIHRoaXMubG9nXyA9IHV0aWxfMS5sb2dXcmFwcGVyKCdjOicgKyB0aGlzLmlkICsgJzonKTtcbiAgICAgICAgdGhpcy50cmFuc3BvcnRNYW5hZ2VyXyA9IG5ldyBUcmFuc3BvcnRNYW5hZ2VyXzEuVHJhbnNwb3J0TWFuYWdlcihyZXBvSW5mb18pO1xuICAgICAgICB0aGlzLmxvZ18oJ0Nvbm5lY3Rpb24gY3JlYXRlZCcpO1xuICAgICAgICB0aGlzLnN0YXJ0XygpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdGFydHMgYSBjb25uZWN0aW9uIGF0dGVtcHRcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIENvbm5lY3Rpb24ucHJvdG90eXBlLnN0YXJ0XyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGNvbm4gPSB0aGlzLnRyYW5zcG9ydE1hbmFnZXJfLmluaXRpYWxUcmFuc3BvcnQoKTtcbiAgICAgICAgdGhpcy5jb25uXyA9IG5ldyBjb25uKHRoaXMubmV4dFRyYW5zcG9ydElkXygpLCB0aGlzLnJlcG9JbmZvXywgdW5kZWZpbmVkLCB0aGlzLmxhc3RTZXNzaW9uSWQpO1xuICAgICAgICAvLyBGb3IgY2VydGFpbiB0cmFuc3BvcnRzIChXZWJTb2NrZXRzKSwgd2UgbmVlZCB0byBzZW5kIGFuZCByZWNlaXZlIHNldmVyYWwgbWVzc2FnZXMgYmFjayBhbmQgZm9ydGggYmVmb3JlIHdlXG4gICAgICAgIC8vIGNhbiBjb25zaWRlciB0aGUgdHJhbnNwb3J0IGhlYWx0aHkuXG4gICAgICAgIHRoaXMucHJpbWFyeVJlc3BvbnNlc1JlcXVpcmVkXyA9IGNvbm5bJ3Jlc3BvbnNlc1JlcXVpcmVkVG9CZUhlYWx0aHknXSB8fCAwO1xuICAgICAgICB2YXIgb25NZXNzYWdlUmVjZWl2ZWQgPSB0aGlzLmNvbm5SZWNlaXZlcl8odGhpcy5jb25uXyk7XG4gICAgICAgIHZhciBvbkNvbm5lY3Rpb25Mb3N0ID0gdGhpcy5kaXNjb25uUmVjZWl2ZXJfKHRoaXMuY29ubl8pO1xuICAgICAgICB0aGlzLnR4XyA9IHRoaXMuY29ubl87XG4gICAgICAgIHRoaXMucnhfID0gdGhpcy5jb25uXztcbiAgICAgICAgdGhpcy5zZWNvbmRhcnlDb25uXyA9IG51bGw7XG4gICAgICAgIHRoaXMuaXNIZWFsdGh5XyA9IGZhbHNlO1xuICAgICAgICAvKlxuICAgICAgICAgKiBGaXJlZm94IGRvZXNuJ3QgbGlrZSB3aGVuIGNvZGUgZnJvbSBvbmUgaWZyYW1lIHRyaWVzIHRvIGNyZWF0ZSBhbm90aGVyIGlmcmFtZSBieSB3YXkgb2YgdGhlIHBhcmVudCBmcmFtZS5cbiAgICAgICAgICogVGhpcyBjYW4gb2NjdXIgaW4gdGhlIGNhc2Ugb2YgYSByZWRpcmVjdCwgaS5lLiB3ZSBndWVzc2VkIHdyb25nIG9uIHdoYXQgc2VydmVyIHRvIGNvbm5lY3QgdG8gYW5kIHJlY2VpdmVkIGEgcmVzZXQuXG4gICAgICAgICAqIFNvbWVob3csIHNldFRpbWVvdXQgc2VlbXMgdG8gbWFrZSB0aGlzIG9rLiBUaGF0IGRvZXNuJ3QgbWFrZSBzZW5zZSBmcm9tIGEgc2VjdXJpdHkgcGVyc3BlY3RpdmUsIHNpbmNlIHlvdSBzaG91bGRcbiAgICAgICAgICogc3RpbGwgaGF2ZSB0aGUgY29udGV4dCBvZiB5b3VyIG9yaWdpbmF0aW5nIGZyYW1lLlxuICAgICAgICAgKi9cbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvLyB0aGlzLmNvbm5fIGdldHMgc2V0IHRvIG51bGwgaW4gc29tZSBvZiB0aGUgdGVzdHMuIENoZWNrIHRvIG1ha2Ugc3VyZSBpdCBzdGlsbCBleGlzdHMgYmVmb3JlIHVzaW5nIGl0XG4gICAgICAgICAgICBfdGhpcy5jb25uXyAmJiBfdGhpcy5jb25uXy5vcGVuKG9uTWVzc2FnZVJlY2VpdmVkLCBvbkNvbm5lY3Rpb25Mb3N0KTtcbiAgICAgICAgfSwgTWF0aC5mbG9vcigwKSk7XG4gICAgICAgIHZhciBoZWFsdGh5VGltZW91dF9tcyA9IGNvbm5bJ2hlYWx0aHlUaW1lb3V0J10gfHwgMDtcbiAgICAgICAgaWYgKGhlYWx0aHlUaW1lb3V0X21zID4gMCkge1xuICAgICAgICAgICAgdGhpcy5oZWFsdGh5VGltZW91dF8gPSB1dGlsXzEuc2V0VGltZW91dE5vbkJsb2NraW5nKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5oZWFsdGh5VGltZW91dF8gPSBudWxsO1xuICAgICAgICAgICAgICAgIGlmICghX3RoaXMuaXNIZWFsdGh5Xykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuY29ubl8gJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmNvbm5fLmJ5dGVzUmVjZWl2ZWQgPiBCWVRFU19SRUNFSVZFRF9IRUFMVEhZX09WRVJSSURFKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5sb2dfKCdDb25uZWN0aW9uIGV4Y2VlZGVkIGhlYWx0aHkgdGltZW91dCBidXQgaGFzIHJlY2VpdmVkICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmNvbm5fLmJ5dGVzUmVjZWl2ZWQgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICcgYnl0ZXMuICBNYXJraW5nIGNvbm5lY3Rpb24gaGVhbHRoeS4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmlzSGVhbHRoeV8gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuY29ubl8ubWFya0Nvbm5lY3Rpb25IZWFsdGh5KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoX3RoaXMuY29ubl8gJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmNvbm5fLmJ5dGVzU2VudCA+IEJZVEVTX1NFTlRfSEVBTFRIWV9PVkVSUklERSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMubG9nXygnQ29ubmVjdGlvbiBleGNlZWRlZCBoZWFsdGh5IHRpbWVvdXQgYnV0IGhhcyBzZW50ICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmNvbm5fLmJ5dGVzU2VudCArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJyBieXRlcy4gIExlYXZpbmcgY29ubmVjdGlvbiBhbGl2ZS4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5PVEU6IFdlIGRvbid0IHdhbnQgdG8gbWFyayBpdCBoZWFsdGh5LCBzaW5jZSB3ZSBoYXZlIG5vIGd1YXJhbnRlZSB0aGF0IHRoZSBieXRlcyBoYXZlIG1hZGUgaXQgdG9cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBzZXJ2ZXIuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5sb2dfKCdDbG9zaW5nIHVuaGVhbHRoeSBjb25uZWN0aW9uIGFmdGVyIHRpbWVvdXQuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgTWF0aC5mbG9vcihoZWFsdGh5VGltZW91dF9tcykpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHshc3RyaW5nfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgQ29ubmVjdGlvbi5wcm90b3R5cGUubmV4dFRyYW5zcG9ydElkXyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICdjOicgKyB0aGlzLmlkICsgJzonICsgdGhpcy5jb25uZWN0aW9uQ291bnQrKztcbiAgICB9O1xuICAgIENvbm5lY3Rpb24ucHJvdG90eXBlLmRpc2Nvbm5SZWNlaXZlcl8gPSBmdW5jdGlvbiAoY29ubikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGV2ZXJDb25uZWN0ZWQpIHtcbiAgICAgICAgICAgIGlmIChjb25uID09PSBfdGhpcy5jb25uXykge1xuICAgICAgICAgICAgICAgIF90aGlzLm9uQ29ubmVjdGlvbkxvc3RfKGV2ZXJDb25uZWN0ZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY29ubiA9PT0gX3RoaXMuc2Vjb25kYXJ5Q29ubl8pIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5sb2dfKCdTZWNvbmRhcnkgY29ubmVjdGlvbiBsb3N0LicpO1xuICAgICAgICAgICAgICAgIF90aGlzLm9uU2Vjb25kYXJ5Q29ubmVjdGlvbkxvc3RfKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5sb2dfKCdjbG9zaW5nIGFuIG9sZCBjb25uZWN0aW9uJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBDb25uZWN0aW9uLnByb3RvdHlwZS5jb25uUmVjZWl2ZXJfID0gZnVuY3Rpb24gKGNvbm4pIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgICAgICBpZiAoX3RoaXMuc3RhdGVfICE9IDIgLyogRElTQ09OTkVDVEVEICovKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbm4gPT09IF90aGlzLnJ4Xykge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5vblByaW1hcnlNZXNzYWdlUmVjZWl2ZWRfKG1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChjb25uID09PSBfdGhpcy5zZWNvbmRhcnlDb25uXykge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5vblNlY29uZGFyeU1lc3NhZ2VSZWNlaXZlZF8obWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5sb2dfKCdtZXNzYWdlIG9uIG9sZCBjb25uZWN0aW9uJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH07XG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YU1zZyBBbiBhcmJpdHJhcnkgZGF0YSBtZXNzYWdlIHRvIGJlIHNlbnQgdG8gdGhlIHNlcnZlclxuICAgICAqL1xuICAgIENvbm5lY3Rpb24ucHJvdG90eXBlLnNlbmRSZXF1ZXN0ID0gZnVuY3Rpb24gKGRhdGFNc2cpIHtcbiAgICAgICAgLy8gd3JhcCBpbiBhIGRhdGEgbWVzc2FnZSBlbnZlbG9wZSBhbmQgc2VuZCBpdCBvblxuICAgICAgICB2YXIgbXNnID0geyB0OiAnZCcsIGQ6IGRhdGFNc2cgfTtcbiAgICAgICAgdGhpcy5zZW5kRGF0YV8obXNnKTtcbiAgICB9O1xuICAgIENvbm5lY3Rpb24ucHJvdG90eXBlLnRyeUNsZWFudXBDb25uZWN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy50eF8gPT09IHRoaXMuc2Vjb25kYXJ5Q29ubl8gJiYgdGhpcy5yeF8gPT09IHRoaXMuc2Vjb25kYXJ5Q29ubl8pIHtcbiAgICAgICAgICAgIHRoaXMubG9nXygnY2xlYW5pbmcgdXAgYW5kIHByb21vdGluZyBhIGNvbm5lY3Rpb246ICcgKyB0aGlzLnNlY29uZGFyeUNvbm5fLmNvbm5JZCk7XG4gICAgICAgICAgICB0aGlzLmNvbm5fID0gdGhpcy5zZWNvbmRhcnlDb25uXztcbiAgICAgICAgICAgIHRoaXMuc2Vjb25kYXJ5Q29ubl8gPSBudWxsO1xuICAgICAgICAgICAgLy8gdGhlIHNlcnZlciB3aWxsIHNodXRkb3duIHRoZSBvbGQgY29ubmVjdGlvblxuICAgICAgICB9XG4gICAgfTtcbiAgICBDb25uZWN0aW9uLnByb3RvdHlwZS5vblNlY29uZGFyeUNvbnRyb2xfID0gZnVuY3Rpb24gKGNvbnRyb2xEYXRhKSB7XG4gICAgICAgIGlmIChNRVNTQUdFX1RZUEUgaW4gY29udHJvbERhdGEpIHtcbiAgICAgICAgICAgIHZhciBjbWQgPSBjb250cm9sRGF0YVtNRVNTQUdFX1RZUEVdO1xuICAgICAgICAgICAgaWYgKGNtZCA9PT0gU1dJVENIX0FDSykge1xuICAgICAgICAgICAgICAgIHRoaXMudXBncmFkZUlmU2Vjb25kYXJ5SGVhbHRoeV8oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGNtZCA9PT0gQ09OVFJPTF9SRVNFVCkge1xuICAgICAgICAgICAgICAgIC8vIE1vc3QgbGlrZWx5IHRoZSBzZXNzaW9uIHdhc24ndCB2YWxpZC4gQWJhbmRvbiB0aGUgc3dpdGNoIGF0dGVtcHRcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ18oJ0dvdCBhIHJlc2V0IG9uIHNlY29uZGFyeSwgY2xvc2luZyBpdCcpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2Vjb25kYXJ5Q29ubl8uY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAvLyBJZiB3ZSB3ZXJlIGFscmVhZHkgdXNpbmcgdGhpcyBjb25uZWN0aW9uIGZvciBzb21ldGhpbmcsIHRoYW4gd2UgbmVlZCB0byBmdWxseSBjbG9zZVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnR4XyA9PT0gdGhpcy5zZWNvbmRhcnlDb25uXyB8fFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJ4XyA9PT0gdGhpcy5zZWNvbmRhcnlDb25uXykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY21kID09PSBDT05UUk9MX1BPTkcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ18oJ2dvdCBwb25nIG9uIHNlY29uZGFyeS4nKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNlY29uZGFyeVJlc3BvbnNlc1JlcXVpcmVkXy0tO1xuICAgICAgICAgICAgICAgIHRoaXMudXBncmFkZUlmU2Vjb25kYXJ5SGVhbHRoeV8oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgQ29ubmVjdGlvbi5wcm90b3R5cGUub25TZWNvbmRhcnlNZXNzYWdlUmVjZWl2ZWRfID0gZnVuY3Rpb24gKHBhcnNlZERhdGEpIHtcbiAgICAgICAgdmFyIGxheWVyID0gdXRpbF8xLnJlcXVpcmVLZXkoJ3QnLCBwYXJzZWREYXRhKTtcbiAgICAgICAgdmFyIGRhdGEgPSB1dGlsXzEucmVxdWlyZUtleSgnZCcsIHBhcnNlZERhdGEpO1xuICAgICAgICBpZiAobGF5ZXIgPT0gJ2MnKSB7XG4gICAgICAgICAgICB0aGlzLm9uU2Vjb25kYXJ5Q29udHJvbF8oZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAobGF5ZXIgPT0gJ2QnKSB7XG4gICAgICAgICAgICAvLyBnb3QgYSBkYXRhIG1lc3NhZ2UsIGJ1dCB3ZSdyZSBzdGlsbCBzZWNvbmQgY29ubmVjdGlvbi4gTmVlZCB0byBidWZmZXIgaXQgdXBcbiAgICAgICAgICAgIHRoaXMucGVuZGluZ0RhdGFNZXNzYWdlcy5wdXNoKGRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbmtub3duIHByb3RvY29sIGxheWVyOiAnICsgbGF5ZXIpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDb25uZWN0aW9uLnByb3RvdHlwZS51cGdyYWRlSWZTZWNvbmRhcnlIZWFsdGh5XyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuc2Vjb25kYXJ5UmVzcG9uc2VzUmVxdWlyZWRfIDw9IDApIHtcbiAgICAgICAgICAgIHRoaXMubG9nXygnU2Vjb25kYXJ5IGNvbm5lY3Rpb24gaXMgaGVhbHRoeS4nKTtcbiAgICAgICAgICAgIHRoaXMuaXNIZWFsdGh5XyA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLnNlY29uZGFyeUNvbm5fLm1hcmtDb25uZWN0aW9uSGVhbHRoeSgpO1xuICAgICAgICAgICAgdGhpcy5wcm9jZWVkV2l0aFVwZ3JhZGVfKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBTZW5kIGEgcGluZyB0byBtYWtlIHN1cmUgdGhlIGNvbm5lY3Rpb24gaXMgaGVhbHRoeS5cbiAgICAgICAgICAgIHRoaXMubG9nXygnc2VuZGluZyBwaW5nIG9uIHNlY29uZGFyeS4nKTtcbiAgICAgICAgICAgIHRoaXMuc2Vjb25kYXJ5Q29ubl8uc2VuZCh7IHQ6ICdjJywgZDogeyB0OiBQSU5HLCBkOiB7fSB9IH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDb25uZWN0aW9uLnByb3RvdHlwZS5wcm9jZWVkV2l0aFVwZ3JhZGVfID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyB0ZWxsIHRoaXMgY29ubmVjdGlvbiB0byBjb25zaWRlciBpdHNlbGYgb3BlblxuICAgICAgICB0aGlzLnNlY29uZGFyeUNvbm5fLnN0YXJ0KCk7XG4gICAgICAgIC8vIHNlbmQgYWNrXG4gICAgICAgIHRoaXMubG9nXygnc2VuZGluZyBjbGllbnQgYWNrIG9uIHNlY29uZGFyeScpO1xuICAgICAgICB0aGlzLnNlY29uZGFyeUNvbm5fLnNlbmQoeyB0OiAnYycsIGQ6IHsgdDogU1dJVENIX0FDSywgZDoge30gfSB9KTtcbiAgICAgICAgLy8gc2VuZCBlbmQgcGFja2V0IG9uIHByaW1hcnkgdHJhbnNwb3J0LCBzd2l0Y2ggdG8gc2VuZGluZyBvbiB0aGlzIG9uZVxuICAgICAgICAvLyBjYW4gcmVjZWl2ZSBvbiB0aGlzIG9uZSwgYnVmZmVyIHJlc3BvbnNlcyB1bnRpbCBlbmQgcmVjZWl2ZWQgb24gcHJpbWFyeSB0cmFuc3BvcnRcbiAgICAgICAgdGhpcy5sb2dfKCdFbmRpbmcgdHJhbnNtaXNzaW9uIG9uIHByaW1hcnknKTtcbiAgICAgICAgdGhpcy5jb25uXy5zZW5kKHsgdDogJ2MnLCBkOiB7IHQ6IEVORF9UUkFOU01JU1NJT04sIGQ6IHt9IH0gfSk7XG4gICAgICAgIHRoaXMudHhfID0gdGhpcy5zZWNvbmRhcnlDb25uXztcbiAgICAgICAgdGhpcy50cnlDbGVhbnVwQ29ubmVjdGlvbigpO1xuICAgIH07XG4gICAgQ29ubmVjdGlvbi5wcm90b3R5cGUub25QcmltYXJ5TWVzc2FnZVJlY2VpdmVkXyA9IGZ1bmN0aW9uIChwYXJzZWREYXRhKSB7XG4gICAgICAgIC8vIE11c3QgcmVmZXIgdG8gcGFyc2VkRGF0YSBwcm9wZXJ0aWVzIGluIHF1b3Rlcywgc28gY2xvc3VyZSBkb2Vzbid0IHRvdWNoIHRoZW0uXG4gICAgICAgIHZhciBsYXllciA9IHV0aWxfMS5yZXF1aXJlS2V5KCd0JywgcGFyc2VkRGF0YSk7XG4gICAgICAgIHZhciBkYXRhID0gdXRpbF8xLnJlcXVpcmVLZXkoJ2QnLCBwYXJzZWREYXRhKTtcbiAgICAgICAgaWYgKGxheWVyID09ICdjJykge1xuICAgICAgICAgICAgdGhpcy5vbkNvbnRyb2xfKGRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGxheWVyID09ICdkJykge1xuICAgICAgICAgICAgdGhpcy5vbkRhdGFNZXNzYWdlXyhkYXRhKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ29ubmVjdGlvbi5wcm90b3R5cGUub25EYXRhTWVzc2FnZV8gPSBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgICAgICB0aGlzLm9uUHJpbWFyeVJlc3BvbnNlXygpO1xuICAgICAgICAvLyBXZSBkb24ndCBkbyBhbnl0aGluZyB3aXRoIGRhdGEgbWVzc2FnZXMsIGp1c3Qga2ljayB0aGVtIHVwIGEgbGV2ZWxcbiAgICAgICAgdGhpcy5vbk1lc3NhZ2VfKG1lc3NhZ2UpO1xuICAgIH07XG4gICAgQ29ubmVjdGlvbi5wcm90b3R5cGUub25QcmltYXJ5UmVzcG9uc2VfID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuaXNIZWFsdGh5Xykge1xuICAgICAgICAgICAgdGhpcy5wcmltYXJ5UmVzcG9uc2VzUmVxdWlyZWRfLS07XG4gICAgICAgICAgICBpZiAodGhpcy5wcmltYXJ5UmVzcG9uc2VzUmVxdWlyZWRfIDw9IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ18oJ1ByaW1hcnkgY29ubmVjdGlvbiBpcyBoZWFsdGh5LicpO1xuICAgICAgICAgICAgICAgIHRoaXMuaXNIZWFsdGh5XyA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5jb25uXy5tYXJrQ29ubmVjdGlvbkhlYWx0aHkoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgQ29ubmVjdGlvbi5wcm90b3R5cGUub25Db250cm9sXyA9IGZ1bmN0aW9uIChjb250cm9sRGF0YSkge1xuICAgICAgICB2YXIgY21kID0gdXRpbF8xLnJlcXVpcmVLZXkoTUVTU0FHRV9UWVBFLCBjb250cm9sRGF0YSk7XG4gICAgICAgIGlmIChNRVNTQUdFX0RBVEEgaW4gY29udHJvbERhdGEpIHtcbiAgICAgICAgICAgIHZhciBwYXlsb2FkID0gY29udHJvbERhdGFbTUVTU0FHRV9EQVRBXTtcbiAgICAgICAgICAgIGlmIChjbWQgPT09IFNFUlZFUl9IRUxMTykge1xuICAgICAgICAgICAgICAgIHRoaXMub25IYW5kc2hha2VfKHBheWxvYWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY21kID09PSBFTkRfVFJBTlNNSVNTSU9OKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2dfKCdyZWN2ZCBlbmQgdHJhbnNtaXNzaW9uIG9uIHByaW1hcnknKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJ4XyA9IHRoaXMuc2Vjb25kYXJ5Q29ubl87XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnBlbmRpbmdEYXRhTWVzc2FnZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRhdGFNZXNzYWdlXyh0aGlzLnBlbmRpbmdEYXRhTWVzc2FnZXNbaV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnBlbmRpbmdEYXRhTWVzc2FnZXMgPSBbXTtcbiAgICAgICAgICAgICAgICB0aGlzLnRyeUNsZWFudXBDb25uZWN0aW9uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjbWQgPT09IENPTlRST0xfU0hVVERPV04pIHtcbiAgICAgICAgICAgICAgICAvLyBUaGlzIHdhcyBwcmV2aW91c2x5IHRoZSAnb25LaWxsJyBjYWxsYmFjayBwYXNzZWQgdG8gdGhlIGxvd2VyLWxldmVsIGNvbm5lY3Rpb25cbiAgICAgICAgICAgICAgICAvLyBwYXlsb2FkIGluIHRoaXMgY2FzZSBpcyB0aGUgcmVhc29uIGZvciB0aGUgc2h1dGRvd24uIEdlbmVyYWxseSBhIGh1bWFuLXJlYWRhYmxlIGVycm9yXG4gICAgICAgICAgICAgICAgdGhpcy5vbkNvbm5lY3Rpb25TaHV0ZG93bl8ocGF5bG9hZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjbWQgPT09IENPTlRST0xfUkVTRVQpIHtcbiAgICAgICAgICAgICAgICAvLyBwYXlsb2FkIGluIHRoaXMgY2FzZSBpcyB0aGUgaG9zdCB3ZSBzaG91bGQgY29udGFjdFxuICAgICAgICAgICAgICAgIHRoaXMub25SZXNldF8ocGF5bG9hZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjbWQgPT09IENPTlRST0xfRVJST1IpIHtcbiAgICAgICAgICAgICAgICB1dGlsXzEuZXJyb3IoJ1NlcnZlciBFcnJvcjogJyArIHBheWxvYWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY21kID09PSBDT05UUk9MX1BPTkcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ18oJ2dvdCBwb25nIG9uIHByaW1hcnkuJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5vblByaW1hcnlSZXNwb25zZV8oKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbmRQaW5nT25QcmltYXJ5SWZOZWNlc3NhcnlfKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB1dGlsXzEuZXJyb3IoJ1Vua25vd24gY29udHJvbCBwYWNrZXQgY29tbWFuZDogJyArIGNtZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGhhbmRzaGFrZSBUaGUgaGFuZHNoYWtlIGRhdGEgcmV0dXJuZWQgZnJvbSB0aGUgc2VydmVyXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBDb25uZWN0aW9uLnByb3RvdHlwZS5vbkhhbmRzaGFrZV8gPSBmdW5jdGlvbiAoaGFuZHNoYWtlKSB7XG4gICAgICAgIHZhciB0aW1lc3RhbXAgPSBoYW5kc2hha2UudHM7XG4gICAgICAgIHZhciB2ZXJzaW9uID0gaGFuZHNoYWtlLnY7XG4gICAgICAgIHZhciBob3N0ID0gaGFuZHNoYWtlLmg7XG4gICAgICAgIHRoaXMuc2Vzc2lvbklkID0gaGFuZHNoYWtlLnM7XG4gICAgICAgIHRoaXMucmVwb0luZm9fLnVwZGF0ZUhvc3QoaG9zdCk7XG4gICAgICAgIC8vIGlmIHdlJ3ZlIGFscmVhZHkgY2xvc2VkIHRoZSBjb25uZWN0aW9uLCB0aGVuIGRvbid0IGJvdGhlciB0cnlpbmcgdG8gcHJvZ3Jlc3MgZnVydGhlclxuICAgICAgICBpZiAodGhpcy5zdGF0ZV8gPT0gMCAvKiBDT05ORUNUSU5HICovKSB7XG4gICAgICAgICAgICB0aGlzLmNvbm5fLnN0YXJ0KCk7XG4gICAgICAgICAgICB0aGlzLm9uQ29ubmVjdGlvbkVzdGFibGlzaGVkXyh0aGlzLmNvbm5fLCB0aW1lc3RhbXApO1xuICAgICAgICAgICAgaWYgKENvbnN0YW50c18xLlBST1RPQ09MX1ZFUlNJT04gIT09IHZlcnNpb24pIHtcbiAgICAgICAgICAgICAgICB1dGlsXzEud2FybignUHJvdG9jb2wgdmVyc2lvbiBtaXNtYXRjaCBkZXRlY3RlZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gVE9ETzogZG8gd2Ugd2FudCB0byB1cGdyYWRlPyB3aGVuPyBtYXliZSBhIGRlbGF5P1xuICAgICAgICAgICAgdGhpcy50cnlTdGFydFVwZ3JhZGVfKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENvbm5lY3Rpb24ucHJvdG90eXBlLnRyeVN0YXJ0VXBncmFkZV8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjb25uID0gdGhpcy50cmFuc3BvcnRNYW5hZ2VyXy51cGdyYWRlVHJhbnNwb3J0KCk7XG4gICAgICAgIGlmIChjb25uKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0VXBncmFkZV8oY29ubik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENvbm5lY3Rpb24ucHJvdG90eXBlLnN0YXJ0VXBncmFkZV8gPSBmdW5jdGlvbiAoY29ubikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnNlY29uZGFyeUNvbm5fID0gbmV3IGNvbm4odGhpcy5uZXh0VHJhbnNwb3J0SWRfKCksIHRoaXMucmVwb0luZm9fLCB0aGlzLnNlc3Npb25JZCk7XG4gICAgICAgIC8vIEZvciBjZXJ0YWluIHRyYW5zcG9ydHMgKFdlYlNvY2tldHMpLCB3ZSBuZWVkIHRvIHNlbmQgYW5kIHJlY2VpdmUgc2V2ZXJhbCBtZXNzYWdlcyBiYWNrIGFuZCBmb3J0aCBiZWZvcmUgd2VcbiAgICAgICAgLy8gY2FuIGNvbnNpZGVyIHRoZSB0cmFuc3BvcnQgaGVhbHRoeS5cbiAgICAgICAgdGhpcy5zZWNvbmRhcnlSZXNwb25zZXNSZXF1aXJlZF8gPVxuICAgICAgICAgICAgY29ublsncmVzcG9uc2VzUmVxdWlyZWRUb0JlSGVhbHRoeSddIHx8IDA7XG4gICAgICAgIHZhciBvbk1lc3NhZ2UgPSB0aGlzLmNvbm5SZWNlaXZlcl8odGhpcy5zZWNvbmRhcnlDb25uXyk7XG4gICAgICAgIHZhciBvbkRpc2Nvbm5lY3QgPSB0aGlzLmRpc2Nvbm5SZWNlaXZlcl8odGhpcy5zZWNvbmRhcnlDb25uXyk7XG4gICAgICAgIHRoaXMuc2Vjb25kYXJ5Q29ubl8ub3Blbihvbk1lc3NhZ2UsIG9uRGlzY29ubmVjdCk7XG4gICAgICAgIC8vIElmIHdlIGhhdmVuJ3Qgc3VjY2Vzc2Z1bGx5IHVwZ3JhZGVkIGFmdGVyIFVQR1JBREVfVElNRU9VVCwgZ2l2ZSB1cCBhbmQga2lsbCB0aGUgc2Vjb25kYXJ5LlxuICAgICAgICB1dGlsXzEuc2V0VGltZW91dE5vbkJsb2NraW5nKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmIChfdGhpcy5zZWNvbmRhcnlDb25uXykge1xuICAgICAgICAgICAgICAgIF90aGlzLmxvZ18oJ1RpbWVkIG91dCB0cnlpbmcgdG8gdXBncmFkZS4nKTtcbiAgICAgICAgICAgICAgICBfdGhpcy5zZWNvbmRhcnlDb25uXy5jbG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCBNYXRoLmZsb29yKFVQR1JBREVfVElNRU9VVCkpO1xuICAgIH07XG4gICAgQ29ubmVjdGlvbi5wcm90b3R5cGUub25SZXNldF8gPSBmdW5jdGlvbiAoaG9zdCkge1xuICAgICAgICB0aGlzLmxvZ18oJ1Jlc2V0IHBhY2tldCByZWNlaXZlZC4gIE5ldyBob3N0OiAnICsgaG9zdCk7XG4gICAgICAgIHRoaXMucmVwb0luZm9fLnVwZGF0ZUhvc3QoaG9zdCk7XG4gICAgICAgIC8vIFRPRE86IGlmIHdlJ3JlIGFscmVhZHkgXCJjb25uZWN0ZWRcIiwgd2UgbmVlZCB0byB0cmlnZ2VyIGEgZGlzY29ubmVjdCBhdCB0aGUgbmV4dCBsYXllciB1cC5cbiAgICAgICAgLy8gV2UgZG9uJ3QgY3VycmVudGx5IHN1cHBvcnQgcmVzZXRzIGFmdGVyIHRoZSBjb25uZWN0aW9uIGhhcyBhbHJlYWR5IGJlZW4gZXN0YWJsaXNoZWRcbiAgICAgICAgaWYgKHRoaXMuc3RhdGVfID09PSAxIC8qIENPTk5FQ1RFRCAqLykge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gQ2xvc2Ugd2hhdGV2ZXIgY29ubmVjdGlvbnMgd2UgaGF2ZSBvcGVuIGFuZCBzdGFydCBhZ2Fpbi5cbiAgICAgICAgICAgIHRoaXMuY2xvc2VDb25uZWN0aW9uc18oKTtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRfKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENvbm5lY3Rpb24ucHJvdG90eXBlLm9uQ29ubmVjdGlvbkVzdGFibGlzaGVkXyA9IGZ1bmN0aW9uIChjb25uLCB0aW1lc3RhbXApIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5sb2dfKCdSZWFsdGltZSBjb25uZWN0aW9uIGVzdGFibGlzaGVkLicpO1xuICAgICAgICB0aGlzLmNvbm5fID0gY29ubjtcbiAgICAgICAgdGhpcy5zdGF0ZV8gPSAxIC8qIENPTk5FQ1RFRCAqLztcbiAgICAgICAgaWYgKHRoaXMub25SZWFkeV8pIHtcbiAgICAgICAgICAgIHRoaXMub25SZWFkeV8odGltZXN0YW1wLCB0aGlzLnNlc3Npb25JZCk7XG4gICAgICAgICAgICB0aGlzLm9uUmVhZHlfID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICAvLyBJZiBhZnRlciA1IHNlY29uZHMgd2UgaGF2ZW4ndCBzZW50IGVub3VnaCByZXF1ZXN0cyB0byB0aGUgc2VydmVyIHRvIGdldCB0aGUgY29ubmVjdGlvbiBoZWFsdGh5LFxuICAgICAgICAvLyBzZW5kIHNvbWUgcGluZ3MuXG4gICAgICAgIGlmICh0aGlzLnByaW1hcnlSZXNwb25zZXNSZXF1aXJlZF8gPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMubG9nXygnUHJpbWFyeSBjb25uZWN0aW9uIGlzIGhlYWx0aHkuJyk7XG4gICAgICAgICAgICB0aGlzLmlzSGVhbHRoeV8gPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdXRpbF8xLnNldFRpbWVvdXROb25CbG9ja2luZyhmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuc2VuZFBpbmdPblByaW1hcnlJZk5lY2Vzc2FyeV8oKTtcbiAgICAgICAgICAgIH0sIE1hdGguZmxvb3IoREVMQVlfQkVGT1JFX1NFTkRJTkdfRVhUUkFfUkVRVUVTVFMpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ29ubmVjdGlvbi5wcm90b3R5cGUuc2VuZFBpbmdPblByaW1hcnlJZk5lY2Vzc2FyeV8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIElmIHRoZSBjb25uZWN0aW9uIGlzbid0IGNvbnNpZGVyZWQgaGVhbHRoeSB5ZXQsIHdlJ2xsIHNlbmQgYSBub29wIHBpbmcgcGFja2V0IHJlcXVlc3QuXG4gICAgICAgIGlmICghdGhpcy5pc0hlYWx0aHlfICYmIHRoaXMuc3RhdGVfID09PSAxIC8qIENPTk5FQ1RFRCAqLykge1xuICAgICAgICAgICAgdGhpcy5sb2dfKCdzZW5kaW5nIHBpbmcgb24gcHJpbWFyeS4nKTtcbiAgICAgICAgICAgIHRoaXMuc2VuZERhdGFfKHsgdDogJ2MnLCBkOiB7IHQ6IFBJTkcsIGQ6IHt9IH0gfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENvbm5lY3Rpb24ucHJvdG90eXBlLm9uU2Vjb25kYXJ5Q29ubmVjdGlvbkxvc3RfID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY29ubiA9IHRoaXMuc2Vjb25kYXJ5Q29ubl87XG4gICAgICAgIHRoaXMuc2Vjb25kYXJ5Q29ubl8gPSBudWxsO1xuICAgICAgICBpZiAodGhpcy50eF8gPT09IGNvbm4gfHwgdGhpcy5yeF8gPT09IGNvbm4pIHtcbiAgICAgICAgICAgIC8vIHdlIGFyZSByZWx5aW5nIG9uIHRoaXMgY29ubmVjdGlvbiBhbHJlYWR5IGluIHNvbWUgY2FwYWNpdHkuIFRoZXJlZm9yZSwgYSBmYWlsdXJlIGlzIHJlYWxcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGV2ZXJDb25uZWN0ZWQgV2hldGhlciBvciBub3QgdGhlIGNvbm5lY3Rpb24gZXZlciByZWFjaGVkIGEgc2VydmVyLiBVc2VkIHRvIGRldGVybWluZSBpZlxuICAgICAqIHdlIHNob3VsZCBmbHVzaCB0aGUgaG9zdCBjYWNoZVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgQ29ubmVjdGlvbi5wcm90b3R5cGUub25Db25uZWN0aW9uTG9zdF8gPSBmdW5jdGlvbiAoZXZlckNvbm5lY3RlZCkge1xuICAgICAgICB0aGlzLmNvbm5fID0gbnVsbDtcbiAgICAgICAgLy8gTk9URTogSUYgeW91J3JlIHNlZWluZyBhIEZpcmVmb3ggZXJyb3IgZm9yIHRoaXMgbGluZSwgSSB0aGluayBpdCBtaWdodCBiZSBiZWNhdXNlIGl0J3MgZ2V0dGluZ1xuICAgICAgICAvLyBjYWxsZWQgb24gd2luZG93IGNsb3NlIGFuZCBSZWFsdGltZVN0YXRlLkNPTk5FQ1RJTkcgaXMgbm8gbG9uZ2VyIGRlZmluZWQuICBKdXN0IGEgZ3Vlc3MuXG4gICAgICAgIGlmICghZXZlckNvbm5lY3RlZCAmJiB0aGlzLnN0YXRlXyA9PT0gMCAvKiBDT05ORUNUSU5HICovKSB7XG4gICAgICAgICAgICB0aGlzLmxvZ18oJ1JlYWx0aW1lIGNvbm5lY3Rpb24gZmFpbGVkLicpO1xuICAgICAgICAgICAgLy8gU2luY2Ugd2UgZmFpbGVkIHRvIGNvbm5lY3QgYXQgYWxsLCBjbGVhciBhbnkgY2FjaGVkIGVudHJ5IGZvciB0aGlzIG5hbWVzcGFjZSBpbiBjYXNlIHRoZSBtYWNoaW5lIHdlbnQgYXdheVxuICAgICAgICAgICAgaWYgKHRoaXMucmVwb0luZm9fLmlzQ2FjaGVhYmxlSG9zdCgpKSB7XG4gICAgICAgICAgICAgICAgc3RvcmFnZV8xLlBlcnNpc3RlbnRTdG9yYWdlLnJlbW92ZSgnaG9zdDonICsgdGhpcy5yZXBvSW5mb18uaG9zdCk7XG4gICAgICAgICAgICAgICAgLy8gcmVzZXQgdGhlIGludGVybmFsIGhvc3QgdG8gd2hhdCB3ZSB3b3VsZCBzaG93IHRoZSB1c2VyLCBpLmUuIDxucz4uZmlyZWJhc2Vpby5jb21cbiAgICAgICAgICAgICAgICB0aGlzLnJlcG9JbmZvXy5pbnRlcm5hbEhvc3QgPSB0aGlzLnJlcG9JbmZvXy5ob3N0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuc3RhdGVfID09PSAxIC8qIENPTk5FQ1RFRCAqLykge1xuICAgICAgICAgICAgdGhpcy5sb2dfKCdSZWFsdGltZSBjb25uZWN0aW9uIGxvc3QuJyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcmVhc29uXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBDb25uZWN0aW9uLnByb3RvdHlwZS5vbkNvbm5lY3Rpb25TaHV0ZG93bl8gPSBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgICAgIHRoaXMubG9nXygnQ29ubmVjdGlvbiBzaHV0ZG93biBjb21tYW5kIHJlY2VpdmVkLiBTaHV0dGluZyBkb3duLi4uJyk7XG4gICAgICAgIGlmICh0aGlzLm9uS2lsbF8pIHtcbiAgICAgICAgICAgIHRoaXMub25LaWxsXyhyZWFzb24pO1xuICAgICAgICAgICAgdGhpcy5vbktpbGxfID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICAvLyBXZSBpbnRlbnRpb25hbGx5IGRvbid0IHdhbnQgdG8gZmlyZSBvbkRpc2Nvbm5lY3QgKGtpbGwgaXMgYSBkaWZmZXJlbnQgY2FzZSksXG4gICAgICAgIC8vIHNvIGNsZWFyIHRoZSBjYWxsYmFjay5cbiAgICAgICAgdGhpcy5vbkRpc2Nvbm5lY3RfID0gbnVsbDtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH07XG4gICAgQ29ubmVjdGlvbi5wcm90b3R5cGUuc2VuZERhdGFfID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGVfICE9PSAxIC8qIENPTk5FQ1RFRCAqLykge1xuICAgICAgICAgICAgdGhyb3cgJ0Nvbm5lY3Rpb24gaXMgbm90IGNvbm5lY3RlZCc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnR4Xy5zZW5kKGRhdGEpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBDbGVhbnMgdXAgdGhpcyBjb25uZWN0aW9uLCBjYWxsaW5nIHRoZSBhcHByb3ByaWF0ZSBjYWxsYmFja3NcbiAgICAgKi9cbiAgICBDb25uZWN0aW9uLnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGVfICE9PSAyIC8qIERJU0NPTk5FQ1RFRCAqLykge1xuICAgICAgICAgICAgdGhpcy5sb2dfKCdDbG9zaW5nIHJlYWx0aW1lIGNvbm5lY3Rpb24uJyk7XG4gICAgICAgICAgICB0aGlzLnN0YXRlXyA9IDIgLyogRElTQ09OTkVDVEVEICovO1xuICAgICAgICAgICAgdGhpcy5jbG9zZUNvbm5lY3Rpb25zXygpO1xuICAgICAgICAgICAgaWYgKHRoaXMub25EaXNjb25uZWN0Xykge1xuICAgICAgICAgICAgICAgIHRoaXMub25EaXNjb25uZWN0XygpO1xuICAgICAgICAgICAgICAgIHRoaXMub25EaXNjb25uZWN0XyA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBDb25uZWN0aW9uLnByb3RvdHlwZS5jbG9zZUNvbm5lY3Rpb25zXyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5sb2dfKCdTaHV0dGluZyBkb3duIGFsbCBjb25uZWN0aW9ucycpO1xuICAgICAgICBpZiAodGhpcy5jb25uXykge1xuICAgICAgICAgICAgdGhpcy5jb25uXy5jbG9zZSgpO1xuICAgICAgICAgICAgdGhpcy5jb25uXyA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuc2Vjb25kYXJ5Q29ubl8pIHtcbiAgICAgICAgICAgIHRoaXMuc2Vjb25kYXJ5Q29ubl8uY2xvc2UoKTtcbiAgICAgICAgICAgIHRoaXMuc2Vjb25kYXJ5Q29ubl8gPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmhlYWx0aHlUaW1lb3V0Xykge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuaGVhbHRoeVRpbWVvdXRfKTtcbiAgICAgICAgICAgIHRoaXMuaGVhbHRoeVRpbWVvdXRfID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIENvbm5lY3Rpb247XG59KCkpO1xuZXhwb3J0cy5Db25uZWN0aW9uID0gQ29ubmVjdGlvbjtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29ubmVjdGlvbi5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuUFJPVE9DT0xfVkVSU0lPTiA9ICc1JztcbmV4cG9ydHMuVkVSU0lPTl9QQVJBTSA9ICd2JztcbmV4cG9ydHMuVFJBTlNQT1JUX1NFU1NJT05fUEFSQU0gPSAncyc7XG5leHBvcnRzLlJFRkVSRVJfUEFSQU0gPSAncic7XG5leHBvcnRzLkZPUkdFX1JFRiA9ICdmJztcbmV4cG9ydHMuRk9SR0VfRE9NQUlOID0gJ2ZpcmViYXNlaW8uY29tJztcbmV4cG9ydHMuTEFTVF9TRVNTSU9OX1BBUkFNID0gJ2xzJztcbmV4cG9ydHMuV0VCU09DS0VUID0gJ3dlYnNvY2tldCc7XG5leHBvcnRzLkxPTkdfUE9MTElORyA9ICdsb25nX3BvbGxpbmcnO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Db25zdGFudHMuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgQnJvd3NlclBvbGxDb25uZWN0aW9uXzEgPSByZXF1aXJlKFwiLi9Ccm93c2VyUG9sbENvbm5lY3Rpb25cIik7XG52YXIgV2ViU29ja2V0Q29ubmVjdGlvbl8xID0gcmVxdWlyZShcIi4vV2ViU29ja2V0Q29ubmVjdGlvblwiKTtcbnZhciB1dGlsXzEgPSByZXF1aXJlKFwiLi4vY29yZS91dGlsL3V0aWxcIik7XG4vKipcbiAqIEN1cnJlbnRseSBzaW1wbGlzdGljLCB0aGlzIGNsYXNzIG1hbmFnZXMgd2hhdCB0cmFuc3BvcnQgYSBDb25uZWN0aW9uIHNob3VsZCB1c2UgYXQgdmFyaW91cyBzdGFnZXMgb2YgaXRzXG4gKiBsaWZlY3ljbGUuXG4gKlxuICogSXQgc3RhcnRzIHdpdGggbG9uZ3BvbGxpbmcgaW4gYSBicm93c2VyLCBhbmQgaHR0cHBvbGxpbmcgb24gbm9kZS4gSXQgdGhlbiB1cGdyYWRlcyB0byB3ZWJzb2NrZXRzIGlmXG4gKiB0aGV5IGFyZSBhdmFpbGFibGUuXG4gKiBAY29uc3RydWN0b3JcbiAqL1xudmFyIFRyYW5zcG9ydE1hbmFnZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshUmVwb0luZm99IHJlcG9JbmZvIE1ldGFkYXRhIGFyb3VuZCB0aGUgbmFtZXNwYWNlIHdlJ3JlIGNvbm5lY3RpbmcgdG9cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBUcmFuc3BvcnRNYW5hZ2VyKHJlcG9JbmZvKSB7XG4gICAgICAgIHRoaXMuaW5pdFRyYW5zcG9ydHNfKHJlcG9JbmZvKTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRyYW5zcG9ydE1hbmFnZXIsIFwiQUxMX1RSQU5TUE9SVFNcIiwge1xuICAgICAgICAvKipcbiAgICAgICAgICogQGNvbnN0XG4gICAgICAgICAqIEB0eXBlIHshQXJyYXkuPGZ1bmN0aW9uKG5ldzpUcmFuc3BvcnQsIHN0cmluZywgUmVwb0luZm8sIHN0cmluZz0pPn1cbiAgICAgICAgICovXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIFtCcm93c2VyUG9sbENvbm5lY3Rpb25fMS5Ccm93c2VyUG9sbENvbm5lY3Rpb24sIFdlYlNvY2tldENvbm5lY3Rpb25fMS5XZWJTb2NrZXRDb25uZWN0aW9uXTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHshUmVwb0luZm99IHJlcG9JbmZvXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBUcmFuc3BvcnRNYW5hZ2VyLnByb3RvdHlwZS5pbml0VHJhbnNwb3J0c18gPSBmdW5jdGlvbiAocmVwb0luZm8pIHtcbiAgICAgICAgdmFyIGlzV2ViU29ja2V0c0F2YWlsYWJsZSA9IFdlYlNvY2tldENvbm5lY3Rpb25fMS5XZWJTb2NrZXRDb25uZWN0aW9uICYmIFdlYlNvY2tldENvbm5lY3Rpb25fMS5XZWJTb2NrZXRDb25uZWN0aW9uWydpc0F2YWlsYWJsZSddKCk7XG4gICAgICAgIHZhciBpc1NraXBQb2xsQ29ubmVjdGlvbiA9IGlzV2ViU29ja2V0c0F2YWlsYWJsZSAmJiAhV2ViU29ja2V0Q29ubmVjdGlvbl8xLldlYlNvY2tldENvbm5lY3Rpb24ucHJldmlvdXNseUZhaWxlZCgpO1xuICAgICAgICBpZiAocmVwb0luZm8ud2ViU29ja2V0T25seSkge1xuICAgICAgICAgICAgaWYgKCFpc1dlYlNvY2tldHNBdmFpbGFibGUpXG4gICAgICAgICAgICAgICAgdXRpbF8xLndhcm4oXCJ3c3M6Ly8gVVJMIHVzZWQsIGJ1dCBicm93c2VyIGlzbid0IGtub3duIHRvIHN1cHBvcnQgd2Vic29ja2V0cy4gIFRyeWluZyBhbnl3YXkuXCIpO1xuICAgICAgICAgICAgaXNTa2lwUG9sbENvbm5lY3Rpb24gPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc1NraXBQb2xsQ29ubmVjdGlvbikge1xuICAgICAgICAgICAgdGhpcy50cmFuc3BvcnRzXyA9IFtXZWJTb2NrZXRDb25uZWN0aW9uXzEuV2ViU29ja2V0Q29ubmVjdGlvbl07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgdHJhbnNwb3J0c18xID0gKHRoaXMudHJhbnNwb3J0c18gPSBbXSk7XG4gICAgICAgICAgICB1dGlsXzEuZWFjaChUcmFuc3BvcnRNYW5hZ2VyLkFMTF9UUkFOU1BPUlRTLCBmdW5jdGlvbiAoaSwgdHJhbnNwb3J0KSB7XG4gICAgICAgICAgICAgICAgaWYgKHRyYW5zcG9ydCAmJiB0cmFuc3BvcnRbJ2lzQXZhaWxhYmxlJ10oKSkge1xuICAgICAgICAgICAgICAgICAgICB0cmFuc3BvcnRzXzEucHVzaCh0cmFuc3BvcnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHtmdW5jdGlvbihuZXc6VHJhbnNwb3J0LCAhc3RyaW5nLCAhUmVwb0luZm8sIHN0cmluZz0sIHN0cmluZz0pfSBUaGUgY29uc3RydWN0b3IgZm9yIHRoZVxuICAgICAqIGluaXRpYWwgdHJhbnNwb3J0IHRvIHVzZVxuICAgICAqL1xuICAgIFRyYW5zcG9ydE1hbmFnZXIucHJvdG90eXBlLmluaXRpYWxUcmFuc3BvcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnRyYW5zcG9ydHNfLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRyYW5zcG9ydHNfWzBdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyB0cmFuc3BvcnRzIGF2YWlsYWJsZScpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHs/ZnVuY3Rpb24obmV3OlRyYW5zcG9ydCwgZnVuY3Rpb24oKSxmdW5jdGlvbigpLCBzdHJpbmc9KX0gVGhlIGNvbnN0cnVjdG9yIGZvciB0aGUgbmV4dFxuICAgICAqIHRyYW5zcG9ydCwgb3IgbnVsbFxuICAgICAqL1xuICAgIFRyYW5zcG9ydE1hbmFnZXIucHJvdG90eXBlLnVwZ3JhZGVUcmFuc3BvcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnRyYW5zcG9ydHNfLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRyYW5zcG9ydHNfWzFdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBUcmFuc3BvcnRNYW5hZ2VyO1xufSgpKTtcbmV4cG9ydHMuVHJhbnNwb3J0TWFuYWdlciA9IFRyYW5zcG9ydE1hbmFnZXI7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVRyYW5zcG9ydE1hbmFnZXIuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgYXBwXzEgPSByZXF1aXJlKFwiQGZpcmViYXNlL2FwcFwiKTtcbnZhciB1dGlsXzEgPSByZXF1aXJlKFwiQGZpcmViYXNlL3V0aWxcIik7XG52YXIgdXRpbF8yID0gcmVxdWlyZShcIi4uL2NvcmUvdXRpbC91dGlsXCIpO1xudmFyIFN0YXRzTWFuYWdlcl8xID0gcmVxdWlyZShcIi4uL2NvcmUvc3RhdHMvU3RhdHNNYW5hZ2VyXCIpO1xudmFyIENvbnN0YW50c18xID0gcmVxdWlyZShcIi4vQ29uc3RhbnRzXCIpO1xudmFyIHV0aWxfMyA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvdXRpbFwiKTtcbnZhciBzdG9yYWdlXzEgPSByZXF1aXJlKFwiLi4vY29yZS9zdG9yYWdlL3N0b3JhZ2VcIik7XG52YXIgdXRpbF80ID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xudmFyIHV0aWxfNSA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvdXRpbFwiKTtcbnZhciBXRUJTT0NLRVRfTUFYX0ZSQU1FX1NJWkUgPSAxNjM4NDtcbnZhciBXRUJTT0NLRVRfS0VFUEFMSVZFX0lOVEVSVkFMID0gNDUwMDA7XG52YXIgV2ViU29ja2V0SW1wbCA9IG51bGw7XG5pZiAodHlwZW9mIE1veldlYlNvY2tldCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBXZWJTb2NrZXRJbXBsID0gTW96V2ViU29ja2V0O1xufVxuZWxzZSBpZiAodHlwZW9mIFdlYlNvY2tldCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBXZWJTb2NrZXRJbXBsID0gV2ViU29ja2V0O1xufVxuZnVuY3Rpb24gc2V0V2ViU29ja2V0SW1wbChpbXBsKSB7XG4gICAgV2ViU29ja2V0SW1wbCA9IGltcGw7XG59XG5leHBvcnRzLnNldFdlYlNvY2tldEltcGwgPSBzZXRXZWJTb2NrZXRJbXBsO1xuLyoqXG4gKiBDcmVhdGUgYSBuZXcgd2Vic29ja2V0IGNvbm5lY3Rpb24gd2l0aCB0aGUgZ2l2ZW4gY2FsbGJhY2tzLlxuICogQGNvbnN0cnVjdG9yXG4gKiBAaW1wbGVtZW50cyB7VHJhbnNwb3J0fVxuICovXG52YXIgV2ViU29ja2V0Q29ubmVjdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gY29ubklkIGlkZW50aWZpZXIgZm9yIHRoaXMgdHJhbnNwb3J0XG4gICAgICogQHBhcmFtIHtSZXBvSW5mb30gcmVwb0luZm8gVGhlIGluZm8gZm9yIHRoZSB3ZWJzb2NrZXQgZW5kcG9pbnQuXG4gICAgICogQHBhcmFtIHtzdHJpbmc9fSB0cmFuc3BvcnRTZXNzaW9uSWQgT3B0aW9uYWwgdHJhbnNwb3J0U2Vzc2lvbklkIGlmIHRoaXMgaXMgY29ubmVjdGluZyB0byBhbiBleGlzdGluZyB0cmFuc3BvcnRcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Vzc2lvblxuICAgICAqIEBwYXJhbSB7c3RyaW5nPX0gbGFzdFNlc3Npb25JZCBPcHRpb25hbCBsYXN0U2Vzc2lvbklkIGlmIHRoZXJlIHdhcyBhIHByZXZpb3VzIGNvbm5lY3Rpb25cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBXZWJTb2NrZXRDb25uZWN0aW9uKGNvbm5JZCwgcmVwb0luZm8sIHRyYW5zcG9ydFNlc3Npb25JZCwgbGFzdFNlc3Npb25JZCkge1xuICAgICAgICB0aGlzLmNvbm5JZCA9IGNvbm5JZDtcbiAgICAgICAgdGhpcy5rZWVwYWxpdmVUaW1lciA9IG51bGw7XG4gICAgICAgIHRoaXMuZnJhbWVzID0gbnVsbDtcbiAgICAgICAgdGhpcy50b3RhbEZyYW1lcyA9IDA7XG4gICAgICAgIHRoaXMuYnl0ZXNTZW50ID0gMDtcbiAgICAgICAgdGhpcy5ieXRlc1JlY2VpdmVkID0gMDtcbiAgICAgICAgdGhpcy5sb2dfID0gdXRpbF8yLmxvZ1dyYXBwZXIodGhpcy5jb25uSWQpO1xuICAgICAgICB0aGlzLnN0YXRzXyA9IFN0YXRzTWFuYWdlcl8xLlN0YXRzTWFuYWdlci5nZXRDb2xsZWN0aW9uKHJlcG9JbmZvKTtcbiAgICAgICAgdGhpcy5jb25uVVJMID0gV2ViU29ja2V0Q29ubmVjdGlvbi5jb25uZWN0aW9uVVJMXyhyZXBvSW5mbywgdHJhbnNwb3J0U2Vzc2lvbklkLCBsYXN0U2Vzc2lvbklkKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtSZXBvSW5mb30gcmVwb0luZm8gVGhlIGluZm8gZm9yIHRoZSB3ZWJzb2NrZXQgZW5kcG9pbnQuXG4gICAgICogQHBhcmFtIHtzdHJpbmc9fSB0cmFuc3BvcnRTZXNzaW9uSWQgT3B0aW9uYWwgdHJhbnNwb3J0U2Vzc2lvbklkIGlmIHRoaXMgaXMgY29ubmVjdGluZyB0byBhbiBleGlzdGluZyB0cmFuc3BvcnRcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Vzc2lvblxuICAgICAqIEBwYXJhbSB7c3RyaW5nPX0gbGFzdFNlc3Npb25JZCBPcHRpb25hbCBsYXN0U2Vzc2lvbklkIGlmIHRoZXJlIHdhcyBhIHByZXZpb3VzIGNvbm5lY3Rpb25cbiAgICAgKiBAcmV0dXJuIHtzdHJpbmd9IGNvbm5lY3Rpb24gdXJsXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBXZWJTb2NrZXRDb25uZWN0aW9uLmNvbm5lY3Rpb25VUkxfID0gZnVuY3Rpb24gKHJlcG9JbmZvLCB0cmFuc3BvcnRTZXNzaW9uSWQsIGxhc3RTZXNzaW9uSWQpIHtcbiAgICAgICAgdmFyIHVybFBhcmFtcyA9IHt9O1xuICAgICAgICB1cmxQYXJhbXNbQ29uc3RhbnRzXzEuVkVSU0lPTl9QQVJBTV0gPSBDb25zdGFudHNfMS5QUk9UT0NPTF9WRVJTSU9OO1xuICAgICAgICBpZiAoIXV0aWxfNS5pc05vZGVTZGsoKSAmJlxuICAgICAgICAgICAgdHlwZW9mIGxvY2F0aW9uICE9PSAndW5kZWZpbmVkJyAmJlxuICAgICAgICAgICAgbG9jYXRpb24uaHJlZiAmJlxuICAgICAgICAgICAgbG9jYXRpb24uaHJlZi5pbmRleE9mKENvbnN0YW50c18xLkZPUkdFX0RPTUFJTikgIT09IC0xKSB7XG4gICAgICAgICAgICB1cmxQYXJhbXNbQ29uc3RhbnRzXzEuUkVGRVJFUl9QQVJBTV0gPSBDb25zdGFudHNfMS5GT1JHRV9SRUY7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRyYW5zcG9ydFNlc3Npb25JZCkge1xuICAgICAgICAgICAgdXJsUGFyYW1zW0NvbnN0YW50c18xLlRSQU5TUE9SVF9TRVNTSU9OX1BBUkFNXSA9IHRyYW5zcG9ydFNlc3Npb25JZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAobGFzdFNlc3Npb25JZCkge1xuICAgICAgICAgICAgdXJsUGFyYW1zW0NvbnN0YW50c18xLkxBU1RfU0VTU0lPTl9QQVJBTV0gPSBsYXN0U2Vzc2lvbklkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXBvSW5mby5jb25uZWN0aW9uVVJMKENvbnN0YW50c18xLldFQlNPQ0tFVCwgdXJsUGFyYW1zKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqXG4gICAgICogQHBhcmFtIG9uTWVzc2FnZSBDYWxsYmFjayB3aGVuIG1lc3NhZ2VzIGFycml2ZVxuICAgICAqIEBwYXJhbSBvbkRpc2Nvbm5lY3QgQ2FsbGJhY2sgd2l0aCBjb25uZWN0aW9uIGxvc3QuXG4gICAgICovXG4gICAgV2ViU29ja2V0Q29ubmVjdGlvbi5wcm90b3R5cGUub3BlbiA9IGZ1bmN0aW9uIChvbk1lc3NhZ2UsIG9uRGlzY29ubmVjdCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLm9uRGlzY29ubmVjdCA9IG9uRGlzY29ubmVjdDtcbiAgICAgICAgdGhpcy5vbk1lc3NhZ2UgPSBvbk1lc3NhZ2U7XG4gICAgICAgIHRoaXMubG9nXygnV2Vic29ja2V0IGNvbm5lY3RpbmcgdG8gJyArIHRoaXMuY29ublVSTCk7XG4gICAgICAgIHRoaXMuZXZlckNvbm5lY3RlZF8gPSBmYWxzZTtcbiAgICAgICAgLy8gQXNzdW1lIGZhaWx1cmUgdW50aWwgcHJvdmVuIG90aGVyd2lzZS5cbiAgICAgICAgc3RvcmFnZV8xLlBlcnNpc3RlbnRTdG9yYWdlLnNldCgncHJldmlvdXNfd2Vic29ja2V0X2ZhaWx1cmUnLCB0cnVlKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICh1dGlsXzUuaXNOb2RlU2RrKCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGV2aWNlID0gdXRpbF8zLkNPTlNUQU5UUy5OT0RFX0FETUlOID8gJ0FkbWluTm9kZScgOiAnTm9kZSc7XG4gICAgICAgICAgICAgICAgLy8gVUEgRm9ybWF0OiBGaXJlYmFzZS88d2lyZV9wcm90b2NvbD4vPHNka192ZXJzaW9uPi88cGxhdGZvcm0+LzxkZXZpY2U+XG4gICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdVc2VyLUFnZW50JzogXCJGaXJlYmFzZS9cIiArIENvbnN0YW50c18xLlBST1RPQ09MX1ZFUlNJT04gKyBcIi9cIiArIGFwcF8xLmRlZmF1bHQuU0RLX1ZFUlNJT04gKyBcIi9cIiArIHByb2Nlc3MucGxhdGZvcm0gKyBcIi9cIiArIGRldmljZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAvLyBQbHVtYiBhcHByb3ByaWF0ZSBodHRwX3Byb3h5IGVudmlyb25tZW50IHZhcmlhYmxlIGludG8gZmF5ZS13ZWJzb2NrZXQgaWYgaXQgZXhpc3RzLlxuICAgICAgICAgICAgICAgIHZhciBlbnYgPSBwcm9jZXNzWydlbnYnXTtcbiAgICAgICAgICAgICAgICB2YXIgcHJveHkgPSB0aGlzLmNvbm5VUkwuaW5kZXhPZignd3NzOi8vJykgPT0gMFxuICAgICAgICAgICAgICAgICAgICA/IGVudlsnSFRUUFNfUFJPWFknXSB8fCBlbnZbJ2h0dHBzX3Byb3h5J11cbiAgICAgICAgICAgICAgICAgICAgOiBlbnZbJ0hUVFBfUFJPWFknXSB8fCBlbnZbJ2h0dHBfcHJveHknXTtcbiAgICAgICAgICAgICAgICBpZiAocHJveHkpIHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uc1sncHJveHknXSA9IHsgb3JpZ2luOiBwcm94eSB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLm15U29jayA9IG5ldyBXZWJTb2NrZXRJbXBsKHRoaXMuY29ublVSTCwgW10sIG9wdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5teVNvY2sgPSBuZXcgV2ViU29ja2V0SW1wbCh0aGlzLmNvbm5VUkwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICB0aGlzLmxvZ18oJ0Vycm9yIGluc3RhbnRpYXRpbmcgV2ViU29ja2V0LicpO1xuICAgICAgICAgICAgdmFyIGVycm9yID0gZS5tZXNzYWdlIHx8IGUuZGF0YTtcbiAgICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHRoaXMubG9nXyhlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm9uQ2xvc2VkXygpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubXlTb2NrLm9ub3BlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF90aGlzLmxvZ18oJ1dlYnNvY2tldCBjb25uZWN0ZWQuJyk7XG4gICAgICAgICAgICBfdGhpcy5ldmVyQ29ubmVjdGVkXyA9IHRydWU7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMubXlTb2NrLm9uY2xvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfdGhpcy5sb2dfKCdXZWJzb2NrZXQgY29ubmVjdGlvbiB3YXMgZGlzY29ubmVjdGVkLicpO1xuICAgICAgICAgICAgX3RoaXMubXlTb2NrID0gbnVsbDtcbiAgICAgICAgICAgIF90aGlzLm9uQ2xvc2VkXygpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLm15U29jay5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAobSkge1xuICAgICAgICAgICAgX3RoaXMuaGFuZGxlSW5jb21pbmdGcmFtZShtKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5teVNvY2sub25lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBfdGhpcy5sb2dfKCdXZWJTb2NrZXQgZXJyb3IuICBDbG9zaW5nIGNvbm5lY3Rpb24uJyk7XG4gICAgICAgICAgICB2YXIgZXJyb3IgPSBlLm1lc3NhZ2UgfHwgZS5kYXRhO1xuICAgICAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMubG9nXyhlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfdGhpcy5vbkNsb3NlZF8oKTtcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIE5vLW9wIGZvciB3ZWJzb2NrZXRzLCB3ZSBkb24ndCBuZWVkIHRvIGRvIGFueXRoaW5nIG9uY2UgdGhlIGNvbm5lY3Rpb24gaXMgY29uZmlybWVkIGFzIG9wZW5cbiAgICAgKi9cbiAgICBXZWJTb2NrZXRDb25uZWN0aW9uLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uICgpIHsgfTtcbiAgICBXZWJTb2NrZXRDb25uZWN0aW9uLmZvcmNlRGlzYWxsb3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIFdlYlNvY2tldENvbm5lY3Rpb24uZm9yY2VEaXNhbGxvd18gPSB0cnVlO1xuICAgIH07XG4gICAgV2ViU29ja2V0Q29ubmVjdGlvbi5pc0F2YWlsYWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGlzT2xkQW5kcm9pZCA9IGZhbHNlO1xuICAgICAgICBpZiAodHlwZW9mIG5hdmlnYXRvciAhPT0gJ3VuZGVmaW5lZCcgJiYgbmF2aWdhdG9yLnVzZXJBZ2VudCkge1xuICAgICAgICAgICAgdmFyIG9sZEFuZHJvaWRSZWdleCA9IC9BbmRyb2lkIChbMC05XXswLH1cXC5bMC05XXswLH0pLztcbiAgICAgICAgICAgIHZhciBvbGRBbmRyb2lkTWF0Y2ggPSBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKG9sZEFuZHJvaWRSZWdleCk7XG4gICAgICAgICAgICBpZiAob2xkQW5kcm9pZE1hdGNoICYmIG9sZEFuZHJvaWRNYXRjaC5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBhcnNlRmxvYXQob2xkQW5kcm9pZE1hdGNoWzFdKSA8IDQuNCkge1xuICAgICAgICAgICAgICAgICAgICBpc09sZEFuZHJvaWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKCFpc09sZEFuZHJvaWQgJiZcbiAgICAgICAgICAgIFdlYlNvY2tldEltcGwgIT09IG51bGwgJiZcbiAgICAgICAgICAgICFXZWJTb2NrZXRDb25uZWN0aW9uLmZvcmNlRGlzYWxsb3dfKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB3ZSBwcmV2aW91c2x5IGZhaWxlZCB0byBjb25uZWN0IHdpdGggdGhpcyB0cmFuc3BvcnQuXG4gICAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBXZWJTb2NrZXRDb25uZWN0aW9uLnByZXZpb3VzbHlGYWlsZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIElmIG91ciBwZXJzaXN0ZW50IHN0b3JhZ2UgaXMgYWN0dWFsbHkgb25seSBpbi1tZW1vcnkgc3RvcmFnZSxcbiAgICAgICAgLy8gd2UgZGVmYXVsdCB0byBhc3N1bWluZyB0aGF0IGl0IHByZXZpb3VzbHkgZmFpbGVkIHRvIGJlIHNhZmUuXG4gICAgICAgIHJldHVybiAoc3RvcmFnZV8xLlBlcnNpc3RlbnRTdG9yYWdlLmlzSW5NZW1vcnlTdG9yYWdlIHx8XG4gICAgICAgICAgICBzdG9yYWdlXzEuUGVyc2lzdGVudFN0b3JhZ2UuZ2V0KCdwcmV2aW91c193ZWJzb2NrZXRfZmFpbHVyZScpID09PSB0cnVlKTtcbiAgICB9O1xuICAgIFdlYlNvY2tldENvbm5lY3Rpb24ucHJvdG90eXBlLm1hcmtDb25uZWN0aW9uSGVhbHRoeSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc3RvcmFnZV8xLlBlcnNpc3RlbnRTdG9yYWdlLnJlbW92ZSgncHJldmlvdXNfd2Vic29ja2V0X2ZhaWx1cmUnKTtcbiAgICB9O1xuICAgIFdlYlNvY2tldENvbm5lY3Rpb24ucHJvdG90eXBlLmFwcGVuZEZyYW1lXyA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHRoaXMuZnJhbWVzLnB1c2goZGF0YSk7XG4gICAgICAgIGlmICh0aGlzLmZyYW1lcy5sZW5ndGggPT0gdGhpcy50b3RhbEZyYW1lcykge1xuICAgICAgICAgICAgdmFyIGZ1bGxNZXNzID0gdGhpcy5mcmFtZXMuam9pbignJyk7XG4gICAgICAgICAgICB0aGlzLmZyYW1lcyA9IG51bGw7XG4gICAgICAgICAgICB2YXIganNvbk1lc3MgPSB1dGlsXzQuanNvbkV2YWwoZnVsbE1lc3MpO1xuICAgICAgICAgICAgLy9oYW5kbGUgdGhlIG1lc3NhZ2VcbiAgICAgICAgICAgIHRoaXMub25NZXNzYWdlKGpzb25NZXNzKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGZyYW1lQ291bnQgVGhlIG51bWJlciBvZiBmcmFtZXMgd2UgYXJlIGV4cGVjdGluZyBmcm9tIHRoZSBzZXJ2ZXJcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIFdlYlNvY2tldENvbm5lY3Rpb24ucHJvdG90eXBlLmhhbmRsZU5ld0ZyYW1lQ291bnRfID0gZnVuY3Rpb24gKGZyYW1lQ291bnQpIHtcbiAgICAgICAgdGhpcy50b3RhbEZyYW1lcyA9IGZyYW1lQ291bnQ7XG4gICAgICAgIHRoaXMuZnJhbWVzID0gW107XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBBdHRlbXB0cyB0byBwYXJzZSBhIGZyYW1lIGNvdW50IG91dCBvZiBzb21lIHRleHQuIElmIGl0IGNhbid0LCBhc3N1bWVzIGEgdmFsdWUgb2YgMVxuICAgICAqIEBwYXJhbSB7IVN0cmluZ30gZGF0YVxuICAgICAqIEByZXR1cm4gez9TdHJpbmd9IEFueSByZW1haW5pbmcgZGF0YSB0byBiZSBwcm9jZXNzLCBvciBudWxsIGlmIHRoZXJlIGlzIG5vbmVcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIFdlYlNvY2tldENvbm5lY3Rpb24ucHJvdG90eXBlLmV4dHJhY3RGcmFtZUNvdW50XyA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHV0aWxfMS5hc3NlcnQodGhpcy5mcmFtZXMgPT09IG51bGwsICdXZSBhbHJlYWR5IGhhdmUgYSBmcmFtZSBidWZmZXInKTtcbiAgICAgICAgLy8gVE9ETzogVGhlIHNlcnZlciBpcyBvbmx5IHN1cHBvc2VkIHRvIHNlbmQgdXAgdG8gOTk5OSBmcmFtZXMgKGkuZS4gbGVuZ3RoIDw9IDQpLCBidXQgdGhhdCBpc24ndCBiZWluZyBlbmZvcmNlZFxuICAgICAgICAvLyBjdXJyZW50bHkuICBTbyBhbGxvd2luZyBsYXJnZXIgZnJhbWUgY291bnRzIChsZW5ndGggPD0gNikuICBTZWUgaHR0cHM6Ly9hcHAuYXNhbmEuY29tLzAvc2VhcmNoLzg2ODg1OTg5OTgzODAvODIzNzYwODA0MjUwOFxuICAgICAgICBpZiAoZGF0YS5sZW5ndGggPD0gNikge1xuICAgICAgICAgICAgdmFyIGZyYW1lQ291bnQgPSBOdW1iZXIoZGF0YSk7XG4gICAgICAgICAgICBpZiAoIWlzTmFOKGZyYW1lQ291bnQpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVOZXdGcmFtZUNvdW50XyhmcmFtZUNvdW50KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLmhhbmRsZU5ld0ZyYW1lQ291bnRfKDEpO1xuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFByb2Nlc3MgYSB3ZWJzb2NrZXQgZnJhbWUgdGhhdCBoYXMgYXJyaXZlZCBmcm9tIHRoZSBzZXJ2ZXIuXG4gICAgICogQHBhcmFtIG1lc3MgVGhlIGZyYW1lIGRhdGFcbiAgICAgKi9cbiAgICBXZWJTb2NrZXRDb25uZWN0aW9uLnByb3RvdHlwZS5oYW5kbGVJbmNvbWluZ0ZyYW1lID0gZnVuY3Rpb24gKG1lc3MpIHtcbiAgICAgICAgaWYgKHRoaXMubXlTb2NrID09PSBudWxsKVxuICAgICAgICAgICAgcmV0dXJuOyAvLyBDaHJvbWUgYXBwYXJlbnRseSBkZWxpdmVycyBpbmNvbWluZyBwYWNrZXRzIGV2ZW4gYWZ0ZXIgd2UgLmNsb3NlKCkgdGhlIGNvbm5lY3Rpb24gc29tZXRpbWVzLlxuICAgICAgICB2YXIgZGF0YSA9IG1lc3NbJ2RhdGEnXTtcbiAgICAgICAgdGhpcy5ieXRlc1JlY2VpdmVkICs9IGRhdGEubGVuZ3RoO1xuICAgICAgICB0aGlzLnN0YXRzXy5pbmNyZW1lbnRDb3VudGVyKCdieXRlc19yZWNlaXZlZCcsIGRhdGEubGVuZ3RoKTtcbiAgICAgICAgdGhpcy5yZXNldEtlZXBBbGl2ZSgpO1xuICAgICAgICBpZiAodGhpcy5mcmFtZXMgIT09IG51bGwpIHtcbiAgICAgICAgICAgIC8vIHdlJ3JlIGJ1ZmZlcmluZ1xuICAgICAgICAgICAgdGhpcy5hcHBlbmRGcmFtZV8oZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyB0cnkgdG8gcGFyc2Ugb3V0IGEgZnJhbWUgY291bnQsIG90aGVyd2lzZSwgYXNzdW1lIDEgYW5kIHByb2Nlc3MgaXRcbiAgICAgICAgICAgIHZhciByZW1haW5pbmdEYXRhID0gdGhpcy5leHRyYWN0RnJhbWVDb3VudF8oZGF0YSk7XG4gICAgICAgICAgICBpZiAocmVtYWluaW5nRGF0YSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwZW5kRnJhbWVfKHJlbWFpbmluZ0RhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBTZW5kIGEgbWVzc2FnZSB0byB0aGUgc2VydmVyXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGEgVGhlIEpTT04gb2JqZWN0IHRvIHRyYW5zbWl0XG4gICAgICovXG4gICAgV2ViU29ja2V0Q29ubmVjdGlvbi5wcm90b3R5cGUuc2VuZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHRoaXMucmVzZXRLZWVwQWxpdmUoKTtcbiAgICAgICAgdmFyIGRhdGFTdHIgPSB1dGlsXzQuc3RyaW5naWZ5KGRhdGEpO1xuICAgICAgICB0aGlzLmJ5dGVzU2VudCArPSBkYXRhU3RyLmxlbmd0aDtcbiAgICAgICAgdGhpcy5zdGF0c18uaW5jcmVtZW50Q291bnRlcignYnl0ZXNfc2VudCcsIGRhdGFTdHIubGVuZ3RoKTtcbiAgICAgICAgLy9XZSBjYW4gb25seSBmaXQgYSBjZXJ0YWluIGFtb3VudCBpbiBlYWNoIHdlYnNvY2tldCBmcmFtZSwgc28gd2UgbmVlZCB0byBzcGxpdCB0aGlzIHJlcXVlc3RcbiAgICAgICAgLy91cCBpbnRvIG11bHRpcGxlIHBpZWNlcyBpZiBpdCBkb2Vzbid0IGZpdCBpbiBvbmUgcmVxdWVzdC5cbiAgICAgICAgdmFyIGRhdGFTZWdzID0gdXRpbF8yLnNwbGl0U3RyaW5nQnlTaXplKGRhdGFTdHIsIFdFQlNPQ0tFVF9NQVhfRlJBTUVfU0laRSk7XG4gICAgICAgIC8vU2VuZCB0aGUgbGVuZ3RoIGhlYWRlclxuICAgICAgICBpZiAoZGF0YVNlZ3MubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgdGhpcy5zZW5kU3RyaW5nXyhTdHJpbmcoZGF0YVNlZ3MubGVuZ3RoKSk7XG4gICAgICAgIH1cbiAgICAgICAgLy9TZW5kIHRoZSBhY3R1YWwgZGF0YSBpbiBzZWdtZW50cy5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhU2Vncy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5zZW5kU3RyaW5nXyhkYXRhU2Vnc1tpXSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFdlYlNvY2tldENvbm5lY3Rpb24ucHJvdG90eXBlLnNodXRkb3duXyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5pc0Nsb3NlZF8gPSB0cnVlO1xuICAgICAgICBpZiAodGhpcy5rZWVwYWxpdmVUaW1lcikge1xuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmtlZXBhbGl2ZVRpbWVyKTtcbiAgICAgICAgICAgIHRoaXMua2VlcGFsaXZlVGltZXIgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm15U29jaykge1xuICAgICAgICAgICAgdGhpcy5teVNvY2suY2xvc2UoKTtcbiAgICAgICAgICAgIHRoaXMubXlTb2NrID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgV2ViU29ja2V0Q29ubmVjdGlvbi5wcm90b3R5cGUub25DbG9zZWRfID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuaXNDbG9zZWRfKSB7XG4gICAgICAgICAgICB0aGlzLmxvZ18oJ1dlYlNvY2tldCBpcyBjbG9zaW5nIGl0c2VsZicpO1xuICAgICAgICAgICAgdGhpcy5zaHV0ZG93bl8oKTtcbiAgICAgICAgICAgIC8vIHNpbmNlIHRoaXMgaXMgYW4gaW50ZXJuYWwgY2xvc2UsIHRyaWdnZXIgdGhlIGNsb3NlIGxpc3RlbmVyXG4gICAgICAgICAgICBpZiAodGhpcy5vbkRpc2Nvbm5lY3QpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9uRGlzY29ubmVjdCh0aGlzLmV2ZXJDb25uZWN0ZWRfKTtcbiAgICAgICAgICAgICAgICB0aGlzLm9uRGlzY29ubmVjdCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEV4dGVybmFsLWZhY2luZyBjbG9zZSBoYW5kbGVyLlxuICAgICAqIENsb3NlIHRoZSB3ZWJzb2NrZXQgYW5kIGtpbGwgdGhlIGNvbm5lY3Rpb24uXG4gICAgICovXG4gICAgV2ViU29ja2V0Q29ubmVjdGlvbi5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5pc0Nsb3NlZF8pIHtcbiAgICAgICAgICAgIHRoaXMubG9nXygnV2ViU29ja2V0IGlzIGJlaW5nIGNsb3NlZCcpO1xuICAgICAgICAgICAgdGhpcy5zaHV0ZG93bl8oKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogS2lsbCB0aGUgY3VycmVudCBrZWVwYWxpdmUgdGltZXIgYW5kIHN0YXJ0IGEgbmV3IG9uZSwgdG8gZW5zdXJlIHRoYXQgaXQgYWx3YXlzIGZpcmVzIE4gc2Vjb25kcyBhZnRlclxuICAgICAqIHRoZSBsYXN0IGFjdGl2aXR5LlxuICAgICAqL1xuICAgIFdlYlNvY2tldENvbm5lY3Rpb24ucHJvdG90eXBlLnJlc2V0S2VlcEFsaXZlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBjbGVhckludGVydmFsKHRoaXMua2VlcGFsaXZlVGltZXIpO1xuICAgICAgICB0aGlzLmtlZXBhbGl2ZVRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy9JZiB0aGVyZSBoYXMgYmVlbiBubyB3ZWJzb2NrZXQgYWN0aXZpdHkgZm9yIGEgd2hpbGUsIHNlbmQgYSBuby1vcFxuICAgICAgICAgICAgaWYgKF90aGlzLm15U29jaykge1xuICAgICAgICAgICAgICAgIF90aGlzLnNlbmRTdHJpbmdfKCcwJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfdGhpcy5yZXNldEtlZXBBbGl2ZSgpO1xuICAgICAgICB9LCBNYXRoLmZsb29yKFdFQlNPQ0tFVF9LRUVQQUxJVkVfSU5URVJWQUwpKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFNlbmQgYSBzdHJpbmcgb3ZlciB0aGUgd2Vic29ja2V0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHN0ciBTdHJpbmcgdG8gc2VuZC5cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIFdlYlNvY2tldENvbm5lY3Rpb24ucHJvdG90eXBlLnNlbmRTdHJpbmdfID0gZnVuY3Rpb24gKHN0cikge1xuICAgICAgICAvLyBGaXJlZm94IHNlZW1zIHRvIHNvbWV0aW1lcyB0aHJvdyBleGNlcHRpb25zIChOU19FUlJPUl9VTkVYUEVDVEVEKSBmcm9tIHdlYnNvY2tldCAuc2VuZCgpXG4gICAgICAgIC8vIGNhbGxzIGZvciBzb21lIHVua25vd24gcmVhc29uLiAgV2UgdHJlYXQgdGhlc2UgYXMgYW4gZXJyb3IgYW5kIGRpc2Nvbm5lY3QuXG4gICAgICAgIC8vIFNlZSBodHRwczovL2FwcC5hc2FuYS5jb20vMC81ODkyNjExMTQwMjI5Mi82ODAyMTM0MDI1MDQxMFxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdGhpcy5teVNvY2suc2VuZChzdHIpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICB0aGlzLmxvZ18oJ0V4Y2VwdGlvbiB0aHJvd24gZnJvbSBXZWJTb2NrZXQuc2VuZCgpOicsIGUubWVzc2FnZSB8fCBlLmRhdGEsICdDbG9zaW5nIGNvbm5lY3Rpb24uJyk7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KHRoaXMub25DbG9zZWRfLmJpbmQodGhpcyksIDApO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBOdW1iZXIgb2YgcmVzcG9uc2UgYmVmb3JlIHdlIGNvbnNpZGVyIHRoZSBjb25uZWN0aW9uIFwiaGVhbHRoeS5cIlxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICovXG4gICAgV2ViU29ja2V0Q29ubmVjdGlvbi5yZXNwb25zZXNSZXF1aXJlZFRvQmVIZWFsdGh5ID0gMjtcbiAgICAvKipcbiAgICAgKiBUaW1lIHRvIHdhaXQgZm9yIHRoZSBjb25uZWN0aW9uIHRlIGJlY29tZSBoZWFsdGh5IGJlZm9yZSBnaXZpbmcgdXAuXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKi9cbiAgICBXZWJTb2NrZXRDb25uZWN0aW9uLmhlYWx0aHlUaW1lb3V0ID0gMzAwMDA7XG4gICAgcmV0dXJuIFdlYlNvY2tldENvbm5lY3Rpb247XG59KCkpO1xuZXhwb3J0cy5XZWJTb2NrZXRDb25uZWN0aW9uID0gV2ViU29ja2V0Q29ubmVjdGlvbjtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9V2ViU29ja2V0Q29ubmVjdGlvbi5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB1dGlsXzEgPSByZXF1aXJlKFwiLi4vLi4vY29yZS91dGlsL3V0aWxcIik7XG4vKipcbiAqIFRoaXMgY2xhc3MgZW5zdXJlcyB0aGUgcGFja2V0cyBmcm9tIHRoZSBzZXJ2ZXIgYXJyaXZlIGluIG9yZGVyXG4gKiBUaGlzIGNsYXNzIHRha2VzIGRhdGEgZnJvbSB0aGUgc2VydmVyIGFuZCBlbnN1cmVzIGl0IGdldHMgcGFzc2VkIGludG8gdGhlIGNhbGxiYWNrcyBpbiBvcmRlci5cbiAqIEBjb25zdHJ1Y3RvclxuICovXG52YXIgUGFja2V0UmVjZWl2ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIG9uTWVzc2FnZV9cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBQYWNrZXRSZWNlaXZlcihvbk1lc3NhZ2VfKSB7XG4gICAgICAgIHRoaXMub25NZXNzYWdlXyA9IG9uTWVzc2FnZV87XG4gICAgICAgIHRoaXMucGVuZGluZ1Jlc3BvbnNlcyA9IFtdO1xuICAgICAgICB0aGlzLmN1cnJlbnRSZXNwb25zZU51bSA9IDA7XG4gICAgICAgIHRoaXMuY2xvc2VBZnRlclJlc3BvbnNlID0gLTE7XG4gICAgICAgIHRoaXMub25DbG9zZSA9IG51bGw7XG4gICAgfVxuICAgIFBhY2tldFJlY2VpdmVyLnByb3RvdHlwZS5jbG9zZUFmdGVyID0gZnVuY3Rpb24gKHJlc3BvbnNlTnVtLCBjYWxsYmFjaykge1xuICAgICAgICB0aGlzLmNsb3NlQWZ0ZXJSZXNwb25zZSA9IHJlc3BvbnNlTnVtO1xuICAgICAgICB0aGlzLm9uQ2xvc2UgPSBjYWxsYmFjaztcbiAgICAgICAgaWYgKHRoaXMuY2xvc2VBZnRlclJlc3BvbnNlIDwgdGhpcy5jdXJyZW50UmVzcG9uc2VOdW0pIHtcbiAgICAgICAgICAgIHRoaXMub25DbG9zZSgpO1xuICAgICAgICAgICAgdGhpcy5vbkNsb3NlID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogRWFjaCBtZXNzYWdlIGZyb20gdGhlIHNlcnZlciBjb21lcyB3aXRoIGEgcmVzcG9uc2UgbnVtYmVyLCBhbmQgYW4gYXJyYXkgb2YgZGF0YS4gVGhlIHJlc3BvbnNlTnVtYmVyXG4gICAgICogYWxsb3dzIHVzIHRvIGVuc3VyZSB0aGF0IHdlIHByb2Nlc3MgdGhlbSBpbiB0aGUgcmlnaHQgb3JkZXIsIHNpbmNlIHdlIGNhbid0IGJlIGd1YXJhbnRlZWQgdGhhdCBhbGxcbiAgICAgKiBicm93c2VycyB3aWxsIHJlc3BvbmQgaW4gdGhlIHNhbWUgb3JkZXIgYXMgdGhlIHJlcXVlc3RzIHdlIHNlbnRcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gcmVxdWVzdE51bVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGRhdGFcbiAgICAgKi9cbiAgICBQYWNrZXRSZWNlaXZlci5wcm90b3R5cGUuaGFuZGxlUmVzcG9uc2UgPSBmdW5jdGlvbiAocmVxdWVzdE51bSwgZGF0YSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnBlbmRpbmdSZXNwb25zZXNbcmVxdWVzdE51bV0gPSBkYXRhO1xuICAgICAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0b1Byb2Nlc3MgPSB0aGlzXzEucGVuZGluZ1Jlc3BvbnNlc1t0aGlzXzEuY3VycmVudFJlc3BvbnNlTnVtXTtcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzXzEucGVuZGluZ1Jlc3BvbnNlc1t0aGlzXzEuY3VycmVudFJlc3BvbnNlTnVtXTtcbiAgICAgICAgICAgIHZhciBfbG9vcF8yID0gZnVuY3Rpb24gKGkpIHtcbiAgICAgICAgICAgICAgICBpZiAodG9Qcm9jZXNzW2ldKSB7XG4gICAgICAgICAgICAgICAgICAgIHV0aWxfMS5leGNlcHRpb25HdWFyZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5vbk1lc3NhZ2VfKHRvUHJvY2Vzc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRvUHJvY2Vzcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICAgIF9sb29wXzIoaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpc18xLmN1cnJlbnRSZXNwb25zZU51bSA9PT0gdGhpc18xLmNsb3NlQWZ0ZXJSZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzXzEub25DbG9zZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzXzEub25DbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzXzEub25DbG9zZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBcImJyZWFrXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzXzEuY3VycmVudFJlc3BvbnNlTnVtKys7XG4gICAgICAgIH07XG4gICAgICAgIHZhciB0aGlzXzEgPSB0aGlzO1xuICAgICAgICB3aGlsZSAodGhpcy5wZW5kaW5nUmVzcG9uc2VzW3RoaXMuY3VycmVudFJlc3BvbnNlTnVtXSkge1xuICAgICAgICAgICAgdmFyIHN0YXRlXzEgPSBfbG9vcF8xKCk7XG4gICAgICAgICAgICBpZiAoc3RhdGVfMSA9PT0gXCJicmVha1wiKVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gUGFja2V0UmVjZWl2ZXI7XG59KCkpO1xuZXhwb3J0cy5QYWNrZXRSZWNlaXZlciA9IFBhY2tldFJlY2VpdmVyO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1QYWNrZXRSZWNlaXZlci5qcy5tYXBcbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4ndXNlIHN0cmljdCc7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgd2luZG93X2NvbnRyb2xsZXJfMSA9IHJlcXVpcmUoXCIuL3NyYy9jb250cm9sbGVycy93aW5kb3ctY29udHJvbGxlclwiKTtcbnZhciBzd19jb250cm9sbGVyXzEgPSByZXF1aXJlKFwiLi9zcmMvY29udHJvbGxlcnMvc3ctY29udHJvbGxlclwiKTtcbnZhciBhcHBfMSA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvYXBwXCIpO1xuZnVuY3Rpb24gcmVnaXN0ZXJNZXNzYWdpbmcoaW5zdGFuY2UpIHtcbiAgICB2YXIgbWVzc2FnaW5nTmFtZSA9ICdtZXNzYWdpbmcnO1xuICAgIHZhciBmYWN0b3J5TWV0aG9kID0gZnVuY3Rpb24gKGFwcCkge1xuICAgICAgICBpZiAoc2VsZiAmJiAnU2VydmljZVdvcmtlckdsb2JhbFNjb3BlJyBpbiBzZWxmKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IHN3X2NvbnRyb2xsZXJfMS5kZWZhdWx0KGFwcCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQXNzdW1lIHdlIGFyZSBpbiB0aGUgd2luZG93IGNvbnRleHQuXG4gICAgICAgIHJldHVybiBuZXcgd2luZG93X2NvbnRyb2xsZXJfMS5kZWZhdWx0KGFwcCk7XG4gICAgfTtcbiAgICB2YXIgbmFtZXNwYWNlRXhwb3J0cyA9IHtcbiAgICAgICAgLy8gbm8taW5saW5lXG4gICAgICAgIE1lc3NhZ2luZzogd2luZG93X2NvbnRyb2xsZXJfMS5kZWZhdWx0XG4gICAgfTtcbiAgICBpbnN0YW5jZS5JTlRFUk5BTC5yZWdpc3RlclNlcnZpY2UobWVzc2FnaW5nTmFtZSwgZmFjdG9yeU1ldGhvZCwgbmFtZXNwYWNlRXhwb3J0cyk7XG59XG5leHBvcnRzLnJlZ2lzdGVyTWVzc2FnaW5nID0gcmVnaXN0ZXJNZXNzYWdpbmc7XG5yZWdpc3Rlck1lc3NhZ2luZyhhcHBfMS5kZWZhdWx0KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwXG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuJ3VzZSBzdHJpY3QnO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHV0aWxfMSA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvdXRpbFwiKTtcbnZhciBlcnJvcnNfMSA9IHJlcXVpcmUoXCIuLi9tb2RlbHMvZXJyb3JzXCIpO1xudmFyIHRva2VuX21hbmFnZXJfMSA9IHJlcXVpcmUoXCIuLi9tb2RlbHMvdG9rZW4tbWFuYWdlclwiKTtcbnZhciBub3RpZmljYXRpb25fcGVybWlzc2lvbl8xID0gcmVxdWlyZShcIi4uL21vZGVscy9ub3RpZmljYXRpb24tcGVybWlzc2lvblwiKTtcbnZhciBTRU5ERVJfSURfT1BUSU9OX05BTUUgPSAnbWVzc2FnaW5nU2VuZGVySWQnO1xudmFyIENvbnRyb2xsZXJJbnRlcmZhY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQW4gaW50ZXJmYWNlIG9mIHRoZSBNZXNzYWdpbmcgU2VydmljZSBBUElcbiAgICAgKiBAcGFyYW0geyFmaXJlYmFzZS5hcHAuQXBwfSBhcHBcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBDb250cm9sbGVySW50ZXJmYWNlKGFwcCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLmVycm9yRmFjdG9yeV8gPSBuZXcgdXRpbF8xLkVycm9yRmFjdG9yeSgnbWVzc2FnaW5nJywgJ01lc3NhZ2luZycsIGVycm9yc18xLmRlZmF1bHQubWFwKTtcbiAgICAgICAgaWYgKCFhcHAub3B0aW9uc1tTRU5ERVJfSURfT1BUSU9OX05BTUVdIHx8XG4gICAgICAgICAgICB0eXBlb2YgYXBwLm9wdGlvbnNbU0VOREVSX0lEX09QVElPTl9OQU1FXSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIHRocm93IHRoaXMuZXJyb3JGYWN0b3J5Xy5jcmVhdGUoZXJyb3JzXzEuZGVmYXVsdC5jb2Rlcy5CQURfU0VOREVSX0lEKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1lc3NhZ2luZ1NlbmRlcklkXyA9IGFwcC5vcHRpb25zW1NFTkRFUl9JRF9PUFRJT05fTkFNRV07XG4gICAgICAgIHRoaXMudG9rZW5NYW5hZ2VyXyA9IG5ldyB0b2tlbl9tYW5hZ2VyXzEuZGVmYXVsdCgpO1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICAgICAgdGhpcy5JTlRFUk5BTCA9IHt9O1xuICAgICAgICB0aGlzLklOVEVSTkFMLmRlbGV0ZSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmRlbGV0ZTsgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGV4cG9ydFxuICAgICAqIEByZXR1cm4ge1Byb21pc2U8c3RyaW5nPiB8IFByb21pc2U8bnVsbD59IFJldHVybnMgYSBwcm9taXNlIHRoYXRcbiAgICAgKiByZXNvbHZlcyB0byBhbiBGQ00gdG9rZW4uXG4gICAgICovXG4gICAgQ29udHJvbGxlckludGVyZmFjZS5wcm90b3R5cGUuZ2V0VG9rZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIC8vIENoZWNrIHdpdGggcGVybWlzc2lvbnNcbiAgICAgICAgdmFyIGN1cnJlbnRQZXJtaXNzaW9uID0gdGhpcy5nZXROb3RpZmljYXRpb25QZXJtaXNzaW9uXygpO1xuICAgICAgICBpZiAoY3VycmVudFBlcm1pc3Npb24gIT09IG5vdGlmaWNhdGlvbl9wZXJtaXNzaW9uXzEuZGVmYXVsdC5ncmFudGVkKSB7XG4gICAgICAgICAgICBpZiAoY3VycmVudFBlcm1pc3Npb24gPT09IG5vdGlmaWNhdGlvbl9wZXJtaXNzaW9uXzEuZGVmYXVsdC5kZW5pZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QodGhpcy5lcnJvckZhY3RvcnlfLmNyZWF0ZShlcnJvcnNfMS5kZWZhdWx0LmNvZGVzLk5PVElGSUNBVElPTlNfQkxPQ0tFRCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gV2UgbXVzdCB3YWl0IGZvciBwZXJtaXNzaW9uIHRvIGJlIGdyYW50ZWRcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobnVsbCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U1dSZWdpc3RyYXRpb25fKCkudGhlbihmdW5jdGlvbiAocmVnaXN0cmF0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4gX3RoaXMudG9rZW5NYW5hZ2VyX1xuICAgICAgICAgICAgICAgIC5nZXRTYXZlZFRva2VuKF90aGlzLm1lc3NhZ2luZ1NlbmRlcklkXywgcmVnaXN0cmF0aW9uKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICAgICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdG9rZW47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy50b2tlbk1hbmFnZXJfLmNyZWF0ZVRva2VuKF90aGlzLm1lc3NhZ2luZ1NlbmRlcklkXywgcmVnaXN0cmF0aW9uKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGRlbGV0ZXMgdG9rZW5zIHRoYXQgdGhlIHRva2VuIG1hbmFnZXIgbG9va3MgYWZ0ZXIgYW5kIHRoZW5cbiAgICAgKiB1bnJlZ2lzdGVycyB0aGUgcHVzaCBzdWJzY3JpcHRpb24gaWYgaXQgZXhpc3RzLlxuICAgICAqIEBleHBvcnRcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdG9rZW5cbiAgICAgKiBAcmV0dXJuIHtQcm9taXNlPHZvaWQ+fVxuICAgICAqL1xuICAgIENvbnRyb2xsZXJJbnRlcmZhY2UucHJvdG90eXBlLmRlbGV0ZVRva2VuID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiB0aGlzLnRva2VuTWFuYWdlcl8uZGVsZXRlVG9rZW4odG9rZW4pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmdldFNXUmVnaXN0cmF0aW9uXygpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlZ2lzdHJhdGlvbikge1xuICAgICAgICAgICAgICAgIGlmIChyZWdpc3RyYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2lzdHJhdGlvbi5wdXNoTWFuYWdlci5nZXRTdWJzY3JpcHRpb24oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChzdWJzY3JpcHRpb24pIHtcbiAgICAgICAgICAgICAgICBpZiAoc3Vic2NyaXB0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBDb250cm9sbGVySW50ZXJmYWNlLnByb3RvdHlwZS5nZXRTV1JlZ2lzdHJhdGlvbl8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRocm93IHRoaXMuZXJyb3JGYWN0b3J5Xy5jcmVhdGUoZXJyb3JzXzEuZGVmYXVsdC5jb2Rlcy5TSE9VTERfQkVfSU5IRVJJVEVEKTtcbiAgICB9O1xuICAgIC8vXG4gICAgLy8gVGhlIGZvbGxvd2luZyBtZXRob2RzIHNob3VsZCBvbmx5IGJlIGF2YWlsYWJsZSBpbiB0aGUgd2luZG93LlxuICAgIC8vXG4gICAgQ29udHJvbGxlckludGVyZmFjZS5wcm90b3R5cGUucmVxdWVzdFBlcm1pc3Npb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRocm93IHRoaXMuZXJyb3JGYWN0b3J5Xy5jcmVhdGUoZXJyb3JzXzEuZGVmYXVsdC5jb2Rlcy5BVkFJTEFCTEVfSU5fV0lORE9XKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBleHBvcnRcbiAgICAgKiBAcGFyYW0geyFTZXJ2aWNlV29ya2VyUmVnaXN0cmF0aW9ufSByZWdpc3RyYXRpb25cbiAgICAgKi9cbiAgICBDb250cm9sbGVySW50ZXJmYWNlLnByb3RvdHlwZS51c2VTZXJ2aWNlV29ya2VyID0gZnVuY3Rpb24gKHJlZ2lzdHJhdGlvbikge1xuICAgICAgICB0aHJvdyB0aGlzLmVycm9yRmFjdG9yeV8uY3JlYXRlKGVycm9yc18xLmRlZmF1bHQuY29kZXMuQVZBSUxBQkxFX0lOX1dJTkRPVyk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAZXhwb3J0XG4gICAgICogQHBhcmFtIHshZmlyZWJhc2UuT2JzZXJ2ZXJ8ZnVuY3Rpb24oKil9IG5leHRPck9ic2VydmVyXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbighRXJyb3IpPX0gb3B0RXJyb3JcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKCk9fSBvcHRDb21wbGV0ZWRcbiAgICAgKiBAcmV0dXJuIHshZnVuY3Rpb24oKX1cbiAgICAgKi9cbiAgICBDb250cm9sbGVySW50ZXJmYWNlLnByb3RvdHlwZS5vbk1lc3NhZ2UgPSBmdW5jdGlvbiAobmV4dE9yT2JzZXJ2ZXIsIG9wdEVycm9yLCBvcHRDb21wbGV0ZWQpIHtcbiAgICAgICAgdGhyb3cgdGhpcy5lcnJvckZhY3RvcnlfLmNyZWF0ZShlcnJvcnNfMS5kZWZhdWx0LmNvZGVzLkFWQUlMQUJMRV9JTl9XSU5ET1cpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQGV4cG9ydFxuICAgICAqIEBwYXJhbSB7IWZpcmViYXNlLk9ic2VydmVyfGZ1bmN0aW9uKCl9IG5leHRPck9ic2VydmVyIEFuIG9ic2VydmVyIG9iamVjdFxuICAgICAqIG9yIGEgZnVuY3Rpb24gdHJpZ2dlcmVkIG9uIHRva2VuIHJlZnJlc2guXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbighRXJyb3IpPX0gb3B0RXJyb3IgT3B0aW9uYWwgQSBmdW5jdGlvblxuICAgICAqIHRyaWdnZXJlZCBvbiB0b2tlbiByZWZyZXNoIGVycm9yLlxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oKT19IG9wdENvbXBsZXRlZCBPcHRpb25hbCBmdW5jdGlvbiB0cmlnZ2VyZWQgd2hlbiB0aGVcbiAgICAgKiBvYnNlcnZlciBpcyByZW1vdmVkLlxuICAgICAqIEByZXR1cm4geyFmdW5jdGlvbigpfSBUaGUgdW5zdWJzY3JpYmUgZnVuY3Rpb24gZm9yIHRoZSBvYnNlcnZlci5cbiAgICAgKi9cbiAgICBDb250cm9sbGVySW50ZXJmYWNlLnByb3RvdHlwZS5vblRva2VuUmVmcmVzaCA9IGZ1bmN0aW9uIChuZXh0T3JPYnNlcnZlciwgb3B0RXJyb3IsIG9wdENvbXBsZXRlZCkge1xuICAgICAgICB0aHJvdyB0aGlzLmVycm9yRmFjdG9yeV8uY3JlYXRlKGVycm9yc18xLmRlZmF1bHQuY29kZXMuQVZBSUxBQkxFX0lOX1dJTkRPVyk7XG4gICAgfTtcbiAgICAvL1xuICAgIC8vIFRoZSBmb2xsb3dpbmcgbWV0aG9kcyBhcmUgdXNlZCBieSB0aGUgc2VydmljZSB3b3JrZXIgb25seS5cbiAgICAvL1xuICAgIC8qKlxuICAgICAqIEBleHBvcnRcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKE9iamVjdCl9IGNhbGxiYWNrXG4gICAgICovXG4gICAgQ29udHJvbGxlckludGVyZmFjZS5wcm90b3R5cGUuc2V0QmFja2dyb3VuZE1lc3NhZ2VIYW5kbGVyID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHRocm93IHRoaXMuZXJyb3JGYWN0b3J5Xy5jcmVhdGUoZXJyb3JzXzEuZGVmYXVsdC5jb2Rlcy5BVkFJTEFCTEVfSU5fU1cpO1xuICAgIH07XG4gICAgLy9cbiAgICAvLyBUaGUgZm9sbG93aW5nIG1ldGhvZHMgYXJlIHVzZWQgYnkgdGhlIHNlcnZpY2UgdGhlbXNlbHZlcyBhbmQgbm90IGV4cG9zZWRcbiAgICAvLyBwdWJsaWNseSBvciBub3QgZXhwZWN0ZWQgdG8gYmUgdXNlZCBieSBkZXZlbG9wZXJzLlxuICAgIC8vXG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgaXMgcmVxdWlyZWQgdG8gYWRoZXJlIHRvIHRoZSBGaXJlYmFzZSBpbnRlcmZhY2UuXG4gICAgICogSXQgY2xvc2VzIGFueSBjdXJyZW50bHkgb3BlbiBpbmRleGRiIGRhdGFiYXNlIGNvbm5lY3Rpb25zLlxuICAgICAqL1xuICAgIENvbnRyb2xsZXJJbnRlcmZhY2UucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudG9rZW5NYW5hZ2VyXy5jbG9zZURhdGFiYXNlKCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBjdXJyZW50IE5vdGlmaWNhdGlvbiBQZXJtaXNzaW9uIHN0YXRlLlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHJldHVybiB7c3RyaW5nfSBUaGUgY3VycmVuY3QgcGVybWlzc2lvbiBzdGF0ZS5cbiAgICAgKi9cbiAgICBDb250cm9sbGVySW50ZXJmYWNlLnByb3RvdHlwZS5nZXROb3RpZmljYXRpb25QZXJtaXNzaW9uXyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIE5vdGlmaWNhdGlvbi5wZXJtaXNzaW9uO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqIEByZXR1cm5zIHtUb2tlbk1hbmFnZXJ9XG4gICAgICovXG4gICAgQ29udHJvbGxlckludGVyZmFjZS5wcm90b3R5cGUuZ2V0VG9rZW5NYW5hZ2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50b2tlbk1hbmFnZXJfO1xuICAgIH07XG4gICAgcmV0dXJuIENvbnRyb2xsZXJJbnRlcmZhY2U7XG59KCkpO1xuZXhwb3J0cy5kZWZhdWx0ID0gQ29udHJvbGxlckludGVyZmFjZTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y29udHJvbGxlci1pbnRlcmZhY2UuanMubWFwXG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgY29udHJvbGxlcl9pbnRlcmZhY2VfMSA9IHJlcXVpcmUoXCIuL2NvbnRyb2xsZXItaW50ZXJmYWNlXCIpO1xudmFyIGVycm9yc18xID0gcmVxdWlyZShcIi4uL21vZGVscy9lcnJvcnNcIik7XG52YXIgd29ya2VyX3BhZ2VfbWVzc2FnZV8xID0gcmVxdWlyZShcIi4uL21vZGVscy93b3JrZXItcGFnZS1tZXNzYWdlXCIpO1xudmFyIGZjbV9kZXRhaWxzXzEgPSByZXF1aXJlKFwiLi4vbW9kZWxzL2ZjbS1kZXRhaWxzXCIpO1xudmFyIEZDTV9NU0cgPSAnRkNNX01TRyc7XG52YXIgU1dDb250cm9sbGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTV0NvbnRyb2xsZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU1dDb250cm9sbGVyKGFwcCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBhcHApIHx8IHRoaXM7XG4gICAgICAgIHNlbGYuYWRkRXZlbnRMaXN0ZW5lcigncHVzaCcsIGZ1bmN0aW9uIChlKSB7IHJldHVybiBfdGhpcy5vblB1c2hfKGUpOyB9LCBmYWxzZSk7XG4gICAgICAgIHNlbGYuYWRkRXZlbnRMaXN0ZW5lcigncHVzaHN1YnNjcmlwdGlvbmNoYW5nZScsIGZ1bmN0aW9uIChlKSB7IHJldHVybiBfdGhpcy5vblN1YkNoYW5nZV8oZSk7IH0sIGZhbHNlKTtcbiAgICAgICAgc2VsZi5hZGRFdmVudExpc3RlbmVyKCdub3RpZmljYXRpb25jbGljaycsIGZ1bmN0aW9uIChlKSB7IHJldHVybiBfdGhpcy5vbk5vdGlmaWNhdGlvbkNsaWNrXyhlKTsgfSwgZmFsc2UpO1xuICAgICAgICAvKipcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQHR5cGUge2Z1bmN0aW9uKE9iamVjdCl8bnVsbH1cbiAgICAgICAgICovXG4gICAgICAgIF90aGlzLmJnTWVzc2FnZUhhbmRsZXJfID0gbnVsbDtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAqIEEgaGFuZGxlciBmb3IgcHVzaCBldmVudHMgdGhhdCBzaG93cyBub3RpZmljYXRpb25zIGJhc2VkIG9uIHRoZSBjb250ZW50IG9mXG4gICAgKiB0aGUgcGF5bG9hZC5cbiAgICAqXG4gICAgKiBUaGUgcGF5bG9hZCBtdXN0IGJlIGEgSlNPTi1lbmNvZGVkIE9iamVjdCB3aXRoIGEgYG5vdGlmaWNhdGlvbmAga2V5LiBUaGVcbiAgICAqIHZhbHVlIG9mIHRoZSBgbm90aWZpY2F0aW9uYCBwcm9wZXJ0eSB3aWxsIGJlIHVzZWQgYXMgdGhlIE5vdGlmaWNhdGlvbk9wdGlvbnNcbiAgICAqIG9iamVjdCBwYXNzZWQgdG8gc2hvd05vdGlmaWNhdGlvbi4gQWRkaXRpb25hbGx5LCB0aGUgYHRpdGxlYCBwcm9wZXJ0eSBvZiB0aGVcbiAgICAqIG5vdGlmaWNhdGlvbiBvYmplY3Qgd2lsbCBiZSB1c2VkIGFzIHRoZSB0aXRsZS5cbiAgICAqXG4gICAgKiBJZiB0aGVyZSBpcyBubyBub3RpZmljYXRpb24gZGF0YSBpbiB0aGUgcGF5bG9hZCB0aGVuIG5vIG5vdGlmaWNhdGlvbiB3aWxsIGJlXG4gICAgKiBzaG93bi5cbiAgICAqIEBwcml2YXRlXG4gICAgKi9cbiAgICBTV0NvbnRyb2xsZXIucHJvdG90eXBlLm9uUHVzaF8gPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIG1zZ1BheWxvYWQ7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBtc2dQYXlsb2FkID0gZXZlbnQuZGF0YS5qc29uKCk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgLy8gTm90IEpTT04gc28gbm90IGFuIEZDTSBtZXNzYWdlXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGhhbmRsZU1zZ1Byb21pc2UgPSB0aGlzLmhhc1Zpc2libGVDbGllbnRzXygpLnRoZW4oZnVuY3Rpb24gKGhhc1Zpc2libGVDbGllbnRzKSB7XG4gICAgICAgICAgICBpZiAoaGFzVmlzaWJsZUNsaWVudHMpIHtcbiAgICAgICAgICAgICAgICAvLyBEbyBub3QgbmVlZCB0byBzaG93IGEgbm90aWZpY2F0aW9uLlxuICAgICAgICAgICAgICAgIGlmIChtc2dQYXlsb2FkLm5vdGlmaWNhdGlvbiB8fCBfdGhpcy5iZ01lc3NhZ2VIYW5kbGVyXykge1xuICAgICAgICAgICAgICAgICAgICAvLyBTZW5kIHRvIHBhZ2VcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnNlbmRNZXNzYWdlVG9XaW5kb3dDbGllbnRzXyhtc2dQYXlsb2FkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG5vdGlmaWNhdGlvbkRldGFpbHMgPSBfdGhpcy5nZXROb3RpZmljYXRpb25EYXRhXyhtc2dQYXlsb2FkKTtcbiAgICAgICAgICAgIGlmIChub3RpZmljYXRpb25EZXRhaWxzKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5vdGlmaWNhdGlvblRpdGxlID0gbm90aWZpY2F0aW9uRGV0YWlscy50aXRsZSB8fCAnJztcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5yZWdpc3RyYXRpb24uc2hvd05vdGlmaWNhdGlvbihub3RpZmljYXRpb25UaXRsZSwgbm90aWZpY2F0aW9uRGV0YWlscyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChfdGhpcy5iZ01lc3NhZ2VIYW5kbGVyXykge1xuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5iZ01lc3NhZ2VIYW5kbGVyXyhtc2dQYXlsb2FkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGV2ZW50LndhaXRVbnRpbChoYW5kbGVNc2dQcm9taXNlKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICogQHByaXZhdGVcbiAgICAqL1xuICAgIFNXQ29udHJvbGxlci5wcm90b3R5cGUub25TdWJDaGFuZ2VfID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBwcm9taXNlQ2hhaW4gPSB0aGlzLmdldFRva2VuKCkudGhlbihmdW5jdGlvbiAodG9rZW4pIHtcbiAgICAgICAgICAgIGlmICghdG9rZW4pIHtcbiAgICAgICAgICAgICAgICAvLyBXZSBjYW4ndCByZXN1YnNjcmliZSBpZiB3ZSBkb24ndCBoYXZlIGFuIEZDTSB0b2tlbiBmb3IgdGhpcyBzY29wZS5cbiAgICAgICAgICAgICAgICB0aHJvdyBfdGhpcy5lcnJvckZhY3RvcnlfLmNyZWF0ZShlcnJvcnNfMS5kZWZhdWx0LmNvZGVzLk5PX0ZDTV9UT0tFTl9GT1JfUkVTVUJTQ1JJQkUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHRva2VuRGV0YWlscyA9IG51bGw7XG4gICAgICAgICAgICB2YXIgdG9rZW5NYW5hZ2VyID0gX3RoaXMuZ2V0VG9rZW5NYW5hZ2VyKCk7XG4gICAgICAgICAgICByZXR1cm4gdG9rZW5NYW5hZ2VyXG4gICAgICAgICAgICAgICAgLmdldFRva2VuRGV0YWlsc0Zyb21Ub2tlbih0b2tlbilcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGV0YWlscykge1xuICAgICAgICAgICAgICAgIHRva2VuRGV0YWlscyA9IGRldGFpbHM7XG4gICAgICAgICAgICAgICAgaWYgKCF0b2tlbkRldGFpbHMpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgX3RoaXMuZXJyb3JGYWN0b3J5Xy5jcmVhdGUoZXJyb3JzXzEuZGVmYXVsdC5jb2Rlcy5JTlZBTElEX1NBVkVEX1RPS0VOKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gQXR0ZW1wdCB0byBnZXQgYSBuZXcgc3Vic2NyaXB0aW9uXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYucmVnaXN0cmF0aW9uLnB1c2hNYW5hZ2VyLnN1YnNjcmliZShmY21fZGV0YWlsc18xLmRlZmF1bHQuU1VCU0NSSVBUSU9OX09QVElPTlMpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAobmV3U3Vic2NyaXB0aW9uKSB7XG4gICAgICAgICAgICAgICAgLy8gU2VuZCBuZXcgc3Vic2NyaXB0aW9uIHRvIEZDTS5cbiAgICAgICAgICAgICAgICByZXR1cm4gdG9rZW5NYW5hZ2VyLnN1YnNjcmliZVRvRkNNKHRva2VuRGV0YWlscy5mY21TZW5kZXJJZCwgbmV3U3Vic2NyaXB0aW9uLCB0b2tlbkRldGFpbHMuZmNtUHVzaFNldCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgLy8gVGhlIGJlc3QgdGhpbmcgd2UgY2FuIGRvIGlzIGxvZyB0aGlzIHRvIHRoZSB0ZXJtaW5hbCBzb1xuICAgICAgICAgICAgICAgIC8vIGRldmVsb3BlcnMgbWlnaHQgbm90aWNlIHRoZSBlcnJvci5cbiAgICAgICAgICAgICAgICByZXR1cm4gdG9rZW5NYW5hZ2VyLmRlbGV0ZVRva2VuKHRva2VuRGV0YWlscy5mY21Ub2tlbikudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IF90aGlzLmVycm9yRmFjdG9yeV8uY3JlYXRlKGVycm9yc18xLmRlZmF1bHQuY29kZXMuVU5BQkxFX1RPX1JFU1VCU0NSSUJFLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBlcnJcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIGV2ZW50LndhaXRVbnRpbChwcm9taXNlQ2hhaW4pO1xuICAgIH07XG4gICAgLyoqXG4gICAgKiBAcHJpdmF0ZVxuICAgICovXG4gICAgU1dDb250cm9sbGVyLnByb3RvdHlwZS5vbk5vdGlmaWNhdGlvbkNsaWNrXyA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIShldmVudC5ub3RpZmljYXRpb24gJiZcbiAgICAgICAgICAgIGV2ZW50Lm5vdGlmaWNhdGlvbi5kYXRhICYmXG4gICAgICAgICAgICBldmVudC5ub3RpZmljYXRpb24uZGF0YVtGQ01fTVNHXSkpIHtcbiAgICAgICAgICAgIC8vIE5vdCBhbiBGQ00gbm90aWZpY2F0aW9uLCBkbyBub3RoaW5nLlxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIC8vIFByZXZlbnQgb3RoZXIgbGlzdGVuZXJzIGZyb20gcmVjZWl2aW5nIHRoZSBldmVudFxuICAgICAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbiAgICAgICAgZXZlbnQubm90aWZpY2F0aW9uLmNsb3NlKCk7XG4gICAgICAgIHZhciBtc2dQYXlsb2FkID0gZXZlbnQubm90aWZpY2F0aW9uLmRhdGFbRkNNX01TR107XG4gICAgICAgIHZhciBjbGlja0FjdGlvbiA9IG1zZ1BheWxvYWRbJ25vdGlmaWNhdGlvbiddWydjbGlja19hY3Rpb24nXTtcbiAgICAgICAgaWYgKCFjbGlja0FjdGlvbikge1xuICAgICAgICAgICAgLy8gTm90aGluZyB0byBkby5cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcHJvbWlzZUNoYWluID0gdGhpcy5nZXRXaW5kb3dDbGllbnRfKGNsaWNrQWN0aW9uKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHdpbmRvd0NsaWVudCkge1xuICAgICAgICAgICAgaWYgKCF3aW5kb3dDbGllbnQpIHtcbiAgICAgICAgICAgICAgICAvLyBVbmFibGUgdG8gZmluZCB3aW5kb3cgY2xpZW50IHNvIG5lZWQgdG8gb3BlbiBvbmUuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuY2xpZW50cy5vcGVuV2luZG93KGNsaWNrQWN0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB3aW5kb3dDbGllbnQ7XG4gICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAod2luZG93Q2xpZW50KSB7XG4gICAgICAgICAgICBpZiAoIXdpbmRvd0NsaWVudCkge1xuICAgICAgICAgICAgICAgIC8vIFdpbmRvdyBDbGllbnQgd2lsbCBub3QgYmUgcmV0dXJuZWQgaWYgaXQncyBmb3IgYSB0aGlyZCBwYXJ0eSBvcmlnaW4uXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gRGVsZXRlIG5vdGlmaWNhdGlvbiBkYXRhIGZyb20gcGF5bG9hZCBiZWZvcmUgc2VuZGluZyB0byB0aGUgcGFnZS5cbiAgICAgICAgICAgIHZhciBub3RpZmljYXRpb25EYXRhID0gbXNnUGF5bG9hZFsnbm90aWZpY2F0aW9uJ107XG4gICAgICAgICAgICBkZWxldGUgbXNnUGF5bG9hZFsnbm90aWZpY2F0aW9uJ107XG4gICAgICAgICAgICB2YXIgaW50ZXJuYWxNc2cgPSB3b3JrZXJfcGFnZV9tZXNzYWdlXzEuZGVmYXVsdC5jcmVhdGVOZXdNc2cod29ya2VyX3BhZ2VfbWVzc2FnZV8xLmRlZmF1bHQuVFlQRVNfT0ZfTVNHLk5PVElGSUNBVElPTl9DTElDS0VELCBtc2dQYXlsb2FkKTtcbiAgICAgICAgICAgIC8vIEF0dGVtcHQgdG8gc2VuZCBhIG1lc3NhZ2UgdG8gdGhlIGNsaWVudCB0byBoYW5kbGUgdGhlIGRhdGFcbiAgICAgICAgICAgIC8vIElzIGFmZmVjdGVkIGJ5OiBodHRwczovL2dpdGh1Yi5jb20vc2xpZ2h0bHlvZmYvU2VydmljZVdvcmtlci9pc3N1ZXMvNzI4XG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuYXR0ZW1wdFRvTWVzc2FnZUNsaWVudF8od2luZG93Q2xpZW50LCBpbnRlcm5hbE1zZyk7XG4gICAgICAgIH0pO1xuICAgICAgICBldmVudC53YWl0VW50aWwocHJvbWlzZUNoYWluKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG1zZ1BheWxvYWRcbiAgICAgKiBAcmV0dXJuIHtOb3RpZmljYXRpb25PcHRpb25zfHVuZGVmaW5lZH1cbiAgICAgKi9cbiAgICBTV0NvbnRyb2xsZXIucHJvdG90eXBlLmdldE5vdGlmaWNhdGlvbkRhdGFfID0gZnVuY3Rpb24gKG1zZ1BheWxvYWQpIHtcbiAgICAgICAgaWYgKCFtc2dQYXlsb2FkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBtc2dQYXlsb2FkLm5vdGlmaWNhdGlvbiAhPT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbm90aWZpY2F0aW9uSW5mb3JtYXRpb24gPSBPYmplY3QuYXNzaWduKHt9LCBtc2dQYXlsb2FkLm5vdGlmaWNhdGlvbik7XG4gICAgICAgIC8vIFB1dCB0aGUgbWVzc2FnZSBwYXlsb2FkIHVuZGVyIEZDTV9NU0cgbmFtZSBzbyB3ZSBjYW4gaWRlbnRpZnkgdGhlXG4gICAgICAgIC8vIG5vdGlmaWNhdGlvbiBhcyBiZWluZyBhbiBGQ00gbm90aWZpY2F0aW9uIHZzIGEgbm90aWZpY2F0aW9uIGZyb21cbiAgICAgICAgLy8gc29tZXdoZXJlIGVsc2UgKGkuZS4gbm9ybWFsIHdlYiBwdXNoIG9yIGRldmVsb3BlciBnZW5lcmF0ZWRcbiAgICAgICAgLy8gbm90aWZpY2F0aW9uKS5cbiAgICAgICAgbm90aWZpY2F0aW9uSW5mb3JtYXRpb25bJ2RhdGEnXSA9IChfYSA9IHt9LFxuICAgICAgICAgICAgX2FbRkNNX01TR10gPSBtc2dQYXlsb2FkLFxuICAgICAgICAgICAgX2EpO1xuICAgICAgICByZXR1cm4gbm90aWZpY2F0aW9uSW5mb3JtYXRpb247XG4gICAgICAgIHZhciBfYTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIENhbGxpbmcgc2V0QmFja2dyb3VuZE1lc3NhZ2VIYW5kbGVyIHdpbGwgb3B0IGluIHRvIHNvbWUgc3BlY2lmaWNcbiAgICAgKiBiZWhhdmlvdXJzLlxuICAgICAqIDEuKSBJZiBhIG5vdGlmaWNhdGlvbiBkb2Vzbid0IG5lZWQgdG8gYmUgc2hvd24gZHVlIHRvIGEgd2luZG93IGFscmVhZHlcbiAgICAgKiBiZWluZyB2aXNpYmxlLCB0aGVuIHB1c2ggbWVzc2FnZXMgd2lsbCBiZSBzZW50IHRvIHRoZSBwYWdlLlxuICAgICAqIDIuKSBJZiBhIG5vdGlmaWNhdGlvbiBuZWVkcyB0byBiZSBzaG93biwgYW5kIHRoZSBtZXNzYWdlIGNvbnRhaW5zIG5vXG4gICAgICogbm90aWZpY2F0aW9uIGRhdGEgdGhpcyBtZXRob2Qgd2lsbCBiZSBjYWxsZWRcbiAgICAgKiBhbmQgdGhlIHByb21pc2UgaXQgcmV0dXJucyB3aWxsIGJlIHBhc3NlZCB0byBldmVudC53YWl0VW50aWwuXG4gICAgICogSWYgeW91IGRvIG5vdCBzZXQgdGhpcyBjYWxsYmFjayB0aGVuIGFsbCBwdXNoIG1lc3NhZ2VzIHdpbGwgbGV0IGFuZCB0aGVcbiAgICAgKiBkZXZlbG9wZXIgY2FuIGhhbmRsZSB0aGVtIGluIGEgdGhlaXIgb3duICdwdXNoJyBldmVudCBjYWxsYmFja1xuICAgICAqIEBleHBvcnRcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKE9iamVjdCl9IGNhbGxiYWNrIFRoZSBjYWxsYmFjayB0byBiZSBjYWxsZWQgd2hlbiBhIHB1c2hcbiAgICAgKiBtZXNzYWdlIGlzIHJlY2VpdmVkIGFuZCBhIG5vdGlmaWNhdGlvbiBtdXN0IGJlIHNob3duLiBUaGUgY2FsbGJhY2sgd2lsbFxuICAgICAqIGJlIGdpdmVuIHRoZSBkYXRhIGZyb20gdGhlIHB1c2ggbWVzc2FnZS5cbiAgICAgKi9cbiAgICBTV0NvbnRyb2xsZXIucHJvdG90eXBlLnNldEJhY2tncm91bmRNZXNzYWdlSGFuZGxlciA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICBpZiAoY2FsbGJhY2sgJiYgdHlwZW9mIGNhbGxiYWNrICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICB0aHJvdyB0aGlzLmVycm9yRmFjdG9yeV8uY3JlYXRlKGVycm9yc18xLmRlZmF1bHQuY29kZXMuQkdfSEFORExFUl9GVU5DVElPTl9FWFBFQ1RFRCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5iZ01lc3NhZ2VIYW5kbGVyXyA9IGNhbGxiYWNrO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIFRoZSBVUkwgdG8gbG9vayBmb3Igd2hlbiBmb2N1c2luZyBhIGNsaWVudC5cbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IFJldHVybnMgYW4gZXhpc3Rpbmcgd2luZG93IGNsaWVudCBvciBhIG5ld2x5IG9wZW5lZFxuICAgICAqIFdpbmRvd0NsaWVudC5cbiAgICAgKi9cbiAgICBTV0NvbnRyb2xsZXIucHJvdG90eXBlLmdldFdpbmRvd0NsaWVudF8gPSBmdW5jdGlvbiAodXJsKSB7XG4gICAgICAgIC8vIFVzZSBVUkwgdG8gbm9ybWFsaXplIHRoZSBVUkwgd2hlbiBjb21wYXJpbmcgdG8gd2luZG93Q2xpZW50cy5cbiAgICAgICAgLy8gVGhpcyBhdCBsZWFzdCBoYW5kbGVzIHdoZXRoZXIgdG8gaW5jbHVkZSB0cmFpbGluZyBzbGFzaGVzIG9yIG5vdFxuICAgICAgICB2YXIgcGFyc2VkVVJMID0gbmV3IFVSTCh1cmwpLmhyZWY7XG4gICAgICAgIHJldHVybiBzZWxmLmNsaWVudHNcbiAgICAgICAgICAgIC5tYXRjaEFsbCh7XG4gICAgICAgICAgICB0eXBlOiAnd2luZG93JyxcbiAgICAgICAgICAgIGluY2x1ZGVVbmNvbnRyb2xsZWQ6IHRydWVcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChjbGllbnRMaXN0KSB7XG4gICAgICAgICAgICB2YXIgc3VpdGFibGVDbGllbnQgPSBudWxsO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjbGllbnRMaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhcnNlZENsaWVudFVybCA9IG5ldyBVUkwoY2xpZW50TGlzdFtpXS51cmwpLmhyZWY7XG4gICAgICAgICAgICAgICAgaWYgKHBhcnNlZENsaWVudFVybCA9PT0gcGFyc2VkVVJMKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1aXRhYmxlQ2xpZW50ID0gY2xpZW50TGlzdFtpXTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHN1aXRhYmxlQ2xpZW50KSB7XG4gICAgICAgICAgICAgICAgc3VpdGFibGVDbGllbnQuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VpdGFibGVDbGllbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogVGhpcyBtZXNzYWdlIHdpbGwgYXR0ZW1wdCB0byBzZW5kIHRoZSBtZXNzYWdlIHRvIGEgd2luZG93IGNsaWVudC5cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBjbGllbnQgVGhlIFdpbmRvd0NsaWVudCB0byBzZW5kIHRoZSBtZXNzYWdlIHRvLlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBtZXNzYWdlIFRoZSBtZXNzYWdlIHRvIHNlbmQgdG8gdGhlIGNsaWVudC5cbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZX0gUmV0dXJucyBhIHByb21pc2UgdGhhdCByZXNvbHZlcyBhZnRlciBzZW5kaW5nIHRoZVxuICAgICAqIG1lc3NhZ2UuIFRoaXMgZG9lcyBub3QgZ3VhcmFudGVlIHRoYXQgdGhlIG1lc3NhZ2Ugd2FzIHN1Y2Nlc3NmdWxseVxuICAgICAqIHJlY2VpdmVkLlxuICAgICAqL1xuICAgIFNXQ29udHJvbGxlci5wcm90b3R5cGUuYXR0ZW1wdFRvTWVzc2FnZUNsaWVudF8gPSBmdW5jdGlvbiAoY2xpZW50LCBtZXNzYWdlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICBpZiAoIWNsaWVudCkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZWplY3QoX3RoaXMuZXJyb3JGYWN0b3J5Xy5jcmVhdGUoZXJyb3JzXzEuZGVmYXVsdC5jb2Rlcy5OT19XSU5ET1dfQ0xJRU5UX1RPX01TRykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2xpZW50LnBvc3RNZXNzYWdlKG1lc3NhZ2UpO1xuICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHJldHVybnMge1Byb21pc2U8Ym9vbGVhbj59IElmIHRoZXJlIGlzIGN1cnJlbnRseSBhIHZpc2libGUgV2luZG93Q2xpZW50LFxuICAgICAqIHRoaXMgbWV0aG9kIHdpbGwgcmVzb2x2ZSB0byB0cnVlLCBvdGhlcndpc2UgZmFsc2UuXG4gICAgICovXG4gICAgU1dDb250cm9sbGVyLnByb3RvdHlwZS5oYXNWaXNpYmxlQ2xpZW50c18gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBzZWxmLmNsaWVudHNcbiAgICAgICAgICAgIC5tYXRjaEFsbCh7XG4gICAgICAgICAgICB0eXBlOiAnd2luZG93JyxcbiAgICAgICAgICAgIGluY2x1ZGVVbmNvbnRyb2xsZWQ6IHRydWVcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChjbGllbnRMaXN0KSB7XG4gICAgICAgICAgICByZXR1cm4gY2xpZW50TGlzdC5zb21lKGZ1bmN0aW9uIChjbGllbnQpIHsgcmV0dXJuIGNsaWVudC52aXNpYmlsaXR5U3RhdGUgPT09ICd2aXNpYmxlJzsgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gbXNnUGF5bG9hZCBUaGUgZGF0YSBmcm9tIHRoZSBwdXNoIGV2ZW50IHRoYXQgc2hvdWxkIGJlIHNlbnRcbiAgICAgKiB0byBhbGwgYXZhaWxhYmxlIHBhZ2VzLlxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlfSBSZXR1cm5zIGEgcHJvbWlzZSB0aGF0IHJlc29sdmVzIG9uY2UgdGhlIG1lc3NhZ2VcbiAgICAgKiBoYXMgYmVlbiBzZW50IHRvIGFsbCBXaW5kb3dDbGllbnRzLlxuICAgICAqL1xuICAgIFNXQ29udHJvbGxlci5wcm90b3R5cGUuc2VuZE1lc3NhZ2VUb1dpbmRvd0NsaWVudHNfID0gZnVuY3Rpb24gKG1zZ1BheWxvYWQpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIHNlbGYuY2xpZW50c1xuICAgICAgICAgICAgLm1hdGNoQWxsKHtcbiAgICAgICAgICAgIHR5cGU6ICd3aW5kb3cnLFxuICAgICAgICAgICAgaW5jbHVkZVVuY29udHJvbGxlZDogdHJ1ZVxuICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGNsaWVudExpc3QpIHtcbiAgICAgICAgICAgIHZhciBpbnRlcm5hbE1zZyA9IHdvcmtlcl9wYWdlX21lc3NhZ2VfMS5kZWZhdWx0LmNyZWF0ZU5ld01zZyh3b3JrZXJfcGFnZV9tZXNzYWdlXzEuZGVmYXVsdC5UWVBFU19PRl9NU0cuUFVTSF9NU0dfUkVDRUlWRUQsIG1zZ1BheWxvYWQpO1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKGNsaWVudExpc3QubWFwKGZ1bmN0aW9uIChjbGllbnQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuYXR0ZW1wdFRvTWVzc2FnZUNsaWVudF8oY2xpZW50LCBpbnRlcm5hbE1zZyk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogVGhpcyB3aWxsIHJlZ2lzdGVyIHRoZSBkZWZhdWx0IHNlcnZpY2Ugd29ya2VyIGFuZCByZXR1cm4gdGhlIHJlZ2lzdHJhdGlvbi5cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEByZXR1cm4ge1Byb21pc2U8IVNlcnZpY2VXb3JrZXJSZWdpc3RyYXRpb24+fSBUaGUgc2VydmljZSB3b3JrZXJcbiAgICAgKiByZWdpc3RyYXRpb24gdG8gYmUgdXNlZCBmb3IgdGhlIHB1c2ggc2VydmljZS5cbiAgICAgKi9cbiAgICBTV0NvbnRyb2xsZXIucHJvdG90eXBlLmdldFNXUmVnaXN0cmF0aW9uXyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShzZWxmLnJlZ2lzdHJhdGlvbik7XG4gICAgfTtcbiAgICByZXR1cm4gU1dDb250cm9sbGVyO1xufShjb250cm9sbGVyX2ludGVyZmFjZV8xLmRlZmF1bHQpKTtcbmV4cG9ydHMuZGVmYXVsdCA9IFNXQ29udHJvbGxlcjtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3ctY29udHJvbGxlci5qcy5tYXBcbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4ndXNlIHN0cmljdCc7XG52YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBjb250cm9sbGVyX2ludGVyZmFjZV8xID0gcmVxdWlyZShcIi4vY29udHJvbGxlci1pbnRlcmZhY2VcIik7XG52YXIgZXJyb3JzXzEgPSByZXF1aXJlKFwiLi4vbW9kZWxzL2Vycm9yc1wiKTtcbnZhciB3b3JrZXJfcGFnZV9tZXNzYWdlXzEgPSByZXF1aXJlKFwiLi4vbW9kZWxzL3dvcmtlci1wYWdlLW1lc3NhZ2VcIik7XG52YXIgZGVmYXVsdF9zd18xID0gcmVxdWlyZShcIi4uL21vZGVscy9kZWZhdWx0LXN3XCIpO1xudmFyIG5vdGlmaWNhdGlvbl9wZXJtaXNzaW9uXzEgPSByZXF1aXJlKFwiLi4vbW9kZWxzL25vdGlmaWNhdGlvbi1wZXJtaXNzaW9uXCIpO1xudmFyIHV0aWxfMSA9IHJlcXVpcmUoXCJAZmlyZWJhc2UvdXRpbFwiKTtcbnZhciBXaW5kb3dDb250cm9sbGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhXaW5kb3dDb250cm9sbGVyLCBfc3VwZXIpO1xuICAgIC8qKlxuICAgICAqIEEgc2VydmljZSB0aGF0IHByb3ZpZGVzIGEgTWVzc2FnaW5nU2VydmljZSBpbnN0YW5jZS5cbiAgICAgKiBAcGFyYW0geyFmaXJlYmFzZS5hcHAuQXBwfSBhcHBcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBXaW5kb3dDb250cm9sbGVyKGFwcCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBhcHApIHx8IHRoaXM7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAdHlwZSB7U2VydmljZVdvcmtlclJlZ2lzdHJhdGlvbn1cbiAgICAgICAgICovXG4gICAgICAgIF90aGlzLnJlZ2lzdHJhdGlvblRvVXNlXztcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEB0eXBlIHtQcm9taXNlfVxuICAgICAgICAgKi9cbiAgICAgICAgX3RoaXMubWFuaWZlc3RDaGVja1Byb21pc2VfO1xuICAgICAgICAvKipcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQHR5cGUge2ZpcmViYXNlLk9ic2VydmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgX3RoaXMubWVzc2FnZU9ic2VydmVyXyA9IG51bGw7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAcHJpdmF0ZSB7IWZpcmViYXNlLlN1YnNjcmliZX0gVGhlIHN1YnNjcmliZSBmdW5jdGlvbiB0byB0aGUgb25NZXNzYWdlXG4gICAgICAgICAqIG9ic2VydmVyLlxuICAgICAgICAgKi9cbiAgICAgICAgX3RoaXMub25NZXNzYWdlXyA9IHV0aWxfMS5jcmVhdGVTdWJzY3JpYmUoZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICAgICAgICBfdGhpcy5tZXNzYWdlT2JzZXJ2ZXJfID0gb2JzZXJ2ZXI7XG4gICAgICAgIH0pO1xuICAgICAgICAvKipcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQHR5cGUge2ZpcmViYXNlLk9ic2VydmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgX3RoaXMudG9rZW5SZWZyZXNoT2JzZXJ2ZXJfID0gbnVsbDtcbiAgICAgICAgX3RoaXMub25Ub2tlblJlZnJlc2hfID0gdXRpbF8xLmNyZWF0ZVN1YnNjcmliZShmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgICAgICAgIF90aGlzLnRva2VuUmVmcmVzaE9ic2VydmVyXyA9IG9ic2VydmVyO1xuICAgICAgICB9KTtcbiAgICAgICAgX3RoaXMuc2V0dXBTV01lc3NhZ2VMaXN0ZW5lcl8oKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCByZXR1cm5zIGFuIEZDTSB0b2tlbiBpZiBpdCBjYW4gYmUgZ2VuZXJhdGVkLlxuICAgICAqIFRoZSByZXR1cm4gcHJvbWlzZSB3aWxsIHJlamVjdCBpZiB0aGUgYnJvd3NlciBkb2Vzbid0IHN1cHBvcnRcbiAgICAgKiBGQ00sIGlmIHBlcm1pc3Npb24gaXMgZGVuaWVkIGZvciBub3RpZmljYXRpb25zIG9yIGl0J3Mgbm90XG4gICAgICogcG9zc2libGUgdG8gZ2VuZXJhdGUgYSB0b2tlbi5cbiAgICAgKiBAZXhwb3J0XG4gICAgICogQHJldHVybiB7UHJvbWlzZTxzdHJpbmc+IHwgUHJvbWlzZTxudWxsPn0gUmV0dXJucyBhIHByb21pc2UgdGhlXG4gICAgICogcmVzb2x2ZXMgdG8gYW4gRkNNIHRva2VuIG9yIG51bGwgaWYgcGVybWlzc2lvbiBpc24ndCBncmFudGVkLlxuICAgICAqL1xuICAgIFdpbmRvd0NvbnRyb2xsZXIucHJvdG90eXBlLmdldFRva2VuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAvLyBDaGVjayB0aGF0IHRoZSByZXF1aXJlZCBBUEkncyBhcmUgYXZhaWxhYmxlXG4gICAgICAgIGlmICghdGhpcy5pc1N1cHBvcnRlZF8oKSkge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHRoaXMuZXJyb3JGYWN0b3J5Xy5jcmVhdGUoZXJyb3JzXzEuZGVmYXVsdC5jb2Rlcy5VTlNVUFBPUlRFRF9CUk9XU0VSKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMubWFuaWZlc3RDaGVja18oKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBfc3VwZXIucHJvdG90eXBlLmdldFRva2VuLmNhbGwoX3RoaXMpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFRoZSBtZXRob2QgY2hlY2tzIHRoYXQgYSBtYW5pZmVzdCBpcyBkZWZpbmVkIGFuZCBoYXMgdGhlIGNvcnJlY3QgR0NNXG4gICAgICogc2VuZGVyIElELlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHJldHVybiB7UHJvbWlzZX0gUmV0dXJucyBhIHByb21pc2UgdGhhdCByZXNvbHZlcyBpZiB0aGUgbWFuaWZlc3QgbWF0Y2hlc1xuICAgICAqIG91ciByZXF1aXJlZCBzZW5kZXIgSURcbiAgICAgKi9cbiAgICBXaW5kb3dDb250cm9sbGVyLnByb3RvdHlwZS5tYW5pZmVzdENoZWNrXyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHRoaXMubWFuaWZlc3RDaGVja1Byb21pc2VfKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tYW5pZmVzdENoZWNrUHJvbWlzZV87XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG1hbmlmZXN0VGFnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbGlua1tyZWw9XCJtYW5pZmVzdFwiXScpO1xuICAgICAgICBpZiAoIW1hbmlmZXN0VGFnKSB7XG4gICAgICAgICAgICB0aGlzLm1hbmlmZXN0Q2hlY2tQcm9taXNlXyA9IFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5tYW5pZmVzdENoZWNrUHJvbWlzZV8gPSBmZXRjaChtYW5pZmVzdFRhZy5ocmVmKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlIGRvd25sb2FkIG9yIHBhcnNpbmcgZmFpbHMgYWxsb3cgY2hlY2suXG4gICAgICAgICAgICAgICAgLy8gV2Ugb25seSB3YW50IHRvIGVycm9yIGlmIHdlIEtOT1cgdGhhdCB0aGUgZ2NtX3NlbmRlcl9pZCBpcyBpbmNvcnJlY3QuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAobWFuaWZlc3RDb250ZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKCFtYW5pZmVzdENvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIW1hbmlmZXN0Q29udGVudFsnZ2NtX3NlbmRlcl9pZCddKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG1hbmlmZXN0Q29udGVudFsnZ2NtX3NlbmRlcl9pZCddICE9PSAnMTAzOTUzODAwNTA3Jykge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBfdGhpcy5lcnJvckZhY3RvcnlfLmNyZWF0ZShlcnJvcnNfMS5kZWZhdWx0LmNvZGVzLklOQ09SUkVDVF9HQ01fU0VOREVSX0lEKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5tYW5pZmVzdENoZWNrUHJvbWlzZV87XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZXF1ZXN0IHBlcm1pc3Npb24gaWYgaXQgaXMgbm90IGN1cnJlbnRseSBncmFudGVkXG4gICAgICogQGV4cG9ydFxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlfSBSZXNvbHZlcyBpZiB0aGUgcGVybWlzc2lvbiB3YXMgZ3JhbnRlZCwgb3RoZXJ3aXNlXG4gICAgICogcmVqZWN0c1xuICAgICAqL1xuICAgIFdpbmRvd0NvbnRyb2xsZXIucHJvdG90eXBlLnJlcXVlc3RQZXJtaXNzaW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoTm90aWZpY2F0aW9uLnBlcm1pc3Npb24gPT09IG5vdGlmaWNhdGlvbl9wZXJtaXNzaW9uXzEuZGVmYXVsdC5ncmFudGVkKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIHZhciBtYW5hZ2VQZXJtaXNzaW9uUmVzdWx0ID0gZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgPT09IG5vdGlmaWNhdGlvbl9wZXJtaXNzaW9uXzEuZGVmYXVsdC5ncmFudGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHJlc3VsdCA9PT0gbm90aWZpY2F0aW9uX3Blcm1pc3Npb25fMS5kZWZhdWx0LmRlbmllZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVqZWN0KF90aGlzLmVycm9yRmFjdG9yeV8uY3JlYXRlKGVycm9yc18xLmRlZmF1bHQuY29kZXMuUEVSTUlTU0lPTl9CTE9DS0VEKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVqZWN0KF90aGlzLmVycm9yRmFjdG9yeV8uY3JlYXRlKGVycm9yc18xLmRlZmF1bHQuY29kZXMuUEVSTUlTU0lPTl9ERUZBVUxUKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIC8vIFRoZSBOb3RpZmljYXRpb24ucmVxdWVzdFBlcm1pc3Npb24gQVBJIHdhcyBjaGFuZ2VkIHRvXG4gICAgICAgICAgICAvLyByZXR1cm4gYSBwcm9taXNlIHNvIG5vdyBoYXZlIHRvIGhhbmRsZSBib3RoIGluIGNhc2VcbiAgICAgICAgICAgIC8vIGJyb3dzZXJzIHN0b3Agc3VwcG9ydCBjYWxsYmFja3MgZm9yIHByb21pc2VkIHZlcnNpb25cbiAgICAgICAgICAgIHZhciBwZXJtaXNzaW9uUHJvbWlzZSA9IE5vdGlmaWNhdGlvbi5yZXF1ZXN0UGVybWlzc2lvbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgaWYgKHBlcm1pc3Npb25Qcm9taXNlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIExldCB0aGUgcHJvbWlzZSBtYW5hZ2UgdGhpc1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG1hbmFnZVBlcm1pc3Npb25SZXN1bHQocmVzdWx0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKHBlcm1pc3Npb25Qcm9taXNlKSB7XG4gICAgICAgICAgICAgICAgLy8gUHJlZmVyIHRoZSBwcm9taXNlIHZlcnNpb24gYXMgaXQncyB0aGUgZnV0dXJlIEFQSS5cbiAgICAgICAgICAgICAgICBwZXJtaXNzaW9uUHJvbWlzZS50aGVuKG1hbmFnZVBlcm1pc3Npb25SZXN1bHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGFsbG93cyBhIGRldmVsb3BlciB0byBvdmVycmlkZSB0aGUgZGVmYXVsdCBzZXJ2aWNlIHdvcmtlciBhbmRcbiAgICAgKiBpbnN0ZWFkIHVzZSBhIGN1c3RvbSBzZXJ2aWNlIHdvcmtlci5cbiAgICAgKiBAZXhwb3J0XG4gICAgICogQHBhcmFtIHshU2VydmljZVdvcmtlclJlZ2lzdHJhdGlvbn0gcmVnaXN0cmF0aW9uIFRoZSBzZXJ2aWNlIHdvcmtlclxuICAgICAqIHJlZ2lzdHJhdGlvbiB0aGF0IHNob3VsZCBiZSB1c2VkIHRvIHJlY2VpdmUgdGhlIHB1c2ggbWVzc2FnZXMuXG4gICAgICovXG4gICAgV2luZG93Q29udHJvbGxlci5wcm90b3R5cGUudXNlU2VydmljZVdvcmtlciA9IGZ1bmN0aW9uIChyZWdpc3RyYXRpb24pIHtcbiAgICAgICAgaWYgKCEocmVnaXN0cmF0aW9uIGluc3RhbmNlb2YgU2VydmljZVdvcmtlclJlZ2lzdHJhdGlvbikpIHtcbiAgICAgICAgICAgIHRocm93IHRoaXMuZXJyb3JGYWN0b3J5Xy5jcmVhdGUoZXJyb3JzXzEuZGVmYXVsdC5jb2Rlcy5TV19SRUdJU1RSQVRJT05fRVhQRUNURUQpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5yZWdpc3RyYXRpb25Ub1VzZV8gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICB0aHJvdyB0aGlzLmVycm9yRmFjdG9yeV8uY3JlYXRlKGVycm9yc18xLmRlZmF1bHQuY29kZXMuVVNFX1NXX0JFRk9SRV9HRVRfVE9LRU4pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVnaXN0cmF0aW9uVG9Vc2VfID0gcmVnaXN0cmF0aW9uO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQGV4cG9ydFxuICAgICAqIEBwYXJhbSB7IWZpcmViYXNlLk9ic2VydmVyfGZ1bmN0aW9uKCopfSBuZXh0T3JPYnNlcnZlciBBbiBvYnNlcnZlciBvYmplY3RcbiAgICAgKiBvciBhIGZ1bmN0aW9uIHRyaWdnZXJlZCBvbiBtZXNzYWdlLlxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oIUVycm9yKT19IG9wdEVycm9yIE9wdGlvbmFsIEEgZnVuY3Rpb24gdHJpZ2dlcmVkIG9uXG4gICAgICogbWVzc2FnZSBlcnJvci5cbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKCk9fSBvcHRDb21wbGV0ZWQgT3B0aW9uYWwgZnVuY3Rpb24gdHJpZ2dlcmVkIHdoZW4gdGhlXG4gICAgICogb2JzZXJ2ZXIgaXMgcmVtb3ZlZC5cbiAgICAgKiBAcmV0dXJuIHshZnVuY3Rpb24oKX0gVGhlIHVuc3Vic2NyaWJlIGZ1bmN0aW9uIGZvciB0aGUgb2JzZXJ2ZXIuXG4gICAgICovXG4gICAgV2luZG93Q29udHJvbGxlci5wcm90b3R5cGUub25NZXNzYWdlID0gZnVuY3Rpb24gKG5leHRPck9ic2VydmVyLCBvcHRFcnJvciwgb3B0Q29tcGxldGVkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm9uTWVzc2FnZV8obmV4dE9yT2JzZXJ2ZXIsIG9wdEVycm9yLCBvcHRDb21wbGV0ZWQpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQGV4cG9ydFxuICAgICAqIEBwYXJhbSB7IWZpcmViYXNlLk9ic2VydmVyfGZ1bmN0aW9uKCl9IG5leHRPck9ic2VydmVyIEFuIG9ic2VydmVyIG9iamVjdFxuICAgICAqIG9yIGEgZnVuY3Rpb24gdHJpZ2dlcmVkIG9uIHRva2VuIHJlZnJlc2guXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbighRXJyb3IpPX0gb3B0RXJyb3IgT3B0aW9uYWwgQSBmdW5jdGlvblxuICAgICAqIHRyaWdnZXJlZCBvbiB0b2tlbiByZWZyZXNoIGVycm9yLlxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oKT19IG9wdENvbXBsZXRlZCBPcHRpb25hbCBmdW5jdGlvbiB0cmlnZ2VyZWQgd2hlbiB0aGVcbiAgICAgKiBvYnNlcnZlciBpcyByZW1vdmVkLlxuICAgICAqIEByZXR1cm4geyFmdW5jdGlvbigpfSBUaGUgdW5zdWJzY3JpYmUgZnVuY3Rpb24gZm9yIHRoZSBvYnNlcnZlci5cbiAgICAgKi9cbiAgICBXaW5kb3dDb250cm9sbGVyLnByb3RvdHlwZS5vblRva2VuUmVmcmVzaCA9IGZ1bmN0aW9uIChuZXh0T3JPYnNlcnZlciwgb3B0RXJyb3IsIG9wdENvbXBsZXRlZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vblRva2VuUmVmcmVzaF8obmV4dE9yT2JzZXJ2ZXIsIG9wdEVycm9yLCBvcHRDb21wbGV0ZWQpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2l2ZW4gYSByZWdpc3RyYXRpb24sIHdhaXQgZm9yIHRoZSBzZXJ2aWNlIHdvcmtlciBpdCByZWxhdGVzIHRvXG4gICAgICogYmVjb21lIGFjdGl2ZXJcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSAge1NlcnZpY2VXb3JrZXJSZWdpc3RyYXRpb259IHJlZ2lzdHJhdGlvbiBSZWdpc3RyYXRpb24gdG8gd2FpdFxuICAgICAqIGZvciBzZXJ2aWNlIHdvcmtlciB0byBiZWNvbWUgYWN0aXZlXG4gICAgICogQHJldHVybiB7UHJvbWlzZTwhU2VydmljZVdvcmtlclJlZ2lzdHJhdGlvbj59IFdhaXQgZm9yIHNlcnZpY2Ugd29ya2VyXG4gICAgICogcmVnaXN0cmF0aW9uIHRvIGJlY29tZSBhY3RpdmVcbiAgICAgKi9cbiAgICBXaW5kb3dDb250cm9sbGVyLnByb3RvdHlwZS53YWl0Rm9yUmVnaXN0cmF0aW9uVG9BY3RpdmF0ZV8gPSBmdW5jdGlvbiAocmVnaXN0cmF0aW9uKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBzZXJ2aWNlV29ya2VyID0gcmVnaXN0cmF0aW9uLmluc3RhbGxpbmcgfHwgcmVnaXN0cmF0aW9uLndhaXRpbmcgfHwgcmVnaXN0cmF0aW9uLmFjdGl2ZTtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIGlmICghc2VydmljZVdvcmtlcikge1xuICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgYSByYXJlIHNjZW5hcmlvIGJ1dCBoYXMgb2NjdXJlZCBpbiBmaXJlZm94XG4gICAgICAgICAgICAgICAgcmVqZWN0KF90aGlzLmVycm9yRmFjdG9yeV8uY3JlYXRlKGVycm9yc18xLmRlZmF1bHQuY29kZXMuTk9fU1dfSU5fUkVHKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gQmVjYXVzZSB0aGUgUHJvbWlzZSBmdW5jdGlvbiBpcyBjYWxsZWQgb24gbmV4dCB0aWNrIHRoZXJlIGlzIGFcbiAgICAgICAgICAgIC8vIHNtYWxsIGNoYW5jZSB0aGF0IHRoZSB3b3JrZXIgYmVjYW1lIGFjdGl2ZSBvciByZWR1bmRhbnQgYWxyZWFkeS5cbiAgICAgICAgICAgIGlmIChzZXJ2aWNlV29ya2VyLnN0YXRlID09PSAnYWN0aXZhdGVkJykge1xuICAgICAgICAgICAgICAgIHJlc29sdmUocmVnaXN0cmF0aW9uKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc2VydmljZVdvcmtlci5zdGF0ZSA9PT0gJ3JlZHVuZGFudCcpIHtcbiAgICAgICAgICAgICAgICByZWplY3QoX3RoaXMuZXJyb3JGYWN0b3J5Xy5jcmVhdGUoZXJyb3JzXzEuZGVmYXVsdC5jb2Rlcy5TV19SRUdfUkVEVU5EQU5UKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHN0YXRlQ2hhbmdlTGlzdGVuZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNlcnZpY2VXb3JrZXIuc3RhdGUgPT09ICdhY3RpdmF0ZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVnaXN0cmF0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoc2VydmljZVdvcmtlci5zdGF0ZSA9PT0gJ3JlZHVuZGFudCcpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KF90aGlzLmVycm9yRmFjdG9yeV8uY3JlYXRlKGVycm9yc18xLmRlZmF1bHQuY29kZXMuU1dfUkVHX1JFRFVOREFOVCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gUmV0dXJuIGVhcmx5IGFuZCB3YWl0IHRvIG5leHQgc3RhdGUgY2hhbmdlXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc2VydmljZVdvcmtlci5yZW1vdmVFdmVudExpc3RlbmVyKCdzdGF0ZWNoYW5nZScsIHN0YXRlQ2hhbmdlTGlzdGVuZXIpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHNlcnZpY2VXb3JrZXIuYWRkRXZlbnRMaXN0ZW5lcignc3RhdGVjaGFuZ2UnLCBzdGF0ZUNoYW5nZUxpc3RlbmVyKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBUaGlzIHdpbGwgcmVnaWF0ZXIgdGhlIGRlZmF1bHQgc2VydmljZSB3b3JrZXIgYW5kIHJldHVybiB0aGUgcmVnaXN0cmF0aW9uXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcmV0dXJuIHtQcm9taXNlPCFTZXJ2aWNlV29ya2VyUmVnaXN0cmF0aW9uPn0gVGhlIHNlcnZpY2Ugd29ya2VyXG4gICAgICogcmVnaXN0cmF0aW9uIHRvIGJlIHVzZWQgZm9yIHRoZSBwdXNoIHNlcnZpY2UuXG4gICAgICovXG4gICAgV2luZG93Q29udHJvbGxlci5wcm90b3R5cGUuZ2V0U1dSZWdpc3RyYXRpb25fID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAodGhpcy5yZWdpc3RyYXRpb25Ub1VzZV8pIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLndhaXRGb3JSZWdpc3RyYXRpb25Ub0FjdGl2YXRlXyh0aGlzLnJlZ2lzdHJhdGlvblRvVXNlXyk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gTWFrZSB0aGUgcmVnaXN0cmF0aW9uIG51bGwgc28gd2Uga25vdyB1c2VTZXJ2aWNlV29ya2VyIHdpbGwgbm90XG4gICAgICAgIC8vIHVzZSBhIG5ldyBzZXJ2aWNlIHdvcmtlciBhcyByZWdpc3RyYXRpb25Ub1VzZV8gaXMgbm8gbG9uZ2VyIHVuZGVmaW5lZFxuICAgICAgICB0aGlzLnJlZ2lzdHJhdGlvblRvVXNlXyA9IG51bGw7XG4gICAgICAgIHJldHVybiBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlclxuICAgICAgICAgICAgLnJlZ2lzdGVyKGRlZmF1bHRfc3dfMS5kZWZhdWx0LnBhdGgsIHtcbiAgICAgICAgICAgIHNjb3BlOiBkZWZhdWx0X3N3XzEuZGVmYXVsdC5zY29wZVxuICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgIHRocm93IF90aGlzLmVycm9yRmFjdG9yeV8uY3JlYXRlKGVycm9yc18xLmRlZmF1bHQuY29kZXMuRkFJTEVEX0RFRkFVTFRfUkVHSVNUUkFUSU9OLCB7XG4gICAgICAgICAgICAgICAgYnJvd3NlckVycm9yTWVzc2FnZTogZXJyLm1lc3NhZ2VcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlZ2lzdHJhdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzLndhaXRGb3JSZWdpc3RyYXRpb25Ub0FjdGl2YXRlXyhyZWdpc3RyYXRpb24pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzLnJlZ2lzdHJhdGlvblRvVXNlXyA9IHJlZ2lzdHJhdGlvbjtcbiAgICAgICAgICAgICAgICAvLyBXZSB1cGRhdGUgYWZ0ZXIgYWN0aXZhdGlvbiBkdWUgdG8gYW4gaXNzdWUgd2l0aCBGaXJlZm94IHY0OSB3aGVyZVxuICAgICAgICAgICAgICAgIC8vIGEgcmFjZSBjb25kaXRpb24gb2NjYXNzaW9uYWxseSBjYXVzZXMgdGhlIHNlcnZpY2Ugd29yayB0byBub3RcbiAgICAgICAgICAgICAgICAvLyBpbnN0YWxsXG4gICAgICAgICAgICAgICAgcmVnaXN0cmF0aW9uLnVwZGF0ZSgpO1xuICAgICAgICAgICAgICAgIHJldHVybiByZWdpc3RyYXRpb247XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCB3aWxsIHNldCB1cCBhIG1lc3NhZ2UgbGlzdGVuZXIgdG8gaGFuZGxlXG4gICAgICogZXZlbnRzIGZyb20gdGhlIHNlcnZpY2Ugd29ya2VyIHRoYXQgc2hvdWxkIHRyaWdnZXJcbiAgICAgKiBldmVudHMgaW4gdGhlIHBhZ2UuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIFdpbmRvd0NvbnRyb2xsZXIucHJvdG90eXBlLnNldHVwU1dNZXNzYWdlTGlzdGVuZXJfID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoISgnc2VydmljZVdvcmtlcicgaW4gbmF2aWdhdG9yKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIGlmICghZXZlbnQuZGF0YSB8fCAhZXZlbnQuZGF0YVt3b3JrZXJfcGFnZV9tZXNzYWdlXzEuZGVmYXVsdC5QQVJBTVMuVFlQRV9PRl9NU0ddKSB7XG4gICAgICAgICAgICAgICAgLy8gTm90IGEgbWVzc2FnZSBmcm9tIEZDTVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB3b3JrZXJQYWdlTWVzc2FnZSA9IGV2ZW50LmRhdGE7XG4gICAgICAgICAgICBzd2l0Y2ggKHdvcmtlclBhZ2VNZXNzYWdlW3dvcmtlcl9wYWdlX21lc3NhZ2VfMS5kZWZhdWx0LlBBUkFNUy5UWVBFX09GX01TR10pIHtcbiAgICAgICAgICAgICAgICBjYXNlIHdvcmtlcl9wYWdlX21lc3NhZ2VfMS5kZWZhdWx0LlRZUEVTX09GX01TRy5QVVNIX01TR19SRUNFSVZFRDpcbiAgICAgICAgICAgICAgICBjYXNlIHdvcmtlcl9wYWdlX21lc3NhZ2VfMS5kZWZhdWx0LlRZUEVTX09GX01TRy5OT1RJRklDQVRJT05fQ0xJQ0tFRDpcbiAgICAgICAgICAgICAgICAgICAgdmFyIHB1c2hNZXNzYWdlID0gd29ya2VyUGFnZU1lc3NhZ2Vbd29ya2VyX3BhZ2VfbWVzc2FnZV8xLmRlZmF1bHQuUEFSQU1TLkRBVEFdO1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5tZXNzYWdlT2JzZXJ2ZXJfLm5leHQocHVzaE1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAvLyBOb29wLlxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgZmFsc2UpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQ2hlY2tzIHRvIHNlZSBpZiB0aGUgcmVxdWlyZWQgQVBJJ3MgYXJlIHZhbGlkIG9yIG5vdC5cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IFJldHVybnMgdHJ1ZSBpZiB0aGUgZGVzaXJlZCBBUElzIGFyZSBhdmFpbGFibGUuXG4gICAgICovXG4gICAgV2luZG93Q29udHJvbGxlci5wcm90b3R5cGUuaXNTdXBwb3J0ZWRfID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKCdzZXJ2aWNlV29ya2VyJyBpbiBuYXZpZ2F0b3IgJiZcbiAgICAgICAgICAgICdQdXNoTWFuYWdlcicgaW4gd2luZG93ICYmXG4gICAgICAgICAgICAnTm90aWZpY2F0aW9uJyBpbiB3aW5kb3cgJiZcbiAgICAgICAgICAgICdmZXRjaCcgaW4gd2luZG93ICYmXG4gICAgICAgICAgICBTZXJ2aWNlV29ya2VyUmVnaXN0cmF0aW9uLnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSgnc2hvd05vdGlmaWNhdGlvbicpICYmXG4gICAgICAgICAgICBQdXNoU3Vic2NyaXB0aW9uLnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSgnZ2V0S2V5JykpO1xuICAgIH07XG4gICAgcmV0dXJuIFdpbmRvd0NvbnRyb2xsZXI7XG59KGNvbnRyb2xsZXJfaW50ZXJmYWNlXzEuZGVmYXVsdCkpO1xuZXhwb3J0cy5kZWZhdWx0ID0gV2luZG93Q29udHJvbGxlcjtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9d2luZG93LWNvbnRyb2xsZXIuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5mdW5jdGlvbiB0b0Jhc2U2NChhcnJheUJ1ZmZlcikge1xuICAgIHZhciB1aW50OFZlcnNpb24gPSBuZXcgVWludDhBcnJheShhcnJheUJ1ZmZlcik7XG4gICAgcmV0dXJuIHdpbmRvdy5idG9hKFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgdWludDhWZXJzaW9uKSk7XG59XG5leHBvcnRzLmRlZmF1bHQgPSBmdW5jdGlvbiAoYXJyYXlCdWZmZXIpIHtcbiAgICB2YXIgYmFzZTY0U3RyaW5nID0gdG9CYXNlNjQoYXJyYXlCdWZmZXIpO1xuICAgIHJldHVybiBiYXNlNjRTdHJpbmdcbiAgICAgICAgLnJlcGxhY2UoLz0vZywgJycpXG4gICAgICAgIC5yZXBsYWNlKC9cXCsvZywgJy0nKVxuICAgICAgICAucmVwbGFjZSgvXFwvL2csICdfJyk7XG59O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcnJheS1idWZmZXItdG8tYmFzZTY0LmpzLm1hcFxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbid1c2Ugc3RyaWN0Jztcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHtcbiAgICBwYXRoOiAnL2ZpcmViYXNlLW1lc3NhZ2luZy1zdy5qcycsXG4gICAgc2NvcGU6ICcvZmlyZWJhc2UtY2xvdWQtbWVzc2FnaW5nLXB1c2gtc2NvcGUnXG59O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1kZWZhdWx0LXN3LmpzLm1hcFxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbid1c2Ugc3RyaWN0Jztcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBDT0RFUyA9IHtcbiAgICBBVkFJTEFCTEVfSU5fV0lORE9XOiAnb25seS1hdmFpbGFibGUtaW4td2luZG93JyxcbiAgICBBVkFJTEFCTEVfSU5fU1c6ICdvbmx5LWF2YWlsYWJsZS1pbi1zdycsXG4gICAgU0hPVUxEX0JFX0lOSEVSSVRFRDogJ3Nob3VsZC1iZS1vdmVycmlkZW4nLFxuICAgIEJBRF9TRU5ERVJfSUQ6ICdiYWQtc2VuZGVyLWlkJyxcbiAgICBJTkNPUlJFQ1RfR0NNX1NFTkRFUl9JRDogJ2luY29ycmVjdC1nY20tc2VuZGVyLWlkJyxcbiAgICBQRVJNSVNTSU9OX0RFRkFVTFQ6ICdwZXJtaXNzaW9uLWRlZmF1bHQnLFxuICAgIFBFUk1JU1NJT05fQkxPQ0tFRDogJ3Blcm1pc3Npb24tYmxvY2tlZCcsXG4gICAgVU5TVVBQT1JURURfQlJPV1NFUjogJ3Vuc3VwcG9ydGVkLWJyb3dzZXInLFxuICAgIE5PVElGSUNBVElPTlNfQkxPQ0tFRDogJ25vdGlmaWNhdGlvbnMtYmxvY2tlZCcsXG4gICAgRkFJTEVEX0RFRkFVTFRfUkVHSVNUUkFUSU9OOiAnZmFpbGVkLXNlcnZpY2V3b3JrZXItcmVnaXN0cmF0aW9uJyxcbiAgICBTV19SRUdJU1RSQVRJT05fRVhQRUNURUQ6ICdzdy1yZWdpc3RyYXRpb24tZXhwZWN0ZWQnLFxuICAgIEdFVF9TVUJTQ1JJUFRJT05fRkFJTEVEOiAnZ2V0LXN1YnNjcmlwdGlvbi1mYWlsZWQnLFxuICAgIElOVkFMSURfU0FWRURfVE9LRU46ICdpbnZhbGlkLXNhdmVkLXRva2VuJyxcbiAgICBTV19SRUdfUkVEVU5EQU5UOiAnc3ctcmVnLXJlZHVuZGFudCcsXG4gICAgVE9LRU5fU1VCU0NSSUJFX0ZBSUxFRDogJ3Rva2VuLXN1YnNjcmliZS1mYWlsZWQnLFxuICAgIFRPS0VOX1NVQlNDUklCRV9OT19UT0tFTjogJ3Rva2VuLXN1YnNjcmliZS1uby10b2tlbicsXG4gICAgVE9LRU5fU1VCU0NSSUJFX05PX1BVU0hfU0VUOiAndG9rZW4tc3Vic2NyaWJlLW5vLXB1c2gtc2V0JyxcbiAgICBVU0VfU1dfQkVGT1JFX0dFVF9UT0tFTjogJ3VzZS1zdy1iZWZvcmUtZ2V0LXRva2VuJyxcbiAgICBJTlZBTElEX0RFTEVURV9UT0tFTjogJ2ludmFsaWQtZGVsZXRlLXRva2VuJyxcbiAgICBERUxFVEVfVE9LRU5fTk9UX0ZPVU5EOiAnZGVsZXRlLXRva2VuLW5vdC1mb3VuZCcsXG4gICAgREVMRVRFX1NDT1BFX05PVF9GT1VORDogJ2RlbGV0ZS1zY29wZS1ub3QtZm91bmQnLFxuICAgIEJHX0hBTkRMRVJfRlVOQ1RJT05fRVhQRUNURUQ6ICdiZy1oYW5kbGVyLWZ1bmN0aW9uLWV4cGVjdGVkJyxcbiAgICBOT19XSU5ET1dfQ0xJRU5UX1RPX01TRzogJ25vLXdpbmRvdy1jbGllbnQtdG8tbXNnJyxcbiAgICBVTkFCTEVfVE9fUkVTVUJTQ1JJQkU6ICd1bmFibGUtdG8tcmVzdWJzY3JpYmUnLFxuICAgIE5PX0ZDTV9UT0tFTl9GT1JfUkVTVUJTQ1JJQkU6ICduby1mY20tdG9rZW4tZm9yLXJlc3Vic2NyaWJlJyxcbiAgICBGQUlMRURfVE9fREVMRVRFX1RPS0VOOiAnZmFpbGVkLXRvLWRlbGV0ZS10b2tlbicsXG4gICAgTk9fU1dfSU5fUkVHOiAnbm8tc3ctaW4tcmVnJyxcbiAgICBCQURfU0NPUEU6ICdiYWQtc2NvcGUnLFxuICAgIEJBRF9WQVBJRF9LRVk6ICdiYWQtdmFwaWQta2V5JyxcbiAgICBCQURfU1VCU0NSSVBUSU9OOiAnYmFkLXN1YnNjcmlwdGlvbicsXG4gICAgQkFEX1RPS0VOOiAnYmFkLXRva2VuJyxcbiAgICBCQURfUFVTSF9TRVQ6ICdiYWQtcHVzaC1zZXQnLFxuICAgIEZBSUxFRF9ERUxFVEVfVkFQSURfS0VZOiAnZmFpbGVkLWRlbGV0ZS12YXBpZC1rZXknXG59O1xudmFyIEVSUk9SX01BUCA9IChfYSA9IHt9LFxuICAgIF9hW0NPREVTLkFWQUlMQUJMRV9JTl9XSU5ET1ddID0gJ1RoaXMgbWV0aG9kIGlzIGF2YWlsYWJsZSBpbiBhIFdpbmRvdyBjb250ZXh0LicsXG4gICAgX2FbQ09ERVMuQVZBSUxBQkxFX0lOX1NXXSA9ICdUaGlzIG1ldGhvZCBpcyBhdmFpbGFibGUgaW4gYSBzZXJ2aWNlIHdvcmtlciAnICsgJ2NvbnRleHQuJyxcbiAgICBfYVtDT0RFUy5TSE9VTERfQkVfSU5IRVJJVEVEXSA9ICdUaGlzIG1ldGhvZCBzaG91bGQgYmUgb3ZlcnJpZGVuIGJ5ICcgKyAnZXh0ZW5kZWQgY2xhc3Nlcy4nLFxuICAgIF9hW0NPREVTLkJBRF9TRU5ERVJfSURdID0gXCJQbGVhc2UgZW5zdXJlIHRoYXQgJ21lc3NhZ2luZ1NlbmRlcklkJyBpcyBzZXQgXCIgK1xuICAgICAgICAnY29ycmVjdGx5IGluIHRoZSBvcHRpb25zIHBhc3NlZCBpbnRvIGZpcmViYXNlLmluaXRpYWxpemVBcHAoKS4nLFxuICAgIF9hW0NPREVTLlBFUk1JU1NJT05fREVGQVVMVF0gPSAnVGhlIHJlcXVpcmVkIHBlcm1pc3Npb25zIHdlcmUgbm90IGdyYW50ZWQgYW5kICcgKyAnZGlzbWlzc2VkIGluc3RlYWQuJyxcbiAgICBfYVtDT0RFUy5QRVJNSVNTSU9OX0JMT0NLRURdID0gJ1RoZSByZXF1aXJlZCBwZXJtaXNzaW9ucyB3ZXJlIG5vdCBncmFudGVkIGFuZCAnICsgJ2Jsb2NrZWQgaW5zdGVhZC4nLFxuICAgIF9hW0NPREVTLlVOU1VQUE9SVEVEX0JST1dTRVJdID0gXCJUaGlzIGJyb3dzZXIgZG9lc24ndCBzdXBwb3J0IHRoZSBBUEkncyBcIiArXG4gICAgICAgICdyZXF1aXJlZCB0byB1c2UgdGhlIGZpcmViYXNlIFNESy4nLFxuICAgIF9hW0NPREVTLk5PVElGSUNBVElPTlNfQkxPQ0tFRF0gPSAnTm90aWZpY2F0aW9ucyBoYXZlIGJlZW4gYmxvY2tlZC4nLFxuICAgIF9hW0NPREVTLkZBSUxFRF9ERUZBVUxUX1JFR0lTVFJBVElPTl0gPSAnV2UgYXJlIHVuYWJsZSB0byByZWdpc3RlciB0aGUgJyArXG4gICAgICAgICdkZWZhdWx0IHNlcnZpY2Ugd29ya2VyLiB7JGJyb3dzZXJFcnJvck1lc3NhZ2V9JyxcbiAgICBfYVtDT0RFUy5TV19SRUdJU1RSQVRJT05fRVhQRUNURURdID0gJ0Egc2VydmljZSB3b3JrZXIgcmVnaXN0cmF0aW9uIHdhcyB0aGUgJyArICdleHBlY3RlZCBpbnB1dC4nLFxuICAgIF9hW0NPREVTLkdFVF9TVUJTQ1JJUFRJT05fRkFJTEVEXSA9ICdUaGVyZSB3YXMgYW4gZXJyb3Igd2hlbiB0cnlpbmcgdG8gZ2V0ICcgK1xuICAgICAgICAnYW55IGV4aXN0aW5nIFB1c2ggU3Vic2NyaXB0aW9ucy4nLFxuICAgIF9hW0NPREVTLklOVkFMSURfU0FWRURfVE9LRU5dID0gJ1VuYWJsZSB0byBhY2Nlc3MgZGV0YWlscyBvZiB0aGUgc2F2ZWQgdG9rZW4uJyxcbiAgICBfYVtDT0RFUy5TV19SRUdfUkVEVU5EQU5UXSA9ICdUaGUgc2VydmljZSB3b3JrZXIgYmVpbmcgdXNlZCBmb3IgcHVzaCB3YXMgbWFkZSAnICsgJ3JlZHVuZGFudC4nLFxuICAgIF9hW0NPREVTLlRPS0VOX1NVQlNDUklCRV9GQUlMRURdID0gJ0EgcHJvYmxlbSBvY2N1cmVkIHdoaWxlIHN1YnNjcmliaW5nIHRoZSAnICsgJ3VzZXIgdG8gRkNNOiB7JG1lc3NhZ2V9JyxcbiAgICBfYVtDT0RFUy5UT0tFTl9TVUJTQ1JJQkVfTk9fVE9LRU5dID0gJ0ZDTSByZXR1cm5lZCBubyB0b2tlbiB3aGVuIHN1YnNjcmliaW5nICcgKyAndGhlIHVzZXIgdG8gcHVzaC4nLFxuICAgIF9hW0NPREVTLlRPS0VOX1NVQlNDUklCRV9OT19QVVNIX1NFVF0gPSAnRkNNIHJldHVybmVkIGFuIGludmFsaWQgcmVzcG9uc2UgJyArICd3aGVuIGdldHRpbmcgYW4gRkNNIHRva2VuLicsXG4gICAgX2FbQ09ERVMuVVNFX1NXX0JFRk9SRV9HRVRfVE9LRU5dID0gJ1lvdSBtdXN0IGNhbGwgdXNlU2VydmljZVdvcmtlcigpIGJlZm9yZSAnICtcbiAgICAgICAgJ2NhbGxpbmcgZ2V0VG9rZW4oKSB0byBlbnN1cmUgeW91ciBzZXJ2aWNlIHdvcmtlciBpcyB1c2VkLicsXG4gICAgX2FbQ09ERVMuSU5WQUxJRF9ERUxFVEVfVE9LRU5dID0gJ1lvdSBtdXN0IHBhc3MgYSB2YWxpZCB0b2tlbiBpbnRvICcgK1xuICAgICAgICAnZGVsZXRlVG9rZW4oKSwgaS5lLiB0aGUgdG9rZW4gZnJvbSBnZXRUb2tlbigpLicsXG4gICAgX2FbQ09ERVMuREVMRVRFX1RPS0VOX05PVF9GT1VORF0gPSAnVGhlIGRlbGV0aW9uIGF0dGVtcHQgZm9yIHRva2VuIGNvdWxkIG5vdCAnICtcbiAgICAgICAgJ2JlIHBlcmZvcm1lZCBhcyB0aGUgdG9rZW4gd2FzIG5vdCBmb3VuZC4nLFxuICAgIF9hW0NPREVTLkRFTEVURV9TQ09QRV9OT1RfRk9VTkRdID0gJ1RoZSBkZWxldGlvbiBhdHRlbXB0IGZvciBzZXJ2aWNlIHdvcmtlciAnICtcbiAgICAgICAgJ3Njb3BlIGNvdWxkIG5vdCBiZSBwZXJmb3JtZWQgYXMgdGhlIHNjb3BlIHdhcyBub3QgZm91bmQuJyxcbiAgICBfYVtDT0RFUy5CR19IQU5ETEVSX0ZVTkNUSU9OX0VYUEVDVEVEXSA9ICdUaGUgaW5wdXQgdG8gJyArICdzZXRCYWNrZ3JvdW5kTWVzc2FnZUhhbmRsZXIoKSBtdXN0IGJlIGEgZnVuY3Rpb24uJyxcbiAgICBfYVtDT0RFUy5OT19XSU5ET1dfQ0xJRU5UX1RPX01TR10gPSAnQW4gYXR0ZW1wdCB3YXMgbWFkZSB0byBtZXNzYWdlIGEgJyArICdub24tZXhpc3RhbnQgd2luZG93IGNsaWVudC4nLFxuICAgIF9hW0NPREVTLlVOQUJMRV9UT19SRVNVQlNDUklCRV0gPSAnVGhlcmUgd2FzIGFuIGVycm9yIHdoaWxlIHJlLXN1YnNjcmliaW5nICcgK1xuICAgICAgICAndGhlIEZDTSB0b2tlbiBmb3IgcHVzaCBtZXNzYWdpbmcuIFdpbGwgaGF2ZSB0byByZXN1YnNjcmliZSB0aGUgJyArXG4gICAgICAgICd1c2VyIG9uIG5leHQgdmlzaXQuIHskbWVzc2FnZX0nLFxuICAgIF9hW0NPREVTLk5PX0ZDTV9UT0tFTl9GT1JfUkVTVUJTQ1JJQkVdID0gJ0NvdWxkIG5vdCBmaW5kIGFuIEZDTSB0b2tlbiAnICtcbiAgICAgICAgJ2FuZCBhcyBhIHJlc3VsdCwgdW5hYmxlIHRvIHJlc3Vic2NyaWJlLiBXaWxsIGhhdmUgdG8gcmVzdWJzY3JpYmUgdGhlICcgK1xuICAgICAgICAndXNlciBvbiBuZXh0IHZpc2l0LicsXG4gICAgX2FbQ09ERVMuRkFJTEVEX1RPX0RFTEVURV9UT0tFTl0gPSAnVW5hYmxlIHRvIGRlbGV0ZSB0aGUgY3VycmVudGx5IHNhdmVkIHRva2VuLicsXG4gICAgX2FbQ09ERVMuTk9fU1dfSU5fUkVHXSA9ICdFdmVuIHRob3VnaCB0aGUgc2VydmljZSB3b3JrZXIgcmVnaXN0cmF0aW9uIHdhcyAnICtcbiAgICAgICAgJ3N1Y2Nlc3NmdWwsIHRoZXJlIHdhcyBhIHByb2JsZW0gYWNjZXNzaW5nIHRoZSBzZXJ2aWNlIHdvcmtlciBpdHNlbGYuJyxcbiAgICBfYVtDT0RFUy5JTkNPUlJFQ1RfR0NNX1NFTkRFUl9JRF0gPSBcIlBsZWFzZSBjaGFuZ2UgeW91ciB3ZWIgYXBwIG1hbmlmZXN0J3MgXCIgK1xuICAgICAgICBcIidnY21fc2VuZGVyX2lkJyB2YWx1ZSB0byAnMTAzOTUzODAwNTA3JyB0byB1c2UgRmlyZWJhc2UgbWVzc2FnaW5nLlwiLFxuICAgIF9hW0NPREVTLkJBRF9TQ09QRV0gPSAnVGhlIHNlcnZpY2Ugd29ya2VyIHNjb3BlIG11c3QgYmUgYSBzdHJpbmcgd2l0aCBhdCAnICtcbiAgICAgICAgJ2xlYXN0IG9uZSBjaGFyYWN0ZXIuJyxcbiAgICBfYVtDT0RFUy5CQURfVkFQSURfS0VZXSA9ICdUaGUgcHVibGljIFZBUElEIGtleSBtdXN0IGJlIGEgc3RyaW5nIHdpdGggYXQgJyArICdsZWFzdCBvbmUgY2hhcmFjdGVyLicsXG4gICAgX2FbQ09ERVMuQkFEX1NVQlNDUklQVElPTl0gPSAnVGhlIHN1YnNjcmlwdGlvbiBtdXN0IGJlIGEgdmFsaWQgJyArICdQdXNoU3Vic2NyaXB0aW9uLicsXG4gICAgX2FbQ09ERVMuQkFEX1RPS0VOXSA9ICdUaGUgRkNNIFRva2VuIHVzZWQgZm9yIHN0b3JhZ2UgLyBsb29rdXAgd2FzIG5vdCAnICtcbiAgICAgICAgJ2EgdmFsaWQgdG9rZW4gc3RyaW5nLicsXG4gICAgX2FbQ09ERVMuQkFEX1BVU0hfU0VUXSA9ICdUaGUgRkNNIHB1c2ggc2V0IHVzZWQgZm9yIHN0b3JhZ2UgLyBsb29rdXAgd2FzIG5vdCAnICtcbiAgICAgICAgJ25vdCBhIHZhbGlkIHB1c2ggc2V0IHN0cmluZy4nLFxuICAgIF9hW0NPREVTLkZBSUxFRF9ERUxFVEVfVkFQSURfS0VZXSA9ICdUaGUgVkFQSUQga2V5IGNvdWxkIG5vdCBiZSBkZWxldGVkLicsXG4gICAgX2EpO1xuZXhwb3J0cy5kZWZhdWx0ID0ge1xuICAgIGNvZGVzOiBDT0RFUyxcbiAgICBtYXA6IEVSUk9SX01BUFxufTtcbnZhciBfYTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZXJyb3JzLmpzLm1hcFxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbid1c2Ugc3RyaWN0Jztcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBGQ01fQVBQTElDQVRJT05fU0VSVkVSX0tFWSA9IFtcbiAgICAweDA0LFxuICAgIDB4MzMsXG4gICAgMHg5NCxcbiAgICAweGY3LFxuICAgIDB4ZGYsXG4gICAgMHhhMSxcbiAgICAweGViLFxuICAgIDB4YjEsXG4gICAgMHhkYyxcbiAgICAweDAzLFxuICAgIDB4YTIsXG4gICAgMHg1ZSxcbiAgICAweDE1LFxuICAgIDB4NzEsXG4gICAgMHhkYixcbiAgICAweDQ4LFxuICAgIDB4ZDMsXG4gICAgMHgyZSxcbiAgICAweGVkLFxuICAgIDB4ZWQsXG4gICAgMHhiMixcbiAgICAweDM0LFxuICAgIDB4ZGIsXG4gICAgMHhiNyxcbiAgICAweDQ3LFxuICAgIDB4M2EsXG4gICAgMHgwYyxcbiAgICAweDhmLFxuICAgIDB4YzQsXG4gICAgMHhjYyxcbiAgICAweGUxLFxuICAgIDB4NmYsXG4gICAgMHgzYyxcbiAgICAweDhjLFxuICAgIDB4ODQsXG4gICAgMHhkZixcbiAgICAweGFiLFxuICAgIDB4YjYsXG4gICAgMHg2NixcbiAgICAweDNlLFxuICAgIDB4ZjIsXG4gICAgMHgwYyxcbiAgICAweGQ0LFxuICAgIDB4OGIsXG4gICAgMHhmZSxcbiAgICAweGUzLFxuICAgIDB4ZjksXG4gICAgMHg3NixcbiAgICAweDJmLFxuICAgIDB4MTQsXG4gICAgMHgxYyxcbiAgICAweDYzLFxuICAgIDB4MDgsXG4gICAgMHg2YSxcbiAgICAweDZmLFxuICAgIDB4MmQsXG4gICAgMHhiMSxcbiAgICAweDFhLFxuICAgIDB4OTUsXG4gICAgMHhiMCxcbiAgICAweGNlLFxuICAgIDB4MzcsXG4gICAgMHhjMCxcbiAgICAweDljLFxuICAgIDB4NmVcbl07XG52YXIgU1VCU0NSSVBUSU9OX0RFVEFJTFMgPSB7XG4gICAgdXNlclZpc2libGVPbmx5OiB0cnVlLFxuICAgIGFwcGxpY2F0aW9uU2VydmVyS2V5OiBuZXcgVWludDhBcnJheShGQ01fQVBQTElDQVRJT05fU0VSVkVSX0tFWSlcbn07XG5leHBvcnRzLmRlZmF1bHQgPSB7XG4gICAgRU5EUE9JTlQ6ICdodHRwczovL2ZjbS5nb29nbGVhcGlzLmNvbScsXG4gICAgQVBQTElDQVRJT05fU0VSVkVSX0tFWTogRkNNX0FQUExJQ0FUSU9OX1NFUlZFUl9LRVksXG4gICAgU1VCU0NSSVBUSU9OX09QVElPTlM6IFNVQlNDUklQVElPTl9ERVRBSUxTXG59O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1mY20tZGV0YWlscy5qcy5tYXBcbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4ndXNlIHN0cmljdCc7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLmRlZmF1bHQgPSB7XG4gICAgZ3JhbnRlZDogJ2dyYW50ZWQnLFxuICAgIGRlZmF1bHQ6ICdkZWZhdWx0JyxcbiAgICBkZW5pZWQ6ICdkZW5pZWQnXG59O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1ub3RpZmljYXRpb24tcGVybWlzc2lvbi5qcy5tYXBcbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4ndXNlIHN0cmljdCc7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdXRpbF8xID0gcmVxdWlyZShcIkBmaXJlYmFzZS91dGlsXCIpO1xudmFyIGVycm9yc18xID0gcmVxdWlyZShcIi4vZXJyb3JzXCIpO1xudmFyIGFycmF5X2J1ZmZlcl90b19iYXNlNjRfMSA9IHJlcXVpcmUoXCIuLi9oZWxwZXJzL2FycmF5LWJ1ZmZlci10by1iYXNlNjRcIik7XG52YXIgZmNtX2RldGFpbHNfMSA9IHJlcXVpcmUoXCIuL2ZjbS1kZXRhaWxzXCIpO1xudmFyIEZDTV9UT0tFTl9PQkpfU1RPUkUgPSAnZmNtX3Rva2VuX29iamVjdF9TdG9yZSc7XG52YXIgRkNNX1RPS0VOX0RFVEFJTFNfREJfVkVSU0lPTiA9IDE7XG52YXIgVG9rZW5NYW5hZ2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFRva2VuTWFuYWdlcigpIHtcbiAgICAgICAgdGhpcy5lcnJvckZhY3RvcnlfID0gbmV3IHV0aWxfMS5FcnJvckZhY3RvcnkoJ21lc3NhZ2luZycsICdNZXNzYWdpbmcnLCBlcnJvcnNfMS5kZWZhdWx0Lm1hcCk7XG4gICAgICAgIHRoaXMub3BlbkRiUHJvbWlzZV8gPSBudWxsO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGluZGV4ZWREQiBhcyBhIHByb21zaWUuXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcmV0dXJuIHtQcm9taXNlPElEQkRhdGFiYXNlPn0gVGhlIEluZGV4ZWREQiBkYXRhYmFzZVxuICAgICAqL1xuICAgIFRva2VuTWFuYWdlci5wcm90b3R5cGUub3BlbkRhdGFiYXNlXyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMub3BlbkRiUHJvbWlzZV8pIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm9wZW5EYlByb21pc2VfO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMub3BlbkRiUHJvbWlzZV8gPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICB2YXIgcmVxdWVzdCA9IGluZGV4ZWREQi5vcGVuKFRva2VuTWFuYWdlci5EQl9OQU1FLCBGQ01fVE9LRU5fREVUQUlMU19EQl9WRVJTSU9OKTtcbiAgICAgICAgICAgIHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIHJlamVjdChldmVudC50YXJnZXQuZXJyb3IpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShldmVudC50YXJnZXQucmVzdWx0KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXF1ZXN0Lm9udXBncmFkZW5lZWRlZCA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIHZhciBkYiA9IGV2ZW50LnRhcmdldC5yZXN1bHQ7XG4gICAgICAgICAgICAgICAgdmFyIG9iamVjdFN0b3JlID0gZGIuY3JlYXRlT2JqZWN0U3RvcmUoRkNNX1RPS0VOX09CSl9TVE9SRSwge1xuICAgICAgICAgICAgICAgICAgICBrZXlQYXRoOiAnc3dTY29wZSdcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAvLyBNYWtlIHN1cmUgdGhlIHNlbmRlciBJRCBjYW4gYmUgc2VhcmNoZWRcbiAgICAgICAgICAgICAgICBvYmplY3RTdG9yZS5jcmVhdGVJbmRleCgnZmNtU2VuZGVySWQnLCAnZmNtU2VuZGVySWQnLCB7XG4gICAgICAgICAgICAgICAgICAgIHVuaXF1ZTogZmFsc2VcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBvYmplY3RTdG9yZS5jcmVhdGVJbmRleCgnZmNtVG9rZW4nLCAnZmNtVG9rZW4nLCB7XG4gICAgICAgICAgICAgICAgICAgIHVuaXF1ZTogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB0aGlzLm9wZW5EYlByb21pc2VfO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQ2xvc2UgdGhlIGN1cnJlbnRseSBvcGVuIGRhdGFiYXNlLlxuICAgICAqIEByZXR1cm4ge1Byb21pc2U8Pz59IFJldHVybnMgdGhlIHJlc3VsdCBvZiB0aGUgcHJvbWlzZSBjaGFpbi5cbiAgICAgKi9cbiAgICBUb2tlbk1hbmFnZXIucHJvdG90eXBlLmNsb3NlRGF0YWJhc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh0aGlzLm9wZW5EYlByb21pc2VfKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5vcGVuRGJQcm9taXNlXy50aGVuKGZ1bmN0aW9uIChkYikge1xuICAgICAgICAgICAgICAgIGRiLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgX3RoaXMub3BlbkRiUHJvbWlzZV8gPSBudWxsO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2l2ZW4gYSB0b2tlbiwgdGhpcyBtZXRob2Qgd2lsbCBsb29rIHVwIHRoZSBkZXRhaWxzIGluIGluZGV4ZWREQi5cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGZjbVRva2VuXG4gICAgICogQHJldHVybiB7UHJvbWlzZTxPYmplY3Q+fSBUaGUgZGV0YWlscyBhc3NvY2lhdGVkIHdpdGggdGhhdCB0b2tlbi5cbiAgICAgKi9cbiAgICBUb2tlbk1hbmFnZXIucHJvdG90eXBlLmdldFRva2VuRGV0YWlsc0Zyb21Ub2tlbiA9IGZ1bmN0aW9uIChmY21Ub2tlbikge1xuICAgICAgICByZXR1cm4gdGhpcy5vcGVuRGF0YWJhc2VfKCkudGhlbihmdW5jdGlvbiAoZGIpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRyYW5zYWN0aW9uID0gZGIudHJhbnNhY3Rpb24oW0ZDTV9UT0tFTl9PQkpfU1RPUkVdKTtcbiAgICAgICAgICAgICAgICB2YXIgb2JqZWN0U3RvcmUgPSB0cmFuc2FjdGlvbi5vYmplY3RTdG9yZShGQ01fVE9LRU5fT0JKX1NUT1JFKTtcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBvYmplY3RTdG9yZS5pbmRleCgnZmNtVG9rZW4nKTtcbiAgICAgICAgICAgICAgICB2YXIgcmVxdWVzdCA9IGluZGV4LmdldChmY21Ub2tlbik7XG4gICAgICAgICAgICAgICAgcmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChldmVudC50YXJnZXQuZXJyb3IpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShldmVudC50YXJnZXQucmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgVG9rZW5NYW5hZ2VyLnByb3RvdHlwZS5nZXRUb2tlbkRldGFpbHNGcm9tU1dTY29wZV8gPSBmdW5jdGlvbiAoc3dTY29wZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5vcGVuRGF0YWJhc2VfKCkudGhlbihmdW5jdGlvbiAoZGIpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRyYW5zYWN0aW9uID0gZGIudHJhbnNhY3Rpb24oW0ZDTV9UT0tFTl9PQkpfU1RPUkVdKTtcbiAgICAgICAgICAgICAgICB2YXIgb2JqZWN0U3RvcmUgPSB0cmFuc2FjdGlvbi5vYmplY3RTdG9yZShGQ01fVE9LRU5fT0JKX1NUT1JFKTtcbiAgICAgICAgICAgICAgICB2YXIgc2NvcGVSZXF1ZXN0ID0gb2JqZWN0U3RvcmUuZ2V0KHN3U2NvcGUpO1xuICAgICAgICAgICAgICAgIHNjb3BlUmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChldmVudC50YXJnZXQuZXJyb3IpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgc2NvcGVSZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGV2ZW50LnRhcmdldC5yZXN1bHQpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBUb2tlbk1hbmFnZXIucHJvdG90eXBlLmdldEFsbFRva2VuRGV0YWlsc0ZvclNlbmRlcklkXyA9IGZ1bmN0aW9uIChzZW5kZXJJZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vcGVuRGF0YWJhc2VfKCkudGhlbihmdW5jdGlvbiAoZGIpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRyYW5zYWN0aW9uID0gZGIudHJhbnNhY3Rpb24oW0ZDTV9UT0tFTl9PQkpfU1RPUkVdKTtcbiAgICAgICAgICAgICAgICB2YXIgb2JqZWN0U3RvcmUgPSB0cmFuc2FjdGlvbi5vYmplY3RTdG9yZShGQ01fVE9LRU5fT0JKX1NUT1JFKTtcbiAgICAgICAgICAgICAgICB2YXIgc2VuZGVySWRUb2tlbnMgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgY3Vyc29yUmVxdWVzdCA9IG9iamVjdFN0b3JlLm9wZW5DdXJzb3IoKTtcbiAgICAgICAgICAgICAgICBjdXJzb3JSZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGV2ZW50LnRhcmdldC5lcnJvcik7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBjdXJzb3JSZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY3Vyc29yID0gZXZlbnQudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnNvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnNvci52YWx1ZVsnZmNtU2VuZGVySWQnXSA9PT0gc2VuZGVySWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZW5kZXJJZFRva2Vucy5wdXNoKGN1cnNvci52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJzb3IuY29udGludWUoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc2VuZGVySWRUb2tlbnMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdpdmVuIGEgUHVzaFN1YnNjcmlwdGlvbiBhbmQgbWVzc2FnaW5nU2VuZGVySWQsIGdldCBhbiBGQ00gdG9rZW4uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSAge3N0cmluZ30gc2VuZGVySWQgVGhlICdtZXNzYWdpbmdTZW5kZXJJZCcgdG8gdGllIHRoZSB0b2tlbiB0by5cbiAgICAgKiBAcGFyYW0gIHtQdXNoU3Vic2NyaXB0aW9ufSBzdWJzY3JpcHRpb24gVGhlIFB1c2hTdXNiY3JpcHRpb24gdG8gXCJmZWRlcmF0ZVwiLlxuICAgICAqIEBwYXJhbSAge3N0cmluZz19IHB1c2hTZXQgSWYgZGVmaW5lZCB0aGlzIHdpbGwgc3dhcCB0aGUgc3Vic2NyaXB0aW9uIGZvclxuICAgICAqIG1hdGNoaW5nIEZDTSB0b2tlbi5cbiAgICAgKiBAcmV0dXJuIHtQcm9taXNlPCFPYmplY3Q+fSBSZXR1cm5zIHRoZSBGQ00gdG9rZW4gdG8gYmUgdXNlZCBpbiBwbGFjZVxuICAgICAqIG9mIHRoZSBQdXNoU3Vic2NyaXB0aW9uLlxuICAgICAqL1xuICAgIFRva2VuTWFuYWdlci5wcm90b3R5cGUuc3Vic2NyaWJlVG9GQ00gPSBmdW5jdGlvbiAoc2VuZGVySWQsIHN1YnNjcmlwdGlvbiwgcHVzaFNldCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgcDI1NmRoID0gYXJyYXlfYnVmZmVyX3RvX2Jhc2U2NF8xLmRlZmF1bHQoc3Vic2NyaXB0aW9uWydnZXRLZXknXSgncDI1NmRoJykpO1xuICAgICAgICB2YXIgYXV0aCA9IGFycmF5X2J1ZmZlcl90b19iYXNlNjRfMS5kZWZhdWx0KHN1YnNjcmlwdGlvblsnZ2V0S2V5J10oJ2F1dGgnKSk7XG4gICAgICAgIHZhciBmY21TdWJzY3JpYmVCb2R5ID0gXCJhdXRob3JpemVkX2VudGl0eT1cIiArIHNlbmRlcklkICsgXCImXCIgK1xuICAgICAgICAgICAgKFwiZW5kcG9pbnQ9XCIgKyBzdWJzY3JpcHRpb24uZW5kcG9pbnQgKyBcIiZcIikgK1xuICAgICAgICAgICAgKFwiZW5jcnlwdGlvbl9rZXk9XCIgKyBwMjU2ZGggKyBcIiZcIikgK1xuICAgICAgICAgICAgKFwiZW5jcnlwdGlvbl9hdXRoPVwiICsgYXV0aCk7XG4gICAgICAgIGlmIChwdXNoU2V0KSB7XG4gICAgICAgICAgICBmY21TdWJzY3JpYmVCb2R5ICs9IFwiJnB1c2hTZXQ9XCIgKyBwdXNoU2V0O1xuICAgICAgICB9XG4gICAgICAgIHZhciBoZWFkZXJzID0gbmV3IEhlYWRlcnMoKTtcbiAgICAgICAgaGVhZGVycy5hcHBlbmQoJ0NvbnRlbnQtVHlwZScsICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnKTtcbiAgICAgICAgdmFyIHN1YnNjcmliZU9wdGlvbnMgPSB7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnMsXG4gICAgICAgICAgICBib2R5OiBmY21TdWJzY3JpYmVCb2R5XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBmZXRjaChmY21fZGV0YWlsc18xLmRlZmF1bHQuRU5EUE9JTlQgKyAnL2ZjbS9jb25uZWN0L3N1YnNjcmliZScsIHN1YnNjcmliZU9wdGlvbnMpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTsgfSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgdmFyIGZjbVRva2VuUmVzcG9uc2UgPSByZXNwb25zZTtcbiAgICAgICAgICAgIGlmIChmY21Ub2tlblJlc3BvbnNlWydlcnJvciddKSB7XG4gICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSBmY21Ub2tlblJlc3BvbnNlWydlcnJvciddWydtZXNzYWdlJ107XG4gICAgICAgICAgICAgICAgdGhyb3cgX3RoaXMuZXJyb3JGYWN0b3J5Xy5jcmVhdGUoZXJyb3JzXzEuZGVmYXVsdC5jb2Rlcy5UT0tFTl9TVUJTQ1JJQkVfRkFJTEVELCB7XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2VcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghZmNtVG9rZW5SZXNwb25zZVsndG9rZW4nXSkge1xuICAgICAgICAgICAgICAgIHRocm93IF90aGlzLmVycm9yRmFjdG9yeV8uY3JlYXRlKGVycm9yc18xLmRlZmF1bHQuY29kZXMuVE9LRU5fU1VCU0NSSUJFX05PX1RPS0VOKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghZmNtVG9rZW5SZXNwb25zZVsncHVzaFNldCddKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgX3RoaXMuZXJyb3JGYWN0b3J5Xy5jcmVhdGUoZXJyb3JzXzEuZGVmYXVsdC5jb2Rlcy5UT0tFTl9TVUJTQ1JJQkVfTk9fUFVTSF9TRVQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB0b2tlbjogZmNtVG9rZW5SZXNwb25zZVsndG9rZW4nXSxcbiAgICAgICAgICAgICAgICBwdXNoU2V0OiBmY21Ub2tlblJlc3BvbnNlWydwdXNoU2V0J11cbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQ2hlY2tzIHRoZSB0aGF0IGZpZWxkcyBpbiB0aGUgUHVzaFN1YnNjcmlwdGlvbiBhcmUgZXF1aXZhbGVudCB0byB0aGVcbiAgICAgKiBkZXRhaWxzIHN0b3JlcyBpbiB0aGUgbWFzdGVyVG9rZW5EZXRhaWxzLlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtICB7UHVzaFN1YnNjcmlwdGlvbn0gc3Vic2NyaXB0aW9uIFRoZSBwdXNoIHN1YnNjcmlwdGlvbiB3ZSBleHBlY3RcbiAgICAgKiB0aGUgbWFzdGVyIHRva2VuIHRvIG1hdGNoLlxuICAgICAqIEBwYXJhbSAge09iamVjdH0gIG1hc3RlclRva2VuRGV0YWlscyBUaGUgc2F2ZWQgZGV0YWlscyB3ZSB3aXNoIHRvIGNvbXBhcmVcbiAgICAgKiB3aXRoIHRoZSBQdXNoU3Vic2NyaXB0aW9uXG4gICAgICogQHJldHVybiB7Ym9vbGVhbn0gdHJ1ZSBpZiB0aGUgc3Vic2NyaXB0aW9uIGFuZCB0b2tlbiBkZXRhaWxzIGFyZVxuICAgICAqIGVxdWl2YWxlbnQuXG4gICAgICovXG4gICAgVG9rZW5NYW5hZ2VyLnByb3RvdHlwZS5pc1NhbWVTdWJzY3JpcHRpb25fID0gZnVuY3Rpb24gKHN1YnNjcmlwdGlvbiwgbWFzdGVyVG9rZW5EZXRhaWxzKSB7XG4gICAgICAgIC8vIGdldEtleSgpIGlzbid0IGRlZmluZWQgaW4gdGhlIFB1c2hTdWJzY3JpcHRpb24gZXh0ZXJucyBmaWxlLCBoZW5jZVxuICAgICAgICAvLyBzdWJzY3JpcHRpb25bJ2dldEtleSddKCc8a2V5IG5hbWU+JykuXG4gICAgICAgIHJldHVybiAoc3Vic2NyaXB0aW9uLmVuZHBvaW50ID09PSBtYXN0ZXJUb2tlbkRldGFpbHNbJ2VuZHBvaW50J10gJiZcbiAgICAgICAgICAgIGFycmF5X2J1ZmZlcl90b19iYXNlNjRfMS5kZWZhdWx0KHN1YnNjcmlwdGlvblsnZ2V0S2V5J10oJ2F1dGgnKSkgPT09XG4gICAgICAgICAgICAgICAgbWFzdGVyVG9rZW5EZXRhaWxzWydhdXRoJ10gJiZcbiAgICAgICAgICAgIGFycmF5X2J1ZmZlcl90b19iYXNlNjRfMS5kZWZhdWx0KHN1YnNjcmlwdGlvblsnZ2V0S2V5J10oJ3AyNTZkaCcpKSA9PT1cbiAgICAgICAgICAgICAgICBtYXN0ZXJUb2tlbkRldGFpbHNbJ3AyNTZkaCddKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFNhdmUgdGhlIGRldGFpbHMgZm9yIHRoZSBmY20gdG9rZW4gZm9yIHJlLXVzZSBhdCBhIGxhdGVyIGRhdGUuXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0gIHtzdHJpbmd9IHNlbmRlcklkIFRoZSAnbWVzc2FnaW5nU2VuZGVySWQnIHVzZWQgZm9yIHRoaXMgcHJvamVjdFxuICAgICAqIEBwYXJhbSAge1NlcnZpY2VXb3JrZXJSZWdpc3RyYXRpb259IHN3UmVnaXN0cmF0aW9uIFRoZSBzZXJ2aWNlIHdvcmtlclxuICAgICAqIHVzZWQgdG8gc3Vic2NyaWJlIHRoZSB1c2VyIGZvciB3ZWIgcHVzaFxuICAgICAqIEBwYXJhbSAge1B1c2hTdWJzY3JpcHRpb259IHN1YnNjcmlwdGlvbiBUaGUgcHVzaCBzdWJzY3JpcHRpb24gcGFzc2VkIHRvXG4gICAgICogRkNNIGZvciB0aGUgY3VycmVudCB0b2tlbi5cbiAgICAgKiBAcGFyYW0gIHtzdHJpbmd9IGZjbVRva2VuIFRoZSBGQ00gdG9rZW4gY3VycmVudGx5IHVzZWQgb24gdGhpc1xuICAgICAqIGRldmljZS5cbiAgICAgKiBAcGFyYW0gIHtzdHJpbmd9IGZjbVB1c2hTZXQgVGhlIEZDTSBwdXNoIHRpZWQgdG8gdGhlIGZjbSB0b2tlbi5cbiAgICAgKiBAcmV0dXJuIHtQcm9taXNlPHZvaWQ+fVxuICAgICAqL1xuICAgIFRva2VuTWFuYWdlci5wcm90b3R5cGUuc2F2ZVRva2VuRGV0YWlsc18gPSBmdW5jdGlvbiAoc2VuZGVySWQsIHN3UmVnaXN0cmF0aW9uLCBzdWJzY3JpcHRpb24sIGZjbVRva2VuLCBmY21QdXNoU2V0KSB7XG4gICAgICAgIHZhciBkZXRhaWxzID0ge1xuICAgICAgICAgICAgc3dTY29wZTogc3dSZWdpc3RyYXRpb24uc2NvcGUsXG4gICAgICAgICAgICBlbmRwb2ludDogc3Vic2NyaXB0aW9uLmVuZHBvaW50LFxuICAgICAgICAgICAgYXV0aDogYXJyYXlfYnVmZmVyX3RvX2Jhc2U2NF8xLmRlZmF1bHQoc3Vic2NyaXB0aW9uWydnZXRLZXknXSgnYXV0aCcpKSxcbiAgICAgICAgICAgIHAyNTZkaDogYXJyYXlfYnVmZmVyX3RvX2Jhc2U2NF8xLmRlZmF1bHQoc3Vic2NyaXB0aW9uWydnZXRLZXknXSgncDI1NmRoJykpLFxuICAgICAgICAgICAgZmNtVG9rZW46IGZjbVRva2VuLFxuICAgICAgICAgICAgZmNtUHVzaFNldDogZmNtUHVzaFNldCxcbiAgICAgICAgICAgIGZjbVNlbmRlcklkOiBzZW5kZXJJZFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gdGhpcy5vcGVuRGF0YWJhc2VfKCkudGhlbihmdW5jdGlvbiAoZGIpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRyYW5zYWN0aW9uID0gZGIudHJhbnNhY3Rpb24oW0ZDTV9UT0tFTl9PQkpfU1RPUkVdLCAncmVhZHdyaXRlJyk7XG4gICAgICAgICAgICAgICAgdmFyIG9iamVjdFN0b3JlID0gdHJhbnNhY3Rpb24ub2JqZWN0U3RvcmUoRkNNX1RPS0VOX09CSl9TVE9SRSk7XG4gICAgICAgICAgICAgICAgdmFyIHJlcXVlc3QgPSBvYmplY3RTdG9yZS5wdXQoZGV0YWlscyk7XG4gICAgICAgICAgICAgICAgcmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChldmVudC50YXJnZXQuZXJyb3IpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBzYXZlZCBGQ00gVG9rZW4gaWYgb25lIGlzIGF2YWlsYWJsZSBhbmQgc3RpbGwgdmFsaWQsXG4gICAgICogb3RoZXJ3aXNlIGBudWxsYCBpcyByZXR1cm5lZC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc2VuZGVySWQgVGhpcyBzaG91bGQgYmUgdGhlIHNlbmRlciBJRCBhc3NvY2lhdGVkIHdpdGggdGhlXG4gICAgICogRkNNIFRva2VuIGJlaW5nIHJldHJpZXZlZC5cbiAgICAgKiBAcGFyYW0ge1NlcnZpY2VXb3JrZXJSZWdpc3RyYXRpb259IHN3UmVnaXN0cmF0aW9uIFJlZ2lzdHJhdGlvbiB0byBiZSB1c2VkXG4gICAgICogdG8gc3Vic2NyaWJlIHRoZSB1c2VyIHRvIHB1c2guXG4gICAgICogQHJldHVybiB7UHJvbWlzZTxzdHJpbmc+IHwgUHJvbWlzZX0gUmV0dXJucyB0aGUgc2F2ZWQgRkNNIFRva2VuIGlmXG4gICAgICogYXZpbGFibGUgYW5kIHZhbGlkLlxuICAgICAqIEBleHBvcnRcbiAgICAgKi9cbiAgICBUb2tlbk1hbmFnZXIucHJvdG90eXBlLmdldFNhdmVkVG9rZW4gPSBmdW5jdGlvbiAoc2VuZGVySWQsIHN3UmVnaXN0cmF0aW9uKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICghKHN3UmVnaXN0cmF0aW9uIGluc3RhbmNlb2YgU2VydmljZVdvcmtlclJlZ2lzdHJhdGlvbikpIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCh0aGlzLmVycm9yRmFjdG9yeV8uY3JlYXRlKGVycm9yc18xLmRlZmF1bHQuY29kZXMuU1dfUkVHSVNUUkFUSU9OX0VYUEVDVEVEKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBzZW5kZXJJZCAhPT0gJ3N0cmluZycgfHwgc2VuZGVySWQubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QodGhpcy5lcnJvckZhY3RvcnlfLmNyZWF0ZShlcnJvcnNfMS5kZWZhdWx0LmNvZGVzLkJBRF9TRU5ERVJfSUQpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5nZXRBbGxUb2tlbkRldGFpbHNGb3JTZW5kZXJJZF8oc2VuZGVySWQpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoYWxsVG9rZW5EZXRhaWxzKSB7XG4gICAgICAgICAgICBpZiAoYWxsVG9rZW5EZXRhaWxzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBpbmRleCA9IGFsbFRva2VuRGV0YWlscy5maW5kSW5kZXgoZnVuY3Rpb24gKHRva2VuRGV0YWlscykge1xuICAgICAgICAgICAgICAgIHJldHVybiAoc3dSZWdpc3RyYXRpb24uc2NvcGUgPT09IHRva2VuRGV0YWlsc1snc3dTY29wZSddICYmXG4gICAgICAgICAgICAgICAgICAgIHNlbmRlcklkID09PSB0b2tlbkRldGFpbHNbJ2ZjbVNlbmRlcklkJ10pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoaW5kZXggPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGFsbFRva2VuRGV0YWlsc1tpbmRleF07XG4gICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAodG9rZW5EZXRhaWxzKSB7XG4gICAgICAgICAgICBpZiAoIXRva2VuRGV0YWlscykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBzd1JlZ2lzdHJhdGlvbi5wdXNoTWFuYWdlclxuICAgICAgICAgICAgICAgIC5nZXRTdWJzY3JpcHRpb24oKVxuICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgX3RoaXMuZXJyb3JGYWN0b3J5Xy5jcmVhdGUoZXJyb3JzXzEuZGVmYXVsdC5jb2Rlcy5HRVRfU1VCU0NSSVBUSU9OX0ZBSUxFRCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChzdWJzY3JpcHRpb24pIHtcbiAgICAgICAgICAgICAgICBpZiAoc3Vic2NyaXB0aW9uICYmXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmlzU2FtZVN1YnNjcmlwdGlvbl8oc3Vic2NyaXB0aW9uLCB0b2tlbkRldGFpbHMpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0b2tlbkRldGFpbHNbJ2ZjbVRva2VuJ107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyBGQ00gdG9rZW4uXG4gICAgICovXG4gICAgVG9rZW5NYW5hZ2VyLnByb3RvdHlwZS5jcmVhdGVUb2tlbiA9IGZ1bmN0aW9uIChzZW5kZXJJZCwgc3dSZWdpc3RyYXRpb24pIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHR5cGVvZiBzZW5kZXJJZCAhPT0gJ3N0cmluZycgfHwgc2VuZGVySWQubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QodGhpcy5lcnJvckZhY3RvcnlfLmNyZWF0ZShlcnJvcnNfMS5kZWZhdWx0LmNvZGVzLkJBRF9TRU5ERVJfSUQpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIShzd1JlZ2lzdHJhdGlvbiBpbnN0YW5jZW9mIFNlcnZpY2VXb3JrZXJSZWdpc3RyYXRpb24pKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QodGhpcy5lcnJvckZhY3RvcnlfLmNyZWF0ZShlcnJvcnNfMS5kZWZhdWx0LmNvZGVzLlNXX1JFR0lTVFJBVElPTl9FWFBFQ1RFRCkpO1xuICAgICAgICB9XG4gICAgICAgIC8vIENoZWNrIGZvciBleGlzdGluZyBzdWJzY3JpcHRpb24gZmlyc3RcbiAgICAgICAgdmFyIHN1YnNjcmlwdGlvbjtcbiAgICAgICAgdmFyIGZjbVRva2VuRGV0YWlscztcbiAgICAgICAgcmV0dXJuIHN3UmVnaXN0cmF0aW9uLnB1c2hNYW5hZ2VyXG4gICAgICAgICAgICAuZ2V0U3Vic2NyaXB0aW9uKClcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChzdWJzY3JpcHRpb24pIHtcbiAgICAgICAgICAgIGlmIChzdWJzY3JpcHRpb24pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc3Vic2NyaXB0aW9uO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHN3UmVnaXN0cmF0aW9uLnB1c2hNYW5hZ2VyLnN1YnNjcmliZShmY21fZGV0YWlsc18xLmRlZmF1bHQuU1VCU0NSSVBUSU9OX09QVElPTlMpO1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHN1Yikge1xuICAgICAgICAgICAgc3Vic2NyaXB0aW9uID0gc3ViO1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnN1YnNjcmliZVRvRkNNKHNlbmRlcklkLCBzdWJzY3JpcHRpb24pO1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHRva2VuRGV0YWlscykge1xuICAgICAgICAgICAgZmNtVG9rZW5EZXRhaWxzID0gdG9rZW5EZXRhaWxzO1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnNhdmVUb2tlbkRldGFpbHNfKHNlbmRlcklkLCBzd1JlZ2lzdHJhdGlvbiwgc3Vic2NyaXB0aW9uLCBmY21Ub2tlbkRldGFpbHNbJ3Rva2VuJ10sIGZjbVRva2VuRGV0YWlsc1sncHVzaFNldCddKTtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIGZjbVRva2VuRGV0YWlsc1sndG9rZW4nXTsgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBkZWxldGVzIGRldGFpbHMgb2YgdGhlIGN1cnJlbnQgRkNNIHRva2VuLlxuICAgICAqIEl0J3MgcmV0dXJuaW5nIGEgcHJvbWlzZSBpbiBjYXNlIHdlIG5lZWQgdG8gbW92ZSB0byBhbiBhc3luY1xuICAgICAqIG1ldGhvZCBmb3IgZGVsZXRpbmcgYXQgYSBsYXRlciBkYXRlLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0b2tlbiBUb2tlbiB0byBiZSBkZWxldGVkXG4gICAgICogQHJldHVybiB7UHJvbWlzZTxPYmplY3Q+fSBSZXNvbHZlcyBvbmNlIHRoZSBGQ00gdG9rZW4gZGV0YWlscyBoYXZlIGJlZW5cbiAgICAgKiBkZWxldGVkIGFuZCByZXR1cm5zIHRoZSBkZWxldGVkIGRldGFpbHMuXG4gICAgICovXG4gICAgVG9rZW5NYW5hZ2VyLnByb3RvdHlwZS5kZWxldGVUb2tlbiA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAodHlwZW9mIHRva2VuICE9PSAnc3RyaW5nJyB8fCB0b2tlbi5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCh0aGlzLmVycm9yRmFjdG9yeV8uY3JlYXRlKGVycm9yc18xLmRlZmF1bHQuY29kZXMuSU5WQUxJRF9ERUxFVEVfVE9LRU4pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5nZXRUb2tlbkRldGFpbHNGcm9tVG9rZW4odG9rZW4pLnRoZW4oZnVuY3Rpb24gKGRldGFpbHMpIHtcbiAgICAgICAgICAgIGlmICghZGV0YWlscykge1xuICAgICAgICAgICAgICAgIHRocm93IF90aGlzLmVycm9yRmFjdG9yeV8uY3JlYXRlKGVycm9yc18xLmRlZmF1bHQuY29kZXMuREVMRVRFX1RPS0VOX05PVF9GT1VORCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gX3RoaXMub3BlbkRhdGFiYXNlXygpLnRoZW4oZnVuY3Rpb24gKGRiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zYWN0aW9uID0gZGIudHJhbnNhY3Rpb24oW0ZDTV9UT0tFTl9PQkpfU1RPUkVdLCAncmVhZHdyaXRlJyk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvYmplY3RTdG9yZSA9IHRyYW5zYWN0aW9uLm9iamVjdFN0b3JlKEZDTV9UT0tFTl9PQkpfU1RPUkUpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVxdWVzdCA9IG9iamVjdFN0b3JlLmRlbGV0ZShkZXRhaWxzWydzd1Njb3BlJ10pO1xuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChldmVudC50YXJnZXQuZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5yZXN1bHQgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoX3RoaXMuZXJyb3JGYWN0b3J5Xy5jcmVhdGUoZXJyb3JzXzEuZGVmYXVsdC5jb2Rlcy5GQUlMRURfVE9fREVMRVRFX1RPS0VOKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShkZXRhaWxzKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiBUb2tlbk1hbmFnZXI7XG59KCkpO1xuZXhwb3J0cy5kZWZhdWx0ID0gVG9rZW5NYW5hZ2VyO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD10b2tlbi1tYW5hZ2VyLmpzLm1hcFxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbid1c2Ugc3RyaWN0Jztcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbi8vIFRoZXNlIGZpZWxkcyBhcmUgc3RyaW5ncyB0byBwcmV2ZW50IGNsb3N1cmUgZnJvbSB0aGlua2luZyBnb29nLmdldE1zZ1xuLy8gc2hvdWxkIGJlIHVzZWQgdG8gaW5pdGlhbGlzZSB0aGUgdmFsdWVzXG52YXIgUEFSQU1TID0ge1xuICAgIFRZUEVfT0ZfTVNHOiAnZmlyZWJhc2UtbWVzc2FnaW5nLW1zZy10eXBlJyxcbiAgICBEQVRBOiAnZmlyZWJhc2UtbWVzc2FnaW5nLW1zZy1kYXRhJ1xufTtcbi8vIFRoaXMgdmFsdWUgaXNuJ3QgdXNpbmcgdGhlIFRZUEVfT0ZfTVNHIHNob3J0IGhhbmQgYXMgY2xvc3VyZVxuLy8gZXhwZWN0cyB0aGUgdmFyaWFibGUgdG8gYmUgZGVmaW5lZCB2aWEgZ29vZy5nZXRNc2dcbnZhciBtc2dUeXBlID0ge1xuICAgIFBVU0hfTVNHX1JFQ0VJVkVEOiAncHVzaC1tc2ctcmVjZWl2ZWQnLFxuICAgIE5PVElGSUNBVElPTl9DTElDS0VEOiAnbm90aWZpY2F0aW9uLWNsaWNrZWQnXG59O1xudmFyIGNyZWF0ZU5ld01zZyA9IGZ1bmN0aW9uIChtc2dUeXBlLCBtc2dEYXRhKSB7XG4gICAgdmFyIG1lc3NhZ2UgPSAoX2EgPSB7fSxcbiAgICAgICAgX2FbUEFSQU1TLlRZUEVfT0ZfTVNHXSA9IG1zZ1R5cGUsXG4gICAgICAgIF9hW1BBUkFNUy5EQVRBXSA9IG1zZ0RhdGEsXG4gICAgICAgIF9hKTtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgICB2YXIgX2E7XG59O1xuZXhwb3J0cy5kZWZhdWx0ID0ge1xuICAgIFBBUkFNUzogUEFSQU1TLFxuICAgIFRZUEVTX09GX01TRzogbXNnVHlwZSxcbiAgICBjcmVhdGVOZXdNc2c6IGNyZWF0ZU5ld01zZ1xufTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9d29ya2VyLXBhZ2UtbWVzc2FnZS5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnJlcXVpcmUoXCIuL3NyYy9wb2x5ZmlsbHMvcHJvbWlzZVwiKTtcbnJlcXVpcmUoXCIuL3NyYy9zaGltcy9maW5kXCIpO1xucmVxdWlyZShcIi4vc3JjL3NoaW1zL2ZpbmRJbmRleFwiKTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwXG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xudmFyIF9fZ2xvYmFsID0gKGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgcmV0dXJuIGdsb2JhbDtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHJldHVybiB3aW5kb3c7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgcmV0dXJuIHNlbGY7XG4gICAgfVxuICAgIHRocm93IG5ldyBFcnJvcigndW5hYmxlIHRvIGxvY2F0ZSBnbG9iYWwgb2JqZWN0Jyk7XG59KSgpO1xuLy8gUG9seWZpbGwgUHJvbWlzZVxuaWYgKHR5cGVvZiBQcm9taXNlID09PSAndW5kZWZpbmVkJykge1xuICAgIC8vIEhBQ0s6IFRTIHRocm93cyBhbiBlcnJvciBpZiBJIGF0dGVtcHQgdG8gdXNlICdkb3Qtbm90YXRpb24nXG4gICAgX19nbG9iYWxbJ1Byb21pc2UnXSA9IFByb21pc2UgPSByZXF1aXJlKCdwcm9taXNlLXBvbHlmaWxsJyk7XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXByb21pc2UuanMubWFwXG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBUaGlzIGlzIHRoZSBBcnJheS5wcm90b3R5cGUuZmluZCBwb2x5ZmlsbCBmcm9tIE1ETlxuICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvQXJyYXkvZmluZFxuICogaHR0cHM6Ly90YzM5LmdpdGh1Yi5pby9lY21hMjYyLyNzZWMtYXJyYXkucHJvdG90eXBlLmZpbmRcbiAqL1xuaWYgKCFBcnJheS5wcm90b3R5cGUuZmluZCkge1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBcnJheS5wcm90b3R5cGUsICdmaW5kJywge1xuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgICAgICAgICAgLy8gMS4gTGV0IE8gYmUgPyBUb09iamVjdCh0aGlzIHZhbHVlKS5cbiAgICAgICAgICAgIGlmICh0aGlzID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcInRoaXNcIiBpcyBudWxsIG9yIG5vdCBkZWZpbmVkJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgbyA9IE9iamVjdCh0aGlzKTtcbiAgICAgICAgICAgIC8vIDIuIExldCBsZW4gYmUgPyBUb0xlbmd0aCg/IEdldChPLCBcImxlbmd0aFwiKSkuXG4gICAgICAgICAgICB2YXIgbGVuID0gby5sZW5ndGggPj4+IDA7XG4gICAgICAgICAgICAvLyAzLiBJZiBJc0NhbGxhYmxlKHByZWRpY2F0ZSkgaXMgZmFsc2UsIHRocm93IGEgVHlwZUVycm9yIGV4Y2VwdGlvbi5cbiAgICAgICAgICAgIGlmICh0eXBlb2YgcHJlZGljYXRlICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigncHJlZGljYXRlIG11c3QgYmUgYSBmdW5jdGlvbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gNC4gSWYgdGhpc0FyZyB3YXMgc3VwcGxpZWQsIGxldCBUIGJlIHRoaXNBcmc7IGVsc2UgbGV0IFQgYmUgdW5kZWZpbmVkLlxuICAgICAgICAgICAgdmFyIHRoaXNBcmcgPSBhcmd1bWVudHNbMV07XG4gICAgICAgICAgICAvLyA1LiBMZXQgayBiZSAwLlxuICAgICAgICAgICAgdmFyIGsgPSAwO1xuICAgICAgICAgICAgLy8gNi4gUmVwZWF0LCB3aGlsZSBrIDwgbGVuXG4gICAgICAgICAgICB3aGlsZSAoayA8IGxlbikge1xuICAgICAgICAgICAgICAgIC8vIGEuIExldCBQayBiZSAhIFRvU3RyaW5nKGspLlxuICAgICAgICAgICAgICAgIC8vIGIuIExldCBrVmFsdWUgYmUgPyBHZXQoTywgUGspLlxuICAgICAgICAgICAgICAgIC8vIGMuIExldCB0ZXN0UmVzdWx0IGJlIFRvQm9vbGVhbig/IENhbGwocHJlZGljYXRlLCBULCDCqyBrVmFsdWUsIGssIE8gwrspKS5cbiAgICAgICAgICAgICAgICAvLyBkLiBJZiB0ZXN0UmVzdWx0IGlzIHRydWUsIHJldHVybiBrVmFsdWUuXG4gICAgICAgICAgICAgICAgdmFyIGtWYWx1ZSA9IG9ba107XG4gICAgICAgICAgICAgICAgaWYgKHByZWRpY2F0ZS5jYWxsKHRoaXNBcmcsIGtWYWx1ZSwgaywgbykpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGtWYWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gZS4gSW5jcmVhc2UgayBieSAxLlxuICAgICAgICAgICAgICAgIGsrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIDcuIFJldHVybiB1bmRlZmluZWQuXG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWZpbmQuanMubWFwXG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBUaGlzIGlzIHRoZSBBcnJheS5wcm90b3R5cGUuZmluZEluZGV4IHBvbHlmaWxsIGZyb20gTUROXG4gKiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9BcnJheS9maW5kSW5kZXhcbiAqIGh0dHBzOi8vdGMzOS5naXRodWIuaW8vZWNtYTI2Mi8jc2VjLWFycmF5LnByb3RvdHlwZS5maW5kSW5kZXhcbiAqL1xuaWYgKCFBcnJheS5wcm90b3R5cGUuZmluZEluZGV4KSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5LnByb3RvdHlwZSwgJ2ZpbmRJbmRleCcsIHtcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICAgICAgICAgIC8vIDEuIExldCBPIGJlID8gVG9PYmplY3QodGhpcyB2YWx1ZSkuXG4gICAgICAgICAgICBpZiAodGhpcyA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJ0aGlzXCIgaXMgbnVsbCBvciBub3QgZGVmaW5lZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG8gPSBPYmplY3QodGhpcyk7XG4gICAgICAgICAgICAvLyAyLiBMZXQgbGVuIGJlID8gVG9MZW5ndGgoPyBHZXQoTywgXCJsZW5ndGhcIikpLlxuICAgICAgICAgICAgdmFyIGxlbiA9IG8ubGVuZ3RoID4+PiAwO1xuICAgICAgICAgICAgLy8gMy4gSWYgSXNDYWxsYWJsZShwcmVkaWNhdGUpIGlzIGZhbHNlLCB0aHJvdyBhIFR5cGVFcnJvciBleGNlcHRpb24uXG4gICAgICAgICAgICBpZiAodHlwZW9mIHByZWRpY2F0ZSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ3ByZWRpY2F0ZSBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIDQuIElmIHRoaXNBcmcgd2FzIHN1cHBsaWVkLCBsZXQgVCBiZSB0aGlzQXJnOyBlbHNlIGxldCBUIGJlIHVuZGVmaW5lZC5cbiAgICAgICAgICAgIHZhciB0aGlzQXJnID0gYXJndW1lbnRzWzFdO1xuICAgICAgICAgICAgLy8gNS4gTGV0IGsgYmUgMC5cbiAgICAgICAgICAgIHZhciBrID0gMDtcbiAgICAgICAgICAgIC8vIDYuIFJlcGVhdCwgd2hpbGUgayA8IGxlblxuICAgICAgICAgICAgd2hpbGUgKGsgPCBsZW4pIHtcbiAgICAgICAgICAgICAgICAvLyBhLiBMZXQgUGsgYmUgISBUb1N0cmluZyhrKS5cbiAgICAgICAgICAgICAgICAvLyBiLiBMZXQga1ZhbHVlIGJlID8gR2V0KE8sIFBrKS5cbiAgICAgICAgICAgICAgICAvLyBjLiBMZXQgdGVzdFJlc3VsdCBiZSBUb0Jvb2xlYW4oPyBDYWxsKHByZWRpY2F0ZSwgVCwgwqsga1ZhbHVlLCBrLCBPIMK7KSkuXG4gICAgICAgICAgICAgICAgLy8gZC4gSWYgdGVzdFJlc3VsdCBpcyB0cnVlLCByZXR1cm4gay5cbiAgICAgICAgICAgICAgICB2YXIga1ZhbHVlID0gb1trXTtcbiAgICAgICAgICAgICAgICBpZiAocHJlZGljYXRlLmNhbGwodGhpc0FyZywga1ZhbHVlLCBrLCBvKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gZS4gSW5jcmVhc2UgayBieSAxLlxuICAgICAgICAgICAgICAgIGsrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIDcuIFJldHVybiAtMS5cbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1maW5kSW5kZXguanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgYXBwXzEgPSByZXF1aXJlKFwiQGZpcmViYXNlL2FwcFwiKTtcbnZhciBzdHJpbmdfMSA9IHJlcXVpcmUoXCIuL3NyYy9pbXBsZW1lbnRhdGlvbi9zdHJpbmdcIik7XG52YXIgdGFza2VudW1zXzEgPSByZXF1aXJlKFwiLi9zcmMvaW1wbGVtZW50YXRpb24vdGFza2VudW1zXCIpO1xudmFyIHRhc2tlbnVtc18yID0gcmVxdWlyZShcIi4vc3JjL2ltcGxlbWVudGF0aW9uL3Rhc2tlbnVtc1wiKTtcbnZhciB4aHJpb3Bvb2xfMSA9IHJlcXVpcmUoXCIuL3NyYy9pbXBsZW1lbnRhdGlvbi94aHJpb3Bvb2xcIik7XG52YXIgcmVmZXJlbmNlXzEgPSByZXF1aXJlKFwiLi9zcmMvcmVmZXJlbmNlXCIpO1xudmFyIHNlcnZpY2VfMSA9IHJlcXVpcmUoXCIuL3NyYy9zZXJ2aWNlXCIpO1xuLyoqXG4gKiBUeXBlIGNvbnN0YW50IGZvciBGaXJlYmFzZSBTdG9yYWdlLlxuICovXG52YXIgU1RPUkFHRV9UWVBFID0gJ3N0b3JhZ2UnO1xuZnVuY3Rpb24gZmFjdG9yeShhcHAsIHVudXNlZCwgb3B0X3VybCkge1xuICAgIHJldHVybiBuZXcgc2VydmljZV8xLlNlcnZpY2UoYXBwLCBuZXcgeGhyaW9wb29sXzEuWGhySW9Qb29sKCksIG9wdF91cmwpO1xufVxuZnVuY3Rpb24gcmVnaXN0ZXJTdG9yYWdlKGluc3RhbmNlKSB7XG4gICAgdmFyIG5hbWVzcGFjZUV4cG9ydHMgPSB7XG4gICAgICAgIC8vIG5vLWlubGluZVxuICAgICAgICBUYXNrU3RhdGU6IHRhc2tlbnVtc18yLlRhc2tTdGF0ZSxcbiAgICAgICAgVGFza0V2ZW50OiB0YXNrZW51bXNfMS5UYXNrRXZlbnQsXG4gICAgICAgIFN0cmluZ0Zvcm1hdDogc3RyaW5nXzEuU3RyaW5nRm9ybWF0LFxuICAgICAgICBTdG9yYWdlOiBzZXJ2aWNlXzEuU2VydmljZSxcbiAgICAgICAgUmVmZXJlbmNlOiByZWZlcmVuY2VfMS5SZWZlcmVuY2VcbiAgICB9O1xuICAgIGluc3RhbmNlLklOVEVSTkFMLnJlZ2lzdGVyU2VydmljZShTVE9SQUdFX1RZUEUsIGZhY3RvcnksIG5hbWVzcGFjZUV4cG9ydHMsIHVuZGVmaW5lZCwgXG4gICAgLy8gQWxsb3cgbXVsdGlwbGUgc3RvcmFnZSBpbnN0YW5jZXMgcGVyIGFwcC5cbiAgICB0cnVlKTtcbn1cbmV4cG9ydHMucmVnaXN0ZXJTdG9yYWdlID0gcmVnaXN0ZXJTdG9yYWdlO1xucmVnaXN0ZXJTdG9yYWdlKGFwcF8xLmRlZmF1bHQpO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbnZhciBlcnJvcnNFeHBvcnRzID0gcmVxdWlyZShcIi4vZXJyb3JcIik7XG52YXIgTWV0YWRhdGFVdGlscyA9IHJlcXVpcmUoXCIuL21ldGFkYXRhXCIpO1xudmFyIHR5cGUgPSByZXF1aXJlKFwiLi90eXBlXCIpO1xuLyoqXG4gKiBAcGFyYW0gbmFtZSBOYW1lIG9mIHRoZSBmdW5jdGlvbi5cbiAqIEBwYXJhbSBzcGVjcyBBcmd1bWVudCBzcGVjcy5cbiAqIEBwYXJhbSBwYXNzZWQgVGhlIGFjdHVhbCBhcmd1bWVudHMgcGFzc2VkIHRvIHRoZSBmdW5jdGlvbi5cbiAqIEB0aHJvd3Mge2Zicy5FcnJvcn0gSWYgdGhlIGFyZ3VtZW50cyBhcmUgaW52YWxpZC5cbiAqL1xuZnVuY3Rpb24gdmFsaWRhdGUobmFtZSwgc3BlY3MsIHBhc3NlZCkge1xuICAgIHZhciBtaW5BcmdzID0gc3BlY3MubGVuZ3RoO1xuICAgIHZhciBtYXhBcmdzID0gc3BlY3MubGVuZ3RoO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3BlY3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKHNwZWNzW2ldLm9wdGlvbmFsKSB7XG4gICAgICAgICAgICBtaW5BcmdzID0gaTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhciB2YWxpZExlbmd0aCA9IG1pbkFyZ3MgPD0gcGFzc2VkLmxlbmd0aCAmJiBwYXNzZWQubGVuZ3RoIDw9IG1heEFyZ3M7XG4gICAgaWYgKCF2YWxpZExlbmd0aCkge1xuICAgICAgICB0aHJvdyBlcnJvcnNFeHBvcnRzLmludmFsaWRBcmd1bWVudENvdW50KG1pbkFyZ3MsIG1heEFyZ3MsIG5hbWUsIHBhc3NlZC5sZW5ndGgpO1xuICAgIH1cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhc3NlZC5sZW5ndGg7IGkrKykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgc3BlY3NbaV0udmFsaWRhdG9yKHBhc3NlZFtpXSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGlmIChlIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcnNFeHBvcnRzLmludmFsaWRBcmd1bWVudChpLCBuYW1lLCBlLm1lc3NhZ2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgZXJyb3JzRXhwb3J0cy5pbnZhbGlkQXJndW1lbnQoaSwgbmFtZSwgZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5leHBvcnRzLnZhbGlkYXRlID0gdmFsaWRhdGU7XG4vKipcbiAqIEBzdHJ1Y3RcbiAqL1xudmFyIEFyZ1NwZWMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQXJnU3BlYyh2YWxpZGF0b3IsIG9wdF9vcHRpb25hbCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMudmFsaWRhdG9yID0gZnVuY3Rpb24gKHApIHtcbiAgICAgICAgICAgIGlmIChzZWxmLm9wdGlvbmFsICYmICF0eXBlLmlzSnVzdERlZihwKSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhbGlkYXRvcihwKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5vcHRpb25hbCA9ICEhb3B0X29wdGlvbmFsO1xuICAgIH1cbiAgICByZXR1cm4gQXJnU3BlYztcbn0oKSk7XG5leHBvcnRzLkFyZ1NwZWMgPSBBcmdTcGVjO1xuZnVuY3Rpb24gYW5kXyh2MSwgdjIpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHApIHtcbiAgICAgICAgdjEocCk7XG4gICAgICAgIHYyKHApO1xuICAgIH07XG59XG5leHBvcnRzLmFuZF8gPSBhbmRfO1xuZnVuY3Rpb24gc3RyaW5nU3BlYyhvcHRfdmFsaWRhdG9yLCBvcHRfb3B0aW9uYWwpIHtcbiAgICBmdW5jdGlvbiBzdHJpbmdWYWxpZGF0b3IocCkge1xuICAgICAgICBpZiAoIXR5cGUuaXNTdHJpbmcocCkpIHtcbiAgICAgICAgICAgIHRocm93ICdFeHBlY3RlZCBzdHJpbmcuJztcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgdmFsaWRhdG9yO1xuICAgIGlmIChvcHRfdmFsaWRhdG9yKSB7XG4gICAgICAgIHZhbGlkYXRvciA9IGFuZF8oc3RyaW5nVmFsaWRhdG9yLCBvcHRfdmFsaWRhdG9yKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHZhbGlkYXRvciA9IHN0cmluZ1ZhbGlkYXRvcjtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBBcmdTcGVjKHZhbGlkYXRvciwgb3B0X29wdGlvbmFsKTtcbn1cbmV4cG9ydHMuc3RyaW5nU3BlYyA9IHN0cmluZ1NwZWM7XG5mdW5jdGlvbiB1cGxvYWREYXRhU3BlYygpIHtcbiAgICBmdW5jdGlvbiB2YWxpZGF0b3IocCkge1xuICAgICAgICB2YXIgdmFsaWQgPSBwIGluc3RhbmNlb2YgVWludDhBcnJheSB8fFxuICAgICAgICAgICAgcCBpbnN0YW5jZW9mIEFycmF5QnVmZmVyIHx8XG4gICAgICAgICAgICAodHlwZS5pc05hdGl2ZUJsb2JEZWZpbmVkKCkgJiYgcCBpbnN0YW5jZW9mIEJsb2IpO1xuICAgICAgICBpZiAoIXZhbGlkKSB7XG4gICAgICAgICAgICB0aHJvdyAnRXhwZWN0ZWQgQmxvYiBvciBGaWxlLic7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5ldyBBcmdTcGVjKHZhbGlkYXRvcik7XG59XG5leHBvcnRzLnVwbG9hZERhdGFTcGVjID0gdXBsb2FkRGF0YVNwZWM7XG5mdW5jdGlvbiBtZXRhZGF0YVNwZWMob3B0X29wdGlvbmFsKSB7XG4gICAgcmV0dXJuIG5ldyBBcmdTcGVjKE1ldGFkYXRhVXRpbHMubWV0YWRhdGFWYWxpZGF0b3IsIG9wdF9vcHRpb25hbCk7XG59XG5leHBvcnRzLm1ldGFkYXRhU3BlYyA9IG1ldGFkYXRhU3BlYztcbmZ1bmN0aW9uIG5vbk5lZ2F0aXZlTnVtYmVyU3BlYygpIHtcbiAgICBmdW5jdGlvbiB2YWxpZGF0b3IocCkge1xuICAgICAgICB2YXIgdmFsaWQgPSB0eXBlLmlzTnVtYmVyKHApICYmIHAgPj0gMDtcbiAgICAgICAgaWYgKCF2YWxpZCkge1xuICAgICAgICAgICAgdGhyb3cgJ0V4cGVjdGVkIGEgbnVtYmVyIDAgb3IgZ3JlYXRlci4nO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBuZXcgQXJnU3BlYyh2YWxpZGF0b3IpO1xufVxuZXhwb3J0cy5ub25OZWdhdGl2ZU51bWJlclNwZWMgPSBub25OZWdhdGl2ZU51bWJlclNwZWM7XG5mdW5jdGlvbiBsb29zZU9iamVjdFNwZWMob3B0X3ZhbGlkYXRvciwgb3B0X29wdGlvbmFsKSB7XG4gICAgZnVuY3Rpb24gdmFsaWRhdG9yKHApIHtcbiAgICAgICAgdmFyIGlzTG9vc2VPYmplY3QgPSBwID09PSBudWxsIHx8ICh0eXBlLmlzRGVmKHApICYmIHAgaW5zdGFuY2VvZiBPYmplY3QpO1xuICAgICAgICBpZiAoIWlzTG9vc2VPYmplY3QpIHtcbiAgICAgICAgICAgIHRocm93ICdFeHBlY3RlZCBhbiBPYmplY3QuJztcbiAgICAgICAgfVxuICAgICAgICBpZiAob3B0X3ZhbGlkYXRvciAhPT0gdW5kZWZpbmVkICYmIG9wdF92YWxpZGF0b3IgIT09IG51bGwpIHtcbiAgICAgICAgICAgIG9wdF92YWxpZGF0b3IocCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5ldyBBcmdTcGVjKHZhbGlkYXRvciwgb3B0X29wdGlvbmFsKTtcbn1cbmV4cG9ydHMubG9vc2VPYmplY3RTcGVjID0gbG9vc2VPYmplY3RTcGVjO1xuZnVuY3Rpb24gbnVsbEZ1bmN0aW9uU3BlYyhvcHRfb3B0aW9uYWwpIHtcbiAgICBmdW5jdGlvbiB2YWxpZGF0b3IocCkge1xuICAgICAgICB2YXIgdmFsaWQgPSBwID09PSBudWxsIHx8IHR5cGUuaXNGdW5jdGlvbihwKTtcbiAgICAgICAgaWYgKCF2YWxpZCkge1xuICAgICAgICAgICAgdGhyb3cgJ0V4cGVjdGVkIGEgRnVuY3Rpb24uJztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbmV3IEFyZ1NwZWModmFsaWRhdG9yLCBvcHRfb3B0aW9uYWwpO1xufVxuZXhwb3J0cy5udWxsRnVuY3Rpb25TcGVjID0gbnVsbEZ1bmN0aW9uU3BlYztcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXJncy5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHRoZSBvYmplY3QgaXMgY29udGFpbmVkIGluIHRoZSBhcnJheSAoY29tcGFyZWQgd2l0aCA9PT0pLlxuICogQHRlbXBsYXRlIFRcbiAqL1xuZnVuY3Rpb24gY29udGFpbnMoYXJyYXksIGVsZW0pIHtcbiAgICByZXR1cm4gYXJyYXkuaW5kZXhPZihlbGVtKSAhPT0gLTE7XG59XG5leHBvcnRzLmNvbnRhaW5zID0gY29udGFpbnM7XG4vKipcbiAqIFJldHVybnMgYSBzaGFsbG93IGNvcHkgb2YgdGhlIGFycmF5IG9yIGFycmF5LWxpa2Ugb2JqZWN0IChlLmcuIGFyZ3VtZW50cykuXG4gKiBAdGVtcGxhdGUgVFxuICovXG5mdW5jdGlvbiBjbG9uZShhcnJheWxpa2UpIHtcbiAgICByZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJyYXlsaWtlKTtcbn1cbmV4cG9ydHMuY2xvbmUgPSBjbG9uZTtcbi8qKlxuICogUmVtb3ZlcyB0aGUgZ2l2ZW4gZWxlbWVudCBmcm9tIHRoZSBnaXZlbiBhcnJheSwgaWYgaXQgaXMgY29udGFpbmVkLlxuICogRGlyZWN0bHkgbW9kaWZpZXMgdGhlIHBhc3NlZC1pbiBhcnJheS5cbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmZ1bmN0aW9uIHJlbW92ZShhcnJheSwgZWxlbSkge1xuICAgIHZhciBpID0gYXJyYXkuaW5kZXhPZihlbGVtKTtcbiAgICBpZiAoaSAhPT0gLTEpIHtcbiAgICAgICAgYXJyYXkuc3BsaWNlKGksIDEpO1xuICAgIH1cbn1cbmV4cG9ydHMucmVtb3ZlID0gcmVtb3ZlO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcnJheS5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbi8qKlxuICogQGZpbGVvdmVydmlldyBNZXRob2QgZm9yIGludm9raW5nIGEgY2FsbGJhY2sgYXN5bmNocm9ub3VzbHkuXG4gKi9cbnZhciBwcm9taXNlaW1wbCA9IHJlcXVpcmUoXCIuL3Byb21pc2VfZXh0ZXJuYWxcIik7XG4vKipcbiAqIFJldHVybnMgYSBmdW5jdGlvbiB0aGF0IGludm9rZXMgZiB3aXRoIGl0cyBhcmd1bWVudHMgYXN5bmNocm9ub3VzbHkgYXMgYVxuICogbWljcm90YXNrLCBpLmUuIGFzIHNvb24gYXMgcG9zc2libGUgYWZ0ZXIgdGhlIGN1cnJlbnQgc2NyaXB0IHJldHVybnMgYmFja1xuICogaW50byBicm93c2VyIGNvZGUuXG4gKi9cbmZ1bmN0aW9uIGFzeW5jKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXJnc1RvRm9yd2FyZCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYXJnc1RvRm9yd2FyZFtfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHByb21pc2VpbXBsLnJlc29sdmUodHJ1ZSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmLmFwcGx5KG51bGwsIGFyZ3NUb0ZvcndhcmQpO1xuICAgICAgICB9KTtcbiAgICB9O1xufVxuZXhwb3J0cy5hc3luYyA9IGFzeW5jO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hc3luYy5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGNvbnN0YW50cyA9IHJlcXVpcmUoXCIuL2NvbnN0YW50c1wiKTtcbnZhciBlcnJvcnNFeHBvcnRzID0gcmVxdWlyZShcIi4vZXJyb3JcIik7XG52YXIgZmFpbHJlcXVlc3RfMSA9IHJlcXVpcmUoXCIuL2ZhaWxyZXF1ZXN0XCIpO1xudmFyIGxvY2F0aW9uXzEgPSByZXF1aXJlKFwiLi9sb2NhdGlvblwiKTtcbnZhciBwcm9taXNlaW1wbCA9IHJlcXVpcmUoXCIuL3Byb21pc2VfZXh0ZXJuYWxcIik7XG52YXIgcmVxdWVzdG1hcF8xID0gcmVxdWlyZShcIi4vcmVxdWVzdG1hcFwiKTtcbnZhciB0eXBlID0gcmVxdWlyZShcIi4vdHlwZVwiKTtcbi8qKlxuICogQHBhcmFtIGFwcCBJZiBudWxsLCBnZXRBdXRoVG9rZW4gYWx3YXlzIHJlc29sdmVzIHdpdGggbnVsbC5cbiAqIEBwYXJhbSBzZXJ2aWNlIFRoZSBzdG9yYWdlIHNlcnZpY2UgYXNzb2NpYXRlZCB3aXRoIHRoaXMgYXV0aCB3cmFwcGVyLlxuICogICAgIFVudHlwZWQgdG8gYXZvaWQgY2lyY3VsYXIgdHlwZSBkZXBlbmRlbmNpZXMuXG4gKiBAc3RydWN0XG4gKi9cbnZhciBBdXRoV3JhcHBlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBBdXRoV3JhcHBlcihhcHAsIG1ha2VyLCByZXF1ZXN0TWFrZXIsIHNlcnZpY2UsIHBvb2wpIHtcbiAgICAgICAgdGhpcy5idWNrZXRfID0gbnVsbDtcbiAgICAgICAgdGhpcy5kZWxldGVkXyA9IGZhbHNlO1xuICAgICAgICB0aGlzLmFwcF8gPSBhcHA7XG4gICAgICAgIGlmICh0aGlzLmFwcF8gIT09IG51bGwpIHtcbiAgICAgICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5hcHBfLm9wdGlvbnM7XG4gICAgICAgICAgICBpZiAodHlwZS5pc0RlZihvcHRpb25zKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuYnVja2V0XyA9IEF1dGhXcmFwcGVyLmV4dHJhY3RCdWNrZXRfKG9wdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuc3RvcmFnZVJlZk1ha2VyXyA9IG1ha2VyO1xuICAgICAgICB0aGlzLnJlcXVlc3RNYWtlcl8gPSByZXF1ZXN0TWFrZXI7XG4gICAgICAgIHRoaXMucG9vbF8gPSBwb29sO1xuICAgICAgICB0aGlzLnNlcnZpY2VfID0gc2VydmljZTtcbiAgICAgICAgdGhpcy5tYXhPcGVyYXRpb25SZXRyeVRpbWVfID0gY29uc3RhbnRzLmRlZmF1bHRNYXhPcGVyYXRpb25SZXRyeVRpbWU7XG4gICAgICAgIHRoaXMubWF4VXBsb2FkUmV0cnlUaW1lXyA9IGNvbnN0YW50cy5kZWZhdWx0TWF4VXBsb2FkUmV0cnlUaW1lO1xuICAgICAgICB0aGlzLnJlcXVlc3RNYXBfID0gbmV3IHJlcXVlc3RtYXBfMS5SZXF1ZXN0TWFwKCk7XG4gICAgfVxuICAgIEF1dGhXcmFwcGVyLmV4dHJhY3RCdWNrZXRfID0gZnVuY3Rpb24gKGNvbmZpZykge1xuICAgICAgICB2YXIgYnVja2V0U3RyaW5nID0gY29uZmlnW2NvbnN0YW50cy5jb25maWdPcHRpb25dIHx8IG51bGw7XG4gICAgICAgIGlmIChidWNrZXRTdHJpbmcgPT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGxvYyA9IGxvY2F0aW9uXzEuTG9jYXRpb24ubWFrZUZyb21CdWNrZXRTcGVjKGJ1Y2tldFN0cmluZyk7XG4gICAgICAgIHJldHVybiBsb2MuYnVja2V0O1xuICAgIH07XG4gICAgQXV0aFdyYXBwZXIucHJvdG90eXBlLmdldEF1dGhUb2tlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gVE9ETyhhbmR5c290byk6IHJlbW92ZSBpZkRlZiBjaGVja3MgYWZ0ZXIgZmlyZWJhc2UtYXBwIGltcGxlbWVudHMgc3R1YnNcbiAgICAgICAgLy8gKGIvMjg2NzM4MTgpLlxuICAgICAgICBpZiAodGhpcy5hcHBfICE9PSBudWxsICYmXG4gICAgICAgICAgICB0eXBlLmlzRGVmKHRoaXMuYXBwXy5JTlRFUk5BTCkgJiZcbiAgICAgICAgICAgIHR5cGUuaXNEZWYodGhpcy5hcHBfLklOVEVSTkFMLmdldFRva2VuKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXBwXy5JTlRFUk5BTC5nZXRUb2tlbigpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5hY2Nlc3NUb2tlbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChfZXJyb3IpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHByb21pc2VpbXBsLnJlc29sdmUobnVsbCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEF1dGhXcmFwcGVyLnByb3RvdHlwZS5idWNrZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmRlbGV0ZWRfKSB7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcnNFeHBvcnRzLmFwcERlbGV0ZWQoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJ1Y2tldF87XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFRoZSBzZXJ2aWNlIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGF1dGggd3JhcHBlci4gVW50eXBlZCB0byBhdm9pZCBjaXJjdWxhclxuICAgICAqIHR5cGUgZGVwZW5kZW5jaWVzLlxuICAgICAqL1xuICAgIEF1dGhXcmFwcGVyLnByb3RvdHlwZS5zZXJ2aWNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zZXJ2aWNlXztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBuZXcgZmlyZWJhc2VTdG9yYWdlLlJlZmVyZW5jZSBvYmplY3QgcmVmZXJlbmNpbmcgdGhpcyBBdXRoV3JhcHBlclxuICAgICAqIGF0IHRoZSBnaXZlbiBMb2NhdGlvbi5cbiAgICAgKiBAcGFyYW0gbG9jIFRoZSBMb2NhdGlvbi5cbiAgICAgKiBAcmV0dXJuIEFjdHVhbGx5IGEgZmlyZWJhc2VTdG9yYWdlLlJlZmVyZW5jZSwgdHlwaW5nIG5vdCBhbGxvd2VkXG4gICAgICogICAgIGJlY2F1c2Ugb2YgY2lyY3VsYXIgZGVwZW5kZW5jeSBwcm9ibGVtcy5cbiAgICAgKi9cbiAgICBBdXRoV3JhcHBlci5wcm90b3R5cGUubWFrZVN0b3JhZ2VSZWZlcmVuY2UgPSBmdW5jdGlvbiAobG9jKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN0b3JhZ2VSZWZNYWtlcl8odGhpcywgbG9jKTtcbiAgICB9O1xuICAgIEF1dGhXcmFwcGVyLnByb3RvdHlwZS5tYWtlUmVxdWVzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0SW5mbywgYXV0aFRva2VuKSB7XG4gICAgICAgIGlmICghdGhpcy5kZWxldGVkXykge1xuICAgICAgICAgICAgdmFyIHJlcXVlc3QgPSB0aGlzLnJlcXVlc3RNYWtlcl8ocmVxdWVzdEluZm8sIGF1dGhUb2tlbiwgdGhpcy5wb29sXyk7XG4gICAgICAgICAgICB0aGlzLnJlcXVlc3RNYXBfLmFkZFJlcXVlc3QocmVxdWVzdCk7XG4gICAgICAgICAgICByZXR1cm4gcmVxdWVzdDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgZmFpbHJlcXVlc3RfMS5GYWlsUmVxdWVzdChlcnJvcnNFeHBvcnRzLmFwcERlbGV0ZWQoKSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFN0b3AgcnVubmluZyByZXF1ZXN0cyBhbmQgcHJldmVudCBtb3JlIGZyb20gYmVpbmcgY3JlYXRlZC5cbiAgICAgKi9cbiAgICBBdXRoV3JhcHBlci5wcm90b3R5cGUuZGVsZXRlQXBwID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmRlbGV0ZWRfID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5hcHBfID0gbnVsbDtcbiAgICAgICAgdGhpcy5yZXF1ZXN0TWFwXy5jbGVhcigpO1xuICAgIH07XG4gICAgQXV0aFdyYXBwZXIucHJvdG90eXBlLm1heFVwbG9hZFJldHJ5VGltZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubWF4VXBsb2FkUmV0cnlUaW1lXztcbiAgICB9O1xuICAgIEF1dGhXcmFwcGVyLnByb3RvdHlwZS5zZXRNYXhVcGxvYWRSZXRyeVRpbWUgPSBmdW5jdGlvbiAodGltZSkge1xuICAgICAgICB0aGlzLm1heFVwbG9hZFJldHJ5VGltZV8gPSB0aW1lO1xuICAgIH07XG4gICAgQXV0aFdyYXBwZXIucHJvdG90eXBlLm1heE9wZXJhdGlvblJldHJ5VGltZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubWF4T3BlcmF0aW9uUmV0cnlUaW1lXztcbiAgICB9O1xuICAgIEF1dGhXcmFwcGVyLnByb3RvdHlwZS5zZXRNYXhPcGVyYXRpb25SZXRyeVRpbWUgPSBmdW5jdGlvbiAodGltZSkge1xuICAgICAgICB0aGlzLm1heE9wZXJhdGlvblJldHJ5VGltZV8gPSB0aW1lO1xuICAgIH07XG4gICAgcmV0dXJuIEF1dGhXcmFwcGVyO1xufSgpKTtcbmV4cG9ydHMuQXV0aFdyYXBwZXIgPSBBdXRoV3JhcHBlcjtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXV0aHdyYXBwZXIuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG4vKipcbiAqIEBwYXJhbSBmIE1heSBiZSBpbnZva2VkXG4gKiAgICAgYmVmb3JlIHRoZSBmdW5jdGlvbiByZXR1cm5zLlxuICogQHBhcmFtIGNhbGxiYWNrIEdldCBhbGwgdGhlIGFyZ3VtZW50cyBwYXNzZWQgdG8gdGhlIGZ1bmN0aW9uXG4gKiAgICAgcGFzc2VkIHRvIGYsIGluY2x1ZGluZyB0aGUgaW5pdGlhbCBib29sZWFuLlxuICovXG5mdW5jdGlvbiBzdGFydChmLCBjYWxsYmFjaywgdGltZW91dCkge1xuICAgIC8vIFRPRE8oYW5keXNvdG8pOiBtYWtlIHRoaXMgY29kZSBjbGVhbmVyIChwcm9iYWJseSByZWZhY3RvciBpbnRvIGFuIGFjdHVhbFxuICAgIC8vIHR5cGUgaW5zdGVhZCBvZiBhIGJ1bmNoIG9mIGZ1bmN0aW9ucyB3aXRoIHN0YXRlIHNoYXJlZCBpbiB0aGUgY2xvc3VyZSlcbiAgICB2YXIgd2FpdFNlY29uZHMgPSAxO1xuICAgIC8vIFdvdWxkIHR5cGUgdGhpcyBhcyBcIm51bWJlclwiIGJ1dCB0aGF0IGRvZXNuJ3Qgd29yayBmb3IgTm9kZSBzbyDCr1xcXyjjg4QpXy/Cr1xuICAgIHZhciB0aW1lb3V0SWQgPSBudWxsO1xuICAgIHZhciBoaXRUaW1lb3V0ID0gZmFsc2U7XG4gICAgdmFyIGNhbmNlbFN0YXRlID0gMDtcbiAgICBmdW5jdGlvbiBjYW5jZWxlZCgpIHtcbiAgICAgICAgcmV0dXJuIGNhbmNlbFN0YXRlID09PSAyO1xuICAgIH1cbiAgICB2YXIgdHJpZ2dlcmVkQ2FsbGJhY2sgPSBmYWxzZTtcbiAgICBmdW5jdGlvbiB0cmlnZ2VyQ2FsbGJhY2soKSB7XG4gICAgICAgIGlmICghdHJpZ2dlcmVkQ2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRyaWdnZXJlZENhbGxiYWNrID0gdHJ1ZTtcbiAgICAgICAgICAgIGNhbGxiYWNrLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gY2FsbFdpdGhEZWxheShtaWxsaXMpIHtcbiAgICAgICAgdGltZW91dElkID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aW1lb3V0SWQgPSBudWxsO1xuICAgICAgICAgICAgZihoYW5kbGVyLCBjYW5jZWxlZCgpKTtcbiAgICAgICAgfSwgbWlsbGlzKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gaGFuZGxlcihzdWNjZXNzKSB7XG4gICAgICAgIHZhciB2YXJfYXJncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyX2FyZ3NbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRyaWdnZXJlZENhbGxiYWNrKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgIHRyaWdnZXJDYWxsYmFjay5hcHBseShudWxsLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBtdXN0U3RvcCA9IGNhbmNlbGVkKCkgfHwgaGl0VGltZW91dDtcbiAgICAgICAgaWYgKG11c3RTdG9wKSB7XG4gICAgICAgICAgICB0cmlnZ2VyQ2FsbGJhY2suYXBwbHkobnVsbCwgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAod2FpdFNlY29uZHMgPCA2NCkge1xuICAgICAgICAgICAgLyogVE9ETyhhbmR5c290byk6IGRvbid0IGJhY2sgb2ZmIHNvIHF1aWNrbHkgaWYgd2Uga25vdyB3ZSdyZSBvZmZsaW5lLiAqL1xuICAgICAgICAgICAgd2FpdFNlY29uZHMgKj0gMjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgd2FpdE1pbGxpcztcbiAgICAgICAgaWYgKGNhbmNlbFN0YXRlID09PSAxKSB7XG4gICAgICAgICAgICBjYW5jZWxTdGF0ZSA9IDI7XG4gICAgICAgICAgICB3YWl0TWlsbGlzID0gMDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHdhaXRNaWxsaXMgPSAod2FpdFNlY29uZHMgKyBNYXRoLnJhbmRvbSgpKSAqIDEwMDA7XG4gICAgICAgIH1cbiAgICAgICAgY2FsbFdpdGhEZWxheSh3YWl0TWlsbGlzKTtcbiAgICB9XG4gICAgdmFyIHN0b3BwZWQgPSBmYWxzZTtcbiAgICBmdW5jdGlvbiBzdG9wKHdhc1RpbWVvdXQpIHtcbiAgICAgICAgaWYgKHN0b3BwZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBzdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgaWYgKHRyaWdnZXJlZENhbGxiYWNrKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRpbWVvdXRJZCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgaWYgKCF3YXNUaW1lb3V0KSB7XG4gICAgICAgICAgICAgICAgY2FuY2VsU3RhdGUgPSAyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XG4gICAgICAgICAgICBjYWxsV2l0aERlbGF5KDApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKCF3YXNUaW1lb3V0KSB7XG4gICAgICAgICAgICAgICAgY2FuY2VsU3RhdGUgPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGNhbGxXaXRoRGVsYXkoMCk7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGhpdFRpbWVvdXQgPSB0cnVlO1xuICAgICAgICBzdG9wKHRydWUpO1xuICAgIH0sIHRpbWVvdXQpO1xuICAgIHJldHVybiBzdG9wO1xufVxuZXhwb3J0cy5zdGFydCA9IHN0YXJ0O1xuLyoqXG4gKiBTdG9wcyB0aGUgcmV0cnkgbG9vcCBmcm9tIHJlcGVhdGluZy5cbiAqIElmIHRoZSBmdW5jdGlvbiBpcyBjdXJyZW50bHkgXCJpbiBiZXR3ZWVuXCIgcmV0cmllcywgaXQgaXMgaW52b2tlZCBpbW1lZGlhdGVseVxuICogd2l0aCB0aGUgc2Vjb25kIHBhcmFtZXRlciBhcyBcInRydWVcIi4gT3RoZXJ3aXNlLCBpdCB3aWxsIGJlIGludm9rZWQgb25jZSBtb3JlXG4gKiBhZnRlciB0aGUgY3VycmVudCBpbnZvY2F0aW9uIGZpbmlzaGVzIGlmZiB0aGUgY3VycmVudCBpbnZvY2F0aW9uIHdvdWxkIGhhdmVcbiAqIHRyaWdnZXJlZCBhbm90aGVyIHJldHJ5LlxuICovXG5mdW5jdGlvbiBzdG9wKGlkKSB7XG4gICAgaWQoZmFsc2UpO1xufVxuZXhwb3J0cy5zdG9wID0gc3RvcDtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YmFja29mZi5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbi8qKlxuICogQGZpbGUgUHJvdmlkZXMgYSBCbG9iLWxpa2Ugd3JhcHBlciBmb3IgdmFyaW91cyBiaW5hcnkgdHlwZXMgKGluY2x1ZGluZyB0aGVcbiAqIG5hdGl2ZSBCbG9iIHR5cGUpLiBUaGlzIG1ha2VzIGl0IHBvc3NpYmxlIHRvIHVwbG9hZCB0eXBlcyBsaWtlIEFycmF5QnVmZmVycyxcbiAqIG1ha2luZyB1cGxvYWRzIHBvc3NpYmxlIGluIGVudmlyb25tZW50cyB3aXRob3V0IHRoZSBuYXRpdmUgQmxvYiB0eXBlLlxuICovXG52YXIgZnMgPSByZXF1aXJlKFwiLi9mc1wiKTtcbnZhciBzdHJpbmcgPSByZXF1aXJlKFwiLi9zdHJpbmdcIik7XG52YXIgc3RyaW5nXzEgPSByZXF1aXJlKFwiLi9zdHJpbmdcIik7XG52YXIgdHlwZSA9IHJlcXVpcmUoXCIuL3R5cGVcIik7XG4vKipcbiAqIEBwYXJhbSBvcHRfZWxpZGVDb3B5IElmIHRydWUsIGRvZXNuJ3QgY29weSBtdXRhYmxlIGlucHV0IGRhdGFcbiAqICAgICAoZS5nLiBVaW50OEFycmF5cykuIFBhc3MgdHJ1ZSBvbmx5IGlmIHlvdSBrbm93IHRoZSBvYmplY3RzIHdpbGwgbm90IGJlXG4gKiAgICAgbW9kaWZpZWQgYWZ0ZXIgdGhpcyBibG9iJ3MgY29uc3RydWN0aW9uLlxuICovXG52YXIgRmJzQmxvYiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBGYnNCbG9iKGRhdGEsIG9wdF9lbGlkZUNvcHkpIHtcbiAgICAgICAgdmFyIHNpemUgPSAwO1xuICAgICAgICB2YXIgYmxvYlR5cGUgPSAnJztcbiAgICAgICAgaWYgKHR5cGUuaXNOYXRpdmVCbG9iKGRhdGEpKSB7XG4gICAgICAgICAgICB0aGlzLmRhdGFfID0gZGF0YTtcbiAgICAgICAgICAgIHNpemUgPSBkYXRhLnNpemU7XG4gICAgICAgICAgICBibG9iVHlwZSA9IGRhdGEudHlwZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkYXRhIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHtcbiAgICAgICAgICAgIGlmIChvcHRfZWxpZGVDb3B5KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhXyA9IG5ldyBVaW50OEFycmF5KGRhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhXyA9IG5ldyBVaW50OEFycmF5KGRhdGEuYnl0ZUxlbmd0aCk7XG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhXy5zZXQobmV3IFVpbnQ4QXJyYXkoZGF0YSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2l6ZSA9IHRoaXMuZGF0YV8ubGVuZ3RoO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGRhdGEgaW5zdGFuY2VvZiBVaW50OEFycmF5KSB7XG4gICAgICAgICAgICBpZiAob3B0X2VsaWRlQ29weSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGF0YV8gPSBkYXRhO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhXyA9IG5ldyBVaW50OEFycmF5KGRhdGEubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGFfLnNldChkYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNpemUgPSBkYXRhLmxlbmd0aDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNpemVfID0gc2l6ZTtcbiAgICAgICAgdGhpcy50eXBlXyA9IGJsb2JUeXBlO1xuICAgIH1cbiAgICBGYnNCbG9iLnByb3RvdHlwZS5zaXplID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zaXplXztcbiAgICB9O1xuICAgIEZic0Jsb2IucHJvdG90eXBlLnR5cGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnR5cGVfO1xuICAgIH07XG4gICAgRmJzQmxvYi5wcm90b3R5cGUuc2xpY2UgPSBmdW5jdGlvbiAoc3RhcnRCeXRlLCBlbmRCeXRlKSB7XG4gICAgICAgIGlmICh0eXBlLmlzTmF0aXZlQmxvYih0aGlzLmRhdGFfKSkge1xuICAgICAgICAgICAgdmFyIHJlYWxCbG9iID0gdGhpcy5kYXRhXztcbiAgICAgICAgICAgIHZhciBzbGljZWQgPSBmcy5zbGljZUJsb2IocmVhbEJsb2IsIHN0YXJ0Qnl0ZSwgZW5kQnl0ZSk7XG4gICAgICAgICAgICBpZiAoc2xpY2VkID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IEZic0Jsb2Ioc2xpY2VkKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBzbGljZSA9IG5ldyBVaW50OEFycmF5KHRoaXMuZGF0YV8uYnVmZmVyLCBzdGFydEJ5dGUsIGVuZEJ5dGUgLSBzdGFydEJ5dGUpO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBGYnNCbG9iKHNsaWNlLCB0cnVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRmJzQmxvYi5nZXRCbG9iID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdmFyX2FyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhcl9hcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGUuaXNOYXRpdmVCbG9iRGVmaW5lZCgpKSB7XG4gICAgICAgICAgICB2YXIgYmxvYmJ5ID0gdmFyX2FyZ3MubWFwKGZ1bmN0aW9uICh2YWwpIHtcbiAgICAgICAgICAgICAgICBpZiAodmFsIGluc3RhbmNlb2YgRmJzQmxvYikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsLmRhdGFfO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgRmJzQmxvYihmcy5nZXRCbG9iLmFwcGx5KG51bGwsIGJsb2JieSkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIHVpbnQ4QXJyYXlzID0gdmFyX2FyZ3MubWFwKGZ1bmN0aW9uICh2YWwpIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZS5pc1N0cmluZyh2YWwpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzdHJpbmcuZGF0YUZyb21TdHJpbmcoc3RyaW5nXzEuU3RyaW5nRm9ybWF0LlJBVywgdmFsKS5kYXRhO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQmxvYnMgZG9uJ3QgZXhpc3QsIHNvIHRoaXMgaGFzIHRvIGJlIGEgVWludDhBcnJheS5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbC5kYXRhXztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZhciBmaW5hbExlbmd0aF8xID0gMDtcbiAgICAgICAgICAgIHVpbnQ4QXJyYXlzLmZvckVhY2goZnVuY3Rpb24gKGFycmF5KSB7XG4gICAgICAgICAgICAgICAgZmluYWxMZW5ndGhfMSArPSBhcnJheS5ieXRlTGVuZ3RoO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB2YXIgbWVyZ2VkXzEgPSBuZXcgVWludDhBcnJheShmaW5hbExlbmd0aF8xKTtcbiAgICAgICAgICAgIHZhciBpbmRleF8xID0gMDtcbiAgICAgICAgICAgIHVpbnQ4QXJyYXlzLmZvckVhY2goZnVuY3Rpb24gKGFycmF5KSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBtZXJnZWRfMVtpbmRleF8xKytdID0gYXJyYXlbaV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEZic0Jsb2IobWVyZ2VkXzEsIHRydWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGYnNCbG9iLnByb3RvdHlwZS51cGxvYWREYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhXztcbiAgICB9O1xuICAgIHJldHVybiBGYnNCbG9iO1xufSgpKTtcbmV4cG9ydHMuRmJzQmxvYiA9IEZic0Jsb2I7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJsb2IuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEBmaWxlb3ZlcnZpZXcgQ29uc3RhbnRzIHVzZWQgaW4gdGhlIEZpcmViYXNlIFN0b3JhZ2UgbGlicmFyeS5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuLyoqXG4gKiBEb21haW4gYW5kIHNjaGVtZSBmb3IgQVBJIGNhbGxzLlxuICovXG5leHBvcnRzLmRvbWFpbkJhc2UgPSAnaHR0cHM6Ly9maXJlYmFzZXN0b3JhZ2UuZ29vZ2xlYXBpcy5jb20nO1xuLyoqXG4gKiBEb21haW4gYW5kIHNjaGVtZSBmb3Igb2JqZWN0IGRvd25sb2Fkcy5cbiAqL1xuZXhwb3J0cy5kb3dubG9hZEJhc2UgPSAnaHR0cHM6Ly9maXJlYmFzZXN0b3JhZ2UuZ29vZ2xlYXBpcy5jb20nO1xuLyoqXG4gKiBCYXNlIFVSTCBmb3Igbm9uLXVwbG9hZCBjYWxscyB0byB0aGUgQVBJLlxuICovXG5leHBvcnRzLmFwaUJhc2VVcmwgPSAnL3YwJztcbi8qKlxuICogQmFzZSBVUkwgZm9yIHVwbG9hZCBjYWxscyB0byB0aGUgQVBJLlxuICovXG5leHBvcnRzLmFwaVVwbG9hZEJhc2VVcmwgPSAnL3YwJztcbmZ1bmN0aW9uIHNldERvbWFpbkJhc2UoZG9tYWluQmFzZSkge1xuICAgIGRvbWFpbkJhc2UgPSBkb21haW5CYXNlO1xufVxuZXhwb3J0cy5zZXREb21haW5CYXNlID0gc2V0RG9tYWluQmFzZTtcbmV4cG9ydHMuY29uZmlnT3B0aW9uID0gJ3N0b3JhZ2VCdWNrZXQnO1xuLyoqXG4gKiAxIG1pbnV0ZVxuICovXG5leHBvcnRzLnNob3J0TWF4T3BlcmF0aW9uUmV0cnlUaW1lID0gMSAqIDYwICogMTAwMDtcbi8qKlxuICogMiBtaW51dGVzXG4gKi9cbmV4cG9ydHMuZGVmYXVsdE1heE9wZXJhdGlvblJldHJ5VGltZSA9IDIgKiA2MCAqIDEwMDA7XG4vKipcbiAqIDEwIG1pbnV0ZXNcbiAqL1xuZXhwb3J0cy5kZWZhdWx0TWF4VXBsb2FkUmV0cnlUaW1lID0gMTAgKiA2MCAqIDEwMDtcbi8qKlxuICogVGhpcyBpcyB0aGUgdmFsdWUgb2YgTnVtYmVyLk1JTl9TQUZFX0lOVEVHRVIsIHdoaWNoIGlzIG5vdCB3ZWxsIHN1cHBvcnRlZFxuICogZW5vdWdoIGZvciB1cyB0byB1c2UgaXQgZGlyZWN0bHkuXG4gKi9cbmV4cG9ydHMubWluU2FmZUludGVnZXIgPSAtOTAwNzE5OTI1NDc0MDk5MTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y29uc3RhbnRzLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xudmFyIGNvbnN0YW50c18xID0gcmVxdWlyZShcIi4vY29uc3RhbnRzXCIpO1xudmFyIEZpcmViYXNlU3RvcmFnZUVycm9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEZpcmViYXNlU3RvcmFnZUVycm9yKGNvZGUsIG1lc3NhZ2UpIHtcbiAgICAgICAgdGhpcy5jb2RlXyA9IHByZXBlbmRDb2RlKGNvZGUpO1xuICAgICAgICB0aGlzLm1lc3NhZ2VfID0gJ0ZpcmViYXNlIFN0b3JhZ2U6ICcgKyBtZXNzYWdlO1xuICAgICAgICB0aGlzLnNlcnZlclJlc3BvbnNlXyA9IG51bGw7XG4gICAgICAgIHRoaXMubmFtZV8gPSAnRmlyZWJhc2VFcnJvcic7XG4gICAgfVxuICAgIEZpcmViYXNlU3RvcmFnZUVycm9yLnByb3RvdHlwZS5jb2RlUHJvcCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29kZTtcbiAgICB9O1xuICAgIEZpcmViYXNlU3RvcmFnZUVycm9yLnByb3RvdHlwZS5jb2RlRXF1YWxzID0gZnVuY3Rpb24gKGNvZGUpIHtcbiAgICAgICAgcmV0dXJuIHByZXBlbmRDb2RlKGNvZGUpID09PSB0aGlzLmNvZGVQcm9wKCk7XG4gICAgfTtcbiAgICBGaXJlYmFzZVN0b3JhZ2VFcnJvci5wcm90b3R5cGUuc2VydmVyUmVzcG9uc2VQcm9wID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zZXJ2ZXJSZXNwb25zZV87XG4gICAgfTtcbiAgICBGaXJlYmFzZVN0b3JhZ2VFcnJvci5wcm90b3R5cGUuc2V0U2VydmVyUmVzcG9uc2VQcm9wID0gZnVuY3Rpb24gKHNlcnZlclJlc3BvbnNlKSB7XG4gICAgICAgIHRoaXMuc2VydmVyUmVzcG9uc2VfID0gc2VydmVyUmVzcG9uc2U7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmlyZWJhc2VTdG9yYWdlRXJyb3IucHJvdG90eXBlLCBcIm5hbWVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5hbWVfO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmlyZWJhc2VTdG9yYWdlRXJyb3IucHJvdG90eXBlLCBcImNvZGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvZGVfO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmlyZWJhc2VTdG9yYWdlRXJyb3IucHJvdG90eXBlLCBcIm1lc3NhZ2VcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1lc3NhZ2VfO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmlyZWJhc2VTdG9yYWdlRXJyb3IucHJvdG90eXBlLCBcInNlcnZlclJlc3BvbnNlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zZXJ2ZXJSZXNwb25zZV87XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiBGaXJlYmFzZVN0b3JhZ2VFcnJvcjtcbn0oKSk7XG5leHBvcnRzLkZpcmViYXNlU3RvcmFnZUVycm9yID0gRmlyZWJhc2VTdG9yYWdlRXJyb3I7XG5leHBvcnRzLmVycm9ycyA9IHt9O1xuZXhwb3J0cy5Db2RlID0ge1xuICAgIC8vIFNoYXJlZCBiZXR3ZWVuIGFsbCBwbGF0Zm9ybXNcbiAgICBVTktOT1dOOiAndW5rbm93bicsXG4gICAgT0JKRUNUX05PVF9GT1VORDogJ29iamVjdC1ub3QtZm91bmQnLFxuICAgIEJVQ0tFVF9OT1RfRk9VTkQ6ICdidWNrZXQtbm90LWZvdW5kJyxcbiAgICBQUk9KRUNUX05PVF9GT1VORDogJ3Byb2plY3Qtbm90LWZvdW5kJyxcbiAgICBRVU9UQV9FWENFRURFRDogJ3F1b3RhLWV4Y2VlZGVkJyxcbiAgICBVTkFVVEhFTlRJQ0FURUQ6ICd1bmF1dGhlbnRpY2F0ZWQnLFxuICAgIFVOQVVUSE9SSVpFRDogJ3VuYXV0aG9yaXplZCcsXG4gICAgUkVUUllfTElNSVRfRVhDRUVERUQ6ICdyZXRyeS1saW1pdC1leGNlZWRlZCcsXG4gICAgSU5WQUxJRF9DSEVDS1NVTTogJ2ludmFsaWQtY2hlY2tzdW0nLFxuICAgIENBTkNFTEVEOiAnY2FuY2VsZWQnLFxuICAgIC8vIEpTIHNwZWNpZmljXG4gICAgSU5WQUxJRF9FVkVOVF9OQU1FOiAnaW52YWxpZC1ldmVudC1uYW1lJyxcbiAgICBJTlZBTElEX1VSTDogJ2ludmFsaWQtdXJsJyxcbiAgICBJTlZBTElEX0RFRkFVTFRfQlVDS0VUOiAnaW52YWxpZC1kZWZhdWx0LWJ1Y2tldCcsXG4gICAgTk9fREVGQVVMVF9CVUNLRVQ6ICduby1kZWZhdWx0LWJ1Y2tldCcsXG4gICAgQ0FOTk9UX1NMSUNFX0JMT0I6ICdjYW5ub3Qtc2xpY2UtYmxvYicsXG4gICAgU0VSVkVSX0ZJTEVfV1JPTkdfU0laRTogJ3NlcnZlci1maWxlLXdyb25nLXNpemUnLFxuICAgIE5PX0RPV05MT0FEX1VSTDogJ25vLWRvd25sb2FkLXVybCcsXG4gICAgSU5WQUxJRF9BUkdVTUVOVDogJ2ludmFsaWQtYXJndW1lbnQnLFxuICAgIElOVkFMSURfQVJHVU1FTlRfQ09VTlQ6ICdpbnZhbGlkLWFyZ3VtZW50LWNvdW50JyxcbiAgICBBUFBfREVMRVRFRDogJ2FwcC1kZWxldGVkJyxcbiAgICBJTlZBTElEX1JPT1RfT1BFUkFUSU9OOiAnaW52YWxpZC1yb290LW9wZXJhdGlvbicsXG4gICAgSU5WQUxJRF9GT1JNQVQ6ICdpbnZhbGlkLWZvcm1hdCcsXG4gICAgSU5URVJOQUxfRVJST1I6ICdpbnRlcm5hbC1lcnJvcidcbn07XG5mdW5jdGlvbiBwcmVwZW5kQ29kZShjb2RlKSB7XG4gICAgcmV0dXJuICdzdG9yYWdlLycgKyBjb2RlO1xufVxuZXhwb3J0cy5wcmVwZW5kQ29kZSA9IHByZXBlbmRDb2RlO1xuZnVuY3Rpb24gdW5rbm93bigpIHtcbiAgICB2YXIgbWVzc2FnZSA9ICdBbiB1bmtub3duIGVycm9yIG9jY3VycmVkLCBwbGVhc2UgY2hlY2sgdGhlIGVycm9yIHBheWxvYWQgZm9yICcgK1xuICAgICAgICAnc2VydmVyIHJlc3BvbnNlLic7XG4gICAgcmV0dXJuIG5ldyBGaXJlYmFzZVN0b3JhZ2VFcnJvcihleHBvcnRzLkNvZGUuVU5LTk9XTiwgbWVzc2FnZSk7XG59XG5leHBvcnRzLnVua25vd24gPSB1bmtub3duO1xuZnVuY3Rpb24gb2JqZWN0Tm90Rm91bmQocGF0aCkge1xuICAgIHJldHVybiBuZXcgRmlyZWJhc2VTdG9yYWdlRXJyb3IoZXhwb3J0cy5Db2RlLk9CSkVDVF9OT1RfRk9VTkQsIFwiT2JqZWN0ICdcIiArIHBhdGggKyBcIicgZG9lcyBub3QgZXhpc3QuXCIpO1xufVxuZXhwb3J0cy5vYmplY3ROb3RGb3VuZCA9IG9iamVjdE5vdEZvdW5kO1xuZnVuY3Rpb24gYnVja2V0Tm90Rm91bmQoYnVja2V0KSB7XG4gICAgcmV0dXJuIG5ldyBGaXJlYmFzZVN0b3JhZ2VFcnJvcihleHBvcnRzLkNvZGUuQlVDS0VUX05PVF9GT1VORCwgXCJCdWNrZXQgJ1wiICsgYnVja2V0ICsgXCInIGRvZXMgbm90IGV4aXN0LlwiKTtcbn1cbmV4cG9ydHMuYnVja2V0Tm90Rm91bmQgPSBidWNrZXROb3RGb3VuZDtcbmZ1bmN0aW9uIHByb2plY3ROb3RGb3VuZChwcm9qZWN0KSB7XG4gICAgcmV0dXJuIG5ldyBGaXJlYmFzZVN0b3JhZ2VFcnJvcihleHBvcnRzLkNvZGUuUFJPSkVDVF9OT1RfRk9VTkQsIFwiUHJvamVjdCAnXCIgKyBwcm9qZWN0ICsgXCInIGRvZXMgbm90IGV4aXN0LlwiKTtcbn1cbmV4cG9ydHMucHJvamVjdE5vdEZvdW5kID0gcHJvamVjdE5vdEZvdW5kO1xuZnVuY3Rpb24gcXVvdGFFeGNlZWRlZChidWNrZXQpIHtcbiAgICByZXR1cm4gbmV3IEZpcmViYXNlU3RvcmFnZUVycm9yKGV4cG9ydHMuQ29kZS5RVU9UQV9FWENFRURFRCwgXCJRdW90YSBmb3IgYnVja2V0ICdcIiArXG4gICAgICAgIGJ1Y2tldCArXG4gICAgICAgIFwiJyBleGNlZWRlZCwgcGxlYXNlIHZpZXcgcXVvdGEgb24gXCIgK1xuICAgICAgICAnaHR0cHM6Ly9maXJlYmFzZS5nb29nbGUuY29tL3ByaWNpbmcvLicpO1xufVxuZXhwb3J0cy5xdW90YUV4Y2VlZGVkID0gcXVvdGFFeGNlZWRlZDtcbmZ1bmN0aW9uIHVuYXV0aGVudGljYXRlZCgpIHtcbiAgICB2YXIgbWVzc2FnZSA9ICdVc2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkLCBwbGVhc2UgYXV0aGVudGljYXRlIHVzaW5nIEZpcmViYXNlICcgK1xuICAgICAgICAnQXV0aGVudGljYXRpb24gYW5kIHRyeSBhZ2Fpbi4nO1xuICAgIHJldHVybiBuZXcgRmlyZWJhc2VTdG9yYWdlRXJyb3IoZXhwb3J0cy5Db2RlLlVOQVVUSEVOVElDQVRFRCwgbWVzc2FnZSk7XG59XG5leHBvcnRzLnVuYXV0aGVudGljYXRlZCA9IHVuYXV0aGVudGljYXRlZDtcbmZ1bmN0aW9uIHVuYXV0aG9yaXplZChwYXRoKSB7XG4gICAgcmV0dXJuIG5ldyBGaXJlYmFzZVN0b3JhZ2VFcnJvcihleHBvcnRzLkNvZGUuVU5BVVRIT1JJWkVELCBcIlVzZXIgZG9lcyBub3QgaGF2ZSBwZXJtaXNzaW9uIHRvIGFjY2VzcyAnXCIgKyBwYXRoICsgXCInLlwiKTtcbn1cbmV4cG9ydHMudW5hdXRob3JpemVkID0gdW5hdXRob3JpemVkO1xuZnVuY3Rpb24gcmV0cnlMaW1pdEV4Y2VlZGVkKCkge1xuICAgIHJldHVybiBuZXcgRmlyZWJhc2VTdG9yYWdlRXJyb3IoZXhwb3J0cy5Db2RlLlJFVFJZX0xJTUlUX0VYQ0VFREVELCAnTWF4IHJldHJ5IHRpbWUgZm9yIG9wZXJhdGlvbiBleGNlZWRlZCwgcGxlYXNlIHRyeSBhZ2Fpbi4nKTtcbn1cbmV4cG9ydHMucmV0cnlMaW1pdEV4Y2VlZGVkID0gcmV0cnlMaW1pdEV4Y2VlZGVkO1xuZnVuY3Rpb24gaW52YWxpZENoZWNrc3VtKHBhdGgsIGNoZWNrc3VtLCBjYWxjdWxhdGVkKSB7XG4gICAgcmV0dXJuIG5ldyBGaXJlYmFzZVN0b3JhZ2VFcnJvcihleHBvcnRzLkNvZGUuSU5WQUxJRF9DSEVDS1NVTSwgXCJVcGxvYWRlZC9kb3dubG9hZGVkIG9iamVjdCAnXCIgK1xuICAgICAgICBwYXRoICtcbiAgICAgICAgXCInIGhhcyBjaGVja3N1bSAnXCIgK1xuICAgICAgICBjaGVja3N1bSArXG4gICAgICAgIFwiJyB3aGljaCBkb2VzIG5vdCBtYXRjaCAnXCIgK1xuICAgICAgICBjYWxjdWxhdGVkICtcbiAgICAgICAgXCInLiBQbGVhc2UgcmV0cnkgdGhlIHVwbG9hZC9kb3dubG9hZC5cIik7XG59XG5leHBvcnRzLmludmFsaWRDaGVja3N1bSA9IGludmFsaWRDaGVja3N1bTtcbmZ1bmN0aW9uIGNhbmNlbGVkKCkge1xuICAgIHJldHVybiBuZXcgRmlyZWJhc2VTdG9yYWdlRXJyb3IoZXhwb3J0cy5Db2RlLkNBTkNFTEVELCAnVXNlciBjYW5jZWxlZCB0aGUgdXBsb2FkL2Rvd25sb2FkLicpO1xufVxuZXhwb3J0cy5jYW5jZWxlZCA9IGNhbmNlbGVkO1xuZnVuY3Rpb24gaW52YWxpZEV2ZW50TmFtZShuYW1lKSB7XG4gICAgcmV0dXJuIG5ldyBGaXJlYmFzZVN0b3JhZ2VFcnJvcihleHBvcnRzLkNvZGUuSU5WQUxJRF9FVkVOVF9OQU1FLCBcIkludmFsaWQgZXZlbnQgbmFtZSAnXCIgKyBuYW1lICsgXCInLlwiKTtcbn1cbmV4cG9ydHMuaW52YWxpZEV2ZW50TmFtZSA9IGludmFsaWRFdmVudE5hbWU7XG5mdW5jdGlvbiBpbnZhbGlkVXJsKHVybCkge1xuICAgIHJldHVybiBuZXcgRmlyZWJhc2VTdG9yYWdlRXJyb3IoZXhwb3J0cy5Db2RlLklOVkFMSURfVVJMLCBcIkludmFsaWQgVVJMICdcIiArIHVybCArIFwiJy5cIik7XG59XG5leHBvcnRzLmludmFsaWRVcmwgPSBpbnZhbGlkVXJsO1xuZnVuY3Rpb24gaW52YWxpZERlZmF1bHRCdWNrZXQoYnVja2V0KSB7XG4gICAgcmV0dXJuIG5ldyBGaXJlYmFzZVN0b3JhZ2VFcnJvcihleHBvcnRzLkNvZGUuSU5WQUxJRF9ERUZBVUxUX0JVQ0tFVCwgXCJJbnZhbGlkIGRlZmF1bHQgYnVja2V0ICdcIiArIGJ1Y2tldCArIFwiJy5cIik7XG59XG5leHBvcnRzLmludmFsaWREZWZhdWx0QnVja2V0ID0gaW52YWxpZERlZmF1bHRCdWNrZXQ7XG5mdW5jdGlvbiBub0RlZmF1bHRCdWNrZXQoKSB7XG4gICAgcmV0dXJuIG5ldyBGaXJlYmFzZVN0b3JhZ2VFcnJvcihleHBvcnRzLkNvZGUuTk9fREVGQVVMVF9CVUNLRVQsICdObyBkZWZhdWx0IGJ1Y2tldCAnICtcbiAgICAgICAgXCJmb3VuZC4gRGlkIHlvdSBzZXQgdGhlICdcIiArXG4gICAgICAgIGNvbnN0YW50c18xLmNvbmZpZ09wdGlvbiArXG4gICAgICAgIFwiJyBwcm9wZXJ0eSB3aGVuIGluaXRpYWxpemluZyB0aGUgYXBwP1wiKTtcbn1cbmV4cG9ydHMubm9EZWZhdWx0QnVja2V0ID0gbm9EZWZhdWx0QnVja2V0O1xuZnVuY3Rpb24gY2Fubm90U2xpY2VCbG9iKCkge1xuICAgIHJldHVybiBuZXcgRmlyZWJhc2VTdG9yYWdlRXJyb3IoZXhwb3J0cy5Db2RlLkNBTk5PVF9TTElDRV9CTE9CLCAnQ2Fubm90IHNsaWNlIGJsb2IgZm9yIHVwbG9hZC4gUGxlYXNlIHJldHJ5IHRoZSB1cGxvYWQuJyk7XG59XG5leHBvcnRzLmNhbm5vdFNsaWNlQmxvYiA9IGNhbm5vdFNsaWNlQmxvYjtcbmZ1bmN0aW9uIHNlcnZlckZpbGVXcm9uZ1NpemUoKSB7XG4gICAgcmV0dXJuIG5ldyBGaXJlYmFzZVN0b3JhZ2VFcnJvcihleHBvcnRzLkNvZGUuU0VSVkVSX0ZJTEVfV1JPTkdfU0laRSwgJ1NlcnZlciByZWNvcmRlZCBpbmNvcnJlY3QgdXBsb2FkIGZpbGUgc2l6ZSwgcGxlYXNlIHJldHJ5IHRoZSB1cGxvYWQuJyk7XG59XG5leHBvcnRzLnNlcnZlckZpbGVXcm9uZ1NpemUgPSBzZXJ2ZXJGaWxlV3JvbmdTaXplO1xuZnVuY3Rpb24gbm9Eb3dubG9hZFVSTCgpIHtcbiAgICByZXR1cm4gbmV3IEZpcmViYXNlU3RvcmFnZUVycm9yKGV4cG9ydHMuQ29kZS5OT19ET1dOTE9BRF9VUkwsICdUaGUgZ2l2ZW4gZmlsZSBkb2VzIG5vdCBoYXZlIGFueSBkb3dubG9hZCBVUkxzLicpO1xufVxuZXhwb3J0cy5ub0Rvd25sb2FkVVJMID0gbm9Eb3dubG9hZFVSTDtcbmZ1bmN0aW9uIGludmFsaWRBcmd1bWVudChpbmRleCwgZm5OYW1lLCBtZXNzYWdlKSB7XG4gICAgcmV0dXJuIG5ldyBGaXJlYmFzZVN0b3JhZ2VFcnJvcihleHBvcnRzLkNvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ0ludmFsaWQgYXJndW1lbnQgaW4gYCcgKyBmbk5hbWUgKyAnYCBhdCBpbmRleCAnICsgaW5kZXggKyAnOiAnICsgbWVzc2FnZSk7XG59XG5leHBvcnRzLmludmFsaWRBcmd1bWVudCA9IGludmFsaWRBcmd1bWVudDtcbmZ1bmN0aW9uIGludmFsaWRBcmd1bWVudENvdW50KGFyZ01pbiwgYXJnTWF4LCBmbk5hbWUsIHJlYWwpIHtcbiAgICB2YXIgY291bnRQYXJ0O1xuICAgIHZhciBwbHVyYWw7XG4gICAgaWYgKGFyZ01pbiA9PT0gYXJnTWF4KSB7XG4gICAgICAgIGNvdW50UGFydCA9IGFyZ01pbjtcbiAgICAgICAgcGx1cmFsID0gYXJnTWluID09PSAxID8gJ2FyZ3VtZW50JyA6ICdhcmd1bWVudHMnO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgY291bnRQYXJ0ID0gJ2JldHdlZW4gJyArIGFyZ01pbiArICcgYW5kICcgKyBhcmdNYXg7XG4gICAgICAgIHBsdXJhbCA9ICdhcmd1bWVudHMnO1xuICAgIH1cbiAgICByZXR1cm4gbmV3IEZpcmViYXNlU3RvcmFnZUVycm9yKGV4cG9ydHMuQ29kZS5JTlZBTElEX0FSR1VNRU5UX0NPVU5ULCAnSW52YWxpZCBhcmd1bWVudCBjb3VudCBpbiBgJyArXG4gICAgICAgIGZuTmFtZSArXG4gICAgICAgICdgOiBFeHBlY3RlZCAnICtcbiAgICAgICAgY291bnRQYXJ0ICtcbiAgICAgICAgJyAnICtcbiAgICAgICAgcGx1cmFsICtcbiAgICAgICAgJywgcmVjZWl2ZWQgJyArXG4gICAgICAgIHJlYWwgK1xuICAgICAgICAnLicpO1xufVxuZXhwb3J0cy5pbnZhbGlkQXJndW1lbnRDb3VudCA9IGludmFsaWRBcmd1bWVudENvdW50O1xuZnVuY3Rpb24gYXBwRGVsZXRlZCgpIHtcbiAgICByZXR1cm4gbmV3IEZpcmViYXNlU3RvcmFnZUVycm9yKGV4cG9ydHMuQ29kZS5BUFBfREVMRVRFRCwgJ1RoZSBGaXJlYmFzZSBhcHAgd2FzIGRlbGV0ZWQuJyk7XG59XG5leHBvcnRzLmFwcERlbGV0ZWQgPSBhcHBEZWxldGVkO1xuLyoqXG4gKiBAcGFyYW0gbmFtZSBUaGUgbmFtZSBvZiB0aGUgb3BlcmF0aW9uIHRoYXQgd2FzIGludmFsaWQuXG4gKi9cbmZ1bmN0aW9uIGludmFsaWRSb290T3BlcmF0aW9uKG5hbWUpIHtcbiAgICByZXR1cm4gbmV3IEZpcmViYXNlU3RvcmFnZUVycm9yKGV4cG9ydHMuQ29kZS5JTlZBTElEX1JPT1RfT1BFUkFUSU9OLCBcIlRoZSBvcGVyYXRpb24gJ1wiICtcbiAgICAgICAgbmFtZSArXG4gICAgICAgIFwiJyBjYW5ub3QgYmUgcGVyZm9ybWVkIG9uIGEgcm9vdCByZWZlcmVuY2UsIGNyZWF0ZSBhIG5vbi1yb290IFwiICtcbiAgICAgICAgXCJyZWZlcmVuY2UgdXNpbmcgY2hpbGQsIHN1Y2ggYXMgLmNoaWxkKCdmaWxlLnBuZycpLlwiKTtcbn1cbmV4cG9ydHMuaW52YWxpZFJvb3RPcGVyYXRpb24gPSBpbnZhbGlkUm9vdE9wZXJhdGlvbjtcbi8qKlxuICogQHBhcmFtIGZvcm1hdCBUaGUgZm9ybWF0IHRoYXQgd2FzIG5vdCB2YWxpZC5cbiAqIEBwYXJhbSBtZXNzYWdlIEEgbWVzc2FnZSBkZXNjcmliaW5nIHRoZSBmb3JtYXQgdmlvbGF0aW9uLlxuICovXG5mdW5jdGlvbiBpbnZhbGlkRm9ybWF0KGZvcm1hdCwgbWVzc2FnZSkge1xuICAgIHJldHVybiBuZXcgRmlyZWJhc2VTdG9yYWdlRXJyb3IoZXhwb3J0cy5Db2RlLklOVkFMSURfRk9STUFULCBcIlN0cmluZyBkb2VzIG5vdCBtYXRjaCBmb3JtYXQgJ1wiICsgZm9ybWF0ICsgXCInOiBcIiArIG1lc3NhZ2UpO1xufVxuZXhwb3J0cy5pbnZhbGlkRm9ybWF0ID0gaW52YWxpZEZvcm1hdDtcbi8qKlxuICogQHBhcmFtIG1lc3NhZ2UgQSBtZXNzYWdlIGRlc2NyaWJpbmcgdGhlIGludGVybmFsIGVycm9yLlxuICovXG5mdW5jdGlvbiBpbnRlcm5hbEVycm9yKG1lc3NhZ2UpIHtcbiAgICB0aHJvdyBuZXcgRmlyZWJhc2VTdG9yYWdlRXJyb3IoZXhwb3J0cy5Db2RlLklOVEVSTkFMX0VSUk9SLCAnSW50ZXJuYWwgZXJyb3I6ICcgKyBtZXNzYWdlKTtcbn1cbmV4cG9ydHMuaW50ZXJuYWxFcnJvciA9IGludGVybmFsRXJyb3I7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWVycm9yLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgcHJvbWlzZWltcGwgPSByZXF1aXJlKFwiLi9wcm9taXNlX2V4dGVybmFsXCIpO1xuLyoqXG4gKiBBIHJlcXVlc3Qgd2hvc2UgcHJvbWlzZSBhbHdheXMgZmFpbHMuXG4gKiBAc3RydWN0XG4gKiBAdGVtcGxhdGUgVFxuICovXG52YXIgRmFpbFJlcXVlc3QgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRmFpbFJlcXVlc3QoZXJyb3IpIHtcbiAgICAgICAgdGhpcy5wcm9taXNlXyA9IHByb21pc2VpbXBsLnJlamVjdChlcnJvcik7XG4gICAgfVxuICAgIC8qKiBAaW5oZXJpdERvYyAqL1xuICAgIEZhaWxSZXF1ZXN0LnByb3RvdHlwZS5nZXRQcm9taXNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9taXNlXztcbiAgICB9O1xuICAgIC8qKiBAaW5oZXJpdERvYyAqL1xuICAgIEZhaWxSZXF1ZXN0LnByb3RvdHlwZS5jYW5jZWwgPSBmdW5jdGlvbiAoYXBwRGVsZXRlKSB7XG4gICAgICAgIGlmIChhcHBEZWxldGUgPT09IHZvaWQgMCkgeyBhcHBEZWxldGUgPSBmYWxzZTsgfVxuICAgIH07XG4gICAgcmV0dXJuIEZhaWxSZXF1ZXN0O1xufSgpKTtcbmV4cG9ydHMuRmFpbFJlcXVlc3QgPSBGYWlsUmVxdWVzdDtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZmFpbHJlcXVlc3QuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB0eXBlID0gcmVxdWlyZShcIi4vdHlwZVwiKTtcbmZ1bmN0aW9uIGdldEJsb2JCdWlsZGVyKCkge1xuICAgIGlmICh0eXBlb2YgQmxvYkJ1aWxkZXIgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHJldHVybiBCbG9iQnVpbGRlcjtcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZW9mIFdlYktpdEJsb2JCdWlsZGVyICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICByZXR1cm4gV2ViS2l0QmxvYkJ1aWxkZXI7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbn1cbi8qKlxuICogQ29uY2F0ZW5hdGVzIG9uZSBvciBtb3JlIHZhbHVlcyB0b2dldGhlciBhbmQgY29udmVydHMgdGhlbSB0byBhIEJsb2IuXG4gKlxuICogQHBhcmFtIHZhcl9hcmdzIFRoZSB2YWx1ZXMgdGhhdCB3aWxsIG1ha2UgdXAgdGhlIHJlc3VsdGluZyBibG9iLlxuICogQHJldHVybiBUaGUgYmxvYi5cbiAqL1xuZnVuY3Rpb24gZ2V0QmxvYigpIHtcbiAgICB2YXIgdmFyX2FyZ3MgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXJfYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgIH1cbiAgICB2YXIgQmxvYkJ1aWxkZXIgPSBnZXRCbG9iQnVpbGRlcigpO1xuICAgIGlmIChCbG9iQnVpbGRlciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHZhciBiYiA9IG5ldyBCbG9iQnVpbGRlcigpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhcl9hcmdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBiYi5hcHBlbmQodmFyX2FyZ3NbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBiYi5nZXRCbG9iKCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpZiAodHlwZS5pc05hdGl2ZUJsb2JEZWZpbmVkKCkpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgQmxvYih2YXJfYXJncyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcIlRoaXMgYnJvd3NlciBkb2Vzbid0IHNlZW0gdG8gc3VwcG9ydCBjcmVhdGluZyBCbG9ic1wiKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmV4cG9ydHMuZ2V0QmxvYiA9IGdldEJsb2I7XG4vKipcbiAqIFNsaWNlcyB0aGUgYmxvYi4gVGhlIHJldHVybmVkIGJsb2IgY29udGFpbnMgZGF0YSBmcm9tIHRoZSBzdGFydCBieXRlXG4gKiAoaW5jbHVzaXZlKSB0aWxsIHRoZSBlbmQgYnl0ZSAoZXhjbHVzaXZlKS4gTmVnYXRpdmUgaW5kaWNlcyBjYW5ub3QgYmUgdXNlZC5cbiAqXG4gKiBAcGFyYW0gYmxvYiBUaGUgYmxvYiB0byBiZSBzbGljZWQuXG4gKiBAcGFyYW0gc3RhcnQgSW5kZXggb2YgdGhlIHN0YXJ0aW5nIGJ5dGUuXG4gKiBAcGFyYW0gZW5kIEluZGV4IG9mIHRoZSBlbmRpbmcgYnl0ZS5cbiAqIEByZXR1cm4gVGhlIGJsb2Igc2xpY2Ugb3IgbnVsbCBpZiBub3Qgc3VwcG9ydGVkLlxuICovXG5mdW5jdGlvbiBzbGljZUJsb2IoYmxvYiwgc3RhcnQsIGVuZCkge1xuICAgIGlmIChibG9iLndlYmtpdFNsaWNlKSB7XG4gICAgICAgIHJldHVybiBibG9iLndlYmtpdFNsaWNlKHN0YXJ0LCBlbmQpO1xuICAgIH1cbiAgICBlbHNlIGlmIChibG9iLm1velNsaWNlKSB7XG4gICAgICAgIHJldHVybiBibG9iLm1velNsaWNlKHN0YXJ0LCBlbmQpO1xuICAgIH1cbiAgICBlbHNlIGlmIChibG9iLnNsaWNlKSB7XG4gICAgICAgIHJldHVybiBibG9iLnNsaWNlKHN0YXJ0LCBlbmQpO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn1cbmV4cG9ydHMuc2xpY2VCbG9iID0gc2xpY2VCbG9iO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1mcy5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbnZhciB0eXBlID0gcmVxdWlyZShcIi4vdHlwZVwiKTtcbi8qKlxuICogUmV0dXJucyB0aGUgT2JqZWN0IHJlc3VsdGluZyBmcm9tIHBhcnNpbmcgdGhlIGdpdmVuIEpTT04sIG9yIG51bGwgaWYgdGhlXG4gKiBnaXZlbiBzdHJpbmcgZG9lcyBub3QgcmVwcmVzZW50IGEgSlNPTiBvYmplY3QuXG4gKi9cbmZ1bmN0aW9uIGpzb25PYmplY3RPck51bGwocykge1xuICAgIHZhciBvYmo7XG4gICAgdHJ5IHtcbiAgICAgICAgb2JqID0gSlNPTi5wYXJzZShzKTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGlmICh0eXBlLmlzTm9uQXJyYXlPYmplY3Qob2JqKSkge1xuICAgICAgICByZXR1cm4gb2JqO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxufVxuZXhwb3J0cy5qc29uT2JqZWN0T3JOdWxsID0ganNvbk9iamVjdE9yTnVsbDtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9anNvbi5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbi8qKlxuICogQGZpbGVvdmVydmlldyBGdW5jdGlvbmFsaXR5IHJlbGF0ZWQgdG8gdGhlIHBhcnNpbmcvY29tcG9zaXRpb24gb2YgYnVja2V0L1xuICogb2JqZWN0IGxvY2F0aW9uLlxuICovXG52YXIgZXJyb3JzRXhwb3J0cyA9IHJlcXVpcmUoXCIuL2Vycm9yXCIpO1xuLyoqXG4gKiBAc3RydWN0XG4gKi9cbnZhciBMb2NhdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBMb2NhdGlvbihidWNrZXQsIHBhdGgpIHtcbiAgICAgICAgdGhpcy5idWNrZXQgPSBidWNrZXQ7XG4gICAgICAgIHRoaXMucGF0aF8gPSBwYXRoO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTG9jYXRpb24ucHJvdG90eXBlLCBcInBhdGhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBhdGhfO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBMb2NhdGlvbi5wcm90b3R5cGUuZnVsbFNlcnZlclVybCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGVuY29kZSA9IGVuY29kZVVSSUNvbXBvbmVudDtcbiAgICAgICAgcmV0dXJuICcvYi8nICsgZW5jb2RlKHRoaXMuYnVja2V0KSArICcvby8nICsgZW5jb2RlKHRoaXMucGF0aCk7XG4gICAgfTtcbiAgICBMb2NhdGlvbi5wcm90b3R5cGUuYnVja2V0T25seVNlcnZlclVybCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGVuY29kZSA9IGVuY29kZVVSSUNvbXBvbmVudDtcbiAgICAgICAgcmV0dXJuICcvYi8nICsgZW5jb2RlKHRoaXMuYnVja2V0KSArICcvbyc7XG4gICAgfTtcbiAgICBMb2NhdGlvbi5tYWtlRnJvbUJ1Y2tldFNwZWMgPSBmdW5jdGlvbiAoYnVja2V0U3RyaW5nKSB7XG4gICAgICAgIHZhciBidWNrZXRMb2NhdGlvbjtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGJ1Y2tldExvY2F0aW9uID0gTG9jYXRpb24ubWFrZUZyb21VcmwoYnVja2V0U3RyaW5nKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgLy8gTm90IHZhbGlkIFVSTCwgdXNlIGFzLWlzLiBUaGlzIGxldHMgeW91IHB1dCBiYXJlIGJ1Y2tldCBuYW1lcyBpblxuICAgICAgICAgICAgLy8gY29uZmlnLlxuICAgICAgICAgICAgcmV0dXJuIG5ldyBMb2NhdGlvbihidWNrZXRTdHJpbmcsICcnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYnVja2V0TG9jYXRpb24ucGF0aCA9PT0gJycpIHtcbiAgICAgICAgICAgIHJldHVybiBidWNrZXRMb2NhdGlvbjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IGVycm9yc0V4cG9ydHMuaW52YWxpZERlZmF1bHRCdWNrZXQoYnVja2V0U3RyaW5nKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgTG9jYXRpb24ubWFrZUZyb21VcmwgPSBmdW5jdGlvbiAodXJsKSB7XG4gICAgICAgIHZhciBsb2NhdGlvbiA9IG51bGw7XG4gICAgICAgIHZhciBidWNrZXREb21haW4gPSAnKFtBLVphLXowLTkuXFxcXC1dKyknO1xuICAgICAgICBmdW5jdGlvbiBnc01vZGlmeShsb2MpIHtcbiAgICAgICAgICAgIGlmIChsb2MucGF0aC5jaGFyQXQobG9jLnBhdGgubGVuZ3RoIC0gMSkgPT09ICcvJykge1xuICAgICAgICAgICAgICAgIGxvYy5wYXRoXyA9IGxvYy5wYXRoXy5zbGljZSgwLCAtMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGdzUGF0aCA9ICcoLyguKikpPyQnO1xuICAgICAgICB2YXIgcGF0aCA9ICcoLyhbXj8jXSopLiopPyQnO1xuICAgICAgICB2YXIgZ3NSZWdleCA9IG5ldyBSZWdFeHAoJ15nczovLycgKyBidWNrZXREb21haW4gKyBnc1BhdGgsICdpJyk7XG4gICAgICAgIHZhciBnc0luZGljZXMgPSB7IGJ1Y2tldDogMSwgcGF0aDogMyB9O1xuICAgICAgICBmdW5jdGlvbiBodHRwTW9kaWZ5KGxvYykge1xuICAgICAgICAgICAgbG9jLnBhdGhfID0gZGVjb2RlVVJJQ29tcG9uZW50KGxvYy5wYXRoKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdmVyc2lvbiA9ICd2W0EtWmEtejAtOV9dKyc7XG4gICAgICAgIHZhciBodHRwUmVnZXggPSBuZXcgUmVnRXhwKCdeaHR0cHM/Oi8vZmlyZWJhc2VzdG9yYWdlXFxcXC5nb29nbGVhcGlzXFxcXC5jb20vJyArXG4gICAgICAgICAgICB2ZXJzaW9uICtcbiAgICAgICAgICAgICcvYi8nICtcbiAgICAgICAgICAgIGJ1Y2tldERvbWFpbiArXG4gICAgICAgICAgICAnL28nICtcbiAgICAgICAgICAgIHBhdGgsICdpJyk7XG4gICAgICAgIHZhciBodHRwSW5kaWNlcyA9IHsgYnVja2V0OiAxLCBwYXRoOiAzIH07XG4gICAgICAgIHZhciBncm91cHMgPSBbXG4gICAgICAgICAgICB7IHJlZ2V4OiBnc1JlZ2V4LCBpbmRpY2VzOiBnc0luZGljZXMsIHBvc3RNb2RpZnk6IGdzTW9kaWZ5IH0sXG4gICAgICAgICAgICB7IHJlZ2V4OiBodHRwUmVnZXgsIGluZGljZXM6IGh0dHBJbmRpY2VzLCBwb3N0TW9kaWZ5OiBodHRwTW9kaWZ5IH1cbiAgICAgICAgXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBncm91cHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBncm91cCA9IGdyb3Vwc1tpXTtcbiAgICAgICAgICAgIHZhciBjYXB0dXJlcyA9IGdyb3VwLnJlZ2V4LmV4ZWModXJsKTtcbiAgICAgICAgICAgIGlmIChjYXB0dXJlcykge1xuICAgICAgICAgICAgICAgIHZhciBidWNrZXRWYWx1ZSA9IGNhcHR1cmVzW2dyb3VwLmluZGljZXMuYnVja2V0XTtcbiAgICAgICAgICAgICAgICB2YXIgcGF0aFZhbHVlID0gY2FwdHVyZXNbZ3JvdXAuaW5kaWNlcy5wYXRoXTtcbiAgICAgICAgICAgICAgICBpZiAoIXBhdGhWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBwYXRoVmFsdWUgPSAnJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbG9jYXRpb24gPSBuZXcgTG9jYXRpb24oYnVja2V0VmFsdWUsIHBhdGhWYWx1ZSk7XG4gICAgICAgICAgICAgICAgZ3JvdXAucG9zdE1vZGlmeShsb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxvY2F0aW9uID09IG51bGwpIHtcbiAgICAgICAgICAgIHRocm93IGVycm9yc0V4cG9ydHMuaW52YWxpZFVybCh1cmwpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsb2NhdGlvbjtcbiAgICB9O1xuICAgIHJldHVybiBMb2NhdGlvbjtcbn0oKSk7XG5leHBvcnRzLkxvY2F0aW9uID0gTG9jYXRpb247XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxvY2F0aW9uLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGpzb24gPSByZXF1aXJlKFwiLi9qc29uXCIpO1xudmFyIGxvY2F0aW9uXzEgPSByZXF1aXJlKFwiLi9sb2NhdGlvblwiKTtcbnZhciBwYXRoID0gcmVxdWlyZShcIi4vcGF0aFwiKTtcbnZhciB0eXBlID0gcmVxdWlyZShcIi4vdHlwZVwiKTtcbnZhciBVcmxVdGlscyA9IHJlcXVpcmUoXCIuL3VybFwiKTtcbmZ1bmN0aW9uIG5vWGZvcm1fKG1ldGFkYXRhLCB2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZTtcbn1cbmV4cG9ydHMubm9YZm9ybV8gPSBub1hmb3JtXztcbi8qKlxuICogQHN0cnVjdFxuICovXG52YXIgTWFwcGluZyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBNYXBwaW5nKHNlcnZlciwgb3B0X2xvY2FsLCBvcHRfd3JpdGFibGUsIG9wdF94Zm9ybSkge1xuICAgICAgICB0aGlzLnNlcnZlciA9IHNlcnZlcjtcbiAgICAgICAgdGhpcy5sb2NhbCA9IG9wdF9sb2NhbCB8fCBzZXJ2ZXI7XG4gICAgICAgIHRoaXMud3JpdGFibGUgPSAhIW9wdF93cml0YWJsZTtcbiAgICAgICAgdGhpcy54Zm9ybSA9IG9wdF94Zm9ybSB8fCBub1hmb3JtXztcbiAgICB9XG4gICAgcmV0dXJuIE1hcHBpbmc7XG59KCkpO1xuZXhwb3J0cy5NYXBwaW5nID0gTWFwcGluZztcbnZhciBtYXBwaW5nc18gPSBudWxsO1xuZnVuY3Rpb24geGZvcm1QYXRoKGZ1bGxQYXRoKSB7XG4gICAgdmFyIHZhbGlkID0gdHlwZS5pc1N0cmluZyhmdWxsUGF0aCk7XG4gICAgaWYgKCF2YWxpZCB8fCBmdWxsUGF0aC5sZW5ndGggPCAyKSB7XG4gICAgICAgIHJldHVybiBmdWxsUGF0aDtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGZ1bGxQYXRoID0gZnVsbFBhdGg7XG4gICAgICAgIHJldHVybiBwYXRoLmxhc3RDb21wb25lbnQoZnVsbFBhdGgpO1xuICAgIH1cbn1cbmV4cG9ydHMueGZvcm1QYXRoID0geGZvcm1QYXRoO1xuZnVuY3Rpb24gZ2V0TWFwcGluZ3MoKSB7XG4gICAgaWYgKG1hcHBpbmdzXykge1xuICAgICAgICByZXR1cm4gbWFwcGluZ3NfO1xuICAgIH1cbiAgICB2YXIgbWFwcGluZ3MgPSBbXTtcbiAgICBtYXBwaW5ncy5wdXNoKG5ldyBNYXBwaW5nKCdidWNrZXQnKSk7XG4gICAgbWFwcGluZ3MucHVzaChuZXcgTWFwcGluZygnZ2VuZXJhdGlvbicpKTtcbiAgICBtYXBwaW5ncy5wdXNoKG5ldyBNYXBwaW5nKCdtZXRhZ2VuZXJhdGlvbicpKTtcbiAgICBtYXBwaW5ncy5wdXNoKG5ldyBNYXBwaW5nKCduYW1lJywgJ2Z1bGxQYXRoJywgdHJ1ZSkpO1xuICAgIGZ1bmN0aW9uIG1hcHBpbmdzWGZvcm1QYXRoKG1ldGFkYXRhLCBmdWxsUGF0aCkge1xuICAgICAgICByZXR1cm4geGZvcm1QYXRoKGZ1bGxQYXRoKTtcbiAgICB9XG4gICAgdmFyIG5hbWVNYXBwaW5nID0gbmV3IE1hcHBpbmcoJ25hbWUnKTtcbiAgICBuYW1lTWFwcGluZy54Zm9ybSA9IG1hcHBpbmdzWGZvcm1QYXRoO1xuICAgIG1hcHBpbmdzLnB1c2gobmFtZU1hcHBpbmcpO1xuICAgIC8qKlxuICAgICAqIENvZXJjZXMgdGhlIHNlY29uZCBwYXJhbSB0byBhIG51bWJlciwgaWYgaXQgaXMgZGVmaW5lZC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB4Zm9ybVNpemUobWV0YWRhdGEsIHNpemUpIHtcbiAgICAgICAgaWYgKHR5cGUuaXNEZWYoc2l6ZSkpIHtcbiAgICAgICAgICAgIHJldHVybiArc2l6ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBzaXplO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhciBzaXplTWFwcGluZyA9IG5ldyBNYXBwaW5nKCdzaXplJyk7XG4gICAgc2l6ZU1hcHBpbmcueGZvcm0gPSB4Zm9ybVNpemU7XG4gICAgbWFwcGluZ3MucHVzaChzaXplTWFwcGluZyk7XG4gICAgbWFwcGluZ3MucHVzaChuZXcgTWFwcGluZygndGltZUNyZWF0ZWQnKSk7XG4gICAgbWFwcGluZ3MucHVzaChuZXcgTWFwcGluZygndXBkYXRlZCcpKTtcbiAgICBtYXBwaW5ncy5wdXNoKG5ldyBNYXBwaW5nKCdtZDVIYXNoJywgbnVsbCwgdHJ1ZSkpO1xuICAgIG1hcHBpbmdzLnB1c2gobmV3IE1hcHBpbmcoJ2NhY2hlQ29udHJvbCcsIG51bGwsIHRydWUpKTtcbiAgICBtYXBwaW5ncy5wdXNoKG5ldyBNYXBwaW5nKCdjb250ZW50RGlzcG9zaXRpb24nLCBudWxsLCB0cnVlKSk7XG4gICAgbWFwcGluZ3MucHVzaChuZXcgTWFwcGluZygnY29udGVudEVuY29kaW5nJywgbnVsbCwgdHJ1ZSkpO1xuICAgIG1hcHBpbmdzLnB1c2gobmV3IE1hcHBpbmcoJ2NvbnRlbnRMYW5ndWFnZScsIG51bGwsIHRydWUpKTtcbiAgICBtYXBwaW5ncy5wdXNoKG5ldyBNYXBwaW5nKCdjb250ZW50VHlwZScsIG51bGwsIHRydWUpKTtcbiAgICBtYXBwaW5ncy5wdXNoKG5ldyBNYXBwaW5nKCdtZXRhZGF0YScsICdjdXN0b21NZXRhZGF0YScsIHRydWUpKTtcbiAgICAvKipcbiAgICAgKiBUcmFuc2Zvcm1zIGEgY29tbWEtc2VwYXJhdGVkIHN0cmluZyBvZiB0b2tlbnMgaW50byBhIGxpc3Qgb2YgZG93bmxvYWRcbiAgICAgKiBVUkxzLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHhmb3JtVG9rZW5zKG1ldGFkYXRhLCB0b2tlbnMpIHtcbiAgICAgICAgdmFyIHZhbGlkID0gdHlwZS5pc1N0cmluZyh0b2tlbnMpICYmIHRva2Vucy5sZW5ndGggPiAwO1xuICAgICAgICBpZiAoIXZhbGlkKSB7XG4gICAgICAgICAgICAvLyBUaGlzIGNhbiBoYXBwZW4gaWYgb2JqZWN0cyBhcmUgdXBsb2FkZWQgdGhyb3VnaCBHQ1MgYW5kIHJldHJpZXZlZFxuICAgICAgICAgICAgLy8gdGhyb3VnaCBsaXN0LCBzbyB3ZSBkb24ndCB3YW50IHRvIHRocm93IGFuIEVycm9yLlxuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgICAgIHZhciBlbmNvZGUgPSBlbmNvZGVVUklDb21wb25lbnQ7XG4gICAgICAgIHZhciB0b2tlbnNMaXN0ID0gdG9rZW5zLnNwbGl0KCcsJyk7XG4gICAgICAgIHZhciB1cmxzID0gdG9rZW5zTGlzdC5tYXAoZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgICAgICB2YXIgYnVja2V0ID0gbWV0YWRhdGFbJ2J1Y2tldCddO1xuICAgICAgICAgICAgdmFyIHBhdGggPSBtZXRhZGF0YVsnZnVsbFBhdGgnXTtcbiAgICAgICAgICAgIHZhciB1cmxQYXJ0ID0gJy9iLycgKyBlbmNvZGUoYnVja2V0KSArICcvby8nICsgZW5jb2RlKHBhdGgpO1xuICAgICAgICAgICAgdmFyIGJhc2UgPSBVcmxVdGlscy5tYWtlRG93bmxvYWRVcmwodXJsUGFydCk7XG4gICAgICAgICAgICB2YXIgcXVlcnlTdHJpbmcgPSBVcmxVdGlscy5tYWtlUXVlcnlTdHJpbmcoe1xuICAgICAgICAgICAgICAgIGFsdDogJ21lZGlhJyxcbiAgICAgICAgICAgICAgICB0b2tlbjogdG9rZW5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGJhc2UgKyBxdWVyeVN0cmluZztcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB1cmxzO1xuICAgIH1cbiAgICBtYXBwaW5ncy5wdXNoKG5ldyBNYXBwaW5nKCdkb3dubG9hZFRva2VucycsICdkb3dubG9hZFVSTHMnLCBmYWxzZSwgeGZvcm1Ub2tlbnMpKTtcbiAgICBtYXBwaW5nc18gPSBtYXBwaW5ncztcbiAgICByZXR1cm4gbWFwcGluZ3NfO1xufVxuZXhwb3J0cy5nZXRNYXBwaW5ncyA9IGdldE1hcHBpbmdzO1xuZnVuY3Rpb24gYWRkUmVmKG1ldGFkYXRhLCBhdXRoV3JhcHBlcikge1xuICAgIGZ1bmN0aW9uIGdlbmVyYXRlUmVmKCkge1xuICAgICAgICB2YXIgYnVja2V0ID0gbWV0YWRhdGFbJ2J1Y2tldCddO1xuICAgICAgICB2YXIgcGF0aCA9IG1ldGFkYXRhWydmdWxsUGF0aCddO1xuICAgICAgICB2YXIgbG9jID0gbmV3IGxvY2F0aW9uXzEuTG9jYXRpb24oYnVja2V0LCBwYXRoKTtcbiAgICAgICAgcmV0dXJuIGF1dGhXcmFwcGVyLm1ha2VTdG9yYWdlUmVmZXJlbmNlKGxvYyk7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShtZXRhZGF0YSwgJ3JlZicsIHsgZ2V0OiBnZW5lcmF0ZVJlZiB9KTtcbn1cbmV4cG9ydHMuYWRkUmVmID0gYWRkUmVmO1xuZnVuY3Rpb24gZnJvbVJlc291cmNlKGF1dGhXcmFwcGVyLCByZXNvdXJjZSwgbWFwcGluZ3MpIHtcbiAgICB2YXIgbWV0YWRhdGEgPSB7fTtcbiAgICBtZXRhZGF0YVsndHlwZSddID0gJ2ZpbGUnO1xuICAgIHZhciBsZW4gPSBtYXBwaW5ncy5sZW5ndGg7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICB2YXIgbWFwcGluZyA9IG1hcHBpbmdzW2ldO1xuICAgICAgICBtZXRhZGF0YVttYXBwaW5nLmxvY2FsXSA9IG1hcHBpbmcueGZvcm0obWV0YWRhdGEsIHJlc291cmNlW21hcHBpbmcuc2VydmVyXSk7XG4gICAgfVxuICAgIGFkZFJlZihtZXRhZGF0YSwgYXV0aFdyYXBwZXIpO1xuICAgIHJldHVybiBtZXRhZGF0YTtcbn1cbmV4cG9ydHMuZnJvbVJlc291cmNlID0gZnJvbVJlc291cmNlO1xuZnVuY3Rpb24gZnJvbVJlc291cmNlU3RyaW5nKGF1dGhXcmFwcGVyLCByZXNvdXJjZVN0cmluZywgbWFwcGluZ3MpIHtcbiAgICB2YXIgb2JqID0ganNvbi5qc29uT2JqZWN0T3JOdWxsKHJlc291cmNlU3RyaW5nKTtcbiAgICBpZiAob2JqID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgcmVzb3VyY2UgPSBvYmo7XG4gICAgcmV0dXJuIGZyb21SZXNvdXJjZShhdXRoV3JhcHBlciwgcmVzb3VyY2UsIG1hcHBpbmdzKTtcbn1cbmV4cG9ydHMuZnJvbVJlc291cmNlU3RyaW5nID0gZnJvbVJlc291cmNlU3RyaW5nO1xuZnVuY3Rpb24gdG9SZXNvdXJjZVN0cmluZyhtZXRhZGF0YSwgbWFwcGluZ3MpIHtcbiAgICB2YXIgcmVzb3VyY2UgPSB7fTtcbiAgICB2YXIgbGVuID0gbWFwcGluZ3MubGVuZ3RoO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgdmFyIG1hcHBpbmcgPSBtYXBwaW5nc1tpXTtcbiAgICAgICAgaWYgKG1hcHBpbmcud3JpdGFibGUpIHtcbiAgICAgICAgICAgIHJlc291cmNlW21hcHBpbmcuc2VydmVyXSA9IG1ldGFkYXRhW21hcHBpbmcubG9jYWxdO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShyZXNvdXJjZSk7XG59XG5leHBvcnRzLnRvUmVzb3VyY2VTdHJpbmcgPSB0b1Jlc291cmNlU3RyaW5nO1xuZnVuY3Rpb24gbWV0YWRhdGFWYWxpZGF0b3IocCkge1xuICAgIHZhciB2YWxpZFR5cGUgPSBwICYmIHR5cGUuaXNPYmplY3QocCk7XG4gICAgaWYgKCF2YWxpZFR5cGUpIHtcbiAgICAgICAgdGhyb3cgJ0V4cGVjdGVkIE1ldGFkYXRhIG9iamVjdC4nO1xuICAgIH1cbiAgICBmb3IgKHZhciBrZXkgaW4gcCkge1xuICAgICAgICB2YXIgdmFsID0gcFtrZXldO1xuICAgICAgICBpZiAoa2V5ID09PSAnY3VzdG9tTWV0YWRhdGEnKSB7XG4gICAgICAgICAgICBpZiAoIXR5cGUuaXNPYmplY3QodmFsKSkge1xuICAgICAgICAgICAgICAgIHRocm93ICdFeHBlY3RlZCBvYmplY3QgZm9yIFxcJ2N1c3RvbU1ldGFkYXRhXFwnIG1hcHBpbmcuJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0eXBlLmlzTm9uTnVsbE9iamVjdCh2YWwpKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgXCJNYXBwaW5nIGZvciAnXCIgKyBrZXkgKyBcIicgY2Fubm90IGJlIGFuIG9iamVjdC5cIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbmV4cG9ydHMubWV0YWRhdGFWYWxpZGF0b3IgPSBtZXRhZGF0YVZhbGlkYXRvcjtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bWV0YWRhdGEuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG4vKipcbiAqIEBmaWxlb3ZlcnZpZXcgQ29udGFpbnMgbWV0aG9kcyBmb3Igd29ya2luZyB3aXRoIG9iamVjdHMuXG4gKi9cbmZ1bmN0aW9uIGNvbnRhaW5zKG9iaiwgcHJvcCkge1xuICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKTtcbn1cbmV4cG9ydHMuY29udGFpbnMgPSBjb250YWlucztcbmZ1bmN0aW9uIGZvckVhY2gob2JqLCBmKSB7XG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgICAgICBpZiAoY29udGFpbnMob2JqLCBrZXkpKSB7XG4gICAgICAgICAgICBmKGtleSwgb2JqW2tleV0pO1xuICAgICAgICB9XG4gICAgfVxufVxuZXhwb3J0cy5mb3JFYWNoID0gZm9yRWFjaDtcbmZ1bmN0aW9uIGNsb25lKG9iaikge1xuICAgIGlmIChvYmogPT0gbnVsbCkge1xuICAgICAgICByZXR1cm4ge307XG4gICAgfVxuICAgIHZhciBjID0ge307XG4gICAgZm9yRWFjaChvYmosIGZ1bmN0aW9uIChrZXksIHZhbCkge1xuICAgICAgICBjW2tleV0gPSB2YWw7XG4gICAgfSk7XG4gICAgcmV0dXJuIGM7XG59XG5leHBvcnRzLmNsb25lID0gY2xvbmU7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW9iamVjdC5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbnZhciB0eXBlID0gcmVxdWlyZShcIi4vdHlwZVwiKTtcbi8qKlxuICogQHN0cnVjdFxuICovXG52YXIgT2JzZXJ2ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gT2JzZXJ2ZXIobmV4dE9yT2JzZXJ2ZXIsIG9wdF9lcnJvciwgb3B0X2NvbXBsZXRlKSB7XG4gICAgICAgIHZhciBhc0Z1bmN0aW9ucyA9IHR5cGUuaXNGdW5jdGlvbihuZXh0T3JPYnNlcnZlcikgfHxcbiAgICAgICAgICAgIHR5cGUuaXNEZWYob3B0X2Vycm9yKSB8fFxuICAgICAgICAgICAgdHlwZS5pc0RlZihvcHRfY29tcGxldGUpO1xuICAgICAgICBpZiAoYXNGdW5jdGlvbnMpIHtcbiAgICAgICAgICAgIHRoaXMubmV4dCA9IG5leHRPck9ic2VydmVyO1xuICAgICAgICAgICAgdGhpcy5lcnJvciA9IG9wdF9lcnJvciB8fCBudWxsO1xuICAgICAgICAgICAgdGhpcy5jb21wbGV0ZSA9IG9wdF9jb21wbGV0ZSB8fCBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIG9ic2VydmVyID0gbmV4dE9yT2JzZXJ2ZXI7XG4gICAgICAgICAgICB0aGlzLm5leHQgPSBvYnNlcnZlci5uZXh0IHx8IG51bGw7XG4gICAgICAgICAgICB0aGlzLmVycm9yID0gb2JzZXJ2ZXIuZXJyb3IgfHwgbnVsbDtcbiAgICAgICAgICAgIHRoaXMuY29tcGxldGUgPSBvYnNlcnZlci5jb21wbGV0ZSB8fCBudWxsO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBPYnNlcnZlcjtcbn0oKSk7XG5leHBvcnRzLk9ic2VydmVyID0gT2JzZXJ2ZXI7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW9ic2VydmVyLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuLyoqXG4gKiBAZmlsZW92ZXJ2aWV3IENvbnRhaW5zIGhlbHBlciBtZXRob2RzIGZvciBtYW5pcHVsYXRpbmcgcGF0aHMuXG4gKi9cbi8qKlxuICogQHJldHVybiBOdWxsIGlmIHRoZSBwYXRoIGlzIGFscmVhZHkgYXQgdGhlIHJvb3QuXG4gKi9cbmZ1bmN0aW9uIHBhcmVudChwYXRoKSB7XG4gICAgaWYgKHBhdGgubGVuZ3RoID09IDApIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBpbmRleCA9IHBhdGgubGFzdEluZGV4T2YoJy8nKTtcbiAgICBpZiAoaW5kZXggPT09IC0xKSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG4gICAgdmFyIG5ld1BhdGggPSBwYXRoLnNsaWNlKDAsIGluZGV4KTtcbiAgICByZXR1cm4gbmV3UGF0aDtcbn1cbmV4cG9ydHMucGFyZW50ID0gcGFyZW50O1xuZnVuY3Rpb24gY2hpbGQocGF0aCwgY2hpbGRQYXRoKSB7XG4gICAgdmFyIGNhbm9uaWNhbENoaWxkUGF0aCA9IGNoaWxkUGF0aFxuICAgICAgICAuc3BsaXQoJy8nKVxuICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChjb21wb25lbnQpIHtcbiAgICAgICAgcmV0dXJuIGNvbXBvbmVudC5sZW5ndGggPiAwO1xuICAgIH0pXG4gICAgICAgIC5qb2luKCcvJyk7XG4gICAgaWYgKHBhdGgubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiBjYW5vbmljYWxDaGlsZFBhdGg7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gcGF0aCArICcvJyArIGNhbm9uaWNhbENoaWxkUGF0aDtcbiAgICB9XG59XG5leHBvcnRzLmNoaWxkID0gY2hpbGQ7XG4vKipcbiAqIFJldHVybnMgdGhlIGxhc3QgY29tcG9uZW50IG9mIGEgcGF0aC5cbiAqICcvZm9vL2JhcicgLT4gJ2JhcidcbiAqICcvZm9vL2Jhci9iYXovJyAtPiAnYmF6LydcbiAqICcvYScgLT4gJ2EnXG4gKi9cbmZ1bmN0aW9uIGxhc3RDb21wb25lbnQocGF0aCkge1xuICAgIHZhciBpbmRleCA9IHBhdGgubGFzdEluZGV4T2YoJy8nLCBwYXRoLmxlbmd0aCAtIDIpO1xuICAgIGlmIChpbmRleCA9PT0gLTEpIHtcbiAgICAgICAgcmV0dXJuIHBhdGg7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gcGF0aC5zbGljZShpbmRleCArIDEpO1xuICAgIH1cbn1cbmV4cG9ydHMubGFzdENvbXBvbmVudCA9IGxhc3RDb21wb25lbnQ7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhdGguanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG4vKipcbiAqIEBmaWxlb3ZlcnZpZXcgSW1wbGVtZW50cyB0aGUgcHJvbWlzZSBhYnN0cmFjdGlvbiBpbnRlcmZhY2UgZm9yIGV4dGVybmFsXG4gKiAocHVibGljIFNESykgcGFja2FnaW5nLCB3aGljaCBqdXN0IHBhc3NlcyB0aHJvdWdoIHRvIHRoZSBmaXJlYmFzZS1hcHAgaW1wbC5cbiAqL1xuLyoqXG4gKiBAdGVtcGxhdGUgVFxuICogQHBhcmFtIHtmdW5jdGlvbigoZnVuY3Rpb24oVCk6IHZvaWQpLFxuICogICAgICAgICAgICAgICAgICAoZnVuY3Rpb24oIUVycm9yKTogdm9pZCkpfSByZXNvbHZlclxuICovXG5mdW5jdGlvbiBtYWtlKHJlc29sdmVyKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmVyKTtcbn1cbmV4cG9ydHMubWFrZSA9IG1ha2U7XG4vKipcbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmZ1bmN0aW9uIHJlc29sdmUodmFsdWUpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHZhbHVlKTtcbn1cbmV4cG9ydHMucmVzb2x2ZSA9IHJlc29sdmU7XG5mdW5jdGlvbiByZWplY3QoZXJyb3IpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xufVxuZXhwb3J0cy5yZWplY3QgPSByZWplY3Q7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXByb21pc2VfZXh0ZXJuYWwuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG4vKipcbiAqIEBmaWxlb3ZlcnZpZXcgRGVmaW5lcyBtZXRob2RzIHVzZWQgdG8gYWN0dWFsbHkgc2VuZCBIVFRQIHJlcXVlc3RzIGZyb21cbiAqIGFic3RyYWN0IHJlcHJlc2VudGF0aW9ucy5cbiAqL1xudmFyIGFwcF8xID0gcmVxdWlyZShcIkBmaXJlYmFzZS9hcHBcIik7XG52YXIgYXJyYXkgPSByZXF1aXJlKFwiLi9hcnJheVwiKTtcbnZhciBiYWNrb2ZmID0gcmVxdWlyZShcIi4vYmFja29mZlwiKTtcbnZhciBlcnJvcnNFeHBvcnRzID0gcmVxdWlyZShcIi4vZXJyb3JcIik7XG52YXIgb2JqZWN0ID0gcmVxdWlyZShcIi4vb2JqZWN0XCIpO1xudmFyIHByb21pc2VpbXBsID0gcmVxdWlyZShcIi4vcHJvbWlzZV9leHRlcm5hbFwiKTtcbnZhciB0eXBlID0gcmVxdWlyZShcIi4vdHlwZVwiKTtcbnZhciBVcmxVdGlscyA9IHJlcXVpcmUoXCIuL3VybFwiKTtcbnZhciBYaHJJb0V4cG9ydHMgPSByZXF1aXJlKFwiLi94aHJpb1wiKTtcbi8qKlxuICogQHN0cnVjdFxuICogQHRlbXBsYXRlIFRcbiAqL1xudmFyIE5ldHdvcmtSZXF1ZXN0ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE5ldHdvcmtSZXF1ZXN0KHVybCwgbWV0aG9kLCBoZWFkZXJzLCBib2R5LCBzdWNjZXNzQ29kZXMsIGFkZGl0aW9uYWxSZXRyeUNvZGVzLCBjYWxsYmFjaywgZXJyb3JDYWxsYmFjaywgdGltZW91dCwgcHJvZ3Jlc3NDYWxsYmFjaywgcG9vbCkge1xuICAgICAgICB0aGlzLnBlbmRpbmdYaHJfID0gbnVsbDtcbiAgICAgICAgdGhpcy5iYWNrb2ZmSWRfID0gbnVsbDtcbiAgICAgICAgdGhpcy5yZXNvbHZlXyA9IG51bGw7XG4gICAgICAgIHRoaXMucmVqZWN0XyA9IG51bGw7XG4gICAgICAgIHRoaXMuY2FuY2VsZWRfID0gZmFsc2U7XG4gICAgICAgIHRoaXMuYXBwRGVsZXRlXyA9IGZhbHNlO1xuICAgICAgICB0aGlzLnVybF8gPSB1cmw7XG4gICAgICAgIHRoaXMubWV0aG9kXyA9IG1ldGhvZDtcbiAgICAgICAgdGhpcy5oZWFkZXJzXyA9IGhlYWRlcnM7XG4gICAgICAgIHRoaXMuYm9keV8gPSBib2R5O1xuICAgICAgICB0aGlzLnN1Y2Nlc3NDb2Rlc18gPSBzdWNjZXNzQ29kZXMuc2xpY2UoKTtcbiAgICAgICAgdGhpcy5hZGRpdGlvbmFsUmV0cnlDb2Rlc18gPSBhZGRpdGlvbmFsUmV0cnlDb2Rlcy5zbGljZSgpO1xuICAgICAgICB0aGlzLmNhbGxiYWNrXyA9IGNhbGxiYWNrO1xuICAgICAgICB0aGlzLmVycm9yQ2FsbGJhY2tfID0gZXJyb3JDYWxsYmFjaztcbiAgICAgICAgdGhpcy5wcm9ncmVzc0NhbGxiYWNrXyA9IHByb2dyZXNzQ2FsbGJhY2s7XG4gICAgICAgIHRoaXMudGltZW91dF8gPSB0aW1lb3V0O1xuICAgICAgICB0aGlzLnBvb2xfID0gcG9vbDtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLnByb21pc2VfID0gcHJvbWlzZWltcGwubWFrZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICBzZWxmLnJlc29sdmVfID0gcmVzb2x2ZTtcbiAgICAgICAgICAgIHNlbGYucmVqZWN0XyA9IHJlamVjdDtcbiAgICAgICAgICAgIHNlbGYuc3RhcnRfKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBY3R1YWxseSBzdGFydHMgdGhlIHJldHJ5IGxvb3AuXG4gICAgICovXG4gICAgTmV0d29ya1JlcXVlc3QucHJvdG90eXBlLnN0YXJ0XyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBkb1RoZVJlcXVlc3QoYmFja29mZkNhbGxiYWNrLCBjYW5jZWxlZCkge1xuICAgICAgICAgICAgaWYgKGNhbmNlbGVkKSB7XG4gICAgICAgICAgICAgICAgYmFja29mZkNhbGxiYWNrKGZhbHNlLCBuZXcgUmVxdWVzdEVuZFN0YXR1cyhmYWxzZSwgbnVsbCwgdHJ1ZSkpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB4aHIgPSBzZWxmLnBvb2xfLmNyZWF0ZVhocklvKCk7XG4gICAgICAgICAgICBzZWxmLnBlbmRpbmdYaHJfID0geGhyO1xuICAgICAgICAgICAgZnVuY3Rpb24gcHJvZ3Jlc3NMaXN0ZW5lcihwcm9ncmVzc0V2ZW50KSB7XG4gICAgICAgICAgICAgICAgdmFyIGxvYWRlZCA9IHByb2dyZXNzRXZlbnQubG9hZGVkO1xuICAgICAgICAgICAgICAgIHZhciB0b3RhbCA9IHByb2dyZXNzRXZlbnQubGVuZ3RoQ29tcHV0YWJsZSA/IHByb2dyZXNzRXZlbnQudG90YWwgOiAtMTtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5wcm9ncmVzc0NhbGxiYWNrXyAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnByb2dyZXNzQ2FsbGJhY2tfKGxvYWRlZCwgdG90YWwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzZWxmLnByb2dyZXNzQ2FsbGJhY2tfICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgeGhyLmFkZFVwbG9hZFByb2dyZXNzTGlzdGVuZXIocHJvZ3Jlc3NMaXN0ZW5lcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB4aHJcbiAgICAgICAgICAgICAgICAuc2VuZChzZWxmLnVybF8sIHNlbGYubWV0aG9kXywgc2VsZi5ib2R5Xywgc2VsZi5oZWFkZXJzXylcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoeGhyKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYucHJvZ3Jlc3NDYWxsYmFja18gIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgeGhyLnJlbW92ZVVwbG9hZFByb2dyZXNzTGlzdGVuZXIocHJvZ3Jlc3NMaXN0ZW5lcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNlbGYucGVuZGluZ1hocl8gPSBudWxsO1xuICAgICAgICAgICAgICAgIHhociA9IHhocjtcbiAgICAgICAgICAgICAgICB2YXIgaGl0U2VydmVyID0geGhyLmdldEVycm9yQ29kZSgpID09PSBYaHJJb0V4cG9ydHMuRXJyb3JDb2RlLk5PX0VSUk9SO1xuICAgICAgICAgICAgICAgIHZhciBzdGF0dXMgPSB4aHIuZ2V0U3RhdHVzKCk7XG4gICAgICAgICAgICAgICAgaWYgKCFoaXRTZXJ2ZXIgfHwgc2VsZi5pc1JldHJ5U3RhdHVzQ29kZV8oc3RhdHVzKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgd2FzQ2FuY2VsZWQgPSB4aHIuZ2V0RXJyb3JDb2RlKCkgPT09IFhocklvRXhwb3J0cy5FcnJvckNvZGUuQUJPUlQ7XG4gICAgICAgICAgICAgICAgICAgIGJhY2tvZmZDYWxsYmFjayhmYWxzZSwgbmV3IFJlcXVlc3RFbmRTdGF0dXMoZmFsc2UsIG51bGwsIHdhc0NhbmNlbGVkKSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3NDb2RlID0gYXJyYXkuY29udGFpbnMoc2VsZi5zdWNjZXNzQ29kZXNfLCBzdGF0dXMpO1xuICAgICAgICAgICAgICAgIGJhY2tvZmZDYWxsYmFjayh0cnVlLCBuZXcgUmVxdWVzdEVuZFN0YXR1cyhzdWNjZXNzQ29kZSwgeGhyKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogQHBhcmFtIHJlcXVlc3RXZW50VGhyb3VnaCBUcnVlIGlmIHRoZSByZXF1ZXN0IGV2ZW50dWFsbHkgd2VudFxuICAgICAgICAgKiAgICAgdGhyb3VnaCwgZmFsc2UgaWYgaXQgaGl0IHRoZSByZXRyeSBsaW1pdCBvciB3YXMgY2FuY2VsZWQuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBiYWNrb2ZmRG9uZShyZXF1ZXN0V2VudFRocm91Z2gsIHN0YXR1cykge1xuICAgICAgICAgICAgdmFyIHJlc29sdmUgPSBzZWxmLnJlc29sdmVfO1xuICAgICAgICAgICAgdmFyIHJlamVjdCA9IHNlbGYucmVqZWN0XztcbiAgICAgICAgICAgIHZhciB4aHIgPSBzdGF0dXMueGhyO1xuICAgICAgICAgICAgaWYgKHN0YXR1cy53YXNTdWNjZXNzQ29kZSkge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBzZWxmLmNhbGxiYWNrXyh4aHIsIHhoci5nZXRSZXNwb25zZVRleHQoKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlLmlzSnVzdERlZihyZXN1bHQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICh4aHIgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVyciA9IGVycm9yc0V4cG9ydHMudW5rbm93bigpO1xuICAgICAgICAgICAgICAgICAgICBlcnIuc2V0U2VydmVyUmVzcG9uc2VQcm9wKHhoci5nZXRSZXNwb25zZVRleHQoKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLmVycm9yQ2FsbGJhY2tfKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3Qoc2VsZi5lcnJvckNhbGxiYWNrXyh4aHIsIGVycikpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGF0dXMuY2FuY2VsZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlcnIgPSBzZWxmLmFwcERlbGV0ZV9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGVycm9yc0V4cG9ydHMuYXBwRGVsZXRlZCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBlcnJvcnNFeHBvcnRzLmNhbmNlbGVkKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlcnIgPSBlcnJvcnNFeHBvcnRzLnJldHJ5TGltaXRFeGNlZWRlZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY2FuY2VsZWRfKSB7XG4gICAgICAgICAgICBiYWNrb2ZmRG9uZShmYWxzZSwgbmV3IFJlcXVlc3RFbmRTdGF0dXMoZmFsc2UsIG51bGwsIHRydWUpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYmFja29mZklkXyA9IGJhY2tvZmYuc3RhcnQoZG9UaGVSZXF1ZXN0LCBiYWNrb2ZmRG9uZSwgdGhpcy50aW1lb3V0Xyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKiBAaW5oZXJpdERvYyAqL1xuICAgIE5ldHdvcmtSZXF1ZXN0LnByb3RvdHlwZS5nZXRQcm9taXNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9taXNlXztcbiAgICB9O1xuICAgIC8qKiBAaW5oZXJpdERvYyAqL1xuICAgIE5ldHdvcmtSZXF1ZXN0LnByb3RvdHlwZS5jYW5jZWwgPSBmdW5jdGlvbiAoYXBwRGVsZXRlKSB7XG4gICAgICAgIHRoaXMuY2FuY2VsZWRfID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5hcHBEZWxldGVfID0gYXBwRGVsZXRlIHx8IGZhbHNlO1xuICAgICAgICBpZiAodGhpcy5iYWNrb2ZmSWRfICE9PSBudWxsKSB7XG4gICAgICAgICAgICBiYWNrb2ZmLnN0b3AodGhpcy5iYWNrb2ZmSWRfKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wZW5kaW5nWGhyXyAhPT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5wZW5kaW5nWGhyXy5hYm9ydCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBOZXR3b3JrUmVxdWVzdC5wcm90b3R5cGUuaXNSZXRyeVN0YXR1c0NvZGVfID0gZnVuY3Rpb24gKHN0YXR1cykge1xuICAgICAgICAvLyBUaGUgY29kZXMgZm9yIHdoaWNoIHRvIHJldHJ5IGNhbWUgZnJvbSB0aGlzIHBhZ2U6XG4gICAgICAgIC8vIGh0dHBzOi8vY2xvdWQuZ29vZ2xlLmNvbS9zdG9yYWdlL2RvY3MvZXhwb25lbnRpYWwtYmFja29mZlxuICAgICAgICB2YXIgaXNGaXZlSHVuZHJlZENvZGUgPSBzdGF0dXMgPj0gNTAwICYmIHN0YXR1cyA8IDYwMDtcbiAgICAgICAgdmFyIGV4dHJhUmV0cnlDb2RlcyA9IFtcbiAgICAgICAgICAgIC8vIFJlcXVlc3QgVGltZW91dDogd2ViIHNlcnZlciBkaWRuJ3QgcmVjZWl2ZSBmdWxsIHJlcXVlc3QgaW4gdGltZS5cbiAgICAgICAgICAgIDQwOCxcbiAgICAgICAgICAgIC8vIFRvbyBNYW55IFJlcXVlc3RzOiB5b3UncmUgZ2V0dGluZyByYXRlLWxpbWl0ZWQsIGJhc2ljYWxseS5cbiAgICAgICAgICAgIDQyOVxuICAgICAgICBdO1xuICAgICAgICB2YXIgaXNFeHRyYVJldHJ5Q29kZSA9IGFycmF5LmNvbnRhaW5zKGV4dHJhUmV0cnlDb2Rlcywgc3RhdHVzKTtcbiAgICAgICAgdmFyIGlzUmVxdWVzdFNwZWNpZmljUmV0cnlDb2RlID0gYXJyYXkuY29udGFpbnModGhpcy5hZGRpdGlvbmFsUmV0cnlDb2Rlc18sIHN0YXR1cyk7XG4gICAgICAgIHJldHVybiBpc0ZpdmVIdW5kcmVkQ29kZSB8fCBpc0V4dHJhUmV0cnlDb2RlIHx8IGlzUmVxdWVzdFNwZWNpZmljUmV0cnlDb2RlO1xuICAgIH07XG4gICAgcmV0dXJuIE5ldHdvcmtSZXF1ZXN0O1xufSgpKTtcbi8qKlxuICogQSBjb2xsZWN0aW9uIG9mIGluZm9ybWF0aW9uIGFib3V0IHRoZSByZXN1bHQgb2YgYSBuZXR3b3JrIHJlcXVlc3QuXG4gKiBAcGFyYW0gb3B0X2NhbmNlbGVkIERlZmF1bHRzIHRvIGZhbHNlLlxuICogQHN0cnVjdFxuICovXG52YXIgUmVxdWVzdEVuZFN0YXR1cyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBSZXF1ZXN0RW5kU3RhdHVzKHdhc1N1Y2Nlc3NDb2RlLCB4aHIsIG9wdF9jYW5jZWxlZCkge1xuICAgICAgICB0aGlzLndhc1N1Y2Nlc3NDb2RlID0gd2FzU3VjY2Vzc0NvZGU7XG4gICAgICAgIHRoaXMueGhyID0geGhyO1xuICAgICAgICB0aGlzLmNhbmNlbGVkID0gISFvcHRfY2FuY2VsZWQ7XG4gICAgfVxuICAgIHJldHVybiBSZXF1ZXN0RW5kU3RhdHVzO1xufSgpKTtcbmV4cG9ydHMuUmVxdWVzdEVuZFN0YXR1cyA9IFJlcXVlc3RFbmRTdGF0dXM7XG5mdW5jdGlvbiBhZGRBdXRoSGVhZGVyXyhoZWFkZXJzLCBhdXRoVG9rZW4pIHtcbiAgICBpZiAoYXV0aFRva2VuICE9PSBudWxsICYmIGF1dGhUb2tlbi5sZW5ndGggPiAwKSB7XG4gICAgICAgIGhlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdGaXJlYmFzZSAnICsgYXV0aFRva2VuO1xuICAgIH1cbn1cbmV4cG9ydHMuYWRkQXV0aEhlYWRlcl8gPSBhZGRBdXRoSGVhZGVyXztcbmZ1bmN0aW9uIGFkZFZlcnNpb25IZWFkZXJfKGhlYWRlcnMpIHtcbiAgICB2YXIgbnVtYmVyID0gdHlwZW9mIGFwcF8xLmRlZmF1bHQgIT09ICd1bmRlZmluZWQnID8gYXBwXzEuZGVmYXVsdC5TREtfVkVSU0lPTiA6ICdBcHBNYW5hZ2VyJztcbiAgICBoZWFkZXJzWydYLUZpcmViYXNlLVN0b3JhZ2UtVmVyc2lvbiddID0gJ3dlYmpzLycgKyBudW1iZXI7XG59XG5leHBvcnRzLmFkZFZlcnNpb25IZWFkZXJfID0gYWRkVmVyc2lvbkhlYWRlcl87XG4vKipcbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmZ1bmN0aW9uIG1ha2VSZXF1ZXN0KHJlcXVlc3RJbmZvLCBhdXRoVG9rZW4sIHBvb2wpIHtcbiAgICB2YXIgcXVlcnlQYXJ0ID0gVXJsVXRpbHMubWFrZVF1ZXJ5U3RyaW5nKHJlcXVlc3RJbmZvLnVybFBhcmFtcyk7XG4gICAgdmFyIHVybCA9IHJlcXVlc3RJbmZvLnVybCArIHF1ZXJ5UGFydDtcbiAgICB2YXIgaGVhZGVycyA9IG9iamVjdC5jbG9uZShyZXF1ZXN0SW5mby5oZWFkZXJzKTtcbiAgICBhZGRBdXRoSGVhZGVyXyhoZWFkZXJzLCBhdXRoVG9rZW4pO1xuICAgIGFkZFZlcnNpb25IZWFkZXJfKGhlYWRlcnMpO1xuICAgIHJldHVybiBuZXcgTmV0d29ya1JlcXVlc3QodXJsLCByZXF1ZXN0SW5mby5tZXRob2QsIGhlYWRlcnMsIHJlcXVlc3RJbmZvLmJvZHksIHJlcXVlc3RJbmZvLnN1Y2Nlc3NDb2RlcywgcmVxdWVzdEluZm8uYWRkaXRpb25hbFJldHJ5Q29kZXMsIHJlcXVlc3RJbmZvLmhhbmRsZXIsIHJlcXVlc3RJbmZvLmVycm9ySGFuZGxlciwgcmVxdWVzdEluZm8udGltZW91dCwgcmVxdWVzdEluZm8ucHJvZ3Jlc3NDYWxsYmFjaywgcG9vbCk7XG59XG5leHBvcnRzLm1ha2VSZXF1ZXN0ID0gbWFrZVJlcXVlc3Q7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXJlcXVlc3QuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBSZXF1ZXN0SW5mbyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBSZXF1ZXN0SW5mbyh1cmwsIG1ldGhvZCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgICAqIFJldHVybnMgdGhlIHZhbHVlIHdpdGggd2hpY2ggdG8gcmVzb2x2ZSB0aGUgcmVxdWVzdCdzIHByb21pc2UuIE9ubHkgY2FsbGVkXG4gICAgICAgICAgICogaWYgdGhlIHJlcXVlc3QgaXMgc3VjY2Vzc2Z1bC4gVGhyb3cgZnJvbSB0aGlzIGZ1bmN0aW9uIHRvIHJlamVjdCB0aGVcbiAgICAgICAgICAgKiByZXR1cm5lZCBSZXF1ZXN0J3MgcHJvbWlzZSB3aXRoIHRoZSB0aHJvd24gZXJyb3IuXG4gICAgICAgICAgICogTm90ZTogVGhlIFhocklvIHBhc3NlZCB0byB0aGlzIGZ1bmN0aW9uIG1heSBiZSByZXVzZWQgYWZ0ZXIgdGhpcyBjYWxsYmFja1xuICAgICAgICAgICAqIHJldHVybnMuIERvIG5vdCBrZWVwIGEgcmVmZXJlbmNlIHRvIGl0IGluIGFueSB3YXkuXG4gICAgICAgICAgICovXG4gICAgICAgIGhhbmRsZXIsIHRpbWVvdXQpIHtcbiAgICAgICAgdGhpcy51cmwgPSB1cmw7XG4gICAgICAgIHRoaXMubWV0aG9kID0gbWV0aG9kO1xuICAgICAgICB0aGlzLmhhbmRsZXIgPSBoYW5kbGVyO1xuICAgICAgICB0aGlzLnRpbWVvdXQgPSB0aW1lb3V0O1xuICAgICAgICB0aGlzLnVybFBhcmFtcyA9IHt9O1xuICAgICAgICB0aGlzLmhlYWRlcnMgPSB7fTtcbiAgICAgICAgdGhpcy5ib2R5ID0gbnVsbDtcbiAgICAgICAgdGhpcy5lcnJvckhhbmRsZXIgPSBudWxsO1xuICAgICAgICAvKipcbiAgICAgICAgICogQ2FsbGVkIHdpdGggdGhlIGN1cnJlbnQgbnVtYmVyIG9mIGJ5dGVzIHVwbG9hZGVkIGFuZCB0b3RhbCBzaXplICgtMSBpZiBub3RcbiAgICAgICAgICogY29tcHV0YWJsZSkgb2YgdGhlIHJlcXVlc3QgYm9keSAoaS5lLiB1c2VkIHRvIHJlcG9ydCB1cGxvYWQgcHJvZ3Jlc3MpLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5wcm9ncmVzc0NhbGxiYWNrID0gbnVsbDtcbiAgICAgICAgdGhpcy5zdWNjZXNzQ29kZXMgPSBbMjAwXTtcbiAgICAgICAgdGhpcy5hZGRpdGlvbmFsUmV0cnlDb2RlcyA9IFtdO1xuICAgIH1cbiAgICByZXR1cm4gUmVxdWVzdEluZm87XG59KCkpO1xuZXhwb3J0cy5SZXF1ZXN0SW5mbyA9IFJlcXVlc3RJbmZvO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1yZXF1ZXN0aW5mby5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbnZhciBvYmplY3QgPSByZXF1aXJlKFwiLi9vYmplY3RcIik7XG52YXIgY29uc3RhbnRzID0gcmVxdWlyZShcIi4vY29uc3RhbnRzXCIpO1xuLyoqXG4gKiBAc3RydWN0XG4gKi9cbnZhciBSZXF1ZXN0TWFwID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFJlcXVlc3RNYXAoKSB7XG4gICAgICAgIHRoaXMubWFwXyA9IHt9O1xuICAgICAgICB0aGlzLmlkXyA9IGNvbnN0YW50cy5taW5TYWZlSW50ZWdlcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVnaXN0ZXJzIHRoZSBnaXZlbiByZXF1ZXN0IHdpdGggdGhpcyBtYXAuXG4gICAgICogVGhlIHJlcXVlc3QgaXMgdW5yZWdpc3RlcmVkIHdoZW4gaXQgY29tcGxldGVzLlxuICAgICAqIEBwYXJhbSByIFRoZSByZXF1ZXN0IHRvIHJlZ2lzdGVyLlxuICAgICAqL1xuICAgIFJlcXVlc3RNYXAucHJvdG90eXBlLmFkZFJlcXVlc3QgPSBmdW5jdGlvbiAocikge1xuICAgICAgICB2YXIgaWQgPSB0aGlzLmlkXztcbiAgICAgICAgdGhpcy5pZF8rKztcbiAgICAgICAgdGhpcy5tYXBfW2lkXSA9IHI7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gdW5tYXAoKSB7XG4gICAgICAgICAgICBkZWxldGUgc2VsZi5tYXBfW2lkXTtcbiAgICAgICAgfVxuICAgICAgICByLmdldFByb21pc2UoKS50aGVuKHVubWFwLCB1bm1hcCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBDYW5jZWxzIGFsbCByZWdpc3RlcmVkIHJlcXVlc3RzLlxuICAgICAqL1xuICAgIFJlcXVlc3RNYXAucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBvYmplY3QuZm9yRWFjaCh0aGlzLm1hcF8sIGZ1bmN0aW9uIChrZXksIHZhbCkge1xuICAgICAgICAgICAgaWYgKHZhbCkge1xuICAgICAgICAgICAgICAgIHZhbC5jYW5jZWwodHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLm1hcF8gPSB7fTtcbiAgICB9O1xuICAgIHJldHVybiBSZXF1ZXN0TWFwO1xufSgpKTtcbmV4cG9ydHMuUmVxdWVzdE1hcCA9IFJlcXVlc3RNYXA7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXJlcXVlc3RtYXAuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgYXJyYXkgPSByZXF1aXJlKFwiLi9hcnJheVwiKTtcbnZhciBibG9iXzEgPSByZXF1aXJlKFwiLi9ibG9iXCIpO1xudmFyIGVycm9yc0V4cG9ydHMgPSByZXF1aXJlKFwiLi9lcnJvclwiKTtcbnZhciBNZXRhZGF0YVV0aWxzID0gcmVxdWlyZShcIi4vbWV0YWRhdGFcIik7XG52YXIgb2JqZWN0ID0gcmVxdWlyZShcIi4vb2JqZWN0XCIpO1xudmFyIHJlcXVlc3RpbmZvXzEgPSByZXF1aXJlKFwiLi9yZXF1ZXN0aW5mb1wiKTtcbnZhciB0eXBlID0gcmVxdWlyZShcIi4vdHlwZVwiKTtcbnZhciBVcmxVdGlscyA9IHJlcXVpcmUoXCIuL3VybFwiKTtcbi8qKlxuICogVGhyb3dzIHRoZSBVTktOT1dOIEZpcmViYXNlU3RvcmFnZUVycm9yIGlmIGNuZG4gaXMgZmFsc2UuXG4gKi9cbmZ1bmN0aW9uIGhhbmRsZXJDaGVjayhjbmRuKSB7XG4gICAgaWYgKCFjbmRuKSB7XG4gICAgICAgIHRocm93IGVycm9yc0V4cG9ydHMudW5rbm93bigpO1xuICAgIH1cbn1cbmV4cG9ydHMuaGFuZGxlckNoZWNrID0gaGFuZGxlckNoZWNrO1xuZnVuY3Rpb24gbWV0YWRhdGFIYW5kbGVyKGF1dGhXcmFwcGVyLCBtYXBwaW5ncykge1xuICAgIGZ1bmN0aW9uIGhhbmRsZXIoeGhyLCB0ZXh0KSB7XG4gICAgICAgIHZhciBtZXRhZGF0YSA9IE1ldGFkYXRhVXRpbHMuZnJvbVJlc291cmNlU3RyaW5nKGF1dGhXcmFwcGVyLCB0ZXh0LCBtYXBwaW5ncyk7XG4gICAgICAgIGhhbmRsZXJDaGVjayhtZXRhZGF0YSAhPT0gbnVsbCk7XG4gICAgICAgIHJldHVybiBtZXRhZGF0YTtcbiAgICB9XG4gICAgcmV0dXJuIGhhbmRsZXI7XG59XG5leHBvcnRzLm1ldGFkYXRhSGFuZGxlciA9IG1ldGFkYXRhSGFuZGxlcjtcbmZ1bmN0aW9uIHNoYXJlZEVycm9ySGFuZGxlcihsb2NhdGlvbikge1xuICAgIGZ1bmN0aW9uIGVycm9ySGFuZGxlcih4aHIsIGVycikge1xuICAgICAgICB2YXIgbmV3RXJyO1xuICAgICAgICBpZiAoeGhyLmdldFN0YXR1cygpID09PSA0MDEpIHtcbiAgICAgICAgICAgIG5ld0VyciA9IGVycm9yc0V4cG9ydHMudW5hdXRoZW50aWNhdGVkKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoeGhyLmdldFN0YXR1cygpID09PSA0MDIpIHtcbiAgICAgICAgICAgICAgICBuZXdFcnIgPSBlcnJvcnNFeHBvcnRzLnF1b3RhRXhjZWVkZWQobG9jYXRpb24uYnVja2V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICh4aHIuZ2V0U3RhdHVzKCkgPT09IDQwMykge1xuICAgICAgICAgICAgICAgICAgICBuZXdFcnIgPSBlcnJvcnNFeHBvcnRzLnVuYXV0aG9yaXplZChsb2NhdGlvbi5wYXRoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0VyciA9IGVycjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbmV3RXJyLnNldFNlcnZlclJlc3BvbnNlUHJvcChlcnIuc2VydmVyUmVzcG9uc2VQcm9wKCkpO1xuICAgICAgICByZXR1cm4gbmV3RXJyO1xuICAgIH1cbiAgICByZXR1cm4gZXJyb3JIYW5kbGVyO1xufVxuZXhwb3J0cy5zaGFyZWRFcnJvckhhbmRsZXIgPSBzaGFyZWRFcnJvckhhbmRsZXI7XG5mdW5jdGlvbiBvYmplY3RFcnJvckhhbmRsZXIobG9jYXRpb24pIHtcbiAgICB2YXIgc2hhcmVkID0gc2hhcmVkRXJyb3JIYW5kbGVyKGxvY2F0aW9uKTtcbiAgICBmdW5jdGlvbiBlcnJvckhhbmRsZXIoeGhyLCBlcnIpIHtcbiAgICAgICAgdmFyIG5ld0VyciA9IHNoYXJlZCh4aHIsIGVycik7XG4gICAgICAgIGlmICh4aHIuZ2V0U3RhdHVzKCkgPT09IDQwNCkge1xuICAgICAgICAgICAgbmV3RXJyID0gZXJyb3JzRXhwb3J0cy5vYmplY3ROb3RGb3VuZChsb2NhdGlvbi5wYXRoKTtcbiAgICAgICAgfVxuICAgICAgICBuZXdFcnIuc2V0U2VydmVyUmVzcG9uc2VQcm9wKGVyci5zZXJ2ZXJSZXNwb25zZVByb3AoKSk7XG4gICAgICAgIHJldHVybiBuZXdFcnI7XG4gICAgfVxuICAgIHJldHVybiBlcnJvckhhbmRsZXI7XG59XG5leHBvcnRzLm9iamVjdEVycm9ySGFuZGxlciA9IG9iamVjdEVycm9ySGFuZGxlcjtcbmZ1bmN0aW9uIGdldE1ldGFkYXRhKGF1dGhXcmFwcGVyLCBsb2NhdGlvbiwgbWFwcGluZ3MpIHtcbiAgICB2YXIgdXJsUGFydCA9IGxvY2F0aW9uLmZ1bGxTZXJ2ZXJVcmwoKTtcbiAgICB2YXIgdXJsID0gVXJsVXRpbHMubWFrZU5vcm1hbFVybCh1cmxQYXJ0KTtcbiAgICB2YXIgbWV0aG9kID0gJ0dFVCc7XG4gICAgdmFyIHRpbWVvdXQgPSBhdXRoV3JhcHBlci5tYXhPcGVyYXRpb25SZXRyeVRpbWUoKTtcbiAgICB2YXIgcmVxdWVzdEluZm8gPSBuZXcgcmVxdWVzdGluZm9fMS5SZXF1ZXN0SW5mbyh1cmwsIG1ldGhvZCwgbWV0YWRhdGFIYW5kbGVyKGF1dGhXcmFwcGVyLCBtYXBwaW5ncyksIHRpbWVvdXQpO1xuICAgIHJlcXVlc3RJbmZvLmVycm9ySGFuZGxlciA9IG9iamVjdEVycm9ySGFuZGxlcihsb2NhdGlvbik7XG4gICAgcmV0dXJuIHJlcXVlc3RJbmZvO1xufVxuZXhwb3J0cy5nZXRNZXRhZGF0YSA9IGdldE1ldGFkYXRhO1xuZnVuY3Rpb24gdXBkYXRlTWV0YWRhdGEoYXV0aFdyYXBwZXIsIGxvY2F0aW9uLCBtZXRhZGF0YSwgbWFwcGluZ3MpIHtcbiAgICB2YXIgdXJsUGFydCA9IGxvY2F0aW9uLmZ1bGxTZXJ2ZXJVcmwoKTtcbiAgICB2YXIgdXJsID0gVXJsVXRpbHMubWFrZU5vcm1hbFVybCh1cmxQYXJ0KTtcbiAgICB2YXIgbWV0aG9kID0gJ1BBVENIJztcbiAgICB2YXIgYm9keSA9IE1ldGFkYXRhVXRpbHMudG9SZXNvdXJjZVN0cmluZyhtZXRhZGF0YSwgbWFwcGluZ3MpO1xuICAgIHZhciBoZWFkZXJzID0geyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgnIH07XG4gICAgdmFyIHRpbWVvdXQgPSBhdXRoV3JhcHBlci5tYXhPcGVyYXRpb25SZXRyeVRpbWUoKTtcbiAgICB2YXIgcmVxdWVzdEluZm8gPSBuZXcgcmVxdWVzdGluZm9fMS5SZXF1ZXN0SW5mbyh1cmwsIG1ldGhvZCwgbWV0YWRhdGFIYW5kbGVyKGF1dGhXcmFwcGVyLCBtYXBwaW5ncyksIHRpbWVvdXQpO1xuICAgIHJlcXVlc3RJbmZvLmhlYWRlcnMgPSBoZWFkZXJzO1xuICAgIHJlcXVlc3RJbmZvLmJvZHkgPSBib2R5O1xuICAgIHJlcXVlc3RJbmZvLmVycm9ySGFuZGxlciA9IG9iamVjdEVycm9ySGFuZGxlcihsb2NhdGlvbik7XG4gICAgcmV0dXJuIHJlcXVlc3RJbmZvO1xufVxuZXhwb3J0cy51cGRhdGVNZXRhZGF0YSA9IHVwZGF0ZU1ldGFkYXRhO1xuZnVuY3Rpb24gZGVsZXRlT2JqZWN0KGF1dGhXcmFwcGVyLCBsb2NhdGlvbikge1xuICAgIHZhciB1cmxQYXJ0ID0gbG9jYXRpb24uZnVsbFNlcnZlclVybCgpO1xuICAgIHZhciB1cmwgPSBVcmxVdGlscy5tYWtlTm9ybWFsVXJsKHVybFBhcnQpO1xuICAgIHZhciBtZXRob2QgPSAnREVMRVRFJztcbiAgICB2YXIgdGltZW91dCA9IGF1dGhXcmFwcGVyLm1heE9wZXJhdGlvblJldHJ5VGltZSgpO1xuICAgIGZ1bmN0aW9uIGhhbmRsZXIoeGhyLCB0ZXh0KSB7IH1cbiAgICB2YXIgcmVxdWVzdEluZm8gPSBuZXcgcmVxdWVzdGluZm9fMS5SZXF1ZXN0SW5mbyh1cmwsIG1ldGhvZCwgaGFuZGxlciwgdGltZW91dCk7XG4gICAgcmVxdWVzdEluZm8uc3VjY2Vzc0NvZGVzID0gWzIwMCwgMjA0XTtcbiAgICByZXF1ZXN0SW5mby5lcnJvckhhbmRsZXIgPSBvYmplY3RFcnJvckhhbmRsZXIobG9jYXRpb24pO1xuICAgIHJldHVybiByZXF1ZXN0SW5mbztcbn1cbmV4cG9ydHMuZGVsZXRlT2JqZWN0ID0gZGVsZXRlT2JqZWN0O1xuZnVuY3Rpb24gZGV0ZXJtaW5lQ29udGVudFR5cGVfKG1ldGFkYXRhLCBibG9iKSB7XG4gICAgcmV0dXJuICgobWV0YWRhdGEgJiYgbWV0YWRhdGFbJ2NvbnRlbnRUeXBlJ10pIHx8XG4gICAgICAgIChibG9iICYmIGJsb2IudHlwZSgpKSB8fFxuICAgICAgICAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJyk7XG59XG5leHBvcnRzLmRldGVybWluZUNvbnRlbnRUeXBlXyA9IGRldGVybWluZUNvbnRlbnRUeXBlXztcbmZ1bmN0aW9uIG1ldGFkYXRhRm9yVXBsb2FkXyhsb2NhdGlvbiwgYmxvYiwgb3B0X21ldGFkYXRhKSB7XG4gICAgdmFyIG1ldGFkYXRhID0gb2JqZWN0LmNsb25lKG9wdF9tZXRhZGF0YSk7XG4gICAgbWV0YWRhdGFbJ2Z1bGxQYXRoJ10gPSBsb2NhdGlvbi5wYXRoO1xuICAgIG1ldGFkYXRhWydzaXplJ10gPSBibG9iLnNpemUoKTtcbiAgICBpZiAoIW1ldGFkYXRhWydjb250ZW50VHlwZSddKSB7XG4gICAgICAgIG1ldGFkYXRhWydjb250ZW50VHlwZSddID0gZGV0ZXJtaW5lQ29udGVudFR5cGVfKG51bGwsIGJsb2IpO1xuICAgIH1cbiAgICByZXR1cm4gbWV0YWRhdGE7XG59XG5leHBvcnRzLm1ldGFkYXRhRm9yVXBsb2FkXyA9IG1ldGFkYXRhRm9yVXBsb2FkXztcbmZ1bmN0aW9uIG11bHRpcGFydFVwbG9hZChhdXRoV3JhcHBlciwgbG9jYXRpb24sIG1hcHBpbmdzLCBibG9iLCBvcHRfbWV0YWRhdGEpIHtcbiAgICB2YXIgdXJsUGFydCA9IGxvY2F0aW9uLmJ1Y2tldE9ubHlTZXJ2ZXJVcmwoKTtcbiAgICB2YXIgaGVhZGVycyA9IHtcbiAgICAgICAgJ1gtR29vZy1VcGxvYWQtUHJvdG9jb2wnOiAnbXVsdGlwYXJ0J1xuICAgIH07XG4gICAgZnVuY3Rpb24gZ2VuQm91bmRhcnkoKSB7XG4gICAgICAgIHZhciBzdHIgPSAnJztcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAyOyBpKyspIHtcbiAgICAgICAgICAgIHN0ciA9XG4gICAgICAgICAgICAgICAgc3RyICtcbiAgICAgICAgICAgICAgICAgICAgTWF0aC5yYW5kb20oKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRvU3RyaW5nKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zbGljZSgyKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3RyO1xuICAgIH1cbiAgICB2YXIgYm91bmRhcnkgPSBnZW5Cb3VuZGFyeSgpO1xuICAgIGhlYWRlcnNbJ0NvbnRlbnQtVHlwZSddID0gJ211bHRpcGFydC9yZWxhdGVkOyBib3VuZGFyeT0nICsgYm91bmRhcnk7XG4gICAgdmFyIG1ldGFkYXRhID0gbWV0YWRhdGFGb3JVcGxvYWRfKGxvY2F0aW9uLCBibG9iLCBvcHRfbWV0YWRhdGEpO1xuICAgIHZhciBtZXRhZGF0YVN0cmluZyA9IE1ldGFkYXRhVXRpbHMudG9SZXNvdXJjZVN0cmluZyhtZXRhZGF0YSwgbWFwcGluZ3MpO1xuICAgIHZhciBwcmVCbG9iUGFydCA9ICctLScgK1xuICAgICAgICBib3VuZGFyeSArXG4gICAgICAgICdcXHJcXG4nICtcbiAgICAgICAgJ0NvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOFxcclxcblxcclxcbicgK1xuICAgICAgICBtZXRhZGF0YVN0cmluZyArXG4gICAgICAgICdcXHJcXG4tLScgK1xuICAgICAgICBib3VuZGFyeSArXG4gICAgICAgICdcXHJcXG4nICtcbiAgICAgICAgJ0NvbnRlbnQtVHlwZTogJyArXG4gICAgICAgIG1ldGFkYXRhWydjb250ZW50VHlwZSddICtcbiAgICAgICAgJ1xcclxcblxcclxcbic7XG4gICAgdmFyIHBvc3RCbG9iUGFydCA9ICdcXHJcXG4tLScgKyBib3VuZGFyeSArICctLSc7XG4gICAgdmFyIGJvZHkgPSBibG9iXzEuRmJzQmxvYi5nZXRCbG9iKHByZUJsb2JQYXJ0LCBibG9iLCBwb3N0QmxvYlBhcnQpO1xuICAgIGlmIChib2R5ID09PSBudWxsKSB7XG4gICAgICAgIHRocm93IGVycm9yc0V4cG9ydHMuY2Fubm90U2xpY2VCbG9iKCk7XG4gICAgfVxuICAgIHZhciB1cmxQYXJhbXMgPSB7IG5hbWU6IG1ldGFkYXRhWydmdWxsUGF0aCddIH07XG4gICAgdmFyIHVybCA9IFVybFV0aWxzLm1ha2VVcGxvYWRVcmwodXJsUGFydCk7XG4gICAgdmFyIG1ldGhvZCA9ICdQT1NUJztcbiAgICB2YXIgdGltZW91dCA9IGF1dGhXcmFwcGVyLm1heFVwbG9hZFJldHJ5VGltZSgpO1xuICAgIHZhciByZXF1ZXN0SW5mbyA9IG5ldyByZXF1ZXN0aW5mb18xLlJlcXVlc3RJbmZvKHVybCwgbWV0aG9kLCBtZXRhZGF0YUhhbmRsZXIoYXV0aFdyYXBwZXIsIG1hcHBpbmdzKSwgdGltZW91dCk7XG4gICAgcmVxdWVzdEluZm8udXJsUGFyYW1zID0gdXJsUGFyYW1zO1xuICAgIHJlcXVlc3RJbmZvLmhlYWRlcnMgPSBoZWFkZXJzO1xuICAgIHJlcXVlc3RJbmZvLmJvZHkgPSBib2R5LnVwbG9hZERhdGEoKTtcbiAgICByZXF1ZXN0SW5mby5lcnJvckhhbmRsZXIgPSBzaGFyZWRFcnJvckhhbmRsZXIobG9jYXRpb24pO1xuICAgIHJldHVybiByZXF1ZXN0SW5mbztcbn1cbmV4cG9ydHMubXVsdGlwYXJ0VXBsb2FkID0gbXVsdGlwYXJ0VXBsb2FkO1xuLyoqXG4gKiBAcGFyYW0gY3VycmVudCBUaGUgbnVtYmVyIG9mIGJ5dGVzIHRoYXQgaGF2ZSBiZWVuIHVwbG9hZGVkIHNvIGZhci5cbiAqIEBwYXJhbSB0b3RhbCBUaGUgdG90YWwgbnVtYmVyIG9mIGJ5dGVzIGluIHRoZSB1cGxvYWQuXG4gKiBAcGFyYW0gb3B0X2ZpbmFsaXplZCBUcnVlIGlmIHRoZSBzZXJ2ZXIgaGFzIGZpbmlzaGVkIHRoZSB1cGxvYWQuXG4gKiBAcGFyYW0gb3B0X21ldGFkYXRhIFRoZSB1cGxvYWQgbWV0YWRhdGEsIHNob3VsZFxuICogICAgIG9ubHkgYmUgcGFzc2VkIGlmIG9wdF9maW5hbGl6ZWQgaXMgdHJ1ZS5cbiAqIEBzdHJ1Y3RcbiAqL1xudmFyIFJlc3VtYWJsZVVwbG9hZFN0YXR1cyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBSZXN1bWFibGVVcGxvYWRTdGF0dXMoY3VycmVudCwgdG90YWwsIGZpbmFsaXplZCwgbWV0YWRhdGEpIHtcbiAgICAgICAgdGhpcy5jdXJyZW50ID0gY3VycmVudDtcbiAgICAgICAgdGhpcy50b3RhbCA9IHRvdGFsO1xuICAgICAgICB0aGlzLmZpbmFsaXplZCA9ICEhZmluYWxpemVkO1xuICAgICAgICB0aGlzLm1ldGFkYXRhID0gbWV0YWRhdGEgfHwgbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIFJlc3VtYWJsZVVwbG9hZFN0YXR1cztcbn0oKSk7XG5leHBvcnRzLlJlc3VtYWJsZVVwbG9hZFN0YXR1cyA9IFJlc3VtYWJsZVVwbG9hZFN0YXR1cztcbmZ1bmN0aW9uIGNoZWNrUmVzdW1lSGVhZGVyXyh4aHIsIG9wdF9hbGxvd2VkKSB7XG4gICAgdmFyIHN0YXR1cztcbiAgICB0cnkge1xuICAgICAgICBzdGF0dXMgPSB4aHIuZ2V0UmVzcG9uc2VIZWFkZXIoJ1gtR29vZy1VcGxvYWQtU3RhdHVzJyk7XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIGhhbmRsZXJDaGVjayhmYWxzZSk7XG4gICAgfVxuICAgIHZhciBhbGxvd2VkID0gb3B0X2FsbG93ZWQgfHwgWydhY3RpdmUnXTtcbiAgICBoYW5kbGVyQ2hlY2soYXJyYXkuY29udGFpbnMoYWxsb3dlZCwgc3RhdHVzKSk7XG4gICAgcmV0dXJuIHN0YXR1cztcbn1cbmV4cG9ydHMuY2hlY2tSZXN1bWVIZWFkZXJfID0gY2hlY2tSZXN1bWVIZWFkZXJfO1xuZnVuY3Rpb24gY3JlYXRlUmVzdW1hYmxlVXBsb2FkKGF1dGhXcmFwcGVyLCBsb2NhdGlvbiwgbWFwcGluZ3MsIGJsb2IsIG9wdF9tZXRhZGF0YSkge1xuICAgIHZhciB1cmxQYXJ0ID0gbG9jYXRpb24uYnVja2V0T25seVNlcnZlclVybCgpO1xuICAgIHZhciBtZXRhZGF0YSA9IG1ldGFkYXRhRm9yVXBsb2FkXyhsb2NhdGlvbiwgYmxvYiwgb3B0X21ldGFkYXRhKTtcbiAgICB2YXIgdXJsUGFyYW1zID0geyBuYW1lOiBtZXRhZGF0YVsnZnVsbFBhdGgnXSB9O1xuICAgIHZhciB1cmwgPSBVcmxVdGlscy5tYWtlVXBsb2FkVXJsKHVybFBhcnQpO1xuICAgIHZhciBtZXRob2QgPSAnUE9TVCc7XG4gICAgdmFyIGhlYWRlcnMgPSB7XG4gICAgICAgICdYLUdvb2ctVXBsb2FkLVByb3RvY29sJzogJ3Jlc3VtYWJsZScsXG4gICAgICAgICdYLUdvb2ctVXBsb2FkLUNvbW1hbmQnOiAnc3RhcnQnLFxuICAgICAgICAnWC1Hb29nLVVwbG9hZC1IZWFkZXItQ29udGVudC1MZW5ndGgnOiBibG9iLnNpemUoKSxcbiAgICAgICAgJ1gtR29vZy1VcGxvYWQtSGVhZGVyLUNvbnRlbnQtVHlwZSc6IG1ldGFkYXRhWydjb250ZW50VHlwZSddLFxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgnXG4gICAgfTtcbiAgICB2YXIgYm9keSA9IE1ldGFkYXRhVXRpbHMudG9SZXNvdXJjZVN0cmluZyhtZXRhZGF0YSwgbWFwcGluZ3MpO1xuICAgIHZhciB0aW1lb3V0ID0gYXV0aFdyYXBwZXIubWF4VXBsb2FkUmV0cnlUaW1lKCk7XG4gICAgZnVuY3Rpb24gaGFuZGxlcih4aHIsIHRleHQpIHtcbiAgICAgICAgY2hlY2tSZXN1bWVIZWFkZXJfKHhocik7XG4gICAgICAgIHZhciB1cmw7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB1cmwgPSB4aHIuZ2V0UmVzcG9uc2VIZWFkZXIoJ1gtR29vZy1VcGxvYWQtVVJMJyk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGhhbmRsZXJDaGVjayhmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgaGFuZGxlckNoZWNrKHR5cGUuaXNTdHJpbmcodXJsKSk7XG4gICAgICAgIHJldHVybiB1cmw7XG4gICAgfVxuICAgIHZhciByZXF1ZXN0SW5mbyA9IG5ldyByZXF1ZXN0aW5mb18xLlJlcXVlc3RJbmZvKHVybCwgbWV0aG9kLCBoYW5kbGVyLCB0aW1lb3V0KTtcbiAgICByZXF1ZXN0SW5mby51cmxQYXJhbXMgPSB1cmxQYXJhbXM7XG4gICAgcmVxdWVzdEluZm8uaGVhZGVycyA9IGhlYWRlcnM7XG4gICAgcmVxdWVzdEluZm8uYm9keSA9IGJvZHk7XG4gICAgcmVxdWVzdEluZm8uZXJyb3JIYW5kbGVyID0gc2hhcmVkRXJyb3JIYW5kbGVyKGxvY2F0aW9uKTtcbiAgICByZXR1cm4gcmVxdWVzdEluZm87XG59XG5leHBvcnRzLmNyZWF0ZVJlc3VtYWJsZVVwbG9hZCA9IGNyZWF0ZVJlc3VtYWJsZVVwbG9hZDtcbi8qKlxuICogQHBhcmFtIHVybCBGcm9tIGEgY2FsbCB0byBmYnMucmVxdWVzdHMuY3JlYXRlUmVzdW1hYmxlVXBsb2FkLlxuICovXG5mdW5jdGlvbiBnZXRSZXN1bWFibGVVcGxvYWRTdGF0dXMoYXV0aFdyYXBwZXIsIGxvY2F0aW9uLCB1cmwsIGJsb2IpIHtcbiAgICB2YXIgaGVhZGVycyA9IHsgJ1gtR29vZy1VcGxvYWQtQ29tbWFuZCc6ICdxdWVyeScgfTtcbiAgICBmdW5jdGlvbiBoYW5kbGVyKHhociwgdGV4dCkge1xuICAgICAgICB2YXIgc3RhdHVzID0gY2hlY2tSZXN1bWVIZWFkZXJfKHhociwgWydhY3RpdmUnLCAnZmluYWwnXSk7XG4gICAgICAgIHZhciBzaXplU3RyaW5nO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgc2l6ZVN0cmluZyA9IHhoci5nZXRSZXNwb25zZUhlYWRlcignWC1Hb29nLVVwbG9hZC1TaXplLVJlY2VpdmVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGhhbmRsZXJDaGVjayhmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNpemUgPSBwYXJzZUludChzaXplU3RyaW5nLCAxMCk7XG4gICAgICAgIGhhbmRsZXJDaGVjayghaXNOYU4oc2l6ZSkpO1xuICAgICAgICByZXR1cm4gbmV3IFJlc3VtYWJsZVVwbG9hZFN0YXR1cyhzaXplLCBibG9iLnNpemUoKSwgc3RhdHVzID09PSAnZmluYWwnKTtcbiAgICB9XG4gICAgdmFyIG1ldGhvZCA9ICdQT1NUJztcbiAgICB2YXIgdGltZW91dCA9IGF1dGhXcmFwcGVyLm1heFVwbG9hZFJldHJ5VGltZSgpO1xuICAgIHZhciByZXF1ZXN0SW5mbyA9IG5ldyByZXF1ZXN0aW5mb18xLlJlcXVlc3RJbmZvKHVybCwgbWV0aG9kLCBoYW5kbGVyLCB0aW1lb3V0KTtcbiAgICByZXF1ZXN0SW5mby5oZWFkZXJzID0gaGVhZGVycztcbiAgICByZXF1ZXN0SW5mby5lcnJvckhhbmRsZXIgPSBzaGFyZWRFcnJvckhhbmRsZXIobG9jYXRpb24pO1xuICAgIHJldHVybiByZXF1ZXN0SW5mbztcbn1cbmV4cG9ydHMuZ2V0UmVzdW1hYmxlVXBsb2FkU3RhdHVzID0gZ2V0UmVzdW1hYmxlVXBsb2FkU3RhdHVzO1xuLyoqXG4gKiBBbnkgdXBsb2FkcyB2aWEgdGhlIHJlc3VtYWJsZSB1cGxvYWQgQVBJIG11c3QgdHJhbnNmZXIgYSBudW1iZXIgb2YgYnl0ZXNcbiAqIHRoYXQgaXMgYSBtdWx0aXBsZSBvZiB0aGlzIG51bWJlci5cbiAqL1xuZXhwb3J0cy5yZXN1bWFibGVVcGxvYWRDaHVua1NpemUgPSAyNTYgKiAxMDI0O1xuLyoqXG4gKiBAcGFyYW0gdXJsIEZyb20gYSBjYWxsIHRvIGZicy5yZXF1ZXN0cy5jcmVhdGVSZXN1bWFibGVVcGxvYWQuXG4gKiBAcGFyYW0gY2h1bmtTaXplIE51bWJlciBvZiBieXRlcyB0byB1cGxvYWQuXG4gKiBAcGFyYW0gb3B0X3N0YXR1cyBUaGUgcHJldmlvdXMgc3RhdHVzLlxuICogICAgIElmIG5vdCBwYXNzZWQgb3IgbnVsbCwgd2Ugc3RhcnQgZnJvbSB0aGUgYmVnaW5uaW5nLlxuICogQHRocm93cyBmYnMuRXJyb3IgSWYgdGhlIHVwbG9hZCBpcyBhbHJlYWR5IGNvbXBsZXRlLCB0aGUgcGFzc2VkIGluIHN0YXR1c1xuICogICAgIGhhcyBhIGZpbmFsIHNpemUgaW5jb25zaXN0ZW50IHdpdGggdGhlIGJsb2IsIG9yIHRoZSBibG9iIGNhbm5vdCBiZSBzbGljZWRcbiAqICAgICBmb3IgdXBsb2FkLlxuICovXG5mdW5jdGlvbiBjb250aW51ZVJlc3VtYWJsZVVwbG9hZChsb2NhdGlvbiwgYXV0aFdyYXBwZXIsIHVybCwgYmxvYiwgY2h1bmtTaXplLCBtYXBwaW5ncywgb3B0X3N0YXR1cywgb3B0X3Byb2dyZXNzQ2FsbGJhY2spIHtcbiAgICAvLyBUT0RPKGFuZHlzb3RvKTogc3RhbmRhcmRpemUgb24gaW50ZXJuYWwgYXNzZXJ0c1xuICAgIC8vIGFzc2VydCghKG9wdF9zdGF0dXMgJiYgb3B0X3N0YXR1cy5maW5hbGl6ZWQpKTtcbiAgICB2YXIgc3RhdHVzID0gbmV3IFJlc3VtYWJsZVVwbG9hZFN0YXR1cygwLCAwKTtcbiAgICBpZiAob3B0X3N0YXR1cykge1xuICAgICAgICBzdGF0dXMuY3VycmVudCA9IG9wdF9zdGF0dXMuY3VycmVudDtcbiAgICAgICAgc3RhdHVzLnRvdGFsID0gb3B0X3N0YXR1cy50b3RhbDtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHN0YXR1cy5jdXJyZW50ID0gMDtcbiAgICAgICAgc3RhdHVzLnRvdGFsID0gYmxvYi5zaXplKCk7XG4gICAgfVxuICAgIGlmIChibG9iLnNpemUoKSAhPT0gc3RhdHVzLnRvdGFsKSB7XG4gICAgICAgIHRocm93IGVycm9yc0V4cG9ydHMuc2VydmVyRmlsZVdyb25nU2l6ZSgpO1xuICAgIH1cbiAgICB2YXIgYnl0ZXNMZWZ0ID0gc3RhdHVzLnRvdGFsIC0gc3RhdHVzLmN1cnJlbnQ7XG4gICAgdmFyIGJ5dGVzVG9VcGxvYWQgPSBieXRlc0xlZnQ7XG4gICAgaWYgKGNodW5rU2l6ZSA+IDApIHtcbiAgICAgICAgYnl0ZXNUb1VwbG9hZCA9IE1hdGgubWluKGJ5dGVzVG9VcGxvYWQsIGNodW5rU2l6ZSk7XG4gICAgfVxuICAgIHZhciBzdGFydEJ5dGUgPSBzdGF0dXMuY3VycmVudDtcbiAgICB2YXIgZW5kQnl0ZSA9IHN0YXJ0Qnl0ZSArIGJ5dGVzVG9VcGxvYWQ7XG4gICAgdmFyIHVwbG9hZENvbW1hbmQgPSBieXRlc1RvVXBsb2FkID09PSBieXRlc0xlZnQgPyAndXBsb2FkLCBmaW5hbGl6ZScgOiAndXBsb2FkJztcbiAgICB2YXIgaGVhZGVycyA9IHtcbiAgICAgICAgJ1gtR29vZy1VcGxvYWQtQ29tbWFuZCc6IHVwbG9hZENvbW1hbmQsXG4gICAgICAgICdYLUdvb2ctVXBsb2FkLU9mZnNldCc6IHN0YXR1cy5jdXJyZW50XG4gICAgfTtcbiAgICB2YXIgYm9keSA9IGJsb2Iuc2xpY2Uoc3RhcnRCeXRlLCBlbmRCeXRlKTtcbiAgICBpZiAoYm9keSA9PT0gbnVsbCkge1xuICAgICAgICB0aHJvdyBlcnJvcnNFeHBvcnRzLmNhbm5vdFNsaWNlQmxvYigpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBoYW5kbGVyKHhociwgdGV4dCkge1xuICAgICAgICAvLyBUT0RPKGFuZHlzb3RvKTogVmVyaWZ5IHRoZSBNRDUgb2YgZWFjaCB1cGxvYWRlZCByYW5nZTpcbiAgICAgICAgLy8gdGhlICd4LXJhbmdlLW1kNScgaGVhZGVyIGNvbWVzIGJhY2sgd2l0aCBzdGF0dXMgY29kZSAzMDggcmVzcG9uc2VzLlxuICAgICAgICAvLyBXZSdsbCBvbmx5IGJlIGFibGUgdG8gYmFpbCBvdXQgdGhvdWdoLCBiZWNhdXNlIHlvdSBjYW4ndCByZS11cGxvYWQgYVxuICAgICAgICAvLyByYW5nZSB0aGF0IHlvdSBwcmV2aW91c2x5IHVwbG9hZGVkLlxuICAgICAgICB2YXIgdXBsb2FkU3RhdHVzID0gY2hlY2tSZXN1bWVIZWFkZXJfKHhociwgWydhY3RpdmUnLCAnZmluYWwnXSk7XG4gICAgICAgIHZhciBuZXdDdXJyZW50ID0gc3RhdHVzLmN1cnJlbnQgKyBieXRlc1RvVXBsb2FkO1xuICAgICAgICB2YXIgc2l6ZSA9IGJsb2Iuc2l6ZSgpO1xuICAgICAgICB2YXIgbWV0YWRhdGE7XG4gICAgICAgIGlmICh1cGxvYWRTdGF0dXMgPT09ICdmaW5hbCcpIHtcbiAgICAgICAgICAgIG1ldGFkYXRhID0gbWV0YWRhdGFIYW5kbGVyKGF1dGhXcmFwcGVyLCBtYXBwaW5ncykoeGhyLCB0ZXh0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG1ldGFkYXRhID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IFJlc3VtYWJsZVVwbG9hZFN0YXR1cyhuZXdDdXJyZW50LCBzaXplLCB1cGxvYWRTdGF0dXMgPT09ICdmaW5hbCcsIG1ldGFkYXRhKTtcbiAgICB9XG4gICAgdmFyIG1ldGhvZCA9ICdQT1NUJztcbiAgICB2YXIgdGltZW91dCA9IGF1dGhXcmFwcGVyLm1heFVwbG9hZFJldHJ5VGltZSgpO1xuICAgIHZhciByZXF1ZXN0SW5mbyA9IG5ldyByZXF1ZXN0aW5mb18xLlJlcXVlc3RJbmZvKHVybCwgbWV0aG9kLCBoYW5kbGVyLCB0aW1lb3V0KTtcbiAgICByZXF1ZXN0SW5mby5oZWFkZXJzID0gaGVhZGVycztcbiAgICByZXF1ZXN0SW5mby5ib2R5ID0gYm9keS51cGxvYWREYXRhKCk7XG4gICAgcmVxdWVzdEluZm8ucHJvZ3Jlc3NDYWxsYmFjayA9IG9wdF9wcm9ncmVzc0NhbGxiYWNrIHx8IG51bGw7XG4gICAgcmVxdWVzdEluZm8uZXJyb3JIYW5kbGVyID0gc2hhcmVkRXJyb3JIYW5kbGVyKGxvY2F0aW9uKTtcbiAgICByZXR1cm4gcmVxdWVzdEluZm87XG59XG5leHBvcnRzLmNvbnRpbnVlUmVzdW1hYmxlVXBsb2FkID0gY29udGludWVSZXN1bWFibGVVcGxvYWQ7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXJlcXVlc3RzLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xudmFyIGVycm9yc0V4cG9ydHMgPSByZXF1aXJlKFwiLi9lcnJvclwiKTtcbmV4cG9ydHMuU3RyaW5nRm9ybWF0ID0ge1xuICAgIFJBVzogJ3JhdycsXG4gICAgQkFTRTY0OiAnYmFzZTY0JyxcbiAgICBCQVNFNjRVUkw6ICdiYXNlNjR1cmwnLFxuICAgIERBVEFfVVJMOiAnZGF0YV91cmwnXG59O1xuZnVuY3Rpb24gZm9ybWF0VmFsaWRhdG9yKHN0cmluZ0Zvcm1hdCkge1xuICAgIHN3aXRjaCAoc3RyaW5nRm9ybWF0KSB7XG4gICAgICAgIGNhc2UgZXhwb3J0cy5TdHJpbmdGb3JtYXQuUkFXOlxuICAgICAgICBjYXNlIGV4cG9ydHMuU3RyaW5nRm9ybWF0LkJBU0U2NDpcbiAgICAgICAgY2FzZSBleHBvcnRzLlN0cmluZ0Zvcm1hdC5CQVNFNjRVUkw6XG4gICAgICAgIGNhc2UgZXhwb3J0cy5TdHJpbmdGb3JtYXQuREFUQV9VUkw6XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICB0aHJvdyAnRXhwZWN0ZWQgb25lIG9mIHRoZSBldmVudCB0eXBlczogWycgK1xuICAgICAgICAgICAgICAgIGV4cG9ydHMuU3RyaW5nRm9ybWF0LlJBVyArXG4gICAgICAgICAgICAgICAgJywgJyArXG4gICAgICAgICAgICAgICAgZXhwb3J0cy5TdHJpbmdGb3JtYXQuQkFTRTY0ICtcbiAgICAgICAgICAgICAgICAnLCAnICtcbiAgICAgICAgICAgICAgICBleHBvcnRzLlN0cmluZ0Zvcm1hdC5CQVNFNjRVUkwgK1xuICAgICAgICAgICAgICAgICcsICcgK1xuICAgICAgICAgICAgICAgIGV4cG9ydHMuU3RyaW5nRm9ybWF0LkRBVEFfVVJMICtcbiAgICAgICAgICAgICAgICAnXS4nO1xuICAgIH1cbn1cbmV4cG9ydHMuZm9ybWF0VmFsaWRhdG9yID0gZm9ybWF0VmFsaWRhdG9yO1xuLyoqXG4gKiBAc3RydWN0XG4gKi9cbnZhciBTdHJpbmdEYXRhID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFN0cmluZ0RhdGEoZGF0YSwgb3B0X2NvbnRlbnRUeXBlKSB7XG4gICAgICAgIHRoaXMuZGF0YSA9IGRhdGE7XG4gICAgICAgIHRoaXMuY29udGVudFR5cGUgPSBvcHRfY29udGVudFR5cGUgfHwgbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIFN0cmluZ0RhdGE7XG59KCkpO1xuZXhwb3J0cy5TdHJpbmdEYXRhID0gU3RyaW5nRGF0YTtcbmZ1bmN0aW9uIGRhdGFGcm9tU3RyaW5nKGZvcm1hdCwgc3RyaW5nKSB7XG4gICAgc3dpdGNoIChmb3JtYXQpIHtcbiAgICAgICAgY2FzZSBleHBvcnRzLlN0cmluZ0Zvcm1hdC5SQVc6XG4gICAgICAgICAgICByZXR1cm4gbmV3IFN0cmluZ0RhdGEodXRmOEJ5dGVzXyhzdHJpbmcpKTtcbiAgICAgICAgY2FzZSBleHBvcnRzLlN0cmluZ0Zvcm1hdC5CQVNFNjQ6XG4gICAgICAgIGNhc2UgZXhwb3J0cy5TdHJpbmdGb3JtYXQuQkFTRTY0VVJMOlxuICAgICAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmdEYXRhKGJhc2U2NEJ5dGVzXyhmb3JtYXQsIHN0cmluZykpO1xuICAgICAgICBjYXNlIGV4cG9ydHMuU3RyaW5nRm9ybWF0LkRBVEFfVVJMOlxuICAgICAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmdEYXRhKGRhdGFVUkxCeXRlc18oc3RyaW5nKSwgZGF0YVVSTENvbnRlbnRUeXBlXyhzdHJpbmcpKTtcbiAgICB9XG4gICAgLy8gYXNzZXJ0KGZhbHNlKTtcbiAgICB0aHJvdyBlcnJvcnNFeHBvcnRzLnVua25vd24oKTtcbn1cbmV4cG9ydHMuZGF0YUZyb21TdHJpbmcgPSBkYXRhRnJvbVN0cmluZztcbmZ1bmN0aW9uIHV0ZjhCeXRlc18oc3RyaW5nKSB7XG4gICAgdmFyIGIgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN0cmluZy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgYyA9IHN0cmluZy5jaGFyQ29kZUF0KGkpO1xuICAgICAgICBpZiAoYyA8PSAxMjcpIHtcbiAgICAgICAgICAgIGIucHVzaChjKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChjIDw9IDIwNDcpIHtcbiAgICAgICAgICAgICAgICBiLnB1c2goMTkyIHwgKGMgPj4gNiksIDEyOCB8IChjICYgNjMpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICgoYyAmIDY0NTEyKSA9PSA1NTI5Nikge1xuICAgICAgICAgICAgICAgICAgICAvLyBUaGUgc3RhcnQgb2YgYSBzdXJyb2dhdGUgcGFpci5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHZhbGlkID0gaSA8IHN0cmluZy5sZW5ndGggLSAxICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAoc3RyaW5nLmNoYXJDb2RlQXQoaSArIDEpICYgNjQ1MTIpID09IDU2MzIwO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXZhbGlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgc2Vjb25kIHN1cnJvZ2F0ZSB3YXNuJ3QgdGhlcmUuXG4gICAgICAgICAgICAgICAgICAgICAgICBiLnB1c2goMjM5LCAxOTEsIDE4OSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGkgPSBjO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxvID0gc3RyaW5nLmNoYXJDb2RlQXQoKytpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSA2NTUzNiB8ICgoaGkgJiAxMDIzKSA8PCAxMCkgfCAobG8gJiAxMDIzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGIucHVzaCgyNDAgfCAoYyA+PiAxOCksIDEyOCB8ICgoYyA+PiAxMikgJiA2MyksIDEyOCB8ICgoYyA+PiA2KSAmIDYzKSwgMTI4IHwgKGMgJiA2MykpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoKGMgJiA2NDUxMikgPT0gNTYzMjApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEludmFsaWQgbG93IHN1cnJvZ2F0ZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIGIucHVzaCgyMzksIDE5MSwgMTg5KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGIucHVzaCgyMjQgfCAoYyA+PiAxMiksIDEyOCB8ICgoYyA+PiA2KSAmIDYzKSwgMTI4IHwgKGMgJiA2MykpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBuZXcgVWludDhBcnJheShiKTtcbn1cbmV4cG9ydHMudXRmOEJ5dGVzXyA9IHV0ZjhCeXRlc187XG5mdW5jdGlvbiBwZXJjZW50RW5jb2RlZEJ5dGVzXyhzdHJpbmcpIHtcbiAgICB2YXIgZGVjb2RlZDtcbiAgICB0cnkge1xuICAgICAgICBkZWNvZGVkID0gZGVjb2RlVVJJQ29tcG9uZW50KHN0cmluZyk7XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIHRocm93IGVycm9yc0V4cG9ydHMuaW52YWxpZEZvcm1hdChleHBvcnRzLlN0cmluZ0Zvcm1hdC5EQVRBX1VSTCwgJ01hbGZvcm1lZCBkYXRhIFVSTC4nKTtcbiAgICB9XG4gICAgcmV0dXJuIHV0ZjhCeXRlc18oZGVjb2RlZCk7XG59XG5leHBvcnRzLnBlcmNlbnRFbmNvZGVkQnl0ZXNfID0gcGVyY2VudEVuY29kZWRCeXRlc187XG5mdW5jdGlvbiBiYXNlNjRCeXRlc18oZm9ybWF0LCBzdHJpbmcpIHtcbiAgICBzd2l0Y2ggKGZvcm1hdCkge1xuICAgICAgICBjYXNlIGV4cG9ydHMuU3RyaW5nRm9ybWF0LkJBU0U2NDoge1xuICAgICAgICAgICAgdmFyIGhhc01pbnVzID0gc3RyaW5nLmluZGV4T2YoJy0nKSAhPT0gLTE7XG4gICAgICAgICAgICB2YXIgaGFzVW5kZXIgPSBzdHJpbmcuaW5kZXhPZignXycpICE9PSAtMTtcbiAgICAgICAgICAgIGlmIChoYXNNaW51cyB8fCBoYXNVbmRlcikge1xuICAgICAgICAgICAgICAgIHZhciBpbnZhbGlkQ2hhciA9IGhhc01pbnVzID8gJy0nIDogJ18nO1xuICAgICAgICAgICAgICAgIHRocm93IGVycm9yc0V4cG9ydHMuaW52YWxpZEZvcm1hdChmb3JtYXQsIFwiSW52YWxpZCBjaGFyYWN0ZXIgJ1wiICtcbiAgICAgICAgICAgICAgICAgICAgaW52YWxpZENoYXIgK1xuICAgICAgICAgICAgICAgICAgICBcIicgZm91bmQ6IGlzIGl0IGJhc2U2NHVybCBlbmNvZGVkP1wiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgZXhwb3J0cy5TdHJpbmdGb3JtYXQuQkFTRTY0VVJMOiB7XG4gICAgICAgICAgICB2YXIgaGFzUGx1cyA9IHN0cmluZy5pbmRleE9mKCcrJykgIT09IC0xO1xuICAgICAgICAgICAgdmFyIGhhc1NsYXNoID0gc3RyaW5nLmluZGV4T2YoJy8nKSAhPT0gLTE7XG4gICAgICAgICAgICBpZiAoaGFzUGx1cyB8fCBoYXNTbGFzaCkge1xuICAgICAgICAgICAgICAgIHZhciBpbnZhbGlkQ2hhciA9IGhhc1BsdXMgPyAnKycgOiAnLyc7XG4gICAgICAgICAgICAgICAgdGhyb3cgZXJyb3JzRXhwb3J0cy5pbnZhbGlkRm9ybWF0KGZvcm1hdCwgXCJJbnZhbGlkIGNoYXJhY3RlciAnXCIgKyBpbnZhbGlkQ2hhciArIFwiJyBmb3VuZDogaXMgaXQgYmFzZTY0IGVuY29kZWQ/XCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3RyaW5nID0gc3RyaW5nLnJlcGxhY2UoLy0vZywgJysnKS5yZXBsYWNlKC9fL2csICcvJyk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgYnl0ZXM7XG4gICAgdHJ5IHtcbiAgICAgICAgYnl0ZXMgPSBhdG9iKHN0cmluZyk7XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIHRocm93IGVycm9yc0V4cG9ydHMuaW52YWxpZEZvcm1hdChmb3JtYXQsICdJbnZhbGlkIGNoYXJhY3RlciBmb3VuZCcpO1xuICAgIH1cbiAgICB2YXIgYXJyYXkgPSBuZXcgVWludDhBcnJheShieXRlcy5sZW5ndGgpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYnl0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgYXJyYXlbaV0gPSBieXRlcy5jaGFyQ29kZUF0KGkpO1xuICAgIH1cbiAgICByZXR1cm4gYXJyYXk7XG59XG5leHBvcnRzLmJhc2U2NEJ5dGVzXyA9IGJhc2U2NEJ5dGVzXztcbi8qKlxuICogQHN0cnVjdFxuICovXG52YXIgRGF0YVVSTFBhcnRzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIERhdGFVUkxQYXJ0cyhkYXRhVVJMKSB7XG4gICAgICAgIHRoaXMuYmFzZTY0ID0gZmFsc2U7XG4gICAgICAgIHRoaXMuY29udGVudFR5cGUgPSBudWxsO1xuICAgICAgICB2YXIgbWF0Y2hlcyA9IGRhdGFVUkwubWF0Y2goL15kYXRhOihbXixdKyk/LC8pO1xuICAgICAgICBpZiAobWF0Y2hlcyA9PT0gbnVsbCkge1xuICAgICAgICAgICAgdGhyb3cgZXJyb3JzRXhwb3J0cy5pbnZhbGlkRm9ybWF0KGV4cG9ydHMuU3RyaW5nRm9ybWF0LkRBVEFfVVJMLCBcIk11c3QgYmUgZm9ybWF0dGVkICdkYXRhOls8bWVkaWF0eXBlPl1bO2Jhc2U2NF0sPGRhdGE+XCIpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBtaWRkbGUgPSBtYXRjaGVzWzFdIHx8IG51bGw7XG4gICAgICAgIGlmIChtaWRkbGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5iYXNlNjQgPSBlbmRzV2l0aChtaWRkbGUsICc7YmFzZTY0Jyk7XG4gICAgICAgICAgICB0aGlzLmNvbnRlbnRUeXBlID0gdGhpcy5iYXNlNjRcbiAgICAgICAgICAgICAgICA/IG1pZGRsZS5zdWJzdHJpbmcoMCwgbWlkZGxlLmxlbmd0aCAtICc7YmFzZTY0Jy5sZW5ndGgpXG4gICAgICAgICAgICAgICAgOiBtaWRkbGU7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZXN0ID0gZGF0YVVSTC5zdWJzdHJpbmcoZGF0YVVSTC5pbmRleE9mKCcsJykgKyAxKTtcbiAgICB9XG4gICAgcmV0dXJuIERhdGFVUkxQYXJ0cztcbn0oKSk7XG5mdW5jdGlvbiBkYXRhVVJMQnl0ZXNfKHN0cmluZykge1xuICAgIHZhciBwYXJ0cyA9IG5ldyBEYXRhVVJMUGFydHMoc3RyaW5nKTtcbiAgICBpZiAocGFydHMuYmFzZTY0KSB7XG4gICAgICAgIHJldHVybiBiYXNlNjRCeXRlc18oZXhwb3J0cy5TdHJpbmdGb3JtYXQuQkFTRTY0LCBwYXJ0cy5yZXN0KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBwZXJjZW50RW5jb2RlZEJ5dGVzXyhwYXJ0cy5yZXN0KTtcbiAgICB9XG59XG5leHBvcnRzLmRhdGFVUkxCeXRlc18gPSBkYXRhVVJMQnl0ZXNfO1xuZnVuY3Rpb24gZGF0YVVSTENvbnRlbnRUeXBlXyhzdHJpbmcpIHtcbiAgICB2YXIgcGFydHMgPSBuZXcgRGF0YVVSTFBhcnRzKHN0cmluZyk7XG4gICAgcmV0dXJuIHBhcnRzLmNvbnRlbnRUeXBlO1xufVxuZXhwb3J0cy5kYXRhVVJMQ29udGVudFR5cGVfID0gZGF0YVVSTENvbnRlbnRUeXBlXztcbmZ1bmN0aW9uIGVuZHNXaXRoKHMsIGVuZCkge1xuICAgIHZhciBsb25nRW5vdWdoID0gcy5sZW5ndGggPj0gZW5kLmxlbmd0aDtcbiAgICBpZiAoIWxvbmdFbm91Z2gpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gcy5zdWJzdHJpbmcocy5sZW5ndGggLSBlbmQubGVuZ3RoKSA9PT0gZW5kO1xufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1zdHJpbmcuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLlRhc2tFdmVudCA9IHtcbiAgICAvKiogVHJpZ2dlcmVkIHdoZW5ldmVyIHRoZSB0YXNrIGNoYW5nZXMgb3IgcHJvZ3Jlc3MgaXMgdXBkYXRlZC4gKi9cbiAgICBTVEFURV9DSEFOR0VEOiAnc3RhdGVfY2hhbmdlZCdcbn07XG5leHBvcnRzLkludGVybmFsVGFza1N0YXRlID0ge1xuICAgIFJVTk5JTkc6ICdydW5uaW5nJyxcbiAgICBQQVVTSU5HOiAncGF1c2luZycsXG4gICAgUEFVU0VEOiAncGF1c2VkJyxcbiAgICBTVUNDRVNTOiAnc3VjY2VzcycsXG4gICAgQ0FOQ0VMSU5HOiAnY2FuY2VsaW5nJyxcbiAgICBDQU5DRUxFRDogJ2NhbmNlbGVkJyxcbiAgICBFUlJPUjogJ2Vycm9yJ1xufTtcbmV4cG9ydHMuVGFza1N0YXRlID0ge1xuICAgIC8qKiBUaGUgdGFzayBpcyBjdXJyZW50bHkgdHJhbnNmZXJyaW5nIGRhdGEuICovXG4gICAgUlVOTklORzogJ3J1bm5pbmcnLFxuICAgIC8qKiBUaGUgdGFzayB3YXMgcGF1c2VkIGJ5IHRoZSB1c2VyLiAqL1xuICAgIFBBVVNFRDogJ3BhdXNlZCcsXG4gICAgLyoqIFRoZSB0YXNrIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuICovXG4gICAgU1VDQ0VTUzogJ3N1Y2Nlc3MnLFxuICAgIC8qKiBUaGUgdGFzayB3YXMgY2FuY2VsZWQuICovXG4gICAgQ0FOQ0VMRUQ6ICdjYW5jZWxlZCcsXG4gICAgLyoqIFRoZSB0YXNrIGZhaWxlZCB3aXRoIGFuIGVycm9yLiAqL1xuICAgIEVSUk9SOiAnZXJyb3InXG59O1xuZnVuY3Rpb24gdGFza1N0YXRlRnJvbUludGVybmFsVGFza1N0YXRlKHN0YXRlKSB7XG4gICAgc3dpdGNoIChzdGF0ZSkge1xuICAgICAgICBjYXNlIGV4cG9ydHMuSW50ZXJuYWxUYXNrU3RhdGUuUlVOTklORzpcbiAgICAgICAgY2FzZSBleHBvcnRzLkludGVybmFsVGFza1N0YXRlLlBBVVNJTkc6XG4gICAgICAgIGNhc2UgZXhwb3J0cy5JbnRlcm5hbFRhc2tTdGF0ZS5DQU5DRUxJTkc6XG4gICAgICAgICAgICByZXR1cm4gZXhwb3J0cy5UYXNrU3RhdGUuUlVOTklORztcbiAgICAgICAgY2FzZSBleHBvcnRzLkludGVybmFsVGFza1N0YXRlLlBBVVNFRDpcbiAgICAgICAgICAgIHJldHVybiBleHBvcnRzLlRhc2tTdGF0ZS5QQVVTRUQ7XG4gICAgICAgIGNhc2UgZXhwb3J0cy5JbnRlcm5hbFRhc2tTdGF0ZS5TVUNDRVNTOlxuICAgICAgICAgICAgcmV0dXJuIGV4cG9ydHMuVGFza1N0YXRlLlNVQ0NFU1M7XG4gICAgICAgIGNhc2UgZXhwb3J0cy5JbnRlcm5hbFRhc2tTdGF0ZS5DQU5DRUxFRDpcbiAgICAgICAgICAgIHJldHVybiBleHBvcnRzLlRhc2tTdGF0ZS5DQU5DRUxFRDtcbiAgICAgICAgY2FzZSBleHBvcnRzLkludGVybmFsVGFza1N0YXRlLkVSUk9SOlxuICAgICAgICAgICAgcmV0dXJuIGV4cG9ydHMuVGFza1N0YXRlLkVSUk9SO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgLy8gVE9ETyhhbmR5c290byk6IGFzc2VydChmYWxzZSk7XG4gICAgICAgICAgICByZXR1cm4gZXhwb3J0cy5UYXNrU3RhdGUuRVJST1I7XG4gICAgfVxufVxuZXhwb3J0cy50YXNrU3RhdGVGcm9tSW50ZXJuYWxUYXNrU3RhdGUgPSB0YXNrU3RhdGVGcm9tSW50ZXJuYWxUYXNrU3RhdGU7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRhc2tlbnVtcy5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbi8qKlxuICogQHJldHVybiBGYWxzZSBpZiB0aGUgb2JqZWN0IGlzIHVuZGVmaW5lZCBvciBudWxsLCB0cnVlIG90aGVyd2lzZS5cbiAqL1xuZnVuY3Rpb24gaXNEZWYocCkge1xuICAgIHJldHVybiBwICE9IG51bGw7XG59XG5leHBvcnRzLmlzRGVmID0gaXNEZWY7XG5mdW5jdGlvbiBpc0p1c3REZWYocCkge1xuICAgIHJldHVybiBwICE9PSB2b2lkIDA7XG59XG5leHBvcnRzLmlzSnVzdERlZiA9IGlzSnVzdERlZjtcbmZ1bmN0aW9uIGlzRnVuY3Rpb24ocCkge1xuICAgIHJldHVybiB0eXBlb2YgcCA9PT0gJ2Z1bmN0aW9uJztcbn1cbmV4cG9ydHMuaXNGdW5jdGlvbiA9IGlzRnVuY3Rpb247XG5mdW5jdGlvbiBpc09iamVjdChwKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBwID09PSAnb2JqZWN0Jztcbn1cbmV4cG9ydHMuaXNPYmplY3QgPSBpc09iamVjdDtcbmZ1bmN0aW9uIGlzTm9uTnVsbE9iamVjdChwKSB7XG4gICAgcmV0dXJuIGlzT2JqZWN0KHApICYmIHAgIT09IG51bGw7XG59XG5leHBvcnRzLmlzTm9uTnVsbE9iamVjdCA9IGlzTm9uTnVsbE9iamVjdDtcbmZ1bmN0aW9uIGlzTm9uQXJyYXlPYmplY3QocCkge1xuICAgIHJldHVybiBpc09iamVjdChwKSAmJiAhQXJyYXkuaXNBcnJheShwKTtcbn1cbmV4cG9ydHMuaXNOb25BcnJheU9iamVjdCA9IGlzTm9uQXJyYXlPYmplY3Q7XG5mdW5jdGlvbiBpc1N0cmluZyhwKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBwID09PSAnc3RyaW5nJyB8fCBwIGluc3RhbmNlb2YgU3RyaW5nO1xufVxuZXhwb3J0cy5pc1N0cmluZyA9IGlzU3RyaW5nO1xuZnVuY3Rpb24gaXNOdW1iZXIocCkge1xuICAgIHJldHVybiB0eXBlb2YgcCA9PT0gJ251bWJlcicgfHwgcCBpbnN0YW5jZW9mIE51bWJlcjtcbn1cbmV4cG9ydHMuaXNOdW1iZXIgPSBpc051bWJlcjtcbmZ1bmN0aW9uIGlzTmF0aXZlQmxvYihwKSB7XG4gICAgcmV0dXJuIGlzTmF0aXZlQmxvYkRlZmluZWQoKSAmJiBwIGluc3RhbmNlb2YgQmxvYjtcbn1cbmV4cG9ydHMuaXNOYXRpdmVCbG9iID0gaXNOYXRpdmVCbG9iO1xuZnVuY3Rpb24gaXNOYXRpdmVCbG9iRGVmaW5lZCgpIHtcbiAgICByZXR1cm4gdHlwZW9mIEJsb2IgIT09ICd1bmRlZmluZWQnO1xufVxuZXhwb3J0cy5pc05hdGl2ZUJsb2JEZWZpbmVkID0gaXNOYXRpdmVCbG9iRGVmaW5lZDtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dHlwZS5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbi8qKlxuICogQGZpbGVvdmVydmlldyBGdW5jdGlvbnMgdG8gY3JlYXRlIGFuZCBtYW5pcHVsYXRlIFVSTHMgZm9yIHRoZSBzZXJ2ZXIgQVBJLlxuICovXG52YXIgY29uc3RhbnRzID0gcmVxdWlyZShcIi4vY29uc3RhbnRzXCIpO1xudmFyIG9iamVjdCA9IHJlcXVpcmUoXCIuL29iamVjdFwiKTtcbmZ1bmN0aW9uIG1ha2VOb3JtYWxVcmwodXJsUGFydCkge1xuICAgIHJldHVybiBjb25zdGFudHMuZG9tYWluQmFzZSArIGNvbnN0YW50cy5hcGlCYXNlVXJsICsgdXJsUGFydDtcbn1cbmV4cG9ydHMubWFrZU5vcm1hbFVybCA9IG1ha2VOb3JtYWxVcmw7XG5mdW5jdGlvbiBtYWtlRG93bmxvYWRVcmwodXJsUGFydCkge1xuICAgIHJldHVybiBjb25zdGFudHMuZG93bmxvYWRCYXNlICsgY29uc3RhbnRzLmFwaUJhc2VVcmwgKyB1cmxQYXJ0O1xufVxuZXhwb3J0cy5tYWtlRG93bmxvYWRVcmwgPSBtYWtlRG93bmxvYWRVcmw7XG5mdW5jdGlvbiBtYWtlVXBsb2FkVXJsKHVybFBhcnQpIHtcbiAgICByZXR1cm4gY29uc3RhbnRzLmRvbWFpbkJhc2UgKyBjb25zdGFudHMuYXBpVXBsb2FkQmFzZVVybCArIHVybFBhcnQ7XG59XG5leHBvcnRzLm1ha2VVcGxvYWRVcmwgPSBtYWtlVXBsb2FkVXJsO1xuZnVuY3Rpb24gbWFrZVF1ZXJ5U3RyaW5nKHBhcmFtcykge1xuICAgIHZhciBlbmNvZGUgPSBlbmNvZGVVUklDb21wb25lbnQ7XG4gICAgdmFyIHF1ZXJ5UGFydCA9ICc/JztcbiAgICBvYmplY3QuZm9yRWFjaChwYXJhbXMsIGZ1bmN0aW9uIChrZXksIHZhbCkge1xuICAgICAgICB2YXIgbmV4dFBhcnQgPSBlbmNvZGUoa2V5KSArICc9JyArIGVuY29kZSh2YWwpO1xuICAgICAgICBxdWVyeVBhcnQgPSBxdWVyeVBhcnQgKyBuZXh0UGFydCArICcmJztcbiAgICB9KTtcbiAgICAvLyBDaG9wIG9mZiB0aGUgZXh0cmEgJyYnIG9yICc/JyBvbiB0aGUgZW5kXG4gICAgcXVlcnlQYXJ0ID0gcXVlcnlQYXJ0LnNsaWNlKDAsIC0xKTtcbiAgICByZXR1cm4gcXVlcnlQYXJ0O1xufVxuZXhwb3J0cy5tYWtlUXVlcnlTdHJpbmcgPSBtYWtlUXVlcnlTdHJpbmc7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXVybC5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbi8qKlxuICogQGVudW17bnVtYmVyfVxuICovXG52YXIgRXJyb3JDb2RlO1xuKGZ1bmN0aW9uIChFcnJvckNvZGUpIHtcbiAgICBFcnJvckNvZGVbRXJyb3JDb2RlW1wiTk9fRVJST1JcIl0gPSAwXSA9IFwiTk9fRVJST1JcIjtcbiAgICBFcnJvckNvZGVbRXJyb3JDb2RlW1wiTkVUV09SS19FUlJPUlwiXSA9IDFdID0gXCJORVRXT1JLX0VSUk9SXCI7XG4gICAgRXJyb3JDb2RlW0Vycm9yQ29kZVtcIkFCT1JUXCJdID0gMl0gPSBcIkFCT1JUXCI7XG59KShFcnJvckNvZGUgPSBleHBvcnRzLkVycm9yQ29kZSB8fCAoZXhwb3J0cy5FcnJvckNvZGUgPSB7fSkpO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD14aHJpby5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbnZhciBlcnJvcnNFeHBvcnRzID0gcmVxdWlyZShcIi4vZXJyb3JcIik7XG52YXIgb2JqZWN0ID0gcmVxdWlyZShcIi4vb2JqZWN0XCIpO1xudmFyIHByb21pc2VpbXBsID0gcmVxdWlyZShcIi4vcHJvbWlzZV9leHRlcm5hbFwiKTtcbnZhciB0eXBlID0gcmVxdWlyZShcIi4vdHlwZVwiKTtcbnZhciBYaHJJb0V4cG9ydHMgPSByZXF1aXJlKFwiLi94aHJpb1wiKTtcbi8qKlxuICogV2UgdXNlIHRoaXMgaW5zdGVhZCBvZiBnb29nLm5ldC5YaHJJbyBiZWNhdXNlIGdvb2cubmV0LlhocklvIGlzIGh5dXV1dWdlIGFuZFxuICogZG9lc24ndCB3b3JrIGluIFJlYWN0IE5hdGl2ZSBvbiBBbmRyb2lkLlxuICovXG52YXIgTmV0d29ya1hocklvID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE5ldHdvcmtYaHJJbygpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5zZW50XyA9IGZhbHNlO1xuICAgICAgICB0aGlzLnhocl8gPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgdGhpcy5lcnJvckNvZGVfID0gWGhySW9FeHBvcnRzLkVycm9yQ29kZS5OT19FUlJPUjtcbiAgICAgICAgdGhpcy5zZW5kUHJvbWlzZV8gPSBwcm9taXNlaW1wbC5tYWtlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIF90aGlzLnhocl8uYWRkRXZlbnRMaXN0ZW5lcignYWJvcnQnLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5lcnJvckNvZGVfID0gWGhySW9FeHBvcnRzLkVycm9yQ29kZS5BQk9SVDtcbiAgICAgICAgICAgICAgICByZXNvbHZlKF90aGlzKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgX3RoaXMueGhyXy5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIF90aGlzLmVycm9yQ29kZV8gPSBYaHJJb0V4cG9ydHMuRXJyb3JDb2RlLk5FVFdPUktfRVJST1I7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShfdGhpcyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIF90aGlzLnhocl8uYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoX3RoaXMpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAb3ZlcnJpZGVcbiAgICAgKi9cbiAgICBOZXR3b3JrWGhySW8ucHJvdG90eXBlLnNlbmQgPSBmdW5jdGlvbiAodXJsLCBtZXRob2QsIG9wdF9ib2R5LCBvcHRfaGVhZGVycykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAodGhpcy5zZW50Xykge1xuICAgICAgICAgICAgdGhyb3cgZXJyb3JzRXhwb3J0cy5pbnRlcm5hbEVycm9yKCdjYW5ub3QgLnNlbmQoKSBtb3JlIHRoYW4gb25jZScpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2VudF8gPSB0cnVlO1xuICAgICAgICB0aGlzLnhocl8ub3BlbihtZXRob2QsIHVybCwgdHJ1ZSk7XG4gICAgICAgIGlmICh0eXBlLmlzRGVmKG9wdF9oZWFkZXJzKSkge1xuICAgICAgICAgICAgdmFyIGhlYWRlcnMgPSBvcHRfaGVhZGVycztcbiAgICAgICAgICAgIG9iamVjdC5mb3JFYWNoKGhlYWRlcnMsIGZ1bmN0aW9uIChrZXksIHZhbCkge1xuICAgICAgICAgICAgICAgIF90aGlzLnhocl8uc2V0UmVxdWVzdEhlYWRlcihrZXksIHZhbC50b1N0cmluZygpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlLmlzRGVmKG9wdF9ib2R5KSkge1xuICAgICAgICAgICAgdGhpcy54aHJfLnNlbmQob3B0X2JvZHkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy54aHJfLnNlbmQoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5zZW5kUHJvbWlzZV87XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAb3ZlcnJpZGVcbiAgICAgKi9cbiAgICBOZXR3b3JrWGhySW8ucHJvdG90eXBlLmdldEVycm9yQ29kZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnNlbnRfKSB7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcnNFeHBvcnRzLmludGVybmFsRXJyb3IoJ2Nhbm5vdCAuZ2V0RXJyb3JDb2RlKCkgYmVmb3JlIHNlbmRpbmcnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5lcnJvckNvZGVfO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQG92ZXJyaWRlXG4gICAgICovXG4gICAgTmV0d29ya1hocklvLnByb3RvdHlwZS5nZXRTdGF0dXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5zZW50Xykge1xuICAgICAgICAgICAgdGhyb3cgZXJyb3JzRXhwb3J0cy5pbnRlcm5hbEVycm9yKCdjYW5ub3QgLmdldFN0YXR1cygpIGJlZm9yZSBzZW5kaW5nJyk7XG4gICAgICAgIH1cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnhocl8uc3RhdHVzO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBvdmVycmlkZVxuICAgICAqL1xuICAgIE5ldHdvcmtYaHJJby5wcm90b3R5cGUuZ2V0UmVzcG9uc2VUZXh0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuc2VudF8pIHtcbiAgICAgICAgICAgIHRocm93IGVycm9yc0V4cG9ydHMuaW50ZXJuYWxFcnJvcignY2Fubm90IC5nZXRSZXNwb25zZVRleHQoKSBiZWZvcmUgc2VuZGluZycpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnhocl8ucmVzcG9uc2VUZXh0O1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQWJvcnRzIHRoZSByZXF1ZXN0LlxuICAgICAqIEBvdmVycmlkZVxuICAgICAqL1xuICAgIE5ldHdvcmtYaHJJby5wcm90b3R5cGUuYWJvcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMueGhyXy5hYm9ydCgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQG92ZXJyaWRlXG4gICAgICovXG4gICAgTmV0d29ya1hocklvLnByb3RvdHlwZS5nZXRSZXNwb25zZUhlYWRlciA9IGZ1bmN0aW9uIChoZWFkZXIpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMueGhyXy5nZXRSZXNwb25zZUhlYWRlcihoZWFkZXIpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQG92ZXJyaWRlXG4gICAgICovXG4gICAgTmV0d29ya1hocklvLnByb3RvdHlwZS5hZGRVcGxvYWRQcm9ncmVzc0xpc3RlbmVyID0gZnVuY3Rpb24gKGxpc3RlbmVyKSB7XG4gICAgICAgIGlmICh0eXBlLmlzRGVmKHRoaXMueGhyXy51cGxvYWQpKSB7XG4gICAgICAgICAgICB0aGlzLnhocl8udXBsb2FkLmFkZEV2ZW50TGlzdGVuZXIoJ3Byb2dyZXNzJywgbGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAb3ZlcnJpZGVcbiAgICAgKi9cbiAgICBOZXR3b3JrWGhySW8ucHJvdG90eXBlLnJlbW92ZVVwbG9hZFByb2dyZXNzTGlzdGVuZXIgPSBmdW5jdGlvbiAobGlzdGVuZXIpIHtcbiAgICAgICAgaWYgKHR5cGUuaXNEZWYodGhpcy54aHJfLnVwbG9hZCkpIHtcbiAgICAgICAgICAgIHRoaXMueGhyXy51cGxvYWQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncHJvZ3Jlc3MnLCBsaXN0ZW5lcik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBOZXR3b3JrWGhySW87XG59KCkpO1xuZXhwb3J0cy5OZXR3b3JrWGhySW8gPSBOZXR3b3JrWGhySW87XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXhocmlvX25ldHdvcmsuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgeGhyaW9fbmV0d29ya18xID0gcmVxdWlyZShcIi4veGhyaW9fbmV0d29ya1wiKTtcbi8qKlxuICogRmFjdG9yeS1saWtlIGNsYXNzIGZvciBjcmVhdGluZyBYaHJJbyBpbnN0YW5jZXMuXG4gKi9cbnZhciBYaHJJb1Bvb2wgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gWGhySW9Qb29sKCkge1xuICAgIH1cbiAgICBYaHJJb1Bvb2wucHJvdG90eXBlLmNyZWF0ZVhocklvID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbmV3IHhocmlvX25ldHdvcmtfMS5OZXR3b3JrWGhySW8oKTtcbiAgICB9O1xuICAgIHJldHVybiBYaHJJb1Bvb2w7XG59KCkpO1xuZXhwb3J0cy5YaHJJb1Bvb2wgPSBYaHJJb1Bvb2w7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXhocmlvcG9vbC5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbi8qKlxuICogQGZpbGVvdmVydmlldyBEZWZpbmVzIHRoZSBGaXJlYmFzZSBTdG9yYWdlIFJlZmVyZW5jZSBjbGFzcy5cbiAqL1xudmFyIGFyZ3MgPSByZXF1aXJlKFwiLi9pbXBsZW1lbnRhdGlvbi9hcmdzXCIpO1xudmFyIGJsb2JfMSA9IHJlcXVpcmUoXCIuL2ltcGxlbWVudGF0aW9uL2Jsb2JcIik7XG52YXIgZXJyb3JzRXhwb3J0cyA9IHJlcXVpcmUoXCIuL2ltcGxlbWVudGF0aW9uL2Vycm9yXCIpO1xudmFyIGxvY2F0aW9uXzEgPSByZXF1aXJlKFwiLi9pbXBsZW1lbnRhdGlvbi9sb2NhdGlvblwiKTtcbnZhciBtZXRhZGF0YSA9IHJlcXVpcmUoXCIuL2ltcGxlbWVudGF0aW9uL21ldGFkYXRhXCIpO1xudmFyIG9iamVjdCA9IHJlcXVpcmUoXCIuL2ltcGxlbWVudGF0aW9uL29iamVjdFwiKTtcbnZhciBwYXRoID0gcmVxdWlyZShcIi4vaW1wbGVtZW50YXRpb24vcGF0aFwiKTtcbnZhciByZXF1ZXN0cyA9IHJlcXVpcmUoXCIuL2ltcGxlbWVudGF0aW9uL3JlcXVlc3RzXCIpO1xudmFyIGZic1N0cmluZyA9IHJlcXVpcmUoXCIuL2ltcGxlbWVudGF0aW9uL3N0cmluZ1wiKTtcbnZhciBzdHJpbmdfMSA9IHJlcXVpcmUoXCIuL2ltcGxlbWVudGF0aW9uL3N0cmluZ1wiKTtcbnZhciB0eXBlID0gcmVxdWlyZShcIi4vaW1wbGVtZW50YXRpb24vdHlwZVwiKTtcbnZhciB0YXNrXzEgPSByZXF1aXJlKFwiLi90YXNrXCIpO1xuLyoqXG4gKiBQcm92aWRlcyBtZXRob2RzIHRvIGludGVyYWN0IHdpdGggYSBidWNrZXQgaW4gdGhlIEZpcmViYXNlIFN0b3JhZ2Ugc2VydmljZS5cbiAqIEBwYXJhbSBsb2NhdGlvbiBBbiBmYnMubG9jYXRpb24sIG9yIHRoZSBVUkwgYXRcbiAqICAgICB3aGljaCB0byBiYXNlIHRoaXMgb2JqZWN0LCBpbiBvbmUgb2YgdGhlIGZvbGxvd2luZyBmb3JtczpcbiAqICAgICAgICAgZ3M6Ly88YnVja2V0Pi88b2JqZWN0LXBhdGg+XG4gKiAgICAgICAgIGh0dHBbc106Ly9maXJlYmFzZXN0b3JhZ2UuZ29vZ2xlYXBpcy5jb20vXG4gKiAgICAgICAgICAgICAgICAgICAgIDxhcGktdmVyc2lvbj4vYi88YnVja2V0Pi9vLzxvYmplY3QtcGF0aD5cbiAqICAgICBBbnkgcXVlcnkgb3IgZnJhZ21lbnQgc3RyaW5ncyB3aWxsIGJlIGlnbm9yZWQgaW4gdGhlIGh0dHBbc11cbiAqICAgICBmb3JtYXQuIElmIG5vIHZhbHVlIGlzIHBhc3NlZCwgdGhlIHN0b3JhZ2Ugb2JqZWN0IHdpbGwgdXNlIGEgVVJMIGJhc2VkIG9uXG4gKiAgICAgdGhlIHByb2plY3QgSUQgb2YgdGhlIGJhc2UgZmlyZWJhc2UuQXBwIGluc3RhbmNlLlxuICovXG52YXIgUmVmZXJlbmNlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFJlZmVyZW5jZShhdXRoV3JhcHBlciwgbG9jYXRpb24pIHtcbiAgICAgICAgdGhpcy5hdXRoV3JhcHBlciA9IGF1dGhXcmFwcGVyO1xuICAgICAgICBpZiAobG9jYXRpb24gaW5zdGFuY2VvZiBsb2NhdGlvbl8xLkxvY2F0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLmxvY2F0aW9uID0gbG9jYXRpb247XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmxvY2F0aW9uID0gbG9jYXRpb25fMS5Mb2NhdGlvbi5tYWtlRnJvbVVybChsb2NhdGlvbik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQHJldHVybiBUaGUgVVJMIGZvciB0aGUgYnVja2V0IGFuZCBwYXRoIHRoaXMgb2JqZWN0IHJlZmVyZW5jZXMsXG4gICAgICogICAgIGluIHRoZSBmb3JtIGdzOi8vPGJ1Y2tldD4vPG9iamVjdC1wYXRoPlxuICAgICAqIEBvdmVycmlkZVxuICAgICAqL1xuICAgIFJlZmVyZW5jZS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGFyZ3MudmFsaWRhdGUoJ3RvU3RyaW5nJywgW10sIGFyZ3VtZW50cyk7XG4gICAgICAgIHJldHVybiAnZ3M6Ly8nICsgdGhpcy5sb2NhdGlvbi5idWNrZXQgKyAnLycgKyB0aGlzLmxvY2F0aW9uLnBhdGg7XG4gICAgfTtcbiAgICBSZWZlcmVuY2UucHJvdG90eXBlLm5ld1JlZiA9IGZ1bmN0aW9uIChhdXRoV3JhcHBlciwgbG9jYXRpb24pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSZWZlcmVuY2UoYXV0aFdyYXBwZXIsIGxvY2F0aW9uKTtcbiAgICB9O1xuICAgIFJlZmVyZW5jZS5wcm90b3R5cGUubWFwcGluZ3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBtZXRhZGF0YS5nZXRNYXBwaW5ncygpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiBBIHJlZmVyZW5jZSB0byB0aGUgb2JqZWN0IG9idGFpbmVkIGJ5XG4gICAgICogICAgIGFwcGVuZGluZyBjaGlsZFBhdGgsIHJlbW92aW5nIGFueSBkdXBsaWNhdGUsIGJlZ2lubmluZywgb3IgdHJhaWxpbmdcbiAgICAgKiAgICAgc2xhc2hlcy5cbiAgICAgKi9cbiAgICBSZWZlcmVuY2UucHJvdG90eXBlLmNoaWxkID0gZnVuY3Rpb24gKGNoaWxkUGF0aCkge1xuICAgICAgICBhcmdzLnZhbGlkYXRlKCdjaGlsZCcsIFthcmdzLnN0cmluZ1NwZWMoKV0sIGFyZ3VtZW50cyk7XG4gICAgICAgIHZhciBuZXdQYXRoID0gcGF0aC5jaGlsZCh0aGlzLmxvY2F0aW9uLnBhdGgsIGNoaWxkUGF0aCk7XG4gICAgICAgIHZhciBsb2NhdGlvbiA9IG5ldyBsb2NhdGlvbl8xLkxvY2F0aW9uKHRoaXMubG9jYXRpb24uYnVja2V0LCBuZXdQYXRoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMubmV3UmVmKHRoaXMuYXV0aFdyYXBwZXIsIGxvY2F0aW9uKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZWZlcmVuY2UucHJvdG90eXBlLCBcInBhcmVudFwiLCB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAcmV0dXJuIEEgcmVmZXJlbmNlIHRvIHRoZSBwYXJlbnQgb2YgdGhlXG4gICAgICAgICAqICAgICBjdXJyZW50IG9iamVjdCwgb3IgbnVsbCBpZiB0aGUgY3VycmVudCBvYmplY3QgaXMgdGhlIHJvb3QuXG4gICAgICAgICAqL1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBuZXdQYXRoID0gcGF0aC5wYXJlbnQodGhpcy5sb2NhdGlvbi5wYXRoKTtcbiAgICAgICAgICAgIGlmIChuZXdQYXRoID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgbG9jYXRpb24gPSBuZXcgbG9jYXRpb25fMS5Mb2NhdGlvbih0aGlzLmxvY2F0aW9uLmJ1Y2tldCwgbmV3UGF0aCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5uZXdSZWYodGhpcy5hdXRoV3JhcHBlciwgbG9jYXRpb24pO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVmZXJlbmNlLnByb3RvdHlwZSwgXCJyb290XCIsIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEByZXR1cm4gQW4gcmVmZXJlbmNlIHRvIHRoZSByb290IG9mIHRoaXNcbiAgICAgICAgICogICAgIG9iamVjdCdzIGJ1Y2tldC5cbiAgICAgICAgICovXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGxvY2F0aW9uID0gbmV3IGxvY2F0aW9uXzEuTG9jYXRpb24odGhpcy5sb2NhdGlvbi5idWNrZXQsICcnKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5ld1JlZih0aGlzLmF1dGhXcmFwcGVyLCBsb2NhdGlvbik7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZWZlcmVuY2UucHJvdG90eXBlLCBcImJ1Y2tldFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubG9jYXRpb24uYnVja2V0O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVmZXJlbmNlLnByb3RvdHlwZSwgXCJmdWxsUGF0aFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubG9jYXRpb24ucGF0aDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFJlZmVyZW5jZS5wcm90b3R5cGUsIFwibmFtZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHBhdGgubGFzdENvbXBvbmVudCh0aGlzLmxvY2F0aW9uLnBhdGgpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVmZXJlbmNlLnByb3RvdHlwZSwgXCJzdG9yYWdlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hdXRoV3JhcHBlci5zZXJ2aWNlKCk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIC8qKlxuICAgICAqIFVwbG9hZHMgYSBibG9iIHRvIHRoaXMgb2JqZWN0J3MgbG9jYXRpb24uXG4gICAgICogQHBhcmFtIGRhdGEgVGhlIGJsb2IgdG8gdXBsb2FkLlxuICAgICAqIEByZXR1cm4gQW4gVXBsb2FkVGFzayB0aGF0IGxldHMgeW91IGNvbnRyb2wgYW5kXG4gICAgICogICAgIG9ic2VydmUgdGhlIHVwbG9hZC5cbiAgICAgKi9cbiAgICBSZWZlcmVuY2UucHJvdG90eXBlLnB1dCA9IGZ1bmN0aW9uIChkYXRhLCBtZXRhZGF0YSkge1xuICAgICAgICBpZiAobWV0YWRhdGEgPT09IHZvaWQgMCkgeyBtZXRhZGF0YSA9IG51bGw7IH1cbiAgICAgICAgYXJncy52YWxpZGF0ZSgncHV0JywgW2FyZ3MudXBsb2FkRGF0YVNwZWMoKSwgYXJncy5tZXRhZGF0YVNwZWModHJ1ZSldLCBhcmd1bWVudHMpO1xuICAgICAgICB0aGlzLnRocm93SWZSb290XygncHV0Jyk7XG4gICAgICAgIHJldHVybiBuZXcgdGFza18xLlVwbG9hZFRhc2sodGhpcywgdGhpcy5hdXRoV3JhcHBlciwgdGhpcy5sb2NhdGlvbiwgdGhpcy5tYXBwaW5ncygpLCBuZXcgYmxvYl8xLkZic0Jsb2IoZGF0YSksIG1ldGFkYXRhKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFVwbG9hZHMgYSBzdHJpbmcgdG8gdGhpcyBvYmplY3QncyBsb2NhdGlvbi5cbiAgICAgKiBAcGFyYW0gc3RyaW5nIFRoZSBzdHJpbmcgdG8gdXBsb2FkLlxuICAgICAqIEBwYXJhbSBvcHRfZm9ybWF0IFRoZSBmb3JtYXQgb2YgdGhlIHN0cmluZyB0byB1cGxvYWQuXG4gICAgICogQHJldHVybiBBbiBVcGxvYWRUYXNrIHRoYXQgbGV0cyB5b3UgY29udHJvbCBhbmRcbiAgICAgKiAgICAgb2JzZXJ2ZSB0aGUgdXBsb2FkLlxuICAgICAqL1xuICAgIFJlZmVyZW5jZS5wcm90b3R5cGUucHV0U3RyaW5nID0gZnVuY3Rpb24gKHN0cmluZywgZm9ybWF0LCBvcHRfbWV0YWRhdGEpIHtcbiAgICAgICAgaWYgKGZvcm1hdCA9PT0gdm9pZCAwKSB7IGZvcm1hdCA9IHN0cmluZ18xLlN0cmluZ0Zvcm1hdC5SQVc7IH1cbiAgICAgICAgYXJncy52YWxpZGF0ZSgncHV0U3RyaW5nJywgW1xuICAgICAgICAgICAgYXJncy5zdHJpbmdTcGVjKCksXG4gICAgICAgICAgICBhcmdzLnN0cmluZ1NwZWMoZmJzU3RyaW5nLmZvcm1hdFZhbGlkYXRvciwgdHJ1ZSksXG4gICAgICAgICAgICBhcmdzLm1ldGFkYXRhU3BlYyh0cnVlKVxuICAgICAgICBdLCBhcmd1bWVudHMpO1xuICAgICAgICB0aGlzLnRocm93SWZSb290XygncHV0U3RyaW5nJyk7XG4gICAgICAgIHZhciBkYXRhID0gZmJzU3RyaW5nLmRhdGFGcm9tU3RyaW5nKGZvcm1hdCwgc3RyaW5nKTtcbiAgICAgICAgdmFyIG1ldGFkYXRhID0gb2JqZWN0LmNsb25lKG9wdF9tZXRhZGF0YSk7XG4gICAgICAgIGlmICghdHlwZS5pc0RlZihtZXRhZGF0YVsnY29udGVudFR5cGUnXSkgJiYgdHlwZS5pc0RlZihkYXRhLmNvbnRlbnRUeXBlKSkge1xuICAgICAgICAgICAgbWV0YWRhdGFbJ2NvbnRlbnRUeXBlJ10gPSBkYXRhLmNvbnRlbnRUeXBlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgdGFza18xLlVwbG9hZFRhc2sodGhpcywgdGhpcy5hdXRoV3JhcHBlciwgdGhpcy5sb2NhdGlvbiwgdGhpcy5tYXBwaW5ncygpLCBuZXcgYmxvYl8xLkZic0Jsb2IoZGF0YS5kYXRhLCB0cnVlKSwgbWV0YWRhdGEpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogRGVsZXRlcyB0aGUgb2JqZWN0IGF0IHRoaXMgbG9jYXRpb24uXG4gICAgICogQHJldHVybiBBIHByb21pc2UgdGhhdCByZXNvbHZlcyBpZiB0aGUgZGVsZXRpb24gc3VjY2VlZHMuXG4gICAgICovXG4gICAgUmVmZXJlbmNlLnByb3RvdHlwZS5kZWxldGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGFyZ3MudmFsaWRhdGUoJ2RlbGV0ZScsIFtdLCBhcmd1bWVudHMpO1xuICAgICAgICB0aGlzLnRocm93SWZSb290XygnZGVsZXRlJyk7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgcmV0dXJuIHRoaXMuYXV0aFdyYXBwZXIuZ2V0QXV0aFRva2VuKCkudGhlbihmdW5jdGlvbiAoYXV0aFRva2VuKSB7XG4gICAgICAgICAgICB2YXIgcmVxdWVzdEluZm8gPSByZXF1ZXN0cy5kZWxldGVPYmplY3Qoc2VsZi5hdXRoV3JhcHBlciwgc2VsZi5sb2NhdGlvbik7XG4gICAgICAgICAgICByZXR1cm4gc2VsZi5hdXRoV3JhcHBlci5tYWtlUmVxdWVzdChyZXF1ZXN0SW5mbywgYXV0aFRva2VuKS5nZXRQcm9taXNlKCk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogICAgIEEgcHJvbWlzZSB0aGF0IHJlc29sdmVzIHdpdGggdGhlIG1ldGFkYXRhIGZvciB0aGlzIG9iamVjdC4gSWYgdGhpc1xuICAgICAqICAgICBvYmplY3QgZG9lc24ndCBleGlzdCBvciBtZXRhZGF0YSBjYW5ub3QgYmUgcmV0cmVpdmVkLCB0aGUgcHJvbWlzZSBpc1xuICAgICAqICAgICByZWplY3RlZC5cbiAgICAgKi9cbiAgICBSZWZlcmVuY2UucHJvdG90eXBlLmdldE1ldGFkYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBhcmdzLnZhbGlkYXRlKCdnZXRNZXRhZGF0YScsIFtdLCBhcmd1bWVudHMpO1xuICAgICAgICB0aGlzLnRocm93SWZSb290XygnZ2V0TWV0YWRhdGEnKTtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICByZXR1cm4gdGhpcy5hdXRoV3JhcHBlci5nZXRBdXRoVG9rZW4oKS50aGVuKGZ1bmN0aW9uIChhdXRoVG9rZW4pIHtcbiAgICAgICAgICAgIHZhciByZXF1ZXN0SW5mbyA9IHJlcXVlc3RzLmdldE1ldGFkYXRhKHNlbGYuYXV0aFdyYXBwZXIsIHNlbGYubG9jYXRpb24sIHNlbGYubWFwcGluZ3MoKSk7XG4gICAgICAgICAgICByZXR1cm4gc2VsZi5hdXRoV3JhcHBlci5tYWtlUmVxdWVzdChyZXF1ZXN0SW5mbywgYXV0aFRva2VuKS5nZXRQcm9taXNlKCk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogVXBkYXRlcyB0aGUgbWV0YWRhdGEgZm9yIHRoaXMgb2JqZWN0LlxuICAgICAqIEBwYXJhbSBtZXRhZGF0YSBUaGUgbmV3IG1ldGFkYXRhIGZvciB0aGUgb2JqZWN0LlxuICAgICAqICAgICBPbmx5IHZhbHVlcyB0aGF0IGhhdmUgYmVlbiBleHBsaWNpdGx5IHNldCB3aWxsIGJlIGNoYW5nZWQuIEV4cGxpY2l0bHlcbiAgICAgKiAgICAgc2V0dGluZyBhIHZhbHVlIHRvIG51bGwgd2lsbCByZW1vdmUgdGhlIG1ldGFkYXRhLlxuICAgICAqIEByZXR1cm4gQSBwcm9taXNlIHRoYXQgcmVzb2x2ZXNcbiAgICAgKiAgICAgd2l0aCB0aGUgbmV3IG1ldGFkYXRhIGZvciB0aGlzIG9iamVjdC5cbiAgICAgKiAgICAgQHNlZSBmaXJlYmFzZVN0b3JhZ2UuUmVmZXJlbmNlLnByb3RvdHlwZS5nZXRNZXRhZGF0YVxuICAgICAqL1xuICAgIFJlZmVyZW5jZS5wcm90b3R5cGUudXBkYXRlTWV0YWRhdGEgPSBmdW5jdGlvbiAobWV0YWRhdGEpIHtcbiAgICAgICAgYXJncy52YWxpZGF0ZSgndXBkYXRlTWV0YWRhdGEnLCBbYXJncy5tZXRhZGF0YVNwZWMoKV0sIGFyZ3VtZW50cyk7XG4gICAgICAgIHRoaXMudGhyb3dJZlJvb3RfKCd1cGRhdGVNZXRhZGF0YScpO1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHJldHVybiB0aGlzLmF1dGhXcmFwcGVyLmdldEF1dGhUb2tlbigpLnRoZW4oZnVuY3Rpb24gKGF1dGhUb2tlbikge1xuICAgICAgICAgICAgdmFyIHJlcXVlc3RJbmZvID0gcmVxdWVzdHMudXBkYXRlTWV0YWRhdGEoc2VsZi5hdXRoV3JhcHBlciwgc2VsZi5sb2NhdGlvbiwgbWV0YWRhdGEsIHNlbGYubWFwcGluZ3MoKSk7XG4gICAgICAgICAgICByZXR1cm4gc2VsZi5hdXRoV3JhcHBlci5tYWtlUmVxdWVzdChyZXF1ZXN0SW5mbywgYXV0aFRva2VuKS5nZXRQcm9taXNlKCk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiBBIHByb21pc2UgdGhhdCByZXNvbHZlcyB3aXRoIHRoZSBkb3dubG9hZFxuICAgICAqICAgICBVUkwgZm9yIHRoaXMgb2JqZWN0LlxuICAgICAqL1xuICAgIFJlZmVyZW5jZS5wcm90b3R5cGUuZ2V0RG93bmxvYWRVUkwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGFyZ3MudmFsaWRhdGUoJ2dldERvd25sb2FkVVJMJywgW10sIGFyZ3VtZW50cyk7XG4gICAgICAgIHRoaXMudGhyb3dJZlJvb3RfKCdnZXREb3dubG9hZFVSTCcpO1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRNZXRhZGF0YSgpLnRoZW4oZnVuY3Rpb24gKG1ldGFkYXRhKSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gbWV0YWRhdGFbJ2Rvd25sb2FkVVJMcyddWzBdO1xuICAgICAgICAgICAgaWYgKHR5cGUuaXNEZWYodXJsKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB1cmw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcnNFeHBvcnRzLm5vRG93bmxvYWRVUkwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBSZWZlcmVuY2UucHJvdG90eXBlLnRocm93SWZSb290XyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIGlmICh0aGlzLmxvY2F0aW9uLnBhdGggPT09ICcnKSB7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcnNFeHBvcnRzLmludmFsaWRSb290T3BlcmF0aW9uKG5hbWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gUmVmZXJlbmNlO1xufSgpKTtcbmV4cG9ydHMuUmVmZXJlbmNlID0gUmVmZXJlbmNlO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1yZWZlcmVuY2UuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgYXJncyA9IHJlcXVpcmUoXCIuL2ltcGxlbWVudGF0aW9uL2FyZ3NcIik7XG52YXIgYXV0aHdyYXBwZXJfMSA9IHJlcXVpcmUoXCIuL2ltcGxlbWVudGF0aW9uL2F1dGh3cmFwcGVyXCIpO1xudmFyIGxvY2F0aW9uXzEgPSByZXF1aXJlKFwiLi9pbXBsZW1lbnRhdGlvbi9sb2NhdGlvblwiKTtcbnZhciBmYnNQcm9taXNlSW1wbCA9IHJlcXVpcmUoXCIuL2ltcGxlbWVudGF0aW9uL3Byb21pc2VfZXh0ZXJuYWxcIik7XG52YXIgUmVxdWVzdEV4cG9ydHMgPSByZXF1aXJlKFwiLi9pbXBsZW1lbnRhdGlvbi9yZXF1ZXN0XCIpO1xudmFyIHJlZmVyZW5jZV8xID0gcmVxdWlyZShcIi4vcmVmZXJlbmNlXCIpO1xuLyoqXG4gKiBBIHNlcnZpY2UgdGhhdCBwcm92aWRlcyBmaXJlYmFzZVN0b3JhZ2UuUmVmZXJlbmNlIGluc3RhbmNlcy5cbiAqIEBwYXJhbSBvcHRfdXJsIGdzOi8vIHVybCB0byBhIGN1c3RvbSBTdG9yYWdlIEJ1Y2tldFxuICpcbiAqIEBzdHJ1Y3RcbiAqL1xudmFyIFNlcnZpY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gU2VydmljZShhcHAsIHBvb2wsIHVybCkge1xuICAgICAgICB0aGlzLmJ1Y2tldF8gPSBudWxsO1xuICAgICAgICBmdW5jdGlvbiBtYWtlcihhdXRoV3JhcHBlciwgbG9jKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IHJlZmVyZW5jZV8xLlJlZmVyZW5jZShhdXRoV3JhcHBlciwgbG9jKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmF1dGhXcmFwcGVyXyA9IG5ldyBhdXRod3JhcHBlcl8xLkF1dGhXcmFwcGVyKGFwcCwgbWFrZXIsIFJlcXVlc3RFeHBvcnRzLm1ha2VSZXF1ZXN0LCB0aGlzLCBwb29sKTtcbiAgICAgICAgdGhpcy5hcHBfID0gYXBwO1xuICAgICAgICBpZiAodXJsICE9IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuYnVja2V0XyA9IGxvY2F0aW9uXzEuTG9jYXRpb24ubWFrZUZyb21CdWNrZXRTcGVjKHVybCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgYXV0aFdyYXBwZXJCdWNrZXQgPSB0aGlzLmF1dGhXcmFwcGVyXy5idWNrZXQoKTtcbiAgICAgICAgICAgIGlmIChhdXRoV3JhcHBlckJ1Y2tldCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5idWNrZXRfID0gbmV3IGxvY2F0aW9uXzEuTG9jYXRpb24oYXV0aFdyYXBwZXJCdWNrZXQsICcnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLmludGVybmFsc18gPSBuZXcgU2VydmljZUludGVybmFscyh0aGlzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGZpcmViYXNlU3RvcmFnZS5SZWZlcmVuY2UgZm9yIHRoZSBnaXZlbiBwYXRoIGluIHRoZSBkZWZhdWx0XG4gICAgICogYnVja2V0LlxuICAgICAqL1xuICAgIFNlcnZpY2UucHJvdG90eXBlLnJlZiA9IGZ1bmN0aW9uIChwYXRoKSB7XG4gICAgICAgIGZ1bmN0aW9uIHZhbGlkYXRvcihwYXRoKSB7XG4gICAgICAgICAgICBpZiAoL15bQS1aYS16XSs6XFwvXFwvLy50ZXN0KHBhdGgpKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgJ0V4cGVjdGVkIGNoaWxkIHBhdGggYnV0IGdvdCBhIFVSTCwgdXNlIHJlZkZyb21VUkwgaW5zdGVhZC4nO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGFyZ3MudmFsaWRhdGUoJ3JlZicsIFthcmdzLnN0cmluZ1NwZWModmFsaWRhdG9yLCB0cnVlKV0sIGFyZ3VtZW50cyk7XG4gICAgICAgIGlmICh0aGlzLmJ1Y2tldF8gPT0gbnVsbCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBTdG9yYWdlIEJ1Y2tldCBkZWZpbmVkIGluIEZpcmViYXNlIE9wdGlvbnMuJyk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlZiA9IG5ldyByZWZlcmVuY2VfMS5SZWZlcmVuY2UodGhpcy5hdXRoV3JhcHBlcl8sIHRoaXMuYnVja2V0Xyk7XG4gICAgICAgIGlmIChwYXRoICE9IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiByZWYuY2hpbGQocGF0aCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gcmVmO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgZmlyZWJhc2VTdG9yYWdlLlJlZmVyZW5jZSBvYmplY3QgZm9yIHRoZSBnaXZlbiBhYnNvbHV0ZSBVUkwsXG4gICAgICogd2hpY2ggbXVzdCBiZSBhIGdzOi8vIG9yIGh0dHBbc106Ly8gVVJMLlxuICAgICAqL1xuICAgIFNlcnZpY2UucHJvdG90eXBlLnJlZkZyb21VUkwgPSBmdW5jdGlvbiAodXJsKSB7XG4gICAgICAgIGZ1bmN0aW9uIHZhbGlkYXRvcihwKSB7XG4gICAgICAgICAgICBpZiAoIS9eW0EtWmEtel0rOlxcL1xcLy8udGVzdChwKSkge1xuICAgICAgICAgICAgICAgIHRocm93ICdFeHBlY3RlZCBmdWxsIFVSTCBidXQgZ290IGEgY2hpbGQgcGF0aCwgdXNlIHJlZiBpbnN0ZWFkLic7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGxvY2F0aW9uXzEuTG9jYXRpb24ubWFrZUZyb21VcmwocCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIHRocm93ICdFeHBlY3RlZCB2YWxpZCBmdWxsIFVSTCBidXQgZ290IGFuIGludmFsaWQgb25lLic7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYXJncy52YWxpZGF0ZSgncmVmRnJvbVVSTCcsIFthcmdzLnN0cmluZ1NwZWModmFsaWRhdG9yLCBmYWxzZSldLCBhcmd1bWVudHMpO1xuICAgICAgICByZXR1cm4gbmV3IHJlZmVyZW5jZV8xLlJlZmVyZW5jZSh0aGlzLmF1dGhXcmFwcGVyXywgdXJsKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXJ2aWNlLnByb3RvdHlwZSwgXCJtYXhVcGxvYWRSZXRyeVRpbWVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmF1dGhXcmFwcGVyXy5tYXhVcGxvYWRSZXRyeVRpbWUoKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU2VydmljZS5wcm90b3R5cGUuc2V0TWF4VXBsb2FkUmV0cnlUaW1lID0gZnVuY3Rpb24gKHRpbWUpIHtcbiAgICAgICAgYXJncy52YWxpZGF0ZSgnc2V0TWF4VXBsb2FkUmV0cnlUaW1lJywgW2FyZ3Mubm9uTmVnYXRpdmVOdW1iZXJTcGVjKCldLCBhcmd1bWVudHMpO1xuICAgICAgICB0aGlzLmF1dGhXcmFwcGVyXy5zZXRNYXhVcGxvYWRSZXRyeVRpbWUodGltZSk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2VydmljZS5wcm90b3R5cGUsIFwibWF4T3BlcmF0aW9uUmV0cnlUaW1lXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hdXRoV3JhcHBlcl8ubWF4T3BlcmF0aW9uUmV0cnlUaW1lKCk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFNlcnZpY2UucHJvdG90eXBlLnNldE1heE9wZXJhdGlvblJldHJ5VGltZSA9IGZ1bmN0aW9uICh0aW1lKSB7XG4gICAgICAgIGFyZ3MudmFsaWRhdGUoJ3NldE1heE9wZXJhdGlvblJldHJ5VGltZScsIFthcmdzLm5vbk5lZ2F0aXZlTnVtYmVyU3BlYygpXSwgYXJndW1lbnRzKTtcbiAgICAgICAgdGhpcy5hdXRoV3JhcHBlcl8uc2V0TWF4T3BlcmF0aW9uUmV0cnlUaW1lKHRpbWUpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNlcnZpY2UucHJvdG90eXBlLCBcImFwcFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXBwXztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNlcnZpY2UucHJvdG90eXBlLCBcIklOVEVSTkFMXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pbnRlcm5hbHNfO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICByZXR1cm4gU2VydmljZTtcbn0oKSk7XG5leHBvcnRzLlNlcnZpY2UgPSBTZXJ2aWNlO1xuLyoqXG4gKiBAc3RydWN0XG4gKi9cbnZhciBTZXJ2aWNlSW50ZXJuYWxzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFNlcnZpY2VJbnRlcm5hbHMoc2VydmljZSkge1xuICAgICAgICB0aGlzLnNlcnZpY2VfID0gc2VydmljZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHdoZW4gdGhlIGFzc29jaWF0ZWQgYXBwIGlzIGRlbGV0ZWQuXG4gICAgICogQHNlZSB7IWZicy5BdXRoV3JhcHBlci5wcm90b3R5cGUuZGVsZXRlQXBwfVxuICAgICAqL1xuICAgIFNlcnZpY2VJbnRlcm5hbHMucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zZXJ2aWNlXy5hdXRoV3JhcHBlcl8uZGVsZXRlQXBwKCk7XG4gICAgICAgIHJldHVybiBmYnNQcm9taXNlSW1wbC5yZXNvbHZlKHVuZGVmaW5lZCk7XG4gICAgfTtcbiAgICByZXR1cm4gU2VydmljZUludGVybmFscztcbn0oKSk7XG5leHBvcnRzLlNlcnZpY2VJbnRlcm5hbHMgPSBTZXJ2aWNlSW50ZXJuYWxzO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1zZXJ2aWNlLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBAZmlsZW92ZXJ2aWV3IERlZmluZXMgdHlwZXMgZm9yIGludGVyYWN0aW5nIHdpdGggYmxvYiB0cmFuc2ZlciB0YXNrcy5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHRhc2tlbnVtc18xID0gcmVxdWlyZShcIi4vaW1wbGVtZW50YXRpb24vdGFza2VudW1zXCIpO1xudmFyIG9ic2VydmVyXzEgPSByZXF1aXJlKFwiLi9pbXBsZW1lbnRhdGlvbi9vYnNlcnZlclwiKTtcbnZhciB0YXNrZW51bXNfMiA9IHJlcXVpcmUoXCIuL2ltcGxlbWVudGF0aW9uL3Rhc2tlbnVtc1wiKTtcbnZhciB0YXNrc25hcHNob3RfMSA9IHJlcXVpcmUoXCIuL3Rhc2tzbmFwc2hvdFwiKTtcbnZhciBmYnNBcmdzID0gcmVxdWlyZShcIi4vaW1wbGVtZW50YXRpb24vYXJnc1wiKTtcbnZhciBmYnNBcnJheSA9IHJlcXVpcmUoXCIuL2ltcGxlbWVudGF0aW9uL2FycmF5XCIpO1xudmFyIGFzeW5jXzEgPSByZXF1aXJlKFwiLi9pbXBsZW1lbnRhdGlvbi9hc3luY1wiKTtcbnZhciBlcnJvcnMgPSByZXF1aXJlKFwiLi9pbXBsZW1lbnRhdGlvbi9lcnJvclwiKTtcbnZhciBmYnNQcm9taXNlaW1wbCA9IHJlcXVpcmUoXCIuL2ltcGxlbWVudGF0aW9uL3Byb21pc2VfZXh0ZXJuYWxcIik7XG52YXIgZmJzUmVxdWVzdHMgPSByZXF1aXJlKFwiLi9pbXBsZW1lbnRhdGlvbi9yZXF1ZXN0c1wiKTtcbnZhciBmYnNUYXNrRW51bXMgPSByZXF1aXJlKFwiLi9pbXBsZW1lbnRhdGlvbi90YXNrZW51bXNcIik7XG52YXIgdHlwZVV0aWxzID0gcmVxdWlyZShcIi4vaW1wbGVtZW50YXRpb24vdHlwZVwiKTtcbi8qKlxuICogUmVwcmVzZW50cyBhIGJsb2IgYmVpbmcgdXBsb2FkZWQuIENhbiBiZSB1c2VkIHRvIHBhdXNlL3Jlc3VtZS9jYW5jZWwgdGhlXG4gKiB1cGxvYWQgYW5kIG1hbmFnZSBjYWxsYmFja3MgZm9yIHZhcmlvdXMgZXZlbnRzLlxuICovXG52YXIgVXBsb2FkVGFzayA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0gcmVmIFRoZSBmaXJlYmFzZVN0b3JhZ2UuUmVmZXJlbmNlIG9iamVjdCB0aGlzIHRhc2sgY2FtZVxuICAgICAqICAgICBmcm9tLCB1bnR5cGVkIHRvIGF2b2lkIGN5Y2xpYyBkZXBlbmRlbmNpZXMuXG4gICAgICogQHBhcmFtIGJsb2IgVGhlIGJsb2IgdG8gdXBsb2FkLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFVwbG9hZFRhc2socmVmLCBhdXRoV3JhcHBlciwgbG9jYXRpb24sIG1hcHBpbmdzLCBibG9iLCBtZXRhZGF0YSkge1xuICAgICAgICBpZiAobWV0YWRhdGEgPT09IHZvaWQgMCkgeyBtZXRhZGF0YSA9IG51bGw7IH1cbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy50cmFuc2ZlcnJlZF8gPSAwO1xuICAgICAgICB0aGlzLm5lZWRUb0ZldGNoU3RhdHVzXyA9IGZhbHNlO1xuICAgICAgICB0aGlzLm5lZWRUb0ZldGNoTWV0YWRhdGFfID0gZmFsc2U7XG4gICAgICAgIHRoaXMub2JzZXJ2ZXJzXyA9IFtdO1xuICAgICAgICB0aGlzLmVycm9yXyA9IG51bGw7XG4gICAgICAgIHRoaXMudXBsb2FkVXJsXyA9IG51bGw7XG4gICAgICAgIHRoaXMucmVxdWVzdF8gPSBudWxsO1xuICAgICAgICB0aGlzLmNodW5rTXVsdGlwbGllcl8gPSAxO1xuICAgICAgICB0aGlzLnJlc29sdmVfID0gbnVsbDtcbiAgICAgICAgdGhpcy5yZWplY3RfID0gbnVsbDtcbiAgICAgICAgdGhpcy5yZWZfID0gcmVmO1xuICAgICAgICB0aGlzLmF1dGhXcmFwcGVyXyA9IGF1dGhXcmFwcGVyO1xuICAgICAgICB0aGlzLmxvY2F0aW9uXyA9IGxvY2F0aW9uO1xuICAgICAgICB0aGlzLmJsb2JfID0gYmxvYjtcbiAgICAgICAgdGhpcy5tZXRhZGF0YV8gPSBtZXRhZGF0YTtcbiAgICAgICAgdGhpcy5tYXBwaW5nc18gPSBtYXBwaW5ncztcbiAgICAgICAgdGhpcy5yZXN1bWFibGVfID0gdGhpcy5zaG91bGREb1Jlc3VtYWJsZV8odGhpcy5ibG9iXyk7XG4gICAgICAgIHRoaXMuc3RhdGVfID0gdGFza2VudW1zXzEuSW50ZXJuYWxUYXNrU3RhdGUuUlVOTklORztcbiAgICAgICAgdGhpcy5lcnJvckhhbmRsZXJfID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICBfdGhpcy5yZXF1ZXN0XyA9IG51bGw7XG4gICAgICAgICAgICBfdGhpcy5jaHVua011bHRpcGxpZXJfID0gMTtcbiAgICAgICAgICAgIGlmIChlcnJvci5jb2RlRXF1YWxzKGVycm9ycy5Db2RlLkNBTkNFTEVEKSkge1xuICAgICAgICAgICAgICAgIF90aGlzLm5lZWRUb0ZldGNoU3RhdHVzXyA9IHRydWU7XG4gICAgICAgICAgICAgICAgX3RoaXMuY29tcGxldGVUcmFuc2l0aW9uc18oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIF90aGlzLmVycm9yXyA9IGVycm9yO1xuICAgICAgICAgICAgICAgIF90aGlzLnRyYW5zaXRpb25fKHRhc2tlbnVtc18xLkludGVybmFsVGFza1N0YXRlLkVSUk9SKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5tZXRhZGF0YUVycm9ySGFuZGxlcl8gPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgIF90aGlzLnJlcXVlc3RfID0gbnVsbDtcbiAgICAgICAgICAgIGlmIChlcnJvci5jb2RlRXF1YWxzKGVycm9ycy5Db2RlLkNBTkNFTEVEKSkge1xuICAgICAgICAgICAgICAgIF90aGlzLmNvbXBsZXRlVHJhbnNpdGlvbnNfKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5lcnJvcl8gPSBlcnJvcjtcbiAgICAgICAgICAgICAgICBfdGhpcy50cmFuc2l0aW9uXyh0YXNrZW51bXNfMS5JbnRlcm5hbFRhc2tTdGF0ZS5FUlJPUik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMucHJvbWlzZV8gPSBmYnNQcm9taXNlaW1wbC5tYWtlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIF90aGlzLnJlc29sdmVfID0gcmVzb2x2ZTtcbiAgICAgICAgICAgIF90aGlzLnJlamVjdF8gPSByZWplY3Q7XG4gICAgICAgICAgICBfdGhpcy5zdGFydF8oKTtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIFByZXZlbnQgdW5jYXVnaHQgcmVqZWN0aW9ucyBvbiB0aGUgaW50ZXJuYWwgcHJvbWlzZSBmcm9tIGJ1YmJsaW5nIG91dFxuICAgICAgICAvLyB0byB0aGUgdG9wIGxldmVsIHdpdGggYSBkdW1teSBoYW5kbGVyLlxuICAgICAgICB0aGlzLnByb21pc2VfLnRoZW4obnVsbCwgZnVuY3Rpb24gKCkgeyB9KTtcbiAgICB9XG4gICAgVXBsb2FkVGFzay5wcm90b3R5cGUubWFrZVByb2dyZXNzQ2FsbGJhY2tfID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgc2l6ZUJlZm9yZSA9IHRoaXMudHJhbnNmZXJyZWRfO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGxvYWRlZCwgdG90YWwpIHtcbiAgICAgICAgICAgIF90aGlzLnVwZGF0ZVByb2dyZXNzXyhzaXplQmVmb3JlICsgbG9hZGVkKTtcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIFVwbG9hZFRhc2sucHJvdG90eXBlLnNob3VsZERvUmVzdW1hYmxlXyA9IGZ1bmN0aW9uIChibG9iKSB7XG4gICAgICAgIHJldHVybiBibG9iLnNpemUoKSA+IDI1NiAqIDEwMjQ7XG4gICAgfTtcbiAgICBVcGxvYWRUYXNrLnByb3RvdHlwZS5zdGFydF8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlXyAhPT0gdGFza2VudW1zXzEuSW50ZXJuYWxUYXNrU3RhdGUuUlVOTklORykge1xuICAgICAgICAgICAgLy8gVGhpcyBjYW4gaGFwcGVuIGlmIHNvbWVvbmUgcGF1c2VzIHVzIGluIGEgcmVzdW1lIGNhbGxiYWNrLCBmb3IgZXhhbXBsZS5cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5yZXF1ZXN0XyAhPT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnJlc3VtYWJsZV8pIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnVwbG9hZFVybF8gPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZVJlc3VtYWJsZV8oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLm5lZWRUb0ZldGNoU3RhdHVzXykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZldGNoU3RhdHVzXygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubmVlZFRvRmV0Y2hNZXRhZGF0YV8pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhhcHBlbnMgaWYgd2UgbWlzcyB0aGUgbWV0YWRhdGEgb24gdXBsb2FkIGNvbXBsZXRpb24uXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZldGNoTWV0YWRhdGFfKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnRpbnVlVXBsb2FkXygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5vbmVTaG90VXBsb2FkXygpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBVcGxvYWRUYXNrLnByb3RvdHlwZS5yZXNvbHZlVG9rZW5fID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuYXV0aFdyYXBwZXJfLmdldEF1dGhUb2tlbigpLnRoZW4oZnVuY3Rpb24gKGF1dGhUb2tlbikge1xuICAgICAgICAgICAgc3dpdGNoIChfdGhpcy5zdGF0ZV8pIHtcbiAgICAgICAgICAgICAgICBjYXNlIHRhc2tlbnVtc18xLkludGVybmFsVGFza1N0YXRlLlJVTk5JTkc6XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKGF1dGhUb2tlbik7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgdGFza2VudW1zXzEuSW50ZXJuYWxUYXNrU3RhdGUuQ0FOQ0VMSU5HOlxuICAgICAgICAgICAgICAgICAgICBfdGhpcy50cmFuc2l0aW9uXyh0YXNrZW51bXNfMS5JbnRlcm5hbFRhc2tTdGF0ZS5DQU5DRUxFRCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgdGFza2VudW1zXzEuSW50ZXJuYWxUYXNrU3RhdGUuUEFVU0lORzpcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMudHJhbnNpdGlvbl8odGFza2VudW1zXzEuSW50ZXJuYWxUYXNrU3RhdGUuUEFVU0VEKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvLyBUT0RPKGFuZHlzb3RvKTogYXNzZXJ0IGZhbHNlXG4gICAgVXBsb2FkVGFzay5wcm90b3R5cGUuY3JlYXRlUmVzdW1hYmxlXyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5yZXNvbHZlVG9rZW5fKGZ1bmN0aW9uIChhdXRoVG9rZW4pIHtcbiAgICAgICAgICAgIHZhciByZXF1ZXN0SW5mbyA9IGZic1JlcXVlc3RzLmNyZWF0ZVJlc3VtYWJsZVVwbG9hZChfdGhpcy5hdXRoV3JhcHBlcl8sIF90aGlzLmxvY2F0aW9uXywgX3RoaXMubWFwcGluZ3NfLCBfdGhpcy5ibG9iXywgX3RoaXMubWV0YWRhdGFfKTtcbiAgICAgICAgICAgIHZhciBjcmVhdGVSZXF1ZXN0ID0gX3RoaXMuYXV0aFdyYXBwZXJfLm1ha2VSZXF1ZXN0KHJlcXVlc3RJbmZvLCBhdXRoVG9rZW4pO1xuICAgICAgICAgICAgX3RoaXMucmVxdWVzdF8gPSBjcmVhdGVSZXF1ZXN0O1xuICAgICAgICAgICAgY3JlYXRlUmVxdWVzdC5nZXRQcm9taXNlKCkudGhlbihmdW5jdGlvbiAodXJsKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMucmVxdWVzdF8gPSBudWxsO1xuICAgICAgICAgICAgICAgIF90aGlzLnVwbG9hZFVybF8gPSB1cmw7XG4gICAgICAgICAgICAgICAgX3RoaXMubmVlZFRvRmV0Y2hTdGF0dXNfID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgX3RoaXMuY29tcGxldGVUcmFuc2l0aW9uc18oKTtcbiAgICAgICAgICAgIH0sIF90aGlzLmVycm9ySGFuZGxlcl8pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFVwbG9hZFRhc2sucHJvdG90eXBlLmZldGNoU3RhdHVzXyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgLy8gVE9ETyhhbmR5c290byk6IGFzc2VydCh0aGlzLnVwbG9hZFVybF8gIT09IG51bGwpO1xuICAgICAgICB2YXIgdXJsID0gdGhpcy51cGxvYWRVcmxfO1xuICAgICAgICB0aGlzLnJlc29sdmVUb2tlbl8oZnVuY3Rpb24gKGF1dGhUb2tlbikge1xuICAgICAgICAgICAgdmFyIHJlcXVlc3RJbmZvID0gZmJzUmVxdWVzdHMuZ2V0UmVzdW1hYmxlVXBsb2FkU3RhdHVzKF90aGlzLmF1dGhXcmFwcGVyXywgX3RoaXMubG9jYXRpb25fLCB1cmwsIF90aGlzLmJsb2JfKTtcbiAgICAgICAgICAgIHZhciBzdGF0dXNSZXF1ZXN0ID0gX3RoaXMuYXV0aFdyYXBwZXJfLm1ha2VSZXF1ZXN0KHJlcXVlc3RJbmZvLCBhdXRoVG9rZW4pO1xuICAgICAgICAgICAgX3RoaXMucmVxdWVzdF8gPSBzdGF0dXNSZXF1ZXN0O1xuICAgICAgICAgICAgc3RhdHVzUmVxdWVzdC5nZXRQcm9taXNlKCkudGhlbihmdW5jdGlvbiAoc3RhdHVzKSB7XG4gICAgICAgICAgICAgICAgc3RhdHVzID0gc3RhdHVzO1xuICAgICAgICAgICAgICAgIF90aGlzLnJlcXVlc3RfID0gbnVsbDtcbiAgICAgICAgICAgICAgICBfdGhpcy51cGRhdGVQcm9ncmVzc18oc3RhdHVzLmN1cnJlbnQpO1xuICAgICAgICAgICAgICAgIF90aGlzLm5lZWRUb0ZldGNoU3RhdHVzXyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlmIChzdGF0dXMuZmluYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLm5lZWRUb0ZldGNoTWV0YWRhdGFfID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgX3RoaXMuY29tcGxldGVUcmFuc2l0aW9uc18oKTtcbiAgICAgICAgICAgIH0sIF90aGlzLmVycm9ySGFuZGxlcl8pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFVwbG9hZFRhc2sucHJvdG90eXBlLmNvbnRpbnVlVXBsb2FkXyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGNodW5rU2l6ZSA9IGZic1JlcXVlc3RzLnJlc3VtYWJsZVVwbG9hZENodW5rU2l6ZSAqIHRoaXMuY2h1bmtNdWx0aXBsaWVyXztcbiAgICAgICAgdmFyIHN0YXR1cyA9IG5ldyBmYnNSZXF1ZXN0cy5SZXN1bWFibGVVcGxvYWRTdGF0dXModGhpcy50cmFuc2ZlcnJlZF8sIHRoaXMuYmxvYl8uc2l6ZSgpKTtcbiAgICAgICAgLy8gVE9ETyhhbmR5c290byk6IGFzc2VydCh0aGlzLnVwbG9hZFVybF8gIT09IG51bGwpO1xuICAgICAgICB2YXIgdXJsID0gdGhpcy51cGxvYWRVcmxfO1xuICAgICAgICB0aGlzLnJlc29sdmVUb2tlbl8oZnVuY3Rpb24gKGF1dGhUb2tlbikge1xuICAgICAgICAgICAgdmFyIHJlcXVlc3RJbmZvO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICByZXF1ZXN0SW5mbyA9IGZic1JlcXVlc3RzLmNvbnRpbnVlUmVzdW1hYmxlVXBsb2FkKF90aGlzLmxvY2F0aW9uXywgX3RoaXMuYXV0aFdyYXBwZXJfLCB1cmwsIF90aGlzLmJsb2JfLCBjaHVua1NpemUsIF90aGlzLm1hcHBpbmdzXywgc3RhdHVzLCBfdGhpcy5tYWtlUHJvZ3Jlc3NDYWxsYmFja18oKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIF90aGlzLmVycm9yXyA9IGU7XG4gICAgICAgICAgICAgICAgX3RoaXMudHJhbnNpdGlvbl8odGFza2VudW1zXzEuSW50ZXJuYWxUYXNrU3RhdGUuRVJST1IpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB1cGxvYWRSZXF1ZXN0ID0gX3RoaXMuYXV0aFdyYXBwZXJfLm1ha2VSZXF1ZXN0KHJlcXVlc3RJbmZvLCBhdXRoVG9rZW4pO1xuICAgICAgICAgICAgX3RoaXMucmVxdWVzdF8gPSB1cGxvYWRSZXF1ZXN0O1xuICAgICAgICAgICAgdXBsb2FkUmVxdWVzdFxuICAgICAgICAgICAgICAgIC5nZXRQcm9taXNlKClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAobmV3U3RhdHVzKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuaW5jcmVhc2VNdWx0aXBsaWVyXygpO1xuICAgICAgICAgICAgICAgIF90aGlzLnJlcXVlc3RfID0gbnVsbDtcbiAgICAgICAgICAgICAgICBfdGhpcy51cGRhdGVQcm9ncmVzc18obmV3U3RhdHVzLmN1cnJlbnQpO1xuICAgICAgICAgICAgICAgIGlmIChuZXdTdGF0dXMuZmluYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLm1ldGFkYXRhXyA9IG5ld1N0YXR1cy5tZXRhZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMudHJhbnNpdGlvbl8odGFza2VudW1zXzEuSW50ZXJuYWxUYXNrU3RhdGUuU1VDQ0VTUyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5jb21wbGV0ZVRyYW5zaXRpb25zXygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIF90aGlzLmVycm9ySGFuZGxlcl8pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFVwbG9hZFRhc2sucHJvdG90eXBlLmluY3JlYXNlTXVsdGlwbGllcl8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjdXJyZW50U2l6ZSA9IGZic1JlcXVlc3RzLnJlc3VtYWJsZVVwbG9hZENodW5rU2l6ZSAqIHRoaXMuY2h1bmtNdWx0aXBsaWVyXztcbiAgICAgICAgLy8gTWF4IGNodW5rIHNpemUgaXMgMzJNLlxuICAgICAgICBpZiAoY3VycmVudFNpemUgPCAzMiAqIDEwMjQgKiAxMDI0KSB7XG4gICAgICAgICAgICB0aGlzLmNodW5rTXVsdGlwbGllcl8gKj0gMjtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVXBsb2FkVGFzay5wcm90b3R5cGUuZmV0Y2hNZXRhZGF0YV8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMucmVzb2x2ZVRva2VuXyhmdW5jdGlvbiAoYXV0aFRva2VuKSB7XG4gICAgICAgICAgICB2YXIgcmVxdWVzdEluZm8gPSBmYnNSZXF1ZXN0cy5nZXRNZXRhZGF0YShfdGhpcy5hdXRoV3JhcHBlcl8sIF90aGlzLmxvY2F0aW9uXywgX3RoaXMubWFwcGluZ3NfKTtcbiAgICAgICAgICAgIHZhciBtZXRhZGF0YVJlcXVlc3QgPSBfdGhpcy5hdXRoV3JhcHBlcl8ubWFrZVJlcXVlc3QocmVxdWVzdEluZm8sIGF1dGhUb2tlbik7XG4gICAgICAgICAgICBfdGhpcy5yZXF1ZXN0XyA9IG1ldGFkYXRhUmVxdWVzdDtcbiAgICAgICAgICAgIG1ldGFkYXRhUmVxdWVzdC5nZXRQcm9taXNlKCkudGhlbihmdW5jdGlvbiAobWV0YWRhdGEpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5yZXF1ZXN0XyA9IG51bGw7XG4gICAgICAgICAgICAgICAgX3RoaXMubWV0YWRhdGFfID0gbWV0YWRhdGE7XG4gICAgICAgICAgICAgICAgX3RoaXMudHJhbnNpdGlvbl8odGFza2VudW1zXzEuSW50ZXJuYWxUYXNrU3RhdGUuU1VDQ0VTUyk7XG4gICAgICAgICAgICB9LCBfdGhpcy5tZXRhZGF0YUVycm9ySGFuZGxlcl8pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFVwbG9hZFRhc2sucHJvdG90eXBlLm9uZVNob3RVcGxvYWRfID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnJlc29sdmVUb2tlbl8oZnVuY3Rpb24gKGF1dGhUb2tlbikge1xuICAgICAgICAgICAgdmFyIHJlcXVlc3RJbmZvID0gZmJzUmVxdWVzdHMubXVsdGlwYXJ0VXBsb2FkKF90aGlzLmF1dGhXcmFwcGVyXywgX3RoaXMubG9jYXRpb25fLCBfdGhpcy5tYXBwaW5nc18sIF90aGlzLmJsb2JfLCBfdGhpcy5tZXRhZGF0YV8pO1xuICAgICAgICAgICAgdmFyIG11bHRpcGFydFJlcXVlc3QgPSBfdGhpcy5hdXRoV3JhcHBlcl8ubWFrZVJlcXVlc3QocmVxdWVzdEluZm8sIGF1dGhUb2tlbik7XG4gICAgICAgICAgICBfdGhpcy5yZXF1ZXN0XyA9IG11bHRpcGFydFJlcXVlc3Q7XG4gICAgICAgICAgICBtdWx0aXBhcnRSZXF1ZXN0LmdldFByb21pc2UoKS50aGVuKGZ1bmN0aW9uIChtZXRhZGF0YSkge1xuICAgICAgICAgICAgICAgIF90aGlzLnJlcXVlc3RfID0gbnVsbDtcbiAgICAgICAgICAgICAgICBfdGhpcy5tZXRhZGF0YV8gPSBtZXRhZGF0YTtcbiAgICAgICAgICAgICAgICBfdGhpcy51cGRhdGVQcm9ncmVzc18oX3RoaXMuYmxvYl8uc2l6ZSgpKTtcbiAgICAgICAgICAgICAgICBfdGhpcy50cmFuc2l0aW9uXyh0YXNrZW51bXNfMS5JbnRlcm5hbFRhc2tTdGF0ZS5TVUNDRVNTKTtcbiAgICAgICAgICAgIH0sIF90aGlzLmVycm9ySGFuZGxlcl8pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFVwbG9hZFRhc2sucHJvdG90eXBlLnVwZGF0ZVByb2dyZXNzXyA9IGZ1bmN0aW9uICh0cmFuc2ZlcnJlZCkge1xuICAgICAgICB2YXIgb2xkID0gdGhpcy50cmFuc2ZlcnJlZF87XG4gICAgICAgIHRoaXMudHJhbnNmZXJyZWRfID0gdHJhbnNmZXJyZWQ7XG4gICAgICAgIC8vIEEgcHJvZ3Jlc3MgdXBkYXRlIGNhbiBtYWtlIHRoZSBcInRyYW5zZmVycmVkXCIgdmFsdWUgc21hbGxlciAoZS5nLiBhXG4gICAgICAgIC8vIHBhcnRpYWwgdXBsb2FkIG5vdCBjb21wbGV0ZWQgYnkgc2VydmVyLCBhZnRlciB3aGljaCB0aGUgXCJ0cmFuc2ZlcnJlZFwiXG4gICAgICAgIC8vIHZhbHVlIG1heSByZXNldCB0byB0aGUgdmFsdWUgYXQgdGhlIGJlZ2lubmluZyBvZiB0aGUgcmVxdWVzdCkuXG4gICAgICAgIGlmICh0aGlzLnRyYW5zZmVycmVkXyAhPT0gb2xkKSB7XG4gICAgICAgICAgICB0aGlzLm5vdGlmeU9ic2VydmVyc18oKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVXBsb2FkVGFzay5wcm90b3R5cGUudHJhbnNpdGlvbl8gPSBmdW5jdGlvbiAoc3RhdGUpIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGVfID09PSBzdGF0ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHN3aXRjaCAoc3RhdGUpIHtcbiAgICAgICAgICAgIGNhc2UgdGFza2VudW1zXzEuSW50ZXJuYWxUYXNrU3RhdGUuQ0FOQ0VMSU5HOlxuICAgICAgICAgICAgICAgIC8vIFRPRE8oYW5keXNvdG8pOlxuICAgICAgICAgICAgICAgIC8vIGFzc2VydCh0aGlzLnN0YXRlXyA9PT0gSW50ZXJuYWxUYXNrU3RhdGUuUlVOTklORyB8fFxuICAgICAgICAgICAgICAgIC8vICAgICAgICB0aGlzLnN0YXRlXyA9PT0gSW50ZXJuYWxUYXNrU3RhdGUuUEFVU0lORyk7XG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0ZV8gPSBzdGF0ZTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5yZXF1ZXN0XyAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlcXVlc3RfLmNhbmNlbCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgdGFza2VudW1zXzEuSW50ZXJuYWxUYXNrU3RhdGUuUEFVU0lORzpcbiAgICAgICAgICAgICAgICAvLyBUT0RPKGFuZHlzb3RvKTpcbiAgICAgICAgICAgICAgICAvLyBhc3NlcnQodGhpcy5zdGF0ZV8gPT09IEludGVybmFsVGFza1N0YXRlLlJVTk5JTkcpO1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGVfID0gc3RhdGU7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucmVxdWVzdF8gIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXF1ZXN0Xy5jYW5jZWwoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIHRhc2tlbnVtc18xLkludGVybmFsVGFza1N0YXRlLlJVTk5JTkc6XG4gICAgICAgICAgICAgICAgLy8gVE9ETyhhbmR5c290byk6XG4gICAgICAgICAgICAgICAgLy8gYXNzZXJ0KHRoaXMuc3RhdGVfID09PSBJbnRlcm5hbFRhc2tTdGF0ZS5QQVVTRUQgfHxcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgdGhpcy5zdGF0ZV8gPT09IEludGVybmFsVGFza1N0YXRlLlBBVVNJTkcpO1xuICAgICAgICAgICAgICAgIHZhciB3YXNQYXVzZWQgPSB0aGlzLnN0YXRlXyA9PT0gdGFza2VudW1zXzEuSW50ZXJuYWxUYXNrU3RhdGUuUEFVU0VEO1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGVfID0gc3RhdGU7XG4gICAgICAgICAgICAgICAgaWYgKHdhc1BhdXNlZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeU9ic2VydmVyc18oKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGFydF8oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIHRhc2tlbnVtc18xLkludGVybmFsVGFza1N0YXRlLlBBVVNFRDpcbiAgICAgICAgICAgICAgICAvLyBUT0RPKGFuZHlzb3RvKTpcbiAgICAgICAgICAgICAgICAvLyBhc3NlcnQodGhpcy5zdGF0ZV8gPT09IEludGVybmFsVGFza1N0YXRlLlBBVVNJTkcpO1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGVfID0gc3RhdGU7XG4gICAgICAgICAgICAgICAgdGhpcy5ub3RpZnlPYnNlcnZlcnNfKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIHRhc2tlbnVtc18xLkludGVybmFsVGFza1N0YXRlLkNBTkNFTEVEOlxuICAgICAgICAgICAgICAgIC8vIFRPRE8oYW5keXNvdG8pOlxuICAgICAgICAgICAgICAgIC8vIGFzc2VydCh0aGlzLnN0YXRlXyA9PT0gSW50ZXJuYWxUYXNrU3RhdGUuUEFVU0VEIHx8XG4gICAgICAgICAgICAgICAgLy8gICAgICAgIHRoaXMuc3RhdGVfID09PSBJbnRlcm5hbFRhc2tTdGF0ZS5DQU5DRUxJTkcpO1xuICAgICAgICAgICAgICAgIHRoaXMuZXJyb3JfID0gZXJyb3JzLmNhbmNlbGVkKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0ZV8gPSBzdGF0ZTtcbiAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeU9ic2VydmVyc18oKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgdGFza2VudW1zXzEuSW50ZXJuYWxUYXNrU3RhdGUuRVJST1I6XG4gICAgICAgICAgICAgICAgLy8gVE9ETyhhbmR5c290byk6XG4gICAgICAgICAgICAgICAgLy8gYXNzZXJ0KHRoaXMuc3RhdGVfID09PSBJbnRlcm5hbFRhc2tTdGF0ZS5SVU5OSU5HIHx8XG4gICAgICAgICAgICAgICAgLy8gICAgICAgIHRoaXMuc3RhdGVfID09PSBJbnRlcm5hbFRhc2tTdGF0ZS5QQVVTSU5HIHx8XG4gICAgICAgICAgICAgICAgLy8gICAgICAgIHRoaXMuc3RhdGVfID09PSBJbnRlcm5hbFRhc2tTdGF0ZS5DQU5DRUxJTkcpO1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGVfID0gc3RhdGU7XG4gICAgICAgICAgICAgICAgdGhpcy5ub3RpZnlPYnNlcnZlcnNfKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIHRhc2tlbnVtc18xLkludGVybmFsVGFza1N0YXRlLlNVQ0NFU1M6XG4gICAgICAgICAgICAgICAgLy8gVE9ETyhhbmR5c290byk6XG4gICAgICAgICAgICAgICAgLy8gYXNzZXJ0KHRoaXMuc3RhdGVfID09PSBJbnRlcm5hbFRhc2tTdGF0ZS5SVU5OSU5HIHx8XG4gICAgICAgICAgICAgICAgLy8gICAgICAgIHRoaXMuc3RhdGVfID09PSBJbnRlcm5hbFRhc2tTdGF0ZS5QQVVTSU5HIHx8XG4gICAgICAgICAgICAgICAgLy8gICAgICAgIHRoaXMuc3RhdGVfID09PSBJbnRlcm5hbFRhc2tTdGF0ZS5DQU5DRUxJTkcpO1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGVfID0gc3RhdGU7XG4gICAgICAgICAgICAgICAgdGhpcy5ub3RpZnlPYnNlcnZlcnNfKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFVwbG9hZFRhc2sucHJvdG90eXBlLmNvbXBsZXRlVHJhbnNpdGlvbnNfID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBzd2l0Y2ggKHRoaXMuc3RhdGVfKSB7XG4gICAgICAgICAgICBjYXNlIHRhc2tlbnVtc18xLkludGVybmFsVGFza1N0YXRlLlBBVVNJTkc6XG4gICAgICAgICAgICAgICAgdGhpcy50cmFuc2l0aW9uXyh0YXNrZW51bXNfMS5JbnRlcm5hbFRhc2tTdGF0ZS5QQVVTRUQpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSB0YXNrZW51bXNfMS5JbnRlcm5hbFRhc2tTdGF0ZS5DQU5DRUxJTkc6XG4gICAgICAgICAgICAgICAgdGhpcy50cmFuc2l0aW9uXyh0YXNrZW51bXNfMS5JbnRlcm5hbFRhc2tTdGF0ZS5DQU5DRUxFRCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIHRhc2tlbnVtc18xLkludGVybmFsVGFza1N0YXRlLlJVTk5JTkc6XG4gICAgICAgICAgICAgICAgdGhpcy5zdGFydF8oKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgLy8gVE9ETyhhbmR5c290byk6IGFzc2VydChmYWxzZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShVcGxvYWRUYXNrLnByb3RvdHlwZSwgXCJzbmFwc2hvdFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGV4dGVybmFsU3RhdGUgPSBmYnNUYXNrRW51bXMudGFza1N0YXRlRnJvbUludGVybmFsVGFza1N0YXRlKHRoaXMuc3RhdGVfKTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgdGFza3NuYXBzaG90XzEuVXBsb2FkVGFza1NuYXBzaG90KHRoaXMudHJhbnNmZXJyZWRfLCB0aGlzLmJsb2JfLnNpemUoKSwgZXh0ZXJuYWxTdGF0ZSwgdGhpcy5tZXRhZGF0YV8sIHRoaXMsIHRoaXMucmVmXyk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIC8qKlxuICAgICAqIEFkZHMgYSBjYWxsYmFjayBmb3IgYW4gZXZlbnQuXG4gICAgICogQHBhcmFtIHR5cGUgVGhlIHR5cGUgb2YgZXZlbnQgdG8gbGlzdGVuIGZvci5cbiAgICAgKi9cbiAgICBVcGxvYWRUYXNrLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uICh0eXBlLCBuZXh0T3JPYnNlcnZlciwgZXJyb3IsIGNvbXBsZXRlZCkge1xuICAgICAgICBpZiAobmV4dE9yT2JzZXJ2ZXIgPT09IHZvaWQgMCkgeyBuZXh0T3JPYnNlcnZlciA9IHVuZGVmaW5lZDsgfVxuICAgICAgICBpZiAoZXJyb3IgPT09IHZvaWQgMCkgeyBlcnJvciA9IHVuZGVmaW5lZDsgfVxuICAgICAgICBpZiAoY29tcGxldGVkID09PSB2b2lkIDApIHsgY29tcGxldGVkID0gdW5kZWZpbmVkOyB9XG4gICAgICAgIGZ1bmN0aW9uIHR5cGVWYWxpZGF0b3IoX3ApIHtcbiAgICAgICAgICAgIGlmICh0eXBlICE9PSB0YXNrZW51bXNfMi5UYXNrRXZlbnQuU1RBVEVfQ0hBTkdFRCkge1xuICAgICAgICAgICAgICAgIHRocm93IFwiRXhwZWN0ZWQgb25lIG9mIHRoZSBldmVudCB0eXBlczogW1wiICsgdGFza2VudW1zXzIuVGFza0V2ZW50LlNUQVRFX0NIQU5HRUQgKyBcIl0uXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5leHRPck9ic2VydmVyTWVzc2FnZSA9ICdFeHBlY3RlZCBhIGZ1bmN0aW9uIG9yIGFuIE9iamVjdCB3aXRoIG9uZSBvZiAnICtcbiAgICAgICAgICAgICdgbmV4dGAsIGBlcnJvcmAsIGBjb21wbGV0ZWAgcHJvcGVydGllcy4nO1xuICAgICAgICB2YXIgbmV4dFZhbGlkYXRvciA9IGZic0FyZ3MubnVsbEZ1bmN0aW9uU3BlYyh0cnVlKS52YWxpZGF0b3I7XG4gICAgICAgIHZhciBvYnNlcnZlclZhbGlkYXRvciA9IGZic0FyZ3MubG9vc2VPYmplY3RTcGVjKG51bGwsIHRydWUpLnZhbGlkYXRvcjtcbiAgICAgICAgZnVuY3Rpb24gbmV4dE9yT2JzZXJ2ZXJWYWxpZGF0b3IocCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBuZXh0VmFsaWRhdG9yKHApO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7IH1cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXJWYWxpZGF0b3IocCk7XG4gICAgICAgICAgICAgICAgdmFyIGFueURlZmluZWQgPSB0eXBlVXRpbHMuaXNKdXN0RGVmKHBbJ25leHQnXSkgfHxcbiAgICAgICAgICAgICAgICAgICAgdHlwZVV0aWxzLmlzSnVzdERlZihwWydlcnJvciddKSB8fFxuICAgICAgICAgICAgICAgICAgICB0eXBlVXRpbHMuaXNKdXN0RGVmKHBbJ2NvbXBsZXRlJ10pO1xuICAgICAgICAgICAgICAgIGlmICghYW55RGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyAnJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXh0T3JPYnNlcnZlck1lc3NhZ2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNwZWNzID0gW1xuICAgICAgICAgICAgZmJzQXJncy5zdHJpbmdTcGVjKHR5cGVWYWxpZGF0b3IpLFxuICAgICAgICAgICAgZmJzQXJncy5sb29zZU9iamVjdFNwZWMobmV4dE9yT2JzZXJ2ZXJWYWxpZGF0b3IsIHRydWUpLFxuICAgICAgICAgICAgZmJzQXJncy5udWxsRnVuY3Rpb25TcGVjKHRydWUpLFxuICAgICAgICAgICAgZmJzQXJncy5udWxsRnVuY3Rpb25TcGVjKHRydWUpXG4gICAgICAgIF07XG4gICAgICAgIGZic0FyZ3MudmFsaWRhdGUoJ29uJywgc3BlY3MsIGFyZ3VtZW50cyk7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gbWFrZUJpbmRlcihzcGVjcykge1xuICAgICAgICAgICAgZnVuY3Rpb24gYmluZGVyKG5leHRPck9ic2VydmVyLCBlcnJvciwgb3B0X2NvbXBsZXRlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNwZWNzICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGZic0FyZ3MudmFsaWRhdGUoJ29uJywgc3BlY3MsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBvYnNlcnZlciA9IG5ldyBvYnNlcnZlcl8xLk9ic2VydmVyKG5leHRPck9ic2VydmVyLCBlcnJvciwgY29tcGxldGVkKTtcbiAgICAgICAgICAgICAgICBzZWxmLmFkZE9ic2VydmVyXyhvYnNlcnZlcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5yZW1vdmVPYnNlcnZlcl8ob2JzZXJ2ZXIpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYmluZGVyO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGJpbmRlck5leHRPck9ic2VydmVyVmFsaWRhdG9yKHApIHtcbiAgICAgICAgICAgIGlmIChwID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV4dE9yT2JzZXJ2ZXJNZXNzYWdlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbmV4dE9yT2JzZXJ2ZXJWYWxpZGF0b3IocCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJpbmRlclNwZWNzID0gW1xuICAgICAgICAgICAgZmJzQXJncy5sb29zZU9iamVjdFNwZWMoYmluZGVyTmV4dE9yT2JzZXJ2ZXJWYWxpZGF0b3IpLFxuICAgICAgICAgICAgZmJzQXJncy5udWxsRnVuY3Rpb25TcGVjKHRydWUpLFxuICAgICAgICAgICAgZmJzQXJncy5udWxsRnVuY3Rpb25TcGVjKHRydWUpXG4gICAgICAgIF07XG4gICAgICAgIHZhciB0eXBlT25seSA9ICEodHlwZVV0aWxzLmlzSnVzdERlZihuZXh0T3JPYnNlcnZlcikgfHxcbiAgICAgICAgICAgIHR5cGVVdGlscy5pc0p1c3REZWYoZXJyb3IpIHx8XG4gICAgICAgICAgICB0eXBlVXRpbHMuaXNKdXN0RGVmKGNvbXBsZXRlZCkpO1xuICAgICAgICBpZiAodHlwZU9ubHkpIHtcbiAgICAgICAgICAgIHJldHVybiBtYWtlQmluZGVyKGJpbmRlclNwZWNzKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBtYWtlQmluZGVyKG51bGwpKG5leHRPck9ic2VydmVyLCBlcnJvciwgY29tcGxldGVkKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogVGhpcyBvYmplY3QgYmVoYXZlcyBsaWtlIGEgUHJvbWlzZSwgYW5kIHJlc29sdmVzIHdpdGggaXRzIHNuYXBzaG90IGRhdGFcbiAgICAgKiB3aGVuIHRoZSB1cGxvYWQgY29tcGxldGVzLlxuICAgICAqIEBwYXJhbSBvbkZ1bGZpbGxlZCBUaGUgZnVsZmlsbG1lbnQgY2FsbGJhY2suIFByb21pc2UgY2hhaW5pbmcgd29ya3MgYXMgbm9ybWFsLlxuICAgICAqIEBwYXJhbSBvblJlamVjdGVkIFRoZSByZWplY3Rpb24gY2FsbGJhY2suXG4gICAgICovXG4gICAgVXBsb2FkVGFzay5wcm90b3R5cGUudGhlbiA9IGZ1bmN0aW9uIChvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCkge1xuICAgICAgICAvLyBUaGVzZSBjYXN0cyBhcmUgbmVlZGVkIHNvIHRoYXQgVHlwZVNjcmlwdCBjYW4gaW5mZXIgdGhlIHR5cGVzIG9mIHRoZVxuICAgICAgICAvLyByZXN1bHRpbmcgUHJvbWlzZS5cbiAgICAgICAgcmV0dXJuIHRoaXMucHJvbWlzZV8udGhlbihvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBFcXVpdmFsZW50IHRvIGNhbGxpbmcgYHRoZW4obnVsbCwgb25SZWplY3RlZClgLlxuICAgICAqL1xuICAgIFVwbG9hZFRhc2sucHJvdG90eXBlLmNhdGNoID0gZnVuY3Rpb24gKG9uUmVqZWN0ZWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudGhlbihudWxsLCBvblJlamVjdGVkKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEFkZHMgdGhlIGdpdmVuIG9ic2VydmVyLlxuICAgICAqL1xuICAgIFVwbG9hZFRhc2sucHJvdG90eXBlLmFkZE9ic2VydmVyXyA9IGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgICB0aGlzLm9ic2VydmVyc18ucHVzaChvYnNlcnZlcik7XG4gICAgICAgIHRoaXMubm90aWZ5T2JzZXJ2ZXJfKG9ic2VydmVyKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgdGhlIGdpdmVuIG9ic2VydmVyLlxuICAgICAqL1xuICAgIFVwbG9hZFRhc2sucHJvdG90eXBlLnJlbW92ZU9ic2VydmVyXyA9IGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgICBmYnNBcnJheS5yZW1vdmUodGhpcy5vYnNlcnZlcnNfLCBvYnNlcnZlcik7XG4gICAgfTtcbiAgICBVcGxvYWRUYXNrLnByb3RvdHlwZS5ub3RpZnlPYnNlcnZlcnNfID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLmZpbmlzaFByb21pc2VfKCk7XG4gICAgICAgIHZhciBvYnNlcnZlcnMgPSBmYnNBcnJheS5jbG9uZSh0aGlzLm9ic2VydmVyc18pO1xuICAgICAgICBvYnNlcnZlcnMuZm9yRWFjaChmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgICAgICAgIF90aGlzLm5vdGlmeU9ic2VydmVyXyhvYnNlcnZlcik7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgVXBsb2FkVGFzay5wcm90b3R5cGUuZmluaXNoUHJvbWlzZV8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlc29sdmVfICE9PSBudWxsKSB7XG4gICAgICAgICAgICB2YXIgdHJpZ2dlcmVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHN3aXRjaCAoZmJzVGFza0VudW1zLnRhc2tTdGF0ZUZyb21JbnRlcm5hbFRhc2tTdGF0ZSh0aGlzLnN0YXRlXykpIHtcbiAgICAgICAgICAgICAgICBjYXNlIHRhc2tlbnVtc18yLlRhc2tTdGF0ZS5TVUNDRVNTOlxuICAgICAgICAgICAgICAgICAgICBhc3luY18xLmFzeW5jKHRoaXMucmVzb2x2ZV8uYmluZChudWxsLCB0aGlzLnNuYXBzaG90KSkoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSB0YXNrZW51bXNfMi5UYXNrU3RhdGUuQ0FOQ0VMRUQ6XG4gICAgICAgICAgICAgICAgY2FzZSB0YXNrZW51bXNfMi5UYXNrU3RhdGUuRVJST1I6XG4gICAgICAgICAgICAgICAgICAgIHZhciB0b0NhbGwgPSB0aGlzLnJlamVjdF87XG4gICAgICAgICAgICAgICAgICAgIGFzeW5jXzEuYXN5bmModG9DYWxsLmJpbmQobnVsbCwgdGhpcy5lcnJvcl8pKSgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICB0cmlnZ2VyZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHJpZ2dlcmVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXNvbHZlXyA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5yZWplY3RfID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgVXBsb2FkVGFzay5wcm90b3R5cGUubm90aWZ5T2JzZXJ2ZXJfID0gZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICAgIHZhciBleHRlcm5hbFN0YXRlID0gZmJzVGFza0VudW1zLnRhc2tTdGF0ZUZyb21JbnRlcm5hbFRhc2tTdGF0ZSh0aGlzLnN0YXRlXyk7XG4gICAgICAgIHN3aXRjaCAoZXh0ZXJuYWxTdGF0ZSkge1xuICAgICAgICAgICAgY2FzZSB0YXNrZW51bXNfMi5UYXNrU3RhdGUuUlVOTklORzpcbiAgICAgICAgICAgIGNhc2UgdGFza2VudW1zXzIuVGFza1N0YXRlLlBBVVNFRDpcbiAgICAgICAgICAgICAgICBpZiAob2JzZXJ2ZXIubmV4dCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBhc3luY18xLmFzeW5jKG9ic2VydmVyLm5leHQuYmluZChvYnNlcnZlciwgdGhpcy5zbmFwc2hvdCkpKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSB0YXNrZW51bXNfMi5UYXNrU3RhdGUuU1VDQ0VTUzpcbiAgICAgICAgICAgICAgICBpZiAob2JzZXJ2ZXIuY29tcGxldGUgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgYXN5bmNfMS5hc3luYyhvYnNlcnZlci5jb21wbGV0ZS5iaW5kKG9ic2VydmVyKSkoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIHRhc2tlbnVtc18yLlRhc2tTdGF0ZS5DQU5DRUxFRDpcbiAgICAgICAgICAgIGNhc2UgdGFza2VudW1zXzIuVGFza1N0YXRlLkVSUk9SOlxuICAgICAgICAgICAgICAgIGlmIChvYnNlcnZlci5lcnJvciAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBhc3luY18xLmFzeW5jKG9ic2VydmVyLmVycm9yLmJpbmQob2JzZXJ2ZXIsIHRoaXMuZXJyb3JfKSkoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIC8vIFRPRE8oYW5keXNvdG8pOiBhc3NlcnQoZmFsc2UpO1xuICAgICAgICAgICAgICAgIGlmIChvYnNlcnZlci5lcnJvciAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBhc3luY18xLmFzeW5jKG9ic2VydmVyLmVycm9yLmJpbmQob2JzZXJ2ZXIsIHRoaXMuZXJyb3JfKSkoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJlc3VtZXMgYSBwYXVzZWQgdGFzay4gSGFzIG5vIGVmZmVjdCBvbiBhIGN1cnJlbnRseSBydW5uaW5nIG9yIGZhaWxlZCB0YXNrLlxuICAgICAqIEByZXR1cm4gVHJ1ZSBpZiB0aGUgb3BlcmF0aW9uIHRvb2sgZWZmZWN0LCBmYWxzZSBpZiBpZ25vcmVkLlxuICAgICAqL1xuICAgIFVwbG9hZFRhc2sucHJvdG90eXBlLnJlc3VtZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZmJzQXJncy52YWxpZGF0ZSgncmVzdW1lJywgW10sIGFyZ3VtZW50cyk7XG4gICAgICAgIHZhciB2YWxpZCA9IHRoaXMuc3RhdGVfID09PSB0YXNrZW51bXNfMS5JbnRlcm5hbFRhc2tTdGF0ZS5QQVVTRUQgfHxcbiAgICAgICAgICAgIHRoaXMuc3RhdGVfID09PSB0YXNrZW51bXNfMS5JbnRlcm5hbFRhc2tTdGF0ZS5QQVVTSU5HO1xuICAgICAgICBpZiAodmFsaWQpIHtcbiAgICAgICAgICAgIHRoaXMudHJhbnNpdGlvbl8odGFza2VudW1zXzEuSW50ZXJuYWxUYXNrU3RhdGUuUlVOTklORyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbGlkO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUGF1c2VzIGEgY3VycmVudGx5IHJ1bm5pbmcgdGFzay4gSGFzIG5vIGVmZmVjdCBvbiBhIHBhdXNlZCBvciBmYWlsZWQgdGFzay5cbiAgICAgKiBAcmV0dXJuIFRydWUgaWYgdGhlIG9wZXJhdGlvbiB0b29rIGVmZmVjdCwgZmFsc2UgaWYgaWdub3JlZC5cbiAgICAgKi9cbiAgICBVcGxvYWRUYXNrLnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZmJzQXJncy52YWxpZGF0ZSgncGF1c2UnLCBbXSwgYXJndW1lbnRzKTtcbiAgICAgICAgdmFyIHZhbGlkID0gdGhpcy5zdGF0ZV8gPT09IHRhc2tlbnVtc18xLkludGVybmFsVGFza1N0YXRlLlJVTk5JTkc7XG4gICAgICAgIGlmICh2YWxpZCkge1xuICAgICAgICAgICAgdGhpcy50cmFuc2l0aW9uXyh0YXNrZW51bXNfMS5JbnRlcm5hbFRhc2tTdGF0ZS5QQVVTSU5HKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsaWQ7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBDYW5jZWxzIGEgY3VycmVudGx5IHJ1bm5pbmcgb3IgcGF1c2VkIHRhc2suIEhhcyBubyBlZmZlY3Qgb24gYSBjb21wbGV0ZSBvclxuICAgICAqIGZhaWxlZCB0YXNrLlxuICAgICAqIEByZXR1cm4gVHJ1ZSBpZiB0aGUgb3BlcmF0aW9uIHRvb2sgZWZmZWN0LCBmYWxzZSBpZiBpZ25vcmVkLlxuICAgICAqL1xuICAgIFVwbG9hZFRhc2sucHJvdG90eXBlLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZmJzQXJncy52YWxpZGF0ZSgnY2FuY2VsJywgW10sIGFyZ3VtZW50cyk7XG4gICAgICAgIHZhciB2YWxpZCA9IHRoaXMuc3RhdGVfID09PSB0YXNrZW51bXNfMS5JbnRlcm5hbFRhc2tTdGF0ZS5SVU5OSU5HIHx8XG4gICAgICAgICAgICB0aGlzLnN0YXRlXyA9PT0gdGFza2VudW1zXzEuSW50ZXJuYWxUYXNrU3RhdGUuUEFVU0lORztcbiAgICAgICAgaWYgKHZhbGlkKSB7XG4gICAgICAgICAgICB0aGlzLnRyYW5zaXRpb25fKHRhc2tlbnVtc18xLkludGVybmFsVGFza1N0YXRlLkNBTkNFTElORyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbGlkO1xuICAgIH07XG4gICAgcmV0dXJuIFVwbG9hZFRhc2s7XG59KCkpO1xuZXhwb3J0cy5VcGxvYWRUYXNrID0gVXBsb2FkVGFzaztcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGFzay5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIFVwbG9hZFRhc2tTbmFwc2hvdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBVcGxvYWRUYXNrU25hcHNob3QoYnl0ZXNUcmFuc2ZlcnJlZCwgdG90YWxCeXRlcywgc3RhdGUsIG1ldGFkYXRhLCB0YXNrLCByZWYpIHtcbiAgICAgICAgdGhpcy5ieXRlc1RyYW5zZmVycmVkID0gYnl0ZXNUcmFuc2ZlcnJlZDtcbiAgICAgICAgdGhpcy50b3RhbEJ5dGVzID0gdG90YWxCeXRlcztcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHN0YXRlO1xuICAgICAgICB0aGlzLm1ldGFkYXRhID0gbWV0YWRhdGE7XG4gICAgICAgIHRoaXMudGFzayA9IHRhc2s7XG4gICAgICAgIHRoaXMucmVmID0gcmVmO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVXBsb2FkVGFza1NuYXBzaG90LnByb3RvdHlwZSwgXCJkb3dubG9hZFVSTFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMubWV0YWRhdGEgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB2YXIgdXJscyA9IHRoaXMubWV0YWRhdGFbJ2Rvd25sb2FkVVJMcyddO1xuICAgICAgICAgICAgICAgIGlmICh1cmxzICE9IG51bGwgJiYgdXJsc1swXSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1cmxzWzBdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiBVcGxvYWRUYXNrU25hcHNob3Q7XG59KCkpO1xuZXhwb3J0cy5VcGxvYWRUYXNrU25hcHNob3QgPSBVcGxvYWRUYXNrU25hcHNob3Q7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRhc2tzbmFwc2hvdC5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9zcmMvYXNzZXJ0XCIpKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL3NyYy9jcnlwdFwiKSk7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9zcmMvY29uc3RhbnRzXCIpKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL3NyYy9kZWVwQ29weVwiKSk7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9zcmMvZGVmZXJyZWRcIikpO1xuX19leHBvcnQocmVxdWlyZShcIi4vc3JjL2Vudmlyb25tZW50XCIpKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL3NyYy9lcnJvcnNcIikpO1xuX19leHBvcnQocmVxdWlyZShcIi4vc3JjL2pzb25cIikpO1xuX19leHBvcnQocmVxdWlyZShcIi4vc3JjL2p3dFwiKSk7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9zcmMvb2JqXCIpKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL3NyYy9xdWVyeVwiKSk7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9zcmMvc2hhMVwiKSk7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9zcmMvc3Vic2NyaWJlXCIpKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL3NyYy92YWxpZGF0aW9uXCIpKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL3NyYy91dGY4XCIpKTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgY29uc3RhbnRzXzEgPSByZXF1aXJlKFwiLi9jb25zdGFudHNcIik7XG4vKipcbiAqIFRocm93cyBhbiBlcnJvciBpZiB0aGUgcHJvdmlkZWQgYXNzZXJ0aW9uIGlzIGZhbHN5XG4gKiBAcGFyYW0geyp9IGFzc2VydGlvbiBUaGUgYXNzZXJ0aW9uIHRvIGJlIHRlc3RlZCBmb3IgZmFsc2luZXNzXG4gKiBAcGFyYW0geyFzdHJpbmd9IG1lc3NhZ2UgVGhlIG1lc3NhZ2UgdG8gZGlzcGxheSBpZiB0aGUgY2hlY2sgZmFpbHNcbiAqL1xuZXhwb3J0cy5hc3NlcnQgPSBmdW5jdGlvbiAoYXNzZXJ0aW9uLCBtZXNzYWdlKSB7XG4gICAgaWYgKCFhc3NlcnRpb24pIHtcbiAgICAgICAgdGhyb3cgZXhwb3J0cy5hc3NlcnRpb25FcnJvcihtZXNzYWdlKTtcbiAgICB9XG59O1xuLyoqXG4gKiBSZXR1cm5zIGFuIEVycm9yIG9iamVjdCBzdWl0YWJsZSBmb3IgdGhyb3dpbmcuXG4gKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZVxuICogQHJldHVybiB7IUVycm9yfVxuICovXG5leHBvcnRzLmFzc2VydGlvbkVycm9yID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICByZXR1cm4gbmV3IEVycm9yKCdGaXJlYmFzZSBEYXRhYmFzZSAoJyArXG4gICAgICAgIGNvbnN0YW50c18xLkNPTlNUQU5UUy5TREtfVkVSU0lPTiArXG4gICAgICAgICcpIElOVEVSTkFMIEFTU0VSVCBGQUlMRUQ6ICcgK1xuICAgICAgICBtZXNzYWdlKTtcbn07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFzc2VydC5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbi8qKlxuICogQGZpbGVvdmVydmlldyBGaXJlYmFzZSBjb25zdGFudHMuICBTb21lIG9mIHRoZXNlIChAZGVmaW5lcykgY2FuIGJlIG92ZXJyaWRkZW4gYXQgY29tcGlsZS10aW1lLlxuICovXG5leHBvcnRzLkNPTlNUQU5UUyA9IHtcbiAgICAvKipcbiAgICAgKiBAZGVmaW5lIHtib29sZWFufSBXaGV0aGVyIHRoaXMgaXMgdGhlIGNsaWVudCBOb2RlLmpzIFNESy5cbiAgICAgKi9cbiAgICBOT0RFX0NMSUVOVDogZmFsc2UsXG4gICAgLyoqXG4gICAgICogQGRlZmluZSB7Ym9vbGVhbn0gV2hldGhlciB0aGlzIGlzIHRoZSBBZG1pbiBOb2RlLmpzIFNESy5cbiAgICAgKi9cbiAgICBOT0RFX0FETUlOOiBmYWxzZSxcbiAgICAvKipcbiAgICAgKiBGaXJlYmFzZSBTREsgVmVyc2lvblxuICAgICAqL1xuICAgIFNES19WRVJTSU9OOiAnJHtKU0NPUkVfVkVSU0lPTn0nXG59O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb25zdGFudHMuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgc3RyaW5nVG9CeXRlQXJyYXkgPSBmdW5jdGlvbiAoc3RyKSB7XG4gICAgdmFyIG91dHB1dCA9IFtdLCBwID0gMDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgYyA9IHN0ci5jaGFyQ29kZUF0KGkpO1xuICAgICAgICB3aGlsZSAoYyA+IDI1NSkge1xuICAgICAgICAgICAgb3V0cHV0W3ArK10gPSBjICYgMjU1O1xuICAgICAgICAgICAgYyA+Pj0gODtcbiAgICAgICAgfVxuICAgICAgICBvdXRwdXRbcCsrXSA9IGM7XG4gICAgfVxuICAgIHJldHVybiBvdXRwdXQ7XG59O1xuLyoqXG4gKiBUdXJucyBhbiBhcnJheSBvZiBudW1iZXJzIGludG8gdGhlIHN0cmluZyBnaXZlbiBieSB0aGUgY29uY2F0ZW5hdGlvbiBvZiB0aGVcbiAqIGNoYXJhY3RlcnMgdG8gd2hpY2ggdGhlIG51bWJlcnMgY29ycmVzcG9uZC5cbiAqIEBwYXJhbSB7QXJyYXk8bnVtYmVyPn0gYnl0ZXMgQXJyYXkgb2YgbnVtYmVycyByZXByZXNlbnRpbmcgY2hhcmFjdGVycy5cbiAqIEByZXR1cm4ge3N0cmluZ30gU3RyaW5naWZpY2F0aW9uIG9mIHRoZSBhcnJheS5cbiAqL1xudmFyIGJ5dGVBcnJheVRvU3RyaW5nID0gZnVuY3Rpb24gKGJ5dGVzKSB7XG4gICAgdmFyIENIVU5LX1NJWkUgPSA4MTkyO1xuICAgIC8vIFNwZWNpYWwtY2FzZSB0aGUgc2ltcGxlIGNhc2UgZm9yIHNwZWVkJ3Mgc2FrZS5cbiAgICBpZiAoYnl0ZXMubGVuZ3RoIDwgQ0hVTktfU0laRSkge1xuICAgICAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLCBieXRlcyk7XG4gICAgfVxuICAgIC8vIFRoZSByZW1haW5pbmcgbG9naWMgc3BsaXRzIGNvbnZlcnNpb24gYnkgY2h1bmtzIHNpbmNlXG4gICAgLy8gRnVuY3Rpb24jYXBwbHkoKSBoYXMgYSBtYXhpbXVtIHBhcmFtZXRlciBjb3VudC5cbiAgICAvLyBTZWUgZGlzY3Vzc2lvbjogaHR0cDovL2dvby5nbC9McldtWjlcbiAgICB2YXIgc3RyID0gJyc7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBieXRlcy5sZW5ndGg7IGkgKz0gQ0hVTktfU0laRSkge1xuICAgICAgICB2YXIgY2h1bmsgPSBieXRlcy5zbGljZShpLCBpICsgQ0hVTktfU0laRSk7XG4gICAgICAgIHN0ciArPSBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsIGNodW5rKTtcbiAgICB9XG4gICAgcmV0dXJuIHN0cjtcbn07XG4vLyBTdGF0aWMgbG9va3VwIG1hcHMsIGxhemlseSBwb3B1bGF0ZWQgYnkgaW5pdF8oKVxuZXhwb3J0cy5iYXNlNjQgPSB7XG4gICAgLyoqXG4gICAgICogTWFwcyBieXRlcyB0byBjaGFyYWN0ZXJzLlxuICAgICAqIEB0eXBlIHtPYmplY3R9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBieXRlVG9DaGFyTWFwXzogbnVsbCxcbiAgICAvKipcbiAgICAgKiBNYXBzIGNoYXJhY3RlcnMgdG8gYnl0ZXMuXG4gICAgICogQHR5cGUge09iamVjdH1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIGNoYXJUb0J5dGVNYXBfOiBudWxsLFxuICAgIC8qKlxuICAgICAqIE1hcHMgYnl0ZXMgdG8gd2Vic2FmZSBjaGFyYWN0ZXJzLlxuICAgICAqIEB0eXBlIHtPYmplY3R9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBieXRlVG9DaGFyTWFwV2ViU2FmZV86IG51bGwsXG4gICAgLyoqXG4gICAgICogTWFwcyB3ZWJzYWZlIGNoYXJhY3RlcnMgdG8gYnl0ZXMuXG4gICAgICogQHR5cGUge09iamVjdH1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIGNoYXJUb0J5dGVNYXBXZWJTYWZlXzogbnVsbCxcbiAgICAvKipcbiAgICAgKiBPdXIgZGVmYXVsdCBhbHBoYWJldCwgc2hhcmVkIGJldHdlZW5cbiAgICAgKiBFTkNPREVEX1ZBTFMgYW5kIEVOQ09ERURfVkFMU19XRUJTQUZFXG4gICAgICogQHR5cGUge3N0cmluZ31cbiAgICAgKi9cbiAgICBFTkNPREVEX1ZBTFNfQkFTRTogJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaJyArICdhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eicgKyAnMDEyMzQ1Njc4OScsXG4gICAgLyoqXG4gICAgICogT3VyIGRlZmF1bHQgYWxwaGFiZXQuIFZhbHVlIDY0ICg9KSBpcyBzcGVjaWFsOyBpdCBtZWFucyBcIm5vdGhpbmcuXCJcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAqL1xuICAgIGdldCBFTkNPREVEX1ZBTFMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkVOQ09ERURfVkFMU19CQVNFICsgJysvPSc7XG4gICAgfSxcbiAgICAvKipcbiAgICAgKiBPdXIgd2Vic2FmZSBhbHBoYWJldC5cbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAqL1xuICAgIGdldCBFTkNPREVEX1ZBTFNfV0VCU0FGRSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuRU5DT0RFRF9WQUxTX0JBU0UgKyAnLV8uJztcbiAgICB9LFxuICAgIC8qKlxuICAgICAqIFdoZXRoZXIgdGhpcyBicm93c2VyIHN1cHBvcnRzIHRoZSBhdG9iIGFuZCBidG9hIGZ1bmN0aW9ucy4gVGhpcyBleHRlbnNpb25cbiAgICAgKiBzdGFydGVkIGF0IE1vemlsbGEgYnV0IGlzIG5vdyBpbXBsZW1lbnRlZCBieSBtYW55IGJyb3dzZXJzLiBXZSB1c2UgdGhlXG4gICAgICogQVNTVU1FXyogdmFyaWFibGVzIHRvIGF2b2lkIHB1bGxpbmcgaW4gdGhlIGZ1bGwgdXNlcmFnZW50IGRldGVjdGlvbiBsaWJyYXJ5XG4gICAgICogYnV0IHN0aWxsIGFsbG93aW5nIHRoZSBzdGFuZGFyZCBwZXItYnJvd3NlciBjb21waWxhdGlvbnMuXG4gICAgICpcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBIQVNfTkFUSVZFX1NVUFBPUlQ6IHR5cGVvZiBhdG9iID09PSAnZnVuY3Rpb24nLFxuICAgIC8qKlxuICAgICAqIEJhc2U2NC1lbmNvZGUgYW4gYXJyYXkgb2YgYnl0ZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0FycmF5PG51bWJlcj58VWludDhBcnJheX0gaW5wdXQgQW4gYXJyYXkgb2YgYnl0ZXMgKG51bWJlcnMgd2l0aFxuICAgICAqICAgICB2YWx1ZSBpbiBbMCwgMjU1XSkgdG8gZW5jb2RlLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF93ZWJTYWZlIEJvb2xlYW4gaW5kaWNhdGluZyB3ZSBzaG91bGQgdXNlIHRoZVxuICAgICAqICAgICBhbHRlcm5hdGl2ZSBhbHBoYWJldC5cbiAgICAgKiBAcmV0dXJuIHtzdHJpbmd9IFRoZSBiYXNlNjQgZW5jb2RlZCBzdHJpbmcuXG4gICAgICovXG4gICAgZW5jb2RlQnl0ZUFycmF5OiBmdW5jdGlvbiAoaW5wdXQsIG9wdF93ZWJTYWZlKSB7XG4gICAgICAgIGlmICghQXJyYXkuaXNBcnJheShpbnB1dCkpIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKCdlbmNvZGVCeXRlQXJyYXkgdGFrZXMgYW4gYXJyYXkgYXMgYSBwYXJhbWV0ZXInKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmluaXRfKCk7XG4gICAgICAgIHZhciBieXRlVG9DaGFyTWFwID0gb3B0X3dlYlNhZmVcbiAgICAgICAgICAgID8gdGhpcy5ieXRlVG9DaGFyTWFwV2ViU2FmZV9cbiAgICAgICAgICAgIDogdGhpcy5ieXRlVG9DaGFyTWFwXztcbiAgICAgICAgdmFyIG91dHB1dCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGlucHV0Lmxlbmd0aDsgaSArPSAzKSB7XG4gICAgICAgICAgICB2YXIgYnl0ZTEgPSBpbnB1dFtpXTtcbiAgICAgICAgICAgIHZhciBoYXZlQnl0ZTIgPSBpICsgMSA8IGlucHV0Lmxlbmd0aDtcbiAgICAgICAgICAgIHZhciBieXRlMiA9IGhhdmVCeXRlMiA/IGlucHV0W2kgKyAxXSA6IDA7XG4gICAgICAgICAgICB2YXIgaGF2ZUJ5dGUzID0gaSArIDIgPCBpbnB1dC5sZW5ndGg7XG4gICAgICAgICAgICB2YXIgYnl0ZTMgPSBoYXZlQnl0ZTMgPyBpbnB1dFtpICsgMl0gOiAwO1xuICAgICAgICAgICAgdmFyIG91dEJ5dGUxID0gYnl0ZTEgPj4gMjtcbiAgICAgICAgICAgIHZhciBvdXRCeXRlMiA9ICgoYnl0ZTEgJiAweDAzKSA8PCA0KSB8IChieXRlMiA+PiA0KTtcbiAgICAgICAgICAgIHZhciBvdXRCeXRlMyA9ICgoYnl0ZTIgJiAweDBmKSA8PCAyKSB8IChieXRlMyA+PiA2KTtcbiAgICAgICAgICAgIHZhciBvdXRCeXRlNCA9IGJ5dGUzICYgMHgzZjtcbiAgICAgICAgICAgIGlmICghaGF2ZUJ5dGUzKSB7XG4gICAgICAgICAgICAgICAgb3V0Qnl0ZTQgPSA2NDtcbiAgICAgICAgICAgICAgICBpZiAoIWhhdmVCeXRlMikge1xuICAgICAgICAgICAgICAgICAgICBvdXRCeXRlMyA9IDY0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG91dHB1dC5wdXNoKGJ5dGVUb0NoYXJNYXBbb3V0Qnl0ZTFdLCBieXRlVG9DaGFyTWFwW291dEJ5dGUyXSwgYnl0ZVRvQ2hhck1hcFtvdXRCeXRlM10sIGJ5dGVUb0NoYXJNYXBbb3V0Qnl0ZTRdKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0cHV0LmpvaW4oJycpO1xuICAgIH0sXG4gICAgLyoqXG4gICAgICogQmFzZTY0LWVuY29kZSBhIHN0cmluZy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBpbnB1dCBBIHN0cmluZyB0byBlbmNvZGUuXG4gICAgICogQHBhcmFtIHtib29sZWFuPX0gb3B0X3dlYlNhZmUgSWYgdHJ1ZSwgd2Ugc2hvdWxkIHVzZSB0aGVcbiAgICAgKiAgICAgYWx0ZXJuYXRpdmUgYWxwaGFiZXQuXG4gICAgICogQHJldHVybiB7c3RyaW5nfSBUaGUgYmFzZTY0IGVuY29kZWQgc3RyaW5nLlxuICAgICAqL1xuICAgIGVuY29kZVN0cmluZzogZnVuY3Rpb24gKGlucHV0LCBvcHRfd2ViU2FmZSkge1xuICAgICAgICAvLyBTaG9ydGN1dCBmb3IgTW96aWxsYSBicm93c2VycyB0aGF0IGltcGxlbWVudFxuICAgICAgICAvLyBhIG5hdGl2ZSBiYXNlNjQgZW5jb2RlciBpbiB0aGUgZm9ybSBvZiBcImJ0b2EvYXRvYlwiXG4gICAgICAgIGlmICh0aGlzLkhBU19OQVRJVkVfU1VQUE9SVCAmJiAhb3B0X3dlYlNhZmUpIHtcbiAgICAgICAgICAgIHJldHVybiBidG9hKGlucHV0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5lbmNvZGVCeXRlQXJyYXkoc3RyaW5nVG9CeXRlQXJyYXkoaW5wdXQpLCBvcHRfd2ViU2FmZSk7XG4gICAgfSxcbiAgICAvKipcbiAgICAgKiBCYXNlNjQtZGVjb2RlIGEgc3RyaW5nLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGlucHV0IHRvIGRlY29kZS5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfd2ViU2FmZSBUcnVlIGlmIHdlIHNob3VsZCB1c2UgdGhlXG4gICAgICogICAgIGFsdGVybmF0aXZlIGFscGhhYmV0LlxuICAgICAqIEByZXR1cm4ge3N0cmluZ30gc3RyaW5nIHJlcHJlc2VudGluZyB0aGUgZGVjb2RlZCB2YWx1ZS5cbiAgICAgKi9cbiAgICBkZWNvZGVTdHJpbmc6IGZ1bmN0aW9uIChpbnB1dCwgb3B0X3dlYlNhZmUpIHtcbiAgICAgICAgLy8gU2hvcnRjdXQgZm9yIE1vemlsbGEgYnJvd3NlcnMgdGhhdCBpbXBsZW1lbnRcbiAgICAgICAgLy8gYSBuYXRpdmUgYmFzZTY0IGVuY29kZXIgaW4gdGhlIGZvcm0gb2YgXCJidG9hL2F0b2JcIlxuICAgICAgICBpZiAodGhpcy5IQVNfTkFUSVZFX1NVUFBPUlQgJiYgIW9wdF93ZWJTYWZlKSB7XG4gICAgICAgICAgICByZXR1cm4gYXRvYihpbnB1dCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGJ5dGVBcnJheVRvU3RyaW5nKHRoaXMuZGVjb2RlU3RyaW5nVG9CeXRlQXJyYXkoaW5wdXQsIG9wdF93ZWJTYWZlKSk7XG4gICAgfSxcbiAgICAvKipcbiAgICAgKiBCYXNlNjQtZGVjb2RlIGEgc3RyaW5nLlxuICAgICAqXG4gICAgICogSW4gYmFzZS02NCBkZWNvZGluZywgZ3JvdXBzIG9mIGZvdXIgY2hhcmFjdGVycyBhcmUgY29udmVydGVkIGludG8gdGhyZWVcbiAgICAgKiBieXRlcy4gIElmIHRoZSBlbmNvZGVyIGRpZCBub3QgYXBwbHkgcGFkZGluZywgdGhlIGlucHV0IGxlbmd0aCBtYXkgbm90XG4gICAgICogYmUgYSBtdWx0aXBsZSBvZiA0LlxuICAgICAqXG4gICAgICogSW4gdGhpcyBjYXNlLCB0aGUgbGFzdCBncm91cCB3aWxsIGhhdmUgZmV3ZXIgdGhhbiA0IGNoYXJhY3RlcnMsIGFuZFxuICAgICAqIHBhZGRpbmcgd2lsbCBiZSBpbmZlcnJlZC4gIElmIHRoZSBncm91cCBoYXMgb25lIG9yIHR3byBjaGFyYWN0ZXJzLCBpdCBkZWNvZGVzXG4gICAgICogdG8gb25lIGJ5dGUuICBJZiB0aGUgZ3JvdXAgaGFzIHRocmVlIGNoYXJhY3RlcnMsIGl0IGRlY29kZXMgdG8gdHdvIGJ5dGVzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGlucHV0IElucHV0IHRvIGRlY29kZS5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfd2ViU2FmZSBUcnVlIGlmIHdlIHNob3VsZCB1c2UgdGhlIHdlYi1zYWZlIGFscGhhYmV0LlxuICAgICAqIEByZXR1cm4geyFBcnJheTxudW1iZXI+fSBieXRlcyByZXByZXNlbnRpbmcgdGhlIGRlY29kZWQgdmFsdWUuXG4gICAgICovXG4gICAgZGVjb2RlU3RyaW5nVG9CeXRlQXJyYXk6IGZ1bmN0aW9uIChpbnB1dCwgb3B0X3dlYlNhZmUpIHtcbiAgICAgICAgdGhpcy5pbml0XygpO1xuICAgICAgICB2YXIgY2hhclRvQnl0ZU1hcCA9IG9wdF93ZWJTYWZlXG4gICAgICAgICAgICA/IHRoaXMuY2hhclRvQnl0ZU1hcFdlYlNhZmVfXG4gICAgICAgICAgICA6IHRoaXMuY2hhclRvQnl0ZU1hcF87XG4gICAgICAgIHZhciBvdXRwdXQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbnB1dC5sZW5ndGg7KSB7XG4gICAgICAgICAgICB2YXIgYnl0ZTEgPSBjaGFyVG9CeXRlTWFwW2lucHV0LmNoYXJBdChpKyspXTtcbiAgICAgICAgICAgIHZhciBoYXZlQnl0ZTIgPSBpIDwgaW5wdXQubGVuZ3RoO1xuICAgICAgICAgICAgdmFyIGJ5dGUyID0gaGF2ZUJ5dGUyID8gY2hhclRvQnl0ZU1hcFtpbnB1dC5jaGFyQXQoaSldIDogMDtcbiAgICAgICAgICAgICsraTtcbiAgICAgICAgICAgIHZhciBoYXZlQnl0ZTMgPSBpIDwgaW5wdXQubGVuZ3RoO1xuICAgICAgICAgICAgdmFyIGJ5dGUzID0gaGF2ZUJ5dGUzID8gY2hhclRvQnl0ZU1hcFtpbnB1dC5jaGFyQXQoaSldIDogNjQ7XG4gICAgICAgICAgICArK2k7XG4gICAgICAgICAgICB2YXIgaGF2ZUJ5dGU0ID0gaSA8IGlucHV0Lmxlbmd0aDtcbiAgICAgICAgICAgIHZhciBieXRlNCA9IGhhdmVCeXRlNCA/IGNoYXJUb0J5dGVNYXBbaW5wdXQuY2hhckF0KGkpXSA6IDY0O1xuICAgICAgICAgICAgKytpO1xuICAgICAgICAgICAgaWYgKGJ5dGUxID09IG51bGwgfHwgYnl0ZTIgPT0gbnVsbCB8fCBieXRlMyA9PSBudWxsIHx8IGJ5dGU0ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBFcnJvcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG91dEJ5dGUxID0gKGJ5dGUxIDw8IDIpIHwgKGJ5dGUyID4+IDQpO1xuICAgICAgICAgICAgb3V0cHV0LnB1c2gob3V0Qnl0ZTEpO1xuICAgICAgICAgICAgaWYgKGJ5dGUzICE9IDY0KSB7XG4gICAgICAgICAgICAgICAgdmFyIG91dEJ5dGUyID0gKChieXRlMiA8PCA0KSAmIDB4ZjApIHwgKGJ5dGUzID4+IDIpO1xuICAgICAgICAgICAgICAgIG91dHB1dC5wdXNoKG91dEJ5dGUyKTtcbiAgICAgICAgICAgICAgICBpZiAoYnl0ZTQgIT0gNjQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG91dEJ5dGUzID0gKChieXRlMyA8PCA2KSAmIDB4YzApIHwgYnl0ZTQ7XG4gICAgICAgICAgICAgICAgICAgIG91dHB1dC5wdXNoKG91dEJ5dGUzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9LFxuICAgIC8qKlxuICAgICAqIExhenkgc3RhdGljIGluaXRpYWxpemF0aW9uIGZ1bmN0aW9uLiBDYWxsZWQgYmVmb3JlXG4gICAgICogYWNjZXNzaW5nIGFueSBvZiB0aGUgc3RhdGljIG1hcCB2YXJpYWJsZXMuXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBpbml0XzogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuYnl0ZVRvQ2hhck1hcF8pIHtcbiAgICAgICAgICAgIHRoaXMuYnl0ZVRvQ2hhck1hcF8gPSB7fTtcbiAgICAgICAgICAgIHRoaXMuY2hhclRvQnl0ZU1hcF8gPSB7fTtcbiAgICAgICAgICAgIHRoaXMuYnl0ZVRvQ2hhck1hcFdlYlNhZmVfID0ge307XG4gICAgICAgICAgICB0aGlzLmNoYXJUb0J5dGVNYXBXZWJTYWZlXyA9IHt9O1xuICAgICAgICAgICAgLy8gV2Ugd2FudCBxdWljayBtYXBwaW5ncyBiYWNrIGFuZCBmb3J0aCwgc28gd2UgcHJlY29tcHV0ZSB0d28gbWFwcy5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5FTkNPREVEX1ZBTFMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB0aGlzLmJ5dGVUb0NoYXJNYXBfW2ldID0gdGhpcy5FTkNPREVEX1ZBTFMuY2hhckF0KGkpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2hhclRvQnl0ZU1hcF9bdGhpcy5ieXRlVG9DaGFyTWFwX1tpXV0gPSBpO1xuICAgICAgICAgICAgICAgIHRoaXMuYnl0ZVRvQ2hhck1hcFdlYlNhZmVfW2ldID0gdGhpcy5FTkNPREVEX1ZBTFNfV0VCU0FGRS5jaGFyQXQoaSk7XG4gICAgICAgICAgICAgICAgdGhpcy5jaGFyVG9CeXRlTWFwV2ViU2FmZV9bdGhpcy5ieXRlVG9DaGFyTWFwV2ViU2FmZV9baV1dID0gaTtcbiAgICAgICAgICAgICAgICAvLyBCZSBmb3JnaXZpbmcgd2hlbiBkZWNvZGluZyBhbmQgY29ycmVjdGx5IGRlY29kZSBib3RoIGVuY29kaW5ncy5cbiAgICAgICAgICAgICAgICBpZiAoaSA+PSB0aGlzLkVOQ09ERURfVkFMU19CQVNFLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNoYXJUb0J5dGVNYXBfW3RoaXMuRU5DT0RFRF9WQUxTX1dFQlNBRkUuY2hhckF0KGkpXSA9IGk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhclRvQnl0ZU1hcFdlYlNhZmVfW3RoaXMuRU5DT0RFRF9WQUxTLmNoYXJBdChpKV0gPSBpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn07XG4vKipcbiAqIFVSTC1zYWZlIGJhc2U2NCBlbmNvZGluZ1xuICogQHBhcmFtIHshc3RyaW5nfSBzdHJcbiAqIEByZXR1cm4geyFzdHJpbmd9XG4gKi9cbmV4cG9ydHMuYmFzZTY0RW5jb2RlID0gZnVuY3Rpb24gKHN0cikge1xuICAgIHZhciB1dGY4Qnl0ZXMgPSBzdHJpbmdUb0J5dGVBcnJheShzdHIpO1xuICAgIHJldHVybiBleHBvcnRzLmJhc2U2NC5lbmNvZGVCeXRlQXJyYXkodXRmOEJ5dGVzLCB0cnVlKTtcbn07XG4vKipcbiAqIFVSTC1zYWZlIGJhc2U2NCBkZWNvZGluZ1xuICpcbiAqIE5PVEU6IERPIE5PVCB1c2UgdGhlIGdsb2JhbCBhdG9iKCkgZnVuY3Rpb24gLSBpdCBkb2VzIE5PVCBzdXBwb3J0IHRoZVxuICogYmFzZTY0VXJsIHZhcmlhbnQgZW5jb2RpbmcuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHN0ciBUbyBiZSBkZWNvZGVkXG4gKiBAcmV0dXJuIHs/c3RyaW5nfSBEZWNvZGVkIHJlc3VsdCwgaWYgcG9zc2libGVcbiAqL1xuZXhwb3J0cy5iYXNlNjREZWNvZGUgPSBmdW5jdGlvbiAoc3RyKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIGV4cG9ydHMuYmFzZTY0LmRlY29kZVN0cmluZyhzdHIsIHRydWUpO1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdiYXNlNjREZWNvZGUgZmFpbGVkOiAnLCBlKTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1jcnlwdC5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbi8qKlxuICogRG8gYSBkZWVwLWNvcHkgb2YgYmFzaWMgSmF2YVNjcmlwdCBPYmplY3RzIG9yIEFycmF5cy5cbiAqL1xuZnVuY3Rpb24gZGVlcENvcHkodmFsdWUpIHtcbiAgICByZXR1cm4gZGVlcEV4dGVuZCh1bmRlZmluZWQsIHZhbHVlKTtcbn1cbmV4cG9ydHMuZGVlcENvcHkgPSBkZWVwQ29weTtcbi8qKlxuICogQ29weSBwcm9wZXJ0aWVzIGZyb20gc291cmNlIHRvIHRhcmdldCAocmVjdXJzaXZlbHkgYWxsb3dzIGV4dGVuc2lvblxuICogb2YgT2JqZWN0cyBhbmQgQXJyYXlzKS4gIFNjYWxhciB2YWx1ZXMgaW4gdGhlIHRhcmdldCBhcmUgb3Zlci13cml0dGVuLlxuICogSWYgdGFyZ2V0IGlzIHVuZGVmaW5lZCwgYW4gb2JqZWN0IG9mIHRoZSBhcHByb3ByaWF0ZSB0eXBlIHdpbGwgYmUgY3JlYXRlZFxuICogKGFuZCByZXR1cm5lZCkuXG4gKlxuICogV2UgcmVjdXJzaXZlbHkgY29weSBhbGwgY2hpbGQgcHJvcGVydGllcyBvZiBwbGFpbiBPYmplY3RzIGluIHRoZSBzb3VyY2UtIHNvXG4gKiB0aGF0IG5hbWVzcGFjZS0gbGlrZSBkaWN0aW9uYXJpZXMgYXJlIG1lcmdlZC5cbiAqXG4gKiBOb3RlIHRoYXQgdGhlIHRhcmdldCBjYW4gYmUgYSBmdW5jdGlvbiwgaW4gd2hpY2ggY2FzZSB0aGUgcHJvcGVydGllcyBpblxuICogdGhlIHNvdXJjZSBPYmplY3QgYXJlIGNvcGllZCBvbnRvIGl0IGFzIHN0YXRpYyBwcm9wZXJ0aWVzIG9mIHRoZSBGdW5jdGlvbi5cbiAqL1xuZnVuY3Rpb24gZGVlcEV4dGVuZCh0YXJnZXQsIHNvdXJjZSkge1xuICAgIGlmICghKHNvdXJjZSBpbnN0YW5jZW9mIE9iamVjdCkpIHtcbiAgICAgICAgcmV0dXJuIHNvdXJjZTtcbiAgICB9XG4gICAgc3dpdGNoIChzb3VyY2UuY29uc3RydWN0b3IpIHtcbiAgICAgICAgY2FzZSBEYXRlOlxuICAgICAgICAgICAgLy8gVHJlYXQgRGF0ZXMgbGlrZSBzY2FsYXJzOyBpZiB0aGUgdGFyZ2V0IGRhdGUgb2JqZWN0IGhhZCBhbnkgY2hpbGRcbiAgICAgICAgICAgIC8vIHByb3BlcnRpZXMgLSB0aGV5IHdpbGwgYmUgbG9zdCFcbiAgICAgICAgICAgIHZhciBkYXRlVmFsdWUgPSBzb3VyY2U7XG4gICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoZGF0ZVZhbHVlLmdldFRpbWUoKSk7XG4gICAgICAgIGNhc2UgT2JqZWN0OlxuICAgICAgICAgICAgaWYgKHRhcmdldCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0ge307XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBBcnJheTpcbiAgICAgICAgICAgIC8vIEFsd2F5cyBjb3B5IHRoZSBhcnJheSBzb3VyY2UgYW5kIG92ZXJ3cml0ZSB0aGUgdGFyZ2V0LlxuICAgICAgICAgICAgdGFyZ2V0ID0gW107XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIC8vIE5vdCBhIHBsYWluIE9iamVjdCAtIHRyZWF0IGl0IGFzIGEgc2NhbGFyLlxuICAgICAgICAgICAgcmV0dXJuIHNvdXJjZTtcbiAgICB9XG4gICAgZm9yICh2YXIgcHJvcCBpbiBzb3VyY2UpIHtcbiAgICAgICAgaWYgKCFzb3VyY2UuaGFzT3duUHJvcGVydHkocHJvcCkpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIHRhcmdldFtwcm9wXSA9IGRlZXBFeHRlbmQodGFyZ2V0W3Byb3BdLCBzb3VyY2VbcHJvcF0pO1xuICAgIH1cbiAgICByZXR1cm4gdGFyZ2V0O1xufVxuZXhwb3J0cy5kZWVwRXh0ZW5kID0gZGVlcEV4dGVuZDtcbi8vIFRPRE86IFJlYWxseSBuZWVkZWQgKGZvciBKU0NvbXBpbGVyIHR5cGUgY2hlY2tpbmcpP1xuZnVuY3Rpb24gcGF0Y2hQcm9wZXJ0eShvYmosIHByb3AsIHZhbHVlKSB7XG4gICAgb2JqW3Byb3BdID0gdmFsdWU7XG59XG5leHBvcnRzLnBhdGNoUHJvcGVydHkgPSBwYXRjaFByb3BlcnR5O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1kZWVwQ29weS5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBEZWZlcnJlZCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBEZWZlcnJlZCgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5wcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgX3RoaXMucmVzb2x2ZSA9IHJlc29sdmU7XG4gICAgICAgICAgICBfdGhpcy5yZWplY3QgPSByZWplY3Q7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAqIE91ciBBUEkgaW50ZXJuYWxzIGFyZSBub3QgcHJvbWlzZWlmaWVkIGFuZCBjYW5ub3QgYmVjYXVzZSBvdXIgY2FsbGJhY2sgQVBJcyBoYXZlIHN1YnRsZSBleHBlY3RhdGlvbnMgYXJvdW5kXG4gICAgKiBpbnZva2luZyBwcm9taXNlcyBpbmxpbmUsIHdoaWNoIFByb21pc2VzIGFyZSBmb3JiaWRkZW4gdG8gZG8uIFRoaXMgbWV0aG9kIGFjY2VwdHMgYW4gb3B0aW9uYWwgbm9kZS1zdHlsZSBjYWxsYmFja1xuICAgICogYW5kIHJldHVybnMgYSBub2RlLXN0eWxlIGNhbGxiYWNrIHdoaWNoIHdpbGwgcmVzb2x2ZSBvciByZWplY3QgdGhlIERlZmVycmVkJ3MgcHJvbWlzZS5cbiAgICAqIEBwYXJhbSB7KCg/ZnVuY3Rpb24oPyhFcnJvcikpOiAoP3x1bmRlZmluZWQpKXwgKD9mdW5jdGlvbig/KEVycm9yKSw/PSk6ICg/fHVuZGVmaW5lZCkpKT19IGNhbGxiYWNrXG4gICAgKiBAcmV0dXJuIHshZnVuY3Rpb24oPyhFcnJvciksID89KX1cbiAgICAqL1xuICAgIERlZmVycmVkLnByb3RvdHlwZS53cmFwQ2FsbGJhY2sgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChlcnJvciwgdmFsdWUpIHtcbiAgICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgICAgIF90aGlzLnJlamVjdChlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5yZXNvbHZlKHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAvLyBBdHRhY2hpbmcgbm9vcCBoYW5kbGVyIGp1c3QgaW4gY2FzZSBkZXZlbG9wZXIgd2Fzbid0IGV4cGVjdGluZ1xuICAgICAgICAgICAgICAgIC8vIHByb21pc2VzXG4gICAgICAgICAgICAgICAgX3RoaXMucHJvbWlzZS5jYXRjaChmdW5jdGlvbiAoKSB7IH0pO1xuICAgICAgICAgICAgICAgIC8vIFNvbWUgb2Ygb3VyIGNhbGxiYWNrcyBkb24ndCBleHBlY3QgYSB2YWx1ZSBhbmQgb3VyIG93biB0ZXN0c1xuICAgICAgICAgICAgICAgIC8vIGFzc2VydCB0aGF0IHRoZSBwYXJhbWV0ZXIgbGVuZ3RoIGlzIDFcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2subGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKGVycm9yLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH07XG4gICAgcmV0dXJuIERlZmVycmVkO1xufSgpKTtcbmV4cG9ydHMuRGVmZXJyZWQgPSBEZWZlcnJlZDtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGVmZXJyZWQuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgY29uc3RhbnRzXzEgPSByZXF1aXJlKFwiLi9jb25zdGFudHNcIik7XG4vKipcbiAqIFJldHVybnMgbmF2aWdhdG9yLnVzZXJBZ2VudCBzdHJpbmcgb3IgJycgaWYgaXQncyBub3QgZGVmaW5lZC5cbiAqIEByZXR1cm4ge3N0cmluZ30gdXNlciBhZ2VudCBzdHJpbmdcbiAqL1xuZXhwb3J0cy5nZXRVQSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodHlwZW9mIG5hdmlnYXRvciAhPT0gJ3VuZGVmaW5lZCcgJiZcbiAgICAgICAgdHlwZW9mIG5hdmlnYXRvclsndXNlckFnZW50J10gPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHJldHVybiBuYXZpZ2F0b3JbJ3VzZXJBZ2VudCddO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH1cbn07XG4vKipcbiAqIERldGVjdCBDb3Jkb3ZhIC8gUGhvbmVHYXAgLyBJb25pYyBmcmFtZXdvcmtzIG9uIGEgbW9iaWxlIGRldmljZS5cbiAqXG4gKiBEZWxpYmVyYXRlbHkgZG9lcyBub3QgcmVseSBvbiBjaGVja2luZyBgZmlsZTovL2AgVVJMcyAoYXMgdGhpcyBmYWlscyBQaG9uZUdhcCBpbiB0aGUgUmlwcGxlIGVtdWxhdG9yKSBub3JcbiAqIENvcmRvdmEgYG9uRGV2aWNlUmVhZHlgLCB3aGljaCB3b3VsZCBub3JtYWxseSB3YWl0IGZvciBhIGNhbGxiYWNrLlxuICpcbiAqIEByZXR1cm4ge2Jvb2xlYW59IGlzTW9iaWxlQ29yZG92YVxuICovXG5leHBvcnRzLmlzTW9iaWxlQ29yZG92YSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmXG4gICAgICAgICEhKHdpbmRvd1snY29yZG92YSddIHx8IHdpbmRvd1sncGhvbmVnYXAnXSB8fCB3aW5kb3dbJ1Bob25lR2FwJ10pICYmXG4gICAgICAgIC9pb3N8aXBob25lfGlwb2R8aXBhZHxhbmRyb2lkfGJsYWNrYmVycnl8aWVtb2JpbGUvaS50ZXN0KGV4cG9ydHMuZ2V0VUEoKSkpO1xufTtcbi8qKlxuICogRGV0ZWN0IFJlYWN0IE5hdGl2ZS5cbiAqXG4gKiBAcmV0dXJuIHtib29sZWFufSBUcnVlIGlmIFJlYWN0TmF0aXZlIGVudmlyb25tZW50IGlzIGRldGVjdGVkLlxuICovXG5leHBvcnRzLmlzUmVhY3ROYXRpdmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuICh0eXBlb2YgbmF2aWdhdG9yID09PSAnb2JqZWN0JyAmJiBuYXZpZ2F0b3JbJ3Byb2R1Y3QnXSA9PT0gJ1JlYWN0TmF0aXZlJyk7XG59O1xuLyoqXG4gKiBEZXRlY3QgTm9kZS5qcy5cbiAqXG4gKiBAcmV0dXJuIHtib29sZWFufSBUcnVlIGlmIE5vZGUuanMgZW52aXJvbm1lbnQgaXMgZGV0ZWN0ZWQuXG4gKi9cbmV4cG9ydHMuaXNOb2RlU2RrID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBjb25zdGFudHNfMS5DT05TVEFOVFMuTk9ERV9DTElFTlQgPT09IHRydWUgfHwgY29uc3RhbnRzXzEuQ09OU1RBTlRTLk5PREVfQURNSU4gPT09IHRydWU7XG59O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1lbnZpcm9ubWVudC5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIEVSUk9SX05BTUUgPSAnRmlyZWJhc2VFcnJvcic7XG52YXIgY2FwdHVyZVN0YWNrVHJhY2UgPSBFcnJvclxuICAgIC5jYXB0dXJlU3RhY2tUcmFjZTtcbi8vIEV4cG9ydCBmb3IgZmFraW5nIGluIHRlc3RzXG5mdW5jdGlvbiBwYXRjaENhcHR1cmUoY2FwdHVyZUZha2UpIHtcbiAgICB2YXIgcmVzdWx0ID0gY2FwdHVyZVN0YWNrVHJhY2U7XG4gICAgY2FwdHVyZVN0YWNrVHJhY2UgPSBjYXB0dXJlRmFrZTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZXhwb3J0cy5wYXRjaENhcHR1cmUgPSBwYXRjaENhcHR1cmU7XG52YXIgRmlyZWJhc2VFcnJvciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBGaXJlYmFzZUVycm9yKGNvZGUsIG1lc3NhZ2UpIHtcbiAgICAgICAgdGhpcy5jb2RlID0gY29kZTtcbiAgICAgICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZTtcbiAgICAgICAgdmFyIHN0YWNrO1xuICAgICAgICAvLyBXZSB3YW50IHRoZSBzdGFjayB2YWx1ZSwgaWYgaW1wbGVtZW50ZWQgYnkgRXJyb3JcbiAgICAgICAgaWYgKGNhcHR1cmVTdGFja1RyYWNlKSB7XG4gICAgICAgICAgICAvLyBQYXRjaGVzIHRoaXMuc3RhY2ssIG9taXR0ZWQgY2FsbHMgYWJvdmUgRXJyb3JGYWN0b3J5I2NyZWF0ZVxuICAgICAgICAgICAgY2FwdHVyZVN0YWNrVHJhY2UodGhpcywgRXJyb3JGYWN0b3J5LnByb3RvdHlwZS5jcmVhdGUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIGVycl8xID0gRXJyb3IuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIHRoaXMubmFtZSA9IEVSUk9SX05BTUU7XG4gICAgICAgICAgICAvLyBNYWtlIG5vbi1lbnVtZXJhYmxlIGdldHRlciBmb3IgdGhlIHByb3BlcnR5LlxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICdzdGFjaycsIHtcbiAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVycl8xLnN0YWNrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBGaXJlYmFzZUVycm9yO1xufSgpKTtcbmV4cG9ydHMuRmlyZWJhc2VFcnJvciA9IEZpcmViYXNlRXJyb3I7XG4vLyBCYWNrLWRvb3IgaW5oZXJpdGFuY2VcbkZpcmViYXNlRXJyb3IucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpO1xuRmlyZWJhc2VFcnJvci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBGaXJlYmFzZUVycm9yO1xuRmlyZWJhc2VFcnJvci5wcm90b3R5cGUubmFtZSA9IEVSUk9SX05BTUU7XG52YXIgRXJyb3JGYWN0b3J5ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEVycm9yRmFjdG9yeShzZXJ2aWNlLCBzZXJ2aWNlTmFtZSwgZXJyb3JzKSB7XG4gICAgICAgIHRoaXMuc2VydmljZSA9IHNlcnZpY2U7XG4gICAgICAgIHRoaXMuc2VydmljZU5hbWUgPSBzZXJ2aWNlTmFtZTtcbiAgICAgICAgdGhpcy5lcnJvcnMgPSBlcnJvcnM7XG4gICAgICAgIC8vIE1hdGNoZXMgeyRuYW1lfSwgYnkgZGVmYXVsdC5cbiAgICAgICAgdGhpcy5wYXR0ZXJuID0gL1xce1xcJChbXn1dKyl9L2c7XG4gICAgICAgIC8vIGVtcHR5XG4gICAgfVxuICAgIEVycm9yRmFjdG9yeS5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24gKGNvZGUsIGRhdGEpIHtcbiAgICAgICAgaWYgKGRhdGEgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgZGF0YSA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIHZhciB0ZW1wbGF0ZSA9IHRoaXMuZXJyb3JzW2NvZGVdO1xuICAgICAgICB2YXIgZnVsbENvZGUgPSB0aGlzLnNlcnZpY2UgKyAnLycgKyBjb2RlO1xuICAgICAgICB2YXIgbWVzc2FnZTtcbiAgICAgICAgaWYgKHRlbXBsYXRlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIG1lc3NhZ2UgPSAnRXJyb3InO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbWVzc2FnZSA9IHRlbXBsYXRlLnJlcGxhY2UodGhpcy5wYXR0ZXJuLCBmdW5jdGlvbiAobWF0Y2gsIGtleSkge1xuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGRhdGFba2V5XTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUgIT09IHVuZGVmaW5lZCA/IHZhbHVlLnRvU3RyaW5nKCkgOiAnPCcgKyBrZXkgKyAnPz4nO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gU2VydmljZTogRXJyb3IgbWVzc2FnZSAoc2VydmljZS9jb2RlKS5cbiAgICAgICAgbWVzc2FnZSA9IHRoaXMuc2VydmljZU5hbWUgKyAnOiAnICsgbWVzc2FnZSArICcgKCcgKyBmdWxsQ29kZSArICcpLic7XG4gICAgICAgIHZhciBlcnIgPSBuZXcgRmlyZWJhc2VFcnJvcihmdWxsQ29kZSwgbWVzc2FnZSk7XG4gICAgICAgIC8vIFBvcHVsYXRlIHRoZSBFcnJvciBvYmplY3Qgd2l0aCBtZXNzYWdlIHBhcnRzIGZvciBwcm9ncmFtbWF0aWNcbiAgICAgICAgLy8gYWNjZXNzZXMgKGUuZy4sIGUuZmlsZSkuXG4gICAgICAgIGZvciAodmFyIHByb3AgaW4gZGF0YSkge1xuICAgICAgICAgICAgaWYgKCFkYXRhLmhhc093blByb3BlcnR5KHByb3ApIHx8IHByb3Auc2xpY2UoLTEpID09PSAnXycpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVycltwcm9wXSA9IGRhdGFbcHJvcF07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGVycjtcbiAgICB9O1xuICAgIHJldHVybiBFcnJvckZhY3Rvcnk7XG59KCkpO1xuZXhwb3J0cy5FcnJvckZhY3RvcnkgPSBFcnJvckZhY3Rvcnk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWVycm9ycy5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbi8vIENvcHlyaWdodCAyMDExIFRoZSBDbG9zdXJlIExpYnJhcnkgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbi8vXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuLy8geW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuLy8gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4vL1xuLy8gICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbi8vXG4vLyBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4vLyBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4vLyBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbi8vIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbi8vIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuLyoqXG4gKiBAZmlsZW92ZXJ2aWV3IEFic3RyYWN0IGNyeXB0b2dyYXBoaWMgaGFzaCBpbnRlcmZhY2UuXG4gKlxuICogU2VlIFNoYTEgYW5kIE1kNSBmb3Igc2FtcGxlIGltcGxlbWVudGF0aW9ucy5cbiAqXG4gKi9cbi8qKlxuICogQ3JlYXRlIGEgY3J5cHRvZ3JhcGhpYyBoYXNoIGluc3RhbmNlLlxuICpcbiAqIEBjb25zdHJ1Y3RvclxuICogQHN0cnVjdFxuICovXG52YXIgSGFzaCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBIYXNoKCkge1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGJsb2NrIHNpemUgZm9yIHRoZSBoYXNoZXIuXG4gICAgICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmJsb2NrU2l6ZSA9IC0xO1xuICAgIH1cbiAgICByZXR1cm4gSGFzaDtcbn0oKSk7XG5leHBvcnRzLkhhc2ggPSBIYXNoO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1oYXNoLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuLyoqXG4gKiBFdmFsdWF0ZXMgYSBKU09OIHN0cmluZyBpbnRvIGEgamF2YXNjcmlwdCBvYmplY3QuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHN0ciBBIHN0cmluZyBjb250YWluaW5nIEpTT04uXG4gKiBAcmV0dXJuIHsqfSBUaGUgamF2YXNjcmlwdCBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBzcGVjaWZpZWQgSlNPTi5cbiAqL1xuZnVuY3Rpb24ganNvbkV2YWwoc3RyKSB7XG4gICAgcmV0dXJuIEpTT04ucGFyc2Uoc3RyKTtcbn1cbmV4cG9ydHMuanNvbkV2YWwgPSBqc29uRXZhbDtcbi8qKlxuICogUmV0dXJucyBKU09OIHJlcHJlc2VudGluZyBhIGphdmFzY3JpcHQgb2JqZWN0LlxuICogQHBhcmFtIHsqfSBkYXRhIEphdmFzY3JpcHQgb2JqZWN0IHRvIGJlIHN0cmluZ2lmaWVkLlxuICogQHJldHVybiB7c3RyaW5nfSBUaGUgSlNPTiBjb250ZW50cyBvZiB0aGUgb2JqZWN0LlxuICovXG5mdW5jdGlvbiBzdHJpbmdpZnkoZGF0YSkge1xuICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShkYXRhKTtcbn1cbmV4cG9ydHMuc3RyaW5naWZ5ID0gc3RyaW5naWZ5O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1qc29uLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGNyeXB0XzEgPSByZXF1aXJlKFwiLi9jcnlwdFwiKTtcbnZhciBqc29uXzEgPSByZXF1aXJlKFwiLi9qc29uXCIpO1xuLyoqXG4gKiBEZWNvZGVzIGEgRmlyZWJhc2UgYXV0aC4gdG9rZW4gaW50byBjb25zdGl0dWVudCBwYXJ0cy5cbiAqXG4gKiBOb3RlczpcbiAqIC0gTWF5IHJldHVybiB3aXRoIGludmFsaWQgLyBpbmNvbXBsZXRlIGNsYWltcyBpZiB0aGVyZSdzIG5vIG5hdGl2ZSBiYXNlNjQgZGVjb2Rpbmcgc3VwcG9ydC5cbiAqIC0gRG9lc24ndCBjaGVjayBpZiB0aGUgdG9rZW4gaXMgYWN0dWFsbHkgdmFsaWQuXG4gKlxuICogQHBhcmFtIHs/c3RyaW5nfSB0b2tlblxuICogQHJldHVybiB7e2hlYWRlcjogKiwgY2xhaW1zOiAqLCBkYXRhOiAqLCBzaWduYXR1cmU6IHN0cmluZ319XG4gKi9cbmV4cG9ydHMuZGVjb2RlID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgdmFyIGhlYWRlciA9IHt9LCBjbGFpbXMgPSB7fSwgZGF0YSA9IHt9LCBzaWduYXR1cmUgPSAnJztcbiAgICB0cnkge1xuICAgICAgICB2YXIgcGFydHMgPSB0b2tlbi5zcGxpdCgnLicpO1xuICAgICAgICBoZWFkZXIgPSBqc29uXzEuanNvbkV2YWwoY3J5cHRfMS5iYXNlNjREZWNvZGUocGFydHNbMF0pIHx8ICcnKTtcbiAgICAgICAgY2xhaW1zID0ganNvbl8xLmpzb25FdmFsKGNyeXB0XzEuYmFzZTY0RGVjb2RlKHBhcnRzWzFdKSB8fCAnJyk7XG4gICAgICAgIHNpZ25hdHVyZSA9IHBhcnRzWzJdO1xuICAgICAgICBkYXRhID0gY2xhaW1zWydkJ10gfHwge307XG4gICAgICAgIGRlbGV0ZSBjbGFpbXNbJ2QnXTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHsgfVxuICAgIHJldHVybiB7XG4gICAgICAgIGhlYWRlcjogaGVhZGVyLFxuICAgICAgICBjbGFpbXM6IGNsYWltcyxcbiAgICAgICAgZGF0YTogZGF0YSxcbiAgICAgICAgc2lnbmF0dXJlOiBzaWduYXR1cmVcbiAgICB9O1xufTtcbi8qKlxuICogRGVjb2RlcyBhIEZpcmViYXNlIGF1dGguIHRva2VuIGFuZCBjaGVja3MgdGhlIHZhbGlkaXR5IG9mIGl0cyB0aW1lLWJhc2VkIGNsYWltcy4gV2lsbCByZXR1cm4gdHJ1ZSBpZiB0aGVcbiAqIHRva2VuIGlzIHdpdGhpbiB0aGUgdGltZSB3aW5kb3cgYXV0aG9yaXplZCBieSB0aGUgJ25iZicgKG5vdC1iZWZvcmUpIGFuZCAnaWF0JyAoaXNzdWVkLWF0KSBjbGFpbXMuXG4gKlxuICogTm90ZXM6XG4gKiAtIE1heSByZXR1cm4gYSBmYWxzZSBuZWdhdGl2ZSBpZiB0aGVyZSdzIG5vIG5hdGl2ZSBiYXNlNjQgZGVjb2Rpbmcgc3VwcG9ydC5cbiAqIC0gRG9lc24ndCBjaGVjayBpZiB0aGUgdG9rZW4gaXMgYWN0dWFsbHkgdmFsaWQuXG4gKlxuICogQHBhcmFtIHs/c3RyaW5nfSB0b2tlblxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0cy5pc1ZhbGlkVGltZXN0YW1wID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgdmFyIGNsYWltcyA9IGV4cG9ydHMuZGVjb2RlKHRva2VuKS5jbGFpbXMsIG5vdyA9IE1hdGguZmxvb3IobmV3IERhdGUoKS5nZXRUaW1lKCkgLyAxMDAwKSwgdmFsaWRTaW5jZSwgdmFsaWRVbnRpbDtcbiAgICBpZiAodHlwZW9mIGNsYWltcyA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgaWYgKGNsYWltcy5oYXNPd25Qcm9wZXJ0eSgnbmJmJykpIHtcbiAgICAgICAgICAgIHZhbGlkU2luY2UgPSBjbGFpbXNbJ25iZiddO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNsYWltcy5oYXNPd25Qcm9wZXJ0eSgnaWF0JykpIHtcbiAgICAgICAgICAgIHZhbGlkU2luY2UgPSBjbGFpbXNbJ2lhdCddO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjbGFpbXMuaGFzT3duUHJvcGVydHkoJ2V4cCcpKSB7XG4gICAgICAgICAgICB2YWxpZFVudGlsID0gY2xhaW1zWydleHAnXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIHRva2VuIHdpbGwgZXhwaXJlIGFmdGVyIDI0aCBieSBkZWZhdWx0XG4gICAgICAgICAgICB2YWxpZFVudGlsID0gdmFsaWRTaW5jZSArIDg2NDAwO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiAobm93ICYmIHZhbGlkU2luY2UgJiYgdmFsaWRVbnRpbCAmJiBub3cgPj0gdmFsaWRTaW5jZSAmJiBub3cgPD0gdmFsaWRVbnRpbCk7XG59O1xuLyoqXG4gKiBEZWNvZGVzIGEgRmlyZWJhc2UgYXV0aC4gdG9rZW4gYW5kIHJldHVybnMgaXRzIGlzc3VlZCBhdCB0aW1lIGlmIHZhbGlkLCBudWxsIG90aGVyd2lzZS5cbiAqXG4gKiBOb3RlczpcbiAqIC0gTWF5IHJldHVybiBudWxsIGlmIHRoZXJlJ3Mgbm8gbmF0aXZlIGJhc2U2NCBkZWNvZGluZyBzdXBwb3J0LlxuICogLSBEb2Vzbid0IGNoZWNrIGlmIHRoZSB0b2tlbiBpcyBhY3R1YWxseSB2YWxpZC5cbiAqXG4gKiBAcGFyYW0gez9zdHJpbmd9IHRva2VuXG4gKiBAcmV0dXJuIHs/bnVtYmVyfVxuICovXG5leHBvcnRzLmlzc3VlZEF0VGltZSA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgIHZhciBjbGFpbXMgPSBleHBvcnRzLmRlY29kZSh0b2tlbikuY2xhaW1zO1xuICAgIGlmICh0eXBlb2YgY2xhaW1zID09PSAnb2JqZWN0JyAmJiBjbGFpbXMuaGFzT3duUHJvcGVydHkoJ2lhdCcpKSB7XG4gICAgICAgIHJldHVybiBjbGFpbXNbJ2lhdCddO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn07XG4vKipcbiAqIERlY29kZXMgYSBGaXJlYmFzZSBhdXRoLiB0b2tlbiBhbmQgY2hlY2tzIHRoZSB2YWxpZGl0eSBvZiBpdHMgZm9ybWF0LiBFeHBlY3RzIGEgdmFsaWQgaXNzdWVkLWF0IHRpbWUgYW5kIG5vbi1lbXB0eVxuICogc2lnbmF0dXJlLlxuICpcbiAqIE5vdGVzOlxuICogLSBNYXkgcmV0dXJuIGEgZmFsc2UgbmVnYXRpdmUgaWYgdGhlcmUncyBubyBuYXRpdmUgYmFzZTY0IGRlY29kaW5nIHN1cHBvcnQuXG4gKiAtIERvZXNuJ3QgY2hlY2sgaWYgdGhlIHRva2VuIGlzIGFjdHVhbGx5IHZhbGlkLlxuICpcbiAqIEBwYXJhbSB7P3N0cmluZ30gdG9rZW5cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydHMuaXNWYWxpZEZvcm1hdCA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgIHZhciBkZWNvZGVkID0gZXhwb3J0cy5kZWNvZGUodG9rZW4pLCBjbGFpbXMgPSBkZWNvZGVkLmNsYWltcztcbiAgICByZXR1cm4gKCEhZGVjb2RlZC5zaWduYXR1cmUgJiZcbiAgICAgICAgISFjbGFpbXMgJiZcbiAgICAgICAgdHlwZW9mIGNsYWltcyA9PT0gJ29iamVjdCcgJiZcbiAgICAgICAgY2xhaW1zLmhhc093blByb3BlcnR5KCdpYXQnKSk7XG59O1xuLyoqXG4gKiBBdHRlbXB0cyB0byBwZWVyIGludG8gYW4gYXV0aCB0b2tlbiBhbmQgZGV0ZXJtaW5lIGlmIGl0J3MgYW4gYWRtaW4gYXV0aCB0b2tlbiBieSBsb29raW5nIGF0IHRoZSBjbGFpbXMgcG9ydGlvbi5cbiAqXG4gKiBOb3RlczpcbiAqIC0gTWF5IHJldHVybiBhIGZhbHNlIG5lZ2F0aXZlIGlmIHRoZXJlJ3Mgbm8gbmF0aXZlIGJhc2U2NCBkZWNvZGluZyBzdXBwb3J0LlxuICogLSBEb2Vzbid0IGNoZWNrIGlmIHRoZSB0b2tlbiBpcyBhY3R1YWxseSB2YWxpZC5cbiAqXG4gKiBAcGFyYW0gez9zdHJpbmd9IHRva2VuXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnRzLmlzQWRtaW4gPSBmdW5jdGlvbiAodG9rZW4pIHtcbiAgICB2YXIgY2xhaW1zID0gZXhwb3J0cy5kZWNvZGUodG9rZW4pLmNsYWltcztcbiAgICByZXR1cm4gdHlwZW9mIGNsYWltcyA9PT0gJ29iamVjdCcgJiYgY2xhaW1zWydhZG1pbiddID09PSB0cnVlO1xufTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9and0LmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuLy8gU2VlIGh0dHA6Ly93d3cuZGV2dGhvdWdodC5jb20vMjAxMi8wMS8xOC9hbi1vYmplY3QtaXMtbm90LWEtaGFzaC9cbmV4cG9ydHMuY29udGFpbnMgPSBmdW5jdGlvbiAob2JqLCBrZXkpIHtcbiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KTtcbn07XG5leHBvcnRzLnNhZmVHZXQgPSBmdW5jdGlvbiAob2JqLCBrZXkpIHtcbiAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSlcbiAgICAgICAgcmV0dXJuIG9ialtrZXldO1xuICAgIC8vIGVsc2UgcmV0dXJuIHVuZGVmaW5lZC5cbn07XG4vKipcbiAqIEVudW1lcmF0ZXMgdGhlIGtleXMvdmFsdWVzIGluIGFuIG9iamVjdCwgZXhjbHVkaW5nIGtleXMgZGVmaW5lZCBvbiB0aGUgcHJvdG90eXBlLlxuICpcbiAqIEBwYXJhbSB7P09iamVjdC48SyxWPn0gb2JqIE9iamVjdCB0byBlbnVtZXJhdGUuXG4gKiBAcGFyYW0geyFmdW5jdGlvbihLLCBWKX0gZm4gRnVuY3Rpb24gdG8gY2FsbCBmb3IgZWFjaCBrZXkgYW5kIHZhbHVlLlxuICogQHRlbXBsYXRlIEssVlxuICovXG5leHBvcnRzLmZvckVhY2ggPSBmdW5jdGlvbiAob2JqLCBmbikge1xuICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcbiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHtcbiAgICAgICAgICAgIGZuKGtleSwgb2JqW2tleV0pO1xuICAgICAgICB9XG4gICAgfVxufTtcbi8qKlxuICogQ29waWVzIGFsbCB0aGUgKG93bikgcHJvcGVydGllcyBmcm9tIG9uZSBvYmplY3QgdG8gYW5vdGhlci5cbiAqIEBwYXJhbSB7IU9iamVjdH0gb2JqVG9cbiAqIEBwYXJhbSB7IU9iamVjdH0gb2JqRnJvbVxuICogQHJldHVybiB7IU9iamVjdH0gb2JqVG9cbiAqL1xuZXhwb3J0cy5leHRlbmQgPSBmdW5jdGlvbiAob2JqVG8sIG9iakZyb20pIHtcbiAgICBleHBvcnRzLmZvckVhY2gob2JqRnJvbSwgZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcbiAgICAgICAgb2JqVG9ba2V5XSA9IHZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBvYmpUbztcbn07XG4vKipcbiAqIFJldHVybnMgYSBjbG9uZSBvZiB0aGUgc3BlY2lmaWVkIG9iamVjdC5cbiAqIEBwYXJhbSB7IU9iamVjdH0gb2JqXG4gKiBAcmV0dXJuIHshT2JqZWN0fSBjbG9uZWQgb2JqLlxuICovXG5leHBvcnRzLmNsb25lID0gZnVuY3Rpb24gKG9iaikge1xuICAgIHJldHVybiBleHBvcnRzLmV4dGVuZCh7fSwgb2JqKTtcbn07XG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiBvYmogaGFzIHR5cGVvZiBcIm9iamVjdFwiIGFuZCBpcyBub3QgbnVsbC4gIFVubGlrZSBnb29nLmlzT2JqZWN0KCksIGRvZXMgbm90IHJldHVybiB0cnVlXG4gKiBmb3IgZnVuY3Rpb25zLlxuICpcbiAqIEBwYXJhbSBvYmogeyp9IEEgcG90ZW50aWFsIG9iamVjdC5cbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIGl0J3MgYW4gb2JqZWN0LlxuICovXG5leHBvcnRzLmlzTm9uTnVsbE9iamVjdCA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICByZXR1cm4gdHlwZW9mIG9iaiA9PT0gJ29iamVjdCcgJiYgb2JqICE9PSBudWxsO1xufTtcbmV4cG9ydHMuaXNFbXB0eSA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG59O1xuZXhwb3J0cy5nZXRDb3VudCA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICB2YXIgcnYgPSAwO1xuICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcbiAgICAgICAgcnYrKztcbiAgICB9XG4gICAgcmV0dXJuIHJ2O1xufTtcbmV4cG9ydHMubWFwID0gZnVuY3Rpb24gKG9iaiwgZiwgb3B0X29iaikge1xuICAgIHZhciByZXMgPSB7fTtcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgICAgIHJlc1trZXldID0gZi5jYWxsKG9wdF9vYmosIG9ialtrZXldLCBrZXksIG9iaik7XG4gICAgfVxuICAgIHJldHVybiByZXM7XG59O1xuZXhwb3J0cy5maW5kS2V5ID0gZnVuY3Rpb24gKG9iaiwgZm4sIG9wdF90aGlzKSB7XG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgICAgICBpZiAoZm4uY2FsbChvcHRfdGhpcywgb2JqW2tleV0sIGtleSwgb2JqKSkge1xuICAgICAgICAgICAgcmV0dXJuIGtleTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xufTtcbmV4cG9ydHMuZmluZFZhbHVlID0gZnVuY3Rpb24gKG9iaiwgZm4sIG9wdF90aGlzKSB7XG4gICAgdmFyIGtleSA9IGV4cG9ydHMuZmluZEtleShvYmosIGZuLCBvcHRfdGhpcyk7XG4gICAgcmV0dXJuIGtleSAmJiBvYmpba2V5XTtcbn07XG5leHBvcnRzLmdldEFueUtleSA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgICAgIHJldHVybiBrZXk7XG4gICAgfVxufTtcbmV4cG9ydHMuZ2V0VmFsdWVzID0gZnVuY3Rpb24gKG9iaikge1xuICAgIHZhciByZXMgPSBbXTtcbiAgICB2YXIgaSA9IDA7XG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgICAgICByZXNbaSsrXSA9IG9ialtrZXldO1xuICAgIH1cbiAgICByZXR1cm4gcmVzO1xufTtcbi8qKlxuICogVGVzdHMgd2hldGhlciBldmVyeSBrZXkvdmFsdWUgcGFpciBpbiBhbiBvYmplY3QgcGFzcyB0aGUgdGVzdCBpbXBsZW1lbnRlZFxuICogYnkgdGhlIHByb3ZpZGVkIGZ1bmN0aW9uXG4gKlxuICogQHBhcmFtIHs/T2JqZWN0LjxLLFY+fSBvYmogT2JqZWN0IHRvIHRlc3QuXG4gKiBAcGFyYW0geyFmdW5jdGlvbihLLCBWKX0gZm4gRnVuY3Rpb24gdG8gY2FsbCBmb3IgZWFjaCBrZXkgYW5kIHZhbHVlLlxuICogQHRlbXBsYXRlIEssVlxuICovXG5leHBvcnRzLmV2ZXJ5ID0gZnVuY3Rpb24gKG9iaiwgZm4pIHtcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7XG4gICAgICAgICAgICBpZiAoIWZuKGtleSwgb2JqW2tleV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9b2JqLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIG9ial8xID0gcmVxdWlyZShcIi4vb2JqXCIpO1xuLyoqXG4gKiBSZXR1cm5zIGEgcXVlcnlzdHJpbmctZm9ybWF0dGVkIHN0cmluZyAoZS5nLiAmYXJnPXZhbCZhcmcyPXZhbDIpIGZyb20gYSBwYXJhbXNcbiAqIG9iamVjdCAoZS5nLiB7YXJnOiAndmFsJywgYXJnMjogJ3ZhbDInfSlcbiAqIE5vdGU6IFlvdSBtdXN0IHByZXBlbmQgaXQgd2l0aCA/IHdoZW4gYWRkaW5nIGl0IHRvIGEgVVJMLlxuICpcbiAqIEBwYXJhbSB7IU9iamVjdH0gcXVlcnlzdHJpbmdQYXJhbXNcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0cy5xdWVyeXN0cmluZyA9IGZ1bmN0aW9uIChxdWVyeXN0cmluZ1BhcmFtcykge1xuICAgIHZhciBwYXJhbXMgPSBbXTtcbiAgICBvYmpfMS5mb3JFYWNoKHF1ZXJ5c3RyaW5nUGFyYW1zLCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgICAgICAgIHZhbHVlLmZvckVhY2goZnVuY3Rpb24gKGFycmF5VmFsKSB7XG4gICAgICAgICAgICAgICAgcGFyYW1zLnB1c2goZW5jb2RlVVJJQ29tcG9uZW50KGtleSkgKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQoYXJyYXlWYWwpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcGFyYW1zLnB1c2goZW5jb2RlVVJJQ29tcG9uZW50KGtleSkgKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQodmFsdWUpKTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBwYXJhbXMubGVuZ3RoID8gJyYnICsgcGFyYW1zLmpvaW4oJyYnKSA6ICcnO1xufTtcbi8qKlxuICogRGVjb2RlcyBhIHF1ZXJ5c3RyaW5nIChlLmcuID9hcmc9dmFsJmFyZzI9dmFsMikgaW50byBhIHBhcmFtcyBvYmplY3QgKGUuZy4ge2FyZzogJ3ZhbCcsIGFyZzI6ICd2YWwyJ30pXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHF1ZXJ5c3RyaW5nXG4gKiBAcmV0dXJuIHshT2JqZWN0fVxuICovXG5leHBvcnRzLnF1ZXJ5c3RyaW5nRGVjb2RlID0gZnVuY3Rpb24gKHF1ZXJ5c3RyaW5nKSB7XG4gICAgdmFyIG9iaiA9IHt9O1xuICAgIHZhciB0b2tlbnMgPSBxdWVyeXN0cmluZy5yZXBsYWNlKC9eXFw/LywgJycpLnNwbGl0KCcmJyk7XG4gICAgdG9rZW5zLmZvckVhY2goZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgICAgdmFyIGtleSA9IHRva2VuLnNwbGl0KCc9Jyk7XG4gICAgICAgICAgICBvYmpba2V5WzBdXSA9IGtleVsxXTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBvYmo7XG59O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1xdWVyeS5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGhhc2hfMSA9IHJlcXVpcmUoXCIuL2hhc2hcIik7XG4vKipcbiAqIEBmaWxlb3ZlcnZpZXcgU0hBLTEgY3J5cHRvZ3JhcGhpYyBoYXNoLlxuICogVmFyaWFibGUgbmFtZXMgZm9sbG93IHRoZSBub3RhdGlvbiBpbiBGSVBTIFBVQiAxODAtMzpcbiAqIGh0dHA6Ly9jc3JjLm5pc3QuZ292L3B1YmxpY2F0aW9ucy9maXBzL2ZpcHMxODAtMy9maXBzMTgwLTNfZmluYWwucGRmLlxuICpcbiAqIFVzYWdlOlxuICogICB2YXIgc2hhMSA9IG5ldyBzaGExKCk7XG4gKiAgIHNoYTEudXBkYXRlKGJ5dGVzKTtcbiAqICAgdmFyIGhhc2ggPSBzaGExLmRpZ2VzdCgpO1xuICpcbiAqIFBlcmZvcm1hbmNlOlxuICogICBDaHJvbWUgMjM6ICAgfjQwMCBNYml0L3NcbiAqICAgRmlyZWZveCAxNjogIH4yNTAgTWJpdC9zXG4gKlxuICovXG4vKipcbiAqIFNIQS0xIGNyeXB0b2dyYXBoaWMgaGFzaCBjb25zdHJ1Y3Rvci5cbiAqXG4gKiBUaGUgcHJvcGVydGllcyBkZWNsYXJlZCBoZXJlIGFyZSBkaXNjdXNzZWQgaW4gdGhlIGFib3ZlIGFsZ29yaXRobSBkb2N1bWVudC5cbiAqIEBjb25zdHJ1Y3RvclxuICogQGV4dGVuZHMge0hhc2h9XG4gKiBAZmluYWxcbiAqIEBzdHJ1Y3RcbiAqL1xudmFyIFNoYTEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFNoYTEsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU2hhMSgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEhvbGRzIHRoZSBwcmV2aW91cyB2YWx1ZXMgb2YgYWNjdW11bGF0ZWQgdmFyaWFibGVzIGEtZSBpbiB0aGUgY29tcHJlc3NfXG4gICAgICAgICAqIGZ1bmN0aW9uLlxuICAgICAgICAgKiBAdHlwZSB7IUFycmF5PG51bWJlcj59XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICBfdGhpcy5jaGFpbl8gPSBbXTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgYnVmZmVyIGhvbGRpbmcgdGhlIHBhcnRpYWxseSBjb21wdXRlZCBoYXNoIHJlc3VsdC5cbiAgICAgICAgICogQHR5cGUgeyFBcnJheTxudW1iZXI+fVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgX3RoaXMuYnVmXyA9IFtdO1xuICAgICAgICAvKipcbiAgICAgICAgICogQW4gYXJyYXkgb2YgODAgYnl0ZXMsIGVhY2ggYSBwYXJ0IG9mIHRoZSBtZXNzYWdlIHRvIGJlIGhhc2hlZC4gIFJlZmVycmVkIHRvXG4gICAgICAgICAqIGFzIHRoZSBtZXNzYWdlIHNjaGVkdWxlIGluIHRoZSBkb2NzLlxuICAgICAgICAgKiBAdHlwZSB7IUFycmF5PG51bWJlcj59XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICBfdGhpcy5XXyA9IFtdO1xuICAgICAgICAvKipcbiAgICAgICAgICogQ29udGFpbnMgZGF0YSBuZWVkZWQgdG8gcGFkIG1lc3NhZ2VzIGxlc3MgdGhhbiA2NCBieXRlcy5cbiAgICAgICAgICogQHR5cGUgeyFBcnJheTxudW1iZXI+fVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgX3RoaXMucGFkXyA9IFtdO1xuICAgICAgICAvKipcbiAgICAgICAgICogQHByaXZhdGUge251bWJlcn1cbiAgICAgICAgICovXG4gICAgICAgIF90aGlzLmluYnVmXyA9IDA7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAcHJpdmF0ZSB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgX3RoaXMudG90YWxfID0gMDtcbiAgICAgICAgX3RoaXMuYmxvY2tTaXplID0gNTEyIC8gODtcbiAgICAgICAgX3RoaXMucGFkX1swXSA9IDEyODtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBfdGhpcy5ibG9ja1NpemU7ICsraSkge1xuICAgICAgICAgICAgX3RoaXMucGFkX1tpXSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgX3RoaXMucmVzZXQoKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBTaGExLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5jaGFpbl9bMF0gPSAweDY3NDUyMzAxO1xuICAgICAgICB0aGlzLmNoYWluX1sxXSA9IDB4ZWZjZGFiODk7XG4gICAgICAgIHRoaXMuY2hhaW5fWzJdID0gMHg5OGJhZGNmZTtcbiAgICAgICAgdGhpcy5jaGFpbl9bM10gPSAweDEwMzI1NDc2O1xuICAgICAgICB0aGlzLmNoYWluX1s0XSA9IDB4YzNkMmUxZjA7XG4gICAgICAgIHRoaXMuaW5idWZfID0gMDtcbiAgICAgICAgdGhpcy50b3RhbF8gPSAwO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogSW50ZXJuYWwgY29tcHJlc3MgaGVscGVyIGZ1bmN0aW9uLlxuICAgICAqIEBwYXJhbSB7IUFycmF5PG51bWJlcj58IVVpbnQ4QXJyYXl8c3RyaW5nfSBidWYgQmxvY2sgdG8gY29tcHJlc3MuXG4gICAgICogQHBhcmFtIHtudW1iZXI9fSBvcHRfb2Zmc2V0IE9mZnNldCBvZiB0aGUgYmxvY2sgaW4gdGhlIGJ1ZmZlci5cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIFNoYTEucHJvdG90eXBlLmNvbXByZXNzXyA9IGZ1bmN0aW9uIChidWYsIG9wdF9vZmZzZXQpIHtcbiAgICAgICAgaWYgKCFvcHRfb2Zmc2V0KSB7XG4gICAgICAgICAgICBvcHRfb2Zmc2V0ID0gMDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgVyA9IHRoaXMuV187XG4gICAgICAgIC8vIGdldCAxNiBiaWcgZW5kaWFuIHdvcmRzXG4gICAgICAgIGlmICh0eXBlb2YgYnVmID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxNjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgLy8gVE9ETyh1c2VyKTogW2J1ZyA4MTQwMTIyXSBSZWNlbnQgdmVyc2lvbnMgb2YgU2FmYXJpIGZvciBNYWMgT1MgYW5kIGlPU1xuICAgICAgICAgICAgICAgIC8vIGhhdmUgYSBidWcgdGhhdCB0dXJucyB0aGUgcG9zdC1pbmNyZW1lbnQgKysgb3BlcmF0b3IgaW50byBwcmUtaW5jcmVtZW50XG4gICAgICAgICAgICAgICAgLy8gZHVyaW5nIEpJVCBjb21waWxhdGlvbi4gIFdlIGhhdmUgY29kZSB0aGF0IGRlcGVuZHMgaGVhdmlseSBvbiBTSEEtMSBmb3JcbiAgICAgICAgICAgICAgICAvLyBjb3JyZWN0bmVzcyBhbmQgd2hpY2ggaXMgYWZmZWN0ZWQgYnkgdGhpcyBidWcsIHNvIEkndmUgcmVtb3ZlZCBhbGwgdXNlc1xuICAgICAgICAgICAgICAgIC8vIG9mIHBvc3QtaW5jcmVtZW50ICsrIGluIHdoaWNoIHRoZSByZXN1bHQgdmFsdWUgaXMgdXNlZC4gIFdlIGNhbiByZXZlcnRcbiAgICAgICAgICAgICAgICAvLyB0aGlzIGNoYW5nZSBvbmNlIHRoZSBTYWZhcmkgYnVnXG4gICAgICAgICAgICAgICAgLy8gKGh0dHBzOi8vYnVncy53ZWJraXQub3JnL3Nob3dfYnVnLmNnaT9pZD0xMDkwMzYpIGhhcyBiZWVuIGZpeGVkIGFuZFxuICAgICAgICAgICAgICAgIC8vIG1vc3QgY2xpZW50cyBoYXZlIGJlZW4gdXBkYXRlZC5cbiAgICAgICAgICAgICAgICBXW2ldID1cbiAgICAgICAgICAgICAgICAgICAgKGJ1Zi5jaGFyQ29kZUF0KG9wdF9vZmZzZXQpIDw8IDI0KSB8XG4gICAgICAgICAgICAgICAgICAgICAgICAoYnVmLmNoYXJDb2RlQXQob3B0X29mZnNldCArIDEpIDw8IDE2KSB8XG4gICAgICAgICAgICAgICAgICAgICAgICAoYnVmLmNoYXJDb2RlQXQob3B0X29mZnNldCArIDIpIDw8IDgpIHxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1Zi5jaGFyQ29kZUF0KG9wdF9vZmZzZXQgKyAzKTtcbiAgICAgICAgICAgICAgICBvcHRfb2Zmc2V0ICs9IDQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDE2OyBpKyspIHtcbiAgICAgICAgICAgICAgICBXW2ldID1cbiAgICAgICAgICAgICAgICAgICAgKGJ1ZltvcHRfb2Zmc2V0XSA8PCAyNCkgfFxuICAgICAgICAgICAgICAgICAgICAgICAgKGJ1ZltvcHRfb2Zmc2V0ICsgMV0gPDwgMTYpIHxcbiAgICAgICAgICAgICAgICAgICAgICAgIChidWZbb3B0X29mZnNldCArIDJdIDw8IDgpIHxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1ZltvcHRfb2Zmc2V0ICsgM107XG4gICAgICAgICAgICAgICAgb3B0X29mZnNldCArPSA0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIGV4cGFuZCB0byA4MCB3b3Jkc1xuICAgICAgICBmb3IgKHZhciBpID0gMTY7IGkgPCA4MDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgdCA9IFdbaSAtIDNdIF4gV1tpIC0gOF0gXiBXW2kgLSAxNF0gXiBXW2kgLSAxNl07XG4gICAgICAgICAgICBXW2ldID0gKCh0IDw8IDEpIHwgKHQgPj4+IDMxKSkgJiAweGZmZmZmZmZmO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhID0gdGhpcy5jaGFpbl9bMF07XG4gICAgICAgIHZhciBiID0gdGhpcy5jaGFpbl9bMV07XG4gICAgICAgIHZhciBjID0gdGhpcy5jaGFpbl9bMl07XG4gICAgICAgIHZhciBkID0gdGhpcy5jaGFpbl9bM107XG4gICAgICAgIHZhciBlID0gdGhpcy5jaGFpbl9bNF07XG4gICAgICAgIHZhciBmLCBrO1xuICAgICAgICAvLyBUT0RPKHVzZXIpOiBUcnkgdG8gdW5yb2xsIHRoaXMgbG9vcCB0byBzcGVlZCB1cCB0aGUgY29tcHV0YXRpb24uXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgODA7IGkrKykge1xuICAgICAgICAgICAgaWYgKGkgPCA0MCkge1xuICAgICAgICAgICAgICAgIGlmIChpIDwgMjApIHtcbiAgICAgICAgICAgICAgICAgICAgZiA9IGQgXiAoYiAmIChjIF4gZCkpO1xuICAgICAgICAgICAgICAgICAgICBrID0gMHg1YTgyNzk5OTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGYgPSBiIF4gYyBeIGQ7XG4gICAgICAgICAgICAgICAgICAgIGsgPSAweDZlZDllYmExO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChpIDwgNjApIHtcbiAgICAgICAgICAgICAgICAgICAgZiA9IChiICYgYykgfCAoZCAmIChiIHwgYykpO1xuICAgICAgICAgICAgICAgICAgICBrID0gMHg4ZjFiYmNkYztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGYgPSBiIF4gYyBeIGQ7XG4gICAgICAgICAgICAgICAgICAgIGsgPSAweGNhNjJjMWQ2O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB0ID0gKCgoYSA8PCA1KSB8IChhID4+PiAyNykpICsgZiArIGUgKyBrICsgV1tpXSkgJiAweGZmZmZmZmZmO1xuICAgICAgICAgICAgZSA9IGQ7XG4gICAgICAgICAgICBkID0gYztcbiAgICAgICAgICAgIGMgPSAoKGIgPDwgMzApIHwgKGIgPj4+IDIpKSAmIDB4ZmZmZmZmZmY7XG4gICAgICAgICAgICBiID0gYTtcbiAgICAgICAgICAgIGEgPSB0O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2hhaW5fWzBdID0gKHRoaXMuY2hhaW5fWzBdICsgYSkgJiAweGZmZmZmZmZmO1xuICAgICAgICB0aGlzLmNoYWluX1sxXSA9ICh0aGlzLmNoYWluX1sxXSArIGIpICYgMHhmZmZmZmZmZjtcbiAgICAgICAgdGhpcy5jaGFpbl9bMl0gPSAodGhpcy5jaGFpbl9bMl0gKyBjKSAmIDB4ZmZmZmZmZmY7XG4gICAgICAgIHRoaXMuY2hhaW5fWzNdID0gKHRoaXMuY2hhaW5fWzNdICsgZCkgJiAweGZmZmZmZmZmO1xuICAgICAgICB0aGlzLmNoYWluX1s0XSA9ICh0aGlzLmNoYWluX1s0XSArIGUpICYgMHhmZmZmZmZmZjtcbiAgICB9O1xuICAgIFNoYTEucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChieXRlcywgb3B0X2xlbmd0aCkge1xuICAgICAgICAvLyBUT0RPKGpvaG5sZW56KTogdGlnaHRlbiB0aGUgZnVuY3Rpb24gc2lnbmF0dXJlIGFuZCByZW1vdmUgdGhpcyBjaGVja1xuICAgICAgICBpZiAoYnl0ZXMgPT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRfbGVuZ3RoID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIG9wdF9sZW5ndGggPSBieXRlcy5sZW5ndGg7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGxlbmd0aE1pbnVzQmxvY2sgPSBvcHRfbGVuZ3RoIC0gdGhpcy5ibG9ja1NpemU7XG4gICAgICAgIHZhciBuID0gMDtcbiAgICAgICAgLy8gVXNpbmcgbG9jYWwgaW5zdGVhZCBvZiBtZW1iZXIgdmFyaWFibGVzIGdpdmVzIH41JSBzcGVlZHVwIG9uIEZpcmVmb3ggMTYuXG4gICAgICAgIHZhciBidWYgPSB0aGlzLmJ1Zl87XG4gICAgICAgIHZhciBpbmJ1ZiA9IHRoaXMuaW5idWZfO1xuICAgICAgICAvLyBUaGUgb3V0ZXIgd2hpbGUgbG9vcCBzaG91bGQgZXhlY3V0ZSBhdCBtb3N0IHR3aWNlLlxuICAgICAgICB3aGlsZSAobiA8IG9wdF9sZW5ndGgpIHtcbiAgICAgICAgICAgIC8vIFdoZW4gd2UgaGF2ZSBubyBkYXRhIGluIHRoZSBibG9jayB0byB0b3AgdXAsIHdlIGNhbiBkaXJlY3RseSBwcm9jZXNzIHRoZVxuICAgICAgICAgICAgLy8gaW5wdXQgYnVmZmVyIChhc3N1bWluZyBpdCBjb250YWlucyBzdWZmaWNpZW50IGRhdGEpLiBUaGlzIGdpdmVzIH4yNSVcbiAgICAgICAgICAgIC8vIHNwZWVkdXAgb24gQ2hyb21lIDIzIGFuZCB+MTUlIHNwZWVkdXAgb24gRmlyZWZveCAxNiwgYnV0IHJlcXVpcmVzIHRoYXRcbiAgICAgICAgICAgIC8vIHRoZSBkYXRhIGlzIHByb3ZpZGVkIGluIGxhcmdlIGNodW5rcyAob3IgaW4gbXVsdGlwbGVzIG9mIDY0IGJ5dGVzKS5cbiAgICAgICAgICAgIGlmIChpbmJ1ZiA9PSAwKSB7XG4gICAgICAgICAgICAgICAgd2hpbGUgKG4gPD0gbGVuZ3RoTWludXNCbG9jaykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbXByZXNzXyhieXRlcywgbik7XG4gICAgICAgICAgICAgICAgICAgIG4gKz0gdGhpcy5ibG9ja1NpemU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGVvZiBieXRlcyA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICB3aGlsZSAobiA8IG9wdF9sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgYnVmW2luYnVmXSA9IGJ5dGVzLmNoYXJDb2RlQXQobik7XG4gICAgICAgICAgICAgICAgICAgICsraW5idWY7XG4gICAgICAgICAgICAgICAgICAgICsrbjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluYnVmID09IHRoaXMuYmxvY2tTaXplKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbXByZXNzXyhidWYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5idWYgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSnVtcCB0byB0aGUgb3V0ZXIgbG9vcCBzbyB3ZSB1c2UgdGhlIGZ1bGwtYmxvY2sgb3B0aW1pemF0aW9uLlxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB3aGlsZSAobiA8IG9wdF9sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgYnVmW2luYnVmXSA9IGJ5dGVzW25dO1xuICAgICAgICAgICAgICAgICAgICArK2luYnVmO1xuICAgICAgICAgICAgICAgICAgICArK247XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmJ1ZiA9PSB0aGlzLmJsb2NrU2l6ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb21wcmVzc18oYnVmKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluYnVmID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEp1bXAgdG8gdGhlIG91dGVyIGxvb3Agc28gd2UgdXNlIHRoZSBmdWxsLWJsb2NrIG9wdGltaXphdGlvbi5cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuaW5idWZfID0gaW5idWY7XG4gICAgICAgIHRoaXMudG90YWxfICs9IG9wdF9sZW5ndGg7XG4gICAgfTtcbiAgICAvKiogQG92ZXJyaWRlICovXG4gICAgU2hhMS5wcm90b3R5cGUuZGlnZXN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZGlnZXN0ID0gW107XG4gICAgICAgIHZhciB0b3RhbEJpdHMgPSB0aGlzLnRvdGFsXyAqIDg7XG4gICAgICAgIC8vIEFkZCBwYWQgMHg4MCAweDAwKi5cbiAgICAgICAgaWYgKHRoaXMuaW5idWZfIDwgNTYpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlKHRoaXMucGFkXywgNTYgLSB0aGlzLmluYnVmXyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZSh0aGlzLnBhZF8sIHRoaXMuYmxvY2tTaXplIC0gKHRoaXMuaW5idWZfIC0gNTYpKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBBZGQgIyBiaXRzLlxuICAgICAgICBmb3IgKHZhciBpID0gdGhpcy5ibG9ja1NpemUgLSAxOyBpID49IDU2OyBpLS0pIHtcbiAgICAgICAgICAgIHRoaXMuYnVmX1tpXSA9IHRvdGFsQml0cyAmIDI1NTtcbiAgICAgICAgICAgIHRvdGFsQml0cyAvPSAyNTY7IC8vIERvbid0IHVzZSBiaXQtc2hpZnRpbmcgaGVyZSFcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNvbXByZXNzXyh0aGlzLmJ1Zl8pO1xuICAgICAgICB2YXIgbiA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNTsgaSsrKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMjQ7IGogPj0gMDsgaiAtPSA4KSB7XG4gICAgICAgICAgICAgICAgZGlnZXN0W25dID0gKHRoaXMuY2hhaW5fW2ldID4+IGopICYgMjU1O1xuICAgICAgICAgICAgICAgICsrbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGlnZXN0O1xuICAgIH07XG4gICAgcmV0dXJuIFNoYTE7XG59KGhhc2hfMS5IYXNoKSk7XG5leHBvcnRzLlNoYTEgPSBTaGExO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1zaGExLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG4vKipcbiAqIEhlbHBlciB0byBtYWtlIGEgU3Vic2NyaWJlIGZ1bmN0aW9uIChqdXN0IGxpa2UgUHJvbWlzZSBoZWxwcyBtYWtlIGFcbiAqIFRoZW5hYmxlKS5cbiAqXG4gKiBAcGFyYW0gZXhlY3V0b3IgRnVuY3Rpb24gd2hpY2ggY2FuIG1ha2UgY2FsbHMgdG8gYSBzaW5nbGUgT2JzZXJ2ZXJcbiAqICAgICBhcyBhIHByb3h5LlxuICogQHBhcmFtIG9uTm9PYnNlcnZlcnMgQ2FsbGJhY2sgd2hlbiBjb3VudCBvZiBPYnNlcnZlcnMgZ29lcyB0byB6ZXJvLlxuICovXG5mdW5jdGlvbiBjcmVhdGVTdWJzY3JpYmUoZXhlY3V0b3IsIG9uTm9PYnNlcnZlcnMpIHtcbiAgICB2YXIgcHJveHkgPSBuZXcgT2JzZXJ2ZXJQcm94eShleGVjdXRvciwgb25Ob09ic2VydmVycyk7XG4gICAgcmV0dXJuIHByb3h5LnN1YnNjcmliZS5iaW5kKHByb3h5KTtcbn1cbmV4cG9ydHMuY3JlYXRlU3Vic2NyaWJlID0gY3JlYXRlU3Vic2NyaWJlO1xuLyoqXG4gKiBJbXBsZW1lbnQgZmFuLW91dCBmb3IgYW55IG51bWJlciBvZiBPYnNlcnZlcnMgYXR0YWNoZWQgdmlhIGEgc3Vic2NyaWJlXG4gKiBmdW5jdGlvbi5cbiAqL1xudmFyIE9ic2VydmVyUHJveHkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIGV4ZWN1dG9yIEZ1bmN0aW9uIHdoaWNoIGNhbiBtYWtlIGNhbGxzIHRvIGEgc2luZ2xlIE9ic2VydmVyXG4gICAgICogICAgIGFzIGEgcHJveHkuXG4gICAgICogQHBhcmFtIG9uTm9PYnNlcnZlcnMgQ2FsbGJhY2sgd2hlbiBjb3VudCBvZiBPYnNlcnZlcnMgZ29lcyB0byB6ZXJvLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIE9ic2VydmVyUHJveHkoZXhlY3V0b3IsIG9uTm9PYnNlcnZlcnMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5vYnNlcnZlcnMgPSBbXTtcbiAgICAgICAgdGhpcy51bnN1YnNjcmliZXMgPSBbXTtcbiAgICAgICAgdGhpcy5vYnNlcnZlckNvdW50ID0gMDtcbiAgICAgICAgLy8gTWljcm8tdGFzayBzY2hlZHVsaW5nIGJ5IGNhbGxpbmcgdGFzay50aGVuKCkuXG4gICAgICAgIHRoaXMudGFzayA9IFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICB0aGlzLmZpbmFsaXplZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLm9uTm9PYnNlcnZlcnMgPSBvbk5vT2JzZXJ2ZXJzO1xuICAgICAgICAvLyBDYWxsIHRoZSBleGVjdXRvciBhc3luY2hyb25vdXNseSBzbyBzdWJzY3JpYmVycyB0aGF0IGFyZSBjYWxsZWRcbiAgICAgICAgLy8gc3luY2hyb25vdXNseSBhZnRlciB0aGUgY3JlYXRpb24gb2YgdGhlIHN1YnNjcmliZSBmdW5jdGlvblxuICAgICAgICAvLyBjYW4gc3RpbGwgcmVjZWl2ZSB0aGUgdmVyeSBmaXJzdCB2YWx1ZSBnZW5lcmF0ZWQgaW4gdGhlIGV4ZWN1dG9yLlxuICAgICAgICB0aGlzLnRhc2tcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGV4ZWN1dG9yKF90aGlzKTtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgX3RoaXMuZXJyb3IoZSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBPYnNlcnZlclByb3h5LnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuZm9yRWFjaE9ic2VydmVyKGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dCh2YWx1ZSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgT2JzZXJ2ZXJQcm94eS5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgdGhpcy5mb3JFYWNoT2JzZXJ2ZXIoZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICAgICAgICBvYnNlcnZlci5lcnJvcihlcnJvcik7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmNsb3NlKGVycm9yKTtcbiAgICB9O1xuICAgIE9ic2VydmVyUHJveHkucHJvdG90eXBlLmNvbXBsZXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmZvckVhY2hPYnNlcnZlcihmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgICAgICAgIG9ic2VydmVyLmNvbXBsZXRlKCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBTdWJzY3JpYmUgZnVuY3Rpb24gdGhhdCBjYW4gYmUgdXNlZCB0byBhZGQgYW4gT2JzZXJ2ZXIgdG8gdGhlIGZhbi1vdXQgbGlzdC5cbiAgICAgKlxuICAgICAqIC0gV2UgcmVxdWlyZSB0aGF0IG5vIGV2ZW50IGlzIHNlbnQgdG8gYSBzdWJzY3JpYmVyIHN5Y2hyb25vdXNseSB0byB0aGVpclxuICAgICAqICAgY2FsbCB0byBzdWJzY3JpYmUoKS5cbiAgICAgKi9cbiAgICBPYnNlcnZlclByb3h5LnByb3RvdHlwZS5zdWJzY3JpYmUgPSBmdW5jdGlvbiAobmV4dE9yT2JzZXJ2ZXIsIGVycm9yLCBjb21wbGV0ZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgb2JzZXJ2ZXI7XG4gICAgICAgIGlmIChuZXh0T3JPYnNlcnZlciA9PT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICBlcnJvciA9PT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICBjb21wbGV0ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgT2JzZXJ2ZXIuJyk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQXNzZW1ibGUgYW4gT2JzZXJ2ZXIgb2JqZWN0IHdoZW4gcGFzc2VkIGFzIGNhbGxiYWNrIGZ1bmN0aW9ucy5cbiAgICAgICAgaWYgKGltcGxlbWVudHNBbnlNZXRob2RzKG5leHRPck9ic2VydmVyLCBbJ25leHQnLCAnZXJyb3InLCAnY29tcGxldGUnXSkpIHtcbiAgICAgICAgICAgIG9ic2VydmVyID0gbmV4dE9yT2JzZXJ2ZXI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBvYnNlcnZlciA9IHtcbiAgICAgICAgICAgICAgICBuZXh0OiBuZXh0T3JPYnNlcnZlcixcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IsXG4gICAgICAgICAgICAgICAgY29tcGxldGU6IGNvbXBsZXRlXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGlmIChvYnNlcnZlci5uZXh0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIG9ic2VydmVyLm5leHQgPSBub29wO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvYnNlcnZlci5lcnJvciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBvYnNlcnZlci5lcnJvciA9IG5vb3A7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9ic2VydmVyLmNvbXBsZXRlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIG9ic2VydmVyLmNvbXBsZXRlID0gbm9vcDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdW5zdWIgPSB0aGlzLnVuc3Vic2NyaWJlT25lLmJpbmQodGhpcywgdGhpcy5vYnNlcnZlcnMubGVuZ3RoKTtcbiAgICAgICAgLy8gQXR0ZW1wdCB0byBzdWJzY3JpYmUgdG8gYSB0ZXJtaW5hdGVkIE9ic2VydmFibGUgLSB3ZVxuICAgICAgICAvLyBqdXN0IHJlc3BvbmQgdG8gdGhlIE9ic2VydmVyIHdpdGggdGhlIGZpbmFsIGVycm9yIG9yIGNvbXBsZXRlXG4gICAgICAgIC8vIGV2ZW50LlxuICAgICAgICBpZiAodGhpcy5maW5hbGl6ZWQpIHtcbiAgICAgICAgICAgIHRoaXMudGFzay50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuZmluYWxFcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIuZXJyb3IoX3RoaXMuZmluYWxFcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5jb21wbGV0ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIG5vdGhpbmdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vYnNlcnZlcnMucHVzaChvYnNlcnZlcik7XG4gICAgICAgIHJldHVybiB1bnN1YjtcbiAgICB9O1xuICAgIC8vIFVuc3Vic2NyaWJlIGlzIHN5bmNocm9ub3VzIC0gd2UgZ3VhcmFudGVlIHRoYXQgbm8gZXZlbnRzIGFyZSBzZW50IHRvXG4gICAgLy8gYW55IHVuc3Vic2NyaWJlZCBPYnNlcnZlci5cbiAgICBPYnNlcnZlclByb3h5LnByb3RvdHlwZS51bnN1YnNjcmliZU9uZSA9IGZ1bmN0aW9uIChpKSB7XG4gICAgICAgIGlmICh0aGlzLm9ic2VydmVycyA9PT0gdW5kZWZpbmVkIHx8IHRoaXMub2JzZXJ2ZXJzW2ldID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBkZWxldGUgdGhpcy5vYnNlcnZlcnNbaV07XG4gICAgICAgIHRoaXMub2JzZXJ2ZXJDb3VudCAtPSAxO1xuICAgICAgICBpZiAodGhpcy5vYnNlcnZlckNvdW50ID09PSAwICYmIHRoaXMub25Ob09ic2VydmVycyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLm9uTm9PYnNlcnZlcnModGhpcyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE9ic2VydmVyUHJveHkucHJvdG90eXBlLmZvckVhY2hPYnNlcnZlciA9IGZ1bmN0aW9uIChmbikge1xuICAgICAgICBpZiAodGhpcy5maW5hbGl6ZWQpIHtcbiAgICAgICAgICAgIC8vIEFscmVhZHkgY2xvc2VkIGJ5IHByZXZpb3VzIGV2ZW50Li4uLmp1c3QgZWF0IHRoZSBhZGRpdGlvbmFsIHZhbHVlcy5cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvLyBTaW5jZSBzZW5kT25lIGNhbGxzIGFzeW5jaHJvbm91c2x5IC0gdGhlcmUgaXMgbm8gY2hhbmNlIHRoYXRcbiAgICAgICAgLy8gdGhpcy5vYnNlcnZlcnMgd2lsbCBiZWNvbWUgdW5kZWZpbmVkLlxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMub2JzZXJ2ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB0aGlzLnNlbmRPbmUoaSwgZm4pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvLyBDYWxsIHRoZSBPYnNlcnZlciB2aWEgb25lIG9mIGl0J3MgY2FsbGJhY2sgZnVuY3Rpb24uIFdlIGFyZSBjYXJlZnVsIHRvXG4gICAgLy8gY29uZmlybSB0aGF0IHRoZSBvYnNlcnZlIGhhcyBub3QgYmVlbiB1bnN1YnNjcmliZWQgc2luY2UgdGhpcyBhc3luY2hyb25vdXNcbiAgICAvLyBmdW5jdGlvbiBoYWQgYmVlbiBxdWV1ZWQuXG4gICAgT2JzZXJ2ZXJQcm94eS5wcm90b3R5cGUuc2VuZE9uZSA9IGZ1bmN0aW9uIChpLCBmbikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAvLyBFeGVjdXRlIHRoZSBjYWxsYmFjayBhc3luY2hyb25vdXNseVxuICAgICAgICB0aGlzLnRhc2sudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoX3RoaXMub2JzZXJ2ZXJzICE9PSB1bmRlZmluZWQgJiYgX3RoaXMub2JzZXJ2ZXJzW2ldICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBmbihfdGhpcy5vYnNlcnZlcnNbaV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBJZ25vcmUgZXhjZXB0aW9ucyByYWlzZWQgaW4gT2JzZXJ2ZXJzIG9yIG1pc3NpbmcgbWV0aG9kcyBvZiBhblxuICAgICAgICAgICAgICAgICAgICAvLyBPYnNlcnZlci5cbiAgICAgICAgICAgICAgICAgICAgLy8gTG9nIGVycm9yIHRvIGNvbnNvbGUuIGIvMzE0MDQ4MDZcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJyAmJiBjb25zb2xlLmVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIE9ic2VydmVyUHJveHkucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gKGVycikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAodGhpcy5maW5hbGl6ZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmZpbmFsaXplZCA9IHRydWU7XG4gICAgICAgIGlmIChlcnIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5maW5hbEVycm9yID0gZXJyO1xuICAgICAgICB9XG4gICAgICAgIC8vIFByb3h5IGlzIG5vIGxvbmdlciBuZWVkZWQgLSBnYXJiYWdlIGNvbGxlY3QgcmVmZXJlbmNlc1xuICAgICAgICB0aGlzLnRhc2sudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfdGhpcy5vYnNlcnZlcnMgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICBfdGhpcy5vbk5vT2JzZXJ2ZXJzID0gdW5kZWZpbmVkO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiBPYnNlcnZlclByb3h5O1xufSgpKTtcbi8qKiBUdXJuIHN5bmNocm9ub3VzIGZ1bmN0aW9uIGludG8gb25lIGNhbGxlZCBhc3luY2hyb25vdXNseS4gKi9cbmZ1bmN0aW9uIGFzeW5jKGZuLCBvbkVycm9yKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICBQcm9taXNlLnJlc29sdmUodHJ1ZSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGZuLmFwcGx5KHZvaWQgMCwgYXJncyk7XG4gICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IoZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xufVxuZXhwb3J0cy5hc3luYyA9IGFzeW5jO1xuLyoqXG4gKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgb2JqZWN0IHBhc3NlZCBpbiBpbXBsZW1lbnRzIGFueSBvZiB0aGUgbmFtZWQgbWV0aG9kcy5cbiAqL1xuZnVuY3Rpb24gaW1wbGVtZW50c0FueU1ldGhvZHMob2JqLCBtZXRob2RzKSB7XG4gICAgaWYgKHR5cGVvZiBvYmogIT09ICdvYmplY3QnIHx8IG9iaiA9PT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGZvciAodmFyIF9pID0gMCwgbWV0aG9kc18xID0gbWV0aG9kczsgX2kgPCBtZXRob2RzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBtZXRob2QgPSBtZXRob2RzXzFbX2ldO1xuICAgICAgICBpZiAobWV0aG9kIGluIG9iaiAmJiB0eXBlb2Ygb2JqW21ldGhvZF0gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cbmZ1bmN0aW9uIG5vb3AoKSB7XG4gICAgLy8gZG8gbm90aGluZ1xufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1zdWJzY3JpYmUuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgYXNzZXJ0XzEgPSByZXF1aXJlKFwiLi9hc3NlcnRcIik7XG4vLyBDb2RlIG9yaWdpbmFsbHkgY2FtZSBmcm9tIGdvb2cuY3J5cHQuc3RyaW5nVG9VdGY4Qnl0ZUFycmF5LCBidXQgZm9yIHNvbWUgcmVhc29uIHRoZXlcbi8vIGF1dG9tYXRpY2FsbHkgcmVwbGFjZWQgJ1xcclxcbicgd2l0aCAnXFxuJywgYW5kIHRoZXkgZGlkbid0IGhhbmRsZSBzdXJyb2dhdGUgcGFpcnMsXG4vLyBzbyBpdCdzIGJlZW4gbW9kaWZpZWQuXG4vLyBOb3RlIHRoYXQgbm90IGFsbCBVbmljb2RlIGNoYXJhY3RlcnMgYXBwZWFyIGFzIHNpbmdsZSBjaGFyYWN0ZXJzIGluIEphdmFTY3JpcHQgc3RyaW5ncy5cbi8vIGZyb21DaGFyQ29kZSByZXR1cm5zIHRoZSBVVEYtMTYgZW5jb2Rpbmcgb2YgYSBjaGFyYWN0ZXIgLSBzbyBzb21lIFVuaWNvZGUgY2hhcmFjdGVyc1xuLy8gdXNlIDIgY2hhcmFjdGVycyBpbiBKYXZhc2NyaXB0LiAgQWxsIDQtYnl0ZSBVVEYtOCBjaGFyYWN0ZXJzIGJlZ2luIHdpdGggYSBmaXJzdFxuLy8gY2hhcmFjdGVyIGluIHRoZSByYW5nZSAweEQ4MDAgLSAweERCRkYgKHRoZSBmaXJzdCBjaGFyYWN0ZXIgb2YgYSBzby1jYWxsZWQgc3Vycm9nYXRlXG4vLyBwYWlyKS5cbi8vIFNlZSBodHRwOi8vd3d3LmVjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNS4xLyNzZWMtMTUuMS4zXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHJcbiAqIEByZXR1cm4ge0FycmF5fVxuICovXG5leHBvcnRzLnN0cmluZ1RvQnl0ZUFycmF5ID0gZnVuY3Rpb24gKHN0cikge1xuICAgIHZhciBvdXQgPSBbXSwgcCA9IDA7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGMgPSBzdHIuY2hhckNvZGVBdChpKTtcbiAgICAgICAgLy8gSXMgdGhpcyB0aGUgbGVhZCBzdXJyb2dhdGUgaW4gYSBzdXJyb2dhdGUgcGFpcj9cbiAgICAgICAgaWYgKGMgPj0gMHhkODAwICYmIGMgPD0gMHhkYmZmKSB7XG4gICAgICAgICAgICB2YXIgaGlnaCA9IGMgLSAweGQ4MDA7IC8vIHRoZSBoaWdoIDEwIGJpdHMuXG4gICAgICAgICAgICBpKys7XG4gICAgICAgICAgICBhc3NlcnRfMS5hc3NlcnQoaSA8IHN0ci5sZW5ndGgsICdTdXJyb2dhdGUgcGFpciBtaXNzaW5nIHRyYWlsIHN1cnJvZ2F0ZS4nKTtcbiAgICAgICAgICAgIHZhciBsb3cgPSBzdHIuY2hhckNvZGVBdChpKSAtIDB4ZGMwMDsgLy8gdGhlIGxvdyAxMCBiaXRzLlxuICAgICAgICAgICAgYyA9IDB4MTAwMDAgKyAoaGlnaCA8PCAxMCkgKyBsb3c7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGMgPCAxMjgpIHtcbiAgICAgICAgICAgIG91dFtwKytdID0gYztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjIDwgMjA0OCkge1xuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyA+PiA2KSB8IDE5MjtcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgJiA2MykgfCAxMjg7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoYyA8IDY1NTM2KSB7XG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjID4+IDEyKSB8IDIyNDtcbiAgICAgICAgICAgIG91dFtwKytdID0gKChjID4+IDYpICYgNjMpIHwgMTI4O1xuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyAmIDYzKSB8IDEyODtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgPj4gMTgpIHwgMjQwO1xuICAgICAgICAgICAgb3V0W3ArK10gPSAoKGMgPj4gMTIpICYgNjMpIHwgMTI4O1xuICAgICAgICAgICAgb3V0W3ArK10gPSAoKGMgPj4gNikgJiA2MykgfCAxMjg7XG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjICYgNjMpIHwgMTI4O1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvdXQ7XG59O1xuLyoqXG4gKiBDYWxjdWxhdGUgbGVuZ3RoIHdpdGhvdXQgYWN0dWFsbHkgY29udmVydGluZzsgdXNlZnVsIGZvciBkb2luZyBjaGVhcGVyIHZhbGlkYXRpb24uXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyXG4gKiBAcmV0dXJuIHtudW1iZXJ9XG4gKi9cbmV4cG9ydHMuc3RyaW5nTGVuZ3RoID0gZnVuY3Rpb24gKHN0cikge1xuICAgIHZhciBwID0gMDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgYyA9IHN0ci5jaGFyQ29kZUF0KGkpO1xuICAgICAgICBpZiAoYyA8IDEyOCkge1xuICAgICAgICAgICAgcCsrO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGMgPCAyMDQ4KSB7XG4gICAgICAgICAgICBwICs9IDI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoYyA+PSAweGQ4MDAgJiYgYyA8PSAweGRiZmYpIHtcbiAgICAgICAgICAgIC8vIExlYWQgc3Vycm9nYXRlIG9mIGEgc3Vycm9nYXRlIHBhaXIuICBUaGUgcGFpciB0b2dldGhlciB3aWxsIHRha2UgNCBieXRlcyB0byByZXByZXNlbnQuXG4gICAgICAgICAgICBwICs9IDQ7XG4gICAgICAgICAgICBpKys7IC8vIHNraXAgdHJhaWwgc3Vycm9nYXRlLlxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcCArPSAzO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBwO1xufTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dXRmOC5qcy5tYXBcbiIsIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbi8qKlxuICogQ2hlY2sgdG8gbWFrZSBzdXJlIHRoZSBhcHByb3ByaWF0ZSBudW1iZXIgb2YgYXJndW1lbnRzIGFyZSBwcm92aWRlZCBmb3IgYSBwdWJsaWMgZnVuY3Rpb24uXG4gKiBUaHJvd3MgYW4gZXJyb3IgaWYgaXQgZmFpbHMuXG4gKlxuICogQHBhcmFtIHshc3RyaW5nfSBmbk5hbWUgVGhlIGZ1bmN0aW9uIG5hbWVcbiAqIEBwYXJhbSB7IW51bWJlcn0gbWluQ291bnQgVGhlIG1pbmltdW0gbnVtYmVyIG9mIGFyZ3VtZW50cyB0byBhbGxvdyBmb3IgdGhlIGZ1bmN0aW9uIGNhbGxcbiAqIEBwYXJhbSB7IW51bWJlcn0gbWF4Q291bnQgVGhlIG1heGltdW0gbnVtYmVyIG9mIGFyZ3VtZW50IHRvIGFsbG93IGZvciB0aGUgZnVuY3Rpb24gY2FsbFxuICogQHBhcmFtIHshbnVtYmVyfSBhcmdDb3VudCBUaGUgYWN0dWFsIG51bWJlciBvZiBhcmd1bWVudHMgcHJvdmlkZWQuXG4gKi9cbmV4cG9ydHMudmFsaWRhdGVBcmdDb3VudCA9IGZ1bmN0aW9uIChmbk5hbWUsIG1pbkNvdW50LCBtYXhDb3VudCwgYXJnQ291bnQpIHtcbiAgICB2YXIgYXJnRXJyb3I7XG4gICAgaWYgKGFyZ0NvdW50IDwgbWluQ291bnQpIHtcbiAgICAgICAgYXJnRXJyb3IgPSAnYXQgbGVhc3QgJyArIG1pbkNvdW50O1xuICAgIH1cbiAgICBlbHNlIGlmIChhcmdDb3VudCA+IG1heENvdW50KSB7XG4gICAgICAgIGFyZ0Vycm9yID0gbWF4Q291bnQgPT09IDAgPyAnbm9uZScgOiAnbm8gbW9yZSB0aGFuICcgKyBtYXhDb3VudDtcbiAgICB9XG4gICAgaWYgKGFyZ0Vycm9yKSB7XG4gICAgICAgIHZhciBlcnJvciA9IGZuTmFtZSArXG4gICAgICAgICAgICAnIGZhaWxlZDogV2FzIGNhbGxlZCB3aXRoICcgK1xuICAgICAgICAgICAgYXJnQ291bnQgK1xuICAgICAgICAgICAgKGFyZ0NvdW50ID09PSAxID8gJyBhcmd1bWVudC4nIDogJyBhcmd1bWVudHMuJykgK1xuICAgICAgICAgICAgJyBFeHBlY3RzICcgK1xuICAgICAgICAgICAgYXJnRXJyb3IgK1xuICAgICAgICAgICAgJy4nO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IpO1xuICAgIH1cbn07XG4vKipcbiAqIEdlbmVyYXRlcyBhIHN0cmluZyB0byBwcmVmaXggYW4gZXJyb3IgbWVzc2FnZSBhYm91dCBmYWlsZWQgYXJndW1lbnQgdmFsaWRhdGlvblxuICpcbiAqIEBwYXJhbSB7IXN0cmluZ30gZm5OYW1lIFRoZSBmdW5jdGlvbiBuYW1lXG4gKiBAcGFyYW0geyFudW1iZXJ9IGFyZ3VtZW50TnVtYmVyIFRoZSBpbmRleCBvZiB0aGUgYXJndW1lbnRcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gb3B0aW9uYWwgV2hldGhlciBvciBub3QgdGhlIGFyZ3VtZW50IGlzIG9wdGlvbmFsXG4gKiBAcmV0dXJuIHshc3RyaW5nfSBUaGUgcHJlZml4IHRvIGFkZCB0byB0aGUgZXJyb3IgdGhyb3duIGZvciB2YWxpZGF0aW9uLlxuICovXG5mdW5jdGlvbiBlcnJvclByZWZpeChmbk5hbWUsIGFyZ3VtZW50TnVtYmVyLCBvcHRpb25hbCkge1xuICAgIHZhciBhcmdOYW1lID0gJyc7XG4gICAgc3dpdGNoIChhcmd1bWVudE51bWJlcikge1xuICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICBhcmdOYW1lID0gb3B0aW9uYWwgPyAnZmlyc3QnIDogJ0ZpcnN0JztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICBhcmdOYW1lID0gb3B0aW9uYWwgPyAnc2Vjb25kJyA6ICdTZWNvbmQnO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgIGFyZ05hbWUgPSBvcHRpb25hbCA/ICd0aGlyZCcgOiAnVGhpcmQnO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgIGFyZ05hbWUgPSBvcHRpb25hbCA/ICdmb3VydGgnIDogJ0ZvdXJ0aCc7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignZXJyb3JQcmVmaXggY2FsbGVkIHdpdGggYXJndW1lbnROdW1iZXIgPiA0LiAgTmVlZCB0byB1cGRhdGUgaXQ/Jyk7XG4gICAgfVxuICAgIHZhciBlcnJvciA9IGZuTmFtZSArICcgZmFpbGVkOiAnO1xuICAgIGVycm9yICs9IGFyZ05hbWUgKyAnIGFyZ3VtZW50ICc7XG4gICAgcmV0dXJuIGVycm9yO1xufVxuZXhwb3J0cy5lcnJvclByZWZpeCA9IGVycm9yUHJlZml4O1xuLyoqXG4gKiBAcGFyYW0geyFzdHJpbmd9IGZuTmFtZVxuICogQHBhcmFtIHshbnVtYmVyfSBhcmd1bWVudE51bWJlclxuICogQHBhcmFtIHshc3RyaW5nfSBuYW1lc3BhY2VcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gb3B0aW9uYWxcbiAqL1xuZnVuY3Rpb24gdmFsaWRhdGVOYW1lc3BhY2UoZm5OYW1lLCBhcmd1bWVudE51bWJlciwgbmFtZXNwYWNlLCBvcHRpb25hbCkge1xuICAgIGlmIChvcHRpb25hbCAmJiAhbmFtZXNwYWNlKVxuICAgICAgICByZXR1cm47XG4gICAgaWYgKHR5cGVvZiBuYW1lc3BhY2UgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgIC8vVE9ETzogSSBzaG91bGQgZG8gbW9yZSB2YWxpZGF0aW9uIGhlcmUuIFdlIG9ubHkgYWxsb3cgY2VydGFpbiBjaGFycyBpbiBuYW1lc3BhY2VzLlxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JQcmVmaXgoZm5OYW1lLCBhcmd1bWVudE51bWJlciwgb3B0aW9uYWwpICtcbiAgICAgICAgICAgICdtdXN0IGJlIGEgdmFsaWQgZmlyZWJhc2UgbmFtZXNwYWNlLicpO1xuICAgIH1cbn1cbmV4cG9ydHMudmFsaWRhdGVOYW1lc3BhY2UgPSB2YWxpZGF0ZU5hbWVzcGFjZTtcbmZ1bmN0aW9uIHZhbGlkYXRlQ2FsbGJhY2soZm5OYW1lLCBhcmd1bWVudE51bWJlciwgY2FsbGJhY2ssIG9wdGlvbmFsKSB7XG4gICAgaWYgKG9wdGlvbmFsICYmICFjYWxsYmFjaylcbiAgICAgICAgcmV0dXJuO1xuICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgIT09ICdmdW5jdGlvbicpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvclByZWZpeChmbk5hbWUsIGFyZ3VtZW50TnVtYmVyLCBvcHRpb25hbCkgK1xuICAgICAgICAgICAgJ211c3QgYmUgYSB2YWxpZCBmdW5jdGlvbi4nKTtcbn1cbmV4cG9ydHMudmFsaWRhdGVDYWxsYmFjayA9IHZhbGlkYXRlQ2FsbGJhY2s7XG5mdW5jdGlvbiB2YWxpZGF0ZUNvbnRleHRPYmplY3QoZm5OYW1lLCBhcmd1bWVudE51bWJlciwgY29udGV4dCwgb3B0aW9uYWwpIHtcbiAgICBpZiAob3B0aW9uYWwgJiYgIWNvbnRleHQpXG4gICAgICAgIHJldHVybjtcbiAgICBpZiAodHlwZW9mIGNvbnRleHQgIT09ICdvYmplY3QnIHx8IGNvbnRleHQgPT09IG51bGwpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvclByZWZpeChmbk5hbWUsIGFyZ3VtZW50TnVtYmVyLCBvcHRpb25hbCkgK1xuICAgICAgICAgICAgJ211c3QgYmUgYSB2YWxpZCBjb250ZXh0IG9iamVjdC4nKTtcbn1cbmV4cG9ydHMudmFsaWRhdGVDb250ZXh0T2JqZWN0ID0gdmFsaWRhdGVDb250ZXh0T2JqZWN0O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD12YWxpZGF0aW9uLmpzLm1hcFxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxucmVxdWlyZSgnQGZpcmViYXNlL3BvbHlmaWxsJyk7XG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJ0BmaXJlYmFzZS9hcHAnKS5kZWZhdWx0O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxucmVxdWlyZSgnQGZpcmViYXNlL2F1dGgnKTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnQGZpcmViYXNlL2RhdGFiYXNlJyk7XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG52YXIgZmlyZWJhc2UgPSByZXF1aXJlKCcuL2FwcCcpO1xucmVxdWlyZSgnLi9hdXRoJyk7XG5yZXF1aXJlKCcuL2RhdGFiYXNlJyk7XG5yZXF1aXJlKCcuL21lc3NhZ2luZycpO1xucmVxdWlyZSgnLi9zdG9yYWdlJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gZmlyZWJhc2U7XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5yZXF1aXJlKCdAZmlyZWJhc2UvbWVzc2FnaW5nJyk7XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5yZXF1aXJlKCdAZmlyZWJhc2Uvc3RvcmFnZScpO1xuIiwiLy8gc2hpbSBmb3IgdXNpbmcgcHJvY2VzcyBpbiBicm93c2VyXG52YXIgcHJvY2VzcyA9IG1vZHVsZS5leHBvcnRzID0ge307XG5cbi8vIGNhY2hlZCBmcm9tIHdoYXRldmVyIGdsb2JhbCBpcyBwcmVzZW50IHNvIHRoYXQgdGVzdCBydW5uZXJzIHRoYXQgc3R1YiBpdFxuLy8gZG9uJ3QgYnJlYWsgdGhpbmdzLiAgQnV0IHdlIG5lZWQgdG8gd3JhcCBpdCBpbiBhIHRyeSBjYXRjaCBpbiBjYXNlIGl0IGlzXG4vLyB3cmFwcGVkIGluIHN0cmljdCBtb2RlIGNvZGUgd2hpY2ggZG9lc24ndCBkZWZpbmUgYW55IGdsb2JhbHMuICBJdCdzIGluc2lkZSBhXG4vLyBmdW5jdGlvbiBiZWNhdXNlIHRyeS9jYXRjaGVzIGRlb3B0aW1pemUgaW4gY2VydGFpbiBlbmdpbmVzLlxuXG52YXIgY2FjaGVkU2V0VGltZW91dDtcbnZhciBjYWNoZWRDbGVhclRpbWVvdXQ7XG5cbmZ1bmN0aW9uIGRlZmF1bHRTZXRUaW1vdXQoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdzZXRUaW1lb3V0IGhhcyBub3QgYmVlbiBkZWZpbmVkJyk7XG59XG5mdW5jdGlvbiBkZWZhdWx0Q2xlYXJUaW1lb3V0ICgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2NsZWFyVGltZW91dCBoYXMgbm90IGJlZW4gZGVmaW5lZCcpO1xufVxuKGZ1bmN0aW9uICgpIHtcbiAgICB0cnkge1xuICAgICAgICBpZiAodHlwZW9mIHNldFRpbWVvdXQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBzZXRUaW1lb3V0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IGRlZmF1bHRTZXRUaW1vdXQ7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBkZWZhdWx0U2V0VGltb3V0O1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICBpZiAodHlwZW9mIGNsZWFyVGltZW91dCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gY2xlYXJUaW1lb3V0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gZGVmYXVsdENsZWFyVGltZW91dDtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gZGVmYXVsdENsZWFyVGltZW91dDtcbiAgICB9XG59ICgpKVxuZnVuY3Rpb24gcnVuVGltZW91dChmdW4pIHtcbiAgICBpZiAoY2FjaGVkU2V0VGltZW91dCA9PT0gc2V0VGltZW91dCkge1xuICAgICAgICAvL25vcm1hbCBlbnZpcm9tZW50cyBpbiBzYW5lIHNpdHVhdGlvbnNcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuLCAwKTtcbiAgICB9XG4gICAgLy8gaWYgc2V0VGltZW91dCB3YXNuJ3QgYXZhaWxhYmxlIGJ1dCB3YXMgbGF0dGVyIGRlZmluZWRcbiAgICBpZiAoKGNhY2hlZFNldFRpbWVvdXQgPT09IGRlZmF1bHRTZXRUaW1vdXQgfHwgIWNhY2hlZFNldFRpbWVvdXQpICYmIHNldFRpbWVvdXQpIHtcbiAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IHNldFRpbWVvdXQ7XG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1biwgMCk7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIC8vIHdoZW4gd2hlbiBzb21lYm9keSBoYXMgc2NyZXdlZCB3aXRoIHNldFRpbWVvdXQgYnV0IG5vIEkuRS4gbWFkZG5lc3NcbiAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQoZnVuLCAwKTtcbiAgICB9IGNhdGNoKGUpe1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gV2hlbiB3ZSBhcmUgaW4gSS5FLiBidXQgdGhlIHNjcmlwdCBoYXMgYmVlbiBldmFsZWQgc28gSS5FLiBkb2Vzbid0IHRydXN0IHRoZSBnbG9iYWwgb2JqZWN0IHdoZW4gY2FsbGVkIG5vcm1hbGx5XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dC5jYWxsKG51bGwsIGZ1biwgMCk7XG4gICAgICAgIH0gY2F0Y2goZSl7XG4gICAgICAgICAgICAvLyBzYW1lIGFzIGFib3ZlIGJ1dCB3aGVuIGl0J3MgYSB2ZXJzaW9uIG9mIEkuRS4gdGhhdCBtdXN0IGhhdmUgdGhlIGdsb2JhbCBvYmplY3QgZm9yICd0aGlzJywgaG9wZnVsbHkgb3VyIGNvbnRleHQgY29ycmVjdCBvdGhlcndpc2UgaXQgd2lsbCB0aHJvdyBhIGdsb2JhbCBlcnJvclxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQuY2FsbCh0aGlzLCBmdW4sIDApO1xuICAgICAgICB9XG4gICAgfVxuXG5cbn1cbmZ1bmN0aW9uIHJ1bkNsZWFyVGltZW91dChtYXJrZXIpIHtcbiAgICBpZiAoY2FjaGVkQ2xlYXJUaW1lb3V0ID09PSBjbGVhclRpbWVvdXQpIHtcbiAgICAgICAgLy9ub3JtYWwgZW52aXJvbWVudHMgaW4gc2FuZSBzaXR1YXRpb25zXG4gICAgICAgIHJldHVybiBjbGVhclRpbWVvdXQobWFya2VyKTtcbiAgICB9XG4gICAgLy8gaWYgY2xlYXJUaW1lb3V0IHdhc24ndCBhdmFpbGFibGUgYnV0IHdhcyBsYXR0ZXIgZGVmaW5lZFxuICAgIGlmICgoY2FjaGVkQ2xlYXJUaW1lb3V0ID09PSBkZWZhdWx0Q2xlYXJUaW1lb3V0IHx8ICFjYWNoZWRDbGVhclRpbWVvdXQpICYmIGNsZWFyVGltZW91dCkge1xuICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBjbGVhclRpbWVvdXQ7XG4gICAgICAgIHJldHVybiBjbGVhclRpbWVvdXQobWFya2VyKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgLy8gd2hlbiB3aGVuIHNvbWVib2R5IGhhcyBzY3Jld2VkIHdpdGggc2V0VGltZW91dCBidXQgbm8gSS5FLiBtYWRkbmVzc1xuICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0KG1hcmtlcik7XG4gICAgfSBjYXRjaCAoZSl7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBXaGVuIHdlIGFyZSBpbiBJLkUuIGJ1dCB0aGUgc2NyaXB0IGhhcyBiZWVuIGV2YWxlZCBzbyBJLkUuIGRvZXNuJ3QgIHRydXN0IHRoZSBnbG9iYWwgb2JqZWN0IHdoZW4gY2FsbGVkIG5vcm1hbGx5XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0LmNhbGwobnVsbCwgbWFya2VyKTtcbiAgICAgICAgfSBjYXRjaCAoZSl7XG4gICAgICAgICAgICAvLyBzYW1lIGFzIGFib3ZlIGJ1dCB3aGVuIGl0J3MgYSB2ZXJzaW9uIG9mIEkuRS4gdGhhdCBtdXN0IGhhdmUgdGhlIGdsb2JhbCBvYmplY3QgZm9yICd0aGlzJywgaG9wZnVsbHkgb3VyIGNvbnRleHQgY29ycmVjdCBvdGhlcndpc2UgaXQgd2lsbCB0aHJvdyBhIGdsb2JhbCBlcnJvci5cbiAgICAgICAgICAgIC8vIFNvbWUgdmVyc2lvbnMgb2YgSS5FLiBoYXZlIGRpZmZlcmVudCBydWxlcyBmb3IgY2xlYXJUaW1lb3V0IHZzIHNldFRpbWVvdXRcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQuY2FsbCh0aGlzLCBtYXJrZXIpO1xuICAgICAgICB9XG4gICAgfVxuXG5cblxufVxudmFyIHF1ZXVlID0gW107XG52YXIgZHJhaW5pbmcgPSBmYWxzZTtcbnZhciBjdXJyZW50UXVldWU7XG52YXIgcXVldWVJbmRleCA9IC0xO1xuXG5mdW5jdGlvbiBjbGVhblVwTmV4dFRpY2soKSB7XG4gICAgaWYgKCFkcmFpbmluZyB8fCAhY3VycmVudFF1ZXVlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZHJhaW5pbmcgPSBmYWxzZTtcbiAgICBpZiAoY3VycmVudFF1ZXVlLmxlbmd0aCkge1xuICAgICAgICBxdWV1ZSA9IGN1cnJlbnRRdWV1ZS5jb25jYXQocXVldWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHF1ZXVlSW5kZXggPSAtMTtcbiAgICB9XG4gICAgaWYgKHF1ZXVlLmxlbmd0aCkge1xuICAgICAgICBkcmFpblF1ZXVlKCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBkcmFpblF1ZXVlKCkge1xuICAgIGlmIChkcmFpbmluZykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciB0aW1lb3V0ID0gcnVuVGltZW91dChjbGVhblVwTmV4dFRpY2spO1xuICAgIGRyYWluaW5nID0gdHJ1ZTtcblxuICAgIHZhciBsZW4gPSBxdWV1ZS5sZW5ndGg7XG4gICAgd2hpbGUobGVuKSB7XG4gICAgICAgIGN1cnJlbnRRdWV1ZSA9IHF1ZXVlO1xuICAgICAgICBxdWV1ZSA9IFtdO1xuICAgICAgICB3aGlsZSAoKytxdWV1ZUluZGV4IDwgbGVuKSB7XG4gICAgICAgICAgICBpZiAoY3VycmVudFF1ZXVlKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFF1ZXVlW3F1ZXVlSW5kZXhdLnJ1bigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHF1ZXVlSW5kZXggPSAtMTtcbiAgICAgICAgbGVuID0gcXVldWUubGVuZ3RoO1xuICAgIH1cbiAgICBjdXJyZW50UXVldWUgPSBudWxsO1xuICAgIGRyYWluaW5nID0gZmFsc2U7XG4gICAgcnVuQ2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xufVxuXG5wcm9jZXNzLm5leHRUaWNrID0gZnVuY3Rpb24gKGZ1bikge1xuICAgIHZhciBhcmdzID0gbmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGggLSAxKTtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGFyZ3NbaSAtIDFdID0gYXJndW1lbnRzW2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHF1ZXVlLnB1c2gobmV3IEl0ZW0oZnVuLCBhcmdzKSk7XG4gICAgaWYgKHF1ZXVlLmxlbmd0aCA9PT0gMSAmJiAhZHJhaW5pbmcpIHtcbiAgICAgICAgcnVuVGltZW91dChkcmFpblF1ZXVlKTtcbiAgICB9XG59O1xuXG4vLyB2OCBsaWtlcyBwcmVkaWN0aWJsZSBvYmplY3RzXG5mdW5jdGlvbiBJdGVtKGZ1biwgYXJyYXkpIHtcbiAgICB0aGlzLmZ1biA9IGZ1bjtcbiAgICB0aGlzLmFycmF5ID0gYXJyYXk7XG59XG5JdGVtLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5mdW4uYXBwbHkobnVsbCwgdGhpcy5hcnJheSk7XG59O1xucHJvY2Vzcy50aXRsZSA9ICdicm93c2VyJztcbnByb2Nlc3MuYnJvd3NlciA9IHRydWU7XG5wcm9jZXNzLmVudiA9IHt9O1xucHJvY2Vzcy5hcmd2ID0gW107XG5wcm9jZXNzLnZlcnNpb24gPSAnJzsgLy8gZW1wdHkgc3RyaW5nIHRvIGF2b2lkIHJlZ2V4cCBpc3N1ZXNcbnByb2Nlc3MudmVyc2lvbnMgPSB7fTtcblxuZnVuY3Rpb24gbm9vcCgpIHt9XG5cbnByb2Nlc3Mub24gPSBub29wO1xucHJvY2Vzcy5hZGRMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLm9uY2UgPSBub29wO1xucHJvY2Vzcy5vZmYgPSBub29wO1xucHJvY2Vzcy5yZW1vdmVMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUFsbExpc3RlbmVycyA9IG5vb3A7XG5wcm9jZXNzLmVtaXQgPSBub29wO1xucHJvY2Vzcy5wcmVwZW5kTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5wcmVwZW5kT25jZUxpc3RlbmVyID0gbm9vcDtcblxucHJvY2Vzcy5saXN0ZW5lcnMgPSBmdW5jdGlvbiAobmFtZSkgeyByZXR1cm4gW10gfVxuXG5wcm9jZXNzLmJpbmRpbmcgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5iaW5kaW5nIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5cbnByb2Nlc3MuY3dkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gJy8nIH07XG5wcm9jZXNzLmNoZGlyID0gZnVuY3Rpb24gKGRpcikge1xuICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5jaGRpciBpcyBub3Qgc3VwcG9ydGVkJyk7XG59O1xucHJvY2Vzcy51bWFzayA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gMDsgfTtcbiIsIihmdW5jdGlvbiAocm9vdCkge1xuXG4gIC8vIFN0b3JlIHNldFRpbWVvdXQgcmVmZXJlbmNlIHNvIHByb21pc2UtcG9seWZpbGwgd2lsbCBiZSB1bmFmZmVjdGVkIGJ5XG4gIC8vIG90aGVyIGNvZGUgbW9kaWZ5aW5nIHNldFRpbWVvdXQgKGxpa2Ugc2lub24udXNlRmFrZVRpbWVycygpKVxuICB2YXIgc2V0VGltZW91dEZ1bmMgPSBzZXRUaW1lb3V0O1xuXG4gIGZ1bmN0aW9uIG5vb3AoKSB7fVxuICBcbiAgLy8gUG9seWZpbGwgZm9yIEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kXG4gIGZ1bmN0aW9uIGJpbmQoZm4sIHRoaXNBcmcpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgZm4uYXBwbHkodGhpc0FyZywgYXJndW1lbnRzKTtcbiAgICB9O1xuICB9XG5cbiAgZnVuY3Rpb24gUHJvbWlzZShmbikge1xuICAgIGlmICh0eXBlb2YgdGhpcyAhPT0gJ29iamVjdCcpIHRocm93IG5ldyBUeXBlRXJyb3IoJ1Byb21pc2VzIG11c3QgYmUgY29uc3RydWN0ZWQgdmlhIG5ldycpO1xuICAgIGlmICh0eXBlb2YgZm4gIT09ICdmdW5jdGlvbicpIHRocm93IG5ldyBUeXBlRXJyb3IoJ25vdCBhIGZ1bmN0aW9uJyk7XG4gICAgdGhpcy5fc3RhdGUgPSAwO1xuICAgIHRoaXMuX2hhbmRsZWQgPSBmYWxzZTtcbiAgICB0aGlzLl92YWx1ZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLl9kZWZlcnJlZHMgPSBbXTtcblxuICAgIGRvUmVzb2x2ZShmbiwgdGhpcyk7XG4gIH1cblxuICBmdW5jdGlvbiBoYW5kbGUoc2VsZiwgZGVmZXJyZWQpIHtcbiAgICB3aGlsZSAoc2VsZi5fc3RhdGUgPT09IDMpIHtcbiAgICAgIHNlbGYgPSBzZWxmLl92YWx1ZTtcbiAgICB9XG4gICAgaWYgKHNlbGYuX3N0YXRlID09PSAwKSB7XG4gICAgICBzZWxmLl9kZWZlcnJlZHMucHVzaChkZWZlcnJlZCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHNlbGYuX2hhbmRsZWQgPSB0cnVlO1xuICAgIFByb21pc2UuX2ltbWVkaWF0ZUZuKGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBjYiA9IHNlbGYuX3N0YXRlID09PSAxID8gZGVmZXJyZWQub25GdWxmaWxsZWQgOiBkZWZlcnJlZC5vblJlamVjdGVkO1xuICAgICAgaWYgKGNiID09PSBudWxsKSB7XG4gICAgICAgIChzZWxmLl9zdGF0ZSA9PT0gMSA/IHJlc29sdmUgOiByZWplY3QpKGRlZmVycmVkLnByb21pc2UsIHNlbGYuX3ZhbHVlKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdmFyIHJldDtcbiAgICAgIHRyeSB7XG4gICAgICAgIHJldCA9IGNiKHNlbGYuX3ZhbHVlKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgcmVqZWN0KGRlZmVycmVkLnByb21pc2UsIGUpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICByZXNvbHZlKGRlZmVycmVkLnByb21pc2UsIHJldCk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiByZXNvbHZlKHNlbGYsIG5ld1ZhbHVlKSB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFByb21pc2UgUmVzb2x1dGlvbiBQcm9jZWR1cmU6IGh0dHBzOi8vZ2l0aHViLmNvbS9wcm9taXNlcy1hcGx1cy9wcm9taXNlcy1zcGVjI3RoZS1wcm9taXNlLXJlc29sdXRpb24tcHJvY2VkdXJlXG4gICAgICBpZiAobmV3VmFsdWUgPT09IHNlbGYpIHRocm93IG5ldyBUeXBlRXJyb3IoJ0EgcHJvbWlzZSBjYW5ub3QgYmUgcmVzb2x2ZWQgd2l0aCBpdHNlbGYuJyk7XG4gICAgICBpZiAobmV3VmFsdWUgJiYgKHR5cGVvZiBuZXdWYWx1ZSA9PT0gJ29iamVjdCcgfHwgdHlwZW9mIG5ld1ZhbHVlID09PSAnZnVuY3Rpb24nKSkge1xuICAgICAgICB2YXIgdGhlbiA9IG5ld1ZhbHVlLnRoZW47XG4gICAgICAgIGlmIChuZXdWYWx1ZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICBzZWxmLl9zdGF0ZSA9IDM7XG4gICAgICAgICAgc2VsZi5fdmFsdWUgPSBuZXdWYWx1ZTtcbiAgICAgICAgICBmaW5hbGUoc2VsZik7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB0aGVuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgZG9SZXNvbHZlKGJpbmQodGhlbiwgbmV3VmFsdWUpLCBzZWxmKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHNlbGYuX3N0YXRlID0gMTtcbiAgICAgIHNlbGYuX3ZhbHVlID0gbmV3VmFsdWU7XG4gICAgICBmaW5hbGUoc2VsZik7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgcmVqZWN0KHNlbGYsIGUpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHJlamVjdChzZWxmLCBuZXdWYWx1ZSkge1xuICAgIHNlbGYuX3N0YXRlID0gMjtcbiAgICBzZWxmLl92YWx1ZSA9IG5ld1ZhbHVlO1xuICAgIGZpbmFsZShzZWxmKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGZpbmFsZShzZWxmKSB7XG4gICAgaWYgKHNlbGYuX3N0YXRlID09PSAyICYmIHNlbGYuX2RlZmVycmVkcy5sZW5ndGggPT09IDApIHtcbiAgICAgIFByb21pc2UuX2ltbWVkaWF0ZUZuKGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoIXNlbGYuX2hhbmRsZWQpIHtcbiAgICAgICAgICBQcm9taXNlLl91bmhhbmRsZWRSZWplY3Rpb25GbihzZWxmLl92YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBzZWxmLl9kZWZlcnJlZHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgIGhhbmRsZShzZWxmLCBzZWxmLl9kZWZlcnJlZHNbaV0pO1xuICAgIH1cbiAgICBzZWxmLl9kZWZlcnJlZHMgPSBudWxsO1xuICB9XG5cbiAgZnVuY3Rpb24gSGFuZGxlcihvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCwgcHJvbWlzZSkge1xuICAgIHRoaXMub25GdWxmaWxsZWQgPSB0eXBlb2Ygb25GdWxmaWxsZWQgPT09ICdmdW5jdGlvbicgPyBvbkZ1bGZpbGxlZCA6IG51bGw7XG4gICAgdGhpcy5vblJlamVjdGVkID0gdHlwZW9mIG9uUmVqZWN0ZWQgPT09ICdmdW5jdGlvbicgPyBvblJlamVjdGVkIDogbnVsbDtcbiAgICB0aGlzLnByb21pc2UgPSBwcm9taXNlO1xuICB9XG5cbiAgLyoqXG4gICAqIFRha2UgYSBwb3RlbnRpYWxseSBtaXNiZWhhdmluZyByZXNvbHZlciBmdW5jdGlvbiBhbmQgbWFrZSBzdXJlXG4gICAqIG9uRnVsZmlsbGVkIGFuZCBvblJlamVjdGVkIGFyZSBvbmx5IGNhbGxlZCBvbmNlLlxuICAgKlxuICAgKiBNYWtlcyBubyBndWFyYW50ZWVzIGFib3V0IGFzeW5jaHJvbnkuXG4gICAqL1xuICBmdW5jdGlvbiBkb1Jlc29sdmUoZm4sIHNlbGYpIHtcbiAgICB2YXIgZG9uZSA9IGZhbHNlO1xuICAgIHRyeSB7XG4gICAgICBmbihmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKGRvbmUpIHJldHVybjtcbiAgICAgICAgZG9uZSA9IHRydWU7XG4gICAgICAgIHJlc29sdmUoc2VsZiwgdmFsdWUpO1xuICAgICAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xuICAgICAgICBpZiAoZG9uZSkgcmV0dXJuO1xuICAgICAgICBkb25lID0gdHJ1ZTtcbiAgICAgICAgcmVqZWN0KHNlbGYsIHJlYXNvbik7XG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChleCkge1xuICAgICAgaWYgKGRvbmUpIHJldHVybjtcbiAgICAgIGRvbmUgPSB0cnVlO1xuICAgICAgcmVqZWN0KHNlbGYsIGV4KTtcbiAgICB9XG4gIH1cblxuICBQcm9taXNlLnByb3RvdHlwZVsnY2F0Y2gnXSA9IGZ1bmN0aW9uIChvblJlamVjdGVkKSB7XG4gICAgcmV0dXJuIHRoaXMudGhlbihudWxsLCBvblJlamVjdGVkKTtcbiAgfTtcblxuICBQcm9taXNlLnByb3RvdHlwZS50aGVuID0gZnVuY3Rpb24gKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKSB7XG4gICAgdmFyIHByb20gPSBuZXcgKHRoaXMuY29uc3RydWN0b3IpKG5vb3ApO1xuXG4gICAgaGFuZGxlKHRoaXMsIG5ldyBIYW5kbGVyKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkLCBwcm9tKSk7XG4gICAgcmV0dXJuIHByb207XG4gIH07XG5cbiAgUHJvbWlzZS5hbGwgPSBmdW5jdGlvbiAoYXJyKSB7XG4gICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcnIpO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIGlmIChhcmdzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIHJlc29sdmUoW10pO1xuICAgICAgdmFyIHJlbWFpbmluZyA9IGFyZ3MubGVuZ3RoO1xuXG4gICAgICBmdW5jdGlvbiByZXMoaSwgdmFsKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgaWYgKHZhbCAmJiAodHlwZW9mIHZhbCA9PT0gJ29iamVjdCcgfHwgdHlwZW9mIHZhbCA9PT0gJ2Z1bmN0aW9uJykpIHtcbiAgICAgICAgICAgIHZhciB0aGVuID0gdmFsLnRoZW47XG4gICAgICAgICAgICBpZiAodHlwZW9mIHRoZW4gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgdGhlbi5jYWxsKHZhbCwgZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICAgICAgICAgIHJlcyhpLCB2YWwpO1xuICAgICAgICAgICAgICB9LCByZWplY3QpO1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGFyZ3NbaV0gPSB2YWw7XG4gICAgICAgICAgaWYgKC0tcmVtYWluaW5nID09PSAwKSB7XG4gICAgICAgICAgICByZXNvbHZlKGFyZ3MpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXgpIHtcbiAgICAgICAgICByZWplY3QoZXgpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJncy5sZW5ndGg7IGkrKykge1xuICAgICAgICByZXMoaSwgYXJnc1tpXSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgUHJvbWlzZS5yZXNvbHZlID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUuY29uc3RydWN0b3IgPT09IFByb21pc2UpIHtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgIHJlc29sdmUodmFsdWUpO1xuICAgIH0pO1xuICB9O1xuXG4gIFByb21pc2UucmVqZWN0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIHJlamVjdCh2YWx1ZSk7XG4gICAgfSk7XG4gIH07XG5cbiAgUHJvbWlzZS5yYWNlID0gZnVuY3Rpb24gKHZhbHVlcykge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gdmFsdWVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIHZhbHVlc1tpXS50aGVuKHJlc29sdmUsIHJlamVjdCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgLy8gVXNlIHBvbHlmaWxsIGZvciBzZXRJbW1lZGlhdGUgZm9yIHBlcmZvcm1hbmNlIGdhaW5zXG4gIFByb21pc2UuX2ltbWVkaWF0ZUZuID0gKHR5cGVvZiBzZXRJbW1lZGlhdGUgPT09ICdmdW5jdGlvbicgJiYgZnVuY3Rpb24gKGZuKSB7IHNldEltbWVkaWF0ZShmbik7IH0pIHx8XG4gICAgZnVuY3Rpb24gKGZuKSB7XG4gICAgICBzZXRUaW1lb3V0RnVuYyhmbiwgMCk7XG4gICAgfTtcblxuICBQcm9taXNlLl91bmhhbmRsZWRSZWplY3Rpb25GbiA9IGZ1bmN0aW9uIF91bmhhbmRsZWRSZWplY3Rpb25GbihlcnIpIHtcbiAgICBpZiAodHlwZW9mIGNvbnNvbGUgIT09ICd1bmRlZmluZWQnICYmIGNvbnNvbGUpIHtcbiAgICAgIGNvbnNvbGUud2FybignUG9zc2libGUgVW5oYW5kbGVkIFByb21pc2UgUmVqZWN0aW9uOicsIGVycik7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogU2V0IHRoZSBpbW1lZGlhdGUgZnVuY3Rpb24gdG8gZXhlY3V0ZSBjYWxsYmFja3NcbiAgICogQHBhcmFtIGZuIHtmdW5jdGlvbn0gRnVuY3Rpb24gdG8gZXhlY3V0ZVxuICAgKiBAZGVwcmVjYXRlZFxuICAgKi9cbiAgUHJvbWlzZS5fc2V0SW1tZWRpYXRlRm4gPSBmdW5jdGlvbiBfc2V0SW1tZWRpYXRlRm4oZm4pIHtcbiAgICBQcm9taXNlLl9pbW1lZGlhdGVGbiA9IGZuO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDaGFuZ2UgdGhlIGZ1bmN0aW9uIHRvIGV4ZWN1dGUgb24gdW5oYW5kbGVkIHJlamVjdGlvblxuICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBmbiBGdW5jdGlvbiB0byBleGVjdXRlIG9uIHVuaGFuZGxlZCByZWplY3Rpb25cbiAgICogQGRlcHJlY2F0ZWRcbiAgICovXG4gIFByb21pc2UuX3NldFVuaGFuZGxlZFJlamVjdGlvbkZuID0gZnVuY3Rpb24gX3NldFVuaGFuZGxlZFJlamVjdGlvbkZuKGZuKSB7XG4gICAgUHJvbWlzZS5fdW5oYW5kbGVkUmVqZWN0aW9uRm4gPSBmbjtcbiAgfTtcbiAgXG4gIGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyAmJiBtb2R1bGUuZXhwb3J0cykge1xuICAgIG1vZHVsZS5leHBvcnRzID0gUHJvbWlzZTtcbiAgfSBlbHNlIGlmICghcm9vdC5Qcm9taXNlKSB7XG4gICAgcm9vdC5Qcm9taXNlID0gUHJvbWlzZTtcbiAgfVxuXG59KSh0aGlzKTtcbiIsIm1vZHVsZS5leHBvcnRzID0ge1xuICAgIGFwaUtleTogXCJBSXphU3lDR1dFcHZ1eTRzUFIzbjV4endmQVRMenlNRHZ3RTZ0T1lcIixcbiAgICBhdXRoRG9tYWluOiBcImlsbGlub2lzLXRlY2gtYWNtLmZpcmViYXNlYXBwLmNvbVwiLFxuICAgIGRhdGFiYXNlVVJMOiBcImh0dHBzOi8vaWxsaW5vaXMtdGVjaC1hY20uZmlyZWJhc2Vpby5jb21cIixcbiAgICBwcm9qZWN0SWQ6IFwiaWxsaW5vaXMtdGVjaC1hY21cIixcbiAgICBzdG9yYWdlQnVja2V0OiBcImlsbGlub2lzLXRlY2gtYWNtLmFwcHNwb3QuY29tXCIsXG4gICAgbWVzc2FnaW5nU2VuZGVySWQ6IFwiMzQ0NTMzNzM0MzEwXCJcbn0iLCJsZXQgY29uZmlnID0gcmVxdWlyZSgnLi9jb25maWcnKTtcbmxldCBmaXJlYmFzZSA9IHJlcXVpcmUoJ2ZpcmViYXNlJyk7XG5sZXQgRmlyZWJhc2VBcHAgPSBmaXJlYmFzZS5pbml0aWFsaXplQXBwKGNvbmZpZyk7XG5sZXQgZGIgPSBGaXJlYmFzZUFwcC5kYXRhYmFzZSgpO1xuXG5jb25zdCBQQVJBTVMgPSBnZXRRdWVyeVBhcmFtcyhkb2N1bWVudC5sb2NhdGlvbi5zZWFyY2gpO1xuY29uc3QgR0FNRSA9IFBBUkFNUy5nYW1lO1xuXG5jb25zdCBQSU5LID0gYCNFQTM4QjlgO1xuY29uc3QgUFVSUExFID0gYCM0MjJFNkVgO1xuXG5mdW5jdGlvbiBnZXRRdWVyeVBhcmFtcyhxcykge1xuXHRxcyA9IHFzLnNwbGl0KCcrJykuam9pbignICcpO1xuXHR2YXIgcGFyYW1zID0ge30sXG5cdFx0dG9rZW5zLFxuXHRcdHJlID0gL1s/Jl0/KFtePV0rKT0oW14mXSopL2c7XG5cdHdoaWxlICh0b2tlbnMgPSByZS5leGVjKHFzKSkge1xuXHRcdHBhcmFtc1tkZWNvZGVVUklDb21wb25lbnQodG9rZW5zWzFdKV0gPSBkZWNvZGVVUklDb21wb25lbnQodG9rZW5zWzJdKTtcblx0fVxuXHRyZXR1cm4gcGFyYW1zO1xufVxuXG5mdW5jdGlvbiBvblJlc3VsdHMoZ2FtZWlkLCBjYWxsYmFjaykge1xuXHRkYi5yZWYoYGx5ZnQvcmVzdWx0cy8ke2dhbWVpZH1gKS5vbigndmFsdWUnLCAoc25hcCkgPT4ge1xuXHRcdGxldCB2YWwgPSBzbmFwLnZhbCgpIHx8IHt9O1xuXHRcdGNhbGxiYWNrKHZhbCk7XG5cdH0pO1xufVxuXG5mdW5jdGlvbiBnZXRUZWFtRGF0YShyZXMpIHtcblx0bGV0IGluTWFwID0gcmVzIHx8IHt9O1xuXHRsZXQgc2ltcyA9IE9iamVjdC5rZXlzKGluTWFwKS5tYXAoKGtleSkgPT4gcmVzW2tleV0pLnNvcnQoKGEsIGIpID0+IHtcblx0XHRyZXR1cm4gYS5zdGFydCAtIGIuc3RhcnQ7XG5cdH0pO1xuXHRsZXQgdGltZSA9IFtdO1xuXHRsZXQgbWFwID0ge307XG5cdGlmIChzaW1zLmxlbmd0aCA+IDApIHtcblx0XHRsZXQgZmlyc3QgPSBzaW1zWzBdO1xuXHRcdGZvciAobGV0IHRlYW1pZCBpbiBmaXJzdC5kYXRhKSB7XG5cdFx0XHRpZiAoISh0ZWFtaWQgaW4gbWFwKSkge1xuXHRcdFx0XHRtYXBbdGVhbWlkXSA9IHtcblx0XHRcdFx0XHRpbmZvOiB7dGVhbWlkOiB0ZWFtaWR9LFxuXHRcdFx0XHRcdHRyaXBzOiBbXSxcblx0XHRcdFx0XHRyZXZlbnVlOiBbXVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHNpbXMuZm9yRWFjaCgoc2ltKSA9PiB7XG5cdFx0XHR0aW1lLnB1c2goc2ltLnN0YXJ0KTtcblx0XHRcdGZvciAobGV0IHRlYW1pZCBpbiBzaW0uZGF0YSkge1xuXHRcdFx0XHRpZiAodGVhbWlkIGluIG1hcCkge1xuXHRcdFx0XHRcdGxldCBzdGVwID0gc2ltLmRhdGFbdGVhbWlkXTtcblx0XHRcdFx0XHRtYXBbdGVhbWlkXS50cmlwcy5wdXNoKHN0ZXAudHJpcHMpO1xuXHRcdFx0XHRcdGxldCBpblJldiA9IHN0ZXAucmV2ZW51ZTtcblx0XHRcdFx0XHRsZXQgcmV2ID0ge1xuXHRcdFx0XHRcdFx0bHlmdDogcGFyc2VGbG9hdChpblJldi5seWZ0KSxcblx0XHRcdFx0XHRcdHRheGk6IHBhcnNlRmxvYXQoaW5SZXYudGF4aSlcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0bWFwW3RlYW1pZF0ucmV2ZW51ZS5wdXNoKHJldik7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXHRyZXR1cm4ge1xuXHRcdHRpbWU6IHRpbWUsXG5cdFx0bWFwOiBtYXBcblx0fTtcbn1cblxuZnVuY3Rpb24gcGxvdE1haW4odGltZSwgbWFwKSB7XG5cdGxldCBkYXRhc2V0cyA9IFtdO1xuXHRmb3IgKGxldCB0ZWFtaWQgaW4gbWFwKSB7XG5cdFx0bGV0IGxpbmUgPSBbXTtcblx0XHRsZXQgdG90YWwgPSAwO1xuXHRcdG1hcFt0ZWFtaWRdLnJldmVudWUuZm9yRWFjaCgoc3RlcCwgaWR4KSA9PiB7XG5cdFx0XHR0b3RhbCArPSBzdGVwLmx5ZnQ7XG5cdFx0XHRsaW5lLnB1c2goe1xuXHRcdFx0XHR4OiB0aW1lW2lkeF0sXG5cdFx0XHRcdHk6IHRvdGFsXG5cdFx0XHR9KTtcblx0XHR9KTtcblx0XHRkYXRhc2V0cy5wdXNoKHtcblx0XHRcdGxhYmVsOiB0ZWFtaWQsXG5cdFx0XHRib3JkZXJDb2xvcjogUElOSyxcblx0XHRcdGZpbGw6IGZhbHNlLFxuXHRcdFx0Y3ViaWNJbnRlcnBvbGF0aW9uTW9kZTogJ21vbm90b25lJyxcblx0XHRcdGRhdGE6IGxpbmVcblx0XHR9KTtcblx0fVxuXHRsZXQgY3R4ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Bsb3QxJykuZ2V0Q29udGV4dCgnMmQnKTtcblx0bGV0IGNoYXJ0ID0gbmV3IENoYXJ0KGN0eCwge1xuXHRcdHR5cGU6IGBsaW5lYCxcblx0XHRkYXRhOiB7XG5cdFx0XHRkYXRhc2V0czogZGF0YXNldHNcblx0XHR9LFxuXHRcdG9wdGlvbnM6IHtcblx0XHRcdHJlc3BvbnNpdmU6IGZhbHNlLFxuXHRcdFx0bWFpbnRhaW5Bc3BlY3RSYXRpbzogdHJ1ZSxcblx0XHRcdGxlZ2VuZDoge1xuXHRcdFx0XHRwb3NpdGlvbjogYGJvdHRvbWAsXG5cdFx0XHR9LFxuXHRcdFx0dGl0bGU6IHtcblx0XHRcdFx0ZGlzcGxheTogdHJ1ZSxcblx0XHRcdFx0dGV4dDogYFJldmVudWUgb3ZlciBUaW1lYFxuXHRcdFx0fSxcblx0XHRcdHNjYWxlczoge1xuXHRcdFx0XHR4QXhlczogW3tcblx0XHRcdFx0XHRkaXNwbGF5OiB0cnVlLFxuXHRcdFx0XHRcdHR5cGU6IGBsaW5lYXJgXG5cdFx0XHRcdH1dLFxuXHRcdFx0XHR5QXhlczogW3tcblx0XHRcdFx0XHRkaXNwbGF5OiB0cnVlLFxuXHRcdFx0XHRcdHR5cGU6IGBsaW5lYXJgXG5cdFx0XHRcdH1dXG5cdFx0XHR9LFxuXHRcdFx0ZWxlbWVudHM6IHtcblx0XHRcdFx0cG9pbnQ6IHtcblx0XHRcdFx0XHRyYWRpdXM6IDBcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fSk7XG59XG5cbmlmIChHQU1FKSB7XG5cdG9uUmVzdWx0cyhHQU1FLCAocmVzKSA9PiB7XG5cdFx0bGV0IGRhdGEgPSBnZXRUZWFtRGF0YShyZXMpO1xuXHRcdGNvbnNvbGUubG9nKGRhdGEpO1xuXHRcdHBsb3RNYWluKGRhdGEudGltZSwgZGF0YS5tYXApO1xuXHR9KTtcbn1cbiJdfQ==\n"]}