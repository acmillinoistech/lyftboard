!function t(e,n,a){function r(i,s){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!s&&c)return c(i,!0);if(o)return o(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var d=n[i]={exports:{}};e[i][0].call(d.exports,function(t){var n=e[i][1][t];return r(n||t)},d,d.exports,t,e,n,a)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<a.length;i++)r(a[i]);return r}({1:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.COMMUNITY_AREAS={1:"Rogers Park",2:"West Ridge",3:"Uptown",4:"Lincoln Square",5:"North Center",6:"Lake View",7:"Lincoln Park",8:"Near North Side",9:"Edison Park",10:"Norwood Park",11:"Jefferson Park",12:"Forest Glen",13:"North Park",14:"Albany Park",15:"Portage Park",16:"Irving Park",17:"Dunning",18:"Montclare",19:"Belmont Cragin",20:"Hermosa",21:"Avondale",22:"Logan Square",23:"Humboldt Park",24:"West Town",25:"Austin",26:"West Garfield Park",27:"East Garfield Park",28:"Near West Side",29:"North Lawndale",30:"South Lawndale",31:"Lower West Side",32:"Loop",33:"Near South Side",34:"Armour Square",35:"Douglas",36:"Oakland",37:"Fuller Park",38:"Grand Boulevard",39:"Kenwood",40:"Washington Park",41:"Hyde Park",42:"Woodlawn",43:"South Shore",44:"Chatham",45:"Avalon Park",46:"South Chicago",47:"Burnside",48:"Calumet Heights",49:"Roseland",50:"Pullman",51:"South Deering",52:"East Side",53:"West Pullman",54:"Riverdale",55:"Hegewisch",56:"Garfield Ridge",57:"Archer Heights",58:"Brighton Park",59:"Mckinley Park",60:"Bridgeport",61:"New City",62:"West Eldson",63:"Gage Park",64:"Clearing",65:"West Lawn",67:"West Englewood",68:"Englewood",69:"Greater Grand Crossing",70:"Ashburn",71:"Auburn Gresham",72:"Beverly",73:"Washington Heights",74:"Mount Greenwood",75:"Morgan Park",76:"O'Hare",77:"Edgewater"}},{}],2:[function(t,e,n){"use strict";e.exports={apiKey:"AIzaSyCGWEpvuy4sPR3n5xzwfATLzyMDvwE6tOY",authDomain:"illinois-tech-acm.firebaseapp.com",databaseURL:"https://illinois-tech-acm.firebaseio.com",projectId:"illinois-tech-acm",storageBucket:"illinois-tech-acm.appspot.com",messagingSenderId:"344533734310"}},{}],3:[function(t,e,n){"use strict";function a(t){return t.replace(/(?!\w|\s)./g,"").replace(/\s+/g," ").replace(/^(\s*)([\W\w]*)(\b\s*$)/g,"$2")}function r(t,e){Array.from(document.querySelectorAll(t)).forEach(function(t){t.innerText=e})}function o(t,e){T.ref("lyft/results/"+t).once("value",function(t){var n=t.val()||{};e(n)})}function i(t,e){T.ref("lyft/info/"+t).once("value",function(t){var n=t.val()||{};e(n)})}function s(t,e){var n=t||{},a=Object.keys(n).map(function(e){return t[e]}).sort(function(t,e){return t.start-e.start}),r=[],o={};if(a.length>0){var i=a[0],s=0;for(var c in i.data)c in o||(o[c]={info:{teamid:c,name:"Untitled Team "+_[s]+" ("+c+")"},revenue:[],trips:[]},c in e&&(o[c].info=e[c],o[c].info.teamid=c)),s++;a.forEach(function(t){r.push(t.start);for(var e in t.data)if(e in o){var n=t.data[e];o[e].trips.push(n.trips);var a=n.revenue,i={lyft:parseFloat(a.lyft),taxi:parseFloat(a.taxi)};o[e].revenue.push(i)}})}for(var l in e)if(!(l in o)){var d=e[l];d.teamid=l,o[l]={info:d,revenue:[],trips:[]}}return{time:r,map:o}}function c(t){return{revenue:t.revenue.reduce(function(t,e){return t+e.lyft},0),trips:t.trips.reduce(function(t,e){return t+e.lyft},0)}}function l(t,e){var n=[],a=0;for(var r in e)!function(r){var o=[],i=0;e[r].revenue.forEach(function(e,n){i+=e.lyft,o.push({x:t[n],y:i})}),n.push({label:e[r].info.name,borderColor:C[a],fill:!1,cubicInterpolationMode:"monotone",data:o}),a++}(r);var o=document.getElementById("plot1").getContext("2d");new Chart(o,{type:"line",data:{datasets:n},options:{responsive:!1,maintainAspectRatio:!0,legend:{position:"right"},title:{display:!0,text:"Revenue over Time"},scales:{xAxes:[{display:!0,type:"linear",scaleLabel:{display:!0,labelString:"Time"},ticks:{callback:function(t){return moment(t).format("M/D")}}}],yAxes:[{display:!0,type:"linear",scaleLabel:{display:!0,labelString:"Revenue ($)"},ticks:{callback:function(t){return"$"+t.toFixed(0)}}}]},elements:{point:{radius:0}},multiTooltipTemplate:"<%%=datasetLabel%>: $<%%=value%>"}})}function d(t){var e=[];for(var n in t){var a=c(t[n]);e.push({info:t[n].info,score:a})}var r=e.sort(function(t,e){return e.score.revenue-t.score.revenue}),o=0,i=1/0;return r.forEach(function(t){t.score.revenue<i&&(i=t.score.revenue,o++),t.rank=o}),r}function u(t,e){var n=d(e),a=L.getLeaderboard({list:n});document.getElementById("leaderboard").appendChild(a)}function f(t,e){if(t&&e){var n=L.getTeamManagement();document.getElementById("team-management").innerHTML=n.innerHTML,document.getElementById("team-space").classList.remove("is-hidden"),document.getElementById("no-team-space").classList.add("is-hidden");var o=document.getElementById("team-secret"),i=document.getElementById("show-team-secret");o.value=t,i.addEventListener("click",function(t){"password"===o.type?(o.type="text",i.innerText="Hide",i.classList.remove("is-danger"),i.classList.add("is-success")):(o.type="password",i.innerText="Show",i.classList.remove("is-success"),i.classList.add("is-danger"))});var s=document.getElementById("teammate-email");document.getElementById("invite-teammate").addEventListener("click",function(e){if(s.value&&s.value.indexOf("@")>-1){var n=a(s.value);console.log("Invite "+n+" to "+t),n&&t&&T.ref("lyft/assignments/"+M+"/"+n).set(t)}});var c=document.getElementById("team-name"),l=document.getElementById("update-team-name");c.value=e.info.name,r(".fill-team-name",e.info.name),l.addEventListener("click",function(e){T.ref("lyft/info/"+M+"/"+t+"/name").set(c.value).then(function(t){window.location.reload()}).catch(console.error)});var d=document.getElementById("holder-pricing"),u=document.getElementById("holder-zones");d.innerHTML="",u.innerHTML="",T.ref("lyft/teams/"+M+"/"+t).on("value",function(t){var e=t.val()||{};d.innerHTML="",u.innerHTML="",e.pricing||(e.pricing={}),e.zones||(e.zones={});var n=L.getPricingCards(e);d.appendChild(n),e.community=w.COMMUNITY_AREAS;var a=L.getZonesCards(e);u.appendChild(a)})}else console.error("Cannot access team: ",t,e)}function m(t,e){var n=e||y();n||console.error("No game data available");var a={revenue:[],trips:[],info:{name:"No Team"}};t?(console.log("Your team is: "+t),a=n.map[t]):console.log("You do not have a team."),f(t,a)}function v(){var t=d(y().map),e=document.getElementById("all-teams-table");e.innerHTML="";var n=L.getAdminTeamTable({list:t});e.appendChild(n),document.getElementById("admin-add-team").addEventListener("click",function(t){T.ref("lyft/info/"+M).push({name:"Untitled Team"}).then(function(t){window.location.reload()}).catch(function(t){console.error(t)})})}function h(t){S="loading"===t?S:t;var e=document.querySelector("li[data-page].is-active");e&&e.classList.remove("is-active");var n=document.querySelector('li[data-page="'+t+'"]');n&&n.classList.add("is-active"),Array.from(document.querySelectorAll("section[data-page]")).forEach(function(t){t.classList.add("is-hidden")});var a=document.querySelector('section[data-page="'+t+'"]');a&&a.classList.remove("is-hidden")}function p(t){return new Promise(function(e,n){var r=a(t);T.ref("lyft/assignments/"+M+"/"+r).once("value",function(t){var n=t.val();e(n)}).catch(n)})}function g(){return new Promise(function(t,e){var n=new firebase.auth.GoogleAuthProvider;firebase.auth().signInWithRedirect(n).then(function(t){var e=t.user;console.log(e)}).catch(e)})}function y(){return B}function b(){o(M,function(t){i(M,function(e){var n=s(t,e);console.log(n),B=n,l(n.time,n.map),u(n.time,n.map),v(),p(x.email).then(function(t){m(t,n)}),h(S)})});var t=a(x.email);T.ref("lyft/admin/"+M+"/"+t).once("value",function(t){t.val()&&(I=!0,document.querySelector('[data-page="admin"]').classList.remove("is-hidden"))})}var k=t("./views"),w=t("./communityareas"),E=t("./config"),L=(0,k.Views)(),T=firebase.initializeApp(E).database(),M=!1;(M=localStorage.getItem("acm_lyft_game_key"))||(M=prompt("Enter your game key:"));var S="",P=!1,x={},I=!1,_="abcdefghijklmnopqrstuvwxyz".toUpperCase().split(""),C="#e6194b-#3cb44b-#ffe119-#0082c8-#f58231-#911eb4-#46f0f0-#f032e6-#d2f53c-#fabebe-#008080-#e6beff-#aa6e28-#fffac8-#800000-#aaffc3-#808000-#ffd8b1-#000080-#808080-#000000".split("-").map(function(t){return""+t}).reverse(),A={"/results":function(){console.log("results"),h("results")},"/leaderboard":function(){console.log("leaderboard"),h("leaderboard")},"/search":function(){console.log("search"),h("search")},"/team":function(){console.log("team"),h("team")},"/team/:teamid":function(t){console.log("team/"+t),I&&m(t),h("team")},"/admin":function(){console.log("admin"),h("admin")}};Router(A).init(),h("loading"),Array.from(document.querySelectorAll(".signout")).forEach(function(t){t.addEventListener("click",function(t){firebase.auth().signOut(),localStorage.removeItem("acm_lyft_game_key")})});var B={};M?(localStorage.setItem("acm_lyft_game_key",M),firebase.auth().onAuthStateChanged(function(t){t?(P=t.uid,x=t,T.ref("lyft/admin/"+M).once("value",function(t){if(t.val())b();else{var e=prompt("Do you want to start a new game with the code {"+M+"}? (y/n)");if(e)if("y"===e.toLowerCase()){var n=a(x.email);T.ref("lyft/admin/"+M+"/"+n).set(!0).then(function(t){window.location.reload()}).catch(console.error)}else localStorage.removeItem("acm_lyft_game_key");else localStorage.removeItem("acm_lyft_game_key")}})):g()})):alert("Please reload the page and enter a valid game key.")},{"./communityareas":1,"./config":2,"./views":4}],4:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Number.prototype.formatMoney=function(t,e,n){var a=this,t=isNaN(t=Math.abs(t))?2:t,e=void 0==e?".":e,n=void 0==n?",":n,r=a<0?"-":"",o=String(parseInt(a=Math.abs(Number(a)||0).toFixed(t))),i=(i=o.length)>3?i%3:0;return r+(i?o.substr(0,i)+n:"")+o.substr(i).replace(/(\d{3})(?=\d)/g,"$1"+n)+(t?e+Math.abs(a-o).toFixed(t).slice(2):"")};n.Views=function(){return{getLeaderboard:function(t){var e="";if(t.list.length>0){var n=t.list[0].score.revenue;e+='\n\t\t\t\t\t<table class="is-fullwidth">\n\t\t\t\t\t\t<thead>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<th>Rank</th>\n\t\t\t\t\t\t\t\t<th>Team</th>\n\t\t\t\t\t\t\t\t<th>Revenue</th>\n\t\t\t\t\t\t\t\t<th>Trips</th>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</thead>\n\t\t\t\t\t\t<tbody>\n\t\t\t\t',t.list.forEach(function(t){var a="background-color: rgba(35, 209, 96, "+(t.score.revenue/n*.95+.05).toFixed(3)+")",r="";1===t.rank&&(r='\n\t\t\t\t\t\t\t<span class="icon">\n\t\t\t\t\t\t\t\t<i class="icon fa fa-trophy"></i>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t'),e+="\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td><span>"+t.rank+"</span>"+r+"</td>\n\t\t\t\t\t\t\t\t<td>"+t.info.name+'</td>\n\t\t\t\t\t\t\t\t<td style="'+a+'">$'+t.score.revenue.formatMoney(2)+"</td>\n\t\t\t\t\t\t\t\t<td>"+t.score.trips+"</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t"}),e+="\n\t\t\t\t\t\t</tbody>\n\t\t\t\t\t</table>\n\t\t\t\t"}else e+="\n\t\t\t\t\t<p>There are no teams in this game yet.</p>\n\t\t\t\t";var a=document.createElement("div");return a.innerHTML=e,a.classList.add("table-holder"),a},getPricingCards:function(t){var e="",n=Object.keys(t.pricing).map(function(e){return t.pricing[e]}).sort(function(t,e){return e.in_effect-t.in_effect});n.length>0?n.forEach(function(t){e+='\n\t\t\t\t\t\t<div class="card">\n\t\t\t\t\t\t\t<header class="card-header">\n\t\t\t\t\t\t\t\t<p class="card-header-title">Week of '+moment(t.in_effect).format("M/D/YYYY")+'</p>\n\t\t\t\t\t\t\t</header>\n\t\t\t\t\t\t\t<div class="card-content">\n\t\t\t\t\t\t\t\t<table>\n\t\t\t\t\t\t\t\t\t<thead>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<th>Category</th>\n\t\t\t\t\t\t\t\t\t\t\t<th>Cost</th>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t</thead>\n\t\t\t\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td>Base</td>\n\t\t\t\t\t\t\t\t\t\t\t<td>$'+t.base.formatMoney(2)+"</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td>Pickup</td>\n\t\t\t\t\t\t\t\t\t\t\t<td>$"+t.pickup.formatMoney(2)+"</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td>Per Mile</td>\n\t\t\t\t\t\t\t\t\t\t\t<td>$"+t.per_mile.formatMoney(2)+"</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td>Per Minute</td>\n\t\t\t\t\t\t\t\t\t\t\t<td>$"+t.per_minute.formatMoney(2)+'</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t</tbody>\n\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\x3c!--<footer class="card-footer">\n\t\t\t\t\t\t\t\t<a href="#" class="card-footer-item">Save</a>\n\t\t\t\t\t\t\t\t<a href="#" class="card-footer-item">Edit</a>\n\t\t\t\t\t\t\t\t<a href="#" class="card-footer-item">Delete</a>\n\t\t\t\t\t\t\t</footer>--\x3e\n\t\t\t\t\t\t</div>\n\t\t\t\t\t'}):e+='\n\t\t\t\t\t<div class="notification is-primary">\n\t\t\t\t\t\t<h2 class="title is-3">No trip costs set.</h2>\n\t\t\t\t\t\t<p class="subtitle is-6">Make a POST request to the /pricing endpoint.</p>\n\t\t\t\t\t</div>\n\t\t\t\t';var a=document.createElement("div");return a.innerHTML=e,a},getZonesCards:function(t){var e="",n=Object.keys(t.zones).map(function(e){return t.zones[e]}).sort(function(t,e){return e.in_effect-t.in_effect});n.length>0?n.forEach(function(n){e+='\n\t\t\t\t\t\t<div class="card">\n\t\t\t\t\t\t\t<header class="card-header">\n\t\t\t\t\t\t\t\t<p class="card-header-title">Week of '+moment(n.in_effect).format("M/D/YYYY")+'</p>\n\t\t\t\t\t\t\t</header>\n\t\t\t\t\t\t\t<div class="card-content">\n\t\t\t\t\t\t\t\t<table>\n\t\t\t\t\t\t\t\t\t<thead>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<th>Zone</th>\n\t\t\t\t\t\t\t\t\t\t\t<th>Community Area</th>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t</thead>\n\t\t\t\t\t\t\t\t\t<tbody>\n\t\t\t\t\t';for(var a in n)"in_effect"!==a&&(e+="\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td>Zone "+a+"</td>\n\t\t\t\t\t\t\t\t\t\t\t<td>"+t.community[a]+"</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t");e+='\n\t\t\t\t\t\t\t\t\t</tbody>\n\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\x3c!--<footer class="card-footer">\n\t\t\t\t\t\t\t\t<a href="#" class="card-footer-item">Save</a>\n\t\t\t\t\t\t\t\t<a href="#" class="card-footer-item">Edit</a>\n\t\t\t\t\t\t\t\t<a href="#" class="card-footer-item">Delete</a>\n\t\t\t\t\t\t\t</footer>--\x3e\n\t\t\t\t\t\t</div>\n\t\t\t\t\t'}):e+='\n\t\t\t\t\t<div class="notification is-primary">\n\t\t\t\t\t\t<h2 class="title is-3">No power zones set.</h2>\n\t\t\t\t\t\t<p class="subtitle is-6">Make a POST request to the /zones endpoint.</p>\n\t\t\t\t\t</div>\n\t\t\t\t';var a=document.createElement("div");return a.innerHTML=e,a},getAdminTeamTable:function(t){var e="";if(t.list.length>0){var n=t.list[0].score.revenue;e+='\n\t\t\t\t\t<table class="is-fullwidth">\n\t\t\t\t\t\t<thead>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<th>Rank</th>\n\t\t\t\t\t\t\t\t<th>Team</th>\n\t\t\t\t\t\t\t\t<th>Revenue</th>\n\t\t\t\t\t\t\t\t<th>Trips</th>\n\t\t\t\t\t\t\t\t<th>View</th>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</thead>\n\t\t\t\t\t\t<tbody>\n\t\t\t\t',t.list.forEach(function(t){var a="background-color: rgba(35, 209, 96, "+(t.score.revenue/n*.95+.05).toFixed(3)+")",r="";1===t.rank&&(r='\n\t\t\t\t\t\t\t<span class="icon">\n\t\t\t\t\t\t\t\t<i class="icon fa fa-trophy"></i>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t'),e+="\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td><span>"+t.rank+"</span>"+r+"</td>\n\t\t\t\t\t\t\t\t<td>"+t.info.name+'</td>\n\t\t\t\t\t\t\t\t<td style="'+a+'">$'+t.score.revenue.formatMoney(2)+"</td>\n\t\t\t\t\t\t\t\t<td>"+t.score.trips+'</td>\n\t\t\t\t\t\t\t\t<td><a href="/#/team/'+t.info.teamid+'" class="button is-primary is-outlined">View Team</a></td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t'}),e+="\n\t\t\t\t\t\t</tbody>\n\t\t\t\t\t</table>\n\t\t\t\t"}else e+="\n\t\t\t\t\t<p>There are no teams in this game yet.</p>\n\t\t\t\t";var a=document.createElement("div");return a.innerHTML=e,a.classList.add("table-holder"),a},getTeamManagement:function(){var t=document.createElement("div");return t.innerHTML='\n\t\t\t\t<div class="columns">\n\t\t\t\t\t<div class="column is-4">\n\t\t\t\t\t\t<h4 class="title is-4">Team Name</h4>\n\t\t\t\t\t\t<div class="field has-addons">\n\t\t\t\t\t\t\t<p class="control">\n\t\t\t\t\t\t\t\t<input id="team-name" class="input" type="text">\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<p class="control">\n\t\t\t\t\t\t\t\t<button id="update-team-name" class="button is-success">Update</button>\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="column is-4">\n\t\t\t\t\t\t<h4 class="title is-4">Invite Teammate</h4>\n\t\t\t\t\t\t<div class="field has-addons">\n\t\t\t\t\t\t\t<p class="control">\n\t\t\t\t\t\t\t\t<input id="teammate-email" class="input" type="text">\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<p class="control">\n\t\t\t\t\t\t\t\t<button id="invite-teammate" class="button is-success">Invite</button>\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="column is-4">\n\t\t\t\t\t\t<h4 class="title is-4">Team Secret</h4>\n\t\t\t\t\t\t<div class="field has-addons">\n\t\t\t\t\t\t\t<p class="control">\n\t\t\t\t\t\t\t\t<input id="team-secret" class="input is-static" type="password" value="secrettext" readonly>\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<p class="control">\n\t\t\t\t\t\t\t\t<button id="show-team-secret" class="button is-danger">Show</button>\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t',t}}}},{}]},{},[3]);
//# sourceMappingURL=maps/main.js.map
